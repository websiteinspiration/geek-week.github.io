<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüíº üê¶ ü§õüèº Im√°genes como cajas: ¬øqu√© hay dentro? Informar en Yandex üë©üèø‚Äçü§ù‚Äçüë®üèº üêÅ ‚ò¢Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las im√°genes y los videos son "cajas negras", dentro de las cuales hay muchas cosas interesantes e incomprensibles. Pero puede mirar dentro de algunos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Im√°genes como cajas: ¬øqu√© hay dentro? Informar en Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/493616/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las im√°genes y los videos son "cajas negras", dentro de las cuales hay muchas cosas interesantes e incomprensibles. </font><font style="vertical-align: inherit;">Pero puede mirar dentro de algunos formatos, cambiar todo all√≠ y ver qu√© sucede. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Polina Gurtovaya, de la compa√±√≠a Evil Martians, habl√≥ en nuestra conferencia </font></font><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I&nbsp; </font></font><img src="https://habrastorage.org/webt/jq/7k/7w/jq7k7wi7p_23g0_clzmrmlgri7y.jpeg" width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Frontend</font></font></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en febrero. </font><font style="vertical-align: inherit;">Con la ayuda del experimento, Polina descubri√≥ c√≥mo convertir im√°genes simples en "im√°genes efectivas" con m√©tricas. </font><font style="vertical-align: inherit;">Las herramientas que pueden hacer esto por nosotros, Polina examin√≥ m√°s cerca del final del informe. </font><font style="vertical-align: inherit;">El resultado fue una gran excursi√≥n al interior y a los principios de funcionamiento de varios formatos: desde PNG y JPEG hasta AV1 y ex√≥ticos.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/CMlXUS6e46w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Hola a todos. </font><font style="vertical-align: inherit;">Mi nombre es Polina, soy el frente de la empresa "Evil Martians".</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tal vez conoces marcianos de nuestras muchas fuentes abiertas. Te contar√© un poco sobre √©l m√°s tarde. Y probablemente debo decir que todav√≠a estamos desarrollando productos, y no solo aserrando c√≥digo abierto. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ck/cs/gx/ckcsgxe6gmebfvkdo2rux-lwwgy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los materiales para el informe estar√°n disponibles para usted a trav√©s de un maravilloso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enlace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el repositorio en GitHub. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/km/90/d2/km90d2teg2yhoqpn4y7xs9x1ryq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hablemos un poco sobre la optimizaci√≥n. Cuando tratamos con ellos, el problema es que funcionan bien si entendemos lo que estamos haciendo. Si no entendemos, resulta mal. Cuando se trata de la optimizaci√≥n de im√°genes, desafortunadamente, todo aqu√≠ no es realmente genial. Es posible que no optimicemos las im√°genes en absoluto, y luego habr√° monstruos de dos metros en el producto, todo es triste y triste.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si optimizamos, ¬øqu√© estamos haciendo? Pensamos: aqu√≠ tenemos una imagen, es una especie de misteriosa caja negra, y el programa optimizador hace algo con esta imagen, una especie de chamanismo negro. La calidad de optimizaci√≥n que obtenemos es un poco dudosa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4g/hr/bv/4ghrbv-nnuqbug7iz0qavj4frma.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos un ejemplo. Tengo un gato en formato PNG. Creo que necesitamos optimizarlo. ¬øQu√© estoy haciendo? Creo una versi√≥n de WebP y pongo cuidadosamente ambas im√°genes en una etiqueta &lt;picture&gt;. ¬øCrees que he terminado bien aqu√≠ o no? ¬øPor qu√© hay tan pocas manos? Estoy muy bien hecho! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hice todo bien, pero la versi√≥n de WebP result√≥ dos kilobytes m√°s que la original. Esto es un poco no lo que quer√≠a.‚Ä®</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/4r/hc/li4rhcov7blg4uquvq54dhmrrk8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra optimizaci√≥n, intento n√∫mero 2. Tengo un peque√±o contenedor en la p√°gina y un gran gato grande. Quiero poner un gato grande en un recipiente peque√±o. ¬øQu√© estoy haciendo? Estoy haciendo un cambio de tama√±o porque es est√∫pido conducir bytes a trav√©s de la red si el tama√±o de mi contenedor es peque√±o. Por supuesto, tengo en cuenta la relaci√≥n de p√≠xeles del dispositivo de mi dispositivo. ¬øCrees que estoy bien aqu√≠ o no? ¬°He terminado! Y mira lo que hice. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estoy usando la biblioteca libvips. Ella es muy genial y popular, y de mi enorme pero feliz gato ligero obtuve un gato peque√±o y muy pesado. El sello aument√≥ 2.5 veces (en bytes) durante el cambio de tama√±o (en p√≠xeles) hacia abajo. Genial, si?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rv/81/vf/rv81vftipmbdmz3opezzn42k6yw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, para que esto no nos suceda, que comprendamos c√≥mo optimizar nuestras im√°genes para nuestra tarea, y, en general, para que al menos comprendamos lo que est√° sucediendo, echemos un vistazo a la caja y comprendamos qu√© hay dentro. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ur/8y/tn/ur8ytn4gri-ezcgsvsxsulwbc10.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comencemos mirando un formato tan interesante como PNG. Alrededor de cada sitio, un peque√±o peengshechka est√° escondido en alguna parte. Esta vez. Por lo tanto, deben ser entendidos. Segundo: PNG: formato de compresi√≥n sin p√©rdidas. Esto significa que garantizamos una coincidencia perfecta con el original en p√≠xeles, pero al mismo tiempo, por desgracia, estamos limitados por naturaleza, no podemos comprimir menos de cu√°nto.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-2/sp/r0/-2spr0e9x6o0qirw1n5fg__zkkk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peengeshka se pliega en un contenedor, como cualquier formato de imagen. Una de las primeras cosas que debemos decirle al programa si lo lee todo es lo que hay dentro. Si supone que sus decodificadores determinan las im√°genes por extensi√≥n, esto no es as√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengashka informa que es PNG, los primeros ocho bytes en su contenedor. Dice "PNG". Adem√°s, una vez m√°s, esto es caracter√≠stico de cualquier contenedor: tiene un dise√±o de trozos. Es decir, la informaci√≥n est√° empaquetada en trozos, de alguna manera est√°n organizados. C√≥mo: define el contenedor. En PNG, se ve as√≠: tiene cuatro bytes que son responsables de la longitud y cuatro bytes que son responsables del tipo de fragmento. Qu√© tipos: hablaremos un poco m√°s tarde. ‚Ä®</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si el fragmento tiene una longitud distinta de cero, tiene una carga √∫til. Adem√°s, existe una suma de comprobaci√≥n. Est√°s comprobando si algo ha sido golpeado all√≠. Luego vienen los siguientes fragmentos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tw/-1/49/tw-1499ut7u6w6fl6rhas8tyk3m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analizar no solo un archivo PNG, sino que casi cualquiera es bastante f√°cil. Tome FileReader, esta es una API de navegador. Leemos el archivo usando FileReader. Tan pronto como leemos, cortamos este archivo en trozos. No dar√© aqu√≠ el c√≥digo de la funci√≥n de divisi√≥n en fragmentos, pero puedes adivinar que hay una combinaci√≥n intrincada de if y for. ‚Ä®</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n7/bg/sb/n7bgsbtsscwv-prpt2atx7a18d4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien, lo hemos cortado, veremos qu√© pasa. Tenemos varios tipos de fragmentos, y son muy, muy caracter√≠sticos de casi cualquier formato. El primero se llama IHDR. Hay una serie de fragmentos llamados IDAT. Estos nombres pueden parecerle un poco extra√±os, pero ahora descubriremos de qu√© se trata. Cuando todo termina, vemos el trozo final.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/y0/pc/b6/y0pcb6n_4f4uiuakytlvwzla3ao.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Echemos un vistazo m√°s de cerca dentro de los trozos. IHDR es un meta-fragmento, y casi cualquier imagen tiene dicho meta-fragmento. Se llama de manera diferente, se organiza de manera diferente, pero lo m√°s probable es que lo sea. Sin √©l, su descompresor, algo que le muestra peengeshki o no peengeshki, no puede mostrarle nada. ¬øQu√© hay en este pedazo? Nuevamente, el contenido es t√≠pico para la mayor√≠a de los formatos. Esta es la altura y el ancho. La altura y el ancho est√°n cosidos en su archivo, se trata de usted. Los siguientes son los t√≠picos indicadores de estilo: bitDepth, colorType y entrelazado. ‚Ä®</font></font><br>
<img src="https://habrastorage.org/webt/cj/ry/k3/cjryk3bpfhzf--zu_vofzg1vdcc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de hablar sobre lo que significan estas banderas y por qu√© son tan, muy importantes para nosotros, veamos c√≥mo almacenamos p√≠xeles en pangshes. En peaneshs, los p√≠xeles se almacenan dentro de un fragmento llamado IDAT. En un buen escenario, los p√≠xeles son una cierta cantidad de n√∫meros que se empaquetan en un fragmento, y este fragmento se comprime mediante el algoritmo de compresi√≥n Deflate. ¬øQui√©n us√≥ el algoritmo de compresi√≥n Deflate? Bien, ¬øcu√°ndo fue la √∫ltima vez que comprimiste algo? ¬øSabes que Deflate es gzip? As√≠ que creo que muchos lo usaron.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero en peengeshah aparece otra cosa interesante que se usa en una gran cantidad de formatos, pero probablemente en todos. Este artilugio se llama codificaci√≥n predictiva. El hecho es que nuestras im√°genes no son p√≠xeles aleatorios. Lo que est√° pintado en nuestra peque√±a imagen est√° de alguna manera conectado entre s√≠. Hay algunas √°reas oscuras, √°reas brillantes, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos tratando de explotar este hecho, y en lugar de almacenar el valor de p√≠xel en estas celdas azules, estamos tratando de predecir estos p√≠xeles en funci√≥n de los anteriores. En PNG, estas predicciones son muy simples y se empaquetan en el primer byte antes de la l√≠nea con p√≠xeles. Una predicci√≥n puede ser as√≠, por ejemplo, no pronostiquemos nada y simplemente pongamos todo como est√°. O, por ejemplo, podemos decir esto: pero solo mantengamos la diferencia entre el p√≠xel actual y el anterior. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tiene el mismo color en su l√≠nea, tendr√° todos los ceros, todo est√° perfectamente comprimido, esto es muy bueno.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/ut/zh/jqutzhlx2vsbyxrbpbuogts9vbq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero ahora hablemos de lo que realmente significa un p√≠xel. Un p√≠xel aparece en un peengesh como un n√∫mero de n√∫meros. Al manipular cu√°ntos n√∫meros hay, puede comprimir muy, muy estrechamente su PNG, tres veces. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© opciones hay? El primero es True Color y alpha. Tenemos tres canales, tres colores, tres n√∫meros por color. Adem√°s de un canal responsable de la transparencia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El tama√±o de este n√∫mero en bits es bitDepth, el mismo indicador que vimos en el fragmento IHDR. Cuanto m√°s peque√±o sea su bitDepth, m√°s peque√±o ser√° el archivo, pero menos colores podr√° presentarles. Un n√∫mero t√≠pico es 8. ¬øCu√°nto es? En mi opini√≥n, habr√° 16 millones con algo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acuerdo, la primera optimizaci√≥n que puedes hacer es tirar los canales alfa en tu peengesh. Este ser√° un colorType diferente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede optimizar a√∫n mejor y usar solo uno en lugar de cuatro n√∫meros. Pero el problema es que tu peengeshka deber√≠a ser blanco y negro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si todav√≠a desea solo un n√∫mero y deja los colores, entonces esto tambi√©n se puede hacer. ¬øQue est√° pasando aqui? Tomas todos los colores dentro de tu peengeshka y los cortas en un trozo separado. Ll√°malo paleta. M√°s adentro de la muestra, que es responsable del p√≠xel dentro del fragmento IDAT, simplemente almacena el √≠ndice de esta paleta. Si tiene alguna captura de pantalla sin un fondo intrincado o alg√∫n dibujo, esto es perfecto. Ella aprieta peengeshki ¬°guau!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra cosa importante que decir es sobre el entrelazado. ¬øQu√© es el entrelazado? Esto es cuando env√≠as tu peengeshka gradualmente. No tienes una peengeshka, sino varias im√°genes. Cada imagen se llama escaneo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gq/u5/50/gqu550y52cqmqi9k14skfsy-bg0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al mismo tiempo, dentro del paengashka, clasifica los p√≠xeles de tal manera que algunos de los p√≠xeles se separan de las im√°genes, una imagen proviene de lugares especiales. La siguiente parte es otra y as√≠ sucesivamente. Una t√©cnica aparentemente genial como JPEG progresivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero se ve as√≠. No estoy seguro si desea que sus usuarios vean esto, aunque puede ser √∫til para su tarea.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo y muy grave problema de PNG entrelazado es que tan pronto como entrelazas tu peengeshka, el tama√±o de tu peengeshka se hace m√°s grande. Y ya no tan d√©bil, en alg√∫n lugar en un par de kilobytes, tu peengeshka de seis kilobytes crecer√° si desactivas Interlaced. Por lo tanto, piense detenidamente si lo quiere o no. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vg/p6/rq/vgp6rqgvogzln5frkfs5lmtcy4y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hablamos solo de PNG, pero de esto puedes sacar conclusiones importantes y √∫tiles. Primera conclusi√≥n: el tama√±o de su archivo, no lo creer√°, depende de lo que se dibuje all√≠. El cuadrado negro se contrae mejor que el gato, no dar√© ninguna recomendaci√≥n aqu√≠. Segundo, m√°s importante: el tama√±o de su archivo depende mucho del codificador y de los par√°metros que transfiera.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si quieres ver c√≥mo funcionan los codificadores horribles, usa los del navegador. ¬øC√≥mo est√° hecho? Tome el archivo PNG, dib√∫jelo en el lienzo, luego haga clic en Guardar como y compare lo que sucedi√≥ con lo que sucedi√≥. En general, Chrome aumentar√° el tama√±o de su archivo en 2.5 veces, Firefox, en 1.6. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cierto, tambi√©n siempre depende del formato, es decir, no solo se debe usar PNG. Comprendamos por qu√© todo depende del formato y de las opciones interesantes que a√∫n tenemos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dk/z9/jd/dkz9jdpv9uy9ivtiqcl-f5nyzhk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para hacer esto, hablaremos sobre la tecnolog√≠a de los antiguos, sobre JPEG. Por supuesto, no puede minimizar la importancia de JPEG. Se encuentran en todas partes. Son tan geniales, buenos y a√∫n m√°s, los sellos en JPEG son una historia bastante com√∫n. Pero JPEG es algo bastante complicado, y es complicado debido al hecho de que JPEG es una compresi√≥n con p√©rdida. Adem√°s, JPEG siempre es una compresi√≥n con p√©rdida. JPEG 100% de calidad todav√≠a se comprime con p√©rdida. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo obtenemos compresi√≥n con p√©rdida? Muy simple. Tomamos alguna fuente, arrojamos los datos de ella y luego la comprimimos sin p√©rdida. Es decir, m√°s un paso.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/k7/pb/ctk7pba6jjplst_3mcqx-4r5xno.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos c√≥mo hacemos p√©rdidas en nuestros archivos JPEG. Entonces, tienes un gato con un tama√±o de 32 por 32. Para que podamos dar el primer paso con p√©rdidas, necesitamos cambiar nuestros canales. Por lo general, hablamos de im√°genes en t√©rminos de RGB. Pero percibimos los colores un poco intrincados. Nuestro cerebro generalmente es un gran problema, aunque nos ayuda mucho a comprimir JPEG. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Percibimos muy bien el blanco y negro. Incluso si observa detenidamente, notar√° que los detalles en la imagen en blanco y negro se distinguen mejor. Acabamos de poner esta imagen en blanco y negro en un canal separado. Se llama Y. En realidad, la barra Y. No estamos haciendo nada con √©l, simplemente lo dejamos como est√°.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay dos canales m√°s que son responsables del color. Estos son CB y CR. Con estos canales ya podemos divertirnos un poco. Aqu√≠ con estos canales producimos un procedimiento tan genial llamado Downsampling. Tomamos y reducimos la resoluci√≥n de este canal. Para JPEG es t√≠pico reducir a la mitad. Es decir, de hecho, obtienes tres im√°genes, una original y dos la mitad. ¬°Hurra! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© hacemos a continuaci√≥n? No comprimimos JPEG, no como un archivo completo. Lo dividimos en bloques y comprimimos a√∫n m√°s, ya estamos comenzando bloques. Los bloques en JPEG tienen un tama√±o de 8 por 8 y observa qu√© les sucede. Veamos el canal Y. CB y CR son todos iguales.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gm/zo/yg/gmzoyg2byoms9jzzncnxvauwiic.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, un bloque no es una imagen, sino n√∫meros. Necesitamos hacer p√©rdidas en JPEG. Este bloque es de 8 por 8, 64 p√≠xeles, ¬øcu√°l tirar? ¬øEl de la izquierda, el de la derecha, el del medio? Poco claro. Pero hay matem√°ticas geniales que nos permiten resolver este problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta matem√°tica se llama, ahora, por favor, no se ponga nervioso si alguien recuerda el terrible pasado institucional: la transformaci√≥n discreta del coseno. Entonces, con la ayuda de esta transformada discreta del coseno, puede convertir estos n√∫meros en su bloque para que sean importantes y sin importancia entre ellos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Importante: despu√©s de la conversi√≥n, los n√∫meros importantes permanecen en la parte superior izquierda del bloque. En la esquina inferior derecha quedan n√∫meros sin importancia.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, debe realizar su p√©rdida de JPEG. Esto tambi√©n es muy f√°cil de hacer. Este truco se llama cuantizaci√≥n. Lo siento si quieres dormir ahora, pero esto es importante, cr√©eme. Entonces, esta misma cuantizaci√≥n funciona de una manera bastante simple. Tomas tu bloque y una placa especialmente dise√±ada. Esta placa est√° determinada por su programa de codificador. Esos n√∫meros que resultaron en su bloque, los divide por este t√©rmino de placa por n√∫mero y n√∫mero entero. ¬øQu√© obtienes como resultado? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como los n√∫meros son grandes en la parte inferior derecha de la placa, solo habr√° ceros.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cw/ak/a4/cwaka4z7wsiu0agcr4d6say3ddc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y al mismo tiempo tu JPEG, tu bloque se comprimir√° perfectamente. Tendr√° una peque√±a cantidad de n√∫meros que evitar√° en un zigzag tan intrincado, todos los ceros desaparecer√°n y, gracias, nuestro bloque est√° listo para la compresi√≥n. Entonces solo necesitamos comprimirlo con un algoritmo de compresi√≥n sin p√©rdidas. JPEG usa Huffman Coding, sea lo que sea. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jv/f9/lr/jvf9lrka6wigwi-l09lcfejpf6a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo se empaca en un contenedor? Los contenedores JPEG se ven un poco tontos, les tengo miedo. Porque ves los primeros dos bytes y dice que lo m√°s probable es que sea JPEG. Pero hasta ahora no est√° claro.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, debe buscar dos fragmentos de meta. ¬øPor qu√© dos? Porque JPEG es un conjunto muy grande de diferentes est√°ndares. Lo que llamamos JPEG es, por norma, llamado JIFF. Esta es una extensi√≥n especial del est√°ndar JPEG. No continuar√© m√°s all√°: en general, hay dos fragmentos de meta, solo conf√≠a en m√≠. Estos meta-fragmentos contienen informaci√≥n sobre el ancho y alto de su archivo y la versi√≥n de JPEG. ¬°Imag√≠nese, JPEG tiene m√°s versiones! Y adem√°s, ¬øes JPEG progresivo? Esta es una bandera importante. Habla sobre c√≥mo se distribuir√°n m√°s tus bloques.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si JPEG no es progresivo, ¬øqu√© necesitas para decodificar tus bloques? Calidad JPEG, esta misma placa. La placa en la que divide sus bloques es de calidad. Pero JPEG tiene dos cualidades. La primera calidad es responsable del canal Y, la segunda: para los canales CB y CR, esto es lo que determina el color. Como ponemos la calidad en un archivo y lo exprimimos todo con un algoritmo de compresi√≥n sin p√©rdidas, a√∫n necesitamos un diccionario especial de tablas de Huffman para expandir esto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego vienen tus bloques, y luego tu JPEG ha terminado.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/qz/ap/hjqzaprqwxahztq8enqtwzq5cce.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acuerdo, una historia progresiva. Todo es exactamente lo mismo. Al principio tienes un meta-fragmento. Luego viene su calidad en forma de 64 n√∫meros, m√°s 64 n√∫meros. Y luego solo los mismos bloques, pero un poco diferentes con los n√∫meros distribuidos. Primera parte de los bloques, luego otra parte, otra parte, etc. A medida que recibe estos bloques, el navegador dibuja una aproximaci√≥n de su JPEG, porque, de hecho, estos n√∫meros son una aproximaci√≥n de su archivo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/uq/x3/qquqx3mnyg-nx0pn8a0lgmjufpa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobre JPEG que terminamos, puedes exhalar, todo est√° bien. Hablemos de algo tan interesante como JPEG 2000. ¬øAlguno de ustedes en producci√≥n usa JPEG 2000? ¬øQui√©n ha o√≠do hablar de esto? ¬øY cu√°l de ustedes ha le√≠do en Lighthouse: "utilizar formatos modernos"?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, JPEG 2000 es un formato interesante y genial, que, en primer lugar, es m√°s efectivo que JPEG. En segundo lugar, no lo creer√°, en algunos casos es m√°s efectivo que WebP, del que hablaremos m√°s adelante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sabe ser transparente, sabe comprimir sin p√©rdida. Solo el formato perfecto. Pero desafortunadamente, s√≠, solo funciona en Safari. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vale la pena mencionar que JPEG 2000 est√° dise√±ado de una manera muy compleja y funciona en matem√°ticas geniales llamadas transformaciones wavelet. Si de repente te interesa, google, y iremos m√°s all√°.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/b8/qw/lib8qwt1s_r7xowxervhr6yaay0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, de repente, necesitamos hablar sobre el video. Todo este informe trata sobre la optimizaci√≥n de im√°genes y sobre im√°genes. Pero el video aqu√≠ es muy importante, ver√°s por qu√© ahora. Cuando pensamos en un video, la primera palabra que nos viene a la mente es "c√≥dec". El video debe estar codificado de alguna manera, y para mostrarlo, debemos decodificarlo. Si decodificamos la transmisi√≥n de video, ¬øqu√© obtenemos?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En primer lugar, tenemos un conjunto de marcos. Pero no piense en estos cuadros como im√°genes en el GIF. Todo mal. Qu√© cuadros dependen mucho del c√≥dec. Pero en el caso general, puede suponer que tiene un fotograma clave. Puede sacar un gato del fotograma clave, en el sentido, cualquier imagen que est√© en este fotograma clave. Y hay marcos dependientes. Es imposible sacar un gato del cuadro dependiente, porque el cuadro dependiente almacena no solo informaci√≥n no sobre la imagen, si la hay, sino sobre c√≥mo se movieron los bloques del cuadro anterior o anterior. Por lo tanto, no puede obtener una imagen para un cuadro dependiente hasta que decodifique un poco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo lo que vamos a hablar ahora es la compresi√≥n de fotogramas clave y dentro de fotogramas. As√≠ es como se comprime una imagen dentro de un fotograma clave.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos un c√≥dec abstracto en el vac√≠o y comp√°relo con JPEG. Hasta ahora parece, ¬øpor qu√© hacer esto? Todo se aclarar√°, conf√≠a en m√≠. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i9/vh/7y/i9vh7ygfkhjucwtefchjamthm3u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez m√°s, repetimos lo mismo que hacemos con JPEG,. Toma una fotograf√≠a, la divide en canales, hace un muestreo descendente en los canales. La misma historia aqu√≠. Luego rompes esta imagen en bloques. Pero ya hay caracter√≠sticas. En primer lugar, el tama√±o del bloque en el que est√° entrando depende de su c√≥dec. Y estos bloques pueden ser muy grandes. Para JPEG - 8 por 8. Para c√≥decs de video - puede ser, por ejemplo, 128 por 128.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°s lejos. Si obtiene algunos detalles muy peque√±os sobre su imagen a los que desea prestar atenci√≥n, a√∫n puede subdividir los bloques un poco, aproximadamente al tama√±o 4 por 4. C√≥mo rompe los bloques, este algoritmo de partici√≥n depende del c√≥dec. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y lo m√°s reciente: el tama√±o m√°ximo de bloque, nuevamente, es espec√≠fico para su c√≥dec. Un codificador es parte del c√≥dec, que debe entenderse en terminolog√≠a. Aqu√≠ todav√≠a somos similares a JPEG. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r0/la/y3/r0lay3m2i5yjdu-sx9by6lsyhpi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo que no parece JPEG es la codificaci√≥n predictiva. Hablamos de √©l en parte sobre peengeshki. La compresi√≥n de video dentro del marco es tan genial y efectiva solo por esto. ¬øQue est√° pasando aqui?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos tratando de predecir los p√≠xeles de cada bloque en funci√≥n de los anteriores. Es decir, no almacenamos p√≠xeles en forma cruda, los predecimos. Las opciones de predicci√≥n son muchas. Dentro de un c√≥dec, podemos usar diferentes variantes de predicciones. Adem√°s, para todo tipo de c√≥decs intrincados de estas opciones, hasta 35, por ejemplo. C√≥mo puedes hacer esto. Veamos un ejemplo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ tienes el bloque. Dices: Quiero predecir p√≠xeles all√≠. Miras hacia la izquierda, miras hacia arriba y recuerdas lo que queda y arriba. Luego, toma todos los valores de p√≠xeles que encontr√≥, promedia y lo llena con un bloque, y dice: Predije. Si acert√≥ y, por cierto, en la peque√±a imagen donde hay flechas azules, acert√≥, entonces es genial, no tiene que hacer nada m√°s. Pero, si no lo ha adivinado, debe guardar la diferencia entre lo que realmente es y lo que predijo. Esta diferencia se comprime mucho, mucho mejor que el valor de p√≠xel puro.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/mb/cg/dxmbcg7w-imsyuamimesxnxi3s0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces todo es exactamente igual que en JPEG. Transformar√° el bloque resultante. Pero la peculiaridad de todo tipo de c√≥decs diferentes es que no puede usar DCT (transformada discreta de coseno), sino algo m√°s. Qu√© usar depende del c√≥dec. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_k/sj/7x/_ksj7xbki-d-hjam59vm-ovudtk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por otra parte, las mismas placas, pero a diferencia de JPEG, puede usar m√°s de una placa para todo su archivo, y puede usar varias placas diferentes para diferentes bloques. Imagina que tienes una persona, por ejemplo, contra el cielo. Quiz√°s, dado que el cielo es azul, no necesita una calidad especial all√≠, puede usar una calidad para el cielo, una placa. Y para una persona que tiene cualquier textura, ropa, use una calidad diferente, y resulta genial y efectivo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ax/lh/mc/axlhmcjhw3u18r0v826se8n74me.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo m√°s reciente es lo que JPEG no tiene, y lo que JPEG es muy, muy escaso. Este es el uso de filtros. Cuando todos cosechamos, obtenemos artefactos tan desagradables despu√©s de la compresi√≥n. Si alguna vez ha comprimido archivos JPEG a baja calidad, deber√≠a ver c√≥mo los JPEG se desmoronan simplemente en terribles bloques de pesadilla. En general, para deshacerse de estos artefactos, los c√≥decs de video usan algo especial. Aplican filtros y los bordes de estos bloques se suavizan. La tecnolog√≠a de los antiguos, que nos permit√≠a hacer lo mismo con JPEG, era tal. Toma su JPEG, lo comprime muy, muy duro, luego lo dobla as√≠ para que no se note nada. En general, esto es casi lo mismo, pero ya se ha hecho a nivel de c√≥dec. Excelente.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eu/kn/oe/euknoewgg9xovgain172cbr03eu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, cuando lo intentamos y todo estaba listo, ahora necesitamos comprimir los bloques recibidos sin p√©rdida. Nos apretamos, bien hecho. El algoritmo de compresi√≥n es similar a JPEG, pero a√∫n diferente. Aqu√≠ debe entenderse que la compresi√≥n sin p√©rdidas est√° limitada por el l√≠mite natural. Realmente queremos acercarnos a √©l, y la mejor manera de acercarnos a √©l es si usamos un algoritmo llamado codificaci√≥n aritm√©tica. Y tambi√©n hay todo tipo de variaciones. Esto nuevamente depende del codificador, pero supongamos que hay una compresi√≥n sin p√©rdidas y aprox.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/9q/ej/li9qej4dyf4w1tqxuu0kdyma1pe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante mucho tiempo he querido llamar a estos c√≥decs abstractos en el vac√≠o por sus nombres propios. Una peque√±a excursi√≥n hist√≥rica. ¬øQu√© pas√≥ en 20 a√±os? Estoy hablando solo de esos c√≥decs de video que al menos de alguna manera son compatibles en la web. H.264 es un c√≥dec que admite todo y a todos. Esta es la soluci√≥n predeterminada para todo el video. Despu√©s de cierto tiempo, despu√©s de unos a√±os, aparece el c√≥dec de video VP8. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ comienzan las guerras salvajes, los holivars sobre el tema de cu√°les de estos c√≥decs son mejores. Busqu√© en Google durante mucho tiempo, no hay respuesta. Se han escrito grandes art√≠culos cient√≠ficos sobre esto, pero en promedio, si digo lo mismo ahora, un tomate volar√° hacia m√≠. Pero, bueno, son lo mismo. Promedio. Entonces, ¬øpor qu√© necesitamos un segundo?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo es necesario porque es gratis. Si usa H.264, debe llevar dinero MPEG en algunas circunstancias. Para VP8 no necesitas llevar dinero. Es bueno. Entonces, fotograma clave VP8: esto es WebP. De hecho, ¬øpor qu√© deber√≠amos inventar un nuevo formato de imagen? Tomamos el fotograma clave, nos esforzamos tanto que lo exprimimos todo. Lo llamamos todo un nuevo formato de im√°genes, ¬°y listo!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© pasa despu√©s? Luego, despu√©s de varios a√±os, dos c√≥decs de video m√°s interesantes, de MPEG y de Google, aparecen casi simult√°neamente. De Google - VP9, ‚Äã‚Äãde MPEG - H.265. Junto a H.265 hay un nuevo est√°ndar de imagen llamado HEIF. No es compatible con navegadores, ni uno en absoluto. Pero es compatible con sus dispositivos Apple. El est√°ndar HEIF es incre√≠blemente interesante, porque es solo una abstracci√≥n de esta idea. En un contenedor HEIF, puede introducir fotogramas clave desde casi cualquier c√≥dec. Es decir, VP8 no es un formato moderno. Pero HEIF es moderno.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© pasa despu√©s? Ahora en una organizaci√≥n muy grande, que incluye Mozilla y Google, se est√° recortando un c√≥dec de video llamado AV1. La organizaci√≥n se llama Alliance for Open Media. La calidad del video AV1 es muchas veces mayor que todo lo que era antes. Es libre, es libre de regal√≠as, es muy genial. Tenemos un buen contenedor HEIF. Todo lo que nos queda es empujar el fotograma clave AV1 en √©l. Y ya est√° hecho. El nuevo formato para insertar el fotograma clave AV1 en un contenedor HEIF se llama AVIF. Esto es lo que nos espera en el futuro. Tal vez alg√∫n d√≠a lo usaremos de forma nativa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero podemos usarlo ahora. Acabamos de poner un fotograma del video en la p√°gina y decimos: voila, tienes una foto.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/k0/cm/jqk0cmtzq6oafsae-uvllieobks.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo se hace esto en webp? WebP es, como dije, un fotograma clave VP8 empaquetado en un contenedor llamado riff. Hay un encabezado en el contenedor de riff. All√≠, no lo creas, est√° escrito que esto es WebP. ¬øQui√©n dudar√≠a de eso? PNG dice que es PNG WebP, y ah√≠ est√°.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero WebP tiene una caracter√≠stica interesante: el fotograma clave VP8 puede estar dentro de √©l, y esto es lo que generalmente se llama WebP. Pero el fotograma clave VP8 puede no serlo. En general, WebP admite compresi√≥n sin p√©rdidas. WebP sin p√©rdida es un formato completamente diferente que no tiene nada que ver con VP8, compresi√≥n con p√©rdida, etc. Por lo tanto, cuando alguien le dice que WebP es m√°s efectivo que otra cosa, la primera pregunta es qu√© WebP algo? Porque si hablamos de compresi√≥n sin p√©rdidas, entonces hay un pasillo natural al que podemos esforzarnos. Estas diferencias, "60% m√°s efectivas que ...", son m√°s probables no sin p√©rdidas, sino WebP con p√©rdidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien, suficiente teor√≠a, harto de eso, veamos algo ya. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/y3/5q/ut/y35qutrwbylxwzjo_dj17alkys8.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comencemos con esto. Tomamos una foto tomada por una c√°mara profesional. Recorta una pieza de 1000 por 1000 p√≠xeles de ella. Esto, por cierto, se ve muy bien en el proyector. Comenzamos a considerar peque√±os detalles. Al mismo tiempo, comprimimos esta pieza para obtener exactamente 15 kilobytes. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Vea lo que sucede. JPEG cay√≥ en bloques de inmediato. De hecho, baja calidad, esper√°bamos esto. </font><font style="vertical-align: inherit;">
As√≠ es como se ve WebP. Tambi√©n cay√≥ en bloques, pero estos bloques no son tan claramente visibles. Cuando usa el codificador WebP y lo controla con sus manos, puede controlar la fuerza del filtro que se usa en WebP. Y si desenrosca este filtro con m√°s fuerza, puede deshacerse de una gran cantidad de artefactos de bloque. Por lo tanto, puramente te√≥ricamente, estos bloques tambi√©n se pueden eliminar.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/9q/c_/jp/9qc_jpasvkhbwiz3zjpxhsgsgji.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y aqu√≠ est√° AV1. Solo admiremos en silencio. Mira lo genial que es. AV1 es compatible con Firefox, en Chrome, por lo que puede usar el video AV1 en lugar de una imagen si de repente lo desea. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Hay un spoiler, en vano lo agregu√©. La situaci√≥n cuando PNG derrota a WebP. S√≠, PNG en este caso es m√°s efectivo que WebP. Esto se debe a que us√© WebP con p√©rdida. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
¬øQu√© hice con el peengeshka? Hice el modo de color indexado, es decir, cort√© la paleta, en mi opini√≥n, a 16 colores. Es bastante efectivo para una imagen en blanco y negro. Result√≥ bien, se contrajo mucho. Para WebP con p√©rdida de calidad, tenemos un tama√±o m√°s grande. Sin embargo, para sin p√©rdidas, esto se espera, es m√°s eficiente que peengeshka. Tenemos una victoria</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/z5/5e/bs/z55ebsmfycy45l6beelixuwfz2k.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/cl/yu/ua/clyuuarpr6mv6byxk2x_wlya7z4.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resumo Las punzadas empotradas muy geniales pueden vencer los formatos de compresi√≥n con p√©rdida y no derrotar a WebP sin p√©rdida. Tristemente, tristemente. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Quiz√°s te atormente la pregunta: ¬øpor qu√© haces esto? ¬øSabemos qu√© es SVG? Y lo s√©, pero para algunos tama√±os, PNG es m√°s eficiente. Esta imagen resulta ser m√°s efectiva que SVG para tama√±os como 200 por 200. Luego, SVG, por supuesto, gana. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Ahora echemos un vistazo a Mike. √âste es Mike. Sus dimensiones son de 3000 por 3000 p√≠xeles. JPEG vs WebP. Era obvio aqu√≠ que JPEG estaba ganando. Pero en este caso, obtuve aproximadamente un seis por ciento de victoria por aproximadamente la misma calidad visual. Esta es una caracter√≠stica de la foto y c√≥mo prepar√© esta foto. Entonces puedes preguntarme c√≥mo lo hice.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/mk/br/bx/mkbrbxyyxxkfbft-22mssst0thk.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/io/5j/lq/io5jlqupl72tvqohsbyd0qqowmm.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/y2/0y/a_/y20ya_ybbu1hlmeqsp_b7ii3iv8.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se puede hacer clic.</font></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A√∫n as√≠, todo depende en gran medida de los par√°metros del codificador. Si se esfuerza mucho y desenrosca los par√°metros del codificador de una manera especial, JPEG comenzar√° a derrotar a WebP en tama√±o para la misma calidad visual. Me gustar√≠a concluir que los gatos se encogen mejor que JPEG, pero no. Este es solo un ejemplo de c√≥mo puede desenroscarlo de la manera que desee si lo desea.</font><b><sup><sub><font style="vertical-align: inherit;"> Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Esto es de muy baja calidad. JPEG est√° cayendo en bloques. Esto es especialmente evidente en el proyector: la nariz se volvi√≥ azul al perro, se volvi√≥ cuadrada. WebP no est√° tan enfermo. Todo parece ser genial y bueno, pero la cuesti√≥n es que, para cualidades muy, muy bajas, WebP proporciona aproximadamente dos, o quiz√°s tres veces el tama√±o del archivo que JPEG. As√≠ que aqu√≠ tambi√©n debes pensar qu√© calidad quieres.</font><b><sup><sub><font style="vertical-align: inherit;"> Clickable</font></sub></sup></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/3g/hr/06/3ghr06olqwqeom_ru2i0xvlki-u.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/9q/-f/xp/9q-fxpk1zj_xq3yjvdunqa2trrm.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta es la comparaci√≥n m√°s honesta. Entonces tienes que comparar, porque H.264 y WebP son similares. ¬øQui√©n crees que gan√≥ aqu√≠? H.264. Pero para ser sincero, el experimento no fue del todo limpio. En el buen sentido, tanto en WebP como en H.264, el cuadro de video es aproximadamente inequ√≠voco. </font><b><sup><sub><font style="vertical-align: inherit;">Se puede hacer clic</font></sub></sup></b><font style="vertical-align: inherit;"> 
Pero con AV1, todo est√° absolutamente claro. Treinta por ciento gana con la misma calidad visual. ¬°Hurra! </font><font style="vertical-align: inherit;">
Se puede hacer </font><b><sup><sub><font style="vertical-align: inherit;">clic en</font></sub></sup></b><font style="vertical-align: inherit;"> Es muy importante comprender qu√© tipo de imagen coloca y c√≥mo responde este o aquel formato a la calidad de la imagen. Aqu√≠ el perro en formato WebP pesa 79 kilobytes en calidad como aproximadamente el 75% frente a 56 kilobytes en JPEG. ¬øPor qu√© est√° pasando esto?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/zn/yd/1u/znyd1unstrzgknbpbc_3w_flga0.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/gg/b9/pf/ggb9pfrw4c1vcjdjeb1g8qeyeum.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debido a que no hay un solo c√≥dec de video, ni un solo formato puede comprimir correctamente el ruido. Si su imagen tiene muchas distorsiones tan agudas, puntos y algo m√°s, lo m√°s probable es que tenga problemas con la compresi√≥n. Si puede tomar alguna otra foto y eliminar este ruido, elim√≠nelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, las im√°genes son algo complicado. ¬øPueden ralentizar su interfaz? Una pregunta importante y buena. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/ss/ux/wqssux2vgg3zjhog3chbctkuwxy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Respuesta: muy probablemente no. ¬øPor qu√© sucede? Porque cuando la imagen se decodifica, sucede en una secuencia separada. Pero hay una excepci√≥n: si dibuja algo en el lienzo, debe recordar que la decodificaci√≥n de la imagen se producir√° en la transmisi√≥n principal y que los botones no se pueden presionar en ese momento.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yb/3-/x3/yb3-x3j8yz_y4lpg9i-zwlwhbjm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si realmente quiere hacer un trato, abra Chrome, busque los hilos rasterizados correspondientes y el evento Image Decode, lo encontrar√°. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cz/hi/na/czhinaou_xikxzzjk8i_kzdvx3u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tiene mucha, mucha curiosidad, puede ir a la pesta√±a de seguimiento y ver all√≠ con detalles lo que sucede al decodificar una imagen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herramientas de optimizaci√≥n </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo m√°s importante son las herramientas de optimizaci√≥n. Ahora sabemos m√°s o menos lo que queremos. Queda por entender c√≥mo hacemos esto. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w5/o9/s1/w5o9s1vjdbzscsb_tr513umrqbu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La herramienta de optimizaci√≥n de imagen m√°s importante es el dise√±ador, no importa cu√°n extra√±o suene. Solo esta persona maravillosa sabe qu√© problema quieres resolver con √©l. No agregamos im√°genes a las p√°ginas para optimizarlas, sino para impresionar a los usuarios. Para mantener un equilibrio entre el grado de optimizaci√≥n y la experiencia del usuario, use un dise√±ador que ayude mucho. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dm/da/rj/dmdarj1ouin679hqaw075cozmiw.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enlace de la diapositiva La</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
segunda herramienta es nuestro c√≥digo abierto marciano, del que promet√≠ hablar. Esta cosa se llama imgproxy y resuelve todos nuestros problemas en general. En mis proyectos solo uso imgproxy, esta cosa puede hacer casi todo lo que quiero.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ex/9a/fz/ex9afzkiiywmkkknxjrndj4svhs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo funciona? ¬øTienes alg√∫n deseo para la foto? Desea una imagen de cierto tama√±o con una cierta optimizaci√≥n. Y en alg√∫n lugar lejano tiene una imagen de cualquier resoluci√≥n, tal vez en la computadora local, o tal vez en alg√∫n lugar del usuario o en general en cualquier lugar. Solo necesita crear una url especial y pedirle a imgproxy que cambie el tama√±o de su imagen. Este es un servicio de este tipo, puede estar en la nube o en otro lugar. Es decir, ten√≠as un gato enorme, env√≠as una URL especial a imgproxy. √âl hace todo lo que quieras sobre la marcha.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/de/9x/up/de9xupjotbsna-qdrecbjjixlz4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si eso no suena claro, veamos c√≥mo se ve la solicitud de imgproxy. Primero, necesita decir d√≥nde se encuentra imgproxy. En segundo lugar, si no desea ser absorbido agresivamente, entonces la URL que est√° solicitando ser√≠a buena para firmar digitalmente. No puede hacer esto, esto es solo una medida adicional de protecci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, si desea cambiar el tama√±o, directamente en la url pase los par√°metros de cambio de tama√±o. Si desea optimizar, lo mismo. Solo necesita transferir la direcci√≥n original de su imagen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iq/ij/zq/iqijzqvjy98twszsumxw5j-g_ds.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si desea optimizaciones manuales, hay un gran conjunto de herramientas. No los describir√© a todos ahora. Los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">materiales</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para el informe, que le enviar√©, lo tienen todo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sm/gb/1v/smgb1vvmd2kwmpgmtivk2var9dy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ est√° lo m√°s genial y √∫til. </font><font style="vertical-align: inherit;">Estas todas las im√°genes no son tan complicadas. </font><font style="vertical-align: inherit;">Creo que logr√© transmitirte esto. </font><font style="vertical-align: inherit;">Si est√° interesado, tome su lenguaje de programaci√≥n favorito, probablemente JavaScript, aunque lejos de ser un hecho, y comience a resolverlo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si desea hacer esto en un navegador, por favor. </font><font style="vertical-align: inherit;">Probablemente necesite un enlace que probablemente est√© escrito en m√°s o en C. Pero, ¬øqu√© le impide compilar todo esto en WebAssembly? </font><font style="vertical-align: inherit;">Hay una aplicaci√≥n genial llamada Squoosh. </font><font style="vertical-align: inherit;">Hace exactamente eso. </font><font style="vertical-align: inherit;">Usted tambi√©n puede, intente, ser√° genial. </font><font style="vertical-align: inherit;">De verdad me gusta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias a todos por su atenci√≥n. </font><font style="vertical-align: inherit;">Materiales para el informe - por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">referencia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es493598/index.html">Ocultar parte del n√∫mero de tel√©fono</a></li>
<li><a href="../es493604/index.html">Eventos digitales en Mosc√∫ del 23 al 29 de marzo</a></li>
<li><a href="../es493606/index.html">La historia de la creaci√≥n de un servicio en la nube con sabor a cyberpunk</a></li>
<li><a href="../es493610/index.html">Programando una capa de video en una Raspberry Pi usando la API DispmanX</a></li>
<li><a href="../es493614/index.html">Detecta COVID-19 en rayos X con Keras, TensorFlow y Deep Learning</a></li>
<li><a href="../es493618/index.html">(No) OSINT obvio en Twitter</a></li>
<li><a href="../es493620/index.html">Curva log√≠stica ¬øCu√°ndo terminar√° la epidemia?</a></li>
<li><a href="../es493622/index.html">Escribir un Retrowave a Angular</a></li>
<li><a href="../es493626/index.html">Selenoide: cientos de pruebas de IU paralelas f√°ciles y r√°pidas. Pavel Senin</a></li>
<li><a href="../es493630/index.html">Reenv√≠o de puertos USB desde Windows 10 para trabajo remoto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>