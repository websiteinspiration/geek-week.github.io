<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖖🏽 🐮 🛌 Reduzierung der React Native-Anwendungsgröße um 60% in wenigen einfachen Schritten 🏥 💅 🤷🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich arbeite bei Mutual . Sie arbeitet in Brasilien im Bereich der Gleichberechtigung. Wir helfen Kreditnehmern und Kreditgebern, sich miteinander zu v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Reduzierung der React Native-Anwendungsgröße um 60% in wenigen einfachen Schritten</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/502422/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich arbeite bei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mutual</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sie arbeitet in Brasilien im Bereich der Gleichberechtigung. </font><font style="vertical-align: inherit;">Wir helfen Kreditnehmern und Kreditgebern, sich miteinander zu verbinden. </font><font style="vertical-align: inherit;">Die ersteren streben nach guten Wetten, während die letzteren ein Einkommen anstreben, das über dem liegt, was der Markt ihnen bieten kann. </font><font style="vertical-align: inherit;">Unser Produkt wird von einer Vielzahl von Anwendern verwendet, wir arbeiten in einem großen Land. </font><font style="vertical-align: inherit;">Infolgedessen werden unsere auf React Native basierenden iOS- und Android-Apps auf sehr unterschiedliche Geräte heruntergeladen.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/59/3g/lf/593glf1nnlud4u0pbaogbghegiy.jpeg"></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu beachten, dass der Großteil unserer Benutzer Anwendungen auf Budgetgeräten installiert. </font><font style="vertical-align: inherit;">Wir können solche Schlussfolgerungen aus den Daten aus der Facebook- </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Geräteklassenbibliothek ziehen</font></a><font style="vertical-align: inherit;"> .</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Diese Bibliothek, die Informationen über das Modell des Geräts erhalten hat, berichtet, in welchem ​​Jahr dieses Gerät als gehobenes Flaggschiff-Telefon gelten würde. </font><font style="vertical-align: inherit;">Das beliebteste Telefon unter unseren Nutzern ist beispielsweise das Samsung Galaxy A10. </font><font style="vertical-align: inherit;">Obwohl dieses Telefon im Jahr 2019 veröffentlicht wurde, konnte es erst 2013 als Flaggschiff angesehen werden. Bei der Analyse von Daten auf Benutzergeräten können wir sagen, dass 85% dieser Geräte erst 2015 oder früher als High-End-Geräte erkannt werden konnten. </font><font style="vertical-align: inherit;">Aus diesem Grund haben wir spezielle Anforderungen an die Optimierung unserer mobilen Anwendung. </font><font style="vertical-align: inherit;">Ziel der Optimierung ist es, dass auch Benutzer mit schwachen Geräten unsere Anwendung bequem nutzen können.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e2/e6b/cf3/1e2e6bcf354e0ed85e47f70b1570dbba.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prozentsatz der Geräte, die in einem bestimmten Jahr als Flaggschiff erkannt werden konnten</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Zusammenhang haben wir genau auf die Größe der Anwendung geachtet. Bei der Android-Version waren es 26,8 MB. Obwohl dies keine so große Größe ist, ist es definitiv mehr als die mittlere Größe der Anwendungen unserer Benutzer. Diese Zahl beträgt laut Google Play Console 16,3 MB. Die Größe der Anwendung kann ein entscheidender Faktor für Benutzer mit begrenzten Tarifplänen oder für Benutzer mit Geräten mit wenig Speicher sein, wodurch Benutzer gezwungen sind, die von ihnen installierten Anwendungen sorgfältig auszuwählen. Daher müssen einige Anwendungen deinstalliert werden. Dies ist besonders wichtig im Fall des Antrags auf Gegenseitigkeit, da die Kreditnehmer über diesen Antrag monatliche Raten zahlen. Wenn der Kreditnehmer unsere Anwendung deinstalliert, verringert sich die Wahrscheinlichkeit, dass er die Zahlung pünktlich leistet, erheblich.Dies wirkt sich direkt auf die Gewinne der Anleger aus, die unsere Plattform nutzen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/72c/cea/78e/72ccea78ee7c05e86b626c0cf6ea45ef.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Größe der gegenseitigen Anwendung ist viel größer als die mittlere Größe der</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Anwendungen</font><i><font color="#999999"><font style="vertical-align: inherit;"> unserer Benutzer</font></font></i><font style="vertical-align: inherit;"> . Die Größe der Anwendung wirkt sich nicht nur auf den Grad der Deinstallation aus. Die Größe wirkt sich auch auf die Conversion-Rate der Anwendungseinstellungen aus.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hier ist ein</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> guter Artikel dazu, der vom Google Play-Team verfasst wurde. Dieser Artikel beschreibt die Bedeutung der Anwendungsgröße. Insbesondere heißt es, dass jede weiteren 6 MB der Größe der APK-Datei die Konvertierungsrate von Installationen um 1% reduziert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie sprechen auch über die Tatsache, dass in Entwicklungsländern, in denen Haushaltsgeräte die Norm sind, dieser Effekt noch stärker ist. Die Reduzierung der Größe der APK-Datei um 10 MB in Schwellenländern entspricht einer Erhöhung der Konvertierungsrate von Installationen um etwa 2,5%.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c1/624/15d/1c162415de7e88ff4c5ed89853b6483b.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erhöhung der Conversion-Rate von Installationen pro 10 MB Reduzierung der Größe der APK-Datei in verschiedenen Ländern (laut internen Daten von Google)</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir waren sehr motiviert, wie sich die Reduzierung der Größe der Anwendung auf den Grad der Deinstallation und die Conversion-Rate der Anwendungseinstellungen auswirken kann. </font><font style="vertical-align: inherit;">Aus diesem Grund haben wir uns daran gemacht, die Größe der Anwendung so weit wie möglich zu reduzieren und dabei die Benutzerfreundlichkeit zu berücksichtigen. </font><font style="vertical-align: inherit;">Der erste Schritt in diesem Projekt war die Analyse der offiziellen</font><font style="vertical-align: inherit;">Google-</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Empfehlungen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für Android-Entwickler.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android App Bundle</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Lesen der Empfehlungen haben wir festgestellt, dass der einfachste Weg, die Größe einer Anwendung zu reduzieren, die Verwendung einer neuen Anwendungsverteilungsmethode namens </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android App Bundle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (AAB) ist. Bis zu diesem Moment haben wir die Anwendung verteilt, die gute alte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android-Paketdatei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (APK) </font><font style="vertical-align: inherit;">gesammelt </font><font style="vertical-align: inherit;">, die auf den meisten Android-Geräten ausgeführt werden kann, und sie auf die Google Play Console hochgeladen. Das AAB-Bundle enthält jedoch nur kompilierten Code und Ressourcen. Daher ist Google beim Herunterladen dafür verantwortlich, optimierte APK-Dateien für verschiedene Gerätetypen unter Berücksichtigung ihrer Spezifikationen und der CPU-Architektur zu generieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass wir durch eine einfache Änderung des Erstellungsprozesses des Projekts die Größe der Anwendung ernsthaft reduzieren können, ohne weitere Anstrengungen zu unternehmen. Das ist zu gut für die Wahrheit! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir die Dokumentation zu </font><font style="vertical-align: inherit;">lesen, wir das Reagieren india Gradle Build - </font><font style="vertical-align: inherit;">Skript nur geändert , </font><font style="vertical-align: inherit;">so dass es </font></font><code>assembleRelease</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laufen würde , </font><font style="vertical-align: inherit;">statt der aktuellen </font><font style="vertical-align: inherit;">ein </font></font><code>bundleRelease</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Das ist alles, was wir zum Erstellen der AAB-Datei benötigen. Nach einigen weiteren Änderungen an der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Fastlane-</font></a></font><code>supply</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konfiguration </font><font style="vertical-align: inherit;">bezüglich des automatischen Hochladens von Materialien direkt in den Play Store sind wir zu AAB gewechselt, und eine neue Version unserer Anwendung wurde in der Google Play Console angezeigt.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Änderung allein hat zu einer Verringerung der Größe der auf Benutzergeräte übertragenen APK-Dateien geführt. Der Rückgang lag zwischen 9,1 und 12,4 MB. Wie sich herausstellte, ist die Verwendung des Android App Bundle eine effektive Technik, mit der Sie die Größe der Anwendung reduzieren können.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e5/feb/57b/9e5feb57bf54450425a6dc54da48f613.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die alte APK-Datei und das neue AAB-Bundle, deren Verwendung dazu führt, dass die Größe der Anwendung auf verschiedenen Geräten zwischen 14,4 und 17,7 MB liegen kann.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Richtig, hier sollten Sie vorsichtig sein. </font><font style="vertical-align: inherit;">Wenn Sie React Native mit</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hermes verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , müssen Sie möglicherweise Ihre Abhängigkeit aktualisieren</font></font><code>soloader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(siehe Details</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Andernfalls besteht die Gefahr, dass der Benutzer eine Anwendung erhält, die einen kritischen Fehler enthält. </font><font style="vertical-align: inherit;">Wir hatten Glück, dass wir dieses Problem beim Testen der Alpha-Version des Projekts identifizieren konnten. </font><font style="vertical-align: inherit;">Der Fehler kann jedoch leicht in die Produktion übergehen, da er beim lokalen Testen oder beim Erstellen der APK-Datei nicht auftritt.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimieren von Anwendungsressourcen mit Android Size Analyzer</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der nächste Vorschlag zur Optimierung von Anwendungen, den wir in der Dokumentation gefunden haben, war die Verwendung von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android Size Analyzer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies ist ein Befehlszeilentool, das Android-Anwendungen analysiert und nach Möglichkeiten sucht, ihre Größe zu reduzieren. </font><font style="vertical-align: inherit;">Wir haben dieses Tool mit einem Befehl der folgenden Form gestartet:</font></font><br>
<br>
<pre><code class="javascript hljs">size-analyzer check-bundle [BUNDLE].aab
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis haben wir eine Liste großartiger Anwendungsressourcen und Bilder erhalten, die wir optimieren können. </font><font style="vertical-align: inherit;">Es wurde uns auch empfohlen, ProGuard einzurichten.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed0/a26/0b0/ed0a260b0a19878cf664c53ec54c9026.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Größenanalysatorbericht</font></font></font></i><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RoProGuard</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ProGuard ist ein Tool zum Komprimieren, Verschleiern und Optimieren von Java-Bytecode. </font><font style="vertical-align: inherit;">Wir haben die Möglichkeit der Verwendung dieses Tools noch nicht untersucht, da wir erfahren haben, dass es möglicherweise nicht mit einigen Android-Bibliotheken kompatibel ist. </font><font style="vertical-align: inherit;">Da wir uns bemüht haben, die Größe unserer Anwendung so schnell wie möglich zu reduzieren und dies so einfach wie möglich zu gestalten, haben wir uns entschlossen, diese Optimierungsmethode in Zukunft beizubehalten.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍Große App-Ressourcen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie es </font></font><code>size-analyzer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem Schlüssel erneut </font><font style="vertical-align: inherit;">ausführen, erhalten Sie </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Liste der Anwendungsressourcen, sortiert nach ihrer Größe. </font><font style="vertical-align: inherit;">Da dieses Tool nichts darüber weiß, wie Benutzer mit der Anwendung arbeiten, konnten wir unabhängig entscheiden, welche Ressourcen entfernt und welche dynamisch in die Anwendung geladen werden sollen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/900/d84/262/900d84262161b1440fe03e0d8b0d4fab.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste der großen Anwendungsressourcen, sortiert nach Größe</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Die erste und größte Ressource in dieser Liste war das React Native JavaScript-Bundle. </font><font style="vertical-align: inherit;">Jetzt können wir dieses Bundle nicht mehr teilen und dynamisch laden. </font><font style="vertical-align: inherit;">Aber später werden wir darüber nachdenken. </font><font style="vertical-align: inherit;">Weiter unten in der Liste befinden sich große Schriftdateien (TTF) und Bilddateien (JPG und PNG).</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍Notwendige Bilder</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Aufmerksamkeit wurde sofort auf die riesigen JPG-Bilder gelenkt, die im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Storybook verwendet wurden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir verwenden dieses System, um Komponenten zu entwickeln und zu testen. </font><font style="vertical-align: inherit;">Dies sind 2 MB Müll, der in die Produktionsversion des Projekts gefallen ist. </font><font style="vertical-align: inherit;">Schändlicher Fehler! </font><font style="vertical-align: inherit;">Wenn so etwas passiert, haben wir das Gefühl, ernsthafte Dummheit getan zu haben. </font><font style="vertical-align: inherit;">In der komplexen Welt der Softwareentwicklung macht jeder Fehler. </font><font style="vertical-align: inherit;">Ich glaube, wenn Sie öffentlich über Ihre Fehler sprechen, wird dies anderen Entwicklern helfen, aus diesen Fehlern zu lernen. </font><font style="vertical-align: inherit;">Es besteht die Möglichkeit, dass Sie dieselben Fehler machen, wenn Sie die Ressourcenstruktur der Anwendung nicht analysieren, deren Größe allmählich zunimmt.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Schriftarten</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir unnötige Bilder schnell entfernt hatten, analysierten wir andere Elemente der Ressourcenliste. Es war klar, dass es viele eingebaute Schriftarten gab. Nachdem wir mit unseren Designern darüber gesprochen hatten, sagten sie uns, dass sich viele alte Komponenten nicht in der strikten Einhaltung typografischer Handbücher unterscheiden. Daher haben wir herausgefunden, welche Komponenten entfernt werden können und in welchen Sie die entsprechenden aktualisierten Schriftarten verwenden können. Dank dessen konnten wir die Anzahl der verwendeten Schriftarten von sechs auf vier reduzieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine andere Sache, die uns aufgefallen ist, war die schiere Größe der Schriftdateien selbst. Die Größe von jedem von ihnen betrug ungefähr 670 Kb. Dies bedeutet, dass vier Schriftarten im unkomprimierten Bundle beeindruckende 2,7 MB belegen. Glücklicherweise gibt es ein Tool namens </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FontForge</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mit dem Sie Schriftdateien gründlich analysieren und ändern können. Mit diesem Tool konnten wir herausfinden, dass der Hauptgrund für die große Größe von Schriftdateien erweiterte kyrillische Zeichen und unnötige Glyphen sind. Wir könnten all dies sicher entfernen, da der Textteil unserer Bewerbung vollständig in Portugiesisch verfasst ist. Dank dieser Änderung konnten wir die Größe der Schriftdateien von 670 KB auf 70 KB reduzieren - um 90%.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d0/144/f9c/7d0144f9c3954dee6570347075fbe392.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiele für einige Glyphen in unseren Schriftarten.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Aufgrund der Tatsache, dass wir unnötige Schriftarten entfernt und die verbleibenden optimiert haben, konnten wir die Anwendungsgröße um 3,8 MB reduzieren. </font><font style="vertical-align: inherit;">Dies führte zu einer angenehmen Reduzierung der Gesamtgröße der APK-Datei um 2 MB.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52b/62c/a55/52b62ca55ea0178919421a1c08304adc.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste der Schriftarten und ihrer Größen vor der Optimierung</font></font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/83e/374/6db/83e3746db754c475501170c6e4372c49.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste der Schriftarten und ihrer Größen nach der Optimierung</font></font></font></i><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍Optimierung von Bildern</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Analyse der Bilder, die noch in der Anwendung verblieben sind, haben wir festgestellt, dass einige davon ziemlich groß sind. </font><font style="vertical-align: inherit;">Wir haben mehrere dieser Bilder mit dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TinyPNG-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Grafikoptimierungstool verarbeitet </font><font style="vertical-align: inherit;">und </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">festgestellt, dass</font></a><font style="vertical-align: inherit;"> die Größe dieser Bilder erheblich reduziert wurde. </font><font style="vertical-align: inherit;">Danach haben wir beschlossen, alle in der Anwendung verwendeten JPG- und PNG-Bilder zu optimieren. </font><font style="vertical-align: inherit;">Es waren 41 von ihnen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa5/8e9/9e6/aa58e99e6307077787f37d0d60fc59db.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bild vor und nach der Optimierung</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dies gab uns die Möglichkeit, die Größe von Bildern von 2,5 MB auf 756 KB zu reduzieren, dh um 70%. </font><font style="vertical-align: inherit;">Aufgrund der Tatsache, dass die Bilder zuvor nicht optimiert wurden, wurden sie jedoch bei der Erstellung der endgültigen APK-Datei komprimiert. </font><font style="vertical-align: inherit;">Es stellte sich heraus, dass unsere Optimierung zu einer Verringerung der Größe der vom Benutzer heruntergeladenen Anwendung um nur 500 KB führte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach stellten wir fest, dass wir bereits alle Möglichkeiten einer schnellen Optimierung ausgeschöpft hatten. </font><font style="vertical-align: inherit;">Die weitere Optimierung der Ressourcen würde entweder große Anstrengungen oder nur geringfügige Verbesserungen erfordern.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reagieren Sie auf die native JavaScript-Bundle-Optimierung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir die für die Android-Plattform spezifischen Anwendungsressourcen ermittelt haben, ist es Zeit, das JavaScript-Bundle zu analysieren. </font><font style="vertical-align: inherit;">Die Bundle-Optimierung kann aus drei Gründen als gute Idee angesehen werden. </font><font style="vertical-align: inherit;">Erstens wird die Größe der fertigen APK-Datei reduziert. </font><font style="vertical-align: inherit;">Zweitens führt dies zu einem schnelleren Start der Anwendung, da die virtuelle JS-Maschine weniger Code verarbeiten muss. </font><font style="vertical-align: inherit;">Schließlich und vor allem beschleunigt es die OTA-Updates, die wir mehrmals pro Woche mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodePush durchführen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Bundle-Analysator und Code-Optimierung</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um eine Entscheidung darüber zu treffen, wie die Größe des Bundles reduziert werden soll, mussten Sie zunächst herausfinden, was den größten Platz im Bundle einnimmt. Zu diesem Zweck haben wir das hervorragende Open-Source-Tool </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React-Native-Bundle-Visualizer verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nachdem wir das Projekt mit seiner Hilfe analysiert hatten, erhielten wir eine Visualisierung, in der jeder Ordner und jede Anwendungsabhängigkeit vorhanden war und die Größe der entsprechenden Entitäten angab.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f2/641/4c0/7f26414c02bec1a7cf7bcd6b901fb837.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Momentaufnahme der Bibliotheken und Ordner der Codebasis des Frontends der Gegenseitigen Anwendung mit der Größenangabe</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben festgestellt, dass die Gesamtgröße des Bundles 5,49 MB beträgt. 57,8% dieses Volumens werden durch Abhängigkeiten aus dem Ordner dargestellt</font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 27,5% - Anwendungscode. Was bleibt, konnte das von uns verwendete Tool nicht identifiziert werden. Während des Assemblierungsprozesses des Bundles wurde nicht verwendeter Code bereits gelöscht. Wir haben also Code gesehen, der tatsächlich von der Anwendung verwendet wird. Aber selbst wenn man dies berücksichtigt, kann man im Bundle immer etwas finden, das verbessert werden kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die größte Projektabhängigkeit ist</font></font><code>math.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Diese Bibliothek implementiert, wie der Name schon sagt, viele mathematische Operationen. Wir haben keinen besonderen Bedarf an dieser Bibliothek, da wir alle wichtigen Berechnungen auf dem Server durchführen und anschließend die Ergebnisse einfach an die Anwendung senden. Beim Betrachten des Anwendungscodes stellte sich heraus, dass die Bibliothek nur zur Ausführung einiger einfacher Vorgänge verwendet wird. Es wurde höchstwahrscheinlich von einem Entwickler verwendet, der nur aus Gewohnheit an Servercode arbeitete. Wir haben schnell die entsprechenden Methoden aus der Bibliothek extrahiert und in unsere Codebasis integriert, um diese Abhängigkeit vollständig zu beseitigen. Dadurch konnte die Größe des Bundles auf 4,64 MB reduziert werden. Durch die Ablehnung nur einer Bibliothek konnte die Größe des Bundles um 15,5% reduziert werden!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie bereits erwähnt, verwenden wir das Storybook, um Komponenten zu entwickeln und zu testen. Die entsprechenden Funktionen sollten nur in lokalen und Zwischenumgebungen verfügbar sein. Endbenutzer benötigen dies nicht. Dank dessen haben wir die Variable verwendet </font></font><code>ENVIRONMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um die Aufnahme des entsprechenden Teils der Anwendung zu steuern. Obwohl dies zur Einschränkung des Zugriffs geeignet ist, kann der Bundler nicht wissen, welcher Wert in diese Variable geschrieben wird. Aufgrund dieser Einschränkung fiel der gesamte Storybook-Code in das Produktionspaket.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das Problem zu beheben, haben wir den Import dieses Abschnitts in einer einzigen Datei isoliert. Dann haben wir zwei Versionen dieser Datei erstellt: eine mit dem Storybook und eine für die Produktion, die nur das Komponentenlayout enthält. Um bei der Vorbereitung der Produktionsversion des Bundles zwischen diesen Dateien zu wechseln, haben wir ein Skript geschrieben, das ausgeführt wird, bevor das Projekt erstellt wird, und eine Datei in eine andere ändert. Dank dieser Methode konnten wir den Storybook-Code vollständig aus der Produktionsversion der Anwendung entfernen und sowohl die Abhängigkeit </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">als auch den üblichen Code für die Konfiguration von Storybook-Storys </font><font style="vertical-align: inherit;">entfernen </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/996/4cc/276/9964cc2769a8a23b3b18d5b0d273cfd9.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Storybook-Ordner wurde mit zwei Versionen der Indexdatei aktualisiert. Durch</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
diese beiden Änderungen wurde die Bundle-Größe von 5,49 MB auf 4,2 MB reduziert. </font><font style="vertical-align: inherit;">Dies bedeutet unter anderem, dass die Anwendung schneller geladen und schneller aktualisiert wird.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/034/06f/f53/03406ff53c8a918119c9febd41e6d752.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Größe des endgültigen Bundles betrug 4,2 MB.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nach all diesen Verbesserungen haben wir die Anwendung erneut im Play Store heruntergeladen. </font><font style="vertical-align: inherit;">Nun wurde uns mitgeteilt, dass die Größe der fertigen APK-Datei im Bereich von 10,5 bis 13,7 MB liegen wird. </font><font style="vertical-align: inherit;">Dies bedeutet angesichts der Tatsache, dass die Anwendung ursprünglich eine Größe von 26,8 MB hatte, einfach eine unglaubliche Reduzierung der Projektgröße um etwa 60%! </font><font style="vertical-align: inherit;">Wie wir in einem Artikel des Google Play-Teams gesagt haben, können wir also davon ausgehen, dass die Conversion-Rate von Installationen um 3,75% steigen wird.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/715/69e/cec/71569ececb25a15225a48cef54bfb254.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleich der ursprünglichen APK-Version der Anwendung mit der endgültigen AAB-Version, in der alle oben beschriebenen Verbesserungen vorgenommen wurden</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir als geschäftsorientierte Programmierer wissen, dass Unternehmen im Interesse einer schnelleren Entwicklung eines Projekts manchmal ihre technische Verschuldung erhöhen können. </font><font style="vertical-align: inherit;">Dies gilt insbesondere für junge Startups wie Mutual, die versuchen, ihren Platz auf dem Markt zu finden. </font><font style="vertical-align: inherit;">Wenn Sie diese Schulden jedoch nicht beachten, können Sie ärgerliche Fehler machen, z. B. das Senden von 2 MB Testbildern an die Produktion und die ungerechtfertigte Verwendung einer riesigen Bibliothek. </font><font style="vertical-align: inherit;">Technische Schulden sollten nicht außer Kontrolle geraten und Probleme verursachen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus kommt es häufig vor, dass Entwickler die ihnen zur Verfügung stehenden Möglichkeiten zur Optimierung von Projekten einfach verpassen. </font><font style="vertical-align: inherit;">Daher wird manchmal empfohlen, Ihre Projekte kritisch zu analysieren. </font><font style="vertical-align: inherit;">Nur um zu überprüfen, ob Sie eine Gelegenheit verpasst haben, die Größe, Geschwindigkeit oder einen anderen Aspekt der Anwendung schnell zu optimieren. </font><font style="vertical-align: inherit;">Wir haben nur zwei Tage gebraucht, um die Anwendung zu analysieren, die Arbeit zu planen und das Projekt zu verbessern, wodurch wir die Größe der Anwendung um 60% reduzieren konnten. </font><font style="vertical-align: inherit;">Es ist schwierig, etwas anderes zu finden, das in so kurzer Zeit die gleichen Ergebnisse erzielen kann. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie optimieren Sie Ihre React Native-Projekte?</font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de502412/index.html">Guilloche auf eine andere Art und Weise</a></li>
<li><a href="../de502414/index.html">FOSS News Nr. 16 - eine Überprüfung der freien und Open-Source-Software für den 11. bis 17. Mai 2020</a></li>
<li><a href="../de502416/index.html">SQL ergänzen. Teil 1. Die Komplexität des Parsens. Geschichten zum Finalisieren der ANTLR-Datei</a></li>
<li><a href="../de502418/index.html">3D-Bildmonitor</a></li>
<li><a href="../de502420/index.html">Interessante CSS-Funde im Twitter-Design</a></li>
<li><a href="../de502424/index.html">Stoppen Sie den Import ganzer JavaScript-Pakete</a></li>
<li><a href="../de502428/index.html">Syntaktische Leckereien Julia</a></li>
<li><a href="../de502430/index.html">Best Practices von Kubernetes. Kubernetes Lebensfähigkeitstest mit Bereitschafts- und Lebendigkeitstests</a></li>
<li><a href="../de502432/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 415 (11.-17. Mai 2020)</a></li>
<li><a href="../de502436/index.html">CI TeamCity - Automatisierung von Build-Prozessen für Android- und UI-Tests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>