<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öúÔ∏è üßôüèΩ üê™ Explore iOS bug with Hopper ‚õπüèª üòô ü•†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My name is Alexander Nikishin, I am developing iOS applications at Badoo. In the article, I will talk about how we investigated a bug in UIKit,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Explore iOS bug with Hopper</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/504084/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello! My name is Alexander Nikishin, I am developing iOS applications at Badoo. In the article, I will talk about how we investigated a bug in UIKit, which Apple did not want to fix for six months. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tm/mh/ea/tmmheaww_pwtz36zltfmiyqgadu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It all started in August 2019 with the first beta versions of iOS 13. Then we first encountered a problem. In the Badoo and Bumble applications, we are constantly working on improving the interfaces and, for example, we try to optimize the tedious and unloved registration process as much as possible. Systematic predictive tooltips above the keyboard are a great way to reduce the number of user clicks when entering data. However, in the new version of iOS, we were surprised to find that the prompts for entering the phone number were gone.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/qh/qe/tp/qhqetpwinu9_mvbd5gms1dyrvu0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the GM version came out, we realized that the problem was not fixed. It seemed to us that such an obvious bug simply could not be missed by regression tests, which Apple probably had in its arsenal, and we began to wait for a correction in the first big update package. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Other developers hoped for</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this </font><font style="vertical-align: inherit;">. However, with the release of version 13.1, nothing has changed, and we had no choice but to open the radar, which we did in early October. Time passed, iOS 13.2 and 13.3 came out, and the bug still remained uncorrected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In February, our registration team got some free time from working on the backlog, and I decided to investigate this problem a little deeper.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before you start digging, you had to figure out which way to do it. Since the hints continued to work on some types of keyboards, the first thought was to study the hierarchy of its views in different versions of iOS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mv/sw/px/mvswpxpjqpsfjh2bqdcn1vlz8sk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iOS 12 vs iOS 13</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
It immediately became clear that Apple in iOS 13 refactored the keyboard implementation and highlighted the prompts in a separate controller ( </font></font><code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Obviously, the trend towards modularization and decomposition has also reached it (by the way, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artyom Loenko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recently </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">spoke</font></a><font style="vertical-align: inherit;"> about our experience of their application </font><font style="vertical-align: inherit;">). Most likely, because of this, there was a regression of functionality. The circle of searches began to narrow.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I think most iOS developers know that it‚Äôs easy to find interfaces of private system classes in the public domain: just enter one query in the search engine. In the study of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a class interface</font></font></a> <code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the eye catches one of its methods: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ex/vt/ry/exvtrycfpe8qra7wrgux5khrqka.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems there was a clue, which is quite easy to check, using the good old tool </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spoofing implementation functions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Swizzling). We will use it so that a function that is ‚Äúunder suspicion‚Äù always returns the true value:</font></font><br>
<br>
<pre><code class="objectivec hljs">+(<span class="hljs-keyword">void</span>)swizzleIsVisibleForInputDelegate {<font></font>
    SEL targetSelector = sel_getUid(<span class="hljs-string">"isVisibleForInputDelegate:inputViews:"</span>);<font></font>
    Class targetClass = <span class="hljs-built_in">NSClassFromString</span>(@‚Äù<span class="hljs-built_in">UIPredictionViewController</span>‚Äù);
    <span class="hljs-keyword">if</span> (targetClass == <span class="hljs-literal">nil</span>) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (![targetClass instancesRespondToSelector:targetSelector]) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
<font></font>
    Method method = class_getInstanceMethod(targetClass, targetSelector);<font></font>
    <span class="hljs-keyword">if</span> (method == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
<font></font>
    IMP originalImplementation = method_getImplementation(method);<font></font>
    IMP newImp = imp_implementationWithBlock(^<span class="hljs-built_in">BOOL</span>(<span class="hljs-keyword">id</span> me, <span class="hljs-keyword">id</span> delegate, <span class="hljs-keyword">id</span> views) {
        <span class="hljs-comment">//   ,        . </span>
        <span class="hljs-built_in">BOOL</span> result = ((<span class="hljs-keyword">bool</span> (*)(<span class="hljs-keyword">id</span>,SEL,<span class="hljs-keyword">id</span>,<span class="hljs-keyword">id</span>))originalImplementation)(me, targetSelector, delegate, views);
        <span class="hljs-keyword">if</span> ([delegate isKindOfClass:[<span class="hljs-built_in">UITextField</span> <span class="hljs-keyword">class</span>]] &amp;&amp; [delegate keyboardType] == <span class="hljs-built_in">UIKeyboardTypePhonePad</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">YES</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> result;<font></font>
    });<font></font>
<font></font>
    method_setImplementation(method, newImp);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Restarting the test project, I found that the phone prompts returned to iOS 13 and are working ‚Äúin normal mode‚Äù. This could end the investigation and perhaps even very carefully use this dangerous and forbidden Apple guideline solution in the release assembly with the ability to remotely enable / disable for some users (for the option of remote feature management, you can see the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recording of the report of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> my colleague Katerina Trofimenko). Nevertheless, I never ceased to wonder why this function returns false when using the telephone type of keyboard.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To get to the truth, we need the source code of the function. Obviously, Apple doesn‚Äôt distribute the iOS component code right and left, so it‚Äôs not possible to google it. There is only one way left - reverse engineering to decompile the binary code. Earlier, I had heard about a product such as </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hopper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> several times and read several articles about its use in order to dig deeper under the hood of system libraries, but I never used it myself. And immediately I was pleasantly surprised: it turned out that in order to play around and learn the tools, it is not even necessary to buy the full version. The demo version includes endless 30-minute work sessions without the ability to save the index and make changes to binary files, which means it is an excellent platform for experimentation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All from the same</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">published</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> private interface, you can find out what </font></font><code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is part of the UIKitCore framework. All that remains is to find it and upload it to Hopper. Binary framework files are located in the depths of Xcode. Here, for example, is the full path to the UIKitCore we need:</font></font><br>
<br>
<pre><code class="plaintext hljs">/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Library/Developer/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/PrivateFrameworks/UIKitCore.framework/UIKitCore</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We make a drag-and-drop file in Hopper, confirm the action in the system dialog and wait for the indexing to complete (in the case of such a large framework as UIKit, this can take from four to six minutes). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The interface of the program is quite simple, I will only note the key elements that were required for my research. </font><font style="vertical-align: inherit;">In the left panel of the interface you can find the search line through which the code is navigated. </font><font style="vertical-align: inherit;">By searching the name of the class we are interested in, we quickly get the function under study, its assembler code opens in the main window. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gi/qf/94/giqf94bvzg42e1zspxys3880gy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the upper task bar there are buttons for switching code display modes. </font><font style="vertical-align: inherit;">From left to right:</font></font><br>
<br>
<img width="200" src="https://habrastorage.org/webt/ho/i-/ig/hoi-igmtwupaitvjpqolbwckmya.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASM mode - assembler code;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CFG mode - assembler code in the form of a block diagram (tree), where the pieces of code are combined into blocks, and the transitions are shown as branches;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pseudo-code mode - the generated pseudo-code (we will talk more about it below);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hex mode is a hexadecimal representation of a binary file, or abracadabra, which does not help us much in our research.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you need to find out what happens inside the function. </font><font style="vertical-align: inherit;">Her body is quite long, so only ASM gurus, whom I can‚Äôt call myself, can understand the logic by looking at the assembler code. </font><font style="vertical-align: inherit;">To do this, Pseudo-code mode will help, in which Hopper simplifies assembly operations as much as possible, substituting real function names where possible and using register names like variables. </font><font style="vertical-align: inherit;">It looks like this: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ph/0w/cy/ph0wcy7eq21kozwiapjtw3mihuu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It remains only to go through the logic of the function and understand which of its branches we fall into. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">Symbolic Breakpoints</font></a><font style="vertical-align: inherit;"> helped me with this.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which can be installed on system calls, simultaneously printing all the necessary variables and the results of function calls to the Xcode console. Using this simple way, I found that the execution of the function is interrupted by an early exit due to the fact that one of the conditions does not work in the example code block. Let's figure out what's going on here. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A little context: in the rbx register a little higher in the code (which I omitted for simplicity) is a link to the object implementing the protocol </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">UITextInputTraits_Private</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(this is an extended version of the public protocol </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">UITextInputTraits</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the first of the conditions is to verify that the prompts are not hidden by the configuration of the input field. In the debug, you can see that it is running: property</font></font><code>hidePrediction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">returns false. The second condition is to verify that the keyboard is not in ‚Äúsplit‚Äù mode (on your iPad, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pull the lower right button up</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , only 2-3% of users know about this thing). With this, too, everything is in order. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Move on. At the next stage, manipulations with begin </font></font><code>keyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which hint to us that the truth is somewhere nearby. It is first checked that the current one is </font></font><code>keyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">less than or equal to 0xb (or 11 in decimal format). If we open the declaration in Xcode </font></font><code>UIKeyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we will see that there are 13 types of keyboards, and one of them (</font></font><code>UIKeyboardTypeAlphabet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) is deprecated and declared as a reference to another type. That is, there are 12 types in enum: if you start from 0, the latter will have a value equal to 11. In other words, the code validates the value in the form of an overflow check, and it, again, passes successfully. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further we see a very strange condition </font></font><code>if (!COND)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and for a long time I could not understand what it was checking, given that the COND variable was not declared anywhere else in the code. Moreover, my </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symbolic Breakpoints</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> showed that it is precisely the failure to fulfill this condition that leads to an early exit from the function. And here we have no choice but to return to ASM mode and study this part of the code in assembler form.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To find this condition in the ASM listing, you can use the ‚ÄúNo code duplication‚Äù option, which will show the pseudocode not in the form of source code with if-else conditions, but in the form of unique blocks of code and transitions in the form of goto. In this case, we will see the position of the beginning of these blocks in the binary file and use this pointer to search in ASM mode. So I found out that the block we are interested in is located at fe79f4: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/ev/wk/yuevwkuqmhpb5ht5ds2l3mgiz1w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Returning to ASM mode, we can easily find this block: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g1/0e/u4/g10eu4epacglmci1utx7gpue_ii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We come to the most difficult part, where we will parse the three lines of assembler code.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I recognized the first line from my memory (thanks to the assembler lessons in my native MIET, finally the moment has come in my life when higher education came in handy!). Everything is quite simple here: the constant 0x930 (100100110000 in binary format) is placed in the ecx register. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the second line, we see the bt instruction executed on the </font></font><code>exc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font><font style="vertical-align: inherit;">registers </font></font><code>eax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The value of one we already know, the value of the second can be seen in the previous screenshot: </font></font><code>rax = [rbx keyboardType]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- it contains the current type of keyboard. </font></font><code>rax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- this is the entire 64-bit register, </font></font><code>eax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- this is its 32-bit part. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With the data decided, it remains to understand the logic of the team. Google leads us to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this description</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<blockquote>Selects the bit in a bit string (specified with the first operand, called the bit base) at the bit-position designated by the bit offset operand (second operand) and stores the value of the bit in the CF flag.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The instruction extracts a bit from the first operand (constant 0x930) at the position specified by the second operand (keyboard type), and places it in CF ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carry flag</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). That is, as a result, the CF will contain 0 or 1, depending on the type of keyboard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We proceed to the last operation </font></font><code>jb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it has the following </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">description</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<code>Jump short if below (CF=1)</code> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is easy to guess that there is a transition to the function (early exit) if CF is 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At this point, the puzzle begins to add up. We have a bit mask 100100110000 (it contains 12 bits according to the number of keyboard types available), and it determines the condition for early exit. Now, if we check the availability of hints for all types of keyboards in ascending order </font></font><code>rawValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, everything will be in place.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/gm/xw/yjgmxwjm7pes1dooauar9gksqxm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In iOS 12, we will not find such logic - the hints there work for any type of keyboard. I suspect that in iOS 13, Apple decided to disable hints for digital keyboards, which is understandable in principle: I can‚Äôt come up with a scenario where the system needs to prompt numbers. Apparently, by mistake, a ‚Äúhot hand‚Äù also hit </font></font><code>UIKeyboardTypePhonePad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which is very similar to a regular numeric keypad. At the same time </font></font><code>UIKeyboardTypeNamePhonePad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, combining a QWERTY keyboard to search for telephone contacts and the exact same disabled digital keypad, he continued to show prompts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To my surprise, working with Hopper turned out to be very pleasant and entertaining, for a long time I did not get so much fan. </font><font style="vertical-align: inherit;">I shared the findings with Apple engineers in my bug report, and its status changed over time to ‚ÄúPotential fix identified - For a future OS update‚Äù. </font><font style="vertical-align: inherit;">I hope the fix will reach users in future updates. </font><font style="vertical-align: inherit;">At the same time, Hopper can be used not only to find the causes of your or Apple bugs, but also to detect Apple fixes for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">third-party programs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en504070/index.html">Graduate student solved a topological problem half a century ago</a></li>
<li><a href="../en504072/index.html">The ideal user agreement: how to minimize risks for developers</a></li>
<li><a href="../en504074/index.html">Glass Nightmare: Cleansing the Hanford Cold War Nuclear Heritage</a></li>
<li><a href="../en504080/index.html">How Apple and Google Employees Help Healthcare Officials Track Coronavirus Together</a></li>
<li><a href="../en504082/index.html">What will we do with the additional 1.2 GHz?</a></li>
<li><a href="../en504086/index.html">Computer system simulators - do they look like reality</a></li>
<li><a href="../en504088/index.html">Advanced Windows Logging. Looking for mimikatz</a></li>
<li><a href="../en504092/index.html">First look at JavaScript records and tuples</a></li>
<li><a href="../en504096/index.html">Optimal Newbie Way for C ++ / Qt</a></li>
<li><a href="../en504098/index.html">Dipfake video one frame</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>