<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍫 🤚 🤳 Solo sobre NModbus (RTU) 👃🏿 🕐 🚠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artículo está destinado a principiantes.
 
 Teoría
 Modbus  es un protocolo de comunicación basado en la arquitectura maestro-esclavo. Utiliza in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Solo sobre NModbus (RTU)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486346/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este artículo está destinado a principiantes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teoría</font></font></h2><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbus</font></font></a> </b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es un protocolo de comunicación basado en la arquitectura maestro-esclavo. </font><font style="vertical-align: inherit;">Utiliza interfaces RS-485, RS-422, RS-232, así como redes Ethernet TCP / IP para la transferencia de datos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NModbus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es una gran biblioteca de C # que incluye la implementación de todos los modos de operación de protocolo. </font><font style="vertical-align: inherit;">El modelo para implementar las clases de esta biblioteca le permite trabajar con cualquier dispositivo Modbus, pero solo con uno, ya que las clases de la biblioteca encapsulan un puerto en sí mismo, evitando la sincronización entre varios objetos Modbus. </font><font style="vertical-align: inherit;">Este protocolo es bastante popular cuando se desarrollan diferentes periféricos para un hogar inteligente, así como el Internet de las cosas.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equipos</font></font></b><div class="spoiler_text">,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"></a>,        TCP/IP .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, para administrar algo, necesitamos saber qué y dónde enviar. </font><font style="vertical-align: inherit;">Entonces necesitamos una tarjeta de registro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aclararé que las celdas de registro son: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Solo lectura </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Para lectura y escritura </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Solo </font><font style="vertical-align: inherit;">escritura </font><font style="vertical-align: inherit;">(se permite la confirmación del registro para dar un código de error) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tarjeta más simple se ve así:</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Captura de pantalla</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/27b/e48/799/27be487999d08a35b673a0407da1aadd.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Además, hay varias explicaciones, por ejemplo, qué valor máximo / mínimo se puede transmitir a la dirección, etc. </font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Práctica</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilizo la versión de prueba del simulador de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbus Tools</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y los puertos COM de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MOXA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con interfaz RS-485.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puerto COM</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/w0/xo/ls/w0xolsnffm5k6qreoqr4wygu2-4.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez que haya creado el proyecto, debe integrar NModbus en él. </font><font style="vertical-align: inherit;">Recomiendo usar VisualStudio, ya que es bastante fácil hacerlo con NuGet, como se muestra a continuación:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1er paso</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/ma/qu/yr/maquyrtimwfnbsnmwicxerf1al4.png"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2do paso</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/1t/r8/rc/1tr8rczzen9c8v5fajjhzertjh8.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ModbusTools, necesitamos establecer los parámetros de conexión (pueden diferir para usted, estos son adecuados para mis puertos COM): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
los parámetros se abren en F3 o en la pestaña "Conexión". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para Master y Slave, la configuración debe coincidir, excepto para el elemento con puertos COM.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Captura de pantalla</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/b3/yj/fy/b3yjfyvkmbmphiogmciwnww74v8.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de configurar, puede hacer clic en "Aceptar" y los dispositivos se conectarán entre sí. </font><font style="vertical-align: inherit;">O bien esto no sucede y aparece una inscripción que indica que la conexión se interrumpió durante N segundos o que está completamente ausente. </font><font style="vertical-align: inherit;">En este caso, verifique la configuración y la conexión, asegúrese de que los controladores para los puertos COM estén instalados correctamente y funcionen correctamente.</font></font><br>
<cut></cut><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejemplo de programa simple</font></font></b><div class="spoiler_text"><pre><code class="bash hljs">using Modbus.Device;<font></font>
using System;<font></font>
using System.Collections.Generic;<font></font>
using System.IO.Ports;<font></font>
using System.Linq;<font></font>
using System.Text;<font></font>
using System.Threading.Tasks;<font></font>
<font></font>
namespace Modbus<font></font>
{<font></font>
    class Program<font></font>
    {<font></font>
        static void Main(string[] args)<font></font>
        {<font></font>
            SerialPort serialPort = new SerialPort(); //Create a new SerialPort object.<font></font>
            serialPort.PortName = <span class="hljs-string">"COM1"</span>;<font></font>
            serialPort.BaudRate = 9600;<font></font>
            serialPort.DataBits = 8;<font></font>
            serialPort.Parity = Parity.None;<font></font>
            serialPort.StopBits = StopBits.One;<font></font>
            serialPort.Open();<font></font>
            ModbusSerialMaster master = ModbusSerialMaster.CreateRtu(serialPort);<font></font>
<font></font>
            byte slaveID = 1;<font></font>
            ushort startAddress = 0;<font></font>
            ushort numOfPoints = 1;<font></font>
            ushort[] holding_register = master.ReadHoldingRegisters(slaveID, startAddress,<font></font>
            numOfPoints);<font></font>
            Console.WriteLine(holding_register);<font></font>
            Console.ReadKey();<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Captura de pantalla</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/bt/qf/fj/btqffjq0_sn0nl0r95yxe59izlc.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importante:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si está desarrollando algo que es más complicado que el ejemplo anterior, debe asegurarse de que los paquetes no se pierdan. </font><font style="vertical-align: inherit;">Es necesario calcular sumas de verificación, puede leer sobre esto </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aquí.</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es486346/">https://habr.com/ru/post/es486346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es486328/index.html">Política de privacidad y términos de uso como atributo obligatorio de un producto de TI</a></li>
<li><a href="../es486330/index.html">Hilo 2 - con Prolog y complementos</a></li>
<li><a href="../es486334/index.html">Construcción de enlaces de dos niveles + proporciones suaves y estables de crecimiento = mayor visibilidad en los motores de búsqueda</a></li>
<li><a href="../es486336/index.html">Verificación automática de los requisitos técnicos en el proceso de modelado dinámico.</a></li>
<li><a href="../es486338/index.html">Facebook llora, Social Links se ríe, Maltego fuma</a></li>
<li><a href="../es486348/index.html">Operaciones CRUD con entidades en DialogFlow (C #)</a></li>
<li><a href="../es486350/index.html">Cashback en un club de robótica, o cómo mis estudiantes ganan en sus habilidades</a></li>
<li><a href="../es486354/index.html">Georgy Potapov: "Soy un consumidor profesional de datos de OpenStreetMap"</a></li>
<li><a href="../es486356/index.html">The Ember Times - Número 132</a></li>
<li><a href="../es486358/index.html">Transformador en imagenes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>