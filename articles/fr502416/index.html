<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòû üÖ±Ô∏è üöä Compl√©ter SQL. Partie 1. La complexit√© de l'analyse. Histoires sur la finalisation du fichier ANTLR üôÜüèª üôãüèæ üë®üèΩ‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je publie l'article original sur Habr, dont la traduction est publi√©e sur le blog Codingsight .
 
 Que se passera-t-il dans cet article?
 Je travaille...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Compl√©ter SQL. Partie 1. La complexit√© de l'analyse. Histoires sur la finalisation du fichier ANTLR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502416/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je publie l'article original sur Habr, dont la traduction est publi√©e sur le blog </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codingsight</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que se passera-t-il dans cet article?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je travaille dans l'entreprise depuis plus de cinq ans, qui d√©veloppe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la ligne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IDE pour travailler avec des bases de donn√©es. Lorsque j'ai commenc√© √† travailler sur cet article, je ne pouvais pas imaginer combien d'histoires int√©ressantes je pouvais me souvenir, car lorsque j'ai termin√©, j'ai re√ßu plus de 30 pages de texte. Apr√®s un peu de r√©flexion, j'ai regroup√© les histoires par sujet et divis√© l'article en plusieurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au fur et √† mesure de ma publication, j'ajouterai des liens vers les parties suivantes: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie 1. La complexit√© de l'analyse. Histoires sur la finalisation d'ANTLR avec un fichier</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Partie 2. Optimisation du travail avec des cha√Ænes et l'ouverture de fichiers </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Partie 3. Dur√©e de vie des extensions pour Visual Studio. Travaillez avec IO. Utilisation inhabituelle de SQL </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Partie 4. Travailler avec des exceptions, l'impact des donn√©es sur le processus de d√©veloppement. Utilisation de ML.NET</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beaucoup de choses int√©ressantes se sont produites pendant le travail: nous avons trouv√© plusieurs bogues dans .NET, optimis√© plusieurs fois certaines fonctions, et certaines seulement en pourcentage, fait quelque chose de tr√®s cool la premi√®re fois, et quelque chose que nous n'avons pas r√©ussi m√™me apr√®s quelques tentatives. </font><font style="vertical-align: inherit;">Mon √©quipe d√©veloppe et prend en charge les fonctionnalit√©s du langage IDE, la principale √©tant l'ach√®vement du code. </font><font style="vertical-align: inherit;">D'o√π le nom de la s√©rie d'articles. </font><font style="vertical-align: inherit;">Dans chacune de leurs parties, je raconterai plusieurs histoires: certaines sur les succ√®s, d'autres sur les √©checs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette partie, je me concentrerai sur les probl√®mes d'analyse syntaxique de SQL, la lutte contre ces probl√®mes et les erreurs commises dans ce combat.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hg/xl/vm/hgxlvmyga2eic3ul4c_i72mrxma.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ceux qui ne sont int√©ress√©s que par une partie de cela et juste pour une navigation facile, le contenu de l'article:</font></font><br>
<br>
<h3><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenu</font></font></u></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qui suis je?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelles sont les difficult√©s?</font></font></a><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©veloppement de bureau</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse SQL et dialectes</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guerres de pr√©dicat</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions de </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v√©lo</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cool</font></font></a><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√©ritage grammatical</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre post-traitement ANTLR</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erreurs</font></font></a><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse sans arbre</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></a></li>
</ul><br>
<a name="Who"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qui suis je?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suis arriv√© √† ce poste en juin avec tr√®s peu d'exp√©rience. </font><font style="vertical-align: inherit;">Comme beaucoup, je suis venu √† la programmation parce que je voulais faire des jouets. </font><font style="vertical-align: inherit;">Plusieurs ont m√™me r√©ussi. </font><font style="vertical-align: inherit;">J'ai m√™me √©crit sur le d√©veloppement d'un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. R√©cemment, au fait, il l'a ressuscit√©e sur un autre serveur. Il restait une douzaine de jeux cr√©√©s ou abandonn√©s √† diff√©rents stades de pr√©paration. En plus des jeux, avant de d√©crocher ce travail, j'ai r√©ussi √† r√©aliser plusieurs projets en freelance. Le plus important d'entre eux √©tait l'application de m√©dias sociaux, qui √©tait un portail de football avec des tables de tournois, des donn√©es de joueurs et la possibilit√© d'informer les utilisateurs du score final ou des buts marqu√©s par SMS. Cela a √©t√© fait il y a pr√®s de 10 ans. √Ä cette √©poque, tout le monde n'√©tait pas all√© avec des smartphones, et qui se rendait plus souvent sans Internet ou avec le EDGE √† trois maudits sur lequel ouvrir un site de texte n'√©tait pas toujours possible. L'id√©e m'a donc sembl√© bonne.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'une mani√®re ou d'une autre, il s'est av√©r√© qu'en plus des jeux, j'√©tais √©galement amen√© √† cr√©er diff√©rents r√©glages pour moi-m√™me ou d'autres d√©veloppeurs. Parfois, il √©tait proche de ce que je devais faire au travail un peu plus tard. Par exemple, l'un des projets que j'ai r√©alis√©s en √©tudiant l'API Win32 √©tait un programme mettant en √©vidence le code XML dans Rich Edit Control. De plus, il √©tait possible de t√©l√©charger du code r√©tro-√©clair√© sur des codes BMP, HTML ou BB qui √©taient √† la mode alors sur diff√©rents forums.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre projet qui s'est av√©r√© tr√®s proche de ce que je faisais au travail √©tait un programme qui analyse le code C / C ++ et en construit un diagramme. L'organigramme √©tait strictement conforme aux exigences d'un enseignant de l'universit√©. Il a √©t√© fait maladroitement, dans le front, sans aucune connaissance de la th√©orie de l'analyse syntaxique, et a travaill√© exclusivement sur mon caract√®re merdique. Quelques ann√©es plus tard, tout en nettoyant l'ordinateur de vieux d√©chets, je suis tomb√© dessus et je ne pouvais pas le retirer, alors je l'ai post√© sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour l'histoire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces exp√©riences, coupl√©es √† du freelance, ont donn√© une assez bonne exp√©rience et ont permis d'obtenir un emploi. </font><font style="vertical-align: inherit;">Au fil du temps, apr√®s une douzaine de revues tremp√©es de sang et de larmes, je commence m√™me √† b√©n√©ficier √† l'entreprise et au produit. </font><font style="vertical-align: inherit;">Revenir en arri√®re, c‚Äôest plut√¥t dr√¥le de comprendre qu‚Äô√† la suite de plusieurs accidents, j‚Äôai commenc√© √† faire exactement ce qui m‚Äôattirait.</font></font><br>
<a name="difficulties"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelles sont les difficult√©s?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce bloc est n√©cessaire pour plonger le lecteur dans le contexte de ce que nous faisons r√©ellement.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bp/sh/st/bpshstukfseasxycc6eyk1epb3s.jpeg"><br>
<a name="desktop"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©veloppement de bureau</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est peut-√™tre m√™me pas de la complexit√©, car c'est d√©j√† un domaine tr√®s mature dans lequel il n'y a pas grand-chose d'inconnu, les biblioth√®ques sont stables, les meilleures pratiques sont connues. </font><font style="vertical-align: inherit;">Cette fonctionnalit√© de notre projet est ici, parce que moi, comme beaucoup d'autres programmeurs, j'ai tendance √† la nouveaut√©, et la nouveaut√© a maintenant disparu sur le Web. </font><font style="vertical-align: inherit;">Il y a eu des jours o√π, sous la pluie, je suis mont√© sur le rebord de la fen√™tre, recouvert d'une couverture, avec une tasse de cacao, et j'ai pens√© √† redis, r√©agir, charger et syst√®mes distribu√©s qui sont d√©velopp√©s quelque part sans moi en ce moment. </font><font style="vertical-align: inherit;">L'autre c√¥t√© de ce probl√®me est qu'il n'est pas facile de d√©crire la complexit√© du projet √† des d√©veloppeurs familiers par rapport √† la bi√®re, et lorsque vous travaillez sur des applications qui fonctionnent selon des lois fondamentalement diff√©rentes, cela devient encore plus difficile.</font></font><br>
<br>
<a name="dialects"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse SQL et dialectes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai √©galement √©crit de petits analyseurs pour diff√©rentes langues avant ce travail. Pendant un certain temps, j'ai enseign√© des cours .NET. Pour certains groupes, en tant que t√¢che suppl√©mentaire, dans le cadre du sujet ¬´cha√Æne¬ª, ils ont sugg√©r√© d'√©crire leur propre analyseur JSON simple. Seuls SQL et ses variantes sont loin d'√™tre XML ou JSON con√ßus pour √™tre √©galement compr√©hensibles par les analyseurs et les utilisateurs. De plus, SQL est syntaxiquement plus complexe que C / C ++, avec ses nombreuses fonctions accumul√©es sur une longue histoire. SQL est structur√© diff√©remment, ils ont essay√© de le faire ressembler √† un langage naturel, avec succ√®s, soit dit en passant. La langue a plusieurs milliers de mots-cl√©s (selon le dialecte). Souvent, pour distinguer une expression d'une autre, vous devez jeter un ≈ìil √† deux mots ou plus (jetons). Cette approche est appel√©e l'anticipation. Il existe une classification des analyseurs selonjusqu'o√π ils peuvent regarder en avant: LA (1), LA (2) ou LA (*), ce qui signifie que l'analyseur peut regarder aussi loin que possible pour d√©terminer la branche correcte. Parfois, la fin facultative d'une clause √† l'int√©rieur d'une instruction SQL co√Øncide avec le d√©but d'une autre, qui est √©galement facultative: de telles situations rendent les analyseurs beaucoup plus compliqu√©s. T-SQL verse de l'eau dans le feu, dans lequel le point-virgule est facultatif, et la fin possible, mais non obligatoire, de certaines instructions SQL peut entrer en conflit avec le d√©but d'autres.de telles situations compliquent grandement les analyseurs. T-SQL verse de l'eau dans le feu, dans lequel le point-virgule est facultatif, et la fin possible, mais non obligatoire, de certaines instructions SQL peut entrer en conflit avec le d√©but d'autres.de telles situations compliquent grandement les analyseurs. T-SQL verse de l'eau dans le feu, dans lequel le point-virgule est facultatif, et la fin possible, mais non obligatoire, de certaines instructions SQL peut entrer en conflit avec le d√©but d'autres.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous ne croyez toujours pas? Il existe un m√©canisme pour d√©crire les langages formels √† travers les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grammaires</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La grammaire est un code dans une langue qui en d√©crit une autre. √Ä partir d'une grammaire, vous pouvez souvent g√©n√©rer un analyseur √† l'aide d'un outil. Les outils et langages de description de grammaire les plus connus sont </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">YACC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANTLR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Les analyseurs g√©n√©r√©s par YACC sont utilis√©s directement dans les moteurs </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MariaDB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Vous pouvez essayer de les prendre directement √† partir de l'open source et de d√©velopper la compl√©tion de code et d'autres fonctions bas√©es sur l'analyse SQL bas√©e sur eux. De plus, une telle impl√©mentation recevrait des mises √† jour gratuites en termes de d√©veloppement, et l'analyseur se comporterait garanti d'√™tre identique au moteur de base de donn√©es. Alors pourquoi utilisons-nous ANTLR? Il supporte qualitativement C # /. NET, il existe de bons outils pour travailler avec lui, sa syntaxe est beaucoup plus facile √† lire et √† √©crire. La syntaxe ANTLR s'est av√©r√©e si pratique que Microsoft l'a r√©cemment utilis√©e dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> officielle </font><font style="vertical-align: inherit;">C #.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Revenons √† ma preuve de la complexit√© de SQL, par rapport √† d'autres langages, en termes d'analyse. Pour ce faire, je veux comparer les tailles de grammaire pour diff√©rentes langues disponibles publiquement. Dans dbForge, nous utilisons nos propres grammaires, elles sont plus compl√®tes que celles disponibles publiquement, mais, malheureusement, sont tr√®s obstru√©es par des insertions de code C # pour prendre en charge diff√©rentes fonctions, plus √† ce sujet dans la section ¬´Analyse sans arborescence¬ª dans la section ¬´Erreurs¬ª. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici les tailles de grammaire pour diff√©rentes langues: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - analyseur de 475 lignes + 273 lexer = 748 lignes </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - analyseur de 615 lignes + 211 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lexer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 826 lignes </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C #</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - analyseur de 1159 lignes + 433 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lexer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 1592 lignes </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 1933 lignes </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- analyseur 2515 lignes + 1189 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lexer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 3704 lignes </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T-SQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 4035 lignes analyseur + 896 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analyseurs lexicaux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 4931 lignes </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PL SQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 6719 lignes analyseur + 2366 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lexer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 9085 lignes </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A la fin de certains lexers il y a une √©num√©ration des caract√®res Unicode dans la langue, cela est inutile dans √©valuation de la complexit√© de la langue. J'ai pris le nombre de lignes avant de commencer de tels transferts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il peut y avoir des questions concernant la complexit√© de l'analyse d'une langue en fonction du nombre de lignes dans sa grammaire. Les questions peuvent √©galement porter sur la pl√©nitude des grammaires ouvertes par rapport √† la syntaxe r√©elle des langues. Malgr√© cela, je consid√®re toujours utile de donner ces chiffres, car l'√©cart est trop important.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est pas tout, car nous n'avons pas seulement besoin d'analyser plusieurs fichiers en SQL. Nous faisons un IDE, ce qui signifie que nous devons travailler sur des scripts incomplets ou invalides. M√™me si vous √©crivez vos scripts sans erreurs, peut-√™tre que vous les √©crivez de mani√®re incoh√©rente, il est peu probable que le script soit valide tout au long du processus de d√©veloppement. Par exemple, j'√©cris d'abord ¬´SELECT FROM¬ª, apr√®s quoi je serai heureux de voir la liste des tables disponibles. Lorsque je s√©lectionne une table, je r√©organise le chariot sur SELECT, j'appuie sur la barre d'espace et j'attends la liste des colonnes de cette table particuli√®re. Il s'agit d'un exemple tr√®s simple, mais il montre que l'analyseur fournissant la compl√©tion de code dans l'EDI ne peut pas planter, √† l'exception de rencontrer un script non valide. Nous avons d√ª trouver de nombreuses astuces pour nous assurer que l'infobulle fonctionne correctement dans de nombreux sc√©narios de ce type,mais les utilisateurs envoient toujours diff√©rents sc√©narios pour travailler avec des scripts inachev√©s, ce qui signifie que nous devons trouver de nouvelles astuces.</font></font><br>
<a name="predicates"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guerres de pr√©dicat</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'analyse du code, il existe parfois des situations o√π le mot suivant ne pr√©cise pas laquelle des deux alternatives choisir. </font><font style="vertical-align: inherit;">Parfois, il suffit de jeter un ≈ìil √† un nombre strictement d√©fini de mots √† l'avance et vous pouvez certainement choisir une alternative. </font><font style="vertical-align: inherit;">Le m√©canisme de r√©solution de ce type d'inexactitude est appel√© l'anticipation ANTLR. </font><font style="vertical-align: inherit;">Dans ce cas, la m√©thode de l'analyseur syntaxique est construite comme une cha√Æne imbriqu√©e d'if, dont chacun regarde un mot plus loin. </font><font style="vertical-align: inherit;">Ci-dessous, un exemple de grammaire g√©n√©rant une telle incertitude.</font></font><br>
<br>
<pre><code class="lisp hljs">rule1:<font></font>
    'a' rule2 | rule3<font></font>
    <span class="hljs-comment">;</span><font></font>
<font></font>
rule2:<font></font>
    'b' 'c' 'd'<font></font>
    <span class="hljs-comment">;</span><font></font>
<font></font>
rule3:<font></font>
    'b' 'c' 'e'<font></font>
    <span class="hljs-comment">;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au milieu de la r√®gle 1, ayant d√©j√† pass√© le jeton 'a', l'analyseur devra regarder 2 jetons devant pour choisir la r√®gle √† suivre. Encore une fois, cette v√©rification se fera √† l'int√©rieur de la r√®gle. Cette grammaire peut √™tre r√©√©crite de sorte que cette anticipation n'existe pas, malheureusement la structure souffre souvent de telles optimisations, et le gain de performances est relativement peu √©lev√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des m√©canismes plus complexes existent pour r√©soudre des incertitudes plus complexes. L'un d'eux est le m√©canisme de pr√©dicat de syntaxe (synpred) dans ANTLR3.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il vient √† la rescousse dans les cas o√π, par exemple, l'ach√®vement facultatif d'une clause recoupe le d√©but de l'autre optionnel suivant. </font><font style="vertical-align: inherit;">Le pr√©dicat, en termes ANTLR3, est la m√©thode g√©n√©r√©e, qui effectue un passage virtuel √† travers le texte conform√©ment √† l'une des alternatives et, en cas de succ√®s, retourne vrai, cet ach√®vement du pr√©dicat est appel√© r√©ussi. </font><font style="vertical-align: inherit;">La passe virtuelle est √©galement appel√©e passe de retour en arri√®re. </font><font style="vertical-align: inherit;">Si le pr√©dicat a fonctionn√© avec succ√®s, une v√©ritable passe est effectu√©e. </font><font style="vertical-align: inherit;">Cela devient un probl√®me lorsqu'un autre pr√©dicat commence √† l'int√©rieur d'un pr√©dicat, puis une section peut √™tre parcourue cent mille fois. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenons un exemple simplifi√©. </font><font style="vertical-align: inherit;">Il y a 3 points d'incertitude (A, B, C).</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'analyseur saisit A, se souvient de la position dans le texte, commence un passage virtuel du 1er niveau.</font></font></li>
<li>   B,    ,    2- .</li>
<li>   C,    ,    3- .</li>
<li>     3- ,   2    .</li>
<li>     2 ,   1   B   .</li>
<li>    ,       A, B  .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, tous les contr√¥les √† l'int√©rieur de C seront effectu√©s 4 fois, B - 3 fois, A - 2 fois. Mais que faire si l'alternative appropri√©e est deuxi√®me ou troisi√®me de la liste? Ensuite, √† un certain stade de l'un des pr√©dicats, il √©chouera, la position dans le texte sera annul√©e et un autre pr√©dicat commencera √† s'ex√©cuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En analysant √† plusieurs reprises la cause du gel de l'application, nous sommes tomb√©s sur des cas o√π la ¬´queue¬ª synpred a √©t√© ex√©cut√©e plusieurs milliers de fois. Les synpreds sont particuli√®rement probl√©matiques dans les r√®gles r√©cursives. Malheureusement, de par sa nature, SQL est r√©cursif, ce qui est au moins la possibilit√© d'utiliser une sous-requ√™te presque partout. Parfois, √† l'aide de divers trucs et astuces, il s'av√®re que la r√®gle est √©limin√©e de sorte que le pr√©dicat a disparu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De toute √©vidence, synpred a un effet n√©gatif sur les performances. √Ä un moment donn√©, il a fallu mettre leur population sous contr√¥le strict. Le seul probl√®me est que lors de l'√©criture de code de grammaire, l'apparence de synpred peut ne pas √™tre √©vidente. De plus, parfois, un changement dans une r√®gle entra√Æne l'apparition d'un pr√©dicat dans une autre. Cela ne peut pas √™tre contr√¥l√© manuellement. Pour contr√¥ler le nombre de pr√©dicats, nous avons √©crit un simple r√©gulier, qui a √©t√© appel√© par une t√¢che MsBuild sp√©ciale. Si le nombre de pr√©dicats √©tait diff√©rent du nombre sp√©cifi√© dans un fichier s√©par√©, la t√¢che a interrompu l'assembly et signal√© une erreur. Voyant une telle erreur, le d√©veloppeur a d√ª r√©√©crire le code de r√®gle plusieurs fois, essayant de se d√©barrasser des pr√©dicats inutiles, impliquant √©ventuellement d'autres d√©veloppeurs dans le probl√®me. Si un pr√©dicat est in√©vitable,puis le d√©veloppeur met √† jour le nombre de pr√©dicats dans le fichier correspondant. Une modification de ce fichier attire davantage l'attention sur la r√©vision.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans de rares cas, nous avons m√™me √©crit nos propres pr√©dicats en C # pour contourner ceux g√©n√©r√©s par ANTLR. </font><font style="vertical-align: inherit;">Heureusement, un tel m√©canisme existe √©galement.</font></font><br>
<a name="bikes"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions de </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v√©lo</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cool</font></font></h2><br>
<img src="https://habrastorage.org/webt/r2/sr/zk/r2srzksxi_3aseqm2bv50nwjfby.jpeg"><br>
<a name="inheritance"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√©ritage grammatical</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s l'annonce de tout changement dans chacun des SGBD que nous prenons en charge, notre travail pour les prendre en charge commence. Presque toujours, le point de d√©part est de prendre en charge les constructions syntaxiques dans la grammaire. Pour chaque dialecte SQL, nous √©crivons notre propre grammaire, cela g√©n√®re une certaine r√©p√©tition du code, mais finalement c'est plus facile que de chercher un commun entre eux. Il y a quelques ann√©es √† peine, MySQL et MariaDB √©taient tr√®s similaires, il n'√©tait pas pratique d'√©crire des grammaires s√©par√©es. Parce que ces quelques constructions qui √©taient dans MariaDB, mais qui n'√©taient pas dans MySQL, nous avons pris en charge dans la grammaire MySQL. Ce fut un moment d√©sagr√©able: pour l'utilisateur MySQL, nous pouvions sugg√©rer des constructions qui ne seraient pas valides. Ces derni√®res ann√©es, MariaDB et MySQL sont devenus tr√®s divergents en termes de syntaxe et plus encore. Il est devenu √©videntqu'il est faux de prendre en charge deux langues diff√©rentes dans la m√™me grammaire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une solution possible pourrait √™tre une copie compl√®te de la grammaire, apr√®s quoi chacune est prise en charge s√©par√©ment. √Ä la suite d'une longue discussion, nous avons pris une d√©cision audacieuse. Je suis tr√®s content que nous n'ayons pas copi√© le code, chaque cellule en moi a r√©sist√© √† cette d√©cision. Il a √©t√© d√©cid√© d'√©crire votre propre pr√©processeur de grammaire ANTLR, qui impl√©mente le m√©canisme d'h√©ritage grammatical. Il y a quelque temps, je suis tomb√© sur une grammaire ANTLR3 dans le r√©f√©rentiel officiel des grammaires ANTLR4. Je pense que cette phrase doit √™tre lue plusieurs fois pour r√©aliser la profondeur de la folie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En discutant de l'id√©e d'h√©r√©dit√©, nous avons rapidement r√©alis√© que nous aimerions avoir un m√©canisme pour le polymorphisme. La capacit√© dans la grammaire de l'h√©ritier non seulement de red√©finir la r√®gle, mais aussi d'appeler la base. De plus, je veux contr√¥ler la position de l'appel de la r√®gle de base: d√©but, milieu ou fin. Nous avons d√©cid√© que toutes les r√®gles peuvent √™tre red√©finies, pour cela vous n'avez pas besoin de sp√©cifier quoi que ce soit de plus. Pour red√©finir une r√®gle, il suffit de d√©clarer une r√®gle du m√™me nom dans la grammaire suivante. Apr√®s cela, la r√®gle de la grammaire parent sera disponible sous un nom diff√©rent.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ANTLR est un outil de d√©veloppement agr√©able en optimisant - il existe une extension pour VS, il y a ANTLRWorks. En introduisant le m√©canisme d'h√©ritage, je ne voudrais pas perdre cette opportunit√©. Mais comment alors indiquer la grammaire de base? Vous pouvez trouver une sorte de convention pour nommer les fichiers, mais ce n'est pas du tout √©vident. Une autre option pourrait √™tre d'indiquer ces informations suppl√©mentaires dans un fichier s√©par√©, mais m√™me maintenant, en tapant ces lignes, je sentais la puanteur de cette solution. Le r√©sultat √©tait une indication de la grammaire de base dans la grammaire de l'h√©ritier sous la forme d'un commentaire ANTLR. Tous les outils ignoreront simplement ce texte, et nous pouvons facilement extraire le code qui nous int√©resse.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les exigences ont √©t√© form√©es, il est temps de les mettre en ≈ìuvre. Nous avons √©crit la t√¢che MsBuild, qui a √©t√© int√©gr√©e au syst√®me de build g√©n√©ral en tant qu'action de pr√©-build. La t√¢che a effectu√© le travail du pr√©processeur de grammaire ANTLR, g√©n√©rant la grammaire r√©sultante √† partir de la base et h√©rit√©e. La grammaire r√©sultante a d√©j√† √©t√© trait√©e par ANTLR lui-m√™me. Si une r√®gle portant le m√™me nom que dans le parent a √©t√© trouv√©e dans la grammaire suivante, la r√®gle de base a √©t√© renomm√©e: le nom de la grammaire parent a √©t√© ajout√© √† son nom apr√®s le trait de soulignement. Par ce nom, il pouvait √™tre contact√© chez l'h√©ritier.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le m√©canisme du pr√©processeur lui-m√™me n'a pas pris beaucoup de temps, mais avec la g√©n√©ration de l'analyseur, il s'est av√©r√© qu'il ralentissait chaque r√©assemblage du projet de 10 √† 20 secondes. </font><font style="vertical-align: inherit;">√Ä un moment donn√©, cela a cess√© de nous convenir. </font><font style="vertical-align: inherit;">Nous avons d√©cid√© de r√©fl√©chir √† la mani√®re d'optimiser cela. </font><font style="vertical-align: inherit;">La solution a √©t√© d'ajouter le hachage de la somme de toutes les grammaires dont il d√©pend sous forme de commentaire √† l'en-t√™te du fichier analyseur CS. </font><font style="vertical-align: inherit;">Avant de faire quoi que ce soit, le pr√©processeur a compar√© ces hachages avec les hachages de fichiers sur le disque, et s'ils ne diff√®rent pas, le fichier analyseur a √©t√© consid√©r√© comme pertinent. </font><font style="vertical-align: inherit;">Au stade de d√©veloppement initial, nous avons d√ª marcher plusieurs fois sur le rake d'analyseurs et de grammaires invalides collect√©s par la version obsol√®te du pr√©processeur. </font><font style="vertical-align: inherit;">Par cons√©quent, la somme de hachage de l'assembly avec le pr√©processeur est apparue dans le commentaire d'en-t√™te.</font></font><br>
<a name="postprocessing"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre post-traitement ANTLR</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans de nombreux langages de programmation, si le mot est la cl√©, il ne peut plus √™tre utilis√© comme nom d'objet. En SQL, selon le dialecte, de 800 √† 3000 mots-cl√©s. La plupart d'entre eux sont √©troitement li√©s au domaine, en outre, ils n'ont pas tous √©t√© introduits imm√©diatement, de sorte qu'une interdiction de les utiliser tous comme noms d'objet se heurterait √† une vague d'indignation. SQL introduit le concept de mots cl√©s r√©serv√©s et non r√©serv√©s. Vous ne pouvez pas nommer un objet de la m√™me mani√®re qu'un mot cl√© r√©serv√© (SELECT, FROM, etc.) sans le citer, car ce n'est pas un mot cl√© r√©serv√© (CONVERSATION, DISPONIBILIT√â, etc.) - vous le pouvez. Ce comportement complique le d√©veloppement de l'analyseur. Au moment de l'analyse lexicale, le contexte est inconnu, mais l'analyseur requiert des num√©ros diff√©rents pour l'identifiant et le mot-cl√©. Pour r√©soudre ce probl√®me, nous avons ajout√© un post-traitement suppl√©mentaire √† l'analyseur ANTLR.Le post-traitement remplace toutes les v√©rifications explicites par un identifiant, avec un appel √† une m√©thode sp√©ciale. Cette m√©thode impl√©mente une v√©rification plus d√©licate. Si un identifiant est entr√© et qu'un identifiant est attendu plus loin, alors tout va bien, mais si un mot cl√© non r√©serv√© est fourni √† l'entr√©e, il doit √™tre v√©rifi√© en plus. Une v√©rification suppl√©mentaire est que la m√©thode est examin√©e dans le contexte actuel dans la recherche de branches, o√π ce mot-cl√© non r√©serv√© peut √™tre utilis√© pr√©cis√©ment comme mot-cl√©, et s'il n'y a pas de telles branches, alors il peut √™tre utilis√© comme identifiant.mais si un mot cl√© non r√©serv√© est entr√©, il doit √™tre v√©rifi√© en plus. Une v√©rification suppl√©mentaire est que la m√©thode est examin√©e dans le contexte actuel dans la recherche de branches, o√π ce mot-cl√© non r√©serv√© peut √™tre utilis√© pr√©cis√©ment comme mot-cl√©, et s'il n'y a pas de telles branches, alors il peut √™tre utilis√© comme identifiant.mais si un mot cl√© non r√©serv√© est entr√©, il doit √™tre v√©rifi√© en plus. Une v√©rification suppl√©mentaire est que la m√©thode est examin√©e dans le contexte actuel dans la recherche de branches, o√π ce mot-cl√© non r√©serv√© peut √™tre utilis√© pr√©cis√©ment comme mot-cl√©, et s'il n'y a pas de telles branches, alors il peut √™tre utilis√© comme identifiant.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä strictement parler, ce probl√®me ne peut √™tre r√©solu qu'au moyen d'ANTLR, mais une telle solution ne sera pas optimale. </font><font style="vertical-align: inherit;">Une solution classique √† ce probl√®me consiste √† cr√©er une r√®gle qui r√©pertorie tous les mots cl√©s non r√©serv√©s et un jeton d'identification. </font><font style="vertical-align: inherit;">De plus, partout o√π il est permis d'utiliser un identifiant, il n'est plus utilis√© le jeton identifiant de l'identifiant, mais il s'agit d'une r√®gle sp√©ciale. </font><font style="vertical-align: inherit;">Une telle solution vous fait non seulement penser √† ajouter le mot-cl√© lorsque vous le saisissez, non seulement l√† o√π il est utilis√©, mais √©galement dans cette r√®gle sp√©ciale, cela fonctionne √©galement beaucoup plus lentement.</font></font><br>
<a name="mistakes"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erreurs</font></font></h2><br>
<a name="trees"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse sans arbre</font></font></h3><br>
<img src="https://habrastorage.org/webt/g1/ty/qw/g1tyqwxs43omgbkeozhr5ygvxw0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le r√©sultat de l'analyseur, en r√®gle g√©n√©rale, est un arbre de syntaxe. </font><font style="vertical-align: inherit;">Un arbre de syntaxe ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abstrait</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">concret</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) est une structure de donn√©es qui refl√®te le texte du programme √† travers le prisme de la grammaire formelle. </font><font style="vertical-align: inherit;">Si vous souhaitez impl√©menter un √©diteur de code avec saisie semi-automatique pour la langue que vous avez r√©cemment trouv√©e, apr√®s avoir √©tudi√© le probl√®me, vous √™tes susceptible d'impl√©menter approximativement l'algorithme suivant:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyser le texte dans l'√©diteur. </font><font style="vertical-align: inherit;">Obtenez l'arbre de syntaxe.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trouvez le n≈ìud sous le chariot. </font><font style="vertical-align: inherit;">Associez-le √† la grammaire. </font><font style="vertical-align: inherit;">D√©couvrez quels mots-cl√©s et types d'objets seront disponibles sur le point.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, la grammaire est repr√©sent√©e de mani√®re pratique sous la forme d'un graphique ou d'une machine √† √©tats finis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, au d√©but du d√©veloppement, l'IDE ANTLR existait dans sa troisi√®me version. La quatri√®me version a √©t√© r√©√©crite √† partir de z√©ro et est fondamentalement diff√©rente de la troisi√®me; en passant le code, l'analyseur g√©n√®rera automatiquement un arbre d'analyse sans une seule ligne suppl√©mentaire. Dans la troisi√®me version, il y avait un m√©canisme par lequel on pouvait dire √† ANTLR comment construire un arbre, mais ce n'√©tait pas tr√®s agr√©able de l'utiliser. De plus, de nombreux exemples et articles sur ce sujet sugg√®rent d'utiliser le m√©canisme d'actions pour ex√©cuter du code au moment o√π l'analyseur passe la r√®gle. Ce m√©canisme est incroyablement pratique et vous permet d'obtenir rapidement des r√©sultats. Malheureusement, cette solution a entra√Æn√© des probl√®mes architecturaux majeurs avec le d√©veloppement du produit et une augmentation de la complexit√© de la prise en charge de nouvelles fonctionnalit√©s. Le fait est que dans un fichier, dans un fichier de grammaire,les actions ont commenc√© √† s'accumuler associ√©es √† un grand nombre de fonctionnalit√©s diff√©rentes, ce qui serait bien de se propager √† diff√©rents assemblages. √Ä l'avenir, nous avons pu distribuer les gestionnaires des actions eux-m√™mes pour diff√©rents assemblages, mettant en ≈ìuvre une version assez d√©licate du mod√®le d'abonn√©-notifiant, mais les appels eux-m√™mes, avec la transmission des informations n√©cessaires, encombrent toujours notre grammaire, compliquent le support de nouvelles fonctionnalit√©s et imposent des restrictions s√©rieuses et d√©sagr√©ables √† l'architecture.compliquer le support de nouvelles fonctionnalit√©s et imposer des restrictions s√©rieuses et d√©sagr√©ables √† l'architecture.compliquer le support de nouvelles fonctionnalit√©s et imposer des restrictions s√©rieuses et d√©sagr√©ables √† l'architecture.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais tout n'est pas aussi √©vident qu'il y para√Æt. </font><font style="vertical-align: inherit;">Le fait est que ANTLR3 est beaucoup plus rapide que ANTLR4. </font><font style="vertical-align: inherit;">Selon nos mesures, les diff√©rences sont environ 6 fois. </font><font style="vertical-align: inherit;">De plus, l'arborescence de syntaxe pour les gros scripts peut prendre beaucoup d'espace RAM, et tant que nous devons survivre dans l'espace d'adressage 32 bits des studios Visual et SqlServer Management, cela peut √™tre critique.</font></font><br>
<a name="end"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les sous-totaux peuvent √™tre les suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANTLR un outil puissant pour construire des analyseurs</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Son avantage sur les autres est les outils, la syntaxe pratique, un grand nombre de langues prises en charge</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANTLR4 a √©t√© r√©√©crit √† partir de z√©ro et implique de travailler avec l'analyseur diff√©rent de la troisi√®me version</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a toujours un moyen d'obtenir un peu plus des biblioth√®ques ThirdParty qu'elles n'en donnent</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langage sp√©cifique √† SQL, construire des analyseurs n'est pas une t√¢che facile</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'analyse du code pour les t√¢ches li√©es √† la construction d'un IDE a ses propres particularit√©s: vous devez envisager de travailler sur des scripts non chiffr√©s ou invalides</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rendez-vous dans la prochaine partie!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr502406/index.html">Antiquit√©s: une seconde approche de la vid√©o VHS, st√©r√©o st√©r√©o et savonneuse</a></li>
<li><a href="../fr502408/index.html">Fakes et th√©ories du complot. Comment ne pas devenir fou et sauver les autres?</a></li>
<li><a href="../fr502410/index.html">29e lancement r√©ussi de l'ann√©e. ETATS-UNIS. Lancement militaire. "Space Plane" X-37</a></li>
<li><a href="../fr502412/index.html">Guilloche d'une mani√®re diff√©rente</a></li>
<li><a href="../fr502414/index.html">FOSS News n ¬∞ 16 - une revue des logiciels libres et open source du 11 au 17 mai 2020</a></li>
<li><a href="../fr502418/index.html">Moniteur d'images 3D</a></li>
<li><a href="../fr502420/index.html">D√©couvertes CSS int√©ressantes dans la conception de Twitter</a></li>
<li><a href="../fr502432/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 415 (11-17 mai 2020)</a></li>
<li><a href="../fr502436/index.html">CI TeamCity - Automatisation des processus de construction de tests Android et UI</a></li>
<li><a href="../fr502438/index.html">Mat√©riel Python. Cartes personnalis√©es avec effets OpenGL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>