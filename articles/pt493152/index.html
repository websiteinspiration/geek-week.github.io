<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôáüèª üîπ üõÄüèª Redes neurais e minera√ß√£o de processos: tentando fazer amigos üñçÔ∏è üë©üèæ‚Äçü§ù‚Äçüë©üèª üë©üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Process Mining √© um campo de an√°lise de dados que permite analisar processos com base nos logs dos sistemas de informa√ß√£o. Como existem muito poucas p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Redes neurais e minera√ß√£o de processos: tentando fazer amigos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vtb/blog/493152/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Process Mining √© um campo de an√°lise de dados que permite analisar processos com base nos logs dos sistemas de informa√ß√£o. Como existem muito poucas publica√ß√µes sobre o uso do aprendizado de m√°quina neste campo em Habr√©, decidimos compartilhar nossa experi√™ncia no desenvolvimento de modelos preditivos para resolver problemas orientados a processos. Como parte do programa VTB, um j√∫nior de TI para profissionais de TI iniciantes, estagi√°rios da equipe de minera√ß√£o de processos testaram os m√©todos de aprendizado de m√°quina no contexto das tarefas de pesquisa de processos banc√°rios. Sob o corte, falaremos sobre quando e como tivemos a ideia de resolver esses problemas, o que fizemos e quais resultados obtivemos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6n/hi/lg/6nhilgitc0hyxrpmzuypu6w0irg.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O IT Junior Program √© um programa de est√°gio anual para profissionais iniciantes de TI do VTB Bank, que come√ßou em setembro de 2019. </font><font style="vertical-align: inherit;">O est√°gio dura seis meses. </font><font style="vertical-align: inherit;">De acordo com os resultados do programa de 2019, mais da metade dos estagi√°rios ingressou na equipe e se tornou funcion√°rio da empresa. </font><font style="vertical-align: inherit;">Mais informa√ß√µes sobre o programa, o in√≠cio da sele√ß√£o e os requisitos para os candidatos podem ser encontrados </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Foi assim que os trainees deste programa abordaram as tarefas do banco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No sistema de coordenadas cl√°ssico, para entender e formalizar o processo, √© necess√°rio:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realizar uma entrevista com funcion√°rios;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analisar relat√≥rios e documenta√ß√£o dispon√≠veis.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na abordagem de Minera√ß√£o de Processo, um modelo digital de processo √© formado com base n√£o apenas na opini√£o de especialistas dos participantes do processo, mas tamb√©m em dados relevantes dos sistemas de informa√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, obtemos um modelo digital objetivo do processo, que √© um reflexo do movimento de dados reais nos sistemas de TI do processo. O modelo resultante funciona em tempo real e permite exibir o estado atual do processo com o grau de detalhe necess√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">artigo</font></a><font style="vertical-align: inherit;"> anterior</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Falamos sobre nossa plataforma de Minera√ß√£o de Processos e as tarefas reais do Banco, que s√£o resolvidas com sua ajuda. </font><font style="vertical-align: inherit;">A solu√ß√£o implementada nos permitiu reduzir significativamente o tempo necess√°rio para preparar relat√≥rios obrigat√≥rios para ag√™ncias governamentais e tamb√©m ajudou a identificar e otimizar imperfei√ß√µes do processo, a fim de estabelecer uma apresenta√ß√£o di√°ria do status atual das compras no trabalho. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Posteriormente, nossos clientes precisaram n√£o apenas determinar qualitativamente o estado atual do processo, mas tamb√©m prever suas condi√ß√µes futuras.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, descreveremos passo a passo como resolvemos o problema de prever a dura√ß√£o do processo de compras (usando o conjunto de dados BPI Challenge 2019 como exemplo) usando um conjunto de eventos conhecidos usando a DGX Station de alto desempenho, gentilmente fornecida pela NVIDIA para pesquisa.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicativo de aprendizado de m√°quina para minera√ß√£o de processos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver o problema, criamos uma linha de base usando o CatBoostRegressor e, em seguida, desenvolvemos uma solu√ß√£o com uma rede neural e incorporamos vari√°veis ‚Äã‚Äãcateg√≥ricas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Devido √† presen√ßa de recursos categ√≥ricos e materiais nos dados de origem, foi decidido usar o refor√ßo, que poderia processar recursos categ√≥ricos sem codifica√ß√£o e tamb√©m resolver o problema em uma entrada discreta e material. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As redes foram usadas para construir atributos completamente materiais e resolver o problema em toda a entrada de material. Em seguida, compare essas duas abordagens e decida se deve se preocupar com as redes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descri√ß√£o de dados</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidiu-se usar dados externos que nos conviriam na √°rea de neg√≥cios e possu√≠ssem um conjunto semelhante de caracter√≠sticas. </font><font style="vertical-align: inherit;">O conjunto de dados usado do BPI Challenge 2019 inclui 250 mil casos - 1,5 milh√£o de eventos. </font><font style="vertical-align: inherit;">Os dados iniciais s√£o descritos por um conjunto de 21 sinais: 18 categ√≥ricos (existem sinais de √≠ndice), dois booleanos e um real. </font><font style="vertical-align: inherit;">O tempo de execu√ß√£o do processo de compras foi selecionado como a vari√°vel alvo, que correspondia √†s reais necessidades do neg√≥cio. </font><font style="vertical-align: inherit;">Para uma descri√ß√£o detalhada das caracter√≠sticas, voc√™ pode consultar a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descri√ß√£o do conjunto de dados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linha de base</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes do treinamento do modelo, os dados foram divididos em amostras de treinamento (treinamento) e teste (teste) na propor√ß√£o de 0,8 / 0,2. Al√©m disso, a divis√£o n√£o ocorreu de acordo com os eventos, mas de acordo com os casos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para determinar como √© apropriado usar uma solu√ß√£o nativa complexa na forma de uma rede neural, a linha de base foi constru√≠da usando o CatBoost, uma biblioteca avan√ßada de aumento de gradiente nas √°rvores de decis√£o. Para construir uma linha de base, foi realizado um pr√©-processamento m√≠nimo de dados (codifica√ß√£o de recursos categ√≥ricos com a frequ√™ncia correspondente nos dados), uma vari√°vel de destino (dura√ß√£o do caso) e v√°rios novos recursos (al√©m dos que j√° estavam no conjunto de dados original):</font></font><br>
<br>
<ul>
<li>   .  ,        :      ,         ,     ,          ,   ,      .<br>
</li>
<li>Exponential Moving Average     . EMA     ,         .<br>
</li>
<li>     (, ,  ).<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s o treinamento do CatBoostRegressor no conjunto de treinamento, obtivemos o seguinte resultado: MAE (Erro Absoluto M√©dio) = 17,5 dias (ou seja, o valor da vari√°vel de destino prevista √©, em m√©dia, 17,5 dias diferente do valor real). Este resultado foi usado para testar a efic√°cia de uma rede neural.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dos detalhes importantes aqui √© o desenvolvimento da vari√°vel de destino para a linha de base.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ter um caso. N√≥s o denotamos por c_i do conjunto C (o conjunto de todos os casos em nosso conjunto de dados). Cada caso √© uma sequ√™ncia ordenada de eventos, ou seja, c_i = (e_0, ‚Äã‚Äã..., e_ni), em que ni √© a dura√ß√£o do i-√©simo caso. Para cada evento, temos um carimbo de hora - a hora exata em que come√ßou. Usando esses carimbos tempor√°rios, voc√™ pode calcular a dura√ß√£o do caso sem o √∫ltimo evento. No entanto, atribuir um alvo para cada evento, ou seja, fazer uma correspond√™ncia ek ‚àà ‚Äã‚Äãci, ek ‚Üí ti (ti √© a dura√ß√£o do i-√©simo caso), n√£o √© muito bom. Em primeiro lugar, eventos semelhantes (t√≠picos) podem ocorrer em casos de diferentes dura√ß√µes. Em segundo lugar, queremos prever a dura√ß√£o do caso a partir de uma certa subsequ√™ncia (ordenada no tempo) de eventos (isso √© motivado pelo fato de n√£o conhecermos toda a sequ√™ncia de eventos, ou seja, n√£o conhecemos o caso antescomo aconteceu, mas queremos fazer uma avalia√ß√£o da dura√ß√£o de todo o caso de acordo com alguns eventos conhecidos (ocorridos) desse caso).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, voc√™ precisa dividir cada caso em subsequ√™ncias de tamanho de um para o tamanho do caso de eventos ordenados por tempo e atribuir uma vari√°vel de destino igual √† dura√ß√£o do caso do qual essas subsequ√™ncias s√£o obtidas, ou seja, as correspond√™ncias ci ‚àà C, ci ‚Üí {sub_cj} ni (ni como antes, o comprimento do i-√©simo caso), j = 1 e len (sub_cj) = j. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, dividimos cada caso em subsequ√™ncias e atribu√≠mos a dura√ß√£o de todo o caso a cada uma dessas subsequ√™ncias. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais sobre subsequ√™ncias</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como mencionado anteriormente, dividimos o caso em subsequ√™ncias e atribu√≠mos a dura√ß√£o do caso a cada uma delas. Vamos usar o refor√ßo, que √© exato para o tamanho dos dados de entrada. Ent√£o agora temos X = {{sub_c </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> } </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ni </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k = 1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> } </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t = 1 N</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sub_c </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ik</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© a k-√©sima subsequ√™ncia do i-√©simo caso, t </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© a dura√ß√£o do i-√©simo caso, N √© o n√∫mero de casos. Ou seja, a dimens√£o [‚àë </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t = 1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sc, 17], </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© uma vari√°vel igual ao comprimento da subsequ√™ncia do caso correspondente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de codificar as vari√°veis ‚Äã‚Äãcateg√≥ricas por sua frequ√™ncia, temos vari√°veis ‚Äã‚Äãreais e booleanas, bem como vari√°veis ‚Äã‚Äãcateg√≥ricas codificadas (vari√°veis ‚Äã‚Äãde √≠ndice n√£o ser√£o usadas no processo de aprendizagem). Tamb√©m podemos calcular valores m√©dios em uma subsequ√™ncia, enquanto em caracter√≠sticas categ√≥ricas a frequ√™ncia m√©dia dos valores categ√≥ricos ocorridos √© obtida, o que tamb√©m pode ser considerado como uma caracter√≠stica que descreve a agrega√ß√£o de um subconjunto de eventos em um caso, ou seja, como uma caracter√≠stica que descreve uma subsequ√™ncia. Deixe-o e veja o que acontece. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a m√©dia de sc sobre a dimens√£o, obtemos a seguinte dimens√£o: [‚àë </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t = 1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , 17]. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Constru√ß√£o de modelo</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com base nos casos, dividimos o trem em outro trem e uma amostra de valida√ß√£o, pegamos um CatBoostRegressor com par√¢metros padr√£o, passamos uma amostra de treinamento, validamos uma amostra de valida√ß√£o, fazemos a melhor itera√ß√£o, usamos o MAE como uma m√©trica de valida√ß√£o. Conseguimos o seguinte (na figura abaixo) no teste (prepararemos o teste separadamente para o mesmo pipeline em que o trem foi constru√≠do. Todos os sinais s√£o baseados nos dados que est√£o no teste, ou seja, n√£o temos nenhum sinal focado na vari√°vel de destino. A √∫nica ressalva: se os recursos categ√≥ricos no teste n√£o atenderem ao valor que vimos no treinamento, consideraremos a frequ√™ncia desse valor no teste e atualizaremos o dicion√°rio para codifica√ß√£o). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultados da linha de base</font></font></b><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/90b/f18/386/90bf183863f8ad2cdb50098c58d06a37.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
‚Ä¢ Itera√ß√µes: 500. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Taxa de aprendizado: 0,1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par√¢metros de treinamento:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Tempo de treinamento: menos de 2 minutos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Ferro: Tesla k80 (da colab). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resultados: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Teste MAE: 17,5 dias. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ A dura√ß√£o m√©dia do caso no teste: 66,3 dias.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rede neural</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para treinar a rede neural, os dados foram aprimorados: constru√≠ram-se combina√ß√µes para vari√°veis ‚Äã‚Äãcateg√≥ricas e ajustou-se a distribui√ß√£o da vari√°vel alvo. </font><font style="vertical-align: inherit;">Em seguida, a rede neural foi treinada no NVIDIA Tesla K80 (Google Colab) e na NVIDIA DGX Station. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os seguintes resultados foram obtidos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tempo de treinamento no NVIDIA K80 (Google Colab): 20 minutos.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tempo de treinamento na esta√ß√£o NVIDIA DGX: 8 minutos.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tempo de treinamento da rede neural √© devido √† diferen√ßa nas caracter√≠sticas t√©cnicas das GPUs utilizadas:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NVIDIA Tesla K80 (Google Colab)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta√ß√£o NVIDIA DGX</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1X NVIDIA Tesla K80 12GB</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4X NVIDIA Tesla V100 32GB</font></font><br>
</td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©-processando</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Novos sinais</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EMA sobre o valor do evento: queremos acompanhar a tend√™ncia no custo das atividades para cada caso.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo de falha: na descri√ß√£o do conjunto de dados, voc√™ pode encontrar informa√ß√µes sobre quatro tipos de algumas estat√≠sticas descritivas da compra (evento) - esses tipos s√£o divididos nos valores de duas vari√°veis ‚Äã‚Äãno conjunto de dados original. </font><font style="vertical-align: inherit;">N√≥s simplesmente o agregamos novamente (se voc√™ olhar para a descri√ß√£o do conjunto de dados, ficar√° claro do que estamos falando).</font></font><br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sinais categ√≥ricos</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Simplesmente codificamos os valores √∫nicos dos sinais categ√≥ricos com n√∫meros naturais em ordem, para que mais tarde possamos ensinar os casamentos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incorpora√ß√µes para vari√°veis ‚Äã‚Äãcateg√≥ricas</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Determinamos a dimens√£o das incorpora√ß√µes para cada vari√°vel categ√≥rica:</font></font><br>
<br>
<ul>
<li>,   ÃÜ  ÃÜ ÃÜ.    ÃÜ ,         ÃÜ  ÃÜ ,    ÃÜ,  .  : MUi&nbsp; = min(CAT_EMBEDDING_DIM; (len(uniquei) + 1) // 2), CAT_EMBEDDING_DIM ‚Äî , uniquei ‚Äî   i-  .<br>
</li>
<li> ,      3,       i-ÃÜ ÃÜ   max(3;MUi)+1,  1,        ,     train,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">unk</a>-.<br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajustamos a distribui√ß√£o do alvo na amostra de trem, que</font></font></b>&nbsp;<br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
passou a ser muito deslocada para a esquerda devido a valores discrepantes (casos que duraram 250 mil dias) e a um grande n√∫mero de casos curtos; portanto, contamos os percentis 0,05 e 0,95 e deixamos os dados do trem com o objetivo entre essas corredeiras.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, ainda temos casos que duram cerca de um e cerca de 100 dias, ou seja, a vari√°vel alvo passa por v√°rias ordens de magnitude. Portanto, a suposi√ß√£o de que a varia√ß√£o √© constante na distribui√ß√£o da vari√°vel de destino em torno do algoritmo de decis√£o dificilmente √© cumprida, ou seja, a distribui√ß√£o da vari√°vel de destino √© pr√≥xima do normal, mas a varia√ß√£o n√£o √© constante devido ao fato de que a vari√°vel de destino pode ser menor que 1 ou mais que 100. Portanto, pelo menos de alguma forma, nivelar esse efeito, normalizamos os dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O resultado √© mostrado no gr√°fico abaixo (a linha preta √© a distribui√ß√£o normal).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/k4/qs/vz/k4qsvz1egedfnm9q4y6nljidoam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, dividimos por caso nossos dados em treinamento e valida√ß√£o. </font><font style="vertical-align: inherit;">Tamb√©m h√° uma nuance √≥bvia aqui: normalizamos o alvo com a m√©dia e o desvio, calculados de acordo com todos os dados, e depois dividimos por trem e valida√ß√£o, ou seja, ele aparece como um rosto em um trem, mas como resolvemos um problema auxiliar aqui, esse rosto n√£o parece cr√≠tico.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sinais de constru√ß√£o</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Id√©ia</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tomamos apenas sinais categ√≥ricos de nosso trem, codificados por n√∫meros naturais.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o extra√≠mos substrings de casos, mas simplesmente eventos, ou seja, uma linha em nossos dados para incorpora√ß√£o - esse √© um evento caracterizado por recursos categ√≥ricos codificados.</font></font><br>
</li>
<li> :     ,   ÃÜ,      ,   ,        ,            ÃÜ  ÃÜ    ÃÜ. - ,         ÃÜ,  ,  ,     ÃÜ (    ),      (     ,  - ÃÜ  ).<br>
</li>
<li>       ÃÜ        .<br>
</li>
<li>     ,     8-ÃÜÃÜ   elu   ÃÜ,   (  ,   ,     ,  L2-)     .<br>
</li>
<li>,           , ‚Äî    ,      ,    .<br>
</li>
<li>Summary:    ‚Äî ÃÜ  ÃÜ ÃÜ ÃÜ        ‚Äî  ÃÜ.<br>
</li>
</ul><br>
<h3>   </h3><br>
<ul>
<li>Batch size = 1000</li>
<li>Learning rate = 3e-04.</li>
<li>  = 15.</li>
<li>: Tesla k80 (colab) + Nvidia DGX Station .</li>
<li> (colab) ‚Äì 50 .</li>
<li> (Nvidia DGX Station) ‚Äî 18 .</li>
</ul><br>
<img src="https://habrastorage.org/webt/53/4y/gh/534yghkinehatjl8cm1xwg5j0oi.png"><br>
<br>
<h3> </h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prepara√ß√£o de dados</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Agora, temos incorpora√ß√µes para vari√°veis ‚Äã‚Äãcateg√≥ricas (h√° uma nuance aqui: honestamente, pegamos valores √∫nicos de vari√°veis ‚Äã‚Äãcateg√≥ricas em nosso trem (n√£o no que alocamos para treinamentos em casamentos, mas no que alocamos no in√≠cio para treinamento), portanto, h√° uma chance de que, nos dados de teste, haja um valor de vari√°veis ‚Äã‚Äãcateg√≥ricas que n√£o vimos no trem, ou seja, n√£o temos incorpora√ß√£o treinada para esse valor.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para esses valores, uma linha separada √© criada nas matrizes de incorpora√ß√£o, mas, no nosso caso, o problema √© que, durante o treinamento, ela n√£o est√° envolvida e, portanto, n√£o estuda. Com base nisso, se encontrarmos um valor de uma vari√°vel categ√≥rica que n√£o era vista antes, pegaremos esse vetor, mas, na verdade, ele √© simplesmente retirado da distribui√ß√£o inicial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em como treinar esse vetor, h√° uma dire√ß√£o para melhorar o modelo. A id√©ia √© que valores muito raros no trem possam ser codificados com esse vetor, porque se virmos um novo valor apenas no teste, que comp√µe condicionalmente 20% de toda a amostra inicial, esse valor √© raro e provavelmente se comporta mesmos valores raros no trem.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em cada evento, substitu√≠mos as vari√°veis ‚Äã‚Äãcateg√≥ricas pela incorpora√ß√£o correspondente, conectamos aos atributos real e booleano, obtemos uma matriz de tamanho [N, F], em que F √© a soma das dimens√µes das incorpora√ß√µes para vari√°veis ‚Äã‚Äãcateg√≥ricas, o n√∫mero de atributos reais e booleanos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Realizamos um agrupamento de eventos em uma subsequ√™ncia (como feito anteriormente). </font><font style="vertical-align: inherit;">A vari√°vel de destino para a subsequ√™ncia √© a dura√ß√£o do caso em que a subsequ√™ncia foi obtida. </font><font style="vertical-align: inherit;">Adicione o n√∫mero de eventos e a soma dos custos dos eventos nessa subsequ√™ncia ao vetor da subsequ√™ncia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora temos uma matriz de tamanho fixo - voc√™ pode alimentar o modelo (antes disso, normalizamos a matriz). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©todo de paraleliza√ß√£o</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazemos uma torre para cada gpu.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em cada etapa, dividimos os par√¢metros entre as torres.</font></font><br>
</li>
<li>       .<br>
</li>
<li> ÃÜ   ,   .<br>
</li>
<li>       (      ,       ÃÜ ÃÜ         ).<br>
</li>
<li>        .<br>
</li>
<li>     ,   -  (   ,  word2vec-style,     ).<br>
</li>
</ul><br>
<b></b><br>
<br>
<ul>
<li>          ()   ()  ().<br>
</li>
<li>ÃÜ :   ‚Äî   ,     gpu     ,    ,   gpu     .<br>
</li>
</ul><br>
<b></b><br>
<br>
<ul>
<li>: 7-ÃÜÃÜ    elu.<br>
</li>
<li>   ÃÜ ,    .<br>
</li>
<li>Batch size = 1000.<br>
</li>
<li>Learning rate = 3e-04.<br>
</li>
<li>  = 15.<br>
</li>
<li>: Tesla k80 (colab) + Nvidia DGX Station.<br>
</li>
<li> (colab) = 20 .<br>
</li>
<li> (Nvidia DGX Station) = 8 .<br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma parte do gr√°fico do modelo </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/u5/4e/3e/u54e3eoth5n5kmcdryndbpqgcua.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consumo de recursos e paraleliza√ß√£o O</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
treinamento da rede neural em uma CPU leva cerca de quatro vezes mais tempo que em uma esta√ß√£o NVIDIA DGX. Nesse caso, a diferen√ßa parece insignificante - oito minutos na NVIDIA DGX Station e 32 minutos na CPU. No entanto, este √© um modelo pequeno com uma pequena quantidade de dados. Ao implementar projetos reais, onde haver√° v√°rias vezes mais casos e eventos, o treinamento na CPU levar√° pelo menos uma semana. Nesse caso, o uso da NVIDIA DGX Station reduzir√° o tempo de treinamento para dois dias, o que aumentar√° bastante a efici√™ncia do trabalho.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m foi revelado que a velocidade do processo de aprendizado depende muito do n√∫mero de GPUs usadas, o que mostra a vantagem da NVIDIA DGX Station.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© confirmado por experimentos anteriores na CPU e GPU NVIDIA DGX Station usando o conjunto de dados original sem qualquer processamento preliminar:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tempo de aprendizado na CPU: 6 minutos e 18 segundos.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tempo de treinamento da GPU: 34 segundos.</font></font><br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">Visualiza√ß√£o de carga da </font></b><b><font style="vertical-align: inherit;">GPU </font></b></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/6f1/015/d82/6f1015d82101dda1e0af40e599ee96a2.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualiza√ß√£o de carga da CPU</font></font></b><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/efe/3ae/f3b/efe3aef3b801dcbd14655b3851ae9ad3.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultados de redes neurais</font></font></h3><br>
<img src="https://habrastorage.org/webt/-g/2g/p1/-g2gp1o1sdktbwtspcurjfdiwqu.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teste MAE = 10 dias.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A dura√ß√£o m√©dia do caso no teste = 67 dias.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tempo de infer√™ncia = 20 segundos.</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">achados</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementamos um piloto para avaliar m√©todos de aprendizado de m√°quina no contexto de tarefas de Minera√ß√£o de Processos.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testamos e expandimos a lista de nossas ferramentas com a qual resolveremos problemas importantes para os neg√≥cios.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um dos resultados interessantes foi a cria√ß√£o de nossa pr√≥pria implementa√ß√£o de computa√ß√£o paralela em 4 placas Tesla v100, equipadas com a esta√ß√£o DGX: o uso de v√°rias gpu acelera o aprendizado quase alinhado com o n√∫mero de gpu (o c√≥digo √© paralelo).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A transi√ß√£o para uma entrada totalmente cont√≠nua e o uso de uma rede neural tornaram poss√≠vel tirar uma semana da linha de base.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O tempo aumenta de alguns minutos para uma hora e meia (treinamento em arquitetura final e incorpora√ß√£o, mas as incorpora√ß√£o podem ser usadas pr√©-treinadas, para que o tempo seja reduzido para 20 minutos).</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As experi√™ncias descritas mostram que, no campo da minera√ß√£o de processos, os algoritmos de aprendizado profundo e de m√°quina podem ser aplicados com sucesso. </font><font style="vertical-align: inherit;">Al√©m disso, foi revelado que a velocidade do processo de aprendizado depende muito do n√∫mero de GPUs usadas, o que mostra a vantagem da NVIDIA DGX Station.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que e como pode ser melhorado</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incorpora√ß√µes no estilo Word2vec para eventos</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Quando criamos nosso modelo, incluindo incorpora√ß√µes para vari√°veis ‚Äã‚Äãcateg√≥ricas, n√£o levamos em conta a sequ√™ncia de eventos entre si, ou seja, a sem√¢ntica peculiar de eventos dentro dos casos. </font><font style="vertical-align: inherit;">Para aprender algo √∫til com a ordem dos eventos dentro dos casos, voc√™ precisa treinar incorpora√ß√µes para esses eventos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Id√©ia</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tomamos uma caracter√≠stica categ√≥rica e uma real, dividimos o real por bucket, ent√£o cada transa√ß√£o ser√° caracterizada pelo valor da vari√°vel categ√≥rica e pelo bucket em que o valor da vari√°vel real cai. </font><font style="vertical-align: inherit;">Combinando esses dois valores, obtemos, por assim dizer, um an√°logo da palavra para o evento.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consideramos o caso como uma senten√ßa (o conjunto de palavras na senten√ßa corresponde ao conjunto de eventos no caso).</font></font><br>
</li>
<li> ÃÜ      ,          ÃÜ   ÃÜ,    ,             .<br>
</li>
<li>   ÃÜ,     Skipgram  CBOW   .<br>
</li>
<li>  ,      ÃÜ,            .<br>
</li>
</ul><br>
<b> </b><br>
<br>
<ul>
<li>  Skipgram.<br>
</li>
<li>  ‚Äî 5.<br>
</li>
</ul><br>
<ul>
<li>Batch size = 1000.<br>
</li>
<li>Learning rate = 3e-04.<br>
</li>
<li>  = 10.<br>
</li>
<li>: Tesla k80 (colab) + Nvidia DGX Station.<br>
</li>
<li> (colab) ‚Äî 20 .<br>
</li>
<li> (Nvidia DGX Station) ‚Äî 8 .<br>
</li>
<li>Test MAE    : 10 ÃÜ.&nbsp;<br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contagem O</font></font></b><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/438/137/cb8/438137cb87ac22637e44a01da4a56dfc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
uso de recursos de incorpora√ß√µes aumenta um d√©cimo de dia por dia. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eventualmente</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os casamentos acabaram, √© claro, sem instru√ß√£o, porque eles treinaram um pouco.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem cerca de 290 recursos de incorpora√ß√µes categ√≥ricas e 20 recursos de incorpora√ß√µes sem√¢nticas (n√£o faz mais sentido, porque o tamanho do dicion√°rio √© pequeno), portanto a influ√™ncia desses recursos sem√¢nticos pode ser nivelada devido a um desequil√≠brio na propor√ß√£o de recursos.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A sem√¢ntica entre os eventos precisa ser de alguma forma adicionada ao conjunto de treinamento, porque, devido ao fato de as sequ√™ncias de eventos (casos) serem ordenadas, a ordem √© importante e as informa√ß√µes podem ser extra√≠das disso.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode usar arquiteturas mais sofisticadas para incorpora√ß√£o.</font></font><br>
</li>
<li>      ,       ,    ‚Äî     .<br>
</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493138/index.html">Fale comigo: o que os rob√¥s de voz podem fazer hoje</a></li>
<li><a href="../pt493140/index.html">As aventuras de Cipollino: Quarantine IT Quest from Flant</a></li>
<li><a href="../pt493142/index.html">"Vamos usar o Kubernetes!" Agora voc√™ tem 8 problemas</a></li>
<li><a href="../pt493146/index.html">Projetos paralelos emocionantes que voc√™ pode fazer hoje</a></li>
<li><a href="../pt493150/index.html">"Remoto" com um roteador Cisco</a></li>
<li><a href="../pt493158/index.html">Loghouse 0.3 - a t√£o esperada atualiza√ß√£o do nosso sistema de registro em Kubernetes</a></li>
<li><a href="../pt493160/index.html">Como aprimoramos a Pesquisa inteligente no hh.ru em 2019: infogr√°ficos</a></li>
<li><a href="../pt493162/index.html">Uma lista aberta de reuni√µes e confer√™ncias on-line</a></li>
<li><a href="../pt493164/index.html">Acontece que o neg√≥cio on-line est√° sobrevivendo no ambiente atual. Por qu√™? DNA exclu√≠do</a></li>
<li><a href="../pt493166/index.html">Ontol: uma sele√ß√£o de artigos sobre "burnout" [100+]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>