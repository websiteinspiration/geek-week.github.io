<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛄 🗃️ 🛋️ Erkennen Sie die Eskalation von Berechtigungen in ABBYY FineReader 🤜🏽 🧓🏿 🐹</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Zyklus, in dem ich Sicherheitsanfälligkeiten bezüglich der Eskalation von Berechtigungen in Windows-Anwendungen finde, wird fortgesetzt. In der vo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Erkennen Sie die Eskalation von Berechtigungen in ABBYY FineReader</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pm/blog/488826/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Zyklus, in dem ich Sicherheitsanfälligkeiten bezüglich der Eskalation von Berechtigungen in Windows-Anwendungen finde, wird fortgesetzt. </font><font style="vertical-align: inherit;">In der vorherigen Serie: Steam ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-14743</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-15316</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-17180</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) und Origin ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-19247, CVE-2019-19248</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Aber heute werden wir nicht über den Game Launcher sprechen, sondern über das ABBYY FinerReader-Anwendungssoftwarepaket. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n6/4z/ac/n64zach5hyh0x3hdcoskm6ojz7m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusammenfassung - Ich werde Ihnen sagen, wie Sie dank der Komponente, die die Lizenz überprüft, in 10 Minuten Ihre Rechte von der Benutzerebene auf NT AUTHORITY \ SYSTEM erhöhen können. </font><font style="vertical-align: inherit;">Der Sicherheitsanfälligkeit wurde die Kennung CVE-2019-20383 zugewiesen, ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link zur ABBYY-Website</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
<h2><font color="orange"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachrichtendienst</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe die Testversion von FineReader von der ABBYY-Website heruntergeladen und schnell überprüft, ob es sinnvoll ist, das Produkt auszuwählen, um die Berechtigungen zu erhöhen. Ja, das Produkt enthält einen Dienst, der nach dem Namen "ABBYY-Netzwerklizenzserver" Lizenzen zugeordnet ist und standardmäßig vom Benutzer NT AUTHORITY \ SYSTEM gestartet wird. Ich habe ProcMon gestartet, um das Verhalten des Dienstes zu beobachten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wurde auf die Datei aufmerksam gemacht, die sich im Pfad "C: \ ProgramData \ ABBYY \ FineReader \ 15 \ Licenses \ Licensing.cnt" befindet. Der Dienst liest etwas daraus, schreibt etwas darauf, im Allgemeinen sah die Datei wie ein interessanter Kandidat für Experimente aus. Betrachten Sie den Ordner "C: \ ProgramData \ ABBYY \ FineReader \ 15 \ Licenses". Die vom übergeordneten Ordner geerbte All-Full Access-ACL ("C: \ ProgramData \ ABBYY \ FineReader \ 15") ist für diesen Ordner gültig. Dies bedeutet, dass Sie den gesamten Inhalt einschließlich der Datei "Licensing.cnt" löschen können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem der Dienst das Fehlen der Datei entdeckt hatte, versuchte er sie auf etwas seltsame Weise zu erstellen. Er erstellte eine Datei der Form "tmpXXXX-YYYYYYYYY.tmp", schrieb einige Daten hinein und benannte sie dann in "Licensing.cnt" um. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist das ProcMon-Protokoll, in dem dieser Vorgang zweimal ausgeführt wird.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8h/hk/ro/8hhkroiszje9qtzyovchs1zldjk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst um 20:36 Uhr und dann um 20:46 Uhr. Zwischen diesen Zeitstempeln wurde die Datei erneut gelöscht, um erneut erstellt zu werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rechteck 1 zeigt die Situation an, in der der Dienst das Fehlen einer Datei festgestellt hat. Rechteck 2 - Erstellen Sie eine temporäre Datei. Rechteck 3 - Benennen Sie die temporäre Datei um. Rechteck 4 - Vorgang nach 10 Minuten wiederholen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie das Format des Namens "tmpXXXX_YYYYYYYYY.tmp". Als Teil eines laufenden Prozesses ist XXXX immer konstant. Außerdem ist dies die Kennung des Threads, der diese Arbeit ausführt. JJJJJJJJJ bleibt nicht konstant, aber wenn wir uns zwei benachbarte Starts ansehen (Werte: 430210515 und 430810515), dann scheint dies nur eine Zeitmarke zu sein - der Unterschied zwischen den Zahlen 600000 - fällt überraschenderweise mit 10 Minuten Unterschied zusammen. Einige weitere Tests bestätigen unsere Annahme.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diesen Teil zusammenzufassen. </font><font style="vertical-align: inherit;">Jeder Benutzer kann die Datei "C: \ ProgramData \ ABBYY \ FineReader \ 15 \ Licenses \ Licensing.cnt" löschen und dann sehr häufig den Inhalt des Ordners "C: \ ProgramData \ ABBYY \ FineReader \ 15 \ Licenses" in anfordern Suchen Sie dort irgendwann eine Datei mit dem Namen "tmpXXXX_YYYYYYYYY.tmp". </font><font style="vertical-align: inherit;">Jetzt ist der Benutzer darauf vorbereitet, nach dem Löschen der Datei genau zu wissen, zu welchem ​​Zeitpunkt und mit welchem ​​Namen die Datei beim nächsten Mal erstellt wird.</font></font><br>
<br>
<h2><font color="orange"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt werden wir mit Symlinks spielen</font></font></font></h2><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So erstellen Sie Symlinks ohne Administratorrechte</font></font></b><div class="spoiler_text">  ,           .     . , ,     «C:\abc\1»   «C:\def\2».<br>
<br>
  NTFS reparse point (  NTFS mount point)   «C:\abc»  «\RPC Control\". «\RPC Control\» –        ,   , ,  .    ,   , ,  ,     .       NTFS reparse point ,  ,             .   - ,  -            .<br>
<br>
          .    "\RPC Control\1" &lt;-&gt; «C:\def\2».  ,     «C:\abc\1»,       «C:\def\2».<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Vorgang zum Erstellen einer Lizenzdatei sieht zunächst folgendermaßen aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ln/zh/8w/lnzh8ws9y5e0ewunx4u_pnnhkh8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir den genauen Zeitpunkt des nächsten solchen Vorgangs kennen, können wir die folgenden Symlinks erstellen (wir überspringen den Namen des </font><font style="vertical-align: inherit;">
Quellordners </font><font style="vertical-align: inherit;">"C: \ ProgramData \ ABBYY \ FineReader \ 15 \ Licenses \"): </font><font style="vertical-align: inherit;">Where YYYYYYYYA, YYYYYYYB, JJJJJJJJ, ... JJJJJJJJ - dies sind verschiedene Zeitstempel im JJJJJJJJ + 10 Minuten (falls der Zeitstempel etwas spät ist). </font><font style="vertical-align: inherit;">
Erstellen Sie als Nächstes einen Link: </font><font style="vertical-align: inherit;">
Beachten Sie, dass keine dieser Dateien wirklich vorhanden ist. Dies ist erforderlich, damit beim Verweisen auf beispielsweise tmpXXXX_YYYYYYYYB.tmp zwei Weiterleitungen auftreten und der Dienst daher mit der Datei "C: \ test \ l2 \ nope" arbeitet. </font><font style="vertical-align: inherit;">
Sobald wir die Erstellung der Datei "C: \ test \ l2 \ nope" entdecken, sollten wir sofort zwei neue Symlinks erstellen:</font></font><br>
<br>
<code>tmpXXXX_YYYYYYYYA.tmp &lt;-&gt; C:\test\l1\proxy<br>
tmpXXXX_YYYYYYYYB.tmp &lt;-&gt; C:\test\l1\proxy<br>
tmpXXXX_YYYYYYYYC.tmp &lt;-&gt; C:\test\l1\proxy<br>
…<br>
tmpXXXX_YYYYYYYYZ.tmp &lt;-&gt; C:\test\l1\proxy</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<code>C:\test\l1\proxy &lt;-&gt; C:\test\l2\nope</code><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<br>
<code>C:\test\l1\proxy &lt;-&gt; C:\test\l2\payload<br>
Licensing.cnt &lt;-&gt; C:\target\path</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Dienst schreibt den Inhalt der Datei weiterhin in "C: \ test \ l2 \ nope", benennt ihn jedoch nach dem Durchlaufen des neuen Symlinks um. Anstatt beispielsweise "tmpXXXX_YYYYYYYYC.tmp" in "Licensing.cnt" umzubenennen, wird "C: \ test \ l2 \ payload" tatsächlich in "C: \ target \ path" umbenannt (verschoben). Tatsächlich können </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir im Auftrag des Benutzers NT AUTHORITY \ SYSTEM eine Datei mit beliebigem Inhalt in einem beliebigen Pfad ablegen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schematisch sieht es so aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m2/bq/cb/m2bqcbiptwhuauds0bpsn4giyjo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Farbe gibt an, was aufgrund des Einflusses von Symlinks tatsächlich ausgeführt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Erhöhen von Berechtigungen mithilfe des resultierenden Grundelements ist bereits einfach - Sie können Ihre DLL an Systemprozesse und ähnliche Dinge anhängen. Zu diesem Zeitpunkt kontaktierte ich ABBYY-Vertreter und gab ihnen Informationen über die Sicherheitsanfälligkeit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laut ABBYY ist die Sicherheitslücke derzeit geschlossen.</font></font><br>
<br>
<h2><font color="orange"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeitleiste</font></font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25.11.2019</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Schwachstellenerkennung </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26.11.2019</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - vom Hersteller einen Sicherheitskontakt angefordert </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26.11.2019</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Senden eines Schwachstellenberichts an den Hersteller </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.09.2019</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Die Sicherheitslücke wurde vom Hersteller bestätigt </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01.10.2020</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Die Sicherheitslücke wurde </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">am 22.01.2020 behoben</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Schwachstellen wurden zugewiesen CVE-2019-20383 </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19.02.2019 .2020</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Veröffentlichung dieses Artikels </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt </font><b><font style="vertical-align: inherit;">derzeit</font></b><font style="vertical-align: inherit;"> viele Projekte und wir erweitern das Team „Prospective Monitoring“. </font><font style="vertical-align: inherit;">Wir suchen Experten für das Studium von Quellcodes sowie Experten für die Analyse mobiler Anwendungen. </font><font style="vertical-align: inherit;">Willst du meinem Team beitreten - schreibe mir, Anastasia (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ana2121</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) oder per Mail info@amonitoring.ru </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Artikel in Englisch.</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488814/index.html">Forge of Empires von AS3 bis Haxe. Post mortem</a></li>
<li><a href="../de488816/index.html">Wie wir Mir verloren haben: ein Feuer auf einer Raumstation, eine Kollision mit einem Progress-Truck, Druckentlastung</a></li>
<li><a href="../de488818/index.html">Durchbrüche #DeepPavlov im Jahr 2019: Rückblick und Ergebnisse des Jahres</a></li>
<li><a href="../de488820/index.html">Wie man bei der Arbeit nicht ausbrennt und was zu tun ist, wenn man immer noch ausbrennt</a></li>
<li><a href="../de488824/index.html">DGTL Design Community Meetup bei der Raiffeisenbank: Broadcast</a></li>
<li><a href="../de488828/index.html">Spam, Spam, Spam ...</a></li>
<li><a href="../de488830/index.html">Internet in Turkmenistan: Preis, Verfügbarkeit und Einschränkungen</a></li>
<li><a href="../de488832/index.html">Überraschenderweise waren Unternehmens-Festplatten im vergangenen Jahr beliebter als SSDs und ihr Umsatz wächst</a></li>
<li><a href="../de488834/index.html">Wie der Fehler von 2009 einen Konflikt zwischen Docker für Windows und Razer Synapse verursacht</a></li>
<li><a href="../de488836/index.html">Einige Aspekte der Arbeit mit Dictionary bei der Entwicklung geladener Anwendungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>