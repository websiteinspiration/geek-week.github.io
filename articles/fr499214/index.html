<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔟 🎅🏻 ⏬ Déployer Hyperledger Fabric 1.4 sur AWS 👩🏻‍🚒 👭 👇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hyperledger Fabric est une plate-forme blockchain open source de la Linux Foundation. Avec lui, vous pouvez créer des applications blockchain et contr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Déployer Hyperledger Fabric 1.4 sur AWS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/499214/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperledger Fabric est une plate-forme blockchain open source de la Linux Foundation. Avec lui, vous pouvez créer des applications blockchain et contrôler l'accès et les autorisations pour les données dans la blockchain. Hyperledger Fabric doit être utilisé si vous souhaitez créer un réseau de blockchain privé ou définir des restrictions sur les transactions que chaque côté peut voir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la documentation d'Hyperledger Fabric, la création d'un réseau blockchain sur une machine à l'aide de Docker est bien planifiée, où chaque membre du réseau est un conteneur séparé. Mais le processus de configuration d'un réseau sur plusieurs machines physiques ou virtuelles n'est pas décrit. Cela sera discuté dans cet article.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre application blockchain est un service de stockage de certaines données médicales des enfants d'âge scolaire et préscolaire. </font><font style="vertical-align: inherit;">Les données doivent être inchangées. </font><font style="vertical-align: inherit;">Ils seront présentés sous la forme d’informations sur la vaccination et l’accord du patient avec un médecin particulier. </font><font style="vertical-align: inherit;">Le réseau comprendra des membres de Parents (une organisation qui représente les intérêts des parents), de l'Hôpital (un hôpital avec les pédiatres dont les parents peuvent conclure un accord pour prendre soin de leurs enfants) et de la maternelle (une école maternelle qui peut demander des rapports de santé et des vaccinations pour ou un autre enfant à l'hôpital).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaîne de blocs gérée par Amazon</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWS dispose d'un service Amazon Managed Blockchain. </font><font style="vertical-align: inherit;">Il vous permet de déployer des réseaux de chaînes de blocs à l'aide des interfaces utilisateur de la console AWS. </font><font style="vertical-align: inherit;">Mais, après avoir acquis une certaine expérience de travail avec Amazon Managed Blockchain, nous avons dû abandonner l'idée d'utiliser le service dans des projets commerciaux. </font><font style="vertical-align: inherit;">Il y avait plusieurs raisons à cela. </font><font style="vertical-align: inherit;">Les principaux sont:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seule la version d'Hyperledger Fabric 1.2 était disponible dans Amazon Managed Blockchain, et au moment d'écrire ces lignes, la version 1.4 est utilisée pour créer des réseaux d'entreprise de blockchain. </font><font style="vertical-align: inherit;">Il ne permet pas non plus l'utilisation de versions modernes des outils SDK Node.js;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Managed Blockchain ne prend pas en charge la base de données CouchDB, ce qui rend difficile la création d'applications qui indexent les données stockées.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, nous pensons qu'il est préférable d'utiliser des serveurs virtuels ou physiques pour créer des réseaux en utilisant le framework Hyperledger Fabric.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos des canaux d'application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hyperledger Fabric a le concept de «canal». </font><font style="vertical-align: inherit;">Un canal est un sous-réseau pour effectuer des transactions sensibles. </font><font style="vertical-align: inherit;">Il y aura deux canaux dans notre application.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Parentshospital". </font><font style="vertical-align: inherit;">Il est destiné aux transactions entre les membres des parents et des organisations hospitalières: création et modification de dossiers médicaux, création d'un accord avec un pédiatre, et signature d'un accord de pédiatre.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Parentshospitalkindergarten." </font><font style="vertical-align: inherit;">Dans ce canal, les membres de Parents and Hospital interagiront avec les membres de Kindergarten. </font><font style="vertical-align: inherit;">De plus, des rapports seront générés sur la base des données des dossiers médicaux.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement de travail</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous déploierons notre réseau de blockchain à l'aide de Docker Swarm - il s'agit du système Docker natif pour le déploiement d'un cluster hôte. Si vous n'avez jamais travaillé avec Docker (et en particulier avec Docker Swarm), consultez d'abord ce produit et comment orchestrer des conteneurs à l'aide de Docker Swarm. La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> décrit les principes de base de l'utilisation de ces outils.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ensemble de notre réseau sera situé sur des serveurs AWS EC2. </font><font style="vertical-align: inherit;">Les informations au sein du réseau blockchain seront stockées dans CouchDB. </font><font style="vertical-align: inherit;">Hyperledger Fabric prend également en charge la base de données LevelDB, mais CouchDB, contrairement à cette dernière, permet de rechercher par n'importe quel critère dans une collection de documents. </font><font style="vertical-align: inherit;">Nous utiliserons également Fabric Certificate Authority - il s'agit d'un composant modulaire pour la gestion des identifiants réseau de toutes les organisations et de leurs utilisateurs. </font><font style="vertical-align: inherit;">Il permet l'enregistrement des participants au réseau et la délivrance de certificats. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous aurons quatre serveurs EC2:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Orderer, MySQL DB (pour stocker les informations d'application qui ne s'appliquent pas aux dossiers médicaux)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisation des parents (Peer0, Peer1), CouchDB, Fabric-CA, CLI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisation hospitalière (Peer0, Peer1), CouchDB, Fabric-CA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisation de la maternelle (Peer0, Peer1), CouchDB, Fabric-CA</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création de serveurs EC2 sur AWS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons besoin des services t2.medium pour fonctionner. </font><font style="vertical-align: inherit;">Ce type de serveur EC2 dispose d'une puissance de calcul suffisante pour installer tous les logiciels nécessaires et fonctionner avec l'outil Hyperledger Fabric. </font><font style="vertical-align: inherit;">Dans Configurer le groupe de sécurité, définissez Tout le trafic et Source - 0.0.0.0/0, :: / 0. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/kx/iu/bbkxiua1teuzbc0jbmajtl-o5i0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 1. </font><font style="vertical-align: inherit;">Configurez le groupe de sécurité dans le panneau AWS. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons quatre serveurs EC2:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-18-232-164-119.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-145-203-186.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-80-241-117.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-52-87-193-235.compute-1.amazonaws.com</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous aurez naturellement vos propres chemins vers les serveurs EC2. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/ab/as/azabas37iihj5xmuaqzrty6-mcc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.2. </font><font style="vertical-align: inherit;">Préparé pour le fonctionnement des serveurs EC2.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation du logiciel prérequis sur les serveurs EC2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, sur chaque serveur EC2, nous devons installer Docker et Git. </font><font style="vertical-align: inherit;">Pour plus de commodité, ouvrez quatre onglets dans le terminal. </font><font style="vertical-align: inherit;">Passons à chaque service EC2 via SSH: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 1:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST1 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 2:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST2 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 3:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST3=ec2-54-80-241-117.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST3 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 4:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST4=ec2-52-87-193-235.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST4 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans chaque terminal, exécutez les commandes suivantes:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum update -y<font></font>
sudo yum install -y docker<font></font>
sudo service docker start<font></font>
sudo docker info<font></font>
sudo yum install git<font></font>
sudo usermod -a -G docker ec2-user<font></font>
newgrp docker<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons maintenant installé Docker et Git.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réseau</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons cloner des éléments de notre réseau à partir du référentiel. </font><font style="vertical-align: inherit;">Pour ce faire, exécutez la commande dans chaque terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/nixsolutions/blockchain-poc-network.git network
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons également cloner les contrats intelligents du référentiel qui réguleront les relations entre les participants du réseau. </font><font style="vertical-align: inherit;">Les contrats intelligents sont écrits dans la langue Golang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous effectuons ces étapes sur chacun des quatre serveurs:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network &amp;&amp; mkdir chaincode &amp;&amp; cd chaincode<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-medical-contract.git medical-contract<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-kindergarten-contract.git kindergarten-contract<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le premier terminal, nous devons générer des fichiers de configuration de canal et des certificats pour connecter les organisations au réseau:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network/poc-network<font></font>
./1_generate_connection_files.sh<font></font>
./2_generating_channel_configuration.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez maintenant les dossiers channel-artifacts et crypto-config vers les trois autres hôtes dans le dossier poc-network du répertoire parent du réseau. </font><font style="vertical-align: inherit;">Remarque: lors de la copie d'organisations sur le serveur EC2, vous devez supprimer les certificats tiers du dossier crypto-config / peerOrganizations qui se rapportent au travail d'autres organisations. </font><font style="vertical-align: inherit;">Par exemple, lors de la copie vers l'hôte Parents, nous devons laisser le dossier parents.poc-network.com dans ce dossier, mais supprimer hospital.poc-network.com et kindergarten.poc-network.com.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création d'une pile Docker Swarm</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que les conteneurs appartenant à différentes organisations et situés sur différents serveurs EC2 puissent accéder les uns aux autres, nous devons les combiner en une pile. </font><font style="vertical-align: inherit;">Regardons notre fichier network / poc-network / docker-compose-general.yaml. </font><font style="vertical-align: inherit;">Il contient la configuration des services, indique sur quels hôtes un service particulier (clé </font></font><code>node.hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">sera déployé </font><font style="vertical-align: inherit;">, les alias (clé </font></font><code>aliases</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">sont indiqués </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons initialiser swarm dans le premier terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm init<font></font>
docker swarm join-token manager<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un jeton apparaîtra pour attacher un autre serveur EC2 à la pile. </font><font style="vertical-align: inherit;">Quelque chose comme: </font></font><code>docker swarm join --token SWMTKN-1-42ml0ohnnbidg8kflgp8xp9dkkus6mn1lslqc15hrxj4tk9e3q-5h4vbzbfk8p90n83oe08gbltf 172.31.46.214:2377</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous pouvons exécuter dans les terminaux restants:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm join --token SWMTKN-1-2xzco7t7txohnzd09318eczpbgmm8woex80byxptpt1jl5i2ar-bsg37h40xze1gaabg80i96gw2 172.31.38.245:2377
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un message apparaît dans la console:</font></font><br>
<br>
<pre><code class="plaintext hljs">This node joined a swarm as a manager.
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois les trois hôtes connectés à Swarm, nous pouvons les voir dans le terminal du premier hôte en exécutant la commande:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker node ls
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16d/687/898/16d687898e5eb8b4ed00883d4eef2de7.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.3. </font><font style="vertical-align: inherit;">Liste des serveurs dans Docker Swarm. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le dossier network / poc-network, il y a un fichier .env.template dans lequel vous devez spécifier un nom d'hôte pour chacun des hôtes: </font></font><br>
<br>
<code>ORDERER=ip-172-31-38-245</code><br>
<code>PARENTS=ip-172-31-43-64</code><br>
<code>HOSPITAL=ip-172-31-38-130</code><br>
<code>KINDERGARTEN=ip-172-31-40-157</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour générer un fichier .env, vous devez exécuter le fichier ./3_env_gen.sh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez maintenant un réseau avec un pilote </font></font><code>overlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker network create --driver overlay --attachable stage_byfn
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez Swarm pour créer une pile basée sur le fichier docker-compose-general.yaml:</font></font><br>
<br>
<pre><code class="plaintext hljs">env $(cat .env | grep ^[A-Z] | xargs) docker stack deploy -c docker-compose-general.yaml stage 2&gt;&amp;1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette commande, nous définissons également des variables d'environnement, décrites dans le fichier .env et nécessaires au bon fonctionnement du réseau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez exécuter la commande </font></font><code>docker service ls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le premier terminal. </font><font style="vertical-align: inherit;">Vous verrez une liste de tous les services qui s'exécutent sur toutes nos instances EC2.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc6/d4d/e6c/dc6d4de6c534c2b97430a1cf2e45512c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.4. </font><font style="vertical-align: inherit;">Liste de tous les services exécutés sur tous les serveurs EC2. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous voyez la même chose dans votre terminal que dans la capture d'écran, alors tout va bien. </font><font style="vertical-align: inherit;">Exécutez maintenant notre réseau. </font><font style="vertical-align: inherit;">Dans le deuxième terminal, vous devez entrer le conteneur CLI (après tout, ce conteneur est déployé sur le deuxième hôte):</font></font><br>
<br>
<pre><code class="plaintext hljs">docker exec -ti stage_cli.1.owni217t53m53efjtikb5oa2f /bin/bash
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nom du conteneur peut être vu en exécutant la commande dans le terminal </font></font><code>docker ps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le conteneur, nous exécutons toutes nos commandes à partir du fichier 4_create_channels.sh, en les copiant une par une vers le terminal. </font><font style="vertical-align: inherit;">Dans le dossier bin, nous avons les binaires pour créer le réseau:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peer channel create - crée des canaux;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jointure de canal de pair - joindre un pair à un canal;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mise à jour du canal homologue - mettre à jour les configurations;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installation du code de chaîne par les pairs - installez le code de code;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peer chaincode instantiate - déployez le code de chaîne spécifié sur le réseau.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez maintenant quitter le conteneur en exécutant la commande </font></font><code>exit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demande de retour des parents</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez l'application sur le deuxième hôte:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons également installer NodeJS et gcc-c ++ (compilateur):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons également entrer dans notre base de données via l'administrateur avec les données d'autorisation suivantes: </font></font><br>
<br>
<code>&lt;HOST_1&gt;:3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(où </font></font><code>&lt;HOST_1&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est l'adresse du premier serveur EC2 sur lequel la base de données est stockée) </font></font><br>
<code>dev</code><br>
<code>devpass</code><br>
<code>poc_database</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est également nécessaire de connecter notre application API à la base de données:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/config/config.json
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Attribuez la valeur correcte à la clé </font></font><code>host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Notre back-application a préparé des migrations et des graines. </font><font style="vertical-align: inherit;">Vous devez les exécuter:</font></font><br>
<br>
<pre><code class="plaintext hljs">npx sequelize-cli db:migrate<font></font>
npx sequelize-cli db:seed:all<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les tableaux doivent apparaître dans la base de données. </font><font style="vertical-align: inherit;">Et dans le tableau des organisations, nous verrons trois lignes avec nos organisations - parents, hôpital, jardin d'enfants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la génération des certificats au tout début, nous avons reçu des fichiers de connexion au réseau pour chaque organisation sur le premier hôte. </font><font style="vertical-align: inherit;">Copiez le fichier connection-parents.json du premier hôte au second. </font><font style="vertical-align: inherit;">Pour ce faire, ouvrez un autre terminal à partir du dossier où </font></font><code>key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se trouve le </font><font style="vertical-align: inherit;">nôtre </font><font style="vertical-align: inherit;">et exécutez les commandes:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-parents.json ~<font></font>
scp -i ./key-poc.pem ~/connection-parents.json ec2-user@$HOST2:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correction </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans constants.js (valeur pour l'hôte actuel):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez notre application dans le deuxième terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier userGenerator.sh, affectez la </font></font><code>HOST_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeur correcte à la </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez exécuter un script qui créera des utilisateurs de l'organisation des parents:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh parents
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez le script pour générer des dossiers médicaux:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deux cartes seront créées dans la blockchain, qui seront également écrites dans la base de données SQL dans le tableau des cartes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demande de retour à l'hôpital</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par analogie avec la back-application précédente, nous devons placer le fichier pour se connecter au réseau sur le troisième hôte. </font><font style="vertical-align: inherit;">Pour ce faire, dans le cinquième terminal, exécutez:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-hospital.json ~<font></font>
scp -i ./key-poc.pem ~/connection-hospital.json ec2-user@$HOST3:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous clonerons notre application sur le troisième hôte:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez NodeJS et gcc-c ++ (compilateur):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correction </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans constants.js (valeur pour l'hôte actuel):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez notre application dans le troisième terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier userGenerator.sh, affectez la </font></font><code>HOST_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeur correcte à la </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons exécuter un script qui créera des utilisateurs de l'organisation hospitalière:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh hospital
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons maintenant un deuxième utilisateur dans la table Users de la base de données.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demande de retour à la maternelle</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par analogie avec la back-application précédente, nous devons placer le fichier pour se connecter au réseau sur le troisième hôte. </font><font style="vertical-align: inherit;">Pour ce faire, dans le cinquième terminal, exécutez:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-kindergarten.json ~<font></font>
scp -i ./key-poc.pem ~/connection-kindergarten.json ec2-user@$HOST4:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous clonerons notre application sur le troisième hôte:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez NodeJS et Gcc-c ++ (compilateur):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correction </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans constants.js (valeur pour l'hôte actuel):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez notre application dans le troisième terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier userGenerator.sh, affectez la </font></font><code>HOST_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeur correcte à la </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons exécuter un script qui créera des utilisateurs de l'organisation hospitalière:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh kindergarten
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons maintenant un troisième utilisateur dans la table Users de la base de données.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installez wkhtmltopdf sur les deuxième, troisième et quatrième serveurs EC2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La contre-application utilise la bibliothèque wkhtmltopdf pour générer un rapport PDF sur l'état de santé de l'enfant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons installer libpng - la bibliothèque officielle pour travailler avec des graphiques raster au format PNG. </font><font style="vertical-align: inherit;">La bibliothèque est indépendante de la plateforme et se compose de fonctions écrites en langage C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première équipe installera wkhtmltox - la bibliothèque open source LGPLv3 pour le rendu HTML au format PDF et divers formats d'image à l'aide du moteur de rendu QtWebKit:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://downloads.wkhtmltopdf.org/0.12/0.12.5/wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
sudo yum install -y wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième bloc de commandes téléchargera et déploiera la bibliothèque libpng15:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://sourceforge.net/projects/libpng/files/libpng15/older-releases/1.5.15/libpng-1.5.15.tar.gz/download -O libpng-1.5.15.tar.gz<font></font>
tar -zxvf libpng-1.5.15.tar.gz<font></font>
cd libpng-1.5.15<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le troisième bloc de commandes est nécessaire pour installer le compilateur:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum groupinstall -y "Development Tools"<font></font>
./configure --prefix=/usr<font></font>
sudo make install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez toujours installer LibTIFF:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install -y libtiff
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons tester:</font></font><br>
<br>
<pre><code class="plaintext hljs">wkhtmltopdf https://majestic.cloud majestic.pdf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez maintenant générer et afficher des documents PDF.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu sur Node SDK</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les outils NodeJS pour travailler avec le réseau Hyperledger Fabric sont présentés sous la forme de packages "fabric-ca-client -v 1.4.0" et "fabric-network" v 1.4.0 ". </font><font style="vertical-align: inherit;">Tous les services de l'application d'arrière-plan qui interagissent avec le réseau à l'aide du SDK Node se trouvent dans le dossier Services, à la racine du projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez lire sur ces outils et leurs méthodes dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation officielle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processus métier d'application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant parler de la façon dont les membres du réseau interagissent entre eux dans cette application. </font><font style="vertical-align: inherit;">Tous les processus sont décrits dans un diagramme UML. </font><font style="vertical-align: inherit;">Examinons chacun d'eux plus en détail.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31f/484/89d/31f48489d84e6f301b105a4cff8b45c7.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.5. Une description graphique des processus métier dans l'application.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ainsi, il existe plusieurs organisations sur le réseau: Parents, Hospital et Kindergarten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un membre des parents crée des dossiers de santé électroniques pour deux de leurs enfants. Ces données seront stockées (et complétées) dans le réseau blockchain. Ensuite, le parent envoie une demande d'accord avec le pédiatre, qui observera ses enfants jusqu'à l'âge adulte (dans le schéma - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demande d'accord avec un médecin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un membre de l'organisation hospitalière signe un accord (dans le schéma - le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">médecin signe un accord</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, le parent envoie une demande au jardin d'enfants avec une demande d'inscription de son enfant (dans le diagramme - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demande de jardin d'enfants pour recevoir un enfant</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf9/da3/cee/cf9da3ceedba087e53abef137fbe353b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.6. </font><font style="vertical-align: inherit;">Une page avec une liste des établissements d'enseignement disponibles dans le compte des parents. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le jardin d'enfants voit la demande dans la liste des nouvelles demandes:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/d01/a8b/7cdd01a8bf99c9cf9d916eef519ff66b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.7. </font><font style="vertical-align: inherit;">Une page avec une liste des demandes d'admission au compte personnel de l'établissement d'enseignement. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le jardin d'enfants avant de décider de l'admission de l'enfant doit s'assurer de son état de santé satisfaisant. </font><font style="vertical-align: inherit;">Pour ce faire, le jardin d'enfants envoie une demande à la clinique dans laquelle cet enfant est observé (dans le schéma - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demande de rapport de santé enfant</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">La demande au pédiatre est exécutée automatiquement après que la demande d'admission au jardin est déplacée vers l'onglet "Accepté".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff1/5af/d29/ff15afd292455ccf1a0e9cdc69315f4c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.8. </font><font style="vertical-align: inherit;">Une page avec une liste des demandes d'admission approuvées sur le compte personnel de l'établissement d'enseignement. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le pédiatre voit la demande et génère un rapport contenant des données sur la santé de l'enfant (dans le diagramme - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">création d'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un rapport sur la santé de l' </font><i><font style="vertical-align: inherit;">enfant</font></i><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/1e6/1f2/8be1e61f2dbbd9e146259a5b3a11ffa2.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.9. </font><font style="vertical-align: inherit;">Une page avec une liste d'applications pour créer un rapport sur l'état de santé de l'enfant dans le compte personnel de l'hôpital. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le parent voit que le pédiatre a généré un rapport:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06d/fe9/c40/06dfe9c403dfe790632d631c7a54e7b0.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.10. </font><font style="vertical-align: inherit;">Une page dans le compte personnel du parent, qui affiche l'état des rapports sur l'état de santé de l'enfant. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... et décide d'autoriser l'accès à l'établissement d'enseignement préscolaire pour consulter et télécharger le rapport (dans le diagramme - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autoriser la consultation du rapport</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35f/ed9/c86/35fed9c8680c84dda737f7acb6029afc.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.11. </font><font style="vertical-align: inherit;">Une fenêtre contextuelle pour choisir un établissement d'enseignement qui peut afficher le rapport médical généré. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le parent clique sur "Confirmer":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/00d/cb5/3cf00dcb54572c2b93b3f2af509d8245.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.12. </font><font style="vertical-align: inherit;">Notification que l'établissement d'enseignement sélectionné a reçu l'autorisation de consulter le rapport médical. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la liste des rapports dans l'application de l'établissement d'enseignement, il apparaît que le rapport a été généré et est disponible pour consultation et téléchargement au format PDF.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b6/a1a/ac2/2b6a1aac247da598bf28f434d0614616.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.13. </font><font style="vertical-align: inherit;">Lien pour télécharger le rapport au format PDF en ligne avec la demande approuvée. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un rapport que vous verrez dans un nouvel onglet sur votre ordinateur:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbb/94a/1e1/fbb94a1e19e8e0db4354d2cc60b6927e.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.14. </font><font style="vertical-align: inherit;">Un rapport de santé généré par un employé de l'hôpital.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création de dossiers médicaux et accords avec un pédiatre, signature d'un accord</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que l'application est davantage conçue pour démontrer le déploiement du réseau sur des serveurs EC2 distincts, nous exécuterons certaines commandes à partir des scripts préparés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Premier serveur EC2:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous nous sommes précédemment connectés à la base de données. </font><font style="vertical-align: inherit;">Après avoir exécuté la commande, vous verrez deux entrées dans le tableau Cartes. </font><font style="vertical-align: inherit;">De plus, des informations sur les données médicales de ces deux enfants ont été enregistrées sur la blockchain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À partir de ce serveur EC2, nous devons créer un accord avec un pédiatre qui observera les enfants:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/createAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet accord doit maintenant être signé par l'utilisateur que nous avons créé pour l'organisation Hospital. </font><font style="vertical-align: inherit;">Nous exécutons la commande à partir du deuxième hôte:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/signAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre accord est signé par le médecin et nous pouvons continuer à travailler sur notre demande. </font><font style="vertical-align: inherit;">Ensuite, nous devons installer l'application frontale sur les deuxième, troisième et quatrième serveurs EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS: Vous pouvez trouver toutes les commandes pour générer des utilisateurs, des cartes, des accords et signer des accords dans le dossier ~ / back / generators.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parents Frontend Application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécuter sur le deuxième hôte (où se trouve l'organisation des parents):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous créons le fichier .env et spécifions le nom d'hôte sur lequel notre application frontale sera située:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-75-46.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est nécessaire d'établir les dépendances:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez également créer l'application et l'exécuter sur le port 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre application sera disponible à: </font></font><code>http://&lt;HOST_2&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">où </font></font><code>&lt;HOST_2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est l'adresse du deuxième serveur EC2 sur lequel se trouve notre application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>parents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mot de </font><font style="vertical-align: inherit;">passe: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici à quoi ressemblera l'interface. </font><font style="vertical-align: inherit;">Ici, vous verrez des informations sur les cartes médicales que nous avons créées à partir du terminal:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/409/71a/2dd/40971a2dde54cabe268936b96d0a3618.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.15. </font><font style="vertical-align: inherit;">Informations sur les dossiers médicaux des enfants dans le compte personnel du parent.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application frontale d'hôpital</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécuter sur le deuxième hôte (où se trouve l'organisation hospitalière):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous créons le fichier .env et spécifions le nom d'hôte sur lequel notre application frontale sera située:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-3-91-238-161.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est nécessaire d'établir les dépendances:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez également créer l'application et l'exécuter sur le port 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre application sera disponible à: </font></font><code>http://&lt;HOST_3&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">où </font></font><code>&lt;HOST_3&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est l'adresse du troisième serveur EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>hospital</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mot de </font><font style="vertical-align: inherit;">passe: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application frontend de la maternelle</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécuter sur le deuxième hôte (où se trouve l'organisation de la maternelle):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous créons le fichier .env et spécifions le nom d'hôte sur lequel notre application frontale sera située:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-12-137.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est nécessaire d'établir les dépendances:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez également créer l'application et l'exécuter sur le port 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre application sera disponible à: </font></font><code>http://&lt;HOST_4&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">où </font></font><code>&lt;HOST_4&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est l'adresse du quatrième serveur EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>kindergarten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mot de </font><font style="vertical-align: inherit;">passe: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons examiné comment déployer un réseau d'applications blockchain sur plusieurs serveurs virtuels ou physiques. </font><font style="vertical-align: inherit;">L'article est conçu pour vous familiariser avec les bases de la technologie blockchain, savoir ce que sont les contrats intelligents et au moins superficiellement familier avec le cadre Hyperledger Fabric et son application standard d'échantillons de tissu.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr499202/index.html">Opium.Fill - standardisation de la palette de couleurs à travers les yeux du programmeur</a></li>
<li><a href="../fr499206/index.html">Assistants virtuels. Créer des chatbots sans programmation</a></li>
<li><a href="../fr499208/index.html">Événements numériques à Moscou du 27 avril au 3 mai</a></li>
<li><a href="../fr499210/index.html">Événements numériques à Saint-Pétersbourg du 27 avril au 3 mai</a></li>
<li><a href="../fr499212/index.html">Séminaires hebdomadaires IBM - avril 2020</a></li>
<li><a href="../fr499216/index.html">Conception au niveau du système. Partie 2. Architecture détaillée</a></li>
<li><a href="../fr499220/index.html">Le transfert de développeurs vers un site distant en raison du coronavirus a augmenté la productivité dans Google et Microsoft</a></li>
<li><a href="../fr499224/index.html">Il est temps de commencer à bien apprendre</a></li>
<li><a href="../fr499226/index.html">Pas de pandémie: comment faire un film sur la crypto-monnaie pour 1000 $ et entrer dans la meilleure distribution de films américains</a></li>
<li><a href="../fr499230/index.html">Comment élever un ver sain et satisfait: analyser le manuel de 1910</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>