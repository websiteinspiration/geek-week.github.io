<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙏🏼 🧖🏻 👩🏻‍🤝‍👨🏽 Roguelike in Unity von Grund auf neu erstellen ♟️ 🎄 🤱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt nicht viele Tutorials zum Erstellen von Roguelike in Unity, daher habe ich beschlossen, es zu schreiben. Nicht zu prahlen, sondern Wissen mit ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Roguelike in Unity von Grund auf neu erstellen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490828/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad4/093/6ab/ad40936ab0dff25fd3214571faf9aa61.png" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt nicht viele Tutorials zum Erstellen von Roguelike in Unity, daher habe ich beschlossen, es zu schreiben. Nicht zu prahlen, sondern Wissen mit denen zu teilen, die sich in der Phase befinden, in der ich schon eine ganze Weile war. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hinweis: Ich sage nicht, dass dies der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einzige</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Weg ist, um in Unity ein Roguelike zu erstellen. Er ist nur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einer von</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wahrscheinlich nicht die beste und effektivste, habe ich durch Ausprobieren gelernt. Und ich werde einige Dinge direkt beim Erstellen eines Tutorials lernen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nehmen wir an, Sie </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kennen zumindest die Grundlagen von Unity</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zum Beispiel, wie man ein Fertighaus oder ein Skript erstellt und dergleichen. </font><font style="vertical-align: inherit;">Erwarten Sie nicht, dass ich Ihnen beibringe, wie man Sprite-Blätter erstellt. Es gibt viele großartige Tutorials dazu. </font><font style="vertical-align: inherit;">Ich werde mich nicht darauf konzentrieren, die Engine zu studieren, sondern darauf, wie das Spiel implementiert wird, das wir gemeinsam erstellen werden. </font><font style="vertical-align: inherit;">Wenn Sie auf Schwierigkeiten </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">stoßen</font></a><font style="vertical-align: inherit;"> 
, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">besuchen Sie</font></a><font style="vertical-align: inherit;"> eine der großartigen Communitys von Discord und bitten Sie um Hilfe: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unity Developer Community </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roguelikes</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Also, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">fangen</font></a><font style="vertical-align: inherit;"> wir an!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stufe 0 - Planung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, das ist richtig. Das erste, was erstellt werden muss, ist ein Plan. Es ist gut für Sie, das Spiel zu planen, und für mich, das Tutorial so zu planen, dass wir nach einer Weile nicht mehr vom Thema abgelenkt werden. Es ist leicht, in den Funktionen des Spiels verwirrt zu werden, genau wie in den schurkenhaften Dungeons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden roguelike schreiben. Wir werden vor allem den klugen Ratschlägen von Cogmind Entwickler Josh Ge folgen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Folgen Sie dem Link, lesen Sie den Beitrag oder sehen Sie sich das Video an und kommen Sie dann zurück.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist der Zweck dieses Tutorials? Holen Sie sich ein solides einfaches Roguelike, mit dem Sie dann experimentieren können. Es sollte eine Dungeon-Generation, einen Spieler, der sich auf der Karte bewegt, Sichtbarkeitsnebel, Feinde und Objekte haben. Nur das Notwendigste. Der Spieler sollte also mehrere Stockwerke die Treppe hinuntergehen können. Nehmen wir an, Sie erhöhen Ihr Level um fünf, verbessern sich und kämpfen am Ende mit dem Boss und besiegen ihn. Oder stirb. Das ist in der Tat alles.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Rat von Josh Ge werden wir die Funktionen des Spiels so gestalten, dass sie uns zum Ziel führen. </font><font style="vertical-align: inherit;">So erhalten wir das Roguelike-Framework, das weiter ausgebaut werden kann. Fügen Sie Ihre eigenen Chips hinzu, um Einzigartigkeit zu schaffen. </font><font style="vertical-align: inherit;">Oder werfen Sie alles in den Korb, nutzen Sie die gesammelten Erfahrungen und fangen Sie von vorne an. </font><font style="vertical-align: inherit;">Es wird sowieso großartig sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde Ihnen keine grafischen Ressourcen geben. </font><font style="vertical-align: inherit;">Zeichnen Sie sie selbst oder verwenden Sie die kostenlosen Kachelsätze, die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder bei der Suche in Google </font><font style="vertical-align: inherit;">heruntergeladen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">werden</font></a><font style="vertical-align: inherit;"> können </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vergiss nur nicht, die Autoren der Grafiken im Spiel zu erwähnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns nun alle Funktionen, die in unserem Roguelike enthalten sein werden, in der Reihenfolge ihrer Implementierung auflisten:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dungeon Map Generation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spielercharakter und seine Bewegung</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sichtbereich</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feinde</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suche nach einem Weg</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kampf, Gesundheit und Tod</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spieler Level Up</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gegenstände (Waffen und Tränke)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konsolen-Cheats (zum Testen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dungeonböden</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speichern und Laden</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endgegner</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir all dies implementiert haben, werden wir ein starkes Roguelike haben und Sie werden Ihre Fähigkeiten zur Spieleentwicklung erheblich verbessern. </font><font style="vertical-align: inherit;">Eigentlich war es </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meine</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Art, </font><em><font style="vertical-align: inherit;">meine</font></em><font style="vertical-align: inherit;"> Fähigkeiten zu verbessern: Code erstellen und Funktionen implementieren. </font><font style="vertical-align: inherit;">Daher bin ich mir sicher, dass Sie auch damit umgehen können.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stufe 1 - MapManager-Klasse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist das erste Skript, das wir erstellen werden, und es wird das Rückgrat unseres Spiels. </font><font style="vertical-align: inherit;">Es ist einfach, enthält aber den Großteil der wichtigen Informationen für das Spiel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie also ein CS-Skript namens MapManager und öffnen Sie es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Löschen Sie ": MonoBehaviour", da es nicht von ihm erbt und an kein GameObject angehängt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entfernen Sie die Funktionen Start () und Update (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie am Ende der MapManager-Klasse eine neue öffentliche Klasse mit dem Namen Tile.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/431/54e/4c2/43154e4c2708a580bc3838b1fbee573b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Tile-Klasse enthält alle Informationen einer einzelnen Kachel. </font><font style="vertical-align: inherit;">Bisher brauchen wir nicht viel, nur x- und y-Positionen sowie ein Spielobjekt an dieser Position der Karte.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/405/21e/cd9/40521ecd9e1292e813391181e523b6dc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben also grundlegende Kachelinformationen. </font><font style="vertical-align: inherit;">Lassen Sie uns aus dieser Kachel eine Karte erstellen. </font><font style="vertical-align: inherit;">Es ist einfach, wir brauchen nur eine zweidimensionale Anordnung von Kachelobjekten. </font><font style="vertical-align: inherit;">Es klingt kompliziert, aber es gibt nichts Besonderes. </font><font style="vertical-align: inherit;">Fügen Sie einfach die Variable Tile [,] zur MapManager-Klasse hinzu:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f44/2e8/806/f442e88061e77cbbb4c1aa904c73bdfd.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voila! </font><font style="vertical-align: inherit;">Wir haben eine Karte! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, es ist leer. </font><font style="vertical-align: inherit;">Aber das ist eine Karte. </font><font style="vertical-align: inherit;">Jedes Mal, wenn sich etwas auf der Karte bewegt oder den Status ändert, werden die Informationen auf dieser Karte aktualisiert. </font><font style="vertical-align: inherit;">Das heißt, wenn ein Spieler beispielsweise versucht, zu einem neuen Plättchen zu wechseln, überprüft die Klasse die Adresse des Zielplättchens auf der Karte, die Anwesenheit des Feindes und seine Durchgängigkeit. </font><font style="vertical-align: inherit;">Dank dessen müssen wir nicht in jeder Runde Tausende von Kollisionen überprüfen, und wir benötigen keine Kollider für jedes Spielobjekt, was die Arbeit mit dem Spiel erleichtert und vereinfacht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der resultierende Code sieht folgendermaßen aus:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Collections;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> UnityEngine;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MapManager</span> <font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tile[,] map; <span class="hljs-comment">// the 2-dimensional map with the information for all the tiles</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Tile</span> { <span class="hljs-comment">//Holds all the information for each tile on the map</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> xPosition; <span class="hljs-comment">// the position on the x axis</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> yPosition; <span class="hljs-comment">// the position on the y axis</span>
    <span class="hljs-keyword">public</span> GameObject baseObject; <span class="hljs-comment">// the map game object attached to that position: a floor, a wall, etc.</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erste Phase ist abgeschlossen. Fahren wir mit dem Ausfüllen der Karte fort. </font><font style="vertical-align: inherit;">Jetzt werden wir beginnen, einen Dungeongenerator zu erstellen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stufe 2 - ein paar Worte zur Datenstruktur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor Sie beginnen, möchte ich Ihnen die Tipps mitteilen, die sich aufgrund des Feedbacks ergeben haben, das Sie nach der Veröffentlichung des ersten Teils erhalten haben. Wenn Sie eine Datenstruktur erstellen, müssen Sie von Anfang an überlegen, wie Sie den Status des Spiels beibehalten. Andernfalls wird es später viel chaotischer. Der Benutzer von Discord st33d, dem Entwickler von Star Shaped Bagel (Sie können dieses Spiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kostenlos spielen </font><font style="vertical-align: inherit;">), sagte, dass er das Spiel zuerst erstellt habe und dachte, dass es überhaupt keine Zustände retten würde. Allmählich wurde das Spiel größer und ihr Fan bat um Unterstützung für die gespeicherte Karte. Aufgrund der gewählten Methode zum Erstellen der Datenstruktur war es jedoch sehr schwierig, die Daten zu speichern, sodass er dies nicht konnte.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82c/b02/858/82cb02858af686ef409ad8a6c0496135.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir lernen wirklich aus unseren Fehlern. Trotz der Tatsache, dass ich den Teil zum Speichern / Laden am Ende des Tutorials eingefügt habe, denke ich von Anfang an darüber nach und habe sie nur noch nicht erklärt. In diesem Teil werde ich ein wenig darüber sprechen, aber um unerfahrene Entwickler nicht zu überlasten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden solche Dinge als ein Array von Variablen der Tile-Klasse speichern, in der die Karte gespeichert ist. Wir speichern alle diese Daten mit Ausnahme der Variablen der GameObject-Klasse, die sich in der Tile-Klasse befinden. Warum? Nur weil GameObjects nicht mit Unity für gespeicherte Daten serialisiert werden können.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher müssen wir die in GameObjects gespeicherten Daten nicht speichern. Alle Daten werden in Klassen wie Tile und später auch Player, Enemy usw. gespeichert. Dann haben wir GameObjects, um die Berechnung von Dingen wie Sichtbarkeit und Bewegung zu vereinfachen und Sprites auf dem Bildschirm zu zeichnen. Daher gibt es innerhalb der Klassen GameObject-Variablen, aber der Wert dieser Variablen wird nicht gespeichert und geladen. Beim Laden wird erzwungen, GameObject erneut aus den gespeicherten Daten (Position, Sprite usw.) zu generieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was müssen wir dann jetzt tun? Fügen Sie der vorhandenen Tile-Klasse einfach zwei Zeilen und eine am oberen Rand des Skripts hinzu. Zuerst fügen wir "using System" hinzu. zum Skripttitel und dann [Serializable] vor der gesamten Klasse und [NonSerialized] direkt vor der GameObject-Variablen. So:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bfd/931/aa3/bfd931aa3a4a1b2b7792650cc25cba07.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a2e/178/9d3/a2e1789d3663b1530d64d3d900c7f047.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde Ihnen mehr darüber erzählen, wenn wir zum Teil des Tutorials zum Speichern / Laden kommen. </font><font style="vertical-align: inherit;">Lassen wir jetzt alles und fahren fort.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stufe 3 - etwas mehr über die Datenstruktur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe eine weitere Überprüfung der Datenstruktur erhalten, die ich hier teilen möchte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich gibt es viele Möglichkeiten, Daten in einem Spiel zu implementieren. Die erste, die ich verwende und die in diesem Tutorial implementiert wird: Alle Kacheldaten befinden sich in der Kachelklasse, und alle werden in einem Array gespeichert. Dieser Ansatz hat viele Vorteile: Es ist einfacher zu lesen, alles, was Sie benötigen, befindet sich an einem Ort, Daten lassen sich leichter bearbeiten und in eine Sicherungsdatei exportieren. Aber aus der Sicht des Gedächtnisses ist es nicht so effektiv. Sie müssen viel Speicher für Variablen reservieren, die im Spiel niemals verwendet werden. Zum Beispiel werden wir später die Enemy GameObject-Variable in die Tile-Klasse aufnehmen, damit wir direkt von der Karte auf das GameObject des Feindes zeigen können, der auf diesem Plättchen steht, um alle Berechnungen im Zusammenhang mit dem Kampf zu vereinfachen. Dies bedeutet jedoch, dass jeder Kachel im Spiel Speicherplatz für die GameObject-Variable zugewiesen wurde.auch wenn sich auf diesem Plättchen kein Feind befindet. Wenn sich auf einer Karte mit 2500 Kacheln 10 Gegner befinden, sind 2490 leere, aber zugewiesene GameObject-Variablen vorhanden. Sie können sehen, wie viel Speicher verschwendet wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine alternative Methode wäre die Verwendung von Strukturen zum Speichern der Basisdaten von Kacheln (z. B. Position und Typ), und alle anderen Daten würden in Hashmap-s gespeichert, die nur bei Bedarf generiert würden. </font><font style="vertical-align: inherit;">Dies würde viel Speicher sparen, aber die Amortisation wäre eine etwas kompliziertere Implementierung. </font><font style="vertical-align: inherit;">Eigentlich wäre es etwas fortgeschrittener als ich es in diesem Tutorial gerne hätte, aber wenn Sie möchten, kann ich in Zukunft einen detaillierteren Beitrag darüber schreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie eine Diskussion zu diesem Thema lesen möchten, können Sie dies </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf Reddit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tun </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stufe 4 - Dungeon-Generierungsalgorithmus</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, dies ist ein weiterer Abschnitt, in dem ich sprechen werde, und wir werden nichts programmieren. Dies ist jedoch wichtig. Eine sorgfältige Planung der Algorithmen spart uns in Zukunft viel Arbeitszeit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt verschiedene Möglichkeiten, einen Dungeongenerator zu erstellen. Diejenige, die wir gemeinsam implementieren werden, ist nicht die beste und nicht die effektivste ... es ist nur ein einfacher, anfänglicher Weg. Es ist sehr einfach, aber die Ergebnisse werden ziemlich gut sein. Das Hauptproblem werden viele Sackgassen sein. Wenn Sie möchten, kann ich später ein weiteres Tutorial über bessere Algorithmen veröffentlichen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen funktioniert der von uns verwendete Algorithmus wie folgt: Angenommen, wir haben eine ganze Karte mit Nullwerten - eine Ebene, die aus einem Stein besteht. </font><font style="vertical-align: inherit;">Zu Beginn haben wir einen Raum in der Mitte ausgeschnitten. </font><font style="vertical-align: inherit;">Von diesem Raum aus durchbrechen wir den Korridor in eine Richtung und fügen dann weitere Korridore und Räume hinzu, die immer zufällig von einem vorhandenen Raum oder Korridor ausgehen, bis wir die maximale Anzahl von Korridoren / Räumen erreichen, die zu Beginn angegeben wurden. </font><font style="vertical-align: inherit;">Oder bis der Algorithmus einen neuen Ort zum Hinzufügen eines neuen Raums / Korridors finden kann, je nachdem, was zuerst eintritt. </font><font style="vertical-align: inherit;">Und so bekommen wir einen Kerker.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns dies Schritt für Schritt algorithmischer beschreiben. </font><font style="vertical-align: inherit;">Der Einfachheit halber werde ich jedes Detail der Karte (Korridor oder Raum) als Element bezeichnen, damit ich nicht jedes Mal „Raum / Korridor“ sagen muss.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schneiden Sie den Raum in der Mitte der Karte aus</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wähle zufällig eine der Wände aus</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir durchbrechen den Korridor in dieser Wand</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wählen Sie zufällig eines der vorhandenen Elemente aus.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wählen Sie zufällig eine der Wände dieses Elements aus</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn das zuletzt ausgewählte Element ein Raum ist, generieren wir einen Korridor. </font><font style="vertical-align: inherit;">Wenn der Korridor, dann wählen Sie zufällig, ob das nächste Element ein Raum oder ein anderer Korridor sein wird</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überprüfen Sie, ob in der ausgewählten Richtung genügend Platz vorhanden ist, um das gewünschte Element zu erstellen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn es einen Ort gibt, erstellen Sie ein Element. Wenn nicht, kehren Sie zu Schritt 4 zurück</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiederholen Sie ab Schritt 4</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles. </font><font style="vertical-align: inherit;">Wir werden eine einfache Karte des Verlieses bekommen, in dem es nur Räume und Korridore gibt, ohne Türen und spezielle Elemente, aber dies wird unser Anfang sein. </font><font style="vertical-align: inherit;">Später werden wir es mit Truhen, Feinden und Fallen füllen. </font><font style="vertical-align: inherit;">Und Sie können es sogar anpassen: Wir lernen, wie Sie interessante Elemente hinzufügen, die Sie benötigen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stufe 5 - Raum ausschneiden</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fahren Sie abschließend mit der Codierung fort! </font><font style="vertical-align: inherit;">Lassen Sie uns unser erstes Zimmer schneiden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie zunächst ein neues Skript und nennen Sie es DungeonGenerator. </font><font style="vertical-align: inherit;">Es wird von Monobehaviour geerbt, sodass Sie es später an GameObject anhängen müssen. </font><font style="vertical-align: inherit;">Dann müssen wir mehrere öffentliche Variablen in der Klasse deklarieren, damit wir die Parameter des Dungeons vom Inspektor aus festlegen können. </font><font style="vertical-align: inherit;">Diese Variablen sind die Breite und Höhe der Karte, die minimale und maximale Höhe und Breite der Räume, die maximale Länge der Korridore und die Anzahl der Elemente, die sich auf der Karte befinden sollen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/120/331/04d/12033104d1f3fcf270fdc5fd64ffb6bb.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes müssen wir den Dungeongenerator initialisieren. Wir tun dies, um die Variablen zu initialisieren, die von der Generierung ausgefüllt werden. Im Moment ist dies nur eine Karte. Und und löschen Sie auch die Funktionen Start () und Update (), die Unity für das neue Skript generiert. Wir werden sie nicht benötigen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f92/a8f/e5d/f92a8fe5dc2ea241284fe95b8758c289.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad7/841/44b/ad784144b6aeea6aee3967caedaa37eb.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier haben wir die Map-Variable der MapManager-Klasse (die wir im vorherigen Schritt erstellt haben) initialisiert und dabei die Breite und Höhe der Map übergeben, die durch die obigen Variablen als Parameter der beiden Dimensionen des Arrays definiert wurden. Dank dessen haben wir eine Karte mit horizontaler x-Größe (Breite) und vertikaler y-Größe (Höhe) und können auf jede Zelle in der Karte zugreifen, indem Sie MapManager.map [x, y] eingeben. Dies ist sehr nützlich, wenn Sie die Position von Objekten ändern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt erstellen wir eine Funktion zum Rendern des ersten Raums. Wir werden es FirstRoom () nennen. Wir haben InitializeDungeon () zu einer öffentlichen Funktion gemacht, da es von einem anderen Skript gestartet wird (Game Manager, den wir bald erstellen werden; es wird die Verwaltung des gesamten Spielstartprozesses zentralisieren). Wir benötigen keine externen Skripte, um auf FirstRoom () zugreifen zu können, daher machen wir es nicht öffentlich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um fortzufahren, erstellen wir drei neue Klassen im MapManager-Skript, damit Sie einen Raum erstellen können. Dies sind die Klassen Feature, Wall und Position. Die Positionsklasse enthält die x- und y-Positionen, damit wir verfolgen können, wo sich alles befindet. Die Wand hat eine Liste von Positionen, die Richtung, in die sie relativ zur Mitte des Raums (Norden, Süden, Osten oder Westen) „schaut“, die Länge und das Vorhandensein eines neuen Elements, das daraus erstellt wurde. Das Element enthält eine Liste aller Positionen, aus denen es besteht, den Typ des Elements (Raum oder Korridor), ein Array von Wandvariablen sowie seine Breite und Höhe.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b7/abe/924/3b7abe9241bb1442f3224048384263ff.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/938/8bc/8d7/9388bc8d7dd523b45013fa80d918d8a2.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kommen wir nun zur FirstRoom () -Funktion. </font><font style="vertical-align: inherit;">Kehren wir zum DungeonGenerator-Skript zurück und erstellen eine Funktion direkt unter InitializeDungeon. </font><font style="vertical-align: inherit;">Sie muss keine Parameter erhalten, daher lassen wir es einfach (). </font><font style="vertical-align: inherit;">Als nächstes müssen wir innerhalb der Funktion zuerst die Raumvariable und ihre Liste der Positionsvariablen erstellen und initialisieren. </font><font style="vertical-align: inherit;">Wir machen es so:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/164/b81/b5d/164b81b5dde06f8e996e22a75bf0b947.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen wir nun die Größe des Raums ein. </font><font style="vertical-align: inherit;">Es wird ein zufälliger Wert zwischen der am Anfang des Skripts angegebenen minimalen und maximalen Höhe und Breite angezeigt. </font><font style="vertical-align: inherit;">Sie sind zwar leer, da wir im Inspektor keinen Wert für sie festgelegt haben, aber keine Sorge, wir werden es bald tun. </font><font style="vertical-align: inherit;">Wir setzen zufällige Werte wie folgt:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d77/bbd/389/d77bbd3896dc4c60d93a9e6b1c006729.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes müssen wir angeben, wo sich der Startpunkt des Raums befindet, dh wo sich im Kartenraster der Punkt von Raum 0.0 befindet. Wir möchten, dass es in der Mitte der Karte beginnt (halbe Breite und halbe Höhe), aber vielleicht nicht </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genau</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Mitte. Es könnte sich lohnen, einen kleinen Randomizer hinzuzufügen, damit er sich leicht nach links und unten bewegt. Daher setzen wir xStartingPoint als halbe Breite der Karte und yStartingPoint als halbe Höhe der Karte und nehmen dann die gerade angegebene Raumbreite und Raumhöhe. Wir erhalten einen zufälligen Wert von 0 bis zu dieser Breite / Höhe und subtrahieren ihn von den anfänglichen x und y. So:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/50f/3f2/f0e/50f3f2f0ecb267d5283dcd4684019708.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8eb/0e7/f2b/8eb0e7f2bff7d3d08b1b0691885e89cd.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes werden wir in derselben Funktion Wände hinzufügen. Wir müssen das Array von Wänden initialisieren, die sich in der neu erstellten Raumvariablen befinden, und dann jede Wandvariable in diesem Array initialisieren. Initialisieren Sie dann jede Liste von Positionen, setzen Sie die Länge der Wand auf 0 und geben Sie die Richtung ein, in die jede Wand „aussehen“ soll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem das Array initialisiert wurde, durchlaufen wir jedes Element des Arrays in der for () - Schleife, initialisieren die Variablen jeder Wand und verwenden dann den Schalter, der die Richtung jeder Wand benennt. Es wird willkürlich gewählt, wir müssen uns nur daran erinnern, was sie bedeuten werden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d3a/f8f/9da/d3af8f9da1ee8f317452d52f9f905536.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt werden wir zwei verschachtelte for-Schleifen unmittelbar nach dem Platzieren der Wände ausführen. </font><font style="vertical-align: inherit;">In der äußeren Schleife gehen wir um alle y-Werte im Raum und in der verschachtelten Schleife um alle x-Werte. </font><font style="vertical-align: inherit;">Auf diese Weise überprüfen wir jede Zelle x in Zeile y, damit wir sie implementieren können.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ee/cb3/695/3eecb3695c59d199fb32064501ce1009.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann müssen Sie zunächst den tatsächlichen Wert der Zellenposition auf dem Kartenmaßstab anhand der Raumposition ermitteln. </font><font style="vertical-align: inherit;">Das ist ziemlich einfach: Wir haben die Startpunkte x und y. </font><font style="vertical-align: inherit;">Sie befinden sich auf Position 0,0 im Raster des Raums. </font><font style="vertical-align: inherit;">Wenn wir dann den realen Wert von x, y von einem lokalen x, y erhalten müssen, addieren wir das lokale x und y mit den Anfangspositionen x und y. </font><font style="vertical-align: inherit;">Anschließend speichern wir diese realen x, y-Werte in der Positionsvariablen (aus einer zuvor erstellten Klasse) und fügen sie dann der Liste &lt;&gt; der Raumpositionen hinzu.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b2/cc4/4a0/0b2cc44a0ae9953a3d49ac0b3c01a6c9.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der nächste Schritt besteht darin, diese Informationen zur Karte hinzuzufügen. </font><font style="vertical-align: inherit;">Denken Sie vor dem Ändern der Werte daran, die Kachelvariable zu initialisieren.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1aa/fe5/a43/1aafe5a43a8c30f2c343472ad7f157ca.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt werden wir die Tile-Klasse ändern. </font><font style="vertical-align: inherit;">Gehen wir zum MapManager-Skript und fügen der Definition der Tile-Klasse eine Zeile hinzu: "public string type;". </font><font style="vertical-align: inherit;">Auf diese Weise können wir eine Kachelklasse hinzufügen, indem wir deklarieren, dass die Kachel in x, y eine Wand, ein Boden oder etwas anderes ist. </font><font style="vertical-align: inherit;">Als nächstes kehren wir zu dem Zyklus zurück, in dem wir die Arbeit ausgeführt haben, und fügen ein großes if-else-Konstrukt hinzu, mit dem wir nicht nur jede Wand, ihre Länge und alle Positionen in dieser Wand bestimmen, sondern auch auf der globalen Karte definieren können, was eine bestimmte Kachel ist - eine Wand oder Geschlecht.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7c3/276/28c/7c327628cea73dafe9319a01ac10b72b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wir haben schon etwas getan. Wenn die Variable y (Steuerung der Variablen in der äußeren Schleife) 0 ist, gehört die Kachel zur untersten Zellenreihe im Raum, dh zur Südwand. Wenn x (Steuerung der Variablen der inneren Schleife) 0 ist, gehört die Kachel zur äußersten linken Spalte der Zellen, dh zur westlichen Wand. Und wenn es sich ganz oben befindet, gehört es zur Nordwand und ganz rechts zur Ostwand. Wir subtrahieren 1 von den Variablen roomWidth und roomHeight, da diese Werte ab 1 berechnet wurden und die x- und y-Variablen des Zyklus ab 0 beginnen. Daher muss diese Differenz berücksichtigt werden. Und alle Zellen, die die Bedingungen nicht erfüllen, sind keine Wände, das heißt, sie sind der Boden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/258/4a6/2c9/2584a62c91fc46205f903cb4283bd1ce.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Großartig, wir sind fast fertig mit dem ersten Raum. </font><font style="vertical-align: inherit;">Es ist fast fertig, wir müssen nur die letzten Werte in die von uns erstellte Variable Feature einfügen. </font><font style="vertical-align: inherit;">Wir verlassen die Schleife und beenden die Funktion wie folgt:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2bd/aaf/a47/2bdaafa47adb2694f360eea850341920.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fein! </font><font style="vertical-align: inherit;">Wir haben ein Zimmer! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber wie verstehen wir, dass alles funktioniert? </font><font style="vertical-align: inherit;">Müssen testen. </font><font style="vertical-align: inherit;">Aber wie teste ich? </font><font style="vertical-align: inherit;">Wir können Zeit damit verbringen und Assets hinzufügen, aber es wird Zeitverschwendung sein und uns zu sehr davon abhalten, den Algorithmus zu vervollständigen. </font><font style="vertical-align: inherit;">Hmm, aber das kann mit ASCII gemacht werden! </font><font style="vertical-align: inherit;">Ja, tolle Idee! </font><font style="vertical-align: inherit;">ASCII ist eine einfache und kostengünstige Möglichkeit, eine Karte zu zeichnen, damit sie getestet werden kann. </font><font style="vertical-align: inherit;">Wenn Sie möchten, können Sie den Teil auch mit Sprites und visuellen Effekten überspringen, die wir später untersuchen werden, und Ihr gesamtes Spiel in ASCII erstellen. </font><font style="vertical-align: inherit;">Mal sehen, wie das gemacht wird.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stufe 6 - Zeichnen des ersten Raums</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Implementierung einer ASCII-Karte müssen Sie zunächst überlegen, welche Schriftart Sie auswählen müssen. Der Hauptfaktor bei der Auswahl einer Schriftart für ASCII ist, ob sie proportional (variable Breite) oder monospaced (feste Breite) ist. Wir benötigen eine Monospace-Schriftart, damit die Karten nach Bedarf aussehen (siehe Beispiel unten). Standardmäßig verwendet jedes neue Unity-Projekt die Arial-Schriftart und ist nicht monospaced, daher müssen wir eine andere finden. Windows 10 verfügt normalerweise über monospaced Schriftarten wie Courier New, Consolas und Lucida Console. Wählen Sie eine dieser drei Optionen aus oder laden Sie eine andere an der gewünschten Stelle herunter und legen Sie sie im Ordner "Schriftarten" im Ordner "Assets" des Projekts ab.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff4/beb/f23/ff4bebf23a4523f4dd348524ac6b0a9f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bereiten wir die Szene für die ASCII-Ausgabe vor. Machen Sie zunächst die Hintergrundfarbe der Hauptkamera der Szene schwarz. Dann fügen wir der Szene das Canvas-Objekt hinzu und fügen ihm das Text-Objekt hinzu. Setzen Sie die Transformation des Textrechtecks ​​auf die mittlere Mitte und auf die Position 0,0,0. Stellen Sie das Textobjekt so ein, dass es die von Ihnen ausgewählte Schriftart und die weiße Farbe sowie den horizontalen und vertikalen Überlauf (horizontaler / vertikaler Überlauf) verwendet, wählen Sie Überlauf und zentrieren Sie die vertikale und horizontale Ausrichtung. Benennen Sie dann das Textobjekt in "ASCIITest" oder ähnliches um. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun zurück zum Code. Erstellen Sie im DungeonGenerator-Skript eine neue Funktion namens DrawMap. Wir möchten, dass sie einen Parameter erhält, der angibt, welche Karte generiert werden soll - ASCII oder Sprite. Erstellen Sie also einen booleschen Parameter und nennen Sie ihn isASCII.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/387/67a/957/38767a9575270115821d6be36ce97293.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann werden wir prüfen, ob die gerenderte Karte ASCII ist. </font><font style="vertical-align: inherit;">Wenn ja (im Moment betrachten wir nur diesen Fall), suchen wir nach einem Textobjekt in der Szene, übergeben den ihm als Parameter angegebenen Namen und erhalten dessen Textkomponente. </font><font style="vertical-align: inherit;">Aber zuerst müssen wir Unity mitteilen, dass wir mit der Benutzeroberfläche arbeiten möchten. </font><font style="vertical-align: inherit;">Fügen Sie die Zeile mit UnityEngine.UI zum Skript-Header hinzu:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/17c/e18/c24/17ce18c24ec7c286b4390159dc98dab1.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fein. </font><font style="vertical-align: inherit;">Jetzt können wir die Textkomponente des Objekts erhalten. </font><font style="vertical-align: inherit;">Die Karte ist eine große Linie, die als Text auf dem Bildschirm angezeigt wird. </font><font style="vertical-align: inherit;">Deshalb ist es so einfach einzurichten. </font><font style="vertical-align: inherit;">Erstellen wir also einen String und initialisieren ihn mit dem Wert "".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d2/7f2/92c/6d27f292c1f519a7b351d7b8d80a8f84.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fein. Jedes Mal, wenn DrawMap aufgerufen wird, müssen wir mitteilen, ob es sich bei der Karte um eine ASCII-Karte handelt. Wenn dies so ist (und wir werden es immer so haben, wir werden später damit arbeiten), durchsucht die Funktion die Szenenhierarchie auf der Suche nach einem Spielobjekt namens "ASCIITest". Wenn dies der Fall ist, erhält es seine Textkomponente und speichert sie in der Bildschirmvariablen, in die wir dann die Karte einfach schreiben können. Anschließend wird eine Zeichenfolge erstellt, deren Wert anfangs leer ist. Wir werden diese Zeile mit unserer Karte füllen, die mit Symbolen markiert ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalerweise gehen wir in einer Schleife um die Karte herum, beginnend bei 0 und bis zum Ende ihrer Länge. </font><font style="vertical-align: inherit;">Um die Zeile zu füllen, beginnen wir mit der ersten Textzeile, dh der obersten Zeile. </font><font style="vertical-align: inherit;">Daher müssen wir uns auf der y-Achse in einer Schleife in die entgegengesetzte Richtung bewegen, vom Ende bis zum Anfang des Arrays. </font><font style="vertical-align: inherit;">Aber die x-Achse des Arrays verläuft genau wie der Text von links nach rechts, daher passt dies zu uns.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/536/019/f47/536019f479ea1af260d551f342ed46aa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Zyklus überprüfen wir jede Zelle der Karte, um herauszufinden, was darin enthalten ist. </font><font style="vertical-align: inherit;">Bisher haben wir die Zellen nur als neue Kachel () initialisiert, die wir für den Raum ausgeschnitten haben, sodass alle anderen beim Versuch, darauf zuzugreifen, einen Fehler zurückgeben. </font><font style="vertical-align: inherit;">Also müssen wir zuerst prüfen , </font><font style="vertical-align: inherit;">ob </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> irgendetwas in dieser Zelle ist, und wir tun dies , </font><font style="vertical-align: inherit;">indem die Zelle für null zu </font><font style="vertical-align: inherit;">überprüfen. </font><font style="vertical-align: inherit;">Wenn es nicht null ist, arbeiten wir weiter, aber wenn es null ist, ist nichts drin, sodass wir der Karte leeren Raum hinzufügen können.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3f3/f56/5d9/3f3f565d9e9f7886c3baa600cd1ab99f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher überprüfen wir für jede nicht leere Zelle ihren Typ und fügen dann das entsprechende Symbol hinzu. </font><font style="vertical-align: inherit;">Wir möchten, dass die Wände mit dem Symbol "#" und die Böden mit dem Symbol "." Angezeigt werden. </font><font style="vertical-align: inherit;">Und während wir nur diese beiden Typen haben. </font><font style="vertical-align: inherit;">Wenn wir später den Spieler, die Monster und die Fallen hinzufügen, wird alles etwas komplizierter.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f9f/a24/ef0/f9fa24ef002860f5331479f9ac07a6e8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Außerdem müssen Zeilenumbrüche ausgeführt werden, wenn das Ende der Array-Zeile erreicht ist, damit sich Zellen mit derselben x-Position direkt untereinander befinden. </font><font style="vertical-align: inherit;">Wir werden bei jeder Iteration der Schleife prüfen, ob die Zelle die letzte in der Zeile ist, und dann einen Zeilenumbruch mit dem Sonderzeichen "\ n" hinzufügen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c14/7b8/1eb/c147b81eb1f4efa01bafdfa8a4aa092d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles. </font><font style="vertical-align: inherit;">Dann verlassen wir die Schleife, damit wir diese Zeile nach Abschluss zum Textobjekt in der Szene hinzufügen können.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/20f/8bb/f4d/20f8bbf4d1c8e5b59afc3163a97d57bb.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fcb/83f/a7f/fcb83fa7f923ec53e33696bb8962a1d9.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Herzliche Glückwünsche! Sie haben das Skript abgeschlossen, mit dem der Raum erstellt und auf dem Bildschirm angezeigt wird. Jetzt müssen wir nur noch diese Zeilen in die Tat umsetzen. Wir verwenden Start () nicht im DungeonGenerator-Skript, da wir ein separates Skript haben möchten, um alles zu steuern, was zu Beginn des Spiels ausgeführt wird, einschließlich der Erstellung der Karte, aber auch der Einrichtung des Spielers, der Feinde usw. Daher enthält dieses andere Skript die Funktion Start () und ruft bei Bedarf die Funktionen unseres Skripts auf. Das DungeonGenerator-Skript verfügt über eine Initialize-Funktion, die öffentlich ist, und FirstRoom und DrawMap sind nicht öffentlich. Initialize initialisiert einfach die Variablen, um den Dungeon-Generierungsprozess zu konfigurieren. Daher benötigen wir eine weitere Funktion, die den Generierungsprozess aufruft. Diese muss öffentlich sein, damit sie aus anderen Skripten aufgerufen werden kann.Im Moment ruft sie nur die Funktion FirstRoom () und dann die Funktion DrawMap () auf und übergibt ihr einen wahren Wert, damit sie eine ASCII-Karte zeichnet. Oh, oder nicht, es ist sogar noch besser - erstellen wir eine öffentliche Variable isASCII, die in den Inspektor aufgenommen werden kann, und übergeben diese Variable einfach als Parameter an die Funktion. Fein.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c58/288/502/c58288502f107440def4f803d602662b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun erstellen wir ein GameManager-Skript. </font><font style="vertical-align: inherit;">Es wird genau das Skript sein, das alle übergeordneten Elemente des Spiels steuert, z. B. das Erstellen einer Karte und den Verlauf der Züge. </font><font style="vertical-align: inherit;">Entfernen wir die Funktion Update (), fügen eine Variable vom Typ DungeonGenerator mit dem Namen dungeonGenerator hinzu und erstellen eine Instanz dieser Variablen in der Funktion Start ().</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e5b/8da/424/e5b8da4243c91f887c08213b9ec14953.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach rufen wir einfach die Funktionen InitializeDungeon () und GenerateDungeon () vom dungeonGenerator </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in dieser Reihenfolge auf</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies ist wichtig - zuerst müssen Sie die Variablen initialisieren und erst danach beginnen Sie mit dem Aufbau auf ihrer Basis.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/158/7e6/781/1587e6781595d0ee6661aea7898aa6e4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Teil ist der Code abgeschlossen. </font><font style="vertical-align: inherit;">Wir müssen ein leeres Spielobjekt im Hierarchiefenster erstellen, es in GameManager umbenennen und die Skripte GameManager und DungeonGenerator daran anhängen. </font><font style="vertical-align: inherit;">Stellen Sie dann die Werte des Dungeon-Generators im Inspektor ein. </font><font style="vertical-align: inherit;">Sie können verschiedene Schemata für den Generator ausprobieren, und ich habe mich dazu entschlossen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a11/41f/495/a1141f4953a6fdeac32cc978ac4a0b05.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klicken Sie jetzt einfach auf "Spielen" und beobachten Sie die Magie! </font><font style="vertical-align: inherit;">Sie sollten etwas Ähnliches auf dem Spielbildschirm sehen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad4/093/6ab/ad40936ab0dff25fd3214571faf9aa61.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Herzlichen Glückwunsch, wir haben jetzt ein Zimmer! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wollte, dass wir den Charakter des Spielers dort platzieren und ihn bewegen, aber der Posten war schon ziemlich lang. </font><font style="vertical-align: inherit;">Daher können wir im nächsten Teil direkt mit der Implementierung des restlichen Dungeon-Algorithmus fortfahren oder den Spieler darin platzieren und ihm das Bewegen beibringen. </font><font style="vertical-align: inherit;">Stimmen Sie in den Kommentaren zum Originalartikel ab, was Ihnen am besten gefällt. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MapManager.cs:</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Collections;
<span class="hljs-keyword">using</span> System; <span class="hljs-comment">// So the script can use the serialization commands</span>
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> UnityEngine;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MapManager</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tile[,] map; <span class="hljs-comment">// the 2-dimensional map with the information for all the tiles</span><font></font>
}<font></font>
<font></font>
[<span class="hljs-meta">Serializable</span>] <span class="hljs-comment">// Makes the class serializable so it can be saved out to a file</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Tile</span> { <span class="hljs-comment">// Holds all the information for each tile on the map</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> xPosition; <span class="hljs-comment">// the position on the x axis</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> yPosition; <span class="hljs-comment">// the position on the y axis</span>
    [<span class="hljs-meta">NonSerialized</span>]
    <span class="hljs-keyword">public</span> GameObject baseObject; <span class="hljs-comment">// the map game object attached to that position: a floor, a wall, etc.</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> type; <span class="hljs-comment">// The type of the tile, if it is wall, floor, etc</span><font></font>
}<font></font>
<font></font>
[<span class="hljs-meta">Serializable</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Position</span> { <span class="hljs-comment">//A class that saves the position of any cell</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> x;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> y;<font></font>
}<font></font>
<font></font>
[<span class="hljs-meta">Serializable</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Wall</span> { <span class="hljs-comment">// A class for saving the wall information, for the dungeon generation algorithm</span>
    <span class="hljs-keyword">public</span> List&lt;Position&gt; positions;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> direction;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> length;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> hasFeature = <span class="hljs-literal">false</span>;<font></font>
}<font></font>
<font></font>
[<span class="hljs-meta">Serializable</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Feature</span> { <span class="hljs-comment">// A class for saving the feature (corridor or room) information, for the dungeon generation algorithm</span>
    <span class="hljs-keyword">public</span> List&lt;Position&gt; positions;
    <span class="hljs-keyword">public</span> Wall[] walls;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> type;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> width;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> height;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DungeonGenerator.cs:</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Collections;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.UI;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DungeonGenerator</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> mapWidth;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> mapHeight;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> widthMinRoom;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> widthMaxRoom;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> heightMinRoom;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> heightMaxRoom;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> maxCorridorLength;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> maxFeatures;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> isASCII;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">InitializeDungeon</span>(<span class="hljs-params"></span>)</span> {<font></font>
        MapManager.map = <span class="hljs-keyword">new</span> Tile[mapWidth, mapHeight];<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GenerateDungeon</span>(<span class="hljs-params"></span>)</span> {<font></font>
        FirstRoom();<font></font>
        DrawMap(isASCII);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">FirstRoom</span>(<span class="hljs-params"></span>)</span> {<font></font>
        Feature room = <span class="hljs-keyword">new</span> Feature();<font></font>
        room.positions = <span class="hljs-keyword">new</span> List&lt;Position&gt;();<font></font>
<font></font>
        <span class="hljs-keyword">int</span> roomWidth = Random.Range(widthMinRoom, widthMaxRoom);
        <span class="hljs-keyword">int</span> roomHeight = Random.Range(heightMinRoom, heightMaxRoom);<font></font>
<font></font>
        <span class="hljs-keyword">int</span> xStartingPoint = mapWidth / <span class="hljs-number">2</span>;
        <span class="hljs-keyword">int</span> yStartingPoint = mapHeight / <span class="hljs-number">2</span>;<font></font>
<font></font>
        xStartingPoint -= Random.Range(<span class="hljs-number">0</span>, roomWidth);<font></font>
        yStartingPoint -= Random.Range(<span class="hljs-number">0</span>, roomHeight);<font></font>
<font></font>
        room.walls = <span class="hljs-keyword">new</span> Wall[<span class="hljs-number">4</span>];<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; room.walls.Length; i++) {<font></font>
            room.walls[i] = <span class="hljs-keyword">new</span> Wall();<font></font>
            room.walls[i].positions = <span class="hljs-keyword">new</span> List&lt;Position&gt;();<font></font>
            room.walls[i].length = <span class="hljs-number">0</span>;<font></font>
<font></font>
            <span class="hljs-keyword">switch</span> (i) {
                <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<font></font>
                    room.walls[i].direction = <span class="hljs-string">"South"</span>;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<font></font>
                    room.walls[i].direction = <span class="hljs-string">"North"</span>;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<font></font>
                    room.walls[i].direction = <span class="hljs-string">"West"</span>;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<font></font>
                    room.walls[i].direction = <span class="hljs-string">"East"</span>;
                    <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt; roomHeight; y++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>; x &lt; roomWidth; x++) {<font></font>
                Position position = <span class="hljs-keyword">new</span> Position();<font></font>
                position.x = xStartingPoint + x;<font></font>
                position.y = yStartingPoint + y;<font></font>
<font></font>
                room.positions.Add(position);<font></font>
<font></font>
                MapManager.map[position.x, position.y] = <span class="hljs-keyword">new</span> Tile();<font></font>
                MapManager.map[position.x, position.y].xPosition = position.x;<font></font>
                MapManager.map[position.x, position.y].yPosition = position.y;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (y == <span class="hljs-number">0</span>) {<font></font>
                    room.walls[<span class="hljs-number">0</span>].positions.Add(position);<font></font>
                    room.walls[<span class="hljs-number">0</span>].length++;<font></font>
                    MapManager.map[position.x, position.y].type = <span class="hljs-string">"Wall"</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (y == (roomHeight - <span class="hljs-number">1</span>)) {<font></font>
                    room.walls[<span class="hljs-number">1</span>].positions.Add(position);<font></font>
                    room.walls[<span class="hljs-number">1</span>].length++;<font></font>
                    MapManager.map[position.x, position.y].type = <span class="hljs-string">"Wall"</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x == <span class="hljs-number">0</span>) {<font></font>
                    room.walls[<span class="hljs-number">2</span>].positions.Add(position);<font></font>
                    room.walls[<span class="hljs-number">2</span>].length++;<font></font>
                    MapManager.map[position.x, position.y].type = <span class="hljs-string">"Wall"</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x == (roomWidth - <span class="hljs-number">1</span>)) {<font></font>
                    room.walls[<span class="hljs-number">3</span>].positions.Add(position);<font></font>
                    room.walls[<span class="hljs-number">3</span>].length++;<font></font>
                    MapManager.map[position.x, position.y].type = <span class="hljs-string">"Wall"</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span> {<font></font>
                    MapManager.map[position.x, position.y].type = <span class="hljs-string">"Floor"</span>;<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
<font></font>
        room.width = roomWidth;<font></font>
        room.height = roomHeight;<font></font>
        room.type = <span class="hljs-string">"Room"</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DrawMap</span>(<span class="hljs-params"><span class="hljs-keyword">bool</span> isASCII</span>)</span> {
        <span class="hljs-keyword">if</span> (isASCII) {<font></font>
            Text screen = GameObject.Find(<span class="hljs-string">"ASCIITest"</span>).GetComponent&lt;Text&gt;();<font></font>
<font></font>
            <span class="hljs-keyword">string</span> asciiMap = <span class="hljs-string">""</span>;<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = (mapHeight - <span class="hljs-number">1</span>); y &gt;= <span class="hljs-number">0</span>; y--) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>; x &lt; mapWidth; x++) {
                    <span class="hljs-keyword">if</span> (MapManager.map[x,y] != <span class="hljs-literal">null</span>) {
                        <span class="hljs-keyword">switch</span> (MapManager.map[x, y].type) {
                            <span class="hljs-keyword">case</span> <span class="hljs-string">"Wall"</span>:<font></font>
                                asciiMap += <span class="hljs-string">"#"</span>;
                                <span class="hljs-keyword">break</span>;
                            <span class="hljs-keyword">case</span> <span class="hljs-string">"Floor"</span>:<font></font>
                                asciiMap += <span class="hljs-string">"."</span>;
                                <span class="hljs-keyword">break</span>;<font></font>
                        }<font></font>
                    } <span class="hljs-keyword">else</span> {<font></font>
                        asciiMap += <span class="hljs-string">" "</span>;<font></font>
                    }<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> (x == (mapWidth - <span class="hljs-number">1</span>)) {<font></font>
                        asciiMap += <span class="hljs-string">"\n"</span>;<font></font>
                    }<font></font>
                }<font></font>
            }<font></font>
<font></font>
            screen.text = asciiMap;<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GameManager.cs:</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Collections;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> UnityEngine;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameManager</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
    DungeonGenerator dungeonGenerator;<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Start</span>(<span class="hljs-params"></span>)</span> {<font></font>
        dungeonGenerator = GetComponent&lt;DungeonGenerator&gt;();<font></font>
<font></font>
        dungeonGenerator.InitializeDungeon();<font></font>
        dungeonGenerator.GenerateDungeon();<font></font>
    }<font></font>
}</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490808/index.html">Mathematik in der Astronautik: Rotationsdetonationsmotor</a></li>
<li><a href="../de490812/index.html">Spring Professional Certification 5 Einreichungserfahrung</a></li>
<li><a href="../de490816/index.html">Wie widerstehen E-Commerce-Websites den AuthBots-Botnetzen?</a></li>
<li><a href="../de490820/index.html">Alles Habr in einer Basis</a></li>
<li><a href="../de490826/index.html">Die Quelle der Produktionseffizienz</a></li>
<li><a href="../de490830/index.html">Kennwortverwaltung in der Open-Source-Edition der Zimbra Collaboration Suite</a></li>
<li><a href="../de490832/index.html">Schuhmarkierung: Als wir 2 Millionen Markierungscodes „1C“ + „Ehrliches Zeichen“ in Umlauf brachten</a></li>
<li><a href="../de490836/index.html">Wie man Kommentare öffnet und nicht in Spam ertrinkt</a></li>
<li><a href="../de490838/index.html">WiFi 6 ist da: Was der Markt bietet und warum brauchen wir diese Technologie</a></li>
<li><a href="../de490840/index.html">Ressourcenplanung. Teil 4.1. Bevor Sie einen Ressourcenplan erstellen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>