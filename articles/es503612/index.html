<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïû üé∂ üòØ Mejores pr√°cticas de Kubernetes. Mapeo de servicios externos üë®üèº üéÖüèæ üè®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mejores pr√°cticas de Kubernetes. Creaci√≥n de contenedores peque√±os 
 Las mejores pr√°cticas de Kubernetes. Organizaci√≥n de Kubernetes con el espacio de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Mejores pr√°cticas de Kubernetes. Mapeo de servicios externos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/503612/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mejores pr√°cticas de Kubernetes. Creaci√≥n de contenedores peque√±os </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las mejores pr√°cticas de Kubernetes. Organizaci√≥n de Kubernetes con el espacio de </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombres de mejores pr√°cticas de </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Kubernetes </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">. Prueba de viabilidad de Kubernetes con pruebas de preparaci√≥n y vitalidad </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mejores pr√°cticas de </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Kubernetes </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">. Establecer consultas y l√≠mites de </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recursos Mejores pr√°cticas de Kubernetes. Desconexi√≥n correcta de Terminate</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si es como la mayor√≠a de las personas, lo m√°s probable es que utilice recursos que operan fuera de su cl√∫ster. Es posible que est√© utilizando la API de Taleo para enviar mensajes de texto o analizar im√°genes con la API de Google Cloud Vision.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si usa el mismo punto final: el punto de recepci√≥n de solicitud del lado del servidor en todos sus entornos y no planea transferir sus servidores a Kubernetes, entonces es perfectamente normal tener un servicio de punto final directamente en su c√≥digo. Sin embargo, hay muchos otros escenarios. En esta serie de mejores pr√°cticas de Kubernetes, aprender√° a usar los mecanismos integrados de Kubernetes para descubrir servicios tanto dentro como fuera del cl√∫ster. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un ejemplo de un servicio externo generalizado es una base de datos que se ejecuta fuera de un cl√∫ster de Kubernetes. A diferencia de las bases de datos en la nube, como Google Cloud Data Store o Google Cloud Spanner, que utilizan un punto final para todos los tipos de acceso, la mayor√≠a de las bases de datos tienen puntos finales separados para diferentes circunstancias.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las mejores pr√°cticas para usar bases de datos tradicionales, como MySQL y MongoDB, generalmente requieren que se conecte a diferentes componentes para diferentes entornos. Puede tener una m√°quina grande para datos de producci√≥n y una m√°quina m√°s peque√±a para un entorno de prueba. Cada uno de ellos tendr√° su propia direcci√≥n IP o nombre de dominio, pero probablemente no querr√° cambiar su c√≥digo cuando se mueva de un entorno a otro. Por lo tanto, en lugar de codificar estas direcciones, puede usar el servicio integrado de Kubernetes para descubrir servicios externos basados ‚Äã‚Äãen DNS de la misma manera que para los servicios nativos de Kubernetes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qg/lz/vj/qglzvjg0ysvnlejo7v6pvtqc1se.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponga que ejecuta la base de datos MongoDB en Google Compute Engine. Se quedar√° atrapado en este mundo h√≠brido hasta que logre transferirlo a un cl√∫ster.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afortunadamente, puede usar los servicios est√°ticos de Kubernetes para hacer su vida un poco m√°s f√°cil. En este ejemplo, cre√© un servidor MongoDB usando Google Cloud Launcher. Dado que se cre√≥ en la misma red (o cl√∫ster Kubernetes VPC), se accede a ella mediante una direcci√≥n IP interna de alto rendimiento. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/ou/z8/r3ouz8pak0n-al5obbd6y81qkke.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta es la configuraci√≥n predeterminada en Google Cloud, por lo que no tiene que configurar nada. Ahora que tiene una direcci√≥n IP, el primer paso es crear un servicio. Puede notar que no hay selectores de hogar para este servicio. Es decir, creamos un servicio que no sabr√° a d√≥nde enviar tr√°fico. Esto le permitir√° crear manualmente un objeto de punto final, que recibir√° tr√°fico de este servicio.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jo/tc/sr/jotcsra7vszs8kmlivxwl_awqsq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El siguiente ejemplo de c√≥digo muestra que los puntos finales determinan la direcci√≥n IP de la base de datos utilizando el mismo nombre mongo que el servicio. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y9/dz/cb/y9dzcbounajojfgkqd-7osjcxka.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetes usar√° todas las direcciones IP para encontrar los puntos finales como si fueran pods regulares de Kubernetes, por lo que ahora puede acceder a la base de datos utilizando una cadena de conexi√≥n simple con el nombre anterior mongodb: // mongo. Sin embargo, no hay necesidad de usar direcciones IP en su c√≥digo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si las direcciones IP cambian en el futuro, simplemente puede actualizar los puntos finales con la nueva direcci√≥n IP, y no ser√° necesario cambiar sus aplicaciones de ninguna manera adicional.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si utiliza una base de datos alojada en un host de terceros, lo m√°s probable es que los propietarios del host le hayan proporcionado un identificador de recursos unificado para el URI. Entonces, si le dieron una direcci√≥n IP, simplemente puede usar el m√©todo anterior. Este ejemplo muestra que tengo dos bases de datos MongoDB alojadas en el host mLab. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bd/er/w9/bderw9_a42oa_nap45ol_au_jla.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uno de ellos es una base de datos de desarrolladores, y el otro es una base de datos de producci√≥n. Las cadenas de conexi√≥n para estas bases de datos son las siguientes: mLab le proporciona un URI din√°mico y un puerto din√°mico. Como puede ver, son diferentes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fu/t9/v5/fut9v5yv1qtskdkx8tju2rmkmnq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para ignorar esto, usamos Kubernetes y nos conectamos a la base de datos de desarrolladores. Puede crear un nombre de servicio externo de Kubernetes, que le proporcionar√° un servicio est√°tico que redirigir√° el tr√°fico al servicio externo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jo/63/u6/jo63u6uv1quvocf8fxh1bnv_6om.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este servicio realizar√° una simple redirecci√≥n CNAME a nivel de kernel, que tendr√° un impacto m√≠nimo en el rendimiento. Gracias a esto, puede usar una cadena de conexi√≥n m√°s simple. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/es/ip/jm/esipjmsa8t8nagtrwu4slv55isa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero como el nombre externo usa la redirecci√≥n CNAME, no puede realizar el reenv√≠o de puertos. Por lo tanto, esta soluci√≥n es aplicable solo para puertos est√°ticos y no se puede usar con puertos din√°micos. Pero el nivel gratuito mLab Free, por defecto, proporciona al usuario un n√∫mero de puerto din√°mico, y no puede cambiarlo. Esto significa que para desarrolladores y productos necesita diferentes l√≠neas de comando de conexi√≥n. La mala noticia es que deber√° codificar el n√∫mero de puerto. Entonces, ¬øc√≥mo hacer que el reenv√≠o de puertos funcione?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El primer paso es obtener la direcci√≥n IP del URI. Si ejecuta el comando nslookup, hostname o hace ping al URI, puede obtener la direcci√≥n IP de la base de datos. Si al mismo tiempo el servicio le devuelve varias direcciones IP, todas estas direcciones pueden usarse en los puntos finales del objeto. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ox/ki/ox/oxkioxus5e4idcigbaufhqfyquk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que las IP de URI pueden cambiar sin previo aviso, por lo que es bastante riesgoso usarlas en productos. Con esta direcci√≥n IP, puede conectarse a una base de datos remota sin especificar un puerto. Por lo tanto, el servicio Kubernetes realiza el reenv√≠o de puertos de manera bastante transparente.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/iu/eo/rsiueor-lvslhr5vscjlowggkho.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El mapeo, o mapeo de recursos externos a recursos internos, le brinda la capacidad de utilizar de manera flexible estos servicios dentro del cl√∫ster en el futuro mientras minimiza los esfuerzos de refactorizaci√≥n. </font><font style="vertical-align: inherit;">Tambi√©n facilita la gesti√≥n y proporciona informaci√≥n sobre los servicios externos que utiliza su empresa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Continuar√° muy pronto ...</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/fvpq4jqtuZ8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un poco de publicidad :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias por estar con nosotros. ¬øTe gustan nuestros art√≠culos? ¬øQuieres ver m√°s materiales interesantes? Ap√≥yenos haciendo un pedido o recomendando a sus amigos, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS en la nube para desarrolladores desde $ 4.99</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an√°logo √∫nico de servidores de nivel b√°sico que inventamos para usted: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toda la verdad sobre VPS (KVM) E5-2697 v3 (6 n√∫cleos) 10GB DDR4 480GB SSD 1Gbps desde $ 19 o c√≥mo dividir el servidor?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2 veces m√°s barato en el centro de datos Equinix Tier IV en Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solo tenemos </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV desde $ 199</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en los Pa√≠ses Bajos.</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - ¬°desde $ 99! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lea sobre</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C√≥mo construir un edificio de infraestructura. </font><font style="vertical-align: inherit;">clase c con servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es503600/index.html">STM32MP1: U-Boot, Buildroot, Arch Linux y un poco de Debian</a></li>
<li><a href="../es503604/index.html">Sergey y "la programaci√≥n es mejor que el sexo"</a></li>
<li><a href="../es503606/index.html">Swift 5.3: ¬øQu√© hay de nuevo?</a></li>
<li><a href="../es503608/index.html">C√≥mo buscamos filtros de virus</a></li>
<li><a href="../es503610/index.html">¬øPor qu√© no hacer tu propio Lisp para la web?</a></li>
<li><a href="../es503616/index.html">C√≥mo creamos un prototipo de robot comercializador y qu√© sigue</a></li>
<li><a href="../es503620/index.html">Noticias del mundo de OpenStreetMap No. 512 (05.05.2020-11.05.2020)</a></li>
<li><a href="../es503624/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 416 (18-24 de mayo de 2020)</a></li>
<li><a href="../es503626/index.html">Pruebas. Errores de certificaci√≥n ISTQB o resuelve un mill√≥n de ejemplos</a></li>
<li><a href="../es503630/index.html">Gafas de realidad aumentada: ¬ød√≥nde estamos ahora?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>