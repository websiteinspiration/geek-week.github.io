<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚵🏿 🐔 👨🏿‍🍳 Hackerfallen. Erkennen Sie Hacking frühzeitig mit Canarytokens 👩‍⚕️ 🙄 🐙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Honey Tokens (englisch - „Honigzeichen / -zeichen / -identifikatoren“) ist eine der Varianten der Honeypot-Idee, ein Köder für Eindringlinge, um die T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Hackerfallen. Erkennen Sie Hacking frühzeitig mit Canarytokens</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/495466/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Honey Tokens (englisch - „Honigzeichen / -zeichen / -identifikatoren“) ist eine der Varianten der Honeypot-Idee, ein Köder für Eindringlinge, um die Tatsache eines Hacks zu erkennen oder seine Quelle zu identifizieren. </font><font style="vertical-align: inherit;">Wenn der Angreifer das System bereits betreten hat, führt er wahrscheinlich Aktionen aus, die für den normalen Benutzer ungewöhnlich sind. </font><font style="vertical-align: inherit;">Dies kann verwendet werden, um Hacking zu erkennen. </font><font style="vertical-align: inherit;">In diesem Artikel werden wir untersuchen, wie einfach es ist, eigene Trigger zu erstellen, um Hacking frühzeitig zu erkennen. </font><font style="vertical-align: inherit;">Solche Traps sind nützlich für Systemadministratoren und sogar für normale Benutzer, die sich Sorgen um den Datenschutz ihrer Daten machen.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/xq/wk/ks/xqwkksjf6adatsv3lhu-am4ph6w.jpeg"></div></a><br>
<font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vor der Erfindung der Gasanalysatoren nahmen Bergleute einen Kanarienvogel mit in die Mine. </font><font style="vertical-align: inherit;">Aufgrund des kleinen Körpers und des schnellen Stoffwechsels reagierten Vögel viel früher auf gefährliche Gase in der Luft und warnten Bergleute.</font></font></i></font><a name="habracut"></a><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warum wird das benötigt?</font></font></font></h3><br>
<img src="https://habrastorage.org/webt/ji/uf/cb/jiufcbwkepg-izswuadwxjkerxe.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobald der Cracker im neuen System ist, beginnt er sich umzusehen, als ein Dieb, der in die Wohnung eingedrungen ist, alle Kisten auf der Suche nach Schmuck öffnet. </font><font style="vertical-align: inherit;">Der Angreifer weiß nicht im Voraus, welche Daten von Wert sind, prüft jedoch mit hoher Wahrscheinlichkeit alle möglichen Optionen. </font><font style="vertical-align: inherit;">Daher ist es wichtig, dass die Fallen wie echte Daten aussehen und für den Angreifer so attraktiv wie möglich sind. </font><font style="vertical-align: inherit;">Je früher der Besitzer bemerkt, dass die Falle ausgelöst wird, desto eher wird er erkennen, dass er gehackt wurde und in der Lage sein wird zu reagieren.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canarytokens Service</font></font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canarytokens.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein Onlinedienst zum bequemen Erstellen eigener Marker (Hanitokens) zur Hackerkennung. </font><font style="vertical-align: inherit;">Es unterstützt mehrere Triggeroptionen und ermöglicht es Ihnen, einen vorgefertigten Trigger mit angehängter E-Mail zu generieren, bei dem eine Benachrichtigung gesendet wird, wenn der Trigger funktioniert hat. </font></font><br>
<img src="https://habrastorage.org/webt/dt/as/lm/dtaslm6-vs_4c-cl6h5nqzlqh70.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Service ist völlig kostenlos und ein Trigger kann sofort ohne Registrierung generiert werden. </font><font style="vertical-align: inherit;">Es gibt auch eine selbst gehostete Version für diejenigen, die es vorziehen, Geheimnisse in ihrer Infrastruktur zu bewahren. </font><font style="vertical-align: inherit;">Als nächstes werden wir uns ansehen, wie jeder der Trigger funktioniert, und am Ende werden wir unseren eigenen Canarytokens-Server im Docker-Container bereitstellen.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auslöser beim Öffnen einer DOC- und PDF-Datei</font></font></font></h3><br>
<img width="300" src="https://habrastorage.org/webt/x9/mw/tn/x9mwtnlqxhixsnu5o6fod1tgwao.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es funktioniert, wenn das Dokument vom Programm zum Anzeigen geöffnet wurde. </font><font style="vertical-align: inherit;">Ich benutze diesen Trick sehr oft. </font><font style="vertical-align: inherit;">Auf jedem Computer und Flash-Laufwerk befinden sich Dokumente mit attraktiven Namen wie Passwords.pdf oder Bitcoins.doc. </font><font style="vertical-align: inherit;">Ich liebe es zu beobachten, wie Buchhalter mit Neugier alle Dateien auf dem Flash-Laufwerk untersuchen, die auf sie übertragen wurden. </font></font><br>
 &nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Ich halte diesen Auslöser für den effektivsten und nützlichsten für alle Benutzerkategorien, vom Fachmann für Informationssicherheit bis zum Anfänger. </font><font style="vertical-align: inherit;">Fast niemand weiß, dass ein PDF-Viewer dem Dokumentbesitzer die Tatsache des Öffnens einer Datei vermitteln kann. </font><font style="vertical-align: inherit;">Jeder stößt darauf.</font></font><br>
 &nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Es gibt verschiedene Möglichkeiten, die Tatsache des Öffnens eines Dokuments zu erfassen. </font><font style="vertical-align: inherit;">Canarytokens verwendet eine im Dokument eingebettete dokumentenspezifische URL, um die widerrufenen SSL-Zertifikate (Certificate Revocation List) zu überprüfen. </font><font style="vertical-align: inherit;">Infolgedessen wechselt das Programm zu dieser Adresse und der Trigger wird ausgelöst.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auslöser über DNS-Auflösung</font></font></font></h3><br>
<img width="500" src="https://habrastorage.org/webt/am/i1/wh/ami1whax3utfizv4zfgxuerxc9g.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein sehr interessanter Auslöser, dessen Vorteile nicht sofort offensichtlich sind. </font><font style="vertical-align: inherit;">Es funktioniert, wenn jemand nach der IP-Adresse der generierten Subdomain fragt, die speziell generiert wurde, damit sie nicht zufällig erraten oder verdreht werden kann. </font><font style="vertical-align: inherit;">Somit sind unbeabsichtigte Operationen ausgeschlossen. </font><font style="vertical-align: inherit;">Dieser Trigger wird für viele der unten beschriebenen Techniken verwendet, einschließlich zum Erkennen des Öffnens eines Ordners und als Trigger in der MS SQL-Datenbank. </font><font style="vertical-align: inherit;">Tatsächlich gibt es viele Möglichkeiten, diesen Trigger zu verwenden.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL-Trigger</font></font></font></h3><br>
<img width="500" src="https://habrastorage.org/webt/60/mk/dn/60mkdnqqsqvla-5cc7-2nbkotrs.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall reicht es aus, wenn eine GET-, POST- oder HEAD-Anforderung als Referenz ausgeführt wird. </font><font style="vertical-align: inherit;">Dies wird den Auslöser auslösen. </font><font style="vertical-align: inherit;">Zusätzlich zu seiner üblichen Verwendung kann es auch in Skripten verwendet werden, um Parser zu überprüfen, die Links folgen, um eine Vorschau des Inhalts anzuzeigen. </font><font style="vertical-align: inherit;">So auch Instant Messenger: Schreiben Sie einfach einen Link in das Eingabefeld, auf das Sie von den Messenger-Servern geklickt haben.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bild</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das klassische 1x1-Pixel-Bild ist jedem bekannt, der Online-Werbung verfolgt. </font><font style="vertical-align: inherit;">Der Auslöser funktioniert, wenn eine Bilddatei hochgeladen wurde. </font><font style="vertical-align: inherit;">Ein solches Pixel kann in jede HTML-Seite oder in einen Buchstaben eingefügt werden. </font><font style="vertical-align: inherit;">Es ist praktisch, es aus JS-Skripten auf der Seite aufzurufen, wenn die erforderliche Bedingung erfüllt ist. </font><font style="vertical-align: inherit;">Sie können das Standardpixel auch durch Ihr eigenes Bild ersetzen.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E-Mail-Trigger</font></font></font></h3><br>
<img width="300" src="https://habrastorage.org/webt/mo/4e/sm/mo4esmyilw_y8lzwqhhw2-kaemq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ein Brief an der generierten Mailbox ankommt, funktioniert der Auslöser. </font><font style="vertical-align: inherit;">Es ist praktisch, E-Mail-Adressen, Kontaktlisten usw. zu verwenden, um den Verlust von Datenbanken zu überwachen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können diese Adresse beispielsweise zu Ihrer Kontaktliste hinzufügen und herausfinden, wann Ihr Notizbuch auf Ihrem Telefon von einer Anwendung zusammengeführt wird, die den Zugriff auf Ihre Kontaktliste anfordert . </font><font style="vertical-align: inherit;">Es ist allen Mitarbeitern auch möglich, Notebooks auf einem Computer, Telefon oder E-Mail-Client unterschiedliche Auslöseadressen hinzuzufügen und zu verfolgen, woher die Kontakte stammen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird speziell eine E-Mail-Adresse generiert, die nicht vorhersehbar ist, sodass die Wahrscheinlichkeit der Auswahl und des versehentlichen Auslösens eines Auslösers ausgeschlossen ist.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auslöser zum Öffnen des Windows-Ordners</font></font></font></h3><br>
<img width="100" src="https://habrastorage.org/webt/fp/zd/hx/fpzdhxc0olbpomnpgglqlhrd9f4.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sicherlich haben viele eine versteckte Datei desktop.ini gesehen, die sich in jedem Windows-Ordner befindet. </font><font style="vertical-align: inherit;">Es stellt sich heraus, dass er nicht so einfach ist. </font><font style="vertical-align: inherit;">Darin können Sie die Adresse des Symbols auf dem Remote-Server mithilfe von UNC-Pfaden angeben (diese werden für Netzwerklaufwerke verwendet und beginnen mit \\), während Windows eine DNS-Auflösung für die im Link zum Symbol angegebene Domäne durchführt und den Trigger aktiviert. </font><font style="vertical-align: inherit;">Die Datei desktop.ini kann mit anderen Dateien in das Archiv gepackt werden und funktioniert, wenn das Archiv entpackt wird.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auslöser für das Klonen von Websites</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein einfaches Skript für Webseiten, das funktioniert, wenn die Seite in Ihrer Domain nicht geöffnet ist. </font><font style="vertical-align: inherit;">Kann zur Erkennung von Phishing nützlich sein.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.domain != <span class="hljs-string">"mydomain.com"</span>) {
    <span class="hljs-keyword">var</span> l = location.href;
    <span class="hljs-keyword">var</span> r = <span class="hljs-built_in">document</span>.referrer;
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> Image();<font></font>
    m.src = <span class="hljs-string">"http://canarytokens.com/"</span>+
            <span class="hljs-string">"blablabla.jpg?l="</span>+
            <span class="hljs-built_in">encodeURI</span>(l) + <span class="hljs-string">"&amp;r="</span> + <span class="hljs-built_in">encodeURI</span>(r);<font></font>
}</code></pre><br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auslöser zum Ausführen einer EXE-Datei oder DLL</font></font></font></h3><br>
<img width="300" src="https://habrastorage.org/webt/co/3f/q5/co3fq5b-ivp-imere3zbbdcmmfe.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ermöglichen Sie, den Trigger mit einer vorhandenen ausführbaren EXE-Datei oder -Bibliothek zu verbinden. </font><font style="vertical-align: inherit;">Es wird von Antivirenprogrammen nicht erkannt. </font><font style="vertical-align: inherit;">Es sollte bedacht werden, dass ein solches Kleben einige Programme beschädigen kann, daher ist es besser, etwas Einfaches zu verwenden. </font><font style="vertical-align: inherit;">Tatsächlich ist dies eine seit langem bekannte Methode zur Verbreitung von Trojanern und Viren. Nur in unserem Fall ist die verborgene Funktionalität völlig harmlos. </font><font style="vertical-align: inherit;">Es sollte jedoch berücksichtigt werden, dass die ausführbare Datei eine größere Aufmerksamkeit für den Angreifer verursachen kann und auch nicht auf seinem Betriebssystem ausgeführt wird.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trigger für MS SQL</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit MS SQL können Sie einen Trigger hinzufügen, um INSERT, SELECT, DELETE usw. auszuführen. Um einen Trigger auszulösen, verwenden Sie dieselbe Methode wie für eine desktop.ini-Datei, nämlich das Auflösen eines DNS-Namens über UNC-Pfade.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Triggerbeispiel für MS SQL</font></font></b><div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--Erstelle einen gespeicherten Prozess, der </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Canarytokens </font><font style="vertical-align: inherit;">anpingt. </font><font style="vertical-align: inherit;">CREATE proc ping_canarytoken </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 AS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 BEGIN </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 deklariert</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nutzername</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> varchar (max), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> varchar (max), @tokendomain varchar (128), @unc varchar (128), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Größe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> int </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erledigt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> int </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zufällig</font></font></a> varchar(3);<br>
<br>
--setup the variables<br>
 set @tokendomain = 'qo2dd6tftntl1pej9j68v31k6.canarytokens.com';<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">size</a> = 128;<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">done</a> = 0;<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">random</a> = cast(round(rand()*100,0) as varchar(2));<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">random</a> = concat(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">random</a>, '.');<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">username</a> = SUSER_SNAME();<br>
<br>
--loop runs until the UNC path is 128 chars or less<br>
 while <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">done</a> &lt;= 0<br>
 begin<br>
 --convert username into base64<br>
 select <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">base64</a> = (SELECT<br>
 CAST(N'' AS XML).value(<br>
 'xs:base64Binary(xs:hexBinary(sql:column(«bin»)))'<br>
, 'VARCHAR(MAX)'<br>
 ) Base64Encoding<br>
 FROM (<br>
 SELECT CAST(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">username</a> AS VARBINARY(MAX)) AS bin<br>
 ) AS bin_sql_server_temp);<br>
<br>
--replace base64 padding as dns will choke on =<br>
 select <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">base64</a> = replace(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">base64</a>,'=','-')<br>
<br>
--construct the UNC path<br>
 select @unc = concat('\\',@base64,'.',@random,@tokendomain,'\a')<br>
<br>
 — if too big, trim the username and try again<br>
 if len(@unc) &lt;= <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">size</a><br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">done</a> = 1<br>
 else<br>
 --trim from the front, to keep the username and lose domain details<br>
 select <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">username</a> = substring(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">username</a>, 2, len(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">username</a>)-1)<br>
 end<br>
 exec master.dbo.xp_fileexist @unc;<br>
 END<br>
<br>
--add a trigger if data is altered<br>
 CREATE TRIGGER TRIGGER1<br>
 ON TABLE1<br>
 AFTER INSERT<br>
 AS<br>
 BEGIN<br>
 exec ping_canarytoken<br>
 end<br>
</div></div><br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Web Services-Anmeldeauslöser</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Amazon Services-API-Schlüssel sollte einen Angreifer dazu verleiten, zu überprüfen, was dort enthalten ist. </font><font style="vertical-align: inherit;">Wenn dieser API-Schlüssel für die Anmeldung verwendet wird, wird der Trigger ausgelöst. </font><font style="vertical-align: inherit;">In diesem Fall gibt es dort natürlich keine Daten.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andere Auslöser</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Dienst canarytokens.org unterstützt auch andere Trigger, z. B. einen SVN-Hook, eine Webumleitung, das Lesen eines QR-Codes, einen Slack-API-Schlüssel und andere. </font><font style="vertical-align: inherit;">Sie alle verwenden ein ähnliches Prinzip. Wenn Sie möchten, können Sie unabhängig voneinander einen eigenen Trigger erstellen, der in Ihrem Arsenal einen DNS-Namen, einen Link mit einem Bild, eine Postanschrift und API-Schlüssel für beliebte Dienste enthält. </font><font style="vertical-align: inherit;">Zusätzlich zu E-Mail-Benachrichtigungen können Canarytokens einen Web-Hook ziehen, wenn ein Auslöser ausgelöst wird. </font><font style="vertical-align: inherit;">Die Funktionsmechanismen sind in der Dokumentation beschrieben.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canarytokens Native Server</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein erfahrener Cracker, der im Quellcode die Adresse canarytokens.org sieht, ahnt sofort alles. </font><font style="vertical-align: inherit;">Für die Verwendung im Unternehmen ist es daher besser, eine eigene Canarytokens-Instanz bereitzustellen, damit alle Triggeradressen an die internen Domänen des Unternehmens gehen und nicht von echten internen Diensten unterschieden werden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entwickler stellen ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gebrauchsfertiges Docker-Image zur Verfügung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Der Installationsprozess ist für jedes Image recht typisch, daher werden wir dieses Thema nicht ansprechen. </font><font style="vertical-align: inherit;">Lassen Sie uns nur auf nicht offensichtliche Punkte eingehen. </font><font style="vertical-align: inherit;">Vor der Installation müssen Sie die Dateien </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frontend.env</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">switchboard.env</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bearbeiten </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># ()       </span>
<span class="hljs-comment">#     IP-    Docker.        SSL-.</span><font></font>
CANARY_DOMAINS=example1.com,example2.com<font></font>
<font></font>
<span class="hljs-comment">#            PDF-</span>
<span class="hljs-comment">#    NS-          .</span>
<span class="hljs-comment">#   example3.com     example1.com  example2.com</span><font></font>
CANARY_NXDOMAINS=example3.com<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Senden von E-Mails empfehle ich die Verwendung des Mailgun-Dienstes, da Sendgrid instabil ist.</font></font><br>
<br>
<h3><font color="“#3AC1EF”"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solche Fallen sind wirklich effektiv. </font><font style="vertical-align: inherit;">In meinem Fall sind Trigger mit PDF-Dateien besonders hilfreich. </font><font style="vertical-align: inherit;">Der Dienst ist sowohl für normale Benutzer als auch für erfahrene Pentester nützlich. </font><font style="vertical-align: inherit;">Selbst ein hoch entwickelter Angreifer, der über die Existenz von Hanipots und Hanitokens Bescheid weiß, wird der Versuchung nicht widerstehen können, die in der Dokumentation enthaltene Subdomain zumindest nüchtern zu machen. </font><font style="vertical-align: inherit;">Wenn Sie vorsichtig und mit Bedacht Fallen verwenden, können Sie einen Cracker frühzeitig erkennen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Techniken können auf Servern, Desktop-Computern, Dateispeichern und sogar auf Telefonen verwendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Canarytokens in Ihrer eigenen Docker-Instanz bereitstellen möchten, wird Docker auf unseren virtuellen Maschinen mit einem Klick vom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marktplatz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus installiert </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Zusätzlich gewähren wir 15% Rabatt auf alle Server, die den </font><b><font style="vertical-align: inherit;">DONTPANIC-Gutscheincode</font></b><font style="vertical-align: inherit;"> verwenden</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de495456/index.html">Überprüfung von 14 neuen Plugins für Figma, die dazu beitragen werden, die Produktivität zu steigern, während wir alle</a></li>
<li><a href="../de495458/index.html">Wie schreibe ich Code, wenn Kinder um dich herumlaufen und fragen: "Wofür wirst du arbeiten?"</a></li>
<li><a href="../de495460/index.html">Auf Uranus explodierte eine 22.000-mal so große Gasblase wie die Erde</a></li>
<li><a href="../de495462/index.html">.NET Core: x86_64 Intrinsics auf virtuellen Maschinen</a></li>
<li><a href="../de495464/index.html">Informationsnachricht 404 - nicht nur ein Fehler, sondern auch ein Feiertag</a></li>
<li><a href="../de495468/index.html">Algorithmus zur Erkennung von Preisschildern, der auch auf Datenerfassungsterminals funktioniert</a></li>
<li><a href="../de495472/index.html">Die Umstellung auf Vegetarismus verhindert nicht, dass Menschen mit Krankheiten wie COVID-19 infiziert werden</a></li>
<li><a href="../de495474/index.html">DataGrip 2020.1: Konfigurationen starten, nach Excel exportieren, Ergebnisse im Editor und mehr</a></li>
<li><a href="../de495476/index.html">Warum der Erfolg der Atari DeepMind AI enttäuschend ist</a></li>
<li><a href="../de495478/index.html">Big and Small Data Tester: Trends, Theorie, meine Geschichte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>