<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤤 👖 📠 単純な言語での暗号化：スターウォーズプロットを例として使用して、対称暗号化と非対称暗号化を分析します（更新） ☔️ 🤦🏾 👱🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ハブルのすべての読者にこんにちは！少し前に、私は暗号化アルゴリズムと電子署名の原則を扱うことにしました。このトピックは興味深いと思います。勉強の過程でいくつかのライブラリを試しましたが、私の観点からはPyCryptoライブラリが最も便利です。彼女は例を伴った優れたドキュメントを持っています。
 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>単純な言語での暗号化：スターウォーズプロットを例として使用して、対称暗号化と非対称暗号化を分析します（更新）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452042/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハブルのすべての読者にこんにちは！</font><font style="vertical-align: inherit;">少し前に、私は暗号化アルゴリズムと電子署名の原則を扱うことにしました。</font><font style="vertical-align: inherit;">このトピックは興味深いと思います。</font><font style="vertical-align: inherit;">勉強の過程でいくつかのライブラリを試しましたが、私の観点からは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyCrypto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリが最も便利</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">彼女は例を伴った優れたドキュメントを持っています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/66/he/oz/66heoz7zb5m8gxup9igsegwjlog.png" alt="画像"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資料を読んだ後、次の点を学びます。</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号化とは;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">対称暗号化と非対称暗号化の違いは何ですか。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この場合、対称暗号化と非対称暗号化を使用する方が効率的です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データハッシュとは何か、なぜ暗号化に使用されるのか。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トピックの関連性は常に高まっています。暗号化の使用は長い間、情報の暗号化に限定されていませんでした。何らかの形で、HTTPSプロトコルを介してサイトにアクセスするとき、クレジットカードで購入するとき、およびインスタントメッセンジャーで通信するとき、私たちは毎日暗号化アルゴリズムを使用します。過去数年にわたり、暗号化にも基づいているブロックチェーン技術が大きな注目を集めています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事の目的は、読者に基本的な暗号化アルゴリズムを紹介することです。記事を書くときは、実用化の問題にできるだけ注意を払いました。プログラミングには、Python 3.6が使用されました。コードを書くとき、私はそれを別々の部分に分けて、すべての重要なポイントについてコメントしようとしました。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、デジタル署名を明らかにしませんでしたが、非対称暗号化を理解すると、このテクノロジーの意味が明らかになります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エピソード6のイベントの前に、レジスタンスフォースが新しいデススターの建設の開始に気づいたときに、スターウォーズの宇宙に精神的に旅しましょう。司令官は、建設業者を装って諜報機関を導入することを計画しています。運用は非常に危険であり、本社とのコミュニケーションは困難です。緊急事態が発生した場合、グループの各メンバーは、保護されていない頻度で本社からメッセージを送受信できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
偵察グループの目的は、将来のステーションの構成、武器、目的を明らかにすることができるデータです。データを保存するために、特別な機器やソフトウェアを開発する予定です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本社はこの作戦の2つのバージョンを承認しました。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
計画A —データを含むエージェントを反政府勢力に戻す。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
計画B-ステーション機器を使用した、デススター自体からの計画のリモート送信。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">情報の転送は迅速に行われますが、転送後は、エージェントが計算されて捕捉される可能性が高くなります。</font></font></i><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スキーム</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/cv/xz/or/cvxzormscazwyzscn90hvzrdmqq.png" alt="image"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたは、ソフトウェア開発を担当するチームのプログラマーです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作を計画するとき、いくつかの考えられる否定的なシナリオが考慮されます：</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">敵は信号を傍受し、攻撃の計画についてその内容を理解し、オブジェクトを帝国に忠実な力に近づけます。</font><font style="vertical-align: inherit;">この場合、抵抗間の損失は大きくなります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スパイの1人が捕らえられ、尋問中に運用計画が明らかになり、暗号化キーの侵害につながる可能性があります（以下でそれらについて説明します）。</font></font></li>
<li>        ,     ,      .   ,            ;</li>
</ul><br>
<b>    :</b><br>
<br>
<ol>
<li>        ;</li>
<li>       ,          ,    .</li>
</ol><br>
<h4> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
情報の暗号化の問題を解決しましょう</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。暗号化キーは</font><font style="vertical-align: inherit;">、情報の暗号</font><font style="vertical-align: inherit;">化と復号化に使用されます。</font><font style="vertical-align: inherit;">暗号化を元に戻すことができるのはキーです。</font><font style="vertical-align: inherit;">各エージェントには暗号化キーが提供されます。</font><font style="vertical-align: inherit;">データをダウンロードした後、エージェントはそれらを暗号化してレジスタンスの本部に送信します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号化の原理の説明</font></font></b><div class="spoiler_text">,             <i> </i>. <br>
<br>
<img src="https://habrastorage.org/webt/or/pn/ar/orpnarkw6jyoz-vdtqwwf7ap4vi.png" alt="image"><br>
<br>
      ,     .       ,     .       ,       . <br>
<br>
<i> </i>          :   .<br>
<br>
<img src="https://habrastorage.org/webt/vg/bo/i3/vgboi3dy5tbj3tbta36ul-ybdau.png" alt="image"><br>
<br>
<b>  :</b><br>
<br>
<ol>
<li>    ;</li>
<li>       .  ,       ;</li>
<li>         (      ).</li>
</ol><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラミングを始めましょう！</font><font style="vertical-align: inherit;">必要なソフトウェアを開発するために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycrypto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">というPythonライブラリを使用し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">彼女は優れたドキュメントを持っており、すべての一般的な暗号化アルゴリズムを提示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Advanced Encryption Standard（AES）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれる対称暗号化の機能を開発します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、最も一般的な対称暗号化アルゴリズムの1つです。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES <span class="hljs-comment">#  </span>
<span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> SHA256 <span class="hljs-comment">#        SHA.</span>
<span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> MD5 <span class="hljs-comment">#            32 </span>
<span class="hljs-keyword">from</span> Crypto <span class="hljs-keyword">import</span> Random<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform_password</span>(<span class="hljs-params">password_str</span>):</span>
    <span class="hljs-string">"""Transform the password string into 32 bit MD5 hash
        
    :param password_str: &lt;str&gt; password in plain text;
    :return: &lt;str&gt; Transformed password fixed length
            
    """</span><font></font>
    h = MD5.new()<font></font>
    h.update(key.encode())<font></font>
    <span class="hljs-keyword">return</span> h.hexdigest()<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">symmetric_encrypt</span>(<span class="hljs-params">message, key, verbose = True</span>):</span>
    <span class="hljs-string">"""Encripts the message using symmetric AES algorythm.
        
    :param message: &lt;str&gt; Message for encryption;
    :param key: &lt;object&gt; symmetric key;
    :return: &lt;object&gt; Message encrypted with key
            
    """</span><font></font>
<font></font>
    key_MD5 = transform_password(key) <span class="hljs-comment">#      32 </span><font></font>
    message_hash = SHA256.new(message.encode())<font></font>
    message_with_hash = message.encode() + message_hash.hexdigest().encode() <span class="hljs-comment">#     .     </span><font></font>
    iv = Random.new().read(AES.block_size)<font></font>
    cipher = AES.new(key_MD5, AES.MODE_CFB, iv) <span class="hljs-comment">#     . AES.MODE_CFB -   ,      iv. https://www.dlitz.net/software/pycrypto/api/current/Crypto.Cipher.blockalgo-module.html#MODE_CFB</span>
    encrypted_message = iv + cipher.encrypt(message_with_hash) <span class="hljs-comment">#       .  ,       ,       .</span>
    <span class="hljs-keyword">if</span> verbose:<font></font>
        print(<span class="hljs-string">f'Message was encrypted into: <span class="hljs-subst">{encrypted_message.hex()}</span>'</span>)
    <span class="hljs-keyword">return</span> encrypted_message<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">symmetric_decrypt</span>(<span class="hljs-params">encr_message, key</span>):</span>
    <span class="hljs-string">"""Decripts the message using private_key and check it's hash
        
    :param encrypted_message: &lt;object&gt; Encrypted message
    :param key: &lt;object&gt; symmetric key;
    :return: &lt;object&gt; Message decripted with key
            
    """</span><font></font>
    key_MD5 = transform_password(key)   <font></font>
    <font></font>
    <span class="hljs-comment">#   ,     </span><font></font>
    bsize = AES.block_size <font></font>
    dsize = SHA256.digest_size*<span class="hljs-number">2</span><font></font>
    <font></font>
    iv = Random.new().read(bsize)<font></font>
    cipher = AES.new(key_MD5, AES.MODE_CFB, iv)<font></font>
    decrypted_message_with_hesh = cipher.decrypt(encr_message)[bsize:] <span class="hljs-comment">#     ,     </span>
    decrypted_message = decrypted_message_with_hesh[:-dsize] <span class="hljs-comment">#   ,     </span>
    digest = SHA256.new(decrypted_message).hexdigest() <span class="hljs-comment">#    .     ,     .</span><font></font>
    <font></font>
    <span class="hljs-keyword">if</span> digest==decrypted_message_with_hesh[-dsize:].decode(): <span class="hljs-comment">#      ,      ,  </span>
        print(<span class="hljs-string">f"Success!\nEncrypted hash is <span class="hljs-subst">{decrypted_message_with_hesh[-dsize:].decode()}</span>\nDecrypted hash is <span class="hljs-subst">{digest}</span>"</span>)
        <span class="hljs-keyword">return</span> decrypted_message.decode()
    <span class="hljs-keyword">else</span>:<font></font>
        print(<span class="hljs-string">f"Encryption was not correct: the hash of decripted message doesn't match with encrypted hash\nEncrypted hash is <span class="hljs-subst">{decrypted_message_with_hesh[-dsize:]}</span>\nDecrypted hash is <span class="hljs-subst">{digest}</span>"</span>)
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例を使用してコードのパフォーマンスを確認しましょう</font></font></b><div class="spoiler_text"><pre><code class="python hljs">message = <span class="hljs-string">"""
 120 
 120 
/ 120 
 10 
   30-5 (2)
   4.0

"""</span>
key = <span class="hljs-string">'Traveling through hyperspace ain’t like dusting crops, farm boy.'</span>
encr_message = symmetric_encrypt(message, key, verbose = <span class="hljs-literal">True</span>)<font></font>
print(<span class="hljs-string">'\n'</span>)<font></font>
print(<span class="hljs-string">'DECRIPTION'</span>)<font></font>
decr_message = symmetric_decrypt(encr_message, key)<font></font>
print(decr_message)<font></font>
</code></pre><br>
<pre><code class="plaintext hljs">Message was encrypted into: ed10e4c65358bb9e351c801c3b3200b21fa86a24021c317bb5c9d8b3f76bdf9f3a7d26781a22402f0e4f41ca831b6d2da9e1e6878c34c79ddc7959af3ae9fc2ba0cfff1c0180a7e0f637f1aa5b24507d552d5dfe7625e7b81d817b5882b2b19bb95f3988a03c78f850098dfc8e6089863deaa39b887eaea4c1d4ba006edaec90205d54b27ed4ac70ed75cdd01732e1176bf04218beb8ae742ff708a201a9d1cb57dd5f2e70dc3239208d23705f7a3aae3e315c4df6d73c871b66c4995cce5f19738f731cd58755d21ed92612c44197f875cddf3f7aa1d60e435ce1492679b9d60c4b8538f52408f321711ac1d2daa6dbbc33dc655abca10e2f5fd3ff27823995b9dcdb62c0bafc1963ab539ccb466f1c140479df34b0005f578f72fcdd76b17391332037b801f74f733a08<font></font>
<font></font>
<font></font>
DECRIPTION<font></font>
Success!<font></font>
Encrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026<font></font>
Decrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026<font></font>
<font></font>
 120 <font></font>
 120 <font></font>
/ 120 <font></font>
 10 <font></font>
   30-5 (2)<font></font>
   4.0<font></font>
</code></pre><br>
</div></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ご覧のとおり、公開鍵を使用してメッセージを正常に暗号化しました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを数回実行します。</font><font style="vertical-align: inherit;">暗号化された部分が変更されるたびに表示されます。</font><font style="vertical-align: inherit;">これは、暗号化の際に、プレーンテキストブロックと暗号化テキストブロックが混在する暗号化フィードバックモード（AES.MODECFB）を使用したためです。</font><font style="vertical-align: inherit;">iv-初期化ベクトル（モードの詳細については</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">メッセージを復号化すると、復号化されたメッセージのハッシュが、暗号化中に追加したハッシュと一致することがわかります。</font><font style="vertical-align: inherit;">これは、復号化が正しかったことを意味します。</font></font><br>
</i><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュとは</font></font></b><div class="spoiler_text">  —     ,    -  .        .  ,  —   « »  -  .<br>
<br>
<img src="https://habrastorage.org/webt/qn/tf/v3/qntfv3yr0oiaexp1o_jzekwsd1o.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、何らかの理由で暗号化キーが侵害された場合はどうなりますか？</font><font style="vertical-align: inherit;">その後、誰でも情報を解読できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、攻撃者が盗む可能性のある頻度で、リモートで暗号化キーを何らかの方法で変更する必要があります。彼らはすでに彼女の話を聞いていると仮定します。それでは、どうすればよいでしょうか。ここで、非対称暗号化（または公開鍵暗号システム）と呼ばれる別の方法が助けになります。対称暗号化とは異なり、公開鍵と秘密鍵の2つの鍵を使用します。メッセージは公開鍵で暗号化され、その後は秘密鍵でのみ復号化できます。復号化公開鍵は役に立たなくなります。ただし、重要な点があります。秘密鍵は、生成された公開ペアからのものでなければなりません。公開鍵の存在は、非対称暗号化のいくつかの重要で興味深い特性の1つです。つまり、公開鍵はどのチャネルでも送信でき、恐れることはありません。メッセージの復号化に使用されること。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、私たちのタスクに関しては、1つのニュアンスがあります。非対称暗号化は、短いメッセージなどの小さなデータに適しています。知性によって得られるデータの量についてしか推測できません。もちろん、受け取ったすべてのデータを小さなフラグメントに分割し、それぞれを秘密鍵でエンコードすることもできますが、より良い解決策があります。 （問題は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で整理されてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定</font></font></b><br>
<br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーAkela_wolfは、誰でも公開鍵を生成して送信できると正しく述べています。</font><font style="vertical-align: inherit;">計画を調整しました。</font></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本社がエージェントを送信する前に、いくつかのキーペアを生成し、秘密キーを各エージェントに割り当てる場合は問題ありません。</font><font style="vertical-align: inherit;">各エージェントが個別のキーを持つように、ペアをいくつか生成することをお勧めします。</font><font style="vertical-align: inherit;">これは、鍵の所有者を正確に擬人化するために必要です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、キーが危険にさらされた場合、センターは新しいSYMMETRICキーを作成し、公開キーを使用して各エージェントにエンコードして、オープンチャネル経由で送信します。</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的なソリューションスキーム</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/ge/uk/q3/geukq3vj-o8ab3bkta_i5y-8xsa.png"><br>
<img src="https://habrastorage.org/webt/5l/sn/fy/5lsnfygzrehgkfjlq6qzon-wbdw.png"><br>
</div></div><br>
<br>
</blockquote><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">古い決定</font></font></b><div class="spoiler_text"><ol>
<li>    (  )  ,      ;</li>
<li>        ;</li>
<li>      ,   ;</li>
<li>    ,       .</li>
</ol><br>
<i>       :<br>
<br>
<ol>
<li>     ,     ;</li>
<li>     ,     . </li>
</ol><br>
</i><br>
       -   .<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを書いてみましょう：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#          RSA.</span>
<span class="hljs-comment">#        SHA256</span>
<span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<font></font>
<font></font>
<span class="hljs-comment">#     </span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_keys</span>(<span class="hljs-params">bits = <span class="hljs-number">2048</span></span>):</span><font></font>
    <font></font>
    <span class="hljs-string">"""Generates the pair of private and public keys.
        
    :param bits: &lt;int&gt; Key length, or size (in bits) 
    of the RSA modulus (default 2048)
    :return: &lt;object&gt; private_key, &lt;object&gt; public_key
            
    """</span><font></font>
    private_key = RSA.generate(bits)<font></font>
    public_key = private_key.publickey()<font></font>
    <span class="hljs-keyword">return</span> private_key, public_key<font></font>
<font></font>
private_key, public_key = generate_keys(bits = <span class="hljs-number">2048</span>)
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーがどのように見えるか見てみましょう</font></font></b><div class="spoiler_text"><pre><code class="python hljs">print(private_key.exportKey(format=<span class="hljs-string">'PEM'</span>).decode())<font></font>
print(<span class="hljs-string">'\n'</span>)<font></font>
print(<span class="hljs-string">'#'</span>*<span class="hljs-number">65</span>)<font></font>
print(<span class="hljs-string">'\n'</span>)<font></font>
print(public_key.exportKey(format=<span class="hljs-string">'PEM'</span>).decode())</code></pre><br>
<code>-----BEGIN RSA PRIVATE KEY-----<br>
MIIEpAIBAAKCAQEA4JDLu7Vtvg2yqbH6Y0eJPfoEsOlKzgmOodqhA1CqkEG4OpKi<br>
sGW7ciGP4v37GE6edHBCEy4UNkVQtnpPBjzTHvKd1pO70B84vD5OSrS7uNw2EYkj<br>
d/ZwhrJMrcQKRwPkkM4OiewaaAaK0vPWJIKwlW61DY9X7LfNz7aOKMTbKnm1vdR0<br>
919AV98FUmNoQBgka6nXFGmNbi7D43MtLwxBZIXfFupEiANSvOs+57hgaCho7OWM<br>
GUOjLkG6HBscPhJ2W1H5DU9GjwL24ynTvKifgo1/2ue61MV1Pzh5CVaicJKNaRtg<br>
Pd99gFhBGINsXV2X6Jh/W5nNsCddU4EI0AlO8wIDAQABAoIBAARM4YnjrIlSK9Sy<br>
EtBp40frjMFyhjsx1ahlzmWI2utORt/gRPtJx3AlEmNPZ8qMXt5t8+X4IOz1INmN<br>
uAuviH90N++O/q66mlSIgOlPUrT0ipiFXseCUZ9StMMzGNtJSMw5FfAwNEU/stLd<br>
VoF2ezkxWIg88XsX/fn3Tfub4XKLvu4raJGcJ+Fo2GI9hYEGKnHhSuHvDHekTLlQ<br>
z46O+cIwtehbFGcKesyK3zDD1uP5YLPIWpiqt1TgKjJzRF0l4ZJLk+RT7kU2pGIQ<br>
mosOnr+06WyMIg724yQyAIwtS9X0czKBGUESrtTTb1HCXLeTwnncOTxh6q2z42LF<br>
tn34+DECgYEA6EEp4oTvjfTQfUQPMByuAjF1hpdFHQqRymygiFgoF+Mg3QmL0w8j<br>
/84H/q7s8FSx+3th8MK87bFq4lrry+h/mYwmvF5zZbhxcnl2uaX+KUPgpT6TgvAo<br>
WOv2wc4BSaoo9DrxrZId86vpO2qbopw6gkBsvw47HSoQ+FSqXtZ0p8kCgYEA94Zj<br>
b1ulctUjybiszO93TAjkzx3lU3yL+B1eZiQXtJa3mgG+ka1R/uMfr0NlT+Jzo0My<br>
wHV30YRJDxziCrDol9OgSSU0sXwEcUxUIBLBwXLCp1EmMsYG9PB/x4OTWve35a8F<br>
O+rMxuvWaZeIOfVCfL8UEcWweYaVdWIonJN+ltsCgYEAjeSZ2UlMLZce9RjqioNL<br>
EA31dlfeoqJ9dYUuAn6RaB6cSk51vWlnnfXazo9CNIYaAsFbkcL3t+QHn+jaXEZc<br>
BowocjbmG4Q20zBAB6XRBJbynSIA7yMYE1N9+uOHx+CMisGkO12krOUfZex4zzzR<br>
RhhkF8ly9htoKL9ZIv20YXkCgYBzH3UF6PkVZJ5lhtgP5Nx2Z7iLwBrV7ppnBrnO<br>
BcFkw6iXH3KT7KmzQ82LxWvMcMVZzLpBGyFkOAOG3OchE9DKNKpa+sv8NHMYguip<br>
li+5mneAPFTozoOTznuPvtl9OLO2RuXHTVh6uFub9tdsJW8L+A8MiQagLwE6fDHp<br>
SQxaewKBgQDIyzL1THpW3+AMNrOZuI/d3Em5wpGJiZbDSBRosvsfGm/sHaz4Ik5E<br>
nWnftgktmsAD60eORTTh9/ww/nm7f3q9kzT8Sv1MmqeRXq9VFIOeP/+8SSE/7LzD<br>
izlb5xEtVD8LuY54jHyiOxiZC++TQswMnOKKi0Gx26MDoO7Tx9akVw==<br>
-----END RSA PRIVATE KEY-----<br>
<br>
#################################################################<br>
<br>
-----BEGIN PUBLIC KEY-----<br>
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4JDLu7Vtvg2yqbH6Y0eJ<br>
PfoEsOlKzgmOodqhA1CqkEG4OpKisGW7ciGP4v37GE6edHBCEy4UNkVQtnpPBjzT<br>
HvKd1pO70B84vD5OSrS7uNw2EYkjd/ZwhrJMrcQKRwPkkM4OiewaaAaK0vPWJIKw<br>
lW61DY9X7LfNz7aOKMTbKnm1vdR0919AV98FUmNoQBgka6nXFGmNbi7D43MtLwxB<br>
ZIXfFupEiANSvOs+57hgaCho7OWMGUOjLkG6HBscPhJ2W1H5DU9GjwL24ynTvKif<br>
go1/2ue61MV1Pzh5CVaicJKNaRtgPd99gFhBGINsXV2X6Jh/W5nNsCddU4EI0AlO<br>
8wIDAQAB<br>
-----END PUBLIC KEY-----<br>
</code><br>
 ,           .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そこで、キーを生成しました。</font><font style="vertical-align: inherit;">次に、データをエンコードする関数を記述します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA <span class="hljs-comment">#        RSA.</span>
<span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> SHA256 <span class="hljs-comment">#        SHA256.    </span>
<span class="hljs-comment">#      </span>
<span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> PKCS1_OAEP <span class="hljs-comment">#  </span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt_message</span>(<span class="hljs-params">message, public_key, verbose = True</span>):</span>
    <span class="hljs-string">"""Encripts the message using public_key.
        
    :param message: &lt;str&gt; Message for encryption
    :param public_key: &lt;object&gt; public_key
    :param verbose: &lt;bool&gt; Print description;
    :return: &lt;object&gt; Message encrypted with public_key
            
    """</span>
    message_hash = SHA256.new(message.encode()) <span class="hljs-comment">#   .</span><font></font>
    cipher = PKCS1_OAEP.new(public_key)<font></font>
    message_with_hash = message.encode() + message_hash.hexdigest().encode() <span class="hljs-comment">#      ,         </span><font></font>
    encrypted_message = cipher.encrypt(message_with_hash)<font></font>
    <span class="hljs-keyword">if</span> verbose:<font></font>
        print(<span class="hljs-string">f'Message: <span class="hljs-subst">{message}</span> was encrypted to\n<span class="hljs-subst">{encrypted_message.hex()}</span>'</span>)
    <span class="hljs-keyword">return</span> encrypted_message<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decrypt_message</span>(<span class="hljs-params">encrypted_message, private_key</span>):</span>
    <span class="hljs-string">"""Decripts the message using private_key and check it's hash
        
    :param encrypted_message: &lt;object&gt; Encrypted message
    :param private_key: &lt;object&gt; private_key
    :return: &lt;object&gt; Message decripted with private_key
            
    """</span>
    dsize = SHA256.digest_size*<span class="hljs-number">2</span><font></font>
    cipher = PKCS1_OAEP.new(private_key)<font></font>
    decrypted_message_with_hesh = cipher.decrypt(encrypted_message) <span class="hljs-comment">#   (  )</span>
    decrypted_message = decrypted_message_with_hesh[:-dsize] <span class="hljs-comment">#     </span>
    digest = SHA256.new(decrypted_message).hexdigest() <span class="hljs-comment">#    </span>
    <span class="hljs-keyword">if</span> digest==decrypted_message_with_hesh[-dsize:].decode(): <span class="hljs-comment">#      ,      ,  </span>
        print(<span class="hljs-string">f"Success!\nEncrypted hash is <span class="hljs-subst">{decrypted_message_with_hesh[-dsize:].decode()}</span>\nDecrypted hash is <span class="hljs-subst">{digest}</span>"</span>)
        <span class="hljs-keyword">return</span> decrypted_message.decode()
    <span class="hljs-keyword">else</span>:<font></font>
        print(<span class="hljs-string">f"Encryption was not correct: the hash of decripted message doesn't match with encrypted hash\nEncrypted hash is <span class="hljs-subst">{decrypted_message_with_hesh[-dsize:]}</span>\nDecrypted hash is <span class="hljs-subst">{digest}</span>"</span>)
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワークフローのステップ</font></font></b><div class="spoiler_text"><ol>
<li>   :<br>
<pre><code class="python hljs">private_key, public_key = generate_keys()</code></pre><br>
</li>
<li>    ;</li>
<li>          :<br>
<pre><code class="python hljs">new_symmetric_key = <span class="hljs-string">'SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt'</span>
encr_msg = encrypt_message(new_symmetric_key, public_key)</code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><code>Message: SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt was encrypted to<br>
41e940507c96397e3feb4a53390c982633bb1775a52957996a8069bd22063086a0e831bf775a17909276aba0d0478ee6c953837c8ea5d20d40e1c8eb463aaa1bc5c93c71677b1a85e90439c9dbda8a98ce168acb38368155437c66815b84aa2fbdda0eb909e4e6079b4410c720eddd955ed048193bf87f8f9976a17ee32a58a71dfddf3db116343d949d29c25f72c511a440a50a5d4f1e01c37b24a1cb4127e191d3231328b2f120c7dbd0cb5bf19823f0978b8ed17d25952de4b146ef9724fff359eb2af503fdfd72b91525a5503b076ba9aaaeac55af3f8d210c12d579d45dd70362123c0b4b36ef9c2f7705e6f884a25553eb0e11e5077f11fa986d0ff280</code><br>
</div></div><br>
</li>
<li>     ;</li>
<li>       :<br>
<pre><code class="python hljs">recieved_symmetric_key = decrypt_message(encr_msg, private_key)<font></font>
print(<span class="hljs-string">'\n'</span>)<font></font>
print(<span class="hljs-string">f"New symmetric key is: <span class="hljs-subst">{recieved_symmetric_key}</span>"</span>)</code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">Success!<font></font>
Encrypted hash is 42ad66445a05ac09e684bb21f9b487d95b9cfa11d02e0b459931321ee02f7c1c<font></font>
Decrypted hash is 42ad66445a05ac09e684bb21f9b487d95b9cfa11d02e0b459931321ee02f7c1c<font></font>
<font></font>
New symmetric key is: SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt</code></pre><br>
</div></div><br>
</li>
<li>         :<br>
<br>
<pre><code class="python hljs">message = <span class="hljs-string">"""
 120 
 120 
/ 120 
 10 
   30-5 (2)
   4.0

"""</span>
encr_message = symmetric_encrypt(message, recieved_symmetric_key, verbose = <span class="hljs-literal">True</span>)
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">Message was encrypted into: 665968950814e0edf48bd80f368cda63ee0ac2b06173989b4bc239c02a064715e433d3e07f638d8e277e9b4bcd0d32c8c819483501066549a64c7ba8a29fa16a289c0283665cfbc2d1ff8ea8c4c4691b76ca430d9d1a26bfe38eb9d3c6ff398ea8926f44af13cf74a30f870f56bab3112374331b3a8bdfd5b1ca465604738e83b86481ca8852193c6c27db25690577d3e28c930d357abba6a3bf4c1f77f69dd066b933b60b353a7c44439baaabe9a58593efab6b410ee7ff4bbcc72dd07456a4f8c9a68c64e99a9151bc466f9daa2cdd3b4abcef7f87bc58caaef52a7811ce05cda5e03e9cba4b1537f7e6096b2385491a1c49a451373868f9951581643047d8f0c72e789943cc7112e00d06a4848919ee823bb18338e2b157c39b8911e518fdccdc8847a3e24be4cedad6
</code></pre><br>
</div></div><br>
</li>
<li>   :<br>
<pre><code class="python hljs">print(<span class="hljs-string">'DECRIPTION'</span>)<font></font>
decr_message = symmetric_decrypt(encr_message, new_symmetric_key)<font></font>
print(decr_message)<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">DECRIPTION<font></font>
Success!<font></font>
Encrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026<font></font>
Decrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026<font></font>
<font></font>
 120 <font></font>
 120 <font></font>
/ 120 <font></font>
 10 <font></font>
   30-5 (2)<font></font>
   4.0<font></font>
</code></pre><br>
</div></div><br>
</li>
</ol><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出来上がり！</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この抽象的な例では、一般的な暗号化アルゴリズムの動作を確認しました。</font><font style="vertical-align: inherit;">対称暗号化と非対称暗号化、およびハッシュ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ウェブ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電子署名</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブロックチェーン、暗号通貨</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">の作業で</font></a><font style="vertical-align: inherit;">使用さ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">れ</font></a><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これらの技術の動作を理解するために、この資料がお役に立てば幸いです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あとがき</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、反乱軍の諜報機関は、ステーションの脆弱性とその経路、検査のための皇帝の存在、エネルギーシールドの存在とEndorでのその発生源に関する正確な情報を取得することができました。</font><font style="vertical-align: inherit;">帝国はスパイを発見し、ステーションの戦闘能力について彼らに誤って知らせた。</font><font style="vertical-align: inherit;">駅はまた、シールドで保護されていたエンドアの衛星にも割り当てられました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、それがすべて終わった方法を知っています;）</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja452030/index.html">インターネットの歴史：双方向性の発見</a></li>
<li><a href="../ja452034/index.html">自己教育のための時間と本を読むための時間の自己制御</a></li>
<li><a href="../ja452036/index.html">ソフトウェア無線-それはどのように機能しますか？パート2</a></li>
<li><a href="../ja452038/index.html">危険な取引</a></li>
<li><a href="../ja452040/index.html">ツングースカ隕石とその弟</a></li>
<li><a href="../ja452046/index.html">ATmega328Pの低静止電流のリモートコントローラー</a></li>
<li><a href="../ja452052/index.html">航空会社のソリューションを見ることで、入門レッスンの費用を半分にした方法</a></li>
<li><a href="../ja452054/index.html">WhatsAppが安全にならない理由</a></li>
<li><a href="../ja452056/index.html">Golang DevDay：5月31日、ノボシビルスク+放送</a></li>
<li><a href="../ja452060/index.html">情報希望述語</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>