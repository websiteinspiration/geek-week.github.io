<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶Ñ üèòÔ∏è üë©üèæ‚Äçü§ù‚Äçüë©üèª –ù–µ–π—Ä–æ—Å–µ—Ç—å ‚Äî –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ —É—á–∏—Ç–µ–ª—è. –ú–µ—Ç–æ–¥ Policy Gradient ü§∏üèº üë©üèΩ‚Äçüç≥ ‚è≤Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", 
 , .
 (Reinforcement Learning for Neuron Networks)
 
 . Policy Gradient, Q-learning, Actor-Critic.
 
 .
 
  ‚Äî Policy Gradient 
 (Policy Gradient fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>–ù–µ–π—Ä–æ—Å–µ—Ç—å ‚Äî –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ —É—á–∏—Ç–µ–ª—è. –ú–µ—Ç–æ–¥ Policy Gradient</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506384/"><h3>  , </h3><br>
      ,      .<br>
 (Reinforcement Learning for Neuron Networks)<br>
<br>
                  .     Policy Gradient,   Q-learning,       Actor-Critic.<br>
<br>
 .<br>
<br>
<h4>  ‚Äî     Policy Gradient <br>
 (Policy Gradient for Reinforcement Learning)</h4><br>
<h4></h4><br>
                   ,        . <br>
<br>
     ‚Äî    ,        ,       . <br>
<br>
              ‚Äî     . <br>
<a name="habracut"></a><br>
<h4> 1.   </h4><br>
     ‚Äî     .                .<br>
<br>
       , ,              .                     ,                     . <br>
<br>
      Mnist       ‚Äî        .<br>
<br>
<img src="https://habrastorage.org/webt/za/kq/b6/zakqb6ob1_xce07caywnurtsl7k.png"><br>
<br>
   Mnist                    .                              ,         .<br>
<br>
      ‚Äî         ,             . <br>
<br>
       ‚Äî           ,                    ,  ,            ,    . <br>
<br>
      ,            .<br>
<br>
<h4> 2.   </h4><br>
     ‚Äî   ,  ,     ‚Äî   .<br>
<br>
     ,         ,   ,        ,     ‚Äî    ,           . <br>
<br>
   ,          ,     ?            ,              .<br>
<br>
 ,   .   ,      ,                ,       ,     ,        .<br>
<br>
       ,       .<br>
<br>
      ,    ,         ,         ,            .<br>
<br>
<img src="https://habrastorage.org/webt/qi/ci/nn/qicinnqzow8o5b7lacir_mrs4aa.png"><br>
<br>
                       .        ‚Äî      . <br>
<br>
<img src="https://habrastorage.org/webt/-f/dp/df/-fdpdf5nbjpawt1mutegmxzw9iu.gif"><br>
<br>
<img src="https://habrastorage.org/webt/ve/jk/wz/vejkwz-fezjvbjcjydzmx7q4hk8.gif"><br>
<br>
<img src="https://habrastorage.org/webt/ws/gv/nb/wsgvnb34jwzwk--6iehpg3y3lqw.gif"><br>
<br>
      .                    .<br>
<br>
<h4> 3. ,   </h4><br>
  ,     ,                 .<br>
 <br>
<br>
          .<br>
               - .<br>
<br>
 ‚Äî              ‚Ä¶ <br>
<br>
 ‚Äî           .<br>
<br>
<img src="https://habrastorage.org/webt/23/dp/gw/23dpgwboqw80sv_1uj5_ubifms8.png"><br>
<br>
          ,         ,       .              .<br>
<br>
              <br>
<br>
<img src="https://habrastorage.org/webt/ml/f5/eq/mlf5eqvivcvcwodu66mfyddfpdo.png"><br>
<br>
St ‚Äî   (state)   t<br>
at ‚Äî   (action)   t<br>
rt ‚Äî  (reward)   t<br>
<br>
    t      ‚Äî St,   ‚Äî at,       ‚Äî rt,       St+1,    ,   ‚Äî at+1,       ‚Äî rt+1    t       ‚Äî n.<br>
<br>
<h4> 4.     </h4><br>
        -     ,         .  reinforcement learning ‚Äî         ,     :<br>
<br>
1) p(a|s) ‚Äî policy function <br>
    ‚Äî a      -s.      a    s .<br>
<br>
2) v(s) ‚Äî value function<br>
   ‚Äî s.      s        <br>
<br>
3) Q(s,a) ‚Äî Q-function <br>
Q   .          ‚Äî s       ‚Äî a<br>
<br>
   ‚Äî policy function,          reinforcement learning.<br>
<br>
     reinforcement learning   .      policy function     . <br>
<br>
<img src="https://habrastorage.org/webt/oa/fv/1x/oafv1xdki7zeejvxvy-tsgd5oeu.png"><br>
<br>
   ,    ‚Äî s,      ,       SoftMax,            .        s            s.                     policy function,        .<br>
<br>
<h4> 5.  policy function   </h4><br>
       .       SoftMax ,  Loss  :<br>
<br>
<img src="https://habrastorage.org/webt/29/y9/u2/29y9u2wizl5w2yf5yeyw08nk1ic.png"><br>
<br>
: <br>
1 ‚Äî   * log( )<br>
2 ‚Äî    <br>
<br>
                  S0-Sj?      ,                  .<br>
<br>
<img src="https://habrastorage.org/webt/46/jp/or/46jporp-h9pj-bujcmytwhnfmze.png"><br>
<br>
      ,  Cross Entropy Loss ‚Äî yj ‚Äî           ,   Policy Function Loss ‚Äî rj ‚Äî          .   rj              . <br>
<br>
   ‚Äî        .<br>
<br>
<img src="https://habrastorage.org/webt/2e/ge/bq/2egebqgdxjutx0tzxvwawunwffq.png"><br>
<br>
   ,     ,       .<br>
<br>
<h4> 6.    </h4><br>
      ‚Äî    Machine Learning ‚Äî     ,    . <br>
<br>
   ,          S ‚Äî          .<br>
<br>
<img src="https://habrastorage.org/webt/4h/pv/hr/4hpvhry6ju1kcckfjj4vxu_7eps.png"><br>
<br>
 Y ‚Äî        S,      ‚Äî           ‚Äî r <br>
<br>
<img src="https://habrastorage.org/webt/an/gh/wo/anghwor5xj9mqdbgnnjrjgvzbta.png"><br>
<br>
             ,          ,     .            ,      .           ,       ,     ,       .<br>
<br>
<img src="https://habrastorage.org/webt/7f/rh/5u/7frh5uda0syl7dbcutr8ez8fcq8.png"><br>
<br>
      ,         ,           .                .    ,    ‚Äî       ,                 ,     ,        . <br>
               ? <br>
<br>
      : <br>
<br>
 ‚Äî                   +1  -1,          . <br>
<br>
                    ,    .       ,                    .<br>
 ‚Äî                .  ,          +1  -1    . <br>
<br>
              ,    ,      ,      ,       .<br>
<br>
      ‚Äî                    (  ,   ).<br>
<br>
<img src="https://habrastorage.org/webt/4r/cf/w6/4rcfw67kmlniyfhczs_p2v2kb-c.png"><br>
<br>
 ‚Äî   ( ).       0  1.      0.95<br>
<br>
           ,            ,   :<br>
<br>
<ul>
<li> , </li>
<li>    , </li>
<li>   .</li>
</ul><br>
         ‚Äî  ,  ,        .  ,             ,      .        +1 ,            ,    -1 .<br>
<br>
<h4> 7.     </h4><br>
 ‚Äî                           ,           .<br>
<br>
   ,              ,              ,                 .              .<br>
<br>
 ‚Äî                      .      ,   ,    ,          .                  .<br>
<br>
<h4> 8.  </h4><br>
                 .          ‚Äî  ,       .<br>
<br>
<img src="https://habrastorage.org/webt/yo/qq/od/yoqqodgrfzatgri5dljps6uqnvw.png"><br>
<br>
<h4>    </h4><br>
<img src="https://habrastorage.org/webt/ph/hr/6x/phhr6xb35udm3hyc3mr9rwv5yno.png"><br>
<br>
         ,              .<br>
<br>
<h4>    :</h4><br>
<img src="https://habrastorage.org/webt/u2/55/ty/u255ty2pzaoeagitk_osyxzxirg.png"><br>
<br>
               .<br>
<br>
                ,      Pytorch.<br>
<br>
<img src="https://habrastorage.org/webt/jo/se/6t/jose6tkxmmtzsttgrnc-q0xkrf0.png"><br>
 <br>
       Pytorch      ,             ,   ,           ,          :<br>
<br>
<img src="https://habrastorage.org/webt/hx/om/3i/hxom3ikgq9n13pb6brfzsfsbmkw.png"><br>
<br>
 1<br>
<br>
<img src="https://habrastorage.org/webt/4j/gh/8l/4jgh8layvkcwg0dhrylxuwul2ri.png"><br>
<br>
 2<br>
<br>
<img src="https://habrastorage.org/webt/pn/ac/pj/pnacpjuzovqe4-zql7lxlarerly.png"><br>
<br>
      Loss       ,          .       . <br>
<br>
                  ,                        . <br>
<br>
       ,              .<br>
<br>
          Policy Gradient.<br>
<br>
<ol>
<li>  </li>
<li> </li>
<li>  </li>
</ol><br>
     ,             .<br>
<br>
<h4> 9.     </h4><br>
      .<br>
<br>
     :<br>
<br>
<img src="https://habrastorage.org/webt/xi/ym/2_/xiym2_kitmamvf52hhuff6tkpqs.png"><br>
<br>
   ‚Äî   ‚Äî    (..   )      9  (1-, 2-, 3-, 4-, 5--, 6--, 7--, 8--, 9-  )  SoftMax,      .<br>
<br>
<h4> </h4><br>
 Conv2d  32    1*32*16<br>
MaxPool2d    32*16*8<br>
 Conv2d  32    32*16*8<br>
MaxPool2d    32*8*4<br>
Flatten ‚Äî     1024<br>
Linear   1024 <br>
Dropout(0.25) <br>
Linear   512 <br>
Linear   256 <br>
Linear   9   SoftMax<br>
<br>
<img src="https://habrastorage.org/webt/2d/tz/ne/2dtzneqr2lsxdkz-yvu9xonh0uw.png"><br>
<br>
<h4>    Pytorch</h4><br>
<img src="https://habrastorage.org/webt/wq/mx/yw/wqmxyw67mbjtmnpnbj86zry8y4a.png"><br>
<br>
           :<br>
<br>
<h4> ‚Ññ 1 ‚Äî      13600  </h4><br>
  <br>
<br>
<img src="https://habrastorage.org/webt/ws/gv/nb/wsgvnb34jwzwk--6iehpg3y3lqw.gif"><br>
<br>
  <br>
<br>
<img src="https://habrastorage.org/webt/jt/kd/3q/jtkd3qmdl7xixi-bwpkdp-tk0uy.png"><br>
<br>
  <br>
<br>
<img src="https://habrastorage.org/webt/4a/v5/9l/4av59lvev4oget2gotgg-xsfy2w.gif"><br>
<br>
<h4> ‚Ññ 2 ‚Äî      8250  </h4><br>
  <br>
<br>
<img src="https://habrastorage.org/webt/ve/jk/wz/vejkwz-fezjvbjcjydzmx7q4hk8.gif"><br>
<br>
  <br>
<br>
<img src="https://habrastorage.org/webt/9e/zc/1x/9ezc1x4gfv7bilgb8sx-r3iemgy.png"><br>
<br>
  <br>
<br>
<img src="https://habrastorage.org/webt/l9/r7/bn/l9r7bnstfbaqszje4npotjrze4o.gif"><br>
<br>
<h4> ‚Ññ 3 ‚Äî      19800  </h4><br>
  <br>
<br>
<img src="https://habrastorage.org/webt/hz/wm/ss/hzwmssjogsxwzv0wrik-1nb8loc.gif"><br>
<br>
  <br>
<br>
<img src="https://habrastorage.org/webt/sh/xv/zd/shxvzdpumy7fnoctkb6bqnhie2o.png"><br>
<br>
  <br>
<br>
<img src="https://habrastorage.org/webt/2h/ga/yh/2hgayhvtgypaq1fvu-i54d4l4ok.gif"><br>
<br>
<h4> 10. </h4><br>
    ,      . <br>
      -     ,     . <br>
<br>
      ,      ,         ,             ,      ,       ,        ,           .<br>
<br>
           Policy Gradient, ..             .                ,     ,     .     .<br>
<br>
         ‚Äî     ,        ,     .            .<br>
<br>
     ‚Äî  ,        ,   ,  ,    .        ,     .<br>
<br>
            Policy Gradient  ,       ,    . <br>
       . <br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">  GitHub c ,      Google Colab</a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja506358/index.html">ÂΩº„Çâ„ÅåÊ§úÂØüÂÅ¥„ÅÆ„É≠„ÉÉ„ÇØ„ÅÆ‰∫ã‰ª∂„ÇíÂèó„ÅëÂèñ„Å£„Åü„Å®„Åç„ÅÆË£ÅÂà§ÊâÄ„ÅÆË°åÂãï„ÅÆ„Åü„ÇÅ„ÅÆ3„Å§„ÅÆ„Ç™„Éó„Ç∑„Éß„É≥</a></li>
<li><a href="../ja506362/index.html">„Ç™„É≥„É©„Ç§„É≥„Åß„ÉÄ„É≥„Çπ„Éú„Éº„É´„Çí„Åó„ÅüÊñπÊ≥ï</a></li>
<li><a href="../ja506370/index.html">SQL Server„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØÂà∂Á¥Ñ„Å®Â§ñÈÉ®„Ç≠„Éº„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÇíÊØîËºÉ„Åô„Çã</a></li>
<li><a href="../ja506372/index.html">ÁîüÊÆñ„ÅÆÊú¨ËÉΩ„ÅØ‰∫∫Â∑•Áü•ËÉΩ„Å´„ÅÇ„Çä„Åæ„Åô</a></li>
<li><a href="../ja506380/index.html">ÁÑ°Êñô„Åæ„Åü„ÅØÂõΩÂÜÖÂêë„Åë„ÅÆ„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„ÄÇÊ®ôÊ∫ñ„Åæ„Åü„ÅØÁÑ°Êñô„ÅÆÊéàÊ•≠Êñô</a></li>
<li><a href="../ja506386/index.html">Â≠¶Ê†°„Çí‰∏≠ÈÄÄ„Åó„Å¶Â≠ê‰æõ„ÇíÈõ¢„Çå„ÅüÂ†¥ÊâÄ„Å´ÁßªÂãï„Åï„Åõ„ÇãÊñπÊ≥ï</a></li>
<li><a href="../ja506392/index.html">2020Âπ¥„ÅÆÂÄã‰∫∫„Éá„Éº„Çø„ÅÆÂá¶ÁêÜ„Å´Èñ¢„Åô„ÇãRoskomnadzor„ÅÆÈÄöÁü•</a></li>
<li><a href="../ja506394/index.html">Anycubic Mega X 3D„Éó„É™„É≥„Çø„ÉºÔºöÊâãÈ†É„Å™‰æ°Ê†º„ÅÆÂÑ™„Çå„Åü„Éó„É™„É≥„Çø„Éº</a></li>
<li><a href="../ja506396/index.html">„Ç®„É≠„É≥„Éª„Éû„Çπ„ÇØÔºö„Äå„É©„Ç§„ÉÄ„Éº„ÅØÊôÇÈñì„ÅÆÁÑ°ÈßÑ„Åß„Åô„ÄÇLIDAR„Å´‰æùÂ≠ò„Åó„Å¶„ÅÑ„Çã„Åô„Åπ„Å¶„ÅÆ‰∫∫„ÅØÈÅãÂëΩ„Å•„Åë„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„Äç</a></li>
<li><a href="../ja506398/index.html">„Ç∏„Éß„Ç®„É´„Éª„Çπ„Éù„É´„Çπ„Ç≠„ÉºÔºö„ÄåÂçòÁã¨„Åß„ÅÆ„É¶„Éº„Ç∂„Éì„É™„ÉÜ„Ç£„Åß„ÅØ„Å™„ÅÑ„Äç</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>