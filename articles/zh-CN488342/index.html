<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¥¨ âœğŸ¿ ğŸ˜– éšæœºæ£®æ—ï¼Œä¸»æˆåˆ†æ–¹æ³•å’Œè¶…å‚æ•°ä¼˜åŒ–ï¼šè§£å†³Pythonåˆ†ç±»é—®é¢˜çš„ç¤ºä¾‹ ğŸº ğŸ¾ â³</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ•°æ®å¤„ç†å’Œåˆ†æä¸“å®¶æ‹¥æœ‰è®¸å¤šç”¨äºåˆ›å»ºåˆ†ç±»æ¨¡å‹çš„å·¥å…·ã€‚å¼€å‘æ­¤ç±»æ¨¡å‹çš„æœ€æµè¡Œï¼Œæœ€å¯é çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨éšæœºæ£®æ—ï¼ˆRFï¼‰ç®—æ³•ã€‚ä¸ºäº†å°è¯•æ”¹å–„ä½¿ç”¨RFç®—æ³•æ„å»ºçš„æ¨¡å‹çš„æ€§èƒ½ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡å‹è¶…å‚æ•°çš„ä¼˜åŒ–ï¼ˆHyperparameter Tuningï¼ŒHTï¼‰ã€‚ æ­¤å¤–ï¼Œå­˜åœ¨ä¸€ç§å¹¿æ³›çš„æ–¹æ³•ï¼Œæ ¹æ®è¯¥æ–¹æ³•ï¼Œä½¿ç”¨ä¸»æˆåˆ†åˆ†æå¤„ç†æ•°æ®ï¼Œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>éšæœºæ£®æ—ï¼Œä¸»æˆåˆ†æ–¹æ³•å’Œè¶…å‚æ•°ä¼˜åŒ–ï¼šè§£å†³Pythonåˆ†ç±»é—®é¢˜çš„ç¤ºä¾‹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/488342/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®å¤„ç†å’Œåˆ†æä¸“å®¶æ‹¥æœ‰è®¸å¤šç”¨äºåˆ›å»ºåˆ†ç±»æ¨¡å‹çš„å·¥å…·ã€‚</font><font style="vertical-align: inherit;">å¼€å‘æ­¤ç±»æ¨¡å‹çš„æœ€æµè¡Œï¼Œæœ€å¯é çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨éšæœºæ£®æ—ï¼ˆRFï¼‰ç®—æ³•ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†å°è¯•æ”¹å–„ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç®—æ³•æ„å»ºçš„æ¨¡å‹çš„æ€§èƒ½</font><font style="vertical-align: inherit;">ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡å‹è¶…å‚æ•°çš„ä¼˜åŒ–ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperparameter Tuning</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ŒHTï¼‰ã€‚</font><font style="vertical-align: inherit;">
æ­¤å¤–ï¼Œå­˜åœ¨ä¸€ç§å¹¿æ³›çš„æ–¹æ³•ï¼Œæ ¹æ®è¯¥æ–¹æ³•ï¼Œä½¿ç”¨</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ä¸»æˆåˆ†åˆ†æ</font></a><font style="vertical-align: inherit;">å¤„ç†æ•°æ®ï¼Œç„¶åå†å°†æ•°æ®ä¼ è¾“åˆ°æ¨¡å‹ä¸­ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/tt/m5/h7/ttm5h7jbbx2u2wuc1var1azxwew.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ŒPCAï¼‰ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯å€¼å¾—ä½¿ç”¨å—ï¼Ÿ</font><font style="vertical-align: inherit;">å°„é¢‘ç®—æ³•çš„ä¸»è¦ç›®çš„ä¸æ˜¯å¸®åŠ©åˆ†æå¸ˆè§£é‡Šç‰¹å¾çš„é‡è¦æ€§å—ï¼Ÿ</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¯çš„ï¼Œåœ¨åˆ†æRFæ¨¡å‹çš„â€œç‰¹å¾é‡è¦æ€§â€æ—¶ï¼Œä½¿ç”¨PCAç®—æ³•å¯èƒ½ä¼šä½¿æ¯ä¸ªâ€œç‰¹å¾â€çš„è§£é‡Šç¨å¾®å¤æ‚ä¸€äº›ã€‚ä½†æ˜¯ï¼ŒPCAç®—æ³•å‡å°äº†ç‰¹å¾ç©ºé—´çš„å°ºå¯¸ï¼Œè¿™å¯èƒ½å¯¼è‡´RFæ¨¡å‹éœ€è¦å¤„ç†çš„ç‰¹å¾æ•°é‡å‡å°‘ã€‚è¯·æ³¨æ„ï¼Œè®¡ç®—é‡æ˜¯éšæœºæ£®æ—ç®—æ³•çš„ä¸»è¦ç¼ºç‚¹ä¹‹ä¸€ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå®Œæˆæ¨¡å‹å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼‰ã€‚ PCAç®—æ³•çš„åº”ç”¨å¯èƒ½æ˜¯å»ºæ¨¡çš„ä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œå°¤å…¶æ˜¯åœ¨å®ƒä»¬å…·æœ‰æ•°ç™¾ç”šè‡³æ•°åƒä¸ªåŠŸèƒ½çš„æƒ…å†µä¸‹ã€‚å› æ­¤ï¼Œå¦‚æœæœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯ç®€å•åœ°åˆ›å»ºæœ€æœ‰æ•ˆçš„æ¨¡å‹ï¼Œå¹¶ä¸”åŒæ—¶ç‰ºç‰²äº†ç¡®å®šå±æ€§é‡è¦æ€§çš„å‡†ç¡®æ€§ï¼Œé‚£ä¹ˆPCAå¯èƒ½å€¼å¾—ä¸€è¯•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨åˆ°äº†é‡ç‚¹ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹³è…ºç™Œæ•°æ®é›†-Scikit-learnâ€œä¹³è…ºç™Œâ€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†åˆ›å»ºä¸‰ä¸ªæ¨¡å‹å¹¶æ¯”è¾ƒå®ƒä»¬çš„æœ‰æ•ˆæ€§ã€‚</font><font style="vertical-align: inherit;">å³ï¼Œæˆ‘ä»¬æ­£åœ¨è°ˆè®ºä»¥ä¸‹æ¨¡å‹ï¼š</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºäºRFç®—æ³•çš„åŸºæœ¬æ¨¡å‹ï¼ˆæˆ‘ä»¬å°†ç®€ç§°ä¸ºRFæ¨¡å‹ï¼‰ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸1å·æ¨¡å‹ç›¸åŒï¼Œä½†å…¶ä¸­ä¸€ç§æ¨¡å‹æ˜¯ä½¿ç”¨ä¸»æˆåˆ†æ–¹æ³•ï¼ˆRF + PCAï¼‰æ¥ç¼©å°ç‰¹å¾ç©ºé—´çš„å°ºå¯¸ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸2å·æ¨¡å‹ç›¸åŒï¼Œä½†ä½¿ç”¨è¶…å‚æ•°ä¼˜åŒ–ï¼ˆRF + PCA + HTï¼‰æ„å»ºã€‚</font></font></li>
</ol><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.å¯¼å…¥æ•°æ®</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼ŒåŠ è½½æ•°æ®å¹¶åˆ›å»ºPandasæ•°æ®æ¡†ã€‚</font><font style="vertical-align: inherit;">ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†Scikit-learnä¸­é¢„å…ˆæ¸…é™¤çš„â€œç©å…·â€æ•°æ®é›†ï¼Œå› æ­¤ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å»ºæ¨¡è¿‡ç¨‹äº†ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå³ä½¿ä½¿ç”¨æ­¤ç±»æ•°æ®ï¼Œä¹Ÿå»ºè®®æ‚¨å§‹ç»ˆé€šè¿‡ä½¿ç”¨ä»¥ä¸‹åº”ç”¨äºæ•°æ®æ¡†ï¼ˆ</font></font><code>df</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰çš„</font><font style="vertical-align: inherit;">å‘½ä»¤å¯¹æ•°æ®è¿›è¡Œåˆæ­¥åˆ†ææ¥å¼€å§‹å·¥ä½œ</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<ul>
<li><code>df.head()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æŸ¥çœ‹æ–°æ•°æ®æ¡†ï¼Œçœ‹å…¶æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</font></font></li>
<li><code>df.info()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-æ‰¾å‡ºæ•°æ®ç±»å‹å’Œåˆ—å†…å®¹çš„ç‰¹å¾ã€‚</font><font style="vertical-align: inherit;">åœ¨ç»§ç»­ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦æ‰§è¡Œæ•°æ®ç±»å‹è½¬æ¢ã€‚</font></font></li>
<li><code>df.isna()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ç¡®ä¿æ•°æ®ä¸­æ²¡æœ‰å€¼</font></font><code>NaN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç›¸åº”çš„å€¼ï¼ˆå¦‚æœæœ‰ï¼‰å¯èƒ½éœ€è¦ä»¥æŸç§æ–¹å¼å¤„ç†ï¼Œæˆ–è€…ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œå¯èƒ½æœ‰å¿…è¦ä»æ•°æ®å¸§ä¸­åˆ é™¤æ•´è¡Œã€‚</font></font></li>
<li><code>df.describe()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æ‰¾å‡ºåˆ—ä¸­æŒ‡æ ‡çš„æœ€å°ï¼Œæœ€å¤§å€¼ï¼Œå¹³å‡å€¼ï¼Œæ‰¾å‡ºåˆ—ä¸­å‡æ–¹æ ¹å’Œå¯èƒ½åå·®çš„æŒ‡æ ‡ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­ï¼Œä¸€åˆ—</font></font><code>cancer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆç™Œç—‡ï¼‰æ˜¯ç›®æ ‡å˜é‡ï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ¨¡å‹é¢„æµ‹å…¶å€¼ã€‚</font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨ç¤ºâ€œæ²¡æœ‰ç–¾ç—…â€ã€‚</font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ã€Šç—…çš„å­˜åœ¨ã€‹ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<font></font>
columns = [<span class="hljs-string">'mean radius'</span>, <span class="hljs-string">'mean texture'</span>, <span class="hljs-string">'mean perimeter'</span>, <span class="hljs-string">'mean area'</span>, <span class="hljs-string">'mean smoothness'</span>, <span class="hljs-string">'mean compactness'</span>, <span class="hljs-string">'mean concavity'</span>, <span class="hljs-string">'mean concave points'</span>, <span class="hljs-string">'mean symmetry'</span>, <span class="hljs-string">'mean fractal dimension'</span>, <span class="hljs-string">'radius error'</span>, <span class="hljs-string">'texture error'</span>, <span class="hljs-string">'perimeter error'</span>, <span class="hljs-string">'area error'</span>, <span class="hljs-string">'smoothness error'</span>, <span class="hljs-string">'compactness error'</span>, <span class="hljs-string">'concavity error'</span>, <span class="hljs-string">'concave points error'</span>, <span class="hljs-string">'symmetry error'</span>, <span class="hljs-string">'fractal dimension error'</span>, <span class="hljs-string">'worst radius'</span>, <span class="hljs-string">'worst texture'</span>, <span class="hljs-string">'worst perimeter'</span>, <span class="hljs-string">'worst area'</span>, <span class="hljs-string">'worst smoothness'</span>, <span class="hljs-string">'worst compactness'</span>, <span class="hljs-string">'worst concavity'</span>, <span class="hljs-string">'worst concave points'</span>, <span class="hljs-string">'worst symmetry'</span>, <span class="hljs-string">'worst fractal dimension'</span>]<font></font>
dataset = load_breast_cancer()<font></font>
data = pd.DataFrame(dataset[<span class="hljs-string">'data'</span>], columns=columns)<font></font>
data[<span class="hljs-string">'cancer'</span>] = dataset[<span class="hljs-string">'target'</span>]<font></font>
display(data.head())<font></font>
display(data.info())<font></font>
display(data.isna().sum())<font></font>
display(data.describe())</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bce/fb8/b60/bcefb8b60462b7658b40e1e56f7744ab.png"></div><br>
<i><font color="#999999">      .       .  , cancer,   ,    . 0  Â« Â». 1 â€” Â« Â»</font></i><br>
 <br>
<h2><font color="#3AC1EF">2.        </font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œä½¿ç”¨Scikit-learnå‡½æ•°æ‹†åˆ†æ•°æ®</font></font><code>train_test_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚æˆ‘ä»¬å¸Œæœ›ä¸ºæ¨¡å‹æä¾›å°½å¯èƒ½å¤šçš„è®­ç»ƒæ•°æ®ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡è¶³å¤Ÿçš„æ•°æ®æ¥æµ‹è¯•æ¨¡å‹ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œéšç€æ•°æ®é›†ä¸­çš„è¡Œæ•°å¢åŠ ï¼Œå¯ä»¥è®¤ä¸ºå…·æœ‰æ•™è‚²æ„ä¹‰çš„æ•°æ®é‡ä¹Ÿä¼šå¢åŠ ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œå¦‚æœæœ‰æ•°ä»¥ç™¾ä¸‡è®¡çš„è¡Œï¼Œåˆ™å¯ä»¥é€šè¿‡çªå‡ºæ˜¾ç¤ºè®­ç»ƒæ•°æ®çš„90ï¼…å’Œæµ‹è¯•æ•°æ®çš„10ï¼…æ¥æ‹†åˆ†é›†åˆã€‚ä½†æ˜¯æµ‹è¯•æ•°æ®é›†ä»…åŒ…å«569è¡Œã€‚è€Œä¸”å¯¹äºè®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹è€Œè¨€ï¼Œè¿˜ä¸ç®—ä»€ä¹ˆã€‚å› æ­¤ï¼Œä¸ºäº†å…¬å¹³å¯¹å¾…åŸ¹è®­å’ŒéªŒè¯æ•°æ®ï¼Œæˆ‘ä»¬å°†é›†åˆåˆ†ä¸ºä¸¤ä¸ªç›¸ç­‰çš„éƒ¨åˆ†-50ï¼…-åŸ¹è®­æ•°æ®å’Œ50ï¼…-éªŒè¯æ•°æ®ã€‚æˆ‘ä»¬å®‰è£…</font></font><code>stratify=y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä»¥ç¡®ä¿è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ä¸åŸå§‹æ•°æ®é›†çš„æ¯”ç‡åˆ†åˆ«ä¸º0å’Œ1ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X = data.drop(<span class="hljs-string">'cancer'</span>, axis=<span class="hljs-number">1</span>)&nbsp;&nbsp;<font></font>
y = data[<span class="hljs-string">'cancer'</span>]&nbsp;<font></font>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.50</span>, random_state = <span class="hljs-number">2020</span>, stratify=y)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.æ•°æ®ç¼©æ”¾</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿›è¡Œå»ºæ¨¡ä¹‹å‰ï¼Œæ‚¨éœ€è¦é€šè¿‡</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼©æ”¾</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®æ¥â€œå±…ä¸­â€å’Œâ€œæ ‡å‡†åŒ–â€æ•°æ®</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç”±äºä¸åŒæ•°é‡ä»¥ä¸åŒå•ä½è¡¨ç¤ºï¼Œå› æ­¤æ‰§è¡Œç¼©æ”¾ã€‚</font><font style="vertical-align: inherit;">é€šè¿‡æ­¤è¿‡ç¨‹ï¼Œæ‚¨å¯ä»¥åœ¨æ ‡ç‰Œä¹‹é—´è¿›è¡Œâ€œå…¬å¹³ç«äº‰â€ä»¥ç¡®å®šå…¶é‡è¦æ€§ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œæˆ‘ä»¬å°†</font></font><code>y_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandasæ•°æ®ç±»å‹</font></font><code>Series</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è½¬æ¢ä¸ºNumPyæ•°ç»„ï¼Œä»¥ä¾¿ä»¥åæ¨¡å‹å¯ä»¥ä¸ç›¸åº”çš„ç›®æ ‡ä¸€èµ·ä½¿ç”¨ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<font></font>
ss = StandardScaler()<font></font>
X_train_scaled = ss.fit_transform(X_train)<font></font>
X_test_scaled = ss.transform(X_test)<font></font>
y_train = np.array(y_train)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.åŸºæœ¬æ¨¡å‹çš„è®­ç»ƒï¼ˆRF 1å·æ¨¡å‹ï¼‰</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨åˆ›å»ºå‹å·1ã€‚</font><font style="vertical-align: inherit;">åœ¨å…¶ä¸­ï¼Œæˆ‘ä»¬è®°å¾—åªæœ‰éšæœºæ£®æ—ç®—æ³•è¢«ä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">å®ƒä½¿ç”¨æ‰€æœ‰åŠŸèƒ½å¹¶ä½¿ç”¨é»˜è®¤å€¼è¿›è¡Œé…ç½®ï¼ˆæœ‰å…³è¿™äº›è®¾ç½®çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚è§sklearn.ensemble.RandomForestClassifier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„æ–‡æ¡£</font><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">åˆå§‹åŒ–æ¨¡å‹ã€‚</font><font style="vertical-align: inherit;">ä¹‹åï¼Œæˆ‘ä»¬å°†å¯¹å¥¹è¿›è¡Œè§„æ¨¡åŒ–æ•°æ®åŸ¹è®­ã€‚</font><font style="vertical-align: inherit;">å¯ä»¥åœ¨è®­ç»ƒæ•°æ®ä¸Šæµ‹é‡æ¨¡å‹çš„å‡†ç¡®æ€§ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> recall_score<font></font>
rfc = RandomForestClassifier()<font></font>
rfc.fit(X_train_scaled, y_train)<font></font>
display(rfc.score(X_train_scaled, y_train))<font></font>
<span class="hljs-comment"># 1.0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“å“ªäº›ç‰¹å¾å¯¹äºRFæ¨¡å‹é¢„æµ‹ä¹³è…ºç™Œæœ€é‡è¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹ä»¥ä¸‹å±æ€§æ¥å¯è§†åŒ–å’Œé‡åŒ–ç‰¹å¾ä¸¥é‡æ€§æŒ‡æ ‡</font></font><code>feature_importances_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="python hljs">feats = {}
<span class="hljs-keyword">for</span> feature, importance <span class="hljs-keyword">in</span> zip(data.columns, rfc_1.feature_importances_):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;feats[feature] = importance<font></font>
importances = pd.DataFrame.from_dict(feats, orient=<span class="hljs-string">'index'</span>).rename(columns={<span class="hljs-number">0</span>: <span class="hljs-string">'Gini-Importance'</span>})<font></font>
importances = importances.sort_values(by=<span class="hljs-string">'Gini-Importance'</span>, ascending=<span class="hljs-literal">False</span>)<font></font>
importances = importances.reset_index()<font></font>
importances = importances.rename(columns={<span class="hljs-string">'index'</span>: <span class="hljs-string">'Features'</span>})<font></font>
sns.set(font_scale = <span class="hljs-number">5</span>)<font></font>
sns.set(style=<span class="hljs-string">"whitegrid"</span>, color_codes=<span class="hljs-literal">True</span>, font_scale = <span class="hljs-number">1.7</span>)<font></font>
fig, ax = plt.subplots()<font></font>
fig.set_size_inches(<span class="hljs-number">30</span>,<span class="hljs-number">15</span>)<font></font>
sns.barplot(x=importances[<span class="hljs-string">'Gini-Importance'</span>], y=importances[<span class="hljs-string">'Features'</span>], data=importances, color=<span class="hljs-string">'skyblue'</span>)<font></font>
plt.xlabel(<span class="hljs-string">'Importance'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
plt.ylabel(<span class="hljs-string">'Features'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
plt.title(<span class="hljs-string">'Feature Importance'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
display(plt.show())<font></font>
display(importances)</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a02/a8f/cd2/a02a8fcd28f87af338f364a70faeca3e.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯è§†åŒ–æ ‡å¿—çš„â€œé‡è¦æ€§â€</font></font></font></i><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/830/176/e1f/830176e1fc9ce63bfedf2d727619253b.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦æ€§æŒ‡æ ‡</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.ä¸»æˆåˆ†æ³•</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œè®©æˆ‘ä»¬é—®ä¸€ä¸‹å¦‚ä½•æ”¹å–„åŸºæœ¬çš„RFæ¨¡å‹ã€‚ä½¿ç”¨å‡å°ç‰¹å¾ç©ºé—´å°ºå¯¸çš„æŠ€æœ¯ï¼Œå¯ä»¥é€šè¿‡è¾ƒå°‘çš„å˜é‡æ˜¾ç¤ºåˆå§‹æ•°æ®é›†ï¼ŒåŒæ—¶å‡å°‘ç¡®ä¿æ¨¡å‹è¿è¡Œæ‰€éœ€çš„è®¡ç®—èµ„æºé‡ã€‚ä½¿ç”¨PCAï¼Œæ‚¨å¯ä»¥ç ”ç©¶è¿™äº›ç‰¹å¾çš„ç´¯ç§¯æ ·æœ¬æ–¹å·®ï¼Œä»¥ä¾¿äº†è§£å“ªäº›ç‰¹å¾å¯ä»¥è§£é‡Šæ•°æ®ä¸­çš„å¤§å¤šæ•°æ–¹å·®ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬åˆå§‹åŒ–PCAï¼ˆ</font></font><code>pca_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">å¯¹è±¡</font><font style="vertical-align: inherit;">ï¼ŒæŒ‡å‡ºéœ€è¦è€ƒè™‘çš„ç»„ä»¶ï¼ˆåŠŸèƒ½ï¼‰æ•°é‡ã€‚æˆ‘ä»¬å°†æ­¤æŒ‡æ ‡è®¾ç½®ä¸º30ï¼Œä»¥ä¾¿åœ¨å†³å®šæ‰€éœ€çš„ç»„ä»¶æ•°é‡ä¹‹å‰æŸ¥çœ‹æ‰€æœ‰ç”Ÿæˆçš„ç»„ä»¶çš„è§£é‡Šæ–¹å·®ã€‚ç„¶åæˆ‘ä»¬è½¬ç§»åˆ°</font></font><code>pca_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¯”ä¾‹æ•°æ®</font></font><code>X_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨æ–¹æ³•</font></font><code>pca_test.fit()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¹‹åï¼Œæˆ‘ä»¬å°†æ•°æ®å¯è§†åŒ–ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA<font></font>
pca_test = PCA(n_components=<span class="hljs-number">30</span>)<font></font>
pca_test.fit(X_train_scaled)<font></font>
sns.set(style=<span class="hljs-string">'whitegrid'</span>)<font></font>
plt.plot(np.cumsum(pca_test.explained_variance_ratio_))<font></font>
plt.xlabel(<span class="hljs-string">'number of components'</span>)<font></font>
plt.ylabel(<span class="hljs-string">'cumulative explained variance'</span>)<font></font>
plt.axvline(linewidth=<span class="hljs-number">4</span>, color=<span class="hljs-string">'r'</span>, linestyle = <span class="hljs-string">'--'</span>, x=<span class="hljs-number">10</span>, ymin=<span class="hljs-number">0</span>, ymax=<span class="hljs-number">1</span>)<font></font>
display(plt.show())<font></font>
evr = pca_test.explained_variance_ratio_<font></font>
cvr = np.cumsum(pca_test.explained_variance_ratio_)<font></font>
pca_df = pd.DataFrame()<font></font>
pca_df[<span class="hljs-string">'Cumulative Variance Ratio'</span>] = cvr<font></font>
pca_df[<span class="hljs-string">'Explained Variance Ratio'</span>] = evr<font></font>
display(pca_df.head(<span class="hljs-number">10</span>))</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6eb/65f/acc/6eb65facc6c8b05f1e910d3b2b676d5e.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ä½¿ç”¨çš„ç»„ä»¶æ•°è¶…è¿‡10åï¼Œç»„ä»¶æ•°çš„å¢åŠ ä¸ä¼šå¤§å¤§å¢åŠ è§£é‡Šçš„æ–¹å·®</font></font></font></i><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f12/e3c/915/f12e3c915d761e1d4623051dac74cd8d.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¥æ•°æ®æ¡†åŒ…å«è¯¸å¦‚ç´¯ç§¯æ–¹å·®æ¯”ï¼ˆæ•°æ®çš„è§£é‡Šæ–¹å·®çš„ç´¯ç§¯å¤§å°ï¼‰å’Œè§£é‡Šæ–¹å·®æ¯”ï¼ˆæ¯ä¸ªæˆåˆ†å¯¹è§£é‡Šæ–¹å·®çš„æ€»ä½“ç§¯çš„è´¡çŒ®ï¼‰ä¹‹ç±»çš„æŒ‡æ ‡</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å¦‚æœæ‚¨æŸ¥çœ‹ä¸Šè¿°æ•°æ®æ¡†ï¼Œå°±ä¼šå‘ç°ä½¿ç”¨PCAä»30ä¸ªå˜é‡è½¬å˜ä¸º10ä¸ªå˜é‡ç»„ä»¶å…è®¸è§£é‡Š95ï¼…çš„æ•°æ®åˆ†æ•£ã€‚å…¶ä»–20ä¸ªç»„ä»¶æ‰€å æ¯”ä¾‹ä¸åˆ°5ï¼…ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ‹’ç»å®ƒä»¬ã€‚æŒ‰ç…§è¿™ä¸€é€»è¾‘ï¼Œæˆ‘ä»¬ç”¨PCAä»30å‡å°‘å…ƒä»¶æ•°é‡ï¼Œä»¥10</font></font><code>X_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>X_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚æˆ‘ä»¬åœ¨ä¸­</font></font><code>X_train_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œä¸­</font><font style="vertical-align: inherit;">å†™å…¥è¿™äº›äººä¸ºåˆ›å»ºçš„â€œé™ç»´â€æ•°æ®é›†</font></font><code>X_test_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs">pca = PCA(n_components=<span class="hljs-number">10</span>)<font></font>
pca.fit(X_train_scaled)<font></font>
X_train_scaled_pca = pca.transform(X_train_scaled)<font></font>
X_test_scaled_pca = pca.transform(X_test_scaled)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¯ä¸ªç»„ä»¶éƒ½æ˜¯æºå˜é‡ä¸ç›¸åº”â€œæƒé‡â€çš„çº¿æ€§ç»„åˆã€‚</font><font style="vertical-align: inherit;">é€šè¿‡åˆ›å»ºæ•°æ®æ¡†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªç»„ä»¶çš„è¿™äº›â€œæƒé‡â€ã€‚</font></font><br>
<br>
<pre><code class="python hljs">pca_dims = []
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(pca_df)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pca_dims.append(<span class="hljs-string">'PCA Component {}'</span>.format(x))<font></font>
pca_test_df = pd.DataFrame(pca_test.components_, columns=columns, index=pca_dims)<font></font>
pca_test_df.head(<span class="hljs-number">10</span>).T</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/086/a28/ae4/086a28ae45e9048811cf813d4868902e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»„ä»¶ä¿¡æ¯æ•°æ®æ¡†</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.åœ¨å¯¹æ•°æ®åº”ç”¨ä¸»æˆåˆ†æ³•ä¹‹åè®­ç»ƒåŸºæœ¬çš„RFæ¨¡å‹ï¼ˆæ¨¡å‹2ï¼ŒRF + PCAï¼‰</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä¼ é€’å¦ä¸€ä¸ªåŸºæœ¬çš„RFæ¨¡å‹æ•°æ®</font></font><code>X_train_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><code>y_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶æ‰¾å‡ºè¯¥æ¨¡å‹å‘å‡ºçš„é¢„æµ‹çš„å‡†ç¡®æ€§æ˜¯å¦æœ‰æ‰€æé«˜ã€‚</font></font><br>
<br>
<pre><code class="python hljs">rfc = RandomForestClassifier()<font></font>
rfc.fit(X_train_scaled_pca, y_train)<font></font>
display(rfc.score(X_train_scaled_pca, y_train))<font></font>
<span class="hljs-comment"># 1.0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‹å·æ¯”è¾ƒå¦‚ä¸‹ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.ä¼˜åŒ–è¶…å‚æ•°ã€‚</font><font style="vertical-align: inherit;">ç¬¬ä¸€è½®ï¼šRandomizedSearchCV</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨ä¸»æˆåˆ†æ–¹æ³•å¤„ç†æ•°æ®åï¼Œå¯ä»¥å°è¯•ä½¿ç”¨</font><font style="vertical-align: inherit;">æ¨¡å‹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¶…å‚æ•°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ä¼˜åŒ–ï¼Œ</font></a><font style="vertical-align: inherit;">ä»¥æé«˜RFæ¨¡å‹äº§ç”Ÿçš„é¢„æµ‹çš„è´¨é‡ã€‚å¯ä»¥å°†è¶…å‚æ•°è§†ä¸ºæ¨¡å‹çš„â€œè®¾ç½®â€ã€‚æœ€é€‚åˆä¸€ä¸ªæ•°æ®é›†çš„è®¾ç½®å°†ä¸é€‚ç”¨äºå¦ä¸€ä¸ªæ•°æ®é›†-è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‚¨éœ€è¦å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥ä»RandomizedSearchCVç®—æ³•å¼€å§‹ï¼Œè¯¥ç®—æ³•ä½¿æ‚¨å¯ä»¥å¤§è‡´æ¢ç´¢å„ç§å€¼ã€‚å¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°æœ‰å…³RFæ¨¡å‹çš„æ‰€æœ‰è¶…å‚æ•°çš„è¯´æ˜</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªå®ä½“</font></font><code>param_dist</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªè¶…å‚æ•°çš„ä¸€ç³»åˆ—éœ€è¦æµ‹è¯•çš„å€¼ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆå§‹åŒ–å¯¹è±¡ã€‚</font></font><code>rs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨å‡½æ•°</font></font><code>RandomizedSearchCV()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå°†å…¶ä¼ é€’ç»™RFæ¨¡å‹</font></font><code>param_dist</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè¿­ä»£æ¬¡æ•°å’Œ</font><font style="vertical-align: inherit;">éœ€è¦æ‰§è¡Œ</font><font style="vertical-align: inherit;">çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº¤å‰éªŒè¯</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¬¡æ•°</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¶…å‚æ•°</font></font><code>verbose</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿æ‚¨å¯ä»¥æ§åˆ¶æ¨¡å‹åœ¨å…¶æ“ä½œæœŸé—´æ˜¾ç¤ºçš„ä¿¡æ¯é‡ï¼ˆä¾‹å¦‚åœ¨æ¨¡å‹è®­ç»ƒæœŸé—´çš„ä¿¡æ¯è¾“å‡ºï¼‰ã€‚</font><font style="vertical-align: inherit;">è¶…å‚æ•°</font></font><code>n_jobs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…è®¸æ‚¨æŒ‡å®šéœ€è¦ä½¿ç”¨å¤šå°‘ä¸ªå¤„ç†å™¨æ ¸å¿ƒä»¥ç¡®ä¿æ¨¡å‹æ­£å¸¸å·¥ä½œã€‚</font><font style="vertical-align: inherit;">å°†å…¶è®¾ç½®</font></font><code>n_jobs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºå€¼</font></font><code>-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†å¯¼è‡´æ›´å¿«çš„æ¨¡å‹ï¼Œå› ä¸ºå®ƒå°†ä½¿ç”¨æ‰€æœ‰å¤„ç†å™¨å†…æ ¸ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ä»äº‹ä»¥ä¸‹è¶…å‚æ•°çš„é€‰æ‹©ï¼š</font></font><br>
<br>
<ul>
<li><code>n_estimators</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -â€œéšæœºæ£®æ—â€ä¸­â€œæ ‘â€çš„æ•°é‡ã€‚</font></font></li>
<li><code>max_features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -é€‰æ‹©åˆ†å‰²çš„ç‰¹å¾æ•°é‡ã€‚</font></font></li>
<li><code>max_depth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æ ‘æœ¨çš„æœ€å¤§æ·±åº¦ã€‚</font></font></li>
<li><code>min_samples_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æ ‘èŠ‚ç‚¹åˆ†è£‚æ‰€éœ€çš„æœ€å°‘å¯¹è±¡æ•°ã€‚</font></font></li>
<li><code>min_samples_leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -å¶å­ä¸­çš„æœ€å°å¯¹è±¡æ•°ã€‚</font></font></li>
<li><code>bootstrap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ç”¨äºæ„é€ å¸¦æœ‰è¿”å›çš„å­æ ·æœ¬æ ‘ã€‚</font></font></li>
</ul><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> RandomizedSearchCV<font></font>
n_estimators = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">100</span>, stop = <span class="hljs-number">1000</span>, num = <span class="hljs-number">10</span>)]<font></font>
max_features = [<span class="hljs-string">'log2'</span>, <span class="hljs-string">'sqrt'</span>]<font></font>
max_depth = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">1</span>, stop = <span class="hljs-number">15</span>, num = <span class="hljs-number">15</span>)]<font></font>
min_samples_split = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">2</span>, stop = <span class="hljs-number">50</span>, num = <span class="hljs-number">10</span>)]<font></font>
min_samples_leaf = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">2</span>, stop = <span class="hljs-number">50</span>, num = <span class="hljs-number">10</span>)]<font></font>
bootstrap = [<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>]<font></font>
param_dist = {<span class="hljs-string">'n_estimators'</span>: n_estimators,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_features'</span>: max_features,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_depth'</span>: max_depth,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_split'</span>: min_samples_split,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_leaf'</span>: min_samples_leaf,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'bootstrap'</span>: bootstrap}<font></font>
rs = RandomizedSearchCV(rfc_2,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param_dist,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_iter = <span class="hljs-number">100</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv = <span class="hljs-number">3</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verbose = <span class="hljs-number">1</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs=<span class="hljs-number">-1</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state=<span class="hljs-number">0</span>)<font></font>
rs.fit(X_train_scaled_pca, y_train)<font></font>
rs.best_params_<font></font>
<span class="hljs-comment"># {'n_estimators': 700,</span>
<span class="hljs-comment"># 'min_samples_split': 2,</span>
<span class="hljs-comment"># 'min_samples_leaf': 2,</span>
<span class="hljs-comment"># 'max_features': 'log2',</span>
<span class="hljs-comment"># 'max_depth': 11,</span>
<span class="hljs-comment"># 'bootstrap': True}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ©ç”¨å‚æ•°</font></font><code>n_iter = 100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font><font style="vertical-align: inherit;">çš„å€¼</font></font><code>cv = 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæˆ‘ä»¬åˆ›å»ºäº†300ä¸ªRFæ¨¡å‹ï¼Œéšæœºé€‰æ‹©ä¸Šè¿°è¶…çº§</font><font style="vertical-align: inherit;">å‚æ•°çš„</font><font style="vertical-align: inherit;">ç»„åˆã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¯ä»¥å‚è€ƒè¯¥å±æ€§</font></font><code>best_params_ </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥è·å–æœ‰å…³ä¸€ç»„å‚æ•°çš„ä¿¡æ¯ï¼Œè¿™äº›å‚æ•°ä½¿æ‚¨å¯ä»¥åˆ›å»ºæœ€ä½³æ¨¡å‹ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯åœ¨ç°é˜¶æ®µï¼Œè¿™å¯èƒ½æ— æ³•ä¸ºæˆ‘ä»¬æä¾›å…³äºå‚æ•°èŒƒå›´çš„æœ€æœ‰è¶£çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®å€¼å¾—åœ¨ä¸‹ä¸€è½®ä¼˜åŒ–ä¸­æ¢ç´¢ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†æ‰¾å‡ºå€¼å¾—ç»§ç»­æœç´¢çš„å€¼èŒƒå›´ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°è·å¾—ä¸€ä¸ªåŒ…å«RandomizedSearchCVç®—æ³•ç»“æœçš„æ•°æ®æ¡†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">rs_df = pd.DataFrame(rs.cv_results_).sort_values(<span class="hljs-string">'rank_test_score'</span>).reset_index(drop=<span class="hljs-literal">True</span>)<font></font>
rs_df = rs_df.drop([<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'mean_fit_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_fit_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'mean_score_time'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_score_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'params'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split0_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split1_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split2_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_test_score'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axis=<span class="hljs-number">1</span>)<font></font>
rs_df.head(<span class="hljs-number">10</span>)</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/617/b8c/20b/617b8c20b787acc3c76c23d9235b4b5a.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RandomizedSearchCVç®—æ³•çš„ç»“æœ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ç°åœ¨æˆ‘ä»¬å°†åˆ›å»ºæ¡å½¢å›¾ï¼Œåœ¨è¯¥æ¡å½¢å›¾çš„Xè½´ä¸Šæ˜¯è¶…å‚æ•°å€¼ï¼ŒYè½´ä¸Šæ˜¯æ¨¡å‹æ˜¾ç¤ºçš„å¹³å‡å€¼ã€‚</font><font style="vertical-align: inherit;">è¿™å°†ä½¿æ‚¨æœ‰å¯èƒ½äº†è§£å¹³å‡è€Œè¨€ï¼Œè¶…å‚æ•°çš„å“ªäº›å€¼æ˜¾ç¤ºå‡ºæœ€ä½³æ€§èƒ½ã€‚</font></font><br>
<br>
<pre><code class="python hljs">fig, axs = plt.subplots(ncols=<span class="hljs-number">3</span>, nrows=<span class="hljs-number">2</span>)<font></font>
sns.set(style=<span class="hljs-string">"whitegrid"</span>, color_codes=<span class="hljs-literal">True</span>, font_scale = <span class="hljs-number">2</span>)<font></font>
fig.set_size_inches(<span class="hljs-number">30</span>,<span class="hljs-number">25</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_n_estimators'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>], color=<span class="hljs-string">'lightgrey'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>].set_ylim([<span class="hljs-number">.83</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>].set_title(label = <span class="hljs-string">'n_estimators'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_min_samples_split'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>], color=<span class="hljs-string">'coral'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>].set_ylim([<span class="hljs-number">.85</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>].set_title(label = <span class="hljs-string">'min_samples_split'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_min_samples_leaf'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>], color=<span class="hljs-string">'lightgreen'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>].set_ylim([<span class="hljs-number">.80</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>].set_title(label = <span class="hljs-string">'min_samples_leaf'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_max_features'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>], color=<span class="hljs-string">'wheat'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>].set_ylim([<span class="hljs-number">.88</span>,<span class="hljs-number">.92</span>])axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>].set_title(label = <span class="hljs-string">'max_features'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_max_depth'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>], color=<span class="hljs-string">'lightpink'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>].set_ylim([<span class="hljs-number">.80</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>].set_title(label = <span class="hljs-string">'max_depth'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_bootstrap'</span>,y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], color=<span class="hljs-string">'skyblue'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>].set_ylim([<span class="hljs-number">.88</span>,<span class="hljs-number">.92</span>])<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>].set_title(label = <span class="hljs-string">'bootstrap'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
plt.show()</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/418/311/ba6/418311ba6c38bfcebbf152af810d6b58.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æè¶…å‚æ•°çš„å€¼</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å¦‚æœæˆ‘ä»¬åˆ†æä¸Šè¿°å›¾è¡¨ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼Œå®ƒä»¬è°ˆè®ºå¹³å‡è€Œè¨€ï¼Œè¶…å‚æ•°çš„æ¯ä¸ªå€¼å¦‚ä½•å½±å“æ¨¡å‹ã€‚</font></font><br>
<br>
<ul>
<li><code>n_estimators</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šæ˜¾ç„¶ï¼Œ300ã€500ã€700çš„å€¼æ˜¾ç¤ºå‡ºæœ€ä½³çš„å¹³å‡ç»“æœã€‚</font></font></li>
<li><code>min_samples_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šåƒ2å’Œ7è¿™æ ·çš„å°å€¼ä¼¼ä¹æ˜¾ç¤ºå‡ºæœ€å¥½çš„ç»“æœã€‚</font><font style="vertical-align: inherit;">å€¼23çœ‹èµ·æ¥ä¹Ÿä¸é”™ã€‚æ‚¨å¯ä»¥æ£€æŸ¥æ­¤è¶…å‚æ•°è¶…è¿‡2çš„å‡ ä¸ªå€¼ï¼Œä»¥åŠçº¦23çš„å‡ ä¸ªå€¼ã€‚</font></font></li>
<li><code>min_samples_leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šæ„Ÿè§‰è¿™ä¸ªè¶…å‚æ•°çš„è¾ƒå°å€¼ä¼šç»™å‡ºæ›´å¥½çš„ç»“æœã€‚</font><font style="vertical-align: inherit;">è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½“éªŒ2åˆ°7ä¹‹é—´çš„å€¼ã€‚</font></font></li>
<li><code>max_features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šé€‰é¡¹</font></font><code>sqrt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»™å‡ºæœ€é«˜çš„å¹³å‡ç»“æœã€‚</font></font></li>
<li><code>max_depth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šè¶…å‚æ•°çš„å€¼ä¸æ¨¡å‹çš„ç»“æœä¹‹é—´æ²¡æœ‰æ˜ç¡®çš„å…³ç³»ï¼Œä½†æ˜¯æœ‰ä¸€ç§æ„Ÿè§‰ï¼Œå€¼2ã€3ã€7ã€11ã€15çœ‹èµ·æ¥ä¸é”™ã€‚</font></font></li>
<li><code>bootstrap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šè¯¥å€¼</font></font><code>False</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¾ç¤ºæœ€ä½³çš„å¹³å‡ç»“æœã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œä½¿ç”¨è¿™äº›å‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­è¿›è¡Œç¬¬äºŒè½®è¶…å‚æ•°ä¼˜åŒ–ã€‚</font><font style="vertical-align: inherit;">è¿™å°†ç¼©å°æˆ‘ä»¬æ„Ÿå…´è¶£çš„ä»·å€¼èŒƒå›´ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.ä¼˜åŒ–è¶…å‚æ•°ã€‚</font><font style="vertical-align: inherit;">ç¬¬2è½®ï¼šGridSearchCVï¼ˆæ¨¡å‹3çš„å‚æ•°çš„æœ€ç»ˆå‡†å¤‡ï¼ŒRF + PCA + HTï¼‰</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åº”ç”¨RandomizedSearchCVç®—æ³•åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨GridSearchCVç®—æ³•å¯¹è¶…å‚æ•°çš„æœ€ä½³ç»„åˆè¿›è¡Œæ›´ç²¾ç¡®çš„æœç´¢ã€‚è¿™é‡Œç ”ç©¶äº†ç›¸åŒçš„è¶…å‚æ•°ï¼Œä½†ç°åœ¨æˆ‘ä»¬æ­£åœ¨å¯¹å…¶è¿›è¡Œæ›´å¥½çš„â€œå½»åº•â€æœç´¢ã€‚ä½¿ç”¨GridSearchCVç®—æ³•ï¼Œæ£€æŸ¥è¶…å‚æ•°çš„æ¯ç§ç»„åˆã€‚å½“æˆ‘ä»¬ç‹¬ç«‹è®¾ç½®æœç´¢è¿­ä»£æ¬¡æ•°æ—¶ï¼Œè¿™æ¯”ä½¿ç”¨RandomizedSearchCVç®—æ³•éœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æºã€‚ä¾‹å¦‚ï¼Œä¸º3ä¸ªå—ä¸­çš„äº¤å‰éªŒè¯ä¸º6ä¸ªè¶…å‚æ•°ä¸­çš„æ¯ä¸€ä¸ªç ”ç©¶10ä¸ªå€¼å°†éœ€è¦10 x 3æˆ–300ä¸‡ä¸ªæ¨¡å‹è®­ç»ƒè¯¾ç¨‹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨åº”ç”¨RandomizedSearchCVä¹‹åç¼©å°ç ”ç©¶å‚æ•°çš„å–å€¼èŒƒå›´ä¹‹åä½¿ç”¨GridSearchCVç®—æ³•çš„åŸå› ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œä½¿ç”¨æˆ‘ä»¬åœ¨RandomizedSearchCVçš„å¸®åŠ©ä¸‹å‘ç°çš„å†…å®¹ï¼Œæˆ‘ä»¬æ£€æŸ¥äº†è¡¨ç°å‡ºæœ€ä½³çŠ¶æ€çš„è¶…å‚æ•°çš„å€¼ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV<font></font>
n_estimators = [<span class="hljs-number">300</span>,<span class="hljs-number">500</span>,<span class="hljs-number">700</span>]<font></font>
max_features = [<span class="hljs-string">'sqrt'</span>]<font></font>
max_depth = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>]<font></font>
min_samples_split = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">24</span>]<font></font>
min_samples_leaf = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>]<font></font>
bootstrap = [<span class="hljs-literal">False</span>]<font></font>
param_grid = {<span class="hljs-string">'n_estimators'</span>: n_estimators,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_features'</span>: max_features,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_depth'</span>: max_depth,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_split'</span>: min_samples_split,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_leaf'</span>: min_samples_leaf,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'bootstrap'</span>: bootstrap}<font></font>
gs = GridSearchCV(rfc_2, param_grid, cv = <span class="hljs-number">3</span>, verbose = <span class="hljs-number">1</span>, n_jobs=<span class="hljs-number">-1</span>)<font></font>
gs.fit(X_train_scaled_pca, y_train)<font></font>
rfc_3 = gs.best_estimator_<font></font>
gs.best_params_<font></font>
<span class="hljs-comment"># {'bootstrap': False,</span>
<span class="hljs-comment"># 'max_depth': 7,</span>
<span class="hljs-comment"># 'max_features': 'sqrt',</span>
<span class="hljs-comment"># 'min_samples_leaf': 3,</span>
<span class="hljs-comment"># 'min_samples_split': 2,</span>
<span class="hljs-comment"># 'n_estimators': 500}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é’ˆå¯¹540ï¼ˆ3 x 1 x 5 x 6 x 6 x 1ï¼‰ä¸ªæ¨¡å‹è®­ç»ƒè¯¾ç¨‹åœ¨3ä¸ªå—ä¸­åº”ç”¨äº¤å‰éªŒè¯ï¼Œè¿™æä¾›äº†1620ä¸ªæ¨¡å‹è®­ç»ƒè¯¾ç¨‹ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨RandomizedSearchCVå’ŒGridSearchCVä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è½¬åˆ°å±æ€§</font></font><code>best_params_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥æ‰¾å‡ºå“ªäº›è¶…å‚æ•°å€¼å¯ä»¥ä½¿æ¨¡å‹ä¸æ­£åœ¨ç ”ç©¶çš„æ•°æ®é›†æœ€ä½³é…åˆä½¿ç”¨ï¼ˆè¿™äº›å€¼å¯ä»¥åœ¨ä¸Šä¸€ä¸ªä»£ç å—çš„åº•éƒ¨çœ‹åˆ°ï¼‰ ã€‚</font><font style="vertical-align: inherit;">è¿™äº›å‚æ•°ç”¨äºåˆ›å»ºå‹å·3ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.æ ¹æ®éªŒè¯æ•°æ®è¯„ä¼°æ¨¡å‹çš„è´¨é‡</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å¯ä»¥æ ¹æ®éªŒè¯æ•°æ®è¯„ä¼°åˆ›å»ºçš„æ¨¡å‹ã€‚</font><font style="vertical-align: inherit;">å³ï¼Œæˆ‘ä»¬æ­£åœ¨è°ˆè®ºææ–™å¼€å§‹æ—¶æè¿°çš„è¿™ä¸‰ä¸ªæ¨¡å‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æŸ¥çœ‹ä»¥ä¸‹æ¨¡å‹ï¼š</font></font><br>
<br>
<pre><code class="python hljs">y_pred = rfc.predict(X_test_scaled)<font></font>
y_pred_pca = rfc.predict(X_test_scaled_pca)<font></font>
y_pred_gs = gs.best_estimator_.predict(X_test_scaled_pca)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºæ¨¡å‹åˆ›å»ºè¯¯å·®çŸ©é˜µï¼Œå¹¶æ‰¾å‡ºæ¯ä¸ªæ¨¡å‹å¯¹ä¹³è…ºç™Œçš„é¢„æµ‹èƒ½åŠ›ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix<font></font>
conf_matrix_baseline = pd.DataFrame(confusion_matrix(y_test, y_pred), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
conf_matrix_baseline_pca = pd.DataFrame(confusion_matrix(y_test, y_pred_pca), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
conf_matrix_tuned_pca = pd.DataFrame(confusion_matrix(y_test, y_pred_gs), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
display(conf_matrix_baseline)<font></font>
display(<span class="hljs-string">'Baseline Random Forest recall score'</span>, recall_score(y_test, y_pred))<font></font>
display(conf_matrix_baseline_pca)<font></font>
display(<span class="hljs-string">'Baseline Random Forest With PCA recall score'</span>, recall_score(y_test, y_pred_pca))<font></font>
display(conf_matrix_tuned_pca)<font></font>
display(<span class="hljs-string">'Hyperparameter Tuned Random Forest With PCA Reduced Dimensionality recall score'</span>, recall_score(y_test, y_pred_gs))</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f48/a9e/92f/f48a9e92fd5fdca613d6073e00bae2c6.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‰ç§æ¨¡å‹çš„å·¥ä½œç»“æœåœ¨æ­¤</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
è¯„ä¼°åº¦é‡â€œå®Œæ•´æ€§â€ï¼ˆå¬å›ï¼‰ã€‚</font><font style="vertical-align: inherit;">äº‹å®æ˜¯æˆ‘ä»¬æ­£åœ¨è¯Šæ–­ç™Œç—‡ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»¬å¯¹æœ€å°åŒ–æ¨¡å‹å‘å¸ƒçš„å‡é˜´æ€§é¢„æµ‹éå¸¸æ„Ÿå…´è¶£ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‰´äºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼ŒåŸºæœ¬RFæ¨¡å‹ç»™å‡ºäº†æœ€ä½³ç»“æœã€‚</font><font style="vertical-align: inherit;">å®Œæ•´ç‡è¾¾94.97ï¼…ã€‚</font><font style="vertical-align: inherit;">åœ¨æµ‹è¯•æ•°æ®é›†ä¸­ï¼Œæœ‰179åç™Œç—‡æ‚£è€…çš„è®°å½•ã€‚</font><font style="vertical-align: inherit;">è¯¥æ¨¡å‹æ‰¾åˆ°äº†å…¶ä¸­çš„170ä¸ªã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‘˜è¦</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é¡¹ç ”ç©¶æä¾›äº†é‡è¦çš„è§‚å¯Ÿã€‚</font><font style="vertical-align: inherit;">æœ‰æ—¶ï¼Œä½¿ç”¨ä¸»æˆåˆ†æ–¹æ³•å’Œè¶…å‚æ•°çš„å¤§è§„æ¨¡ä¼˜åŒ–çš„RFæ¨¡å‹å¯èƒ½æ— æ³•åƒæ ‡å‡†è®¾ç½®çš„æœ€æ™®é€šæ¨¡å‹é‚£æ ·å·¥ä½œã€‚</font><font style="vertical-align: inherit;">ä½†è¿™ä¸æ˜¯å°†è‡ªå·±ä»…é™äºæœ€ç®€å•çš„æ¨¡å‹çš„åŸå› ã€‚</font><font style="vertical-align: inherit;">å¦‚æœä¸å°è¯•ä¸åŒçš„æ¨¡å‹ï¼Œå°±ä¸å¯èƒ½è¯´å“ªä¸ªæ¨¡å‹å°†æ˜¾ç¤ºæœ€ä½³ç»“æœã€‚</font><font style="vertical-align: inherit;">åœ¨ç”¨äºé¢„æµ‹æ‚£è€…ç™Œç—‡å­˜åœ¨çš„æ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¯´æ¨¡å‹è¶Šå¥½-å¯ä»¥æŒ½æ•‘æ›´å¤šçš„ç”Ÿå‘½ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº²çˆ±çš„è¯»è€…ä»¬ï¼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨ä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•è§£å†³äº†å“ªäº›ä»»åŠ¡ï¼Ÿ</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN488330/index.html">ä¸ä¹”æ²»Â·å¡æ—ï¼ˆGeorge Karlinï¼‰çš„è‹±è¯­ï¼šæˆ‘ä»¬åˆ†æäº†æœ‰å…³è¯ç»„å­¦çš„å·§å¦™è¡¨è¿°</a></li>
<li><a href="../zh-CN488332/index.html">é›¶ï¼Œä¸€ï¼ŒäºŒï¼Œå¼—é›·è¿ªä¼šæ¥ä½ </a></li>
<li><a href="../zh-CN488336/index.html">ä½¿ç”¨æ³¢å‡½æ•°æŠ˜å ç®—æ³•çš„æç¤º</a></li>
<li><a href="../zh-CN488338/index.html">Googleå®ä¹ æœºä¼šï¼šè‹é»ä¸–ï¼Œä¼¦æ•¦å’Œç¡…è°·</a></li>
<li><a href="../zh-CN488340/index.html">èŒä¸šï¼šåç«¯å¼€å‘äººå‘˜</a></li>
<li><a href="../zh-CN488346/index.html">åœ¨Linuxä¸Šçš„Python 3.7è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨SCIPå’ŒGLPKå®‰è£…æˆ–å·¥å…·</a></li>
<li><a href="../zh-CN488348/index.html">ç½‘ç»œç ”è®¨ä¼šâ€œåå¤§æ•æ·æŒ‘æˆ˜å’Œåœ¨ä¸€å°æ—¶å†…å…‹æœæŒ‘æˆ˜çš„æ–¹å¼â€ï¼Œ2æœˆ17æ—¥ï¼Œè«æ–¯ç§‘æ—¶é—´</a></li>
<li><a href="../zh-CN488352/index.html">VDIæˆæœ¬æ¯”è¾ƒï¼šå†…éƒ¨éƒ¨ç½²ä¸å…¬å…±äº‘</a></li>
<li><a href="../zh-CN488356/index.html">åœ¨åœ£å½¼å¾—å ¡å›½ç«‹æµ·æ´‹æŠ€æœ¯å¤§å­¦æ¥å—DassaultSystÃ¨mesäº§å“åŸ¹è®­</a></li>
<li><a href="../zh-CN488360/index.html">å¤§æ•°æ®ç¥è¯ä¸æ•°å­—æ–‡åŒ–</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>