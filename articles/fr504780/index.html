<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📸 🚑 🌠 NSA, Ghidra et licornes 🚴🏼 📗 🔫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cette fois, les yeux de l'équipe PVS-Studio ont été attirés par Ghidra, un cadre large et diabolique pour la rétro-ingénierie avec lequel vous pouvez ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>NSA, Ghidra et licornes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/504780/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/zb/b9/po/zbb9pocjsbhx8woze4xo8picks0.png" alt="NSA, Ghidra et licornes"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette fois, les yeux de l'équipe PVS-Studio ont été attirés par Ghidra, un cadre large et diabolique pour la rétro-ingénierie avec lequel vous pouvez analyser divers fichiers binaires et faire toutes sortes de choses effrayantes avec eux. </font><font style="vertical-align: inherit;">La chose la plus intéressante à ce sujet n'est pas qu'il est libre d'utiliser ou s'étend bien avec les plugins, mais qu'ils l'ont écrit dans la NSA et ont publié la source sur GitHub pour tout le monde. </font><font style="vertical-align: inherit;">D'une part, la NSA semble disposer de suffisamment de ressources pour maintenir la base de code propre. </font><font style="vertical-align: inherit;">Et d'autre part, de nouveaux contributeurs qui ne le connaissaient pas très bien auraient pu accidentellement ajouter des bogues non détectés récemment. </font><font style="vertical-align: inherit;">Par conséquent, armés d'une analyse statique, nous avons décidé de rechercher des faiblesses dans ce projet.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prélude</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au total, l'analyseur statique PVS-Studio a émis 651 avertissements élevés, 904 moyens et 909 faibles dans la partie Java du projet Ghidra ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version 9.1.2, commit 687ce7f</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Parmi eux, environ la moitié des réponses hautes et moyennes ont été déclenchées par le diagnostic </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6022</font></a><font style="vertical-align: inherit;"> .</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le paramètre n'est pas utilisé à l'intérieur du corps de la méthode ", qui apparaît généralement après refactorisation, lorsqu'un paramètre n'était plus nécessaire ou qu'une fonctionnalité était temporairement désactivée par des commentaires. Un aperçu rapide de ces avertissements (il y en a trop pour les afficher chacun en tant qu'observateur externe ) dans ce projet n'a révélé aucun élément manifestement suspect. Il est probablement autorisé pour ce projet de désactiver temporairement ce diagnostic dans les paramètres de l'analyseur afin de ne pas être distrait par celui-ci. En pratique, vous pouvez souvent voir des fautes de frappe au nom du paramètre setter ou constructeur et, d'une manière générale, Je suis sûr que la plupart des lecteurs rencontrent au moins une fois un schéma désagréable similaire:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>{
  <span class="hljs-keyword">private</span> String value;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">A</span><span class="hljs-params">(String val)</span> </span>{ <span class="hljs-comment">// V6022</span>
    <span class="hljs-keyword">this</span>.value = value;<font></font>
  }<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> value.hashCode(); <span class="hljs-comment">// NullPointerException</span><font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus de la moitié des avertissements faibles ont été émis par le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diagnostic</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Déréférence</font></a><font style="vertical-align: inherit;"> potentielle nulle </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6008</font></a><font style="vertical-align: inherit;"> de" variable "- par exemple, la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File.getParentFile () est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> souvent utilisée </font><font style="vertical-align: inherit;">sans vérifier la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si l'objet fichier sur lequel cette méthode a été appelée a été construit sans chemin absolu, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera renvoyé </font><font style="vertical-align: inherit;">et l'absence de vérification risque de supprimer l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par tradition, nous n'analyserons que les avertissements de niveaux élevés et moyens, car la majeure partie des erreurs réelles y sont contenues. Lorsque vous travaillez avec des rapports d'analyseur, nous recommandons toujours d'analyser les avertissements par ordre décroissant de leur fiabilité.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous considérons quelques fragments indiqués par l'analyseur qui me paraissent suspects ou intéressants. </font><font style="vertical-align: inherit;">La base de code du projet s'est avérée être d'une taille impressionnante, et il est presque impossible de trouver de tels endroits manuellement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 1: validation interrompue</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">parseDataTypeTextEntry</span><span class="hljs-params">()</span>
<span class="hljs-keyword">throws</span> InvalidDataTypeException </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">try</span> {<font></font>
    newDataType = parser.parse(selectionField.getText(),<font></font>
                               getDataTypeRootForCurrentText());<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (CancelledException e) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (newDataType != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">if</span> (maxSize &gt;= <span class="hljs-number">0</span>
        &amp;&amp; newDataType.getLength() &gt; newDataType.getLength()) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidDataTypeException(<span class="hljs-string">"data-type larger than "</span>
                                         + maxSize + <span class="hljs-string">" bytes"</span>);<font></font>
    }<font></font>
    selectionField.setSelectedValue(newDataType);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe des sous-expressions identiques 'newDataType.getLength ()' à gauche et à droite de l'opérateur '&gt;'. DataTypeSelectionEditor.java data66 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette classe fournit un composant graphique pour sélectionner un type de données qui prend en charge la </font><font style="vertical-align: inherit;">saisie semi </font><font style="vertical-align: inherit;">-automatique. Le développeur utilisant ce composant peut définir la taille maximale autorisée du type de données sélectionné (via le champ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ou la rendre illimitée en définissant une valeur négative. Il a été supposé que lors de la validation des données entrées, le dépassement de la limite lève une exception, qui est alors rattrapée dans la pile d'appels et l'utilisateur reçoit un message.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semble que l'auteur du composant ait été distrait au moment de la rédaction de ce test, ou peut-être qu'il ait pensé au sens de la vie, mais au final, la validation n'est tout simplement pas effectuée, car le nombre ne peut jamais être plus grand que lui-même et, en conséquence, nous obtenons d'ignorer cette condition. Cela signifie que ce composant peut fournir des données non valides. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre erreur similaire a été trouvée dans deux autres classes: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GuidUtil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewGuid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GuidUtil</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GuidInfo <span class="hljs-title">parseLine</span><span class="hljs-params">(...)</span> </span>{<font></font>
    ...<font></font>
    <span class="hljs-keyword">long</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">long</span>[<span class="hljs-number">4</span>];<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (isOK(data)) {
      <span class="hljs-keyword">if</span> (!hasVersion) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GuidInfo(guidString, name, guidType);<font></font>
      }<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VersionedGuidInfo(guidString, version, name, guidType);<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
  }<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
      <span class="hljs-keyword">if</span> ((data[i] != <span class="hljs-number">0</span>) || (data[i] != <span class="hljs-number">0xFFFFFFFFL</span>)) { <span class="hljs-comment">// &lt;=</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: l' </font><font style="vertical-align: inherit;">expression </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6007</font></a><font style="vertical-align: inherit;"> 'données [i]! = 0xFFFFFFFFL' est toujours vraie. GuidUtil.java:200 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La boucle </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><font style="vertical-align: inherit;">la méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vérifie que la même valeur n'est pas égale à deux nombres différents en même temps. Si tel est le cas, le GUID est immédiatement reconnu comme valide. Autrement dit, le GUID sera invalide uniquement si le tableau de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">données</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">vide, et cela ne se produit jamais, car la valeur de la variable correspondante n'est affectée qu'une seule fois - au début de la méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parseLine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Corps de la</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans les deux classes, cela coïncide complètement, ce qui suggère l'idée d'un autre copier-coller de code incorrect. </font><font style="vertical-align: inherit;">Ce que l'auteur voulait exactement vérifier, je ne suis pas sûr, mais je peux supposer que cette méthode devrait être corrigée comme suit:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">if</span> ((data[i] == <span class="hljs-number">0</span>) || (data[i] == <span class="hljs-number">0xFFFFFFFFL</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 2: masquer les exceptions</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">putByte</span><span class="hljs-params">(<span class="hljs-keyword">long</span> offsetInMemBlock, <span class="hljs-keyword">byte</span> b)</span>
<span class="hljs-keyword">throws</span> MemoryAccessException, IOException </span>{
  <span class="hljs-keyword">long</span> offsetInSubBlock = offsetInMemBlock - subBlockOffset;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (ioPending) {
      <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"Cyclic Access"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
    }<font></font>
    ioPending = <span class="hljs-keyword">true</span>;<font></font>
    doPutByte(mappedAddress.addNoWrap(offsetInSubBlock / <span class="hljs-number">8</span>),<font></font>
              (<span class="hljs-keyword">int</span>) (offsetInSubBlock % <span class="hljs-number">8</span>), b);<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (AddressOverflowException e) {
    <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"No memory at address"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span> {<font></font>
    ioPending = <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6006</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L'objet a été créé mais il n'est pas utilisé. Le mot clé 'throw' peut être manquant: 'new MemoryAccessException ("Cyclic Access")'. BitMappedSubMemoryBlock.java:99 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les objets d'exception eux-mêmes, comme vous le savez, ne font rien (ou du moins ne devraient rien faire). Presque toujours, leurs nouvelles instances sont jetées par </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans de rares cas - transférées quelque part ou placées dans une collection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La classe contenant cette méthode est un wrapper sur un bloc de mémoire qui permet de lire et d'écrire des données. Ici, en raison du fait que les exceptions ne sont pas levées, la restriction imposée d'accès au bloc de mémoire actuel avec l'indicateur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioPending peut être violée</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et, en outre, une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception AddressOverflowException est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ignorée </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ainsi, les données peuvent être silencieusement corrompues et au lieu d'indiquer explicitement une erreur à un endroit particulier, le développeur recevra des artefacts étranges qui doivent être analysés par le débogueur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y avait huit de ces exceptions perdues:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BitMappedSubMemoryBlock.java: lignes 77, 99, 106, 122</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ByteMappedSubMemoryBlock.java: lignes 52, 73, 92, 114</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est caractéristique que dans les mêmes fichiers, il existe des méthodes extrêmement similaires dans lesquelles la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projection est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> présente. </font><font style="vertical-align: inherit;">Très probablement, une méthode a été écrite à l'origine de la même manière que le fragment ci-dessus, après quoi elle a été copiée plusieurs fois, a en quelque sorte trouvé une erreur et l'a corrigée dans les endroits dont ils pouvaient se souvenir.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 3: champ de mines</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processSelection</span><span class="hljs-params">(OptionsTreeNode selectedNode)</span> </span>{
  <span class="hljs-keyword">if</span> (selectedNode == <span class="hljs-keyword">null</span>) {<font></font>
    setViewPanel(defaultPanel, selectedNode); <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setViewPanel</span><span class="hljs-params">(JComponent component, OptionsTreeNode selectedNode)</span> </span>{<font></font>
  ...<font></font>
  setHelpLocation(component, selectedNode);<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHelpLocation</span><span class="hljs-params">(JComponent component, OptionsTreeNode node)</span> </span>{<font></font>
  Options options = node.getOptions();<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6008 Déréférence</font></a><font style="vertical-align: inherit;"> nulle de 'selectedNode' dans la fonction 'setViewPanel'. OptionsPanel.java:266 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'analyseur a menti un peu - pour le moment, appeler la méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection ne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conduit pas à une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car cette méthode n'est appelée que deux fois et avant d'être appelée, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> explicitement vérifié pour </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cela ne doit pas être fait, car un autre développeur peut voir que la méthode gère explicitement le cas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et décider qu'il s'agit d'une valeur valide, ce qui entraînera le blocage de l'application. De telles surprises sont particulièrement dangereuses uniquement dans les projets ouverts, car des personnes qui ne connaissent pas complètement la base de code y participent.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En général, je dois dire que toute la méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semble plutôt étrange. </font><font style="vertical-align: inherit;">Il est probable qu'il s'agit d'une erreur de copier-coller, car dans la même méthode, un bloc if avec le même corps est rencontré deux fois de plus, bien qu'avec des conditions différentes. </font><font style="vertical-align: inherit;">Cependant, à ce stade, le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne </font><i><font style="vertical-align: inherit;">sera</font></i><font style="vertical-align: inherit;"> plus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et la chaîne d'appel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setViewPanel-setHelpLocation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'entraînera pas d' </font><i><font style="vertical-align: inherit;">exception </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 4: auto-complétion pour le mal</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] UNSUPPORTED_OPCODES_LIST = { ... };
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;Integer&gt; UNSUPPORTED_OPCODES = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();<font></font>
<font></font>
<span class="hljs-keyword">static</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> opcode : UNSUPPORTED_OPCODES) {<font></font>
    UNSUPPORTED_OPCODES.add(opcode);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6053</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La collection est modifiée pendant que l'itération est en cours. ConcurrentModificationException peut se produire. DWARFExpressionOpCodes.java:205 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, l'analyseur a de nouveau menti un peu - l'exception ne sera pas levée, car la collection </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNSUPPORTED_OPCODES est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toujours vide et la boucle ne s'exécutera tout simplement pas. De plus, il se trouve que la collection est une multitude, et l'ajout d'un élément déjà présent ne le changera pas. Très probablement, l'auteur a entré </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour chaque</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nom de la collection par auto-complétion et n'a pas remarqué que le mauvais champ a été proposé. </font><font style="vertical-align: inherit;">Il est impossible de modifier la collection pendant l'itération, mais dans de bonnes circonstances, comme dans ce cas, l'application peut ne pas tomber. </font><font style="vertical-align: inherit;">Ici, cette faute de frappe a un effet indirect: la machine qui analyse les fichiers DWARF s'appuie sur cette collection pour arrêter l'analyse lors de la recherche d'opcodes non pris en charge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À partir de Java 9, il vaut la peine d'utiliser les méthodes d'usine de la bibliothèque standard pour les collections constantes: par exemple, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set.of (T ... elements) est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> non seulement beaucoup plus pratique, mais rend également immuable la collection créée, ce qui augmente la fiabilité du code.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 5: il y a tout</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValueAt</span><span class="hljs-params">(Object aValue, <span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> column)</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">int</span> index = indexOf(newName);
  <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {                  <span class="hljs-comment">// &lt;=</span><font></font>
    Window window = tool.getActiveWindow();<font></font>
    Msg.showInfo(getClass(), window, <span class="hljs-string">"Duplicate Name"</span>,
                 <span class="hljs-string">"Name already exists: "</span> + newName);
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
<font></font>
  ExternalPath path = paths.get(row); <span class="hljs-comment">// &lt;=</span><font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">indexOf</span><span class="hljs-params">(String name)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; paths.size(); i++) {<font></font>
    ExternalPath path = paths.get(i);<font></font>
    <span class="hljs-keyword">if</span> (path.getName().equals(name)) {
      <span class="hljs-keyword">return</span> i;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissements de PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6007 L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expression 'index&gt; = 0' est toujours vraie. </font><font style="vertical-align: inherit;">ExternalNamesTableModel.java:105</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V6019</a> Unreachable code detected. It is possible that an error is present. ExternalNamesTableModel.java:109</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'auteur y a pensé, et dans la méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au lieu de "index" -1 pour une valeur inconnue retourne 0 - l'index du premier élément de la collection de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chemins</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Même si la collection est vide. Ou peut-être que la méthode a été générée, mais a oublié de modifier la valeur de retour par défaut. Par conséquent, la méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt supprimera</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toute valeur qui lui sera transmise et affichera l'utilisateur avec une erreur «Le nom existe déjà», même s'il n'y a pas de nom existant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est utilisé nulle part ailleurs, et sa valeur n'est nécessaire que pour déterminer si l'élément que vous recherchez existe. Peut-être qu'au lieu d'une méthode distincte, écrivez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for-each</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> directement dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et effectuez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">return</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur un élément correspondant au lieu de jeux avec des index. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remarque: je n'ai pas pu reproduire l'erreur alléguée. </font><font style="vertical-align: inherit;">La méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est </font><i><font style="vertical-align: inherit;">probablement</font></i><font style="vertical-align: inherit;"> plus utilisée ou appelée uniquement sous certaines conditions.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 6: garder le silence</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> Map&lt;Character, String&gt; DELIMITER_NAME_MAP = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(<span class="hljs-number">20</span>);
<span class="hljs-comment">// Any non-alphanumeric char can be used as a delimiter.</span>
<span class="hljs-keyword">static</span> {<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">' '</span>, <span class="hljs-string">"Space"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'~'</span>, <span class="hljs-string">"Tilde"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'`'</span>, <span class="hljs-string">"Back quote"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"Exclamation point"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"At sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'#'</span>, <span class="hljs-string">"Pound sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'$'</span>, <span class="hljs-string">"Dollar sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'%'</span>, <span class="hljs-string">"Percent sign"</span>);<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6033</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un élément avec la même clé '@' a déjà été ajouté. FilterOptions.java:45 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ghidra prend en charge le filtrage des données dans divers contextes: par exemple, vous pouvez filtrer la liste des fichiers de projet par nom. De plus, le filtrage par plusieurs mots-clés à la fois est implémenté: «.java, .c» lorsque le mode «OU» est activé, affiche tous les fichiers dont le nom contient «.java» ou «.c». Il est entendu que n'importe quel caractère spécial peut être utilisé comme séparateur de mots (un séparateur spécifique est sélectionné dans les paramètres du filtre), mais en réalité le point d'exclamation n'était pas disponible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans de telles feuilles d'initialisation, il est très facile de les sceller, car elles sont souvent écrites à l'aide de copier-coller, et lorsque vous regardez un tel code, vos yeux se brouillent rapidement. </font><font style="vertical-align: inherit;">Et si la faute de frappe n'était pas sur deux lignes adjacentes, alors à la main, elle ne sera presque certainement pas vue.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 7: le reste de la division est toujours 0</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setFactorys</span><span class="hljs-params">(FieldFactory[] fieldFactorys,
                 DataFormatModel dataModel, <span class="hljs-keyword">int</span> margin)</span> </span>{<font></font>
  factorys = <span class="hljs-keyword">new</span> FieldFactory[fieldFactorys.length];<font></font>
<font></font>
  <span class="hljs-keyword">int</span> x = margin;
  <span class="hljs-keyword">int</span> defaultGroupSizeSpace = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; factorys.length; i++) {<font></font>
    factorys[i] = fieldFactorys[i];<font></font>
    factorys[i].setStartX(x);<font></font>
    x += factorys[i].getWidth();<font></font>
    <span class="hljs-comment">// add in space between groups</span>
    <span class="hljs-keyword">if</span> (((i + <span class="hljs-number">1</span>) % defaultGroupSizeSpace) == <span class="hljs-number">0</span>) { <span class="hljs-comment">// &lt;=</span><font></font>
      x += margin * dataModel.getUnitDelimiterSize();<font></font>
    }<font></font>
  }<font></font>
  width = x - margin * dataModel.getUnitDelimiterSize() + margin;<font></font>
  layoutChanged();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissements de PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6007 L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expression '((i + 1)% defaultGroupSizeSpace) == 0' est toujours vraie. </font><font style="vertical-align: inherit;">ByteViewerLayoutModel.java:66</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6048</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cette expression peut être simplifiée. </font><font style="vertical-align: inherit;">L'opérande 'defaultGroupSizeSpace' dans l'opération est égal à 1. ByteViewerLayoutModel.java:66</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le visualiseur d'octets hexadécimal prend en charge le choix de la taille des groupes affichés: par exemple, vous pouvez configurer la sortie au format 'ffff ffff' ou 'ff ff ff ff'. La méthode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setFactorys</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est responsable de l'emplacement de ces groupes dans l'interface utilisateur </font><font style="vertical-align: inherit;">. Malgré le fait que la personnalisation et l'affichage fonctionnent correctement, le cycle de cette méthode semble extrêmement suspect: le reste de la division par un est toujours nul, ce qui signifie que la coordonnée </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> augmentera à chaque itération. La suspicion ajoute des propriétés et la disponibilité </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groupSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la définition de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataModel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reste des ordures après refactorisation? Ou peut-être que les </font><i><font style="vertical-align: inherit;">calculs de la</font></i><font style="vertical-align: inherit;"> variable </font><i><font style="vertical-align: inherit;">defaultGroupSizeSpace</font></i><font style="vertical-align: inherit;"> ont été perdus</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Dans tous les cas, une tentative de remplacer sa valeur par </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataModel.getGroupSize () a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cassé la disposition, et peut-être que seul l'auteur de ce code peut donner une réponse non ambiguë.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 8: validation brisée, partie 2</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">parseArrayDimensions</span><span class="hljs-params">(String datatype,
                                    List&lt;Integer&gt; arrayDimensions)</span> </span>{<font></font>
  String dataTypeName = datatype;<font></font>
  <span class="hljs-keyword">boolean</span> zeroLengthArray = <span class="hljs-keyword">false</span>;
  <span class="hljs-keyword">while</span> (dataTypeName.endsWith(<span class="hljs-string">"]"</span>)) {
    <span class="hljs-keyword">if</span> (zeroLengthArray) {                   <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// only last dimension may be 0</span><font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> rBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">']'</span>);
    <span class="hljs-keyword">int</span> lBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">'['</span>);
    <span class="hljs-keyword">if</span> (lBracketPos &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> dimension;
    <span class="hljs-keyword">try</span> {<font></font>
      dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                          rBracketPos));<font></font>
      <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span><font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">catch</span> (NumberFormatException e) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    dataTypeName = dataTypeName.substring(<span class="hljs-number">0</span>, lBracketPos).trim();<font></font>
    arrayDimensions.add(dimension);<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> dataTypeName;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissement PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expression V6007 'zeroLengthArray' est toujours fausse. PdbDataTypeParser.java:278 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette méthode analyse la dimension d'un tableau multidimensionnel et renvoie le texte restant après l'analyse ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour les données non valides. Un commentaire à côté de l'une des vérifications de validation indique que seule la dernière taille de lecture peut être nulle. L'analyse va de droite à gauche, il est donc entendu que «[0] [1] [2]» est un texte d'entrée valide, et «[2] [1] [0]» ne l'est pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais, problème: personne n'a ajouté la vérification que la taille suivante est zéro et l'analyseur mange des données invalides sans poser de questions inutiles. Vous devriez probablement corriger le bloc try comme suit:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">try</span> {<font></font>
  dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                      rBracketPos));<font></font>
  <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dimension == <span class="hljs-number">0</span>) {<font></font>
    zeroLengthArray = <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
}<font></font>
<span class="hljs-keyword">catch</span> (NumberFormatException e) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, il est possible que ce critère de validité dans le temps se soit avéré inutile, ou que le commentaire de l’auteur ait une signification différente et qu’il soit nécessaire de vérifier la première dimension lue. </font><font style="vertical-align: inherit;">Dans tous les cas, la validation des données est un élément essentiel de toute application, qui doit être prise avec l'entière responsabilité. </font><font style="vertical-align: inherit;">Des erreurs peuvent entraîner des plantages de l'application tout à fait inoffensifs, ainsi que des failles de sécurité, des fuites de données, une corruption ou une perte de données (par exemple, si vous ignorez l'injection SQL lors de la validation de la requête).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu sur le reste des avertissements</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le lecteur peut remarquer que de nombreux avertissements ont été émis, mais peu ont été pris en compte. Le cloc pas très bien réglé dans le projet comptait environ 1,25 million de lignes de code Java (pas vides et pas de commentaires). Le fait est que presque tous les avertissements sont extrêmement similaires: ici, ils ont oublié de vérifier la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ils n'y ont pas supprimé le code hérité inutilisé. Je ne veux pas vraiment ennuyer le lecteur en énumérant la même chose, et j'ai mentionné une partie de ces cas au début de l'article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre exemple est les cinquante avertissements " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonction </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6009</font></a><font style="vertical-align: inherit;"> reçoit un argument impair" dans le contexte d'une utilisation inexacte de la méthode de </font><i><font style="vertical-align: inherit;">sous</font></i><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chaîne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(CParserUtils.java:280, ComplexName.java:48 et autres) pour obtenir le reste de la chaîne après tout séparateur. </font><font style="vertical-align: inherit;">Les développeurs espèrent souvent que ce séparateur sera présent dans la chaîne et oublient que sinon </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renverra -1, ce qui est une valeur incorrecte pour la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous-chaîne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Naturellement, si les données ont été validées ou reçues non de l'extérieur, la probabilité de plantage de l'application est considérablement réduite. </font><font style="vertical-align: inherit;">Cependant, en général, ce sont des endroits potentiellement dangereux dont nous voulons nous débarrasser.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En général, Ghidra était satisfait de la qualité du code - aucun cauchemar spécial n'est évident. </font><font style="vertical-align: inherit;">Le code est bien formaté et a un style très cohérent: dans la plupart des cas, les variables, les méthodes et tout le reste reçoivent des noms clairs, des commentaires explicatifs sont trouvés et un grand nombre de tests sont présents. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, il n'y a eu aucun problème, parmi lesquels:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code mort, qui, très probablement, est resté après de nombreuses modifications;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De nombreux javadocs sont désespérément obsolètes et, par exemple, indiquent des paramètres inexistants;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a aucune possibilité de développement pratique </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lors de l'utilisation d'IntelliJ IDEA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un système modulaire construit autour de la réflexion rend la navigation dans un projet et la recherche de dépendances entre les composants beaucoup plus difficiles.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez ne pas négliger les outils de développement. </font><font style="vertical-align: inherit;">L'analyse statique, comme les ceintures de sécurité, n'est pas une panacée, mais elle aidera à prévenir certaines catastrophes avant la libération. </font><font style="vertical-align: inherit;">Et personne n'aime utiliser le logiciel connecté. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez lire sur d'autres projets éprouvés dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notre blog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et nous avons également une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">licence d'essai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et diverses </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">options pour</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utiliser l'analyseur sans avoir à payer pour cela.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Nikita Lazeba. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSA, Ghidra et Unicorns</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr504768/index.html">Stage d'analyste à Yandex: analyse des tâches de test</a></li>
<li><a href="../fr504770/index.html">Distributions de jeux Linux</a></li>
<li><a href="../fr504772/index.html">Événements numériques à Moscou du 1er au 7 juin</a></li>
<li><a href="../fr504774/index.html">Sondage auprès des responsables informatiques sur l'évolution des besoins en services informatiques</a></li>
<li><a href="../fr504776/index.html">Écrire un moteur de jeu dès votre première année: facile! (Presque)</a></li>
<li><a href="../fr504784/index.html">Le certificat racine AddTrust de Sectigo a expiré le 30 mai 2020, ce qui a provoqué des problèmes dans les clients OpenSSL 1.0.x et GnuTLS</a></li>
<li><a href="../fr504786/index.html">Tout ce que vous devez savoir sur la mise en cache</a></li>
<li><a href="../fr504790/index.html">Une sélection d'articles sur l'apprentissage automatique: cas, guides et études pour mai 2020</a></li>
<li><a href="../fr504792/index.html">Pensionnat de service. Comment NSPK a sauvé sa salle de travail d'un coronavirus</a></li>
<li><a href="../fr504796/index.html">Udalenka est cool. Peut-être rester pour toujours?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>