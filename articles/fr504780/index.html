<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì∏ üöë üå† NSA, Ghidra et licornes üö¥üèº üìó üî´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cette fois, les yeux de l'√©quipe PVS-Studio ont √©t√© attir√©s par Ghidra, un cadre large et diabolique pour la r√©tro-ing√©nierie avec lequel vous pouvez ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>NSA, Ghidra et licornes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/504780/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/zb/b9/po/zbb9pocjsbhx8woze4xo8picks0.png" alt="NSA, Ghidra et licornes"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette fois, les yeux de l'√©quipe PVS-Studio ont √©t√© attir√©s par Ghidra, un cadre large et diabolique pour la r√©tro-ing√©nierie avec lequel vous pouvez analyser divers fichiers binaires et faire toutes sortes de choses effrayantes avec eux. </font><font style="vertical-align: inherit;">La chose la plus int√©ressante √† ce sujet n'est pas qu'il est libre d'utiliser ou s'√©tend bien avec les plugins, mais qu'ils l'ont √©crit dans la NSA et ont publi√© la source sur GitHub pour tout le monde. </font><font style="vertical-align: inherit;">D'une part, la NSA semble disposer de suffisamment de ressources pour maintenir la base de code propre. </font><font style="vertical-align: inherit;">Et d'autre part, de nouveaux contributeurs qui ne le connaissaient pas tr√®s bien auraient pu accidentellement ajouter des bogues non d√©tect√©s r√©cemment. </font><font style="vertical-align: inherit;">Par cons√©quent, arm√©s d'une analyse statique, nous avons d√©cid√© de rechercher des faiblesses dans ce projet.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©lude</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au total, l'analyseur statique PVS-Studio a √©mis 651 avertissements √©lev√©s, 904 moyens et 909 faibles dans la partie Java du projet Ghidra ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version 9.1.2, commit 687ce7f</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Parmi eux, environ la moiti√© des r√©ponses hautes et moyennes ont √©t√© d√©clench√©es par le diagnostic </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6022</font></a><font style="vertical-align: inherit;"> .</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le param√®tre n'est pas utilis√© √† l'int√©rieur du corps de la m√©thode ", qui appara√Æt g√©n√©ralement apr√®s refactorisation, lorsqu'un param√®tre n'√©tait plus n√©cessaire ou qu'une fonctionnalit√© √©tait temporairement d√©sactiv√©e par des commentaires. Un aper√ßu rapide de ces avertissements (il y en a trop pour les afficher chacun en tant qu'observateur externe ) dans ce projet n'a r√©v√©l√© aucun √©l√©ment manifestement suspect. Il est probablement autoris√© pour ce projet de d√©sactiver temporairement ce diagnostic dans les param√®tres de l'analyseur afin de ne pas √™tre distrait par celui-ci. En pratique, vous pouvez souvent voir des fautes de frappe au nom du param√®tre setter ou constructeur et, d'une mani√®re g√©n√©rale, Je suis s√ªr que la plupart des lecteurs rencontrent au moins une fois un sch√©ma d√©sagr√©able similaire:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>{
  <span class="hljs-keyword">private</span> String value;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">A</span><span class="hljs-params">(String val)</span> </span>{ <span class="hljs-comment">// V6022</span>
    <span class="hljs-keyword">this</span>.value = value;<font></font>
  }<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> value.hashCode(); <span class="hljs-comment">// NullPointerException</span><font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus de la moiti√© des avertissements faibles ont √©t√© √©mis par le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diagnostic</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">D√©r√©f√©rence</font></a><font style="vertical-align: inherit;"> potentielle nulle </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6008</font></a><font style="vertical-align: inherit;"> de" variable "- par exemple, la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File.getParentFile () est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> souvent utilis√©e </font><font style="vertical-align: inherit;">sans v√©rifier la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si l'objet fichier sur lequel cette m√©thode a √©t√© appel√©e a √©t√© construit sans chemin absolu, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera renvoy√© </font><font style="vertical-align: inherit;">et l'absence de v√©rification risque de supprimer l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par tradition, nous n'analyserons que les avertissements de niveaux √©lev√©s et moyens, car la majeure partie des erreurs r√©elles y sont contenues. Lorsque vous travaillez avec des rapports d'analyseur, nous recommandons toujours d'analyser les avertissements par ordre d√©croissant de leur fiabilit√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous consid√©rons quelques fragments indiqu√©s par l'analyseur qui me paraissent suspects ou int√©ressants. </font><font style="vertical-align: inherit;">La base de code du projet s'est av√©r√©e √™tre d'une taille impressionnante, et il est presque impossible de trouver de tels endroits manuellement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 1: validation interrompue</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">parseDataTypeTextEntry</span><span class="hljs-params">()</span>
<span class="hljs-keyword">throws</span> InvalidDataTypeException </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">try</span> {<font></font>
    newDataType = parser.parse(selectionField.getText(),<font></font>
                               getDataTypeRootForCurrentText());<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (CancelledException e) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (newDataType != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">if</span> (maxSize &gt;= <span class="hljs-number">0</span>
        &amp;&amp; newDataType.getLength() &gt; newDataType.getLength()) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidDataTypeException(<span class="hljs-string">"data-type larger than "</span>
                                         + maxSize + <span class="hljs-string">" bytes"</span>);<font></font>
    }<font></font>
    selectionField.setSelectedValue(newDataType);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe des sous-expressions identiques 'newDataType.getLength ()' √† gauche et √† droite de l'op√©rateur '&gt;'. DataTypeSelectionEditor.java data66 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette classe fournit un composant graphique pour s√©lectionner un type de donn√©es qui prend en charge la </font><font style="vertical-align: inherit;">saisie semi </font><font style="vertical-align: inherit;">-automatique. Le d√©veloppeur utilisant ce composant peut d√©finir la taille maximale autoris√©e du type de donn√©es s√©lectionn√© (via le champ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ou la rendre illimit√©e en d√©finissant une valeur n√©gative. Il a √©t√© suppos√© que lors de la validation des donn√©es entr√©es, le d√©passement de la limite l√®ve une exception, qui est alors rattrap√©e dans la pile d'appels et l'utilisateur re√ßoit un message.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semble que l'auteur du composant ait √©t√© distrait au moment de la r√©daction de ce test, ou peut-√™tre qu'il ait pens√© au sens de la vie, mais au final, la validation n'est tout simplement pas effectu√©e, car le nombre ne peut jamais √™tre plus grand que lui-m√™me et, en cons√©quence, nous obtenons d'ignorer cette condition. Cela signifie que ce composant peut fournir des donn√©es non valides. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre erreur similaire a √©t√© trouv√©e dans deux autres classes: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GuidUtil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewGuid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GuidUtil</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GuidInfo <span class="hljs-title">parseLine</span><span class="hljs-params">(...)</span> </span>{<font></font>
    ...<font></font>
    <span class="hljs-keyword">long</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">long</span>[<span class="hljs-number">4</span>];<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (isOK(data)) {
      <span class="hljs-keyword">if</span> (!hasVersion) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GuidInfo(guidString, name, guidType);<font></font>
      }<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VersionedGuidInfo(guidString, version, name, guidType);<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
  }<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
      <span class="hljs-keyword">if</span> ((data[i] != <span class="hljs-number">0</span>) || (data[i] != <span class="hljs-number">0xFFFFFFFFL</span>)) { <span class="hljs-comment">// &lt;=</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: l' </font><font style="vertical-align: inherit;">expression </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6007</font></a><font style="vertical-align: inherit;"> 'donn√©es [i]! = 0xFFFFFFFFL' est toujours vraie. GuidUtil.java:200 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La boucle </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><font style="vertical-align: inherit;">la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v√©rifie que la m√™me valeur n'est pas √©gale √† deux nombres diff√©rents en m√™me temps. Si tel est le cas, le GUID est imm√©diatement reconnu comme valide. Autrement dit, le GUID sera invalide uniquement si le tableau de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donn√©es</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">vide, et cela ne se produit jamais, car la valeur de la variable correspondante n'est affect√©e qu'une seule fois - au d√©but de la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parseLine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Corps de la</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans les deux classes, cela co√Øncide compl√®tement, ce qui sugg√®re l'id√©e d'un autre copier-coller de code incorrect. </font><font style="vertical-align: inherit;">Ce que l'auteur voulait exactement v√©rifier, je ne suis pas s√ªr, mais je peux supposer que cette m√©thode devrait √™tre corrig√©e comme suit:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">if</span> ((data[i] == <span class="hljs-number">0</span>) || (data[i] == <span class="hljs-number">0xFFFFFFFFL</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 2: masquer les exceptions</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">putByte</span><span class="hljs-params">(<span class="hljs-keyword">long</span> offsetInMemBlock, <span class="hljs-keyword">byte</span> b)</span>
<span class="hljs-keyword">throws</span> MemoryAccessException, IOException </span>{
  <span class="hljs-keyword">long</span> offsetInSubBlock = offsetInMemBlock - subBlockOffset;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (ioPending) {
      <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"Cyclic Access"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
    }<font></font>
    ioPending = <span class="hljs-keyword">true</span>;<font></font>
    doPutByte(mappedAddress.addNoWrap(offsetInSubBlock / <span class="hljs-number">8</span>),<font></font>
              (<span class="hljs-keyword">int</span>) (offsetInSubBlock % <span class="hljs-number">8</span>), b);<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (AddressOverflowException e) {
    <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"No memory at address"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span> {<font></font>
    ioPending = <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6006</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L'objet a √©t√© cr√©√© mais il n'est pas utilis√©. Le mot cl√© 'throw' peut √™tre manquant: 'new MemoryAccessException ("Cyclic Access")'. BitMappedSubMemoryBlock.java:99 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les objets d'exception eux-m√™mes, comme vous le savez, ne font rien (ou du moins ne devraient rien faire). Presque toujours, leurs nouvelles instances sont jet√©es par </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans de rares cas - transf√©r√©es quelque part ou plac√©es dans une collection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La classe contenant cette m√©thode est un wrapper sur un bloc de m√©moire qui permet de lire et d'√©crire des donn√©es. Ici, en raison du fait que les exceptions ne sont pas lev√©es, la restriction impos√©e d'acc√®s au bloc de m√©moire actuel avec l'indicateur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioPending peut √™tre viol√©e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et, en outre, une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception AddressOverflowException est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ignor√©e </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ainsi, les donn√©es peuvent √™tre silencieusement corrompues et au lieu d'indiquer explicitement une erreur √† un endroit particulier, le d√©veloppeur recevra des artefacts √©tranges qui doivent √™tre analys√©s par le d√©bogueur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y avait huit de ces exceptions perdues:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BitMappedSubMemoryBlock.java: lignes 77, 99, 106, 122</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ByteMappedSubMemoryBlock.java: lignes 52, 73, 92, 114</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est caract√©ristique que dans les m√™mes fichiers, il existe des m√©thodes extr√™mement similaires dans lesquelles la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projection est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pr√©sente. </font><font style="vertical-align: inherit;">Tr√®s probablement, une m√©thode a √©t√© √©crite √† l'origine de la m√™me mani√®re que le fragment ci-dessus, apr√®s quoi elle a √©t√© copi√©e plusieurs fois, a en quelque sorte trouv√© une erreur et l'a corrig√©e dans les endroits dont ils pouvaient se souvenir.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 3: champ de mines</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processSelection</span><span class="hljs-params">(OptionsTreeNode selectedNode)</span> </span>{
  <span class="hljs-keyword">if</span> (selectedNode == <span class="hljs-keyword">null</span>) {<font></font>
    setViewPanel(defaultPanel, selectedNode); <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setViewPanel</span><span class="hljs-params">(JComponent component, OptionsTreeNode selectedNode)</span> </span>{<font></font>
  ...<font></font>
  setHelpLocation(component, selectedNode);<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHelpLocation</span><span class="hljs-params">(JComponent component, OptionsTreeNode node)</span> </span>{<font></font>
  Options options = node.getOptions();<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6008 D√©r√©f√©rence</font></a><font style="vertical-align: inherit;"> nulle de 'selectedNode' dans la fonction 'setViewPanel'. OptionsPanel.java:266 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'analyseur a menti un peu - pour le moment, appeler la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection ne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conduit pas √† une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car cette m√©thode n'est appel√©e que deux fois et avant d'√™tre appel√©e, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> explicitement v√©rifi√© pour </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cela ne doit pas √™tre fait, car un autre d√©veloppeur peut voir que la m√©thode g√®re explicitement le cas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et d√©cider qu'il s'agit d'une valeur valide, ce qui entra√Ænera le blocage de l'application. De telles surprises sont particuli√®rement dangereuses uniquement dans les projets ouverts, car des personnes qui ne connaissent pas compl√®tement la base de code y participent.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, je dois dire que toute la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semble plut√¥t √©trange. </font><font style="vertical-align: inherit;">Il est probable qu'il s'agit d'une erreur de copier-coller, car dans la m√™me m√©thode, un bloc if avec le m√™me corps est rencontr√© deux fois de plus, bien qu'avec des conditions diff√©rentes. </font><font style="vertical-align: inherit;">Cependant, √† ce stade, le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne </font><i><font style="vertical-align: inherit;">sera</font></i><font style="vertical-align: inherit;"> plus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et la cha√Æne d'appel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setViewPanel-setHelpLocation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'entra√Ænera pas d' </font><i><font style="vertical-align: inherit;">exception </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 4: auto-compl√©tion pour le mal</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] UNSUPPORTED_OPCODES_LIST = { ... };
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;Integer&gt; UNSUPPORTED_OPCODES = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();<font></font>
<font></font>
<span class="hljs-keyword">static</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> opcode : UNSUPPORTED_OPCODES) {<font></font>
    UNSUPPORTED_OPCODES.add(opcode);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6053</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La collection est modifi√©e pendant que l'it√©ration est en cours. ConcurrentModificationException peut se produire. DWARFExpressionOpCodes.java:205 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, l'analyseur a de nouveau menti un peu - l'exception ne sera pas lev√©e, car la collection </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNSUPPORTED_OPCODES est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toujours vide et la boucle ne s'ex√©cutera tout simplement pas. De plus, il se trouve que la collection est une multitude, et l'ajout d'un √©l√©ment d√©j√† pr√©sent ne le changera pas. Tr√®s probablement, l'auteur a entr√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour chaque</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nom de la collection par auto-compl√©tion et n'a pas remarqu√© que le mauvais champ a √©t√© propos√©. </font><font style="vertical-align: inherit;">Il est impossible de modifier la collection pendant l'it√©ration, mais dans de bonnes circonstances, comme dans ce cas, l'application peut ne pas tomber. </font><font style="vertical-align: inherit;">Ici, cette faute de frappe a un effet indirect: la machine qui analyse les fichiers DWARF s'appuie sur cette collection pour arr√™ter l'analyse lors de la recherche d'opcodes non pris en charge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä partir de Java 9, il vaut la peine d'utiliser les m√©thodes d'usine de la biblioth√®que standard pour les collections constantes: par exemple, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set.of (T ... elements) est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> non seulement beaucoup plus pratique, mais rend √©galement immuable la collection cr√©√©e, ce qui augmente la fiabilit√© du code.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 5: il y a tout</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValueAt</span><span class="hljs-params">(Object aValue, <span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> column)</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">int</span> index = indexOf(newName);
  <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {                  <span class="hljs-comment">// &lt;=</span><font></font>
    Window window = tool.getActiveWindow();<font></font>
    Msg.showInfo(getClass(), window, <span class="hljs-string">"Duplicate Name"</span>,
                 <span class="hljs-string">"Name already exists: "</span> + newName);
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
<font></font>
  ExternalPath path = paths.get(row); <span class="hljs-comment">// &lt;=</span><font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">indexOf</span><span class="hljs-params">(String name)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; paths.size(); i++) {<font></font>
    ExternalPath path = paths.get(i);<font></font>
    <span class="hljs-keyword">if</span> (path.getName().equals(name)) {
      <span class="hljs-keyword">return</span> i;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissements de PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6007 L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expression 'index&gt; = 0' est toujours vraie. </font><font style="vertical-align: inherit;">ExternalNamesTableModel.java:105</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V6019</a> Unreachable code detected. It is possible that an error is present. ExternalNamesTableModel.java:109</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'auteur y a pens√©, et dans la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au lieu de "index" -1 pour une valeur inconnue retourne 0 - l'index du premier √©l√©ment de la collection de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chemins</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . M√™me si la collection est vide. Ou peut-√™tre que la m√©thode a √©t√© g√©n√©r√©e, mais a oubli√© de modifier la valeur de retour par d√©faut. Par cons√©quent, la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt supprimera</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toute valeur qui lui sera transmise et affichera l'utilisateur avec une erreur ¬´Le nom existe d√©j√†¬ª, m√™me s'il n'y a pas de nom existant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est utilis√© nulle part ailleurs, et sa valeur n'est n√©cessaire que pour d√©terminer si l'√©l√©ment que vous recherchez existe. Peut-√™tre qu'au lieu d'une m√©thode distincte, √©crivez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for-each</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> directement dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et effectuez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">return</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur un √©l√©ment correspondant au lieu de jeux avec des index. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remarque: je n'ai pas pu reproduire l'erreur all√©gu√©e. </font><font style="vertical-align: inherit;">La m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est </font><i><font style="vertical-align: inherit;">probablement</font></i><font style="vertical-align: inherit;"> plus utilis√©e ou appel√©e uniquement sous certaines conditions.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 6: garder le silence</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> Map&lt;Character, String&gt; DELIMITER_NAME_MAP = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(<span class="hljs-number">20</span>);
<span class="hljs-comment">// Any non-alphanumeric char can be used as a delimiter.</span>
<span class="hljs-keyword">static</span> {<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">' '</span>, <span class="hljs-string">"Space"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'~'</span>, <span class="hljs-string">"Tilde"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'`'</span>, <span class="hljs-string">"Back quote"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"Exclamation point"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"At sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'#'</span>, <span class="hljs-string">"Pound sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'$'</span>, <span class="hljs-string">"Dollar sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'%'</span>, <span class="hljs-string">"Percent sign"</span>);<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6033</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un √©l√©ment avec la m√™me cl√© '@' a d√©j√† √©t√© ajout√©. FilterOptions.java:45 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ghidra prend en charge le filtrage des donn√©es dans divers contextes: par exemple, vous pouvez filtrer la liste des fichiers de projet par nom. De plus, le filtrage par plusieurs mots-cl√©s √† la fois est impl√©ment√©: ¬´.java, .c¬ª lorsque le mode ¬´OU¬ª est activ√©, affiche tous les fichiers dont le nom contient ¬´.java¬ª ou ¬´.c¬ª. Il est entendu que n'importe quel caract√®re sp√©cial peut √™tre utilis√© comme s√©parateur de mots (un s√©parateur sp√©cifique est s√©lectionn√© dans les param√®tres du filtre), mais en r√©alit√© le point d'exclamation n'√©tait pas disponible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans de telles feuilles d'initialisation, il est tr√®s facile de les sceller, car elles sont souvent √©crites √† l'aide de copier-coller, et lorsque vous regardez un tel code, vos yeux se brouillent rapidement. </font><font style="vertical-align: inherit;">Et si la faute de frappe n'√©tait pas sur deux lignes adjacentes, alors √† la main, elle ne sera presque certainement pas vue.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 7: le reste de la division est toujours 0</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setFactorys</span><span class="hljs-params">(FieldFactory[] fieldFactorys,
                 DataFormatModel dataModel, <span class="hljs-keyword">int</span> margin)</span> </span>{<font></font>
  factorys = <span class="hljs-keyword">new</span> FieldFactory[fieldFactorys.length];<font></font>
<font></font>
  <span class="hljs-keyword">int</span> x = margin;
  <span class="hljs-keyword">int</span> defaultGroupSizeSpace = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; factorys.length; i++) {<font></font>
    factorys[i] = fieldFactorys[i];<font></font>
    factorys[i].setStartX(x);<font></font>
    x += factorys[i].getWidth();<font></font>
    <span class="hljs-comment">// add in space between groups</span>
    <span class="hljs-keyword">if</span> (((i + <span class="hljs-number">1</span>) % defaultGroupSizeSpace) == <span class="hljs-number">0</span>) { <span class="hljs-comment">// &lt;=</span><font></font>
      x += margin * dataModel.getUnitDelimiterSize();<font></font>
    }<font></font>
  }<font></font>
  width = x - margin * dataModel.getUnitDelimiterSize() + margin;<font></font>
  layoutChanged();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissements de PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6007 L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expression '((i + 1)% defaultGroupSizeSpace) == 0' est toujours vraie. </font><font style="vertical-align: inherit;">ByteViewerLayoutModel.java:66</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6048</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cette expression peut √™tre simplifi√©e. </font><font style="vertical-align: inherit;">L'op√©rande 'defaultGroupSizeSpace' dans l'op√©ration est √©gal √† 1. ByteViewerLayoutModel.java:66</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le visualiseur d'octets hexad√©cimal prend en charge le choix de la taille des groupes affich√©s: par exemple, vous pouvez configurer la sortie au format 'ffff ffff' ou 'ff ff ff ff'. La m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setFactorys</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est responsable de l'emplacement de ces groupes dans l'interface utilisateur </font><font style="vertical-align: inherit;">. Malgr√© le fait que la personnalisation et l'affichage fonctionnent correctement, le cycle de cette m√©thode semble extr√™mement suspect: le reste de la division par un est toujours nul, ce qui signifie que la coordonn√©e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> augmentera √† chaque it√©ration. La suspicion ajoute des propri√©t√©s et la disponibilit√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groupSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la d√©finition de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataModel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reste des ordures apr√®s refactorisation? Ou peut-√™tre que les </font><i><font style="vertical-align: inherit;">calculs de la</font></i><font style="vertical-align: inherit;"> variable </font><i><font style="vertical-align: inherit;">defaultGroupSizeSpace</font></i><font style="vertical-align: inherit;"> ont √©t√© perdus</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Dans tous les cas, une tentative de remplacer sa valeur par </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataModel.getGroupSize () a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cass√© la disposition, et peut-√™tre que seul l'auteur de ce code peut donner une r√©ponse non ambigu√´.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment 8: validation bris√©e, partie 2</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">parseArrayDimensions</span><span class="hljs-params">(String datatype,
                                    List&lt;Integer&gt; arrayDimensions)</span> </span>{<font></font>
  String dataTypeName = datatype;<font></font>
  <span class="hljs-keyword">boolean</span> zeroLengthArray = <span class="hljs-keyword">false</span>;
  <span class="hljs-keyword">while</span> (dataTypeName.endsWith(<span class="hljs-string">"]"</span>)) {
    <span class="hljs-keyword">if</span> (zeroLengthArray) {                   <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// only last dimension may be 0</span><font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> rBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">']'</span>);
    <span class="hljs-keyword">int</span> lBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">'['</span>);
    <span class="hljs-keyword">if</span> (lBracketPos &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> dimension;
    <span class="hljs-keyword">try</span> {<font></font>
      dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                          rBracketPos));<font></font>
      <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span><font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">catch</span> (NumberFormatException e) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    dataTypeName = dataTypeName.substring(<span class="hljs-number">0</span>, lBracketPos).trim();<font></font>
    arrayDimensions.add(dimension);<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> dataTypeName;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissement PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expression V6007 'zeroLengthArray' est toujours fausse. PdbDataTypeParser.java:278 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette m√©thode analyse la dimension d'un tableau multidimensionnel et renvoie le texte restant apr√®s l'analyse ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour les donn√©es non valides. Un commentaire √† c√¥t√© de l'une des v√©rifications de validation indique que seule la derni√®re taille de lecture peut √™tre nulle. L'analyse va de droite √† gauche, il est donc entendu que ¬´[0] [1] [2]¬ª est un texte d'entr√©e valide, et ¬´[2] [1] [0]¬ª ne l'est pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais, probl√®me: personne n'a ajout√© la v√©rification que la taille suivante est z√©ro et l'analyseur mange des donn√©es invalides sans poser de questions inutiles. Vous devriez probablement corriger le bloc try comme suit:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">try</span> {<font></font>
  dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                      rBracketPos));<font></font>
  <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dimension == <span class="hljs-number">0</span>) {<font></font>
    zeroLengthArray = <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
}<font></font>
<span class="hljs-keyword">catch</span> (NumberFormatException e) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, il est possible que ce crit√®re de validit√© dans le temps se soit av√©r√© inutile, ou que le commentaire de l‚Äôauteur ait une signification diff√©rente et qu‚Äôil soit n√©cessaire de v√©rifier la premi√®re dimension lue. </font><font style="vertical-align: inherit;">Dans tous les cas, la validation des donn√©es est un √©l√©ment essentiel de toute application, qui doit √™tre prise avec l'enti√®re responsabilit√©. </font><font style="vertical-align: inherit;">Des erreurs peuvent entra√Æner des plantages de l'application tout √† fait inoffensifs, ainsi que des failles de s√©curit√©, des fuites de donn√©es, une corruption ou une perte de donn√©es (par exemple, si vous ignorez l'injection SQL lors de la validation de la requ√™te).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu sur le reste des avertissements</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le lecteur peut remarquer que de nombreux avertissements ont √©t√© √©mis, mais peu ont √©t√© pris en compte. Le cloc pas tr√®s bien r√©gl√© dans le projet comptait environ 1,25 million de lignes de code Java (pas vides et pas de commentaires). Le fait est que presque tous les avertissements sont extr√™mement similaires: ici, ils ont oubli√© de v√©rifier la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ils n'y ont pas supprim√© le code h√©rit√© inutilis√©. Je ne veux pas vraiment ennuyer le lecteur en √©num√©rant la m√™me chose, et j'ai mentionn√© une partie de ces cas au d√©but de l'article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre exemple est les cinquante avertissements " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonction </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">V6009</font></a><font style="vertical-align: inherit;"> re√ßoit un argument impair" dans le contexte d'une utilisation inexacte de la m√©thode de </font><i><font style="vertical-align: inherit;">sous</font></i><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cha√Æne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(CParserUtils.java:280, ComplexName.java:48 et autres) pour obtenir le reste de la cha√Æne apr√®s tout s√©parateur. </font><font style="vertical-align: inherit;">Les d√©veloppeurs esp√®rent souvent que ce s√©parateur sera pr√©sent dans la cha√Æne et oublient que sinon </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renverra -1, ce qui est une valeur incorrecte pour la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous-cha√Æne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Naturellement, si les donn√©es ont √©t√© valid√©es ou re√ßues non de l'ext√©rieur, la probabilit√© de plantage de l'application est consid√©rablement r√©duite. </font><font style="vertical-align: inherit;">Cependant, en g√©n√©ral, ce sont des endroits potentiellement dangereux dont nous voulons nous d√©barrasser.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, Ghidra √©tait satisfait de la qualit√© du code - aucun cauchemar sp√©cial n'est √©vident. </font><font style="vertical-align: inherit;">Le code est bien format√© et a un style tr√®s coh√©rent: dans la plupart des cas, les variables, les m√©thodes et tout le reste re√ßoivent des noms clairs, des commentaires explicatifs sont trouv√©s et un grand nombre de tests sont pr√©sents. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, il n'y a eu aucun probl√®me, parmi lesquels:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code mort, qui, tr√®s probablement, est rest√© apr√®s de nombreuses modifications;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De nombreux javadocs sont d√©sesp√©r√©ment obsol√®tes et, par exemple, indiquent des param√®tres inexistants;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a aucune possibilit√© de d√©veloppement pratique </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lors de l'utilisation d'IntelliJ IDEA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un syst√®me modulaire construit autour de la r√©flexion rend la navigation dans un projet et la recherche de d√©pendances entre les composants beaucoup plus difficiles.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez ne pas n√©gliger les outils de d√©veloppement. </font><font style="vertical-align: inherit;">L'analyse statique, comme les ceintures de s√©curit√©, n'est pas une panac√©e, mais elle aidera √† pr√©venir certaines catastrophes avant la lib√©ration. </font><font style="vertical-align: inherit;">Et personne n'aime utiliser le logiciel connect√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez lire sur d'autres projets √©prouv√©s dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notre blog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et nous avons √©galement une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">licence d'essai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et diverses </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">options pour</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utiliser l'analyseur sans avoir √† payer pour cela.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Nikita Lazeba. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSA, Ghidra et Unicorns</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr504768/index.html">Stage d'analyste √† Yandex: analyse des t√¢ches de test</a></li>
<li><a href="../fr504770/index.html">Distributions de jeux Linux</a></li>
<li><a href="../fr504772/index.html">√âv√©nements num√©riques √† Moscou du 1er au 7 juin</a></li>
<li><a href="../fr504774/index.html">Sondage aupr√®s des responsables informatiques sur l'√©volution des besoins en services informatiques</a></li>
<li><a href="../fr504776/index.html">√âcrire un moteur de jeu d√®s votre premi√®re ann√©e: facile! (Presque)</a></li>
<li><a href="../fr504784/index.html">Le certificat racine AddTrust de Sectigo a expir√© le 30 mai 2020, ce qui a provoqu√© des probl√®mes dans les clients OpenSSL 1.0.x et GnuTLS</a></li>
<li><a href="../fr504786/index.html">Tout ce que vous devez savoir sur la mise en cache</a></li>
<li><a href="../fr504790/index.html">Une s√©lection d'articles sur l'apprentissage automatique: cas, guides et √©tudes pour mai 2020</a></li>
<li><a href="../fr504792/index.html">Pensionnat de service. Comment NSPK a sauv√© sa salle de travail d'un coronavirus</a></li>
<li><a href="../fr504796/index.html">Udalenka est cool. Peut-√™tre rester pour toujours?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>