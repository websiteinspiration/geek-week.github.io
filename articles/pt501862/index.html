<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßíüèª üë®üèæ‚Äçüé® ‚ôæ Tremula√ß√£o sob o cap√¥ üåÖ üïô üåè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° a todos! Meu nome √© Mikhail Zotiev, trabalho como desenvolvedor Flutter na Surf. Eu, como provavelmente a maioria dos outros desenvolvedores que t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Tremula√ß√£o sob o cap√¥</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/501862/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ol√° a todos! Meu nome √© Mikhail Zotiev, trabalho como desenvolvedor Flutter na Surf. Eu, como provavelmente a maioria dos outros desenvolvedores que trabalham com o Flutter, gosto principalmente de como √© f√°cil criar aplicativos bonitos e convenientes com sua ajuda. Leva muito pouco tempo para entrar no desenvolvimento do Flutter. Recentemente, trabalhei no desenvolvimento de jogos e agora mudei completamente para o desenvolvimento m√≥vel multiplataforma no Flutter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qual √© a simplicidade? </font><font style="vertical-align: inherit;">Com uma d√∫zia de widgets b√°sicos, voc√™ pode criar interfaces de usu√°rio bastante decentes. </font><font style="vertical-align: inherit;">E com o tempo, quando a bagagem usada √© bastante decente, √© improv√°vel que alguma tarefa o deixe parado: seja um design incomum ou uma anima√ß√£o sofisticada. </font><font style="vertical-align: inherit;">E o mais interessante - provavelmente voc√™ pode us√°-lo sem nem pensar na pergunta: "Como funciona?" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como Flutter tem c√≥digo aberto, decidi descobrir o que est√° por tr√°s (no lado Dart da For√ßa) e compartilh√°-lo com voc√™.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lg/ln/q6/lglnq6t8sbc8gq-emifhx1dxjwu.png"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ferramenta</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos n√≥s ouvimos a frase da equipe de desenvolvimento de estruturas mais de uma vez: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tudo no Flutter √© widgets"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vamos ver se √© realmente assim. </font><font style="vertical-align: inherit;">Para fazer isso, passamos √† classe </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Widget</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (a seguir - o widget) e come√ßamos a nos familiarizar gradualmente com o conte√∫do. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira coisa que leremos na documenta√ß√£o da classe:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descreve a configura√ß√£o para um [elemento].</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que o pr√≥prio widget √© apenas uma descri√ß√£o de algum </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (daqui em diante - o elemento).</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Widgets s√£o a hierarquia de classe central na estrutura Flutter. </font><font style="vertical-align: inherit;">Um widget √© uma descri√ß√£o imut√°vel de parte de uma interface do usu√°rio. </font><font style="vertical-align: inherit;">Os widgets podem ser inflados em elementos, que gerenciam a √°rvore de renderiza√ß√£o subjacente.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para resumir, a frase </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tudo no Flutter √© um widget"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o n√≠vel m√≠nimo de entendimento de como tudo est√° organizado para usar o Flutter. </font><font style="vertical-align: inherit;">O widget √© a classe central na hierarquia Flutter. </font><font style="vertical-align: inherit;">Ao mesmo tempo, existem muitos mecanismos adicionais ao seu redor que ajudam a estrutura a lidar com sua tarefa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, aprendemos mais alguns fatos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget - uma descri√ß√£o imut√°vel de uma parte da interface do usu√°rio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o widget est√° associado a uma vis√£o avan√ßada chamada elemento; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um elemento controla alguma entidade da √°rvore de renderiza√ß√£o.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ deve ter notado uma coisa estranha. </font><font style="vertical-align: inherit;">A interface do usu√°rio e a imutabilidade se encaixam muito mal, diria at√© que esses s√£o conceitos completamente incompat√≠veis. </font><font style="vertical-align: inherit;">Mas voltaremos a isso quando surgir uma imagem mais completa do dispositivo do mundo Flutter, mas, por enquanto, continuaremos a nos familiarizar com a documenta√ß√£o do widget.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os pr√≥prios widgets n√£o t√™m estado mut√°vel (todos os seus campos devem ser finais). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ deseja associar um estado mut√°vel a um widget, considere usar um [StatefulWidget], que cria um objeto [State] (via [StatefulWidget.createState]) sempre que for inflado em um elemento e incorporado √† √°rvore.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este par√°grafo complementa um pouco o primeiro par√°grafo: se precisarmos de uma configura√ß√£o mut√°vel, usamos a entidade </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">State</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> especial </font><font style="vertical-align: inherit;">(doravante denominada state), que descreve o estado atual desse widget. </font><font style="vertical-align: inherit;">No entanto, o estado n√£o est√° associado ao widget, mas √† sua representa√ß√£o elementar.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um determinado widget pode ser inclu√≠do na √°rvore zero ou mais vezes. </font><font style="vertical-align: inherit;">Em particular, um determinado widget pode ser colocado na √°rvore v√°rias vezes. </font><font style="vertical-align: inherit;">Cada vez que um widget √© colocado na √°rvore, ele √© inflado em um [Elemento], o que significa que um widget que √© incorporado √† √°rvore v√°rias vezes ser√° inflado v√°rias vezes.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O mesmo widget pode ser inclu√≠do na √°rvore de widgets v√°rias vezes ou nem sequer ser inclu√≠do. </font><font style="vertical-align: inherit;">Mas toda vez que um widget √© inclu√≠do na √°rvore de widgets, um elemento √© mapeado para ele. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, nesta fase, os widgets est√£o quase prontos, vamos resumir:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget - a classe central da hierarquia;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget √© alguma configura√ß√£o; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget - uma descri√ß√£o imut√°vel de uma parte da interface do usu√°rio; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o widget est√° associado a um elemento que controla a renderiza√ß√£o de alguma maneira; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o estado alterado do widget pode ser descrito por alguma entidade, mas n√£o est√° conectado ao widget, mas ao elemento que representa esse widget.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elemento</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pelo que aprendemos, a pergunta implora: "Quais s√£o esses elementos que governam tudo?" </font><font style="vertical-align: inherit;">Fa√ßa o mesmo - abra a documenta√ß√£o para a classe Element.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma instancia√ß√£o de um [Widget] em um local espec√≠fico na √°rvore.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um elemento √© uma representa√ß√£o de um widget em um local espec√≠fico em uma √°rvore.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os widgets descrevem como configurar uma sub√°rvore, mas o mesmo widget pode ser usado para configurar v√°rias sub√°rvores simultaneamente, porque os widgets s√£o imut√°veis. </font><font style="vertical-align: inherit;">Um [Elemento] representa o uso de um widget para configurar um local espec√≠fico na √°rvore. </font><font style="vertical-align: inherit;">Com o tempo, o widget associado a um determinado elemento pode mudar, por exemplo, se o widget pai for reconstru√≠do e criar um novo widget para esse local.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O widget descreve a configura√ß√£o de alguma parte da interface do usu√°rio, mas como j√° sabemos, o mesmo widget pode ser usado em diferentes locais da √°rvore. Cada um desses locais ser√° representado por um elemento correspondente. Por√©m, com o tempo, o widget associado ao item pode ser alterado. Isso significa que os elementos s√£o mais tenazes e continuam a ser usados, apenas atualizando suas conex√µes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta √© uma decis√£o bastante racional. Como j√° definimos acima, os widgets s√£o uma configura√ß√£o imut√°vel que simplesmente descreve uma parte espec√≠fica da interface, o que significa que eles devem ser muito leves. E os elementos na √°rea cujo controle √© muito mais pesado, mas eles n√£o s√£o recriados desnecessariamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender como isso √© feito, considere o ciclo de vida de um elemento:</font></font><br>
<br>
<ul>
<li>     Widget.createElement    ,     .</li>
<li>   mount        .              .</li>
<li>       .</li>
<li>   ,    (,    ),     .       runtimeType  key,     .   ,     ,           .</li>
<li> ,       ,    ,             ,      (  deactivate).</li>
<li>   ,     .           ,       ,   (unmount),           .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando voc√™ inclui novamente elementos na √°rvore, por exemplo, se o elemento ou seus ancestrais tiverem uma chave global, ele ser√° removido da lista de elementos inativos, o m√©todo de ativa√ß√£o ser√° chamado e o objeto renderizado associado a esse elemento ser√° incorporado novamente na √°rvore de renderiza√ß√£o. </font><font style="vertical-align: inherit;">Isso significa que o item deve aparecer na tela novamente.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na declara√ß√£o de classe, vemos que o elemento implementa a interface BuildContext. </font><font style="vertical-align: inherit;">Um BuildContext √© algo que controla a posi√ß√£o de um widget em uma √°rvore de widgets, como segue em sua documenta√ß√£o. </font><font style="vertical-align: inherit;">Corresponde quase exatamente √† descri√ß√£o do item. </font><font style="vertical-align: inherit;">Essa interface √© usada para evitar a manipula√ß√£o direta do elemento, mas ao mesmo tempo fornece acesso aos m√©todos de contexto necess√°rios. </font><font style="vertical-align: inherit;">Por exemplo, findRenderObject, que permite encontrar o objeto da √°rvore de renderiza√ß√£o correspondente a esse elemento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renderderbject</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resta lidar com o √∫ltimo link dessa tr√≠ade - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RenderObject</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Como o nome indica, este √© um objeto da √°rvore de visualiza√ß√£o. Ele tem um objeto pai, bem como um campo de dados que o objeto pai usa para armazenar informa√ß√µes espec√≠ficas sobre esse objeto em si, por exemplo, sua posi√ß√£o. Este objeto √© respons√°vel pela implementa√ß√£o dos protocolos b√°sicos de renderiza√ß√£o e layout.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RenderObject n√£o limita o modelo de uso de objetos filhos: pode haver nenhum, um ou muitos. </font><font style="vertical-align: inherit;">Al√©m disso, o sistema de posicionamento n√£o se limita a: o sistema cartesiano, coordenadas polares, tudo isso e muito mais est√° dispon√≠vel para uso. </font><font style="vertical-align: inherit;">N√£o h√° restri√ß√µes quanto ao uso de protocolos de localiza√ß√£o: ajustando a largura ou altura, limitando o tamanho, especificando o tamanho e a localiza√ß√£o do pai ou, se necess√°rio, usando os dados do objeto pai.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagem do mundo da vibra√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos tentar criar uma imagem geral de como tudo funciona juntos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° observamos acima, o widget √© uma descri√ß√£o imut√°vel, mas a interface do usu√°rio n√£o √© de todo est√°tica. </font><font style="vertical-align: inherit;">Essa discrep√¢ncia √© removida dividindo-se em tr√™s n√≠veis de objetos e a divis√£o de zonas de responsabilidade.</font></font><br>
<br>
<ul>
<li> ,          . </li>
<li> ,               . </li>
<li>  ,   ‚Äî ,     .</li>
</ul><br>
<img src="https://habrastorage.org/webt/j_/n_/og/j_n_ogui1a0iawbuoq5vxclsnne.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vejamos como essas √°rvores se parecem com um exemplo simples: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u7/0o/wk/u70owkgirs6krcos85rwn-acli8.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, temos alguns StatelessWidget agrupados em um widget Padding e contendo texto dentro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos nos colocar no lugar do Flutter - nos foi dada essa √°rvore de widgets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúEi, Padding, preciso do seu elemento‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Padding: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúClaro, segure SingleChildRenderObjectElement‚Äù</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/jj/u7/zn/jju7znfat7skocfex74adc4cu7o.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúElemento, aqui √© o seu lugar,</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
acalme-se </font><i><font style="vertical-align: inherit;">‚Äù</font></i><font style="vertical-align: inherit;"> SingleChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúGente, est√° tudo bem, mas eu preciso do RenderObject‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúPadding, like desenhar voc√™? ‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Preenchimento: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúHold it, RenderPadding‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
SingleChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äú√ìtimo, comece a trabalhar‚Äù</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/zk/ty/se/zktyse7pgo6jdd6x7impyivfhy0.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Ent√£o, quem √© o pr√≥ximo?" StatelessWidget, agora voc√™ deixa o elemento ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
StatelessWidget: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ Aqui StatelessElement ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ StatelessElement, voc√™ estar√° sujeito a SingleChildRenderObjectElement, aqui est√° o lugar, embarcando ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
StatelessElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ OK ¬ª</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/7w/tb/ke/7wtbkebtfn_xeq1ieqxqbarpkro.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ o RichText, elemento presente, por favor ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
o RichText fornece MultiChildRenderObjectElement </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúMultiChildRenderObjectElement, aqui est√°, comece‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
MultiChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúPreciso de uma renderiza√ß√£o para trabalhar‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúRichText, precisamos de um objeto de renderiza√ß√£o‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
RichText: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúAqui est√° um RenderParagraph‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúRenderParagraph voc√™ receber√° instru√ß√µes RenderPadding e controlar√° MultiChildRenderObjectElement‚Äù</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
MultiChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúAgora est√° tudo bem, estou pronto‚Äù</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/s4/24/fn/s424fnivo4j2tb4sv9pcirmxov0.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Certamente voc√™ far√° uma pergunta leg√≠tima: ‚ÄúOnde est√° o objeto de renderiza√ß√£o para StatelessWidget, por que n√£o est√° l√°, decidimos acima que os elementos vinculam configura√ß√µes com display? " </font><font style="vertical-align: inherit;">Vamos prestar aten√ß√£o na implementa√ß√£o b√°sica do m√©todo mount, discutida nesta se√ß√£o da descri√ß√£o do ciclo de vida.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">void</span> mount(Element parent, dynamic newSlot) {<font></font>
    assert(_debugLifecycleState == _ElementLifecycle.initial);<font></font>
    assert(widget != <span class="hljs-literal">null</span>);<font></font>
    assert(_parent == <span class="hljs-literal">null</span>);<font></font>
    assert(parent == <span class="hljs-literal">null</span> || parent._debugLifecycleState == _ElementLifecycle.active);<font></font>
    assert(slot == <span class="hljs-literal">null</span>);<font></font>
    assert(depth == <span class="hljs-literal">null</span>);<font></font>
    assert(!_active);<font></font>
    _parent = parent;<font></font>
    _slot = newSlot;<font></font>
    _depth = _parent != <span class="hljs-literal">null</span> ? _parent.depth + <span class="hljs-number">1</span> : <span class="hljs-number">1</span>;<font></font>
    _active = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (parent != <span class="hljs-literal">null</span>)<font></font>
        _owner = parent.owner;<font></font>
    <span class="hljs-keyword">if</span> (widget.key is GlobalKey) {<font></font>
        final GlobalKey key = widget.key;<font></font>
        key._register(<span class="hljs-keyword">this</span>);<font></font>
    }<font></font>
    _updateInheritance();<font></font>
    assert(() {<font></font>
        _debugLifecycleState = _ElementLifecycle.active;<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    }());<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o veremos nela a cria√ß√£o de um objeto de renderiza√ß√£o. </font><font style="vertical-align: inherit;">Mas o elemento implementa um BuildContext, que possui um m√©todo de pesquisa de objeto de visualiza√ß√£o findRenderObject, que nos levar√° ao seguinte getter:</font></font><br>
<br>
<pre><code class="javascript hljs">RenderObject get renderObject {<font></font>
    RenderObject result;<font></font>
    <span class="hljs-keyword">void</span> visit(Element element) {<font></font>
        assert(result == <span class="hljs-literal">null</span>); 
        <span class="hljs-keyword">if</span> (element is RenderObjectElement)<font></font>
            result = element.renderObject;<font></font>
        <span class="hljs-keyword">else</span><font></font>
            element.visitChildren(visit);<font></font>
    }<font></font>
    visit(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">return</span> result;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No caso b√°sico, um elemento pode n√£o criar um objeto de renderiza√ß√£o; somente RenderObjectElement e seus descendentes s√£o necess√°rios para fazer isso; no entanto, nesse caso, um elemento em algum n√≠vel de aninhamento deve ter um elemento filho que possui um objeto de renderiza√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece porque todas essas dificuldades. At√© tr√™s √°rvores, diferentes √°reas de responsabilidade, etc. A resposta √© bastante simples - √© aqui que o desempenho do Flutter √© constru√≠do. Os widgets s√£o configura√ß√µes imut√°veis; portanto, s√£o frequentemente recriados, mas ao mesmo tempo s√£o bastante leves, o que n√£o afeta o desempenho. Mas Flutter est√° tentando reutilizar elementos pesados ‚Äã‚Äão m√°ximo poss√≠vel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere um exemplo. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texto no meio da tela. O c√≥digo neste caso ser√° mais ou menos assim:</font></font></i><br>
<br>
<pre><code class="javascript hljs">body: Center(<font></font>
    child: Text(‚ÄúHello world!‚Äù)<font></font>
),</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, a √°rvore de widgets ficar√° assim: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lc/wt/fa/lcwtfazdhkpaprcu9tqvhssvck4.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois que o Flutter cria as tr√™s √°rvores, obtemos a seguinte imagem: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uc/vx/ph/ucvxphu5r2ds-6_kmoizgyoczo8.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que acontece se mudarmos o texto que vamos exibir? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_u/8b/do/_u8bdowthfzx9jshpbprfnpj1ai.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora temos uma nova √°rvore de widgets. Acima, falamos sobre o m√°ximo poss√≠vel de reutiliza√ß√£o de elementos. D√™ uma olhada no m√©todo da classe Widget, sob o nome falante </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canUpdate</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">static</span> bool canUpdate(Widget oldWidget, Widget newWidget) {
    <span class="hljs-keyword">return</span> oldWidget.runtimeType == newWidget.runtimeType &amp;&amp; oldWidget.key == newWidget.key;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificamos o tipo do widget anterior e o novo, bem como suas chaves. Se eles s√£o iguais, n√£o h√° necessidade de alterar o item. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, antes da atualiza√ß√£o, o primeiro elemento √© o Center, ap√≥s a atualiza√ß√£o, tamb√©m o Center. Ambos n√£o t√™m chaves, uma completa coincid√™ncia. Podemos atualizar o link do item para um novo widget. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/he/tr/s4/hetrs4cgzrimhibqeilfoja5xzi.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, al√©m do tipo e da chave, o widget √© uma descri√ß√£o e configura√ß√£o, e os valores dos par√¢metros necess√°rios para a exibi√ß√£o podem mudar. √â por isso que o elemento, ap√≥s atualizar o link para o widget, deve iniciar atualiza√ß√µes no objeto de renderiza√ß√£o. No caso do Center, nada mudou e continuamos a comparar ainda mais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais uma vez, o tipo e a chave nos dizem que n√£o faz sentido recriar o elemento. O texto √© descendente de StatelessWidget e n√£o possui um objeto de exibi√ß√£o direta.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dp/yy/6m/dpyy6mckv6cddryb0_yu5asy_uy.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V√° para RichText. O widget tamb√©m n√£o mudou seu tipo; n√£o h√° discrep√¢ncias nas chaves. O item atualiza sua associa√ß√£o com o novo widget. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/vh/95/hwvh952jekjwhudyj6czju3hq6a.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A conex√£o √© atualizada, resta apenas atualizar as propriedades. Como resultado, RenderParagraph exibir√° o novo valor de texto. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lv/_p/g-/lv_pg-n6wlmcmlunokumb60nqw0.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E assim que chegar a pr√≥xima etapa do desenho, veremos o resultado que esperamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gra√ßas a esse tipo de trabalho, o Flutter atinge um desempenho t√£o alto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O exemplo acima descreve o caso em que a estrutura do widget em si n√£o foi alterada. Mas o que acontece se a estrutura mudar? O Flutter, √© claro, continuar√° tentando maximizar o uso de objetos existentes, como entendemos a partir da descri√ß√£o do ciclo de vida, mas novos elementos ser√£o criados para todos os novos widgets, e os antigos e mais desnecess√°rios ser√£o exclu√≠dos no final do quadro.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vejamos alguns exemplos. </font><font style="vertical-align: inherit;">E para garantir o que foi dito acima, usamos a ferramenta Android Studio - Flutter Inspector.</font></font><br>
<br>
<pre><code class="javascript hljs">@override<font></font>
Wid<span class="hljs-keyword">get</span> <span class="hljs-title">build</span>(<span class="hljs-params">BuildContext context</span>) {
    <span class="hljs-keyword">return</span> Scaffold(<font></font>
        body: Center(<font></font>
            child: _isFirst ? first() : second(),<font></font>
        ),<font></font>
        <span class="hljs-attr">floatingActionButton</span>: FloatingActionButton(<font></font>
            child: Text(<span class="hljs-string">"Switch"</span>),
            <span class="hljs-attr">onPressed</span>: () {<font></font>
                setState(() {<font></font>
                    _isFirst = !_isFirst;<font></font>
                });<font></font>
            },<font></font>
        ),<font></font>
    );<font></font>
}<font></font>
<font></font>
Wid<span class="hljs-keyword">get</span> <span class="hljs-title">first</span>() =&gt; <span class="hljs-title">Row</span>(<span class="hljs-params">
    mainAxisAlignment: MainAxisAlignment.center,
    children: &lt;Widget&gt;[
        Text(
            <span class="hljs-string">"test"</span>,
            style: TextStyle(fontSize: <span class="hljs-number">25</span></span>),<font></font>
        ),<font></font>
        <span class="hljs-title">SizedBox</span>(<span class="hljs-params">
            width: <span class="hljs-number">5</span>,
        </span>),
        <span class="hljs-title">Icon</span>(<span class="hljs-params">
            Icons.error,
        </span>),<font></font>
    ],<font></font>
);<font></font>
<font></font>
<span class="hljs-title">Widget</span> <span class="hljs-title">second</span>() =&gt; <span class="hljs-title">Row</span>(<span class="hljs-params">
    mainAxisAlignment: MainAxisAlignment.center,
    children: &lt;Widget&gt;[
        Text(
            <span class="hljs-string">"one more test"</span>,
            style: TextStyle(fontSize: <span class="hljs-number">25</span></span>),<font></font>
        ),<font></font>
        <span class="hljs-title">Padding</span>(<span class="hljs-params">
            padding: EdgeInsets.only(left: <span class="hljs-number">5</span></span>),<font></font>
        ),<font></font>
        <span class="hljs-title">Icon</span>(<span class="hljs-params">
            Icons.error,
        </span>),<font></font>
    ],<font></font>
);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, clicando no bot√£o, um dos widgets ser√° alterado. </font><font style="vertical-align: inherit;">Vamos ver o que o inspetor nos mostra. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wi/vt/vt/wivtvtojhv4uq3l7ouoje3le-u0.png" alt="imagem"><br>
<br>
<img src="https://habrastorage.org/webt/f4/rb/0a/f4rb0avn7pombux2ct6pkap2edi.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como podemos ver, Flutter recriou a renderiza√ß√£o apenas para Padding, o restante foi reutilizado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere mais uma op√ß√£o na qual a estrutura muda de maneira mais global - alteramos os n√≠veis de aninhamento.</font></font><br>
<br>
<pre><code class="javascript hljs">Wid<span class="hljs-keyword">get</span> <span class="hljs-title">second</span>() =&gt; <span class="hljs-title">Container</span>(<span class="hljs-params">child: first(</span>),);</code></pre><br>
<img src="https://habrastorage.org/webt/yt/8i/gs/yt8igsxt3r3b-ofhkrlcyjaqryc.png" alt="imagem"><br>
<br>
<img src="https://habrastorage.org/webt/j7/na/qw/j7naqwq6060sh-tw_atxna_umpa.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apesar do fato de a √°rvore n√£o ter mudado visualmente, os elementos e objetos da √°rvore de renderiza√ß√£o foram recriados. </font><font style="vertical-align: inherit;">Isso aconteceu porque o Flutter se compara por n√≠vel (nesse caso, n√£o importa que a maior parte da √°rvore n√£o tenha sido alterada). A peneira√ß√£o dessa parte ocorreu no momento da compara√ß√£o entre Container e Row. </font><font style="vertical-align: inherit;">No entanto, pode-se sair dessa situa√ß√£o. </font><font style="vertical-align: inherit;">Isso nos ajudar√° a GlobalKey. </font><font style="vertical-align: inherit;">Adicione uma chave para Row.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> _key = GlobalKey(debugLabel: <span class="hljs-string">"testLabel"</span>);<font></font>
<font></font>
Wid<span class="hljs-keyword">get</span> <span class="hljs-title">first</span>() =&gt; <span class="hljs-title">Row</span>(<span class="hljs-params">
    key: _key,
    ‚Ä¶
</span>);</code></pre><br>
<img src="https://habrastorage.org/webt/gg/jp/zj/ggjpzjlpox-ijhgtwxy-i6rvcsk.png" alt="imagem"><br>
<br>
<img src="https://habrastorage.org/webt/zy/br/zy/zybrzywy-_ixs_apl7j1fiqsrco.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim que dissemos a Flutter que a pe√ßa poderia ser reutilizada, ele aproveitou a oportunidade.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s nos familiarizamos um pouco mais com a magia do Flutter e agora sabemos que ela n√£o √© apenas em widgets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Flutter √© um mecanismo bem coordenado e bem planejado, com sua pr√≥pria hierarquia, √°reas de responsabilidade, com as quais voc√™ pode criar aplicativos n√£o apenas bonitos, mas tamb√©m produtivos. </font><font style="vertical-align: inherit;">Obviamente, examinamos apenas uma parte pequena, embora bastante importante de seu dispositivo, e continuaremos analisando v√°rios aspectos do funcionamento interno da estrutura em artigos futuros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que as informa√ß√µes neste artigo sejam √∫teis para entender como o Flutter funciona internamente e ajuda a encontrar solu√ß√µes elegantes e produtivas durante o desenvolvimento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obrigado pela aten√ß√£o!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recursos</font></font></h4><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flutter </font></font></i><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Como Flutter renderiza Widgets", de Andrew Fitz Gibbon, Matt Sullivan</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt501848/index.html">Eu explico a reserva no data center sobre cerveja</a></li>
<li><a href="../pt501854/index.html">Como sair da programa√ß√£o e come√ßar a executar</a></li>
<li><a href="../pt501856/index.html">Tarantool: olhar do analista</a></li>
<li><a href="../pt501858/index.html">Colocando todos os pontos no "psi"</a></li>
<li><a href="../pt501860/index.html">15 de maio O RU-Center pode adicionar um servi√ßo pago sem a sua participa√ß√£o</a></li>
<li><a href="../pt501864/index.html">Assistente ou inspetor: para quem o rob√¥ est√° ligando?</a></li>
<li><a href="../pt501866/index.html">Quantos empregos os rob√¥s destruir√£o</a></li>
<li><a href="../pt501868/index.html">Como n√£o deixar o contador se jogar ou Transferimos 1C para a nuvem. Instru√ß√µes passo a passo</a></li>
<li><a href="../pt501870/index.html">N√∫mero m√°ximo de valores em enumera√ß√£o, parte II</a></li>
<li><a href="../pt501872/index.html">Lugar de estudo em sistemas cibern√©ticos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>