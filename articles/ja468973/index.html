<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😳 🥑 🔹 PythonでTensorflowを使用して衛星画像を分類するためのニューラルネットワーク 🕚 ⌚️ 🦅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="これは、Landsat 5衛星からのマルチスペクトル画像を分類するための段階的な手順です。今日、多くの分野で、ディープラーニングが地理空間の問題を含む複雑な問題を解決するためのツールとして支配しています。衛星画像のデータセット、特にLandsat 5 TMに精通していることを願っています。機械学習ア...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PythonでTensorflowを使用して衛星画像を分類するためのニューラルネットワーク</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/468973/"><img src="https://habrastorage.org/webt/uq/qc/uz/uqqcuz2dhxwps1cueikg6ceigja.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、Landsat 5衛星からのマルチスペクトル画像を分類するための段階的な手順です。今日、多くの分野で、ディープラーニングが地理空間の問題を含む複雑な問題を解決するためのツールとして支配しています。衛星画像のデータセット、特にLandsat 5 TMに精通していることを願っています。機械学習アルゴリズムに少し慣れている場合は、このマニュアルをすばやく学習するのに役立ちます。そして、理解していない人にとっては、実際には、機械学習はオブジェクトの他のプロパティ（値またはラベル、ターゲット変数Y）を持つオブジェクトのいくつかの特性（属性Xのセット）間の関係を確立することで構成されることを知っていれば十分でしょう。オブジェクトのターゲットインジケーター/クラス（ラベル付きデータ）の特性と値が既知である多くのオブジェクトをモデルにフィードし、それをトレーニングします新しいデータ（未割り当て）のターゲット変数Yの値を予測できるようにします。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
衛星画像の主な問題は何ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
衛星画像内の2つ以上のクラスのオブジェクト（たとえば、建物、空き地、基礎ピット）は、同じ値のスペクトル特性を持つ可能性があるため、過去20年間、それらの分類は困難な作業でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このため、教師の有無にかかわらず従来の機械学習モデルを使用することは可能ですが、その品質は理想とはほど遠いものになります。それらには常に同じ欠点があります。例を考えてみましょう：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/15b/16c/5b7/15b16c5b76906f81f27374daa8558806.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
垂直線を分類子として使用してX軸に沿って移動すると、家の画像の分類が容易になりません。データは、1つの縦線を使用してそれらをクラスに分離することが不可能であるように分散されます（このような場合、「異なるクラスのオブジェクトは線形的に分離できない」と言われます）。しかし、これは家をまったく分類できないという意味ではありません！</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc4/ea7/7a0/cc4ea77a0f9f4713ea6a49b7885d31c2.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
赤い線を使用して2つのクラスを分離しましょう。この場合、分類器はほとんどの家を識別しましたが、1つの家がそのクラスに割り当てられておらず、誤って「家」にさらに3本の木が割り当てられていました。 1つの家を見逃さないようにするために、青い線の形で分類子を使用できます。その後、すべてが自宅でカバーされます。つまり、リコールメトリック（充足度）が高いと言えます。ただし、すべての分類された値が住宅であることが判明したわけではありません。つまり、精度メトリックの低い値が同時に得られました。緑の線を使用すると、家として分類されたすべての画像は実際に家になります。つまり、分類器は高い精度を示します。この場合、3つの家が考慮されないため、満杯度は低くなります。ほとんどの場合、正確さと完全性の間の妥協点を見つける必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この家と木の問題は、建物、空き地、ピットの問題に似ています。</font><font style="vertical-align: inherit;">衛星画像分類指標の優先度は、タスクによって異なる場合があります。</font><font style="vertical-align: inherit;">たとえば、すべての構築された領域が例外なく建物として分類されることを確認する必要があり、同様にシグネチャを持つ他のクラスのピクセルの存在に耐える準備ができている場合、これも建物として分類されるため、完全性の高いモデルが必要です。</font><font style="vertical-align: inherit;">また、他のクラスのピクセルを追加せずに建物を分類することがより重要であり、混合地域の分類を放棄する準備ができている場合は、高精度の分類子を選択します。</font><font style="vertical-align: inherit;">家や木の場合、通常のモデルは赤い線を使用し、正確さと完全性のバランスを維持します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用したデータ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
兆候として、Landsat 5 TMからの画像の6つの範囲（バンド2-バンド7）の値を使用し、バイナリ開発クラスの予測を試みます。</font><font style="vertical-align: inherit;">トレーニングとテストには、バンガロールの2011年のランドサット5を使用したマルチスペクトルデータ（画像とバイナリビルディングクラスのレイヤー）が使用されます。</font><font style="vertical-align: inherit;">予測には、ハイデラバードで2005年に取得されたマルチスペクトルLandsat 5データが使用されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
教えるためにタグ付きデータを使用するので、これを教師とのティーチングと呼びます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c4/nx/71/c4nx71fzbix6rhp4fb1-ofdupjm.jpeg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチスペクトルトレーニングデータと、対応する開発後のバイナリレイヤー。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニューラルネットワークを作成するには、Python — Google Tensorflowライブラリを使用します。</font><font style="vertical-align: inherit;">これらのライブラリも必要です。</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyrsgis</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -GeoTIFFの読み書き用。</font></font><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn-</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データの前処理と精度評価用。</font></font><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">numpy-</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列を使用した基本的な操作用。</font></font><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、さっそくコードを書きましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つのファイルすべてをディレクトリに配置し、入力ファイルのパスと名前をスクリプトに書き込んでから、GeoTIFFファイルを読み取ります。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> pyrsgis <span class="hljs-keyword">import</span> raster<font></font>
<font></font>
os.chdir(<span class="hljs-string">"E:\\yourDirectoryName"</span>)<font></font>
mxBangalore = <span class="hljs-string">'l5_Bangalore2011_raw.tif'</span>
builtupBangalore = <span class="hljs-string">'l5_Bangalore2011_builtup.tif'</span>
mxHyderabad = <span class="hljs-string">'l5_Hyderabad2011_raw.tif'</span><font></font>
<font></font>
<span class="hljs-comment"># Read the rasters as array</span>
ds1, featuresBangalore = raster.read(mxBangalore, bands=<span class="hljs-string">'all'</span>)<font></font>
ds2, labelBangalore = raster.read(builtupBangalore, bands=<span class="hljs-number">1</span>)<font></font>
ds3, featuresHyderabad = raster.read(mxHyderabad, bands=<span class="hljs-string">'all'</span>)</code></pre><br><font style="vertical-align: inherit;"></font><code>raster</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージ</font><font style="vertical-align: inherit;">
のモジュール</font><font style="vertical-align: inherit;">は、</font></font><code>pyrsgis</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GeoTIFFジオロケーションデータとデジタル番号（DN）値を個別のNumPy配列として読み取ります。</font><font style="vertical-align: inherit;">詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読み込んだデータのサイズを表示します。</font></font><br>
<br>
<pre><code class="python hljs">print(<span class="hljs-string">"Bangalore multispectral image shape: "</span>, featuresBangalore.shape)<font></font>
print(<span class="hljs-string">"Bangalore binary built-up image shape: "</span>, labelBangalore.shape)<font></font>
print(<span class="hljs-string">"Hyderabad multispectral image shape: "</span>, featuresHyderabad.shape)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果：</font></font><br>
<br>
<pre><code class="python hljs">Bangalore multispectral image shape: <span class="hljs-number">6</span>, <span class="hljs-number">2054</span>, <span class="hljs-number">2044</span>
Bangalore binary built-up image shape: <span class="hljs-number">2054</span>, <span class="hljs-number">2044</span>
Hyderabad multispectral image shape: <span class="hljs-number">6</span>, <span class="hljs-number">1318</span>, <span class="hljs-number">1056</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、バンガロールの画像の行と列の数は、バイナリレイヤー（建物に対応）と同じです。</font><font style="vertical-align: inherit;">バンガロールとハイデラバードのマルチスペクトル画像のレイヤー数も一致しています。</font><font style="vertical-align: inherit;">モデルは、6つのスペクトルすべての対応する値に基づいて、建物に属するピクセルとそうでないピクセルを決定する方法を学習します。</font><font style="vertical-align: inherit;">したがって、マルチスペクトル画像は、同じ数の特徴（範囲）を同じ順序でリストする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、配列を2次元に変換します。各行は個別のピクセルを表します。これは、ほとんどの機械学習アルゴリズムの動作に必要であるためです。</font><font style="vertical-align: inherit;">これ</font></font><code>convert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、パッケージ</font><font style="vertical-align: inherit;">のモジュールを使用して</font><font style="vertical-align: inherit;">行います</font></font><code>pyrsgis</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d69/176/b91/d69176b91e9758291e1faae6c25486e5.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ再構築スキーム。</font></font></i><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> pyrsgis.convert <span class="hljs-keyword">import</span> changeDimension<font></font>
<font></font>
featuresBangalore = changeDimension(featuresBangalore)<font></font>
labelBangalore = changeDimension (labelBangalore)<font></font>
featuresHyderabad = changeDimension(featuresHyderabad)<font></font>
nBands = featuresBangalore.shape[<span class="hljs-number">1</span>]<font></font>
labelBangalore = (labelBangalore == <span class="hljs-number">1</span>).astype(int)<font></font>
<font></font>
print(<span class="hljs-string">"Bangalore multispectral image shape: "</span>, featuresBangalore.shape)<font></font>
print(<span class="hljs-string">"Bangalore binary built-up image shape: "</span>, labelBangalore.shape)<font></font>
print(<span class="hljs-string">"Hyderabad multispectral image shape: "</span>, featuresHyderabad.shape)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果：</font></font><br>
<br>
<pre><code class="python hljs">Bangalore multispectral image shape: <span class="hljs-number">4198376</span>, <span class="hljs-number">6</span>
Bangalore binary built-up image shape: <span class="hljs-number">4198376</span>
Hyderabad multispectral image shape: <span class="hljs-number">1391808</span>, <span class="hljs-number">6</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7行目では、値1のすべてのピクセルを抽出しました。これにより、非常に高い値または低い値を持つことが多い情報のないピクセル（NoData）の問題を回避できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、データをトレーニングサンプルと検証サンプルに分割します。</font><font style="vertical-align: inherit;">これは、モデルがテストデータを表示せず、新しい情報で正しく機能するために必要です。</font><font style="vertical-align: inherit;">それ以外の場合、モデルは再トレーニングされ、トレーニングデータでのみ正常に機能します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
<font></font>
xTrain, xTest, yTrain, yTest = train_test_split(featuresBangalore, labelBangalore, test_size=<span class="hljs-number">0.4</span>, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
print(xTrain.shape)<font></font>
print(yTrain.shape)<font></font>
<font></font>
print(xTest.shape)<font></font>
print(yTest.shape)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果：</font></font><br>
<br>
<pre><code class="python hljs">(<span class="hljs-number">2519025</span>, <span class="hljs-number">6</span>)<font></font>
(<span class="hljs-number">2519025</span>,)<font></font>
(<span class="hljs-number">1679351</span>, <span class="hljs-number">6</span>)<font></font>
(<span class="hljs-number">1679351</span>,)<font></font>
test_size=<span class="hljs-number">0.4</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 データが60/40の比率でトレーニングと検証に分割されることを意味します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニューラルネットワークを含む多くの機械学習アルゴリズムは、正規化されたデータを必要とします。つまり、それらは特定の範囲（この場合は0から1）内に分布している必要があります。したがって、この要件を満たすために、症状を正規化します。これは、最小値を抽出し、それをスプレッド（最大値と最小値の差）で割ることで実行できます。ランドサットデータセットは8ビットであるため、最小値と最大値は、0と255（2あろう</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⁸</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 256の値）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正規化のためには、データに基づいて最小値と最大値を計算する方が常に良いことに注意してください。</font><font style="vertical-align: inherit;">タスクを簡略化するために、デフォルトでは8ビットの範囲に従います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
予備処理の別の段階は、属性のマトリックスを2次元から3次元に変換することです。これにより、モデルは各行を個別のピクセル（個別の学習オブジェクト）として認識します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/965/d0f/aa8/965d0faa8e8c7b4787c10823cf038d20.jpg"><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># Normalise the data</span>
xTrain = xTrain / <span class="hljs-number">255.0</span>
xTest = xTest / <span class="hljs-number">255.0</span>
featuresHyderabad = featuresHyderabad / <span class="hljs-number">255.0</span><font></font>
<font></font>
<span class="hljs-comment"># Reshape the data</span>
xTrain = xTrain.reshape((xTrain.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>, xTrain.shape[<span class="hljs-number">1</span>]))<font></font>
xTest = xTest.reshape((xTest.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>, xTest.shape[<span class="hljs-number">1</span>]))<font></font>
featuresHyderabad = featuresHyderabad.reshape((featuresHyderabad.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>, featuresHyderabad.shape[<span class="hljs-number">1</span>]))<font></font>
<font></font>
<span class="hljs-comment"># Print the shape of reshaped data</span>
print(xTrain.shape, xTest.shape, featuresHyderabad.shape)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果：</font></font><br>
<br>
<pre><code class="python hljs">(<span class="hljs-number">2519025</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>) (<span class="hljs-number">1679351</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>) (<span class="hljs-number">1391808</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての準備ができたら、モデルを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ケラスで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み立てましょう</font><font style="vertical-align: inherit;">。はじめに、順次モデルを使用して、次々にレイヤーを追加します。ノードの数が範囲の数（</font></font><code>nBands</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に</font><font style="vertical-align: inherit;">等しい1つの入力レイヤーがあり</font><font style="vertical-align: inherit;">、この場合は6つあります。14個のノードとアクティベーション関数を持つ1つの非表示レイヤーも使用します</font></font><code>ReLu</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。最後の層は</font></font><code>softmax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、分類された結果を出力するのに適し</font><font style="vertical-align: inherit;">たアクティベーション関数</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">持つバイナリ構築クラスを定義するための2つのノードで構成され</font><font style="vertical-align: inherit;">ています。アクティベーション機能について詳しくは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras<font></font>
<font></font>
<span class="hljs-comment"># Define the parameters of the model</span><font></font>
model = keras.Sequential([<font></font>
    keras.layers.Flatten(input_shape=(<span class="hljs-number">1</span>, nBands)),<font></font>
    keras.layers.Dense(<span class="hljs-number">14</span>, activation=<span class="hljs-string">'relu'</span>),<font></font>
    keras.layers.Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">'softmax'</span>)])<font></font>
<font></font>
<span class="hljs-comment"># Define the accuracy metrics and parameters</span>
model.compile(optimizer=<span class="hljs-string">"adam"</span>, loss=<span class="hljs-string">"sparse_categorical_crossentropy"</span>, metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># Run the model</span>
model.fit(xTrain, yTrain, epochs=<span class="hljs-number">2</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/d8a/9cd/5ec/d8a9cd5ec53c57d671d77b0c46bfb17e.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニューラルネットワークアーキテクチャ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
10行目で述べたように、</font></font><code>adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルをオプティマイザとして</font><font style="vertical-align: inherit;">設定し</font><font style="vertical-align: inherit;">ます（他にもいくつかあり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。この場合、クロスエントロピーを損失関数として使用します（en。- </font></font><code>categorical-sparse-crossentropy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記載されてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">）。モデルの品質を評価するために、メトリックを使用します</font></font><code>accuracy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、との2つの時代（または反復）のモデルのトレーニングを開始</font></font><code>xTrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し</font></font><code>yTrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。データのサイズと処理能力に応じて、これにはしばらく時間がかかります。コンパイル後の表示は次のとおり</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/dfa/3fc/c47/dfa3fcc47572b2fd20c5252ba4da1e50.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。個別に保存する検証データの値を予測して、さまざまな精度メトリックを計算してみましょう。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix, precision_score, recall_score<font></font>
<font></font>
<span class="hljs-comment"># Predict for test data </span><font></font>
yTestPredicted = model.predict(xTest)<font></font>
yTestPredicted = yTestPredicted[:,<span class="hljs-number">1</span>]<font></font>
<font></font>
<span class="hljs-comment"># Calculate and display the error metrics</span>
yTestPredicted = (yTestPredicted&gt;<span class="hljs-number">0.5</span>).astype(int)<font></font>
cMatrix = confusion_matrix(yTest, yTestPredicted)<font></font>
pScore = precision_score(yTest, yTestPredicted)<font></font>
rScore = recall_score(yTest, yTestPredicted)<font></font>
<font></font>
print(<span class="hljs-string">"Confusion matrix: for 14 nodes\n"</span>, cMatrix)<font></font>
print(<span class="hljs-string">"\nP-Score: %.3f, R-Score: %.3f"</span> % (pScore, rScore))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数</font></font><code>softmax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、クラスごとに確率値の個別の列を生成します。上記のコードの6行目からわかるように、最初のクラス（「建物がある」）の値のみを使用します。地理空間分析モデルの作業を評価することは、機械学習の他の古典的な問題とは異なり、それほど単純ではありません。一般化された合計エラーに依存するのは不公平です。モデルを成功させる鍵は、空間レイアウトです。したがって、誤差行列（混同行列）、精度、完全性により、モデルの品質をより正確に把握できます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/399/3d8/bf3/3993d8bf36a5f4165b60f39e36e5c566.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、コンソールにはエラーマトリックス、精度、完全性が表示されます。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
混同行列からわかるように、建物に関連する何千ものピクセルがありますが、分類は異なり、逆も同様です。ただし、合計データ量に対するそれらのシェアはそれほど大きくありません。テストデータの正確性と完全性がしきい値0.8を超えました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より多くの時間をかけ、いくつかの反復を実行して、最適な非表示レイヤーの数、各非表示レイヤーのノードの数、および必要な精度を達成するための元号の数を見つけることができます。必要に応じて、NDBIやNDWIなどのリモートセンシングインデックスを機能として使用できます。目的の精度を達成したら、モデルを使用して新しいデータに基づいて開発を予測し、結果をGeoTIFFにエクスポートします。そのようなタスクには、小さな変更を加えた同様のモデルを使用できます。</font></font><br>
<br>
<pre><code class="python hljs">predicted = model.predict(feature2005)<font></font>
predicted = predicted[:,<span class="hljs-number">1</span>]<font></font>
<font></font>
<span class="hljs-comment">#Export raster</span><font></font>
prediction = np.reshape(predicted, (ds.RasterYSize, ds.RasterXSize))<font></font>
outFile = <span class="hljs-string">'Hyderabad_2011_BuiltupNN_predicted.tif'</span>
raster.export(prediction, ds3, filename=outFile, dtype=<span class="hljs-string">'float'</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GeoTIFFは、しきい値2値化バージョンではなく、予測確率値とともにエクスポートされることに注意してください。後でGIS環境で、下の図に示すように、フロートタイプのレイヤーのしきい値を設定できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sk/ka/kz/skkakzxokrbkvrgulcvm0vkuwua.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチスペクトルデータに基づくモデルによって予測されたハイデラバードビルドアップレイヤー。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
モデルの精度はすでに正確に再現されています。また、新しい予測レイヤーで従来のチェック（たとえば、カッパ係数を使用）を実行することもできます。衛星画像の分類に関する前述の困難に加えて、他の明らかな制限には、それらが異なるスペクトルシグネチャを持っているため、年間の異なる時間および異なる地域で撮影された画像に基づく予測の不可能性が含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事で説明するモデルは、ニューラルネットワークのアーキテクチャが最も単純です。</font><font style="vertical-align: inherit;">畳み込みニューラルネットワークなどのより複雑なモデルを使用すると、より良い結果を得ることができます。</font><font style="vertical-align: inherit;">このような分類の主な利点は、モデルのトレーニング後のスケーラビリティ（適用性）です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用したデータとすべてのコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468961/index.html">560ドルで生活の中のルーチンを取り除く方法は？または生きる方法ではなく、生きる方法</a></li>
<li><a href="../ja468963/index.html">バックアップ、読者のリクエストに応じて一部：UrBackupの概要、BackupPC、AMANDA</a></li>
<li><a href="../ja468967/index.html">TAUの動的方程式を得る「技術」。そして、なぜシステム識別は厄介であり、「正直な物理学」が支配するのか</a></li>
<li><a href="../ja468969/index.html">APIを介してPowerShellからGoogleユーザーを作成する</a></li>
<li><a href="../ja468971/index.html">ニンテンドーDS用のJavaで書く</a></li>
<li><a href="../ja468989/index.html">UEBAマーケットダイ-ロングライブUEBA</a></li>
<li><a href="../ja468991/index.html">モジュラースプライトキャラクターとそのアニメーション</a></li>
<li><a href="../ja468993/index.html">Oculus QuestがPCに接続し、手を見る</a></li>
<li><a href="../ja468995/index.html">オープン性ポリシー：ユーザーがプロジェクトに与える影響</a></li>
<li><a href="../ja468997/index.html">メンタリング-必須または素晴らしいボーナス？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>