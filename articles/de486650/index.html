<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤“ ğŸ•ºğŸ½ ğŸˆšï¸ Dynamischer Speicher in harten Echtzeitsystemen ğŸ‘©ğŸ¾â€âš•ï¸ ğŸ‘¨ğŸ¼â€ğŸ¨ ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt eine Klasse von Echtzeitanwendungen, fÃ¼r die es schwierig ist, den Bedarf an Speicherzuweisung zur Laufzeit statisch vorherzusagen. Diese Klas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Dynamischer Speicher in harten Echtzeitsystemen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486650/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt eine Klasse von Echtzeitanwendungen, fÃ¼r die es schwierig ist, den Bedarf an Speicherzuweisung zur Laufzeit statisch vorherzusagen. Diese Klasse umfasst beispielsweise eingebettete Implementierungen der Stapel einiger Kommunikationsprotokolle, bei denen das Verhalten und die Verteilung von Ressourcen teilweise durch die AktivitÃ¤t anderer Agenten im Netzwerk bestimmt werden. Der klassische Ansatz in solchen FÃ¤llen besteht darin, Blockspeichermanager zu verwenden, die Fragmente fester GrÃ¶ÃŸe zuweisen (wie dies beispielsweise in LwIP geschehen ist). Dieser Ansatz fÃ¼hrt zu unerwÃ¼nschten Funktions- und QualitÃ¤tsbeschrÃ¤nkungen bei der Implementierung. In diesem Artikel schlage ich den Standpunkt vor, dass traditionelle (nicht blockige) Allokatoren zu Unrecht der Aufmerksamkeit von Entwicklern von Echtzeitsystemen beraubt werden. Ich teile meine Gedanken zu relevanten Themen, ich beschwere mich Ã¼ber das Leben.und ich schlage vor, die Situation zu verbessern.</font></font></p><br>
<p><img src="https://habrastorage.org/webt/b3/f0/m9/b3f0m9w5_y6qdzhbm98vo_zai34.png" title="Heap-GrÃ¶ÃŸe (H) als Funktion des Spitzenbedarfs der Anwendung im dynamischen Speicher (M) und der maximalen GrÃ¶ÃŸe des zugewiesenen Fragments (n)"><br>
<em>( â€“ .     )</em></p><a name="habracut"></a><br>
<p>                ,    . ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">  FreeRTOS</a>        <em>O(1)</em>,    ,  <em>O(n)</em>   .       ChibiOS (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">1</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">2</a>). , ,          ; ,       .           ,      .</p><br>
<p>         ,         ,   ,         (   ,        ).     :       <em>O(log n)</em>    ,  <del>   </del>    <em>O(n)</em>,       .</p><br>
<p>     .    , ,      ,         .              ,        .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">  NuttX</a>,       (best fit),                 .         .</p><br>
<p>             ,               ,   , ,  ,    .</p><br>
<p>       .           ,  ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">  </a>           API  ,        .  ,  ,          :</p><br>
<pre><code class="plaintext hljs">//     :<font></font>
struct FragmentedBuffer<font></font>
{<font></font>
    struct FragmentedBuffer* next;<font></font>
    uint8_t data[];<font></font>
};<font></font>
<font></font>
// ... :<font></font>
uint8_t* data;</code></pre><br>
<p>      ,        Buddy Allocator, Half-Fit,  Two-Level Segregated Fit (TLSF).          O(1) ( Buddy Allocator   ,    ,      ).   J. Herter  J. Robson     â€“  ,    â€“     â€œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Timing-Predictable Memory Allocation In Hard Real-Time Systems</a>â€   â€œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Worst case fragmentation of first fit and best fit storage allocation strategies</a>â€, .</p><br>
<p>               .      .    ,     ,          (    -    )   .           26â€“33   ,       ,     H,     ,       :</p><br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>H</mi><mo>=</mo><mn>2</mn><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2308;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;></mrow><msub><mi>log</mi><mn>2</mn></msub><mo>&amp;#x2061;</mo><mi>n</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2309;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.839ex" height="2.634ex" viewBox="0 -809.3 9833.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMATHI-48" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-3D" x="1166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-32" x="2222" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMATHI-4D" x="2723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-28" x="3774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-31" x="4164" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-2B" x="4886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-2308" x="5887" y="0"></use><g transform="translate(6498,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-67" x="779" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-32" x="1809" y="-343"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMATHI-6E" x="8398" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-2309" x="8999" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/486650/&amp;usg=ALkJrhjiscZmpb1Ivpo525DJbqrGO9GqRQ#MJMAIN-29" x="9443" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H.</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></mo><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></mn><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M.</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></mo><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></mn><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></mo><mo fence="false" stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">âŒˆ</font></font></mo><mrow class="MJX-TeXAtom-ORD"></mrow><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Log</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></mn></msub><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â¡</font></font></mo><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></mi><mo fence="false" stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">âŒ‰</font></font></mo><mrow class="MJX-TeXAtom-ORD"></mrow><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">H = 2 M (1 + \lceil{}\log_2 n\rceil{})</script></p><br>
<p> M â€“      , n â€“   .</p><br>
<p>            .   ,        ,          .        ,         H = M (n â€” 2),        .</p><br>
<p>   ,     ,      ()     ,    .              , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">     StackOverflow</a>,     ,      .    (500   C99/C11),          ,      .</p><br>
<p><strong> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">https://github.com/pavel-kirienko/o1heap</a>.</strong></p><br>
<p>       ,                .  ,      ,   ,         .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">    </a>;      ,   :</p><br>
<ul>
<li> :   H [KiB]       M [KiB]    n [KiB]     16 .</li>
<li> : ,    MiB.</li>
</ul><br>
<p>  H  ,  ,         .                  .           H,   ,     ,      .       H             ,          . ,          .        (Embox?),          .</p><br>
<p>           .         NuttX   ,  ,     : <em>"I considered porting TLSF at one point, but overall it's low on my list of NuttX improvements I'd explore if I actually had time"</em>.   .</p></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de486638/index.html">Blazor WebAssembly 3.2.0 Preview 1 ist jetzt verfÃ¼gbar</a></li>
<li><a href="../de486640/index.html">Die Zusammenfassung interessanter Materialien fÃ¼r den mobilen Entwickler # 331 (27. Januar - 2. Februar)</a></li>
<li><a href="../de486644/index.html">DIY Antenne in 5 Minuten</a></li>
<li><a href="../de486646/index.html">Geh weg von jQuery nach Svelte, ohne Schmerzen</a></li>
<li><a href="../de486648/index.html">AWS Lambda in Aktion in Java 11. Serverlos in die Produktion gehen</a></li>
<li><a href="../de486652/index.html">"Kritik der reinen Vernunft" fÃ¼r Programmierer</a></li>
<li><a href="../de486654/index.html">Bewegungssensor und Alarm- und Videoregistrierungsverbindung im Home Assistant auf Raspberry pi</a></li>
<li><a href="../de486656/index.html">So fÃ¼gen Sie Unicode neue Charaktere hinzu: die Erfahrung des Laien</a></li>
<li><a href="../de486658/index.html">Moxy Strategie Plugin</a></li>
<li><a href="../de486660/index.html">Ideen vom Tisch: Metro Raumanzug</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>