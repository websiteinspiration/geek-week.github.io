<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚛 🆚 👩🏻‍🤝‍👨🏿 ROSトラックトロリー。パート5. rvizおよびgazeboでの作業：xacro、新しいセンサー 🛠️ 🆗 ▶️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="シリーズの投稿：
 8. ROS制御電話、GPSノードから制御します
 。7.ロボットのローカライズ：マッピング、AMCL、ルームマップ上の基準点
 6.ホイールエンコーダー、ルームマップ、ライダーによる
 オドメトリ5. rvizとガゼボで作業します：xacro、新しいセンサー。 
 4. rvi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ROSトラックトロリー。パート5. rvizおよびgazeboでの作業：xacro、新しいセンサー</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467665/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シリーズの投稿：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. ROS制御電話、GPSノードから制御します</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。7.ロボットのローカライズ：マッピング、AMCL、ルームマップ上の基準点</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.ホイールエンコーダー、ルームマップ、ライダーによる</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オドメトリ5. rvizとガゼボで作業します：xacro、新しいセンサー。</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. rvizおよびgazeboエディターを使用してロボットシミュレーションを作成します。</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.加速、カメラの変更、歩行の修正</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.ソフトウェア</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.アイロン</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
前回、次の目標が達成されました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロボットのurdf-descriptionを含むxacroファイルを作成して、ロボットを視覚化します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの起動ファイルを作成します。その1つを使用して、ロボットをエディターシミュレータGazeboに配置できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーボードからGazeboシミュレーターのロボットを制御します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 この投稿では、より読みやすくなるようにプロジェクトをxacroモジュールの形式で配置します（以前は、明確にするために、説明全体を1つのxacroファイルにプッシュしました）。</font><font style="vertical-align: inherit;">仮想ビデオカメラとimuを追加します。</font><font style="vertical-align: inherit;">ガゼボを異物に追加する方法を見てみましょう。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、roscdコマンドを使用して、端末がROSシステムを介したローミングで動作するかどうかを確認します。</font></font><br>
<br>
<pre><code class="plaintext hljs">roscd rosbots_description/launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機能しない場合は、catkin_wsのあるフォルダーに移動して、次のコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">source devel/setup.bash</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ロボットの説明があるフォルダーに移動します。</font></font><br>
<br>
<pre><code class="plaintext hljs">roscd rosbots_description/launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前に作成されたspawn.launchファイルでは、次のことが示されていました。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"robot_description"</span> <span class="hljs-attr">command</span>=<span class="hljs-string">"cat '$(find rosbots_description)/urdf/rosbots.xacro'"</span> /&gt;</span></code></pre><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コマンドを使用</font><font style="vertical-align: inherit;">して、rosbots.xacroの内容をrobot_descriptionパラメーターにロードしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
xacroコマンド形式を最大限に活用するには、コードを少し修正する必要があります。</font><font style="vertical-align: inherit;">上記の行を次の行に置き換えます。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"robot_description"</span> <span class="hljs-attr">command</span>=<span class="hljs-string">"$(find xacro)/xacro.py '$(find rosbots_description)/urdf/rosbots.xacro'"</span> /&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、システムはxacro.pyを使用してrosbots.xacroを実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目の起動ファイルrviz.launchにも同じ変更が必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変化する</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"robot_description"</span> <span class="hljs-attr">command</span>=<span class="hljs-string">"cat '$(find rosbots_description)/urdf/rosbots.xacro'"</span> /&gt;</span></code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
に</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"robot_description"</span> <span class="hljs-attr">command</span>=<span class="hljs-string">"$(find xacro)/xacro.py  '$(find rosbots_description)/urdf/rosbots.xacro'"</span>/&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが新しい構文で機能することを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、rvizエディターでモデルを確認します。</font></font><br>
<br>
<pre><code class="python hljs">roslaunch rosbots_description rviz.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、rvizを閉じて、ガゼボをチェックインします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一ターミナル：</font></font><br>
<br>
<pre><code class="python hljs">roslaunch gazebo_ros empty_world.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目：</font></font><br>
<br>
<pre><code class="python hljs">roslaunch rosbots_description spawn.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*メッセージを見ることができます</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">黄色</font></font></b><div class="spoiler_text"> <br>
<br>
<pre><code class="plaintext hljs">xacro: Traditional processing is deprecated. Switch to --inorder processing!<font></font>
To check for compatibility of your document, use option --check-order.<font></font>
For more infos, see http://wiki.ros.org/xacro#Processing_Order<font></font>
xacro.py is deprecated; please use xacro instead</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
天候に左右されないので気をつけられません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、すべてが以前と同様に機能し、xacro形式が使用されるようになりました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼は何を与えるのですか？</font><font style="vertical-align: inherit;">この形式では、コードを再編成できます。</font><font style="vertical-align: inherit;">プロジェクトが成長するにつれ、これにより将来のナビゲーションが改善されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xacroの操作</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rosbots.xacroを構成要素に分割し、xacroを利用する時が来ました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ガゼボエディタ（gazeboタグ）に関するすべてをrosbots.xacroから新しいファイルに移動します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
urdfフォルダーにrosbots.gazebo.xacroファイルを作成します。</font></font><br>
<br>
<pre><code class="python hljs">nano rosbots.gazebo.xacro</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、コードをそこに置きます：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosbots.gazebo.xacro</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">robot</span> <span class="hljs-attr">xmlns:xacro</span>=<span class="hljs-string">"http://www.ros.org/wiki/xacro"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"rosbots"</span> &gt;</span><font></font>
  <font></font>
  <span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"differential_drive_controller"</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"libgazebo_ros_diff_drive.so"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">legacyMode</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">legacyMode</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">alwaysOn</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">alwaysOn</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">publishWheelTF</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">publishWheelTF</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">publishTf</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">publishTf</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">publishWheelJointState</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">publishWheelJointState</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">updateRate</span>&gt;</span>100.0<span class="hljs-tag">&lt;/<span class="hljs-name">updateRate</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">leftJoint</span>&gt;</span>wheel_left_joint<span class="hljs-tag">&lt;/<span class="hljs-name">leftJoint</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">rightJoint</span>&gt;</span>wheel_right_joint<span class="hljs-tag">&lt;/<span class="hljs-name">rightJoint</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">wheelSeparation</span>&gt;</span>1.1<span class="hljs-tag">&lt;/<span class="hljs-name">wheelSeparation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">wheelDiameter</span>&gt;</span>0.52<span class="hljs-tag">&lt;/<span class="hljs-name">wheelDiameter</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">wheelAcceleration</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">wheelAcceleration</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">torque</span>&gt;</span>20<span class="hljs-tag">&lt;/<span class="hljs-name">torque</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">commandTopic</span>&gt;</span>/part2_cmr/cmd_vel<span class="hljs-tag">&lt;/<span class="hljs-name">commandTopic</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">odometryTopic</span>&gt;</span>odom<span class="hljs-tag">&lt;/<span class="hljs-name">odometryTopic</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">odometryFrame</span>&gt;</span>odom<span class="hljs-tag">&lt;/<span class="hljs-name">odometryFrame</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">robotBaseFrame</span>&gt;</span>base_link<span class="hljs-tag">&lt;/<span class="hljs-name">robotBaseFrame</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">robot</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグ内の同じコード </font></font><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span></code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosbots.xacroファイルから削除します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、新しく作成したファイルをrosbots.xacroにバインドします。</font><font style="vertical-align: inherit;">どこからでも、rosbots.xacroのガゼボコンポーネントに関する同じ情報を受け取る必要があります！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、rosbots.xacroに追加します。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">xacro:include</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"$(find rosbots_description)/urdf/rosbots.gazebo.xacro"</span> /&gt;</span> </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグのある行の後にこの行を挿入します </font></font><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">robot</span>&gt;</span></code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ファイルの先頭は次のようになります。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">robot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"rosbots"</span> <span class="hljs-attr">xmlns:xacro</span>=<span class="hljs-string">"http://www.ros.org/wiki/xacro"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">xacro:include</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"$(find rosbots_description)/urdf/rosbots.gazebo.xacro"</span> /&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう一度、すべてが新しい形式で機能することを確認します</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。</font></font><br>
<br>
<pre><code class="python hljs">roslaunch gazebo_ros empty_world.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目：</font></font><br>
<br>
<pre><code class="python hljs">roslaunch rosbots_description spawn.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ユーザーにとって、シミュレーションでのモデルの起動に関してはすべてがその場所に残り、コマンドは同じです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいセンサーを追加する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトが多少構造化された外観になったので、センサーを追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「ボディキット」でロボットを煩雑にしないために、カメラとimu（慣性測定モジュールまたはジャイロスコープ）の2つのセンサーのみを追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの目的のために、rosbots.xacroおよびrosbots.gazebo.xacroファイルを修正する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カメラとrosbots.xacroファイルから始めましょう。</font><font style="vertical-align: inherit;">すべてがうまくいくためには、センサーに追加する必要があります：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通信（リンク）。</font><font style="vertical-align: inherit;">それはdaeファイルで表されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カメラをロボットの本体に取り付けるジョイント。</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のファイル-rosbots.gazebo.xacro-に追加します：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上記で作成したリンクをセンサーとして検出するプラグイン。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグ内のrosbots.xacroに配置しましょう（便宜上、末尾に追加できます）。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosbots.xacro</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">joint</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"camera_joint"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"fixed"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">origin</span> <span class="hljs-attr">xyz</span>=<span class="hljs-string">"0.49 -0.03 0.75"</span> <span class="hljs-attr">rpy</span>=<span class="hljs-string">"0 0.21 0"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">parent</span> <span class="hljs-attr">link</span>=<span class="hljs-string">"base_link"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">child</span> <span class="hljs-attr">link</span>=<span class="hljs-string">"camera_link"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">joint</span>&gt;</span>   
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"camera_link"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">visual</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">geometry</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">mesh</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"package://rosbots_description/meshes/camera.dae"</span> <span class="hljs-attr">scale</span>=<span class="hljs-string">"4.0 4.0 4.0"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">geometry</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">origin</span> <span class="hljs-attr">xyz</span>=<span class="hljs-string">"0.0 0 0"</span> <span class="hljs-attr">rpy</span>=<span class="hljs-string">"0 0 0"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">visual</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">collision</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">geometry</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">mesh</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"package://rosbots_description/meshes/camera.dae"</span> <span class="hljs-attr">scale</span>=<span class="hljs-string">"4.0 4.0 4.0"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">geometry</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">origin</span> <span class="hljs-attr">xyz</span>=<span class="hljs-string">"0.0 0 0"</span> <span class="hljs-attr">rpy</span>=<span class="hljs-string">"0 0 0"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">collision</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">link</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のコードは、カメラにリンクとジョイントを追加して、視覚化できるようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これをチェックしてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一ターミナル：</font></font><br>
<br>
<pre><code class="python hljs">roslaunch gazebo_ros empty_world.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目：</font></font><br>
<br>
<pre><code class="python hljs">roslaunch rosbots_description spawn.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが正しければ、ロボットに追加されたカメラ（白）が表示されます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e-/9o/op/e-9oopleym1djh4yf2mrzwsacwq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。すべてが単純なようです。</font><font style="vertical-align: inherit;">ただし、カメラの視覚化のみが追加されていることを理解する必要があります。</font><font style="vertical-align: inherit;">このカメラが物理的な世界でどのように動作するかはまだ明らかではありません。</font><font style="vertical-align: inherit;">彼女の行動は未定義です。</font><font style="vertical-align: inherit;">カメラはまだ写真を撮ったり、ビデオを撮影したりすることができません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ガゼボでファイルを操作する時が来ました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosbots.gazebo.xacro</font></font></b><div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> タグの内側 </font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">robot</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">robot</span>&gt;</span></code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加：</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span> <span class="hljs-attr">reference</span>=<span class="hljs-string">"camera_link"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">sensor</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"camera"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"camera1"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">update_rate</span>&gt;</span>30.0<span class="hljs-tag">&lt;/<span class="hljs-name">update_rate</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">camera</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"head"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">horizontal_fov</span>&gt;</span>1.04<span class="hljs-tag">&lt;/<span class="hljs-name">horizontal_fov</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">image</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">width</span>&gt;</span>320<span class="hljs-tag">&lt;/<span class="hljs-name">width</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">height</span>&gt;</span>240<span class="hljs-tag">&lt;/<span class="hljs-name">height</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">format</span>&gt;</span>R8G8B8<span class="hljs-tag">&lt;/<span class="hljs-name">format</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">clip</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">near</span>&gt;</span>0.1<span class="hljs-tag">&lt;/<span class="hljs-name">near</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">far</span>&gt;</span>50<span class="hljs-tag">&lt;/<span class="hljs-name">far</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">clip</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">camera</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"camera_controller"</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"libgazebo_ros_camera.so"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">alwaysOn</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">alwaysOn</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">updateRate</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">updateRate</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">cameraName</span>&gt;</span>camera1<span class="hljs-tag">&lt;/<span class="hljs-name">cameraName</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">imageTopicName</span>&gt;</span>image_raw<span class="hljs-tag">&lt;/<span class="hljs-name">imageTopicName</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">cameraInfoTopicName</span>&gt;</span>camera_info<span class="hljs-tag">&lt;/<span class="hljs-name">cameraInfoTopicName</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">frameName</span>&gt;</span>camera<span class="hljs-tag">&lt;/<span class="hljs-name">frameName</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">hackBaseline</span>&gt;</span>0.07<span class="hljs-tag">&lt;/<span class="hljs-name">hackBaseline</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">distortionK1</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">distortionK1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">distortionK2</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">distortionK2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">distortionK3</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">distortionK3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">distortionT1</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">distortionT1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">distortionT2</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">distortionT2</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">sensor</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span>
</code></pre><br>
</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードでは簡単に推測できるため、カメラのパラメータを決定しました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update_rate：データが到着する頻度</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幅/高さ：画像の解像度。</font><font style="vertical-align: inherit;">この場合は320x240です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format：ビデオ形式（R8G8B8）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageTopicName：データが送信されるトピックの名前</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frameName：カメラが接続されるリンク-リンク。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、カメラとシミュレーションの両方を視覚化する準備がすべて整いました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シミュレーションを再起動してトピックのリストを表示すると、その中にカメラによって生成されたトピックが追加されていることがわかります。</font></font><br>
<br>
<pre><code class="plaintext hljs">rostopic list</code></pre><br>
<pre><code class="plaintext hljs">/rosbots/camera1/camera_info<font></font>
/rosbots/camera1/image_raw<font></font>
/rosbots/camera1/image_raw/compressed<font></font>
/rosbots/camera1/image_raw/compressed/parameter_descriptions<font></font>
/rosbots/camera1/image_raw/compressed/parameter_updates<font></font>
/rosbots/camera1/image_raw/compressedDepth<font></font>
/rosbots/camera1/image_raw/compressedDepth/parameter_descriptions<font></font>
/rosbots/camera1/image_raw/compressedDepth/parameter_updates<font></font>
/rosbots/camera1/image_raw/theora<font></font>
/rosbots/camera1/image_raw/theora/parameter_descriptions<font></font>
/rosbots/camera1/image_raw/theora/parameter_updates<font></font>
/rosbots/camera1/parameter_descriptions<font></font>
/rosbots/camera1/parameter_updates</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たくさんの話題があります！</font><font style="vertical-align: inherit;">ただし、原則として、最初の3つを除いて、すべてが頻繁に使用されるわけではありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ガゼボシミュレータからのrviz内の画像</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*ここでは、VMWare Workstationの現在のイメージ構成で、仮想ビデオカメラからrvizへのブロードキャストを開始しようとすると、gazeboがクラッシュすることを予約する必要があります。</font><font style="vertical-align: inherit;">可能な解決策は、エラーセクションの投稿の最後に示されています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
わかりやすくするために、シミュレーションでカメラを操作する場合は、rvizを実行して、ロボットの前にオブジェクトを配置します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、最初にオブジェクト自体が必要です。これは、ガゼボに追加されます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">object.urdf</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">ダウンロードし</font><font style="vertical-align: inherit;">て、〜/ catkin_ws / src / </font><font style="vertical-align: inherit;">
Runに配置します。</font><font style="vertical-align: inherit;">
第一ターミナル：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">roslaunch gazebo_ros empty_world.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目（モデルを配置）：</font></font><br>
<br>
<pre><code class="python hljs">rosrun gazebo_ros spawn_model -file /home/pi/catkin_ws/src/object.urdf -urdf -x <span class="hljs-number">1</span> -y <span class="hljs-number">0</span> -z <span class="hljs-number">1</span> -model my_object</code></pre><br>
<pre><code class="python hljs">roslaunch rosbots_description spawn.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シミュレーションでは、次の画像</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vo/hv/8b/vohv8bcwklaq0azofipui9vwnxi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
が表示されます。ロボットのモデルとポストもモデルとして追加されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アイテムは、挿入エディター内のタブから簡単な方法でガゼボエディターに追加できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hf/nl/by/hfnlby1wrk2bd4rg5y82cwamjzm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ロボットが表示するものを見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前の2つのターミナルを閉じずに、ロボットの説明を指定してrvizを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">roslaunch rosbots_description rviz.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、そこに「画像」と呼ばれる新しいディスプレイを追加</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uq/zy/ig/uqzyiginhyxvva8aa2qsailzkmk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
します。カメラからの画像を含む新しいディスプレイが表示され、ガゼボエディターが飛び出します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、VMWareイメージを使用して仮想マシンで作業している場合、仮想カメラからのブロードキャストを追加するとエラーが発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作業が仮想マシンではなく実際の仮想マシンで実行される場合は、ガゼボの仮想カメラからの画像と柱状図の画像を取得します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ii/3m/yj/ii3myjortuqornbgiepnmhzc-48.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、IMUをモデルに追加します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IMU（ジャイロスコープ）</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
imuを追加するプロセスは、カメラを追加するプロセスに似ています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、rosbots.gazebo.xacroを開いて、</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"gazebo_ros_imu_controller"</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">"libgazebo_ros_imu.so"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- &lt;robotNamespace&gt;&lt;/robotNamespace&gt; --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">topicName</span>&gt;</span>imu/data<span class="hljs-tag">&lt;/<span class="hljs-name">topicName</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">serviceName</span>&gt;</span>imu/service<span class="hljs-tag">&lt;/<span class="hljs-name">serviceName</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bodyName</span>&gt;</span>base_link<span class="hljs-tag">&lt;/<span class="hljs-name">bodyName</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">gaussianNoise</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">gaussianNoise</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">rpyOffsets</span>&gt;</span>0 0 0<span class="hljs-tag">&lt;/<span class="hljs-name">rpyOffsets</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">updateRate</span>&gt;</span>30.0<span class="hljs-tag">&lt;/<span class="hljs-name">updateRate</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">alwaysOn</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">alwaysOn</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">gaussianNoise</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">gaussianNoise</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードと追加したカメラのコードをタグ内に追加します</font></font><br>
<br>
<pre><code class="xml hljs"> <span class="hljs-tag">&lt;<span class="hljs-name">robot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">robot</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードから推測することは難しくないため、トピック/ imu / dataでデータを公開します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、ロボットモデル</font></font><code>rostopic list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をgazeboに</font><font style="vertical-align: inherit;">再配置してコマンドを実行すると、隣接するターミナルで</font><font style="vertical-align: inherit;">、とりわけimuデータを含むトピックを表示できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/_s/ha/hn_shayd-eggetkufqz9b3rs_wg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコマンドを実行して、パブリッシュしたものを表示することもできます。</font></font><br>
<br>
<pre><code class="plaintext hljs">rostopic echo /imu/data -n1 </code></pre><br>
<img src="https://habrastorage.org/webt/fx/qn/e2/fxqne2c6z62pqfldnblh9ycfgd0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要するに、imuは以下の情報を公開します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：x、y、z、w軸に沿ったロボットの方向。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">angular_velocity：ロボットの角速度。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linear_acceleration：線形加速度。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小さなタッチがあります</font></font></h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rosbots.gazebo.xacroにすべてをタグ内にも追加します</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span> <span class="hljs-attr">reference</span>=<span class="hljs-string">"wheel_left_link"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu1</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">mu1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu2</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">mu2</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">kp</span>&gt;</span>1000000.0<span class="hljs-tag">&lt;/<span class="hljs-name">kp</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">kd</span>&gt;</span>100.0<span class="hljs-tag">&lt;/<span class="hljs-name">kd</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">minDepth</span>&gt;</span>0.001<span class="hljs-tag">&lt;/<span class="hljs-name">minDepth</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">maxVel</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">maxVel</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span> <span class="hljs-attr">reference</span>=<span class="hljs-string">"wheel_right_link"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu1</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">mu1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu2</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">mu2</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">kp</span>&gt;</span>1000000.0<span class="hljs-tag">&lt;/<span class="hljs-name">kp</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">kd</span>&gt;</span>100.0<span class="hljs-tag">&lt;/<span class="hljs-name">kd</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">minDepth</span>&gt;</span>0.001<span class="hljs-tag">&lt;/<span class="hljs-name">minDepth</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">maxVel</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">maxVel</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span> <span class="hljs-attr">reference</span>=<span class="hljs-string">"base_link"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">material</span>&gt;</span>Gazebo/Blue<span class="hljs-tag">&lt;/<span class="hljs-name">material</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu1</span>&gt;</span>0.3<span class="hljs-tag">&lt;/<span class="hljs-name">mu1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu2</span>&gt;</span>0.3<span class="hljs-tag">&lt;/<span class="hljs-name">mu2</span>&gt;</span><font></font>
<font></font>
  <span class="hljs-tag">&lt;<span class="hljs-name">sensor</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"contact"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bumpers"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">always_on</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">always_on</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">update_rate</span>&gt;</span>50.0<span class="hljs-tag">&lt;/<span class="hljs-name">update_rate</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">visualize</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">visualize</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">contact</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">collision</span>&gt;</span>base_footprint_collision_base_link<span class="hljs-tag">&lt;/<span class="hljs-name">collision</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">contact</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">sensor</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">gazebo</span> <span class="hljs-attr">reference</span>=<span class="hljs-string">"camera_link"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu1</span>&gt;</span>0.2<span class="hljs-tag">&lt;/<span class="hljs-name">mu1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mu2</span>&gt;</span>0.2<span class="hljs-tag">&lt;/<span class="hljs-name">mu2</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">gazebo</span>&gt;</span></code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードは、ロボットの追加パラメータを決定します：車輪の摩擦係数、望楼の色、接触センサー。</font><font style="vertical-align: inherit;">ロボットのバンパーが障害物に触れた直後に、接触センサーがトリガーされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今度はgazeboを再起動してモデルを配置し、rvizに以前と同じようにimuディスプレイを追加し、カメラでディスプレイを追加します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i_/op/ph/i_opphe9wcki4_p8a1kfz2zacrs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてがうまくいけば、imuがトピックに投稿していることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論として、シミュレーションでロボットを制御し、imu：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1番目のターミナルで</font><font style="vertical-align: inherit;">データがどのように変化するかを確認します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs">roslaunch gazebo_ros empty_world.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目：</font></font><br>
<br>
<pre><code class="python hljs">roslaunch rosbots_description spawn.launch</code></pre><br>
<pre><code class="python hljs">roslaunch rosbots_description rviz.launch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目：</font></font><br>
<br>
<pre><code class="python hljs">rosrun teleop_twist_keyboard teleop_twist_keyboard.py /cmd_vel:=/part2_cmr/cmd_vel</code></pre><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/1qn_gtUJSxQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作中に発生する可能性のあるエラー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.ロボットモデルがgazeboに表示されません（パッケージ[rosbots_description]にパスがありません）-gazeboを閉じ、ターミナルでソースdevel / setup.bashを実行し、gazeboを再起動します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2。</font></font><br>
<br>
<pre><code class="python hljs">gzserver: /build/ogre<span class="hljs-number">-1.9</span>-mqY1wq/ogre<span class="hljs-number">-1.9</span><span class="hljs-number">-1.9</span><span class="hljs-number">.0</span>+dfsg1/OgreMain/src/OgreRenderSystem.cpp:<span class="hljs-number">546</span>: virtual void Ogre::RenderSystem::setDepthBufferFor(Ogre::RenderTarget*): Assertion `bAttached &amp;&amp; <span class="hljs-string">"A new DepthBuffer for a RenderTarget was created, but after creation"</span> <span class="hljs-string">"it says it's incompatible with that RT"</span><span class="hljs-string">' failed.
Aborted (core dumped)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可能な解決策（テストされていません）： </font></font><br>
<br>
<pre><code class="plaintext hljs">https://bitbucket.org/osrf/gazebo/issues/1837/vmware-rendering-z-ordering-appears-random</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja467655/index.html">C＃8で夏を過ごした方法</a></li>
<li><a href="../ja467657/index.html">IからZまでのインベントリ。ソフトウェアライセンスをカウントします</a></li>
<li><a href="../ja467659/index.html">更新されたHyperX FURY DDR4メモリの追加構成の例を使用して、タスクの実行を大幅にスピードアップします</a></li>
<li><a href="../ja467661/index.html">Seryozhaの線量計。パートI. Polimaster-核種ハンター</a></li>
<li><a href="../ja467663/index.html">.NET Coreでのハードウェア固有の命令のサポート（現在はSIMDだけではありません）</a></li>
<li><a href="../ja467667/index.html">組織プロジェクト計画（パート4）</a></li>
<li><a href="../ja467669/index.html">完全に私を見て：モバイルプラットフォームでライブビデオを最大限に活用する</a></li>
<li><a href="../ja467671/index.html">NLXレトロコンピュータ</a></li>
<li><a href="../ja467673/index.html">組み込みのGo機能</a></li>
<li><a href="../ja467675/index.html">SwiftUIでのStoreオブジェクトを使用したアプリケーション状態のモデリング</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>