<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è© üë®üèº‚Äçü§ù‚Äçüë®üèª üí¶ Detectar COVID-19 em raios-X com Keras, TensorFlow e Deep Learning üíî ‚úåüèª üêì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Com a ajuda deste guia, com a ajuda de Keras, TensorFlow e aprendizado profundo, aprenderemos como determinar automaticamente o COVID-19 a partir de u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Detectar COVID-19 em raios-X com Keras, TensorFlow e Deep Learning</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/493614/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/bt/gn/albtgnkhy92l7fzrjmwpm6fdu4o.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com a ajuda deste guia, com a ajuda de Keras, TensorFlow e aprendizado profundo, aprenderemos como determinar automaticamente o COVID-19 a partir de um conjunto de dados de raio-x manualmente </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como tantos outros, estou sinceramente preocupado com o COVID-19. </font><font style="vertical-align: inherit;">Percebi que estou constantemente analisando minha condi√ß√£o e me perguntando se vou pegar a doen√ßa e quando ela acontecer√°. </font><font style="vertical-align: inherit;">E quanto mais me preocupo com isso, mais ele se transforma em um jogo doloroso da mente, no qual a sintomatologia √© combinada com hipocondria:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acordei de manh√£, sentindo alguma dor e fraqueza.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando me arrastei para fora da cama, encontrei um corrimento nasal (embora </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j√° se saiba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que um corrimento nasal </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><font style="vertical-align: inherit;">um sintoma do COVID-19).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando cheguei ao banheiro para pegar um len√ßo de papel, eu j√° estava tossindo.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No come√ßo, n√£o prestei muita aten√ß√£o: sou al√©rgico ao p√≥len e, devido ao clima quente na costa leste dos Estados Unidos, a primavera foi um come√ßo de primavera. </font><font style="vertical-align: inherit;">Muito provavelmente, esses s√£o sintomas al√©rgicos. </font><font style="vertical-align: inherit;">Mas durante o dia minha condi√ß√£o n√£o melhorou. </font><font style="vertical-align: inherit;">Sento e escrevo este manual com um term√¥metro na boca. </font><font style="vertical-align: inherit;">Olho para baixo e vejo 37,4 ¬∞ C. </font><font style="vertical-align: inherit;">Minha temperatura corporal normal √© um pouco mais baixa que outras, a 36,3 ¬∞ C. </font><font style="vertical-align: inherit;">Tudo acima de 37,2 ¬∞ C j√° √© um pouco de calor para mim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tosse e febre leve? </font><font style="vertical-align: inherit;">Pode ser COVID-19 ... ou apenas minha alergia. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â imposs√≠vel descobrir sem testar, e √© precisamente essa "ignor√¢ncia" que torna a situa√ß√£o t√£o intimidadora no n√≠vel humano.</font></font></strong><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minuto de Cuidados com OVNI</font></font></h3><br>
     COVID-19 ‚Äî     ,   SARS-CoV-2 (2019-nCoV).        ‚Äî    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apesar dos meus medos, tento pensar racionalmente. Tenho pouco mais de 30 anos, estou em √≥tima forma e minha imunidade √© forte. Vou me colocar em quarentena (apenas no caso), descansar e lidar com tudo. O COVID-19 n√£o me assusta do ponto de vista da </font><font style="vertical-align: inherit;">sa√∫de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pessoal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (pelo menos eu o suportarei). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, eu me preocupo com meus parentes idosos, incluindo todos aqueles que j√° foram diagnosticados com a doen√ßa, bem como aqueles que est√£o em lares e hospitais. Essas pessoas s√£o vulner√°veis ‚Äã‚Äãe ser√° terr√≠vel se elas morrerem devido ao COVID-19. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em vez de n√£o fazer nada e deixar minha doen√ßa me manter em casa (seja alergia, COVID-19 ou meus medos), decidi fazer o que podia:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escreverei o c√≥digo, conduzirei experimentos e, usando exemplos pr√°ticos, ensinarei outras pessoas a usar a vis√£o computacional e o aprendizado profundo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Devo dizer imediatamente que este </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><i><font style="vertical-align: inherit;">o</font></i><font style="vertical-align: inherit;"> artigo mais cient√≠fico escrito por mim. </font><font style="vertical-align: inherit;">Ela n√£o √© cient√≠fica. </font><font style="vertical-align: inherit;">Os m√©todos e conjuntos de dados usados </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valem a pena publicar. </font><font style="vertical-align: inherit;">Mas eles servem como ponto de partida para quem quer pelo menos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algo para</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ajudar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estou preocupado com voc√™ e esta comunidade. </font><font style="vertical-align: inherit;">Quero ajudar o que posso: este artigo √© minha maneira de lidar mentalmente com os tempos dif√≠ceis, enquanto ajuda os outros em uma situa√ß√£o semelhante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste guia, voc√™ aprender√°:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como coletar um conjunto de dados de c√≥digo-fonte aberto de imagens de raios-X de pacientes com COVID-19 detectado.</font></font></li>
<li>   ¬´¬ª (  )    .</li>
<li>      COVID-19      .</li>
<li>      .</li>
</ol><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eu j√° sugeri isso, mas agora vou dizer diretamente. </font><font style="vertical-align: inherit;">As t√©cnicas descritas aqui s√£o apenas para fins educacionais. </font><font style="vertical-align: inherit;">Este </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><strong><font style="vertical-align: inherit;">um</font></strong><font style="vertical-align: inherit;"> estudo cient√≠fico rigoroso, n√£o ser√° publicado em peri√≥dicos. </font><font style="vertical-align: inherit;">Este artigo √© para leitores interessados ‚Äã‚Äãem vis√£o computacional e aprendizado profundo, que desejam aprender na pr√°tica, bem como para aqueles que s√£o inspirados pelos eventos atuais. </font><font style="vertical-align: inherit;">Pe√ßo que voc√™ leve tudo isso em considera√ß√£o. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na primeira parte do manual, discutiremos como detectar o COVID-19 em radiografias pulmonares. </font><font style="vertical-align: inherit;">Em seguida, discutimos o pr√≥prio conjunto de dados. </font><font style="vertical-align: inherit;">Depois, mostrarei como treinar o modelo usando Keras e TensorFlow para prever o COVID-19 em nossas imagens.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explica√ß√£o</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este artigo de detec√ß√£o autom√°tica COVID-19 foi escrito apenas para fins educacionais. Ele </font></font></strong><i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></strong></i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descreve um sistema de diagn√≥stico confi√°vel e preciso COVID-19, n√£o foi testado nem do ponto de vista profissional nem acad√™mico.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Meu objetivo √© inspir√°-lo e mostrar como o estudo da vis√£o computacional e do aprendizado profundo, com a subsequente aplica√ß√£o desse conhecimento na √°rea m√©dica, pode ter um grande impacto no mundo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ n√£o precisa de educa√ß√£o m√©dica para influenciar a medicina</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hoje, profissionais de treinamento profundo trabalham em estreita colabora√ß√£o com m√©dicos e outros m√©dicos na solu√ß√£o de problemas complexos, salvam vidas e tornam o mundo um lugar melhor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que minha lideran√ßa inspire voc√™ a faz√™-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por√©m, considerando tudo o exposto, pesquisadores, curadores de revistas e o sistema de revis√£o j√° est√£o sobrecarregados com trabalhos que descrevem modelos de previs√£o de qualidade duvidosa do COVID-19. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por favor, n√£o envie o c√≥digo e o modelo deste artigo para uma revista ou alguma publica√ß√£o cient√≠fica - voc√™ apenas aumentar√° o caos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, se voc√™ deseja realizar pesquisas com base neste artigo (ou em qualquer outra publica√ß√£o sobre o COVID-19), siga o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guia TRIPOD para descrever modelos preditivos.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como voc√™ entende, o uso da intelig√™ncia artificial na √°rea m√©dica pode ter consequ√™ncias muito graves. Publique e use esses modelos somente se voc√™ for um especialista m√©dico ou se tiver sido aconselhado em detalhes por esses especialistas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como o COVID-19 pode ser detectado em raios-x?</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/8bd/a46/dbb8bda4650156ba71b79b0db4309738.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 1:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exemplo de radiografia de um paciente diagnosticado com COVID-19. </font><font style="vertical-align: inherit;">Nestas imagens, voc√™ pode ensinar o classificador usando Keras e TensorFlow para determinar o COVID-19. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testar o COVID-19 agora √© dif√≠cil -</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o h√° testes suficientes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas √© imposs√≠vel produzi-los rapidamente, o que s√≥ aumenta o p√¢nico. </font><font style="vertical-align: inherit;">E em p√¢nico, h√° patifes que est√£o tentando lucrar com os outros</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e vender testes falsos no COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> encontrando-se v√≠timas inocentes em redes sociais e mensageiros instant√¢neos. </font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado o n√∫mero limitado de testes, precisamos confiar em outros m√©todos de diagn√≥stico.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidi estudar os raios-X, porque os m√©dicos costumam us√°-los e tomografias para diagnosticar pneumonia, inflama√ß√£o pulmonar, abscessos e linfonodos aumentados. Como o v√≠rus ataca as c√©lulas epiteliais que revestem o trato respirat√≥rio, podemos usar raios-X para estudar a condi√ß√£o dos pulm√µes humanos. E como as m√°quinas de raio-X est√£o em quase toda parte, usando as imagens voc√™ pode detectar o COVID-19 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kits de teste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As desvantagens do m√©todo incluem a necessidade de radiologistas, bem como um tempo de processamento significativo. E o tempo √© especialmente caro quando as pessoas est√£o doentes em todo o mundo. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E para economizar tempo dos m√©dicos, voc√™ precisa criar um sistema de an√°lise autom√°tica</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong></i><i>    ,   ,    COVID-19    .        .  ,  </i><i><strong></strong></i><i> ,  ,   ,     COVID-19,   .</i><br>
<br>
<h3>    COVID-19</h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e99/03e/e2a/e9903ee2a07ec44819bb4821671401fa.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† esquerda, imagens de pessoas com resultado positivo (infectado), √† direita - com negativo. </font><font style="vertical-align: inherit;">Nestas imagens, ensinaremos o modelo usando TensorFlow e Keras para prever automaticamente a presen√ßa de COVID-19 (ou seja, uma doen√ßa resultante de coronav√≠rus). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O conjunto de dados de imagens de pacientes usado com o COVID-19 usado aqui foi compilado sob a supervis√£o do</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um estudante de gradua√ß√£o da Universidade de Montreal. </font><font style="vertical-align: inherit;">Alguns dias atr√°s, Cohen come√ßou a coletar imagens de raios-X de pacientes com COVID-19 e envi√°-las</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para o reposit√≥rio GitHub. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√° voc√™ encontrar√° exemplos n√£o apenas desta doen√ßa, mas tamb√©m de MERS, SARS e SDRA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar um conjunto de dados I:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analise o arquivo metadata.csv no reposit√≥rio.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selecionadas todas as linhas:</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No total, foram obtidas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 fotos com resultados positivos no COVID-19</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esquerda</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora escolha as fotos de pessoas saud√°veis.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Para fazer isso, peguei um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de dados de raios-X do pulm√£o de Kaggle (pneumonia)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e selecionei </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 imagens de pessoas saud√°veis</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √† </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">direita</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Esse conjunto de dados possui v√°rias desvantagens, incluindo etiquetas com preenchimento incorreto ou incorreto, mas √© adequado como ponto de partida para testar a hip√≥tese do detector COVID-19. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, recebi </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 inje√ß√µes:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 25 pacientes com COVID-19 e 25 saud√°veis. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode baixar o conjunto de dados no </font></font></strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Al√©m disso, adicionei scripts Python com os quais gerei o conjunto de dados, mas neste artigo n√£o os considerei.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estrutura do projeto</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download do c√≥digo e dos dados. </font><font style="vertical-align: inherit;">Retire os arquivos de l√° e voc√™ obt√©m a seguinte estrutura de diret√≥rios:</font></font><br>
<br>
<pre><code class="python hljs">$ tree --dirsfirst --filelimit <span class="hljs-number">10</span><font></font>
.<font></font>
‚îú‚îÄ‚îÄ dataset<font></font>
‚îÇ   ‚îú‚îÄ‚îÄ covid [<span class="hljs-number">25</span> entries]<font></font>
‚îÇ   ‚îî‚îÄ‚îÄ normal [<span class="hljs-number">25</span> entries]<font></font>
‚îú‚îÄ‚îÄ build_covid_dataset.py<font></font>
‚îú‚îÄ‚îÄ sample_kaggle_dataset.py<font></font>
‚îú‚îÄ‚îÄ train_covid19.py<font></font>
‚îú‚îÄ‚îÄ plot.png<font></font>
‚îî‚îÄ‚îÄ covid19.model<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tr√™s diret√≥rios, cinco arquivos. </font><font style="vertical-align: inherit;">O conjunto de dados est√° no diret√≥rio / conjunto de dados e √© dividido em duas classes - covid / e normal /. </font><font style="vertical-align: inherit;">Abaixo, examinamos o script train_covid19.py que treina nosso detector COVID-19.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementa√ß√£o do script de treinamento</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos prosseguir com o ajuste fino da rede neural convolucional, que diagnosticar√° automaticamente o COVID-19 usando Keras, TensorFlow e aprendizado profundo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abra o arquivo train_covid19.py e cole o seguinte c√≥digo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este script tira proveito das bibliotecas TensorFlow 2.0 e Keras selecionando importa√ß√µes tensorflow.keras. </font><font style="vertical-align: inherit;">Tamb√©m usamos:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , esta √© uma </font><font style="vertical-align: inherit;">biblioteca de aprendizado de m√°quina Python </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de fato</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para gr√°ficos,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para upload e pr√©-processamento de imagens em um conjunto de dados.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aprender a instalar o TensorFlow 2.0 (incluindo scikit-learn, OpenCV e matplotlib), confira meus tutoriais para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora analisamos os argumentos para a linha de comando e inicializamos os hiperpar√¢metros:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
    help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nossos tr√™s </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argumentos de linha de comando</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 24-31</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) incluem:</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: caminho para o conjunto de dados de entrada.</font></font></li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: caminho opcional para o planejamento de sa√≠da do hist√≥rico de aprendizado. </font><font style="vertical-align: inherit;">Por padr√£o, o gr√°fico √© chamado plot.png, a menos que um nome diferente seja especificado na linha de comando.</font></font></li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: caminho opcional para o nosso modelo de defini√ß√£o COVID-19 de sa√≠da. </font><font style="vertical-align: inherit;">Por padr√£o, √© chamado covid19.model.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, inicializamos a frequ√™ncia inicial de aprendizado, o n√∫mero de eras de treinamento e os hiperpar√¢metros do tamanho do pacote ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 35-37</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, baixe e pr√©-processe os raios-x:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
    <span class="hljs-comment"># extract the class label from the filename</span>
    label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]<font></font>
<font></font>
    <span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
    <span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
    image = cv2.imread(imagePath)<font></font>
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
    image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))<font></font>
<font></font>
    <span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
    data.append(image)<font></font>
    labels.append(label)<font></font>
<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span><font></font>
labels = np.array(labels)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para carregar os dados, pegamos todos os caminhos para as imagens no diret√≥rio --dataset ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linha 42</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) e, em seguida, para cada imagePath:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extra√≠mos </font><font style="vertical-align: inherit;">do caminho ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linha 49</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) o r√≥tulo da classe (covid ou normal).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregamos a imagem, convertemos em canais RGB e a reduzimos para um tamanho de 224x224 pixels para alimentar uma rede neural convolucional ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 53-55</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualiza√ß√£o de listas de dados e etiquetas ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 58 e 59</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, escalamos a intensidade do pixel em um intervalo </font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e convertemos os dados e os r√≥tulos no formato de matriz NumPy ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 63 e 64</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, executaremos uma codifica√ß√£o de hot label de nossos r√≥tulos e dividiremos o conjunto de dados em conjuntos de treinamento e teste:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels); print(labels)<font></font>
<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
    test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
    rotation_range=<span class="hljs-number">15</span>,<font></font>
    fill_mode=<span class="hljs-string">"nearest"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A codifica√ß√£o unit√°ria de etiquetas √© realizada nas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 67-69</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : os dados ser√£o apresentados neste formato:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada etiqueta codificada dessa maneira consiste em uma matriz de dois elementos, na qual um dos elementos √© "quente" (1) e o segundo √© "n√£o" (0). Nas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 73 e 74, o</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conjunto de dados √© dividido em duas partes: 80% para treinamento e 20% para teste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para generalizar o modelo, realizamos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a expans√£o dos dados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (aumento dos dados), definindo uma rota√ß√£o aleat√≥ria da imagem em 15 graus no sentido hor√°rio ou contra-atacando. O objeto de gera√ß√£o de extens√£o √© inicializado nas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 77-79</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, inicialize o modelo VGGNet e prepare-o para o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajuste fino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
    input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))<font></font>
<font></font>
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)<font></font>
<font></font>
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
    layer.trainable = <span class="hljs-literal">False</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 83 e 84</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , uma inst√¢ncia da rede neural VGG16 √© criada com os pesos obtidos previamente no ImageNet sem uma camada totalmente conectada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, criaremos uma camada totalmente conectada, consistindo de camadas POOL =&gt; FC = SOFTMAX ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 88-93</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) e coloc√°-la sobre o VGG16 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linha 97</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora congele pesos CONV para que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apenas uma</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> camada totalmente conectada seja </font><font style="vertical-align: inherit;">treinada </font><font style="vertical-align: inherit;">( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 101-102</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Isso termina a sintonia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora estamos prontos para compilar e treinar nosso modelo de aprendizado profundo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
    metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
    trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
    steps_per_epoch=len(trainX) // BS,<font></font>
    validation_data=(testX, testY),<font></font>
    validation_steps=len(testX) // BS,<font></font>
    epochs=EPOCHS)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 106-108,</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compilamos o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">treinamento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o otimizador de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">velocidade de atenua√ß√£o da</font></a><font style="vertical-align: inherit;"> rede </font><font style="vertical-align: inherit;">Adam. Dado que essa √© uma tarefa de classifica√ß√£o de duas classes, usamos a fun√ß√£o de perda de entropia cruzada bin√°ria (binary_crossentropy), n√£o a entropia cruzada categ√≥rica (entropia cruzada categ√≥rica). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para iniciar o treinamento, chamamos Keras-method </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fit_generator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e fornecemos a ele nossos raios-X atrav√©s de uma extens√£o de objeto de dados ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 112-117</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos avaliar o modelo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
    target_names=lb.classes_))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, primeiro executamos a previs√£o com base no conjunto de testes e obtemos os √≠ndices de previs√£o ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 121-125</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Em seguida, geraremos e exibiremos o relat√≥rio de classifica√ß√£o ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 128 e 129</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">usando o utilit√°rio scikit-learn </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos calcular a matriz de confus√£o para estimativa estat√≠stica futura:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])<font></font>
<font></font>
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos aqui:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerar uma matriz de imprecis√µes ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linha 133</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usamos essa matriz para determinar a precis√£o, sensibilidade e especificidade ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 135-137</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) e, em seguida, derivamos todas essas m√©tricas ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas 141-143</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, para an√°lises subsequentes, exibimos na forma de gr√°fico em um arquivo o hist√≥rico de altera√ß√µes de precis√£o e perda:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E, finalmente, serializamos o modelo do classificador tf.keras em disco:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Treinamos nosso detector com Keras e TensorFlow</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a implementa√ß√£o do script train_covid19.py, podemos treinar o detector autom√°tico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download do c√≥digo fonte, conjunto de dados e modelo pr√©-treinado. </font><font style="vertical-align: inherit;">Abra um terminal e execute o comando para treinar o detector:</font></font><br>
<br>
<pre><code class="python hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch <span class="hljs-number">1</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">20</span>s <span class="hljs-number">4</span>s/step - loss: <span class="hljs-number">0.7169</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.6590</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">2</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">86</span>ms/step - loss: <span class="hljs-number">0.8088</span> - accuracy: <span class="hljs-number">0.4250</span> - val_loss: <span class="hljs-number">0.6112</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">3</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.6809</span> - accuracy: <span class="hljs-number">0.5500</span> - val_loss: <span class="hljs-number">0.6054</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">4</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">100</span>ms/step - loss: <span class="hljs-number">0.6723</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.5771</span> - val_accuracy: <span class="hljs-number">0.6000</span><font></font>
...<font></font>
Epoch <span class="hljs-number">22</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3271</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2902</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">23</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3634</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2690</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">24</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">27</span>s <span class="hljs-number">5</span>s/step - loss: <span class="hljs-number">0.3175</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2395</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">25</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">101</span>ms/step - loss: <span class="hljs-number">0.3655</span> - accuracy: <span class="hljs-number">0.8250</span> - val_loss: <span class="hljs-number">0.2522</span> - val_accuracy: <span class="hljs-number">0.9000</span><font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
<font></font>
       covid       <span class="hljs-number">0.83</span>      <span class="hljs-number">1.00</span>      <span class="hljs-number">0.91</span>         <span class="hljs-number">5</span>
      normal       <span class="hljs-number">1.00</span>      <span class="hljs-number">0.80</span>      <span class="hljs-number">0.89</span>         <span class="hljs-number">5</span><font></font>
<font></font>
    accuracy                           <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
   macro avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
weighted avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span><font></font>
<font></font>
[[<span class="hljs-number">5</span> <span class="hljs-number">0</span>]<font></font>
 [<span class="hljs-number">1</span> <span class="hljs-number">4</span>]]<font></font>
acc: <span class="hljs-number">0.9000</span>
sensitivity: <span class="hljs-number">1.0000</span>
specificity: <span class="hljs-number">0.8000</span>
[INFO] saving COVID<span class="hljs-number">-19</span> detector model...
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagn√≥stico autom√°tico de raios-X</font></font></h3><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nesta parte, n√£o "resolvemos" o problema de determinar o COVID-19. Est√° escrito no contexto da situa√ß√£o atual e apenas para fins educacionais. Este √© um exemplo da aplica√ß√£o pr√°tica da vis√£o computacional e do aprendizado profundo, para que voc√™ se familiarize com diferentes m√©tricas, incluindo a precis√£o, sensibilidade e especificidade usuais (e trade-offs que devem ser considerados ao trabalhar com dados m√©dicos). Repito, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o resolvemos o</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> problema de determinar o COVID-19.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Assim, nosso detector autom√°tico mostrou uma precis√£o de</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ~ 90-92%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em amostras de</font><font style="vertical-align: inherit;">imagens de raios-X</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sozinho</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nenhuma outra informa√ß√£o foi usada para treinar o modelo, incluindo localiza√ß√£o geogr√°fica, densidade populacional etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m recebemos</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sensibilidade de 100%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificidade de 80%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o que significa:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dos pacientes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (casos positivos verdadeiros), usando o modelo, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conseguimos identificar com precis√£o como "positivo para COVID-19" em 100% dos casos.</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dos pacientes que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o tiveram</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (casos negativos verdadeiros), usando o modelo, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conseguimos identificar com precis√£o como "COVID-19 negativo" em apenas 80% dos casos.</font></font></strong></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como mostra o gr√°fico do hist√≥rico de treinamento, a rede neural n√£o √© treinada novamente, apesar do </font><font style="vertical-align: inherit;">tamanho </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muito pequeno</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dos dados de treinamento:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/566/c90/eb8/566c90eb8e4b35dd1d5c5293e90084f6.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 3:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este gr√°fico de precis√£o e perda demonstra que nosso modelo n√£o √© treinado novamente.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√â √≥timo termos alcan√ßado 100% de precis√£o ao detectar o COVID-19. No entanto, a situa√ß√£o com casos verdadeiramente negativos √© embara√ßosa:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o queremos atribuir a "COVID-19-negativo" aqueles que s√£o realmente "COVID-19-positivos".</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
N√≥s menos queremos deixar pacientes doentes irem para casa, para fam√≠lias e amigos, contribuindo para a dissemina√ß√£o da doen√ßa.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m precisa ter</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muito cuidado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com a parcela de casos falso-positivos:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o queremos contar erroneamente algu√©m como doente e coloc√°-lo em quarentena com outros pacientes para que ele seja infectado por eles</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrar um equil√≠brio entre sensibilidade e especificidade -</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uma</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tarefa </font><i><font style="vertical-align: inherit;">extremamente dif√≠cil</font></i><font style="vertical-align: inherit;"> , especialmente quando se trata de medicamentos e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principalmente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quando se trata de doen√ßas infecciosas que se espalham rapidamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Falando sobre vis√£o computacional m√©dica e aprendizado profundo, voc√™ deve sempre lembrar que o trabalho de nossos modelos preditivos pode ter consequ√™ncias muito graves: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diagn√≥sticos err√¥neos podem custar vidas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repito, os resultados deste artigo s√£o apresentados apenas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para fins educacionais</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esta n√£o √© uma publica√ß√£o de peri√≥dico, esses dados n√£o atendem aos crit√©rios do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRIPOD para a publica√ß√£o de modelos de previs√£o.</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limita√ß√µes, melhorias e trabalho adicional</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/032/a41/702032a4173717d7cc9fddb00d67ee27.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 4:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Atualmente, os profissionais de IA e de aprendizado profundo n√£o t√™m dados COVID-19 de qualidade para treinar efetivamente sistemas de reconhecimento autom√°tico de imagem.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Uma das principais limita√ß√µes do m√©todo descrito neste manual s√£o os dados.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> N√£o temos dados suficientes (confi√°veis) para treinar detectores COVID-19.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Os hospitais j√° possuem muitos casos cl√≠nicos com esse v√≠rus, mas, dada a privacidade e os direitos humanos, fica ainda mais dif√≠cil reunir rapidamente um conjunto de dados de alta qualidade a partir de imagens m√©dicas. Acredito que nos pr√≥ximos 12 a 18 meses teremos mais dados de qualidade. Mas, por enquanto, voc√™ precisa usar o que possui.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu tentei (dada minha condi√ß√£o f√≠sica e mental), nas condi√ß√µes de tempo e recursos limitados, escrever este guia para aqueles que est√£o interessados ‚Äã‚Äãno uso da vis√£o computacional e no aprendizado profundo. Mas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deixe-me</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lembr√°-lo de que </font><strong><font style="vertical-align: inherit;">n√£o sou um m√©dico profissional</font></strong><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para usar o detector COVID-19 na vida real, ele deve ser </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rigorosamente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> testado por m√©dicos reais, trabalhando lado a lado com especialistas em aprendizado profundo. O m√©todo que descrevi n√£o √© adequado para isso. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m disso, √© preciso ter cuidado com o que exatamente o modelo ‚Äúaprende‚Äù.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como escrevi no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manual Grad-CAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, √© prov√°vel que o modelo aprenda padr√µes que n√£o s√£o relevantes para o COVID-19, mas seja capaz de distinguir apenas duas amostras de dados (ou seja, diagn√≥sticos positivos e negativos). Os resultados do nosso detector precisar√£o ser rigorosamente testados e verificados pelos m√©dicos. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E, finalmente, os detectores futuros (e mais avan√ßados) ser√£o multimodais.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Agora usamos apenas dados visuais (raios-x). Os melhores detectores devem usar outros dados: indicadores vitais do paciente, densidade populacional, localiza√ß√£o geogr√°fica, etc. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dados visuais por si s√≥ geralmente n√£o s√£o suficientes para essas tarefas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por essas raz√µes, quero enfatizar novamente: este guia desempenha apenas o papel de material de treinamento - n√£o pode ser considerado como um detector COVID-19 confi√°vel. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ acha que voc√™ ou algu√©m pr√≥ximo ao COVID-19, siga as recomenda√ß√µes do seu sistema de sa√∫de. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que este guia tenha sido √∫til para voc√™. </font><font style="vertical-align: inherit;">Espero tamb√©m que seja para algu√©m um ponto de partida na busca de m√©todos de uso da vis√£o computacional e aprendizado profundo determinar automaticamente o COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste guia, voc√™ aprendeu como usar o Keras, o TensorFlow e o aprendizado profundo para criar um detector autom√°tico COVID-19 em um conjunto de dados a partir de imagens de raios-x. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hoje (ainda) n√£o existem conjuntos de dados de imagem verificados e de alta qualidade para esta doen√ßa, ent√£o voc√™ precisa trabalhar com </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o reposit√≥rio Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tiramos 25 imagens de seu</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conjunto de dados </font><strong><font style="vertical-align: inherit;">,</font></strong><font style="vertical-align: inherit;"> limitando-nos √† proje√ß√£o anteroposterior dos casos diagnosticados positivamente.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em seguida, tiramos 25 fotos de pessoas saud√°veis</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de dados Kaggle Chest X-Ray Images (Pneumonia).</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois, com a ajuda de Keras e TensorFlow, treinamos o detector COVID-19, que mostrou uma </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precis√£o de</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 90 a 92 </font><strong><font style="vertical-align: inherit;">%</font></strong><font style="vertical-align: inherit;"> em nossa amostra de teste, com uma sensibilidade de 100% e uma especificidade de 80% (em nosso pequeno conjunto de dados). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lembre-se de que o detector descrito aqui √© apenas para fins educacionais (consulte a Nota no texto). </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu queria inspirar outras pessoas a usar o aprendizado profundo, para mostrar que, em combina√ß√£o com a vis√£o computacional, isso pode ter um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grande impacto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em nossas vidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que tenha gostado.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493596/index.html">O homem que n√£o tinha pressa</a></li>
<li><a href="../pt493598/index.html">Ocultar parte do n√∫mero de telefone</a></li>
<li><a href="../pt493604/index.html">Eventos digitais em Moscou de 23 a 29 de mar√ßo</a></li>
<li><a href="../pt493606/index.html">A hist√≥ria da cria√ß√£o de um servi√ßo de nuvem com sabor de cyberpunk</a></li>
<li><a href="../pt493610/index.html">Programando uma camada de v√≠deo em um Raspberry Pi usando a API DispmanX</a></li>
<li><a href="../pt493616/index.html">Imagens como caixas - o que h√° dentro? Relat√≥rio em Yandex</a></li>
<li><a href="../pt493618/index.html">(N√£o) √≥bvio OSINT no Twitter</a></li>
<li><a href="../pt493620/index.html">Curva log√≠stica. Quando a epidemia terminar√°?</a></li>
<li><a href="../pt493622/index.html">Gravando um Retrowave em Angular</a></li>
<li><a href="../pt493626/index.html">Selenoid - Centenas de testes de interface do usu√°rio paralelos s√£o f√°ceis e r√°pidos. Pavel Senin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>