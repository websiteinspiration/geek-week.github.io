<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔃 💅🏽 🏇🏼 Automate HR processes using Microsoft Teams, PowerApps and Power Automate. Employee withdrawal requests 🐟 🌡️ 🉐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! Today I would like to share a small example of automation of the process of creating applications for new employees using Microsoft S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Automate HR processes using Microsoft Teams, PowerApps and Power Automate. Employee withdrawal requests</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497488/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Good day to all! </font><font style="vertical-align: inherit;">Today I would like to share a small example of automation of the process of creating applications for new employees using Microsoft SharePoint, PowerApps, Power Automate and Teams. </font><font style="vertical-align: inherit;">When implementing this process, you will not need to purchase separate PowerApps and Power Automate user plans, an Office365 E1 / E3 / E5 subscription will suffice. </font><font style="vertical-align: inherit;">We’ll create lists and columns on the SharePoint site, PowerApps will help you create the form, and Power Automate will provide the ability to customize the logic of business processes. </font><font style="vertical-align: inherit;">The final process is connected to the MS Teams team. </font><font style="vertical-align: inherit;">Let's not waste time and see what happens.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e-/by/t1/e-byt1bfrywvuok7gx25kggbvj8.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the first stage, we create lists and details. </font><font style="vertical-align: inherit;">We will need lists:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Employee withdrawal requests</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Divisions</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HR by unit</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Administrators</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each list will play a role in the future, and we will see which one. </font><font style="vertical-align: inherit;">We create the details and configure the navigation menu:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/jt/gh/hwjtghqjoqtymuuvhezpyvggsck.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Powerapps</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, let's make a form for the Employee Withdrawal Applications list using PowerApps. In the final form, it will look like this: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2e/zy/wo/2ezywokrmvzpfm_5vxbx1u4lzj8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the “Employee” field, Office 365 users are selected from the list of users, “Release Date” is indicated from the calendar, “Department” is indicated from the departments directory, and “HR” is selected from the “HR by departments” directory : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/aj/e8/niaje8qtx9zko2sk9c6x2wx5g7o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But you need to make sure that the list of HR available for selection is filtered by the unit indicated on the form. Use a formula to filter data in PowerApps. For the “Items” property of the “HR” field, we write: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qk/o-/p7/qko-p70_444xwyltuxby8fqduko.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Additionally, on the form, you can make small settings for the default value for the Status field. For the “Default” property of the “Status” field, write:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b4/zg/ic/b4zgic7k4bvev-uadqina0ni4ey.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the item creation form is opened, then the “New” value will be written in the Status field; otherwise, the value from the SharePoint column for the current element will be substituted into the status field on the form. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the problems with PowerApps is the inability to easily retrieve data from SharePoint groups. In this regard, it is not possible to easily configure the visibility / availability of fields or objects on the form if you wanted to tune in to the user's joining the SharePoint group. But you can make a workaround. Especially for this, we have created a list of Administrators in advance:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bn/3m/se/bn3mseql4chpxozeu_gbtacxyqy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this list there is an “Employee” field with the type “User or group” displayed only on the form and a “Name” field in which the name of the selected employee is written, displayed only in the list view. Now, let's do a little trick in PowerApps. For example, you can configure the availability of any field to the condition that the current user is in the Administrators list. We find the “Display Mode” property of the “Release Date” field and write: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2e/0m/8d/2e0m8dqb8ydddbxeod7zedmknui.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
According to this formula, if there is at least one employee in the Administrators list whose login matches the login of the current user, the field will be available for editing, otherwise, for viewing. For greater reliability, we bring the login to lowercase, otherwise there are all sorts of cases. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may have noticed that there is a button “Actions on application” in the title of the form:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wp/0b/wc/wp0bwcymw4vo7wg_gkegu0qg50s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This button will go to another screen, where, for convenience, all possible actions on the application are collected: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/to/0s/wk/to0swknwraznhohevjatxjoh06y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After clicking on each button an additional window of actions is opened, for example, if the action "Cancel request" is selected, an additional window opens with the ability to enter a comment: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cf/c8/wg/cfc8wgn2v64qdqq3-pugswtxmti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After clicking on the “Confirm” button, the status of the application changes, and this can be done even without starting the Power Automate stream. We will use the “Patch” function for the “OnSelect” property of the button: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/l4/yj/s5l4yjpdm_2uedemovmggtq9_8g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the Patch function, we update the application list item by filtering it by the identifier of the current item. We change the value of the "Status" field and go to the main screen. For the remaining action buttons, the logic is similar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It remains to configure the negotiation flow. </font><font style="vertical-align: inherit;">Let's make it in its simplest form.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Power automation</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our approval flow will start automatically when you create an application. </font><font style="vertical-align: inherit;">During the implementation, the status of the application will be changed, the division head will be received, and a notification of a new application will be sent to the head. </font><font style="vertical-align: inherit;">To determine the leader, we have a directory of “Departments”: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/vc/7h/sbvc7hsibhkxeyikwhsulhunmge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We create a Power Automate stream: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vx/u9/i0/vxu9i0iosnwmf4qj331z1hxusli.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the execution of this stream, the head of the division receives an email notification about the creation of a new application and can click on the link to make a decision by clicking on the button: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/aa/q6/baaaq6wl23ypaz_bj_cbo2u6zfo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clicking the “Agree” button or “Reject” also triggers the Power Automate thread, which changes the status of the application and sends a notification email to an HR specialist: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/78/xh/qd/78xhqdkb6lulsmt-ah9ciq3bgls.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The process is ready.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teams</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And the final touch is the organization of collaboration with this process. </font><font style="vertical-align: inherit;">To do this, we connect the process to the MS Teams team: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ky/v1/-v/kyv1-v3g_x_rzqpyz8dsgrfvnmy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, all members of the MS Teams team have access to the new employees exit process on a separate tab. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, multi-stage matching can be provided in the flow logic, plus there is the possibility to use the Approvals component to assign Power Automate tasks. </font><font style="vertical-align: inherit;">You can also set up reports and generate notifications that will be sent to the Microsoft Teams chatbot. </font><font style="vertical-align: inherit;">But more on that in the following articles. </font><font style="vertical-align: inherit;">Thank you for your attention and have a nice day!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497478/index.html">Network simulator tutorial ns-3. Chapter 4</a></li>
<li><a href="../en497480/index.html">Video Lectures: unix way</a></li>
<li><a href="../en497482/index.html">Authentication in Kubernetes with Dex: fasten LDAP</a></li>
<li><a href="../en497484/index.html">Using ML Algorithms to Classify Multipage Documents: VTB Experience</a></li>
<li><a href="../en497486/index.html">Data division. year 2013. Retrospective</a></li>
<li><a href="../en497490/index.html">Difficulties in paternity of seahorses: genetic metamorphoses of the immune system</a></li>
<li><a href="../en497492/index.html">Application on TSD and communication with 1C: Enterprise 8.3 through HTTP-Service. Part 1.1 (Detailed Description of the API)</a></li>
<li><a href="../en497504/index.html">How Quarkus Integrates MicroProfile and Spring</a></li>
<li><a href="../en497506/index.html">Create a todo for a remote command on Laravel</a></li>
<li><a href="../en497508/index.html">We continue to run into multi-storey C ++ templates in RESTinio: a type-safe alternative to express-js router</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>