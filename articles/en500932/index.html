<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêò ‚úäüèΩ üÖ±Ô∏è Spam as a protection tool ‚òÉÔ∏è üêÑ üí∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is believed that 80% of emails in the world are spam. That is, e-mail messages that the recipient does not need at all (and this is sad). But, as i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Spam as a protection tool</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500932/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is believed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that 80% of emails in the world are spam. That is, e-mail messages that the recipient does not need at all (and this is sad). But, as if this weren‚Äôt enough, in the middle of spam there are often letters sent with malicious purposes: for example, to steal or delete data, or to extort. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KDPV: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wx/g4/cg/wxg4cg61k9sutw8cme9epzyjzfm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As we know, in order for a letter to really harm computer systems, just delivering the letter to the recipient in most cases is not enough. Requires an ‚Äúopponent prone to cooperation‚Äù, i.e. the user must independently perform actions that will lead to the execution of the intent of the attacker.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typically, such an action is to ‚Äúopen‚Äù the file attachment to the letter, that is, manually start processing the file with the corresponding handler program inside the user's operating system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Even more sadly, the assistant opponent is a very common bird, and our attacker spammer may well count on him.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And that leads to</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/5u/my/dp/5umydpt6m2j3xlrrugbbjrowbbm.png"><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In short, our accountant opens an account, and there is not even an account at all, but a virus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malicious letters, of course, have important differences. But hoping for user attention and awareness is a bad idea. Even bizarre concerts on the theme ‚Äúdo not open such a thing‚Äù with a salute and a solo vocal performance by the general (composition ‚ÄúPolymers‚Äù) are erased from the memory of an office worker over time. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, well-tuned systems will protect us from most of these attacks. But the key word is ‚Äúfrom the majority‚Äù. No one will give a 100% guarantee; and if it comes to the user, then strengthening it, as one of the weakest places in the systems, is a good thing.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In computer crime, technology and social engineering go hand in hand. </font><font style="vertical-align: inherit;">The attacker realizes that it is difficult to pretend to whom the user trusts unconditionally, and therefore is forced to use other tactics: intimidation, coercion, imitate recognized authorities and / or use the corresponding false names - for example, send letters on behalf of government bodies and large companies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And, as the ancients teach us: if we cannot win, we must lead. </font><font style="vertical-align: inherit;">Indeed, what are we worse than spammers? </font><font style="vertical-align: inherit;">Yes, we are much better! </font><font style="vertical-align: inherit;">Yes, and we have more opportunities. </font><font style="vertical-align: inherit;">And the task itself will require the most minimal programming skills and will practically not affect existing systems.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disclaimer: author is not a spammer, spammer is not an author. </font><font style="vertical-align: inherit;">The author is solely and exclusively on the good side.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The task is very simple: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
we will send our users letters similar to malicious ones. In the attachments to these letters we will attach documents where in capital letters we write ‚ÄúDO NOT OPEN DOCUMENTS FROM SUCH LETTERS. Be careful and careful. " </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, our problem has the following </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conditions</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Letters should be different</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . If we send the same letter to everyone and every time, then this will not differ from ordinary reminders at meetings, to which users have immunity. We must stimulate the user with the system responsible for training. The following conditions follow from this: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Letters should be like real ones</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. It is possible, but inefficient, to send letters from Meat-Company LLP or Barack Obama. It makes sense to use the really existing (and different!) Names of organizations and bodies; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . It </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> also </font><b><font style="vertical-align: inherit;">important that the letters look a little strange</font></b><font style="vertical-align: inherit;"> . They should be somewhat dubious in order to arouse suspicion and the user and activate the learning system in the brain; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition 4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . And with all this, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">letters should attract attention and provoke</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Well, everything is simple, we don‚Äôt even need to invent anything: spammers have already done everything for us. ‚ÄúPenalties‚Äù, ‚ÄúJudicial decisions‚Äù and even just ‚ÄúDocuments‚Äù in attachments, ‚ÄúForfeits‚Äù, ‚ÄúRecalculations‚Äù, ‚ÄúPenalties‚Äù in the subject and many words ‚ÄúUrgent‚Äù, ‚ÄúImmediately‚Äù, ‚ÄúObligatory‚Äù, ‚ÄúPay‚Äù in the text - and it's in the hat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To implement this magic set you will need minimal programming skills and a boring evening. The author used Python 3 (because it was necessary to practice) and JS (to collect data directly from the browser console). But most of the code is easily implemented on native OS tools (bash, cmd), only with the encodings are tormented. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fairness, it should be noted that the idea itself does not belong to the author, but was spied on by one large international company. Nevertheless, the idea is so on the surface that, barely hearing, the author, shouting ‚Äúwhy haven‚Äôt I done this before,‚Äù rushed to implement it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, first of all, we need the parts from which we will compose the letter. Let's start with the From field - who will threaten our fearful users. Well, who: of course, banks, tax inspectorates, courts and all sorts of weird LLCs. At the same time, you can add templates for future auto-substitution, like PAO </font></font><code>CmpNmF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. See from.txt </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we need, in fact, the names. LLC Chamomile and Vector, as well as the endlessly repeating of some ‚ÄúMoscow court‚Äù is unlikely to cause a response in the souls. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fortunately, the Internet provides us with amazing opportunities to receive information. For example, a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list of the current courts of the Russian Federation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be obtained with a simple JavaScript command directly in the browser console code like:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> el <span class="hljs-keyword">of</span> <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"mw-content-text"</span>).querySelectorAll(<span class="hljs-string">"li"</span>)) {<span class="hljs-built_in">console</span>.log(el.innerText;)}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So you can quickly very quickly gain an excellent base for our tasks (especially since the author has already done this for you :)). We will save in Plain text, the database for such a task is overkill. The project uses UTF-8 encoding with BOM, in case the most specific characters are used. See txt files with appropriate names. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, you need to generate the correct (from the standard standard, but not necessarily existing) email address of the sender so that our letter is correctly displayed and correctly forwarded. For some of the titles, the author used fixed domains, for some, auto-generation from the name using a transliteration library, something like Vector LLC -&gt; warning@ooovektor.ru. The name of the box is taken from the list in the code and is also intended to inspire awe: ‚Äúvzyskanie‚Äù, ‚Äúshtraf‚Äù, ‚Äúdolg‚Äù, 'alarm'and other "zapros".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now - the subject of the letter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The subject must necessarily attract attention, otherwise the letter will go unnoticed. Give free rein to your internal scarecrow of accountants, and everything will turn out: ‚ÄúClosing account (s) ( </font></font><code>CmpNm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)‚Äù, ‚ÄúChief accountant ( </font></font><code>CmpNm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)‚Äù, ‚ÄúRequirement (for </font></font><code>CmpNm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)‚Äù ‚ÄúImmediately pay (!!!)‚Äù and other pranks. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
See subj.txt. Add to taste, mix, do not shake. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The text of the letter should be somewhat strange. We have already attracted the attention of the user, now our task is to raise suspicion. Therefore, trying at this point is completely useless. Let us take threatening phrases from spammers and we will combine them arbitrarily, 100% certainty will only hinder us. It will turn out nonsense like:</font></font><br>
<blockquote><code>()  ( "")       <br>
    <br>
  </code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
See msg.txt. Additions are welcome. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And finally, the attachment. The project currently provides for 3 types of investments: pdf, doc, docx. Files are copied from the samples without changing the content, the attachment file is given a name from the list (‚ÄúResolution‚Äù, ‚ÄúJudgment‚Äù, etc., see flnms.txt). For the first two types, the size is randomly generated by adding zeros to the end of the file. This does not work with docx (although after the recovery procedure, the Word file opens; LibreOffice, for example, opens the docx files without abuse, into which third-party files are added via the archiver interface). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And we get such a miracle: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wf/fp/fr/wffpfr3pdwjgwo2eyppoprp-quw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can send:</font></font><br>
<br>
<pre><code class="plaintext hljs">gen_msg.py buh@oootest.ru</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code, of course, on the github</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Actually, that's all. </font><font style="vertical-align: inherit;">Cases for an hour, and the benefits ... But the benefits will be. </font><font style="vertical-align: inherit;">For the theory is dry, but the tree of life is lushly green - explanations do not reach, reminders are forgotten, and people learn skills only in practice. </font><font style="vertical-align: inherit;">And we‚Äôd rather be better teachers than to restore everything from backups, right?</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500922/index.html">A wolf in sheep's clothing: how to catch a hacker who carefully disguises himself as an ordinary user</a></li>
<li><a href="../en500924/index.html">Online meeting JUG.ru "Spring-builder" with Evgeny Borisov</a></li>
<li><a href="../en500926/index.html">Dynamic typing is not a development tool. This is nonsense (lousy)</a></li>
<li><a href="../en500928/index.html">Digital Breakthrough Contest 2020 Launches Online IT Marathon</a></li>
<li><a href="../en500930/index.html">Little secrets for game designers to make a player hate your game a little less</a></li>
<li><a href="../en500934/index.html">Winnum announces a new release of the flagship platform Winnum Platform 4.3</a></li>
<li><a href="../en500936/index.html">Simple integration of RabbitMQ and Spring Boot</a></li>
<li><a href="../en500942/index.html">Ultraviolet: effective disinfection and safety</a></li>
<li><a href="../en500944/index.html">WexLang Reader - how to read books in foreign languages ‚Äã‚Äãwith pleasure (104 languages)</a></li>
<li><a href="../en500948/index.html">Rust 1.43.1 release: adjustment release</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>