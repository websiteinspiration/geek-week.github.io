<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜò ü•ß ‚úùÔ∏è C√≥mo creamos informes din√°micos en SSRS 2014 ü•í ‚öúÔ∏è üöä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nosotros ya hablamos de c√≥mo hemos ayudado a una empresa de fabricaci√≥n de transformar los procesos de formaci√≥n corporativa y el desarrollo personal....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C√≥mo creamos informes din√°micos en SSRS 2014</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/true_engineering/blog/487704/"><img src="https://habrastorage.org/webt/_q/hb/qb/_qhbqb8irkmfwui-lrqaktkhe8q.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosotros </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya hablamos de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c√≥mo hemos ayudado a una empresa de fabricaci√≥n de transformar los procesos de formaci√≥n corporativa y el desarrollo personal. </font><font style="vertical-align: inherit;">Los empleados del cliente, que se estaban ahogando en documentos en papel y hojas de c√°lculo Excel, recibieron una pr√°ctica aplicaci√≥n para iPad y un portal web. </font><font style="vertical-align: inherit;">Una de las funciones m√°s importantes de este producto es la creaci√≥n de informes din√°micos mediante los cuales los gerentes juzgan el trabajo de los empleados "en el campo". </font><font style="vertical-align: inherit;">Estos son documentos enormes con docenas de campos y tama√±os promedio de 3000 * 1600 p√≠xeles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este art√≠culo, hablaremos sobre c√≥mo implementar esta belleza basada en Microsoft SQL Server Reporting Services, por qu√© un backend puede ser un mal amigo del portal web y qu√© trucos ayudar√°n a establecer su relaci√≥n. </font><font style="vertical-align: inherit;">La parte comercial completa de la soluci√≥n ya se describi√≥ en el art√≠culo anterior, por lo que aqu√≠ nos centramos en cuestiones t√©cnicas. </font><font style="vertical-align: inherit;">¬°Empecemos!</font></font><br>
<br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formulaci√≥n del problema</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenemos un portal con el que trabajan varios cientos de usuarios. </font><font style="vertical-align: inherit;">Est√°n organizados en una jerarqu√≠a gradual, donde cada usuario tiene un supervisor de un rango m√°s alto. </font><font style="vertical-align: inherit;">Esta diferenciaci√≥n de derechos es necesaria para que los usuarios puedan crear eventos con cualquier empleado subordinado. </font><font style="vertical-align: inherit;">Puedes saltar los pasos, es decir </font><font style="vertical-align: inherit;">el usuario puede comenzar la actividad con un empleado de cualquier rango inferior a √©l. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© eventos se entienden aqu√≠? </font><font style="vertical-align: inherit;">Esto puede ser capacitaci√≥n, soporte o certificaci√≥n de un empleado de una empresa comercial, que el supervisor lleva a cabo en un punto de venta. </font><font style="vertical-align: inherit;">El resultado de tal evento es un cuestionario completado en un iPad con calificaciones de los empleados para las cualidades y habilidades profesionales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seg√∫n los datos del cuestionario, puede preparar estad√≠sticas, por ejemplo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øCu√°ntos eventos con sus subordinados de este tipo cre√≥ Vasya Ivanov en un mes? </font><font style="vertical-align: inherit;">¬øCu√°ntos de ellos est√°n completos?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øCu√°l es el porcentaje de calificaciones satisfactorias? </font><font style="vertical-align: inherit;">¬øQu√© preguntas responden los comerciantes a lo peor? </font><font style="vertical-align: inherit;">¬øQu√© gerente es peor para tomar ex√°menes?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dichas estad√≠sticas est√°n contenidas en </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informes</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que pueden crearse a trav√©s de la interfaz web, en formatos XLS, PDF, DOCX e imprimirse. </font><font style="vertical-align: inherit;">Todas estas funciones est√°n dise√±adas para gerentes en diferentes niveles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El contenido y el dise√±o de los informes se definen en las </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plantillas</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , lo que le permite establecer los par√°metros necesarios. </font><font style="vertical-align: inherit;">Si en el futuro los usuarios necesitar√°n nuevos tipos de informes, el sistema tiene la capacidad de crear plantillas, especificar par√°metros modificables y agregar una plantilla al portal. </font><font style="vertical-align: inherit;">Todo esto, sin interferir con el c√≥digo fuente y los procesos de trabajo del producto.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Especificaciones y limitaciones</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El portal se ejecuta en arquitectura de microservicio, el frente est√° escrito en Angular 5. El recurso utiliza la autorizaci√≥n JWT, es compatible con los navegadores Google Chrome, Firefox, Microsoft Edge e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IE 11</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos los datos se almacenan en MS SQL Server 2014. SQL Server Reporting Services (SSRS) est√° instalado en el servidor, el cliente lo usa y no lo va a rechazar. </font><font style="vertical-align: inherit;">De ah√≠ la limitaci√≥n m√°s importante: el acceso a SSRS est√° cerrado desde el exterior, por lo que puede acceder a la interfaz web y SOAP solo desde la red local a trav√©s de la autorizaci√≥n NTLM.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algunas palabras sobre SSRS</font></font></b><div class="spoiler_text"><b>SSRS </b>‚Äì    ,        ,     .     docs.microsoft.com,  SSRS        (API)    ( Report Server,  -    HTTP). <br>
</div></div><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atenci√≥n, la pregunta: ¬øc√≥mo completar la tarea sin m√©todos manuales, con recursos m√≠nimos y beneficios m√°ximos para el cliente? </font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como el cliente tiene SSRS en un servidor dedicado, deje que SSRS haga todo el trabajo sucio de generar y exportar informes. </font><font style="vertical-align: inherit;">Entonces no tenemos que escribir nuestro propio servicio de informes, exportar m√≥dulos a XLS, PDF, DOCX, HTML y la API correspondiente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, la tarea era hacer amigos de SSRS con el portal y garantizar el funcionamiento de las funciones especificadas en la tarea. </font><font style="vertical-align: inherit;">As√≠ que veamos la lista de estos escenarios: se encontraron sutilezas interesantes en casi todos los puntos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estructura de la soluci√≥n</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como ya tenemos SSRS, existen todas las herramientas para administrar plantillas de informes: </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor de informes: responsable de toda la l√≥gica de trabajar con informes, su almacenamiento, generaci√≥n, administraci√≥n y mucho m√°s.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Administrador de informes: un servicio con una interfaz web para administrar informes. </font><font style="vertical-align: inherit;">Aqu√≠ puede cargar plantillas creadas en las herramientas de datos de SQL Server en el servidor, configurar los derechos de acceso, las fuentes de datos y los par√°metros (incluidos los que se pueden cambiar al informar solicitudes). </font><font style="vertical-align: inherit;">Es capaz de generar informes sobre plantillas descargadas y subirlas a varios formatos, incluidos XLS, PDF, DOCX y HTML.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> creamos plantillas en las herramientas de datos de SQL Server, con la ayuda de Report Manager las completamos en Report Server, configuramos y est√° listo. </font><font style="vertical-align: inherit;">Podemos generar informes, cambiar sus par√°metros. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La siguiente pregunta: ¬øc√≥mo solicitar la generaci√≥n de informes sobre plantillas espec√≠ficas a trav√©s del portal y obtener el resultado al frente para enviarlo a la interfaz de usuario o descargarlo en el formato deseado?</font></font></i></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informes de SSRS al portal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como dijimos anteriormente, SSRS tiene su propia API para acceder a los informes. Pero no queremos entregar sus funciones por razones de seguridad e higiene digital: solo necesitamos solicitar datos de SSRS en la forma correcta y transmitir el resultado al usuario. La gesti√≥n de informes estar√° a cargo de personal de atenci√≥n al cliente especialmente capacitado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que el acceso a SSRS es solo desde la red local, el intercambio de datos entre el servidor y el portal es a trav√©s de un servicio proxy. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/kz/f5/9x/kzf59xp7_ltztohtag_orirmn5i.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intercambio de datos entre el portal y el servidor</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Veamos c√≥mo funciona y por qu√© ReportProxy est√° aqu√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, en el lado del portal, tenemos un ReportService, al que accede el portal para informes. El servicio verifica la autorizaci√≥n del usuario, el nivel de sus derechos, convierte los datos de SSRS en la forma deseada seg√∫n el contrato.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ReportService API contiene solo 2 m√©todos, que son suficientes para nosotros:</font></font><br>
<br>
<ol>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetReports</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : proporciona los identificadores y nombres de todas las plantillas que el usuario actual puede recibir;</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetReportData (formato, par√°metros)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : proporciona datos de informes exportados y listos para </font><i><font style="vertical-align: inherit;">usar</font></i><font style="vertical-align: inherit;"> en el formato especificado, con un conjunto dado de par√°metros.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora necesita estos 2 m√©todos para poder comunicarse con SSRS y tomar los datos necesarios de la forma correcta. </font><font style="vertical-align: inherit;">De la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentaci√≥n se sabe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que podemos acceder al servidor de informes a trav√©s de HTTP utilizando la API SOAP. </font><font style="vertical-align: inherit;">Parece que el rompecabezas se est√° desarrollando ... Pero, de hecho, una sorpresa nos espera aqu√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que SSRS est√° cerrado al mundo exterior y solo se puede acceder a trav√©s de la autenticaci√≥n NTLM, no est√° disponible directamente desde el portal SOAP. </font><font style="vertical-align: inherit;">Tambi√©n hay nuestros propios deseos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otorgue acceso solo al conjunto de funciones requerido e incluso proh√≠ba el cambio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si tiene que cambiar a otro sistema de informes, las ediciones en ReportService deben ser m√≠nimas, y es mejor que no sean necesarias.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ es donde ReportProxy nos ayuda, que se encuentra en la misma m√°quina que SSRS y es responsable de enviar las solicitudes de ReportService a SSRS. </font><font style="vertical-align: inherit;">El procesamiento de la solicitud es el siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el servicio recibe una solicitud de ReportService, verifica la autorizaci√≥n JWT;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de acuerdo con el m√©todo API, el proxy pasa por el protocolo SOAP en SSRS para obtener los datos necesarios, iniciando sesi√≥n a trav√©s de NTLM en el camino;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los datos recibidos de SSRS se env√≠an de nuevo a ReportService en respuesta a la solicitud.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De hecho, ReportProxy es un adaptador entre SSRS y ReportService. </font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El controlador es el siguiente:</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">[BasicAuthentication]<font></font>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReportProxyController</span> : <span class="hljs-title">ApiController</span>
</span>{<font></font>
    [HttpGet()]<font></font>
    public List&lt;ReportItem&gt; Get(string rootPath)<font></font>
    {<font></font>
        <span class="hljs-comment">//  ...</span><font></font>
    }<font></font>
<font></font>
    public HttpResponseMessage Post([FromBody]ReportRequest request)<font></font>
    {<font></font>
        <span class="hljs-comment">//  ...</span><font></font>
    }<font></font>
}<font></font>
</code></pre><br>
  BasicAuthentication   :<br>
<br>
<pre><code class="javascript hljs">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BasicAuthenticationAttribute</span> : <span class="hljs-title">AuthorizationFilterAttribute</span>
</span>{<font></font>
    public override <span class="hljs-keyword">void</span> OnAuthorization(HttpActionContext actionContext)<font></font>
    {<font></font>
        <span class="hljs-keyword">var</span> authHeader = actionContext.Request.Headers.Authorization;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (authHeader != <span class="hljs-literal">null</span>)<font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> authenticationToken = actionContext.Request.Headers.Authorization.Parameter;
            <span class="hljs-keyword">var</span> tokenFromBase64 = Convert.FromBase64String(authenticationToken);
            <span class="hljs-keyword">var</span> decodedAuthenticationToken = Encoding.UTF8.GetString(tokenFromBase64);
            <span class="hljs-keyword">var</span> usernamePasswordArray = decodedAuthenticationToken.Split(<span class="hljs-string">':'</span>);
            <span class="hljs-keyword">var</span> userName = usernamePasswordArray[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">var</span> password = usernamePasswordArray[<span class="hljs-number">1</span>];<font></font>
<font></font>
            <span class="hljs-keyword">var</span> isValid = userName == BasiAuthConf.Login &amp;&amp; password == BasiAuthConf.Password;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (isValid)<font></font>
            {<font></font>
                <span class="hljs-keyword">var</span> principal = <span class="hljs-keyword">new</span> GenericPrincipal(<span class="hljs-keyword">new</span> GenericIdentity(userName), <span class="hljs-literal">null</span>);<font></font>
                Thread.CurrentPrincipal = principal;<font></font>
<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        HandleUnathorized(actionContext);<font></font>
    }<font></font>
<font></font>
    private <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> HandleUnathorized(HttpActionContext actionContext)<font></font>
    {<font></font>
        actionContext.Response = actionContext.Request.CreateResponse(<font></font>
            HttpStatusCode.Unauthorized<font></font>
        );<font></font>
<font></font>
        actionContext.Response.Headers.Add(<font></font>
            <span class="hljs-string">"WWW-Authenticate"</span>, <span class="hljs-string">"Basic Scheme='Data' location = 'http://localhost:"</span><font></font>
        );<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, el proceso se ve as√≠:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El frente env√≠a una solicitud http a ReportService;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportService env√≠a una solicitud http a ReportProxy;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportProxy a trav√©s de la interfaz SOAP recibe datos de SSRS y env√≠a el resultado a ReportService;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportService trae el resultado de acuerdo con el contrato y se lo entrega al cliente.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenemos un sistema de trabajo que solicita una lista de plantillas disponibles, va a SSRS para obtener informes y las entrega al frente en cualquier formato compatible. </font><font style="vertical-align: inherit;">Ahora debe mostrar los informes generados en el frente de acuerdo con los par√°metros especificados, dar la oportunidad de cargarlos en archivos XLS, PDF, DOCX e imprimir. </font><font style="vertical-align: inherit;">Comencemos con la pantalla.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajar con informes SSRS en el portal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primera vista, es un asunto cotidiano: el informe viene en formato HTML, por lo que podemos hacer lo que queramos con √©l. </font><font style="vertical-align: inherit;">Lo incrustaremos en la p√°gina, lo matizaremos con estilos de dise√±o, y la cosa est√° en el sombrero. </font><font style="vertical-align: inherit;">De hecho, result√≥ que hab√≠a suficientes dificultades. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seg√∫n el concepto de dise√±o, la secci√≥n de informes en el portal debe constar de dos p√°ginas: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) una lista de plantillas donde podemos:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ver estad√≠sticas sobre actividades para todo el portal;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ver todas las plantillas disponibles para nosotros;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haga clic en la plantilla deseada y vaya al generador de informes correspondiente.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/yx/tp/1h/yxtp1h3tvvpujymptptca2gcyew.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) un generador de informes que nos permite:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">establecer par√°metros de plantilla y crear un informe sobre ellos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ver lo que sucedi√≥ como resultado;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seleccione el formato del archivo de salida, desc√°rguelo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imprima el informe de forma conveniente y visual.</font></font></li>
</ul><br>
 <img src="https://habrastorage.org/webt/au/ct/2f/auct2fiklpvvfad6vpbovv0xat0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hubo problemas especiales con la primera p√°gina, por lo que no la consideraremos m√°s. </font><font style="vertical-align: inherit;">Y el generador de informes nos oblig√≥ a encender el ingeniero, por lo que ser√≠a conveniente para personas reales usar todas las funciones en TK.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problema n√∫mero 1. </font><font style="vertical-align: inherit;">Mesas gigantes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seg√∫n el concepto de dise√±o, esta p√°gina debe tener un √°rea de visualizaci√≥n para que el usuario pueda ver su informe antes de exportarlo. Si el informe no cabe en la ventana, puede desplazarse horizontal y verticalmente. Al mismo tiempo, un informe t√≠pico puede alcanzar tama√±os de varias pantallas, lo que significa que debemos pegar bloques con los nombres de filas y columnas. Sin esto, los usuarios tendr√°n que regresar constantemente a la parte superior de la tabla para recordar qu√© significa una celda en particular. O, en general, ser√° m√°s f√°cil imprimir un informe y mantener constantemente las hojas necesarias frente a sus ojos, pero luego la tabla en la pantalla simplemente pierde su significado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, los bloques pegados no se pueden evitar. Y SSRS 2014 no sabe c√≥mo arreglar filas y columnas en un documento MHTML, solo en su propia interfaz web.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ recordamos que los navegadores modernos admiten la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propiedad adhesiva CSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que solo proporciona la funci√≥n que necesitamos. Ponemos posici√≥n: pegajoso en el bloque marcado, especificamos la sangr√≠a a la izquierda o en la parte superior (izquierda, propiedades superiores), y el bloque permanecer√° en su lugar durante el desplazamiento horizontal y vertical. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesita encontrar un par√°metro que CSS pueda alcanzar. Los valores de celda personalizados que permiten que SSRS 2014 los capture en la interfaz web se pierden al exportar a HTML. Bien, los marcaremos nosotros mismos, solo entender√≠amos c√≥mo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de varias horas de lectura de documentaci√≥n y discusiones con colegas, parec√≠a que no hab√≠a opciones. Y aqu√≠, seg√∫n todas las leyes de la trama, el campo de informaci√≥n sobre herramientas apareci√≥ para nosotros, lo que nos permite especificar informaci√≥n sobre herramientas para las celdas. Result√≥ que se arroja al c√≥digo HTML exportado en el atributo de informaci√≥n sobre herramientas, exactamente en la etiqueta que pertenece a la celda personalizada en las Herramientas de datos de SQL Server. No hab√≠a otra opci√≥n: no encontramos otra forma de marcar las c√©lulas para su fijaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, debe crear reglas de marcado y reenviar marcadores en HTML a trav√©s de la informaci√≥n sobre herramientas. Luego, usando JS, cambiamos el atributo de informaci√≥n sobre herramientas a la clase CSS en el marcador especificado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo hay dos formas de arreglar las celdas: verticalmente (columna fija) y horizontalmente (fila fija). </font><font style="vertical-align: inherit;">Tiene sentido colocar otro marcador en las celdas de la esquina, que permanecen en su lugar cuando se desplaza en ambas direcciones, fijo-ambos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El siguiente paso es hacer la interfaz de usuario. </font><font style="vertical-align: inherit;">Cuando recibe un documento HTML, necesita encontrar todos los elementos HTML con marcadores en √©l, reconocer los valores, establecer la clase CSS adecuada y eliminar el atributo de informaci√≥n sobre herramientas para que no salga al pasar el mouse sobre √©l. </font><font style="vertical-align: inherit;">Cabe se√±alar que el marcado resultante consiste en tablas anidadas (etiquetas de tabla).</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ver c√≥digo</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">type FixationType = <span class="hljs-string">'row'</span> | <span class="hljs-string">'column'</span> | <span class="hljs-string">'both'</span>;<font></font>
<font></font>
init(reportHTML: HTMLElement) {<font></font>
    <span class="hljs-comment">//    </span><font></font>
<font></font>
    <span class="hljs-comment">// -  </span>
    <span class="hljs-keyword">const</span> rowsFixed: NodeList = reportHTML.querySelectorAll(<span class="hljs-string">'[title^="RowFixed"]'</span>);
    <span class="hljs-comment">// -  </span>
    <span class="hljs-keyword">const</span> columnFixed: NodeList = reportHTML.querySelectorAll(<span class="hljs-string">'[title^="ColumnFixed"]'</span>);
    <span class="hljs-comment">// -    </span>
    <span class="hljs-keyword">const</span> bothFixed: NodeList = reportHTML.querySelectorAll(<span class="hljs-string">'[title^="BothFixed"]'</span>);<font></font>
<font></font>
    <span class="hljs-keyword">this</span>.prepare(rowsFixed, <span class="hljs-string">'row'</span>);
    <span class="hljs-keyword">this</span>.prepare(columnFixed, <span class="hljs-string">'column'</span>);
    <span class="hljs-keyword">this</span>.prepare(bothFixed, <span class="hljs-string">'both'</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    </span>
prepare(nodeList: NodeList, <span class="hljs-attr">fixingType</span>: FixationType) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeList.length; i++) {
        <span class="hljs-keyword">const</span> element: HTMLElement = nodeList[i];
        <span class="hljs-comment">//   -</span>
        element.classList.add(fixingType + <span class="hljs-string">'-fixed'</span>);<font></font>
<font></font>
        element.removeAttribute(<span class="hljs-string">'title'</span>);<font></font>
        element.removeAttribute(<span class="hljs-string">'alt'</span>); <span class="hljs-comment">//   SSRS</span><font></font>
<font></font>
        element.parentElement.classList.add(fixingType  + <span class="hljs-string">'-fixed-parent'</span>);<font></font>
<font></font>
        <span class="hljs-comment">//     ,     </span>
        element.style.width = element.getBoundingClientRect().width  + <span class="hljs-string">'px'</span>;
        <span class="hljs-comment">//     ,     </span>
        element.style.height = element.getBoundingClientRect().height  + <span class="hljs-string">'px'</span>;<font></font>
<font></font>
        <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">this</span>.calculateCellCascadeParams(element, fixingType);<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y aqu√≠ hay un nuevo problema: con el comportamiento en cascada, cuando varios bloques que se mueven en una direcci√≥n se fijan a la vez en la tabla, las celdas que van una tras otra se colocar√°n en capas. </font><font style="vertical-align: inherit;">Al mismo tiempo, no est√° claro cu√°nto debe retirarse cada bloque siguiente: las sangr√≠as deber√°n calcularse a trav√©s de JavaScript en funci√≥n de la altura del bloque que se encuentra frente a √©l. </font><font style="vertical-align: inherit;">Todo esto se aplica a los anclajes verticales y horizontales.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El script de correcci√≥n resolvi√≥ el problema.</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">//      </span>
calculateCellCascadeParams(cell: HTMLElement, <span class="hljs-attr">fixationType</span>: FixationType) {
    <span class="hljs-keyword">const</span> currentTD: HTMLTableCellElement = cell.parentElement;
    <span class="hljs-keyword">const</span> currentCellIndex = currentTD.cellIndex;<font></font>
<font></font>
    <span class="hljs-comment">//   </span>
    currentTD.style.left = <span class="hljs-string">''</span>;<font></font>
    currentTD.style.top = <span class="hljs-string">''</span>;<font></font>
<font></font>
    <span class="hljs-keyword">const</span> currentTDStyles = getComputedStyle(currentTD);<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">if</span> (fixationType === <span class="hljs-string">'row'</span> || fixationType === <span class="hljs-string">'both'</span>) {
        <span class="hljs-keyword">const</span> parentRow: HTMLTableRowElement = currentTD.parentElement;<font></font>
<font></font>
        <span class="hljs-comment">//        </span>
        <span class="hljs-comment">//    .</span>
        <span class="hljs-comment">//   ,    .</span>
        <span class="hljs-keyword">let</span> previousRow: HTMLTableRowElement = parentRow;
        <span class="hljs-keyword">let</span> topOffset = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">while</span> (previousRow = previousRow.previousElementSibling) {
            <span class="hljs-keyword">let</span> previousCellIndex = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">let</span> cellIndexBulk = <span class="hljs-number">0</span>;<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; previousRow.cells.length; i++) {
                <span class="hljs-keyword">if</span> (previousRow.cells[i].colSpan &gt; <span class="hljs-number">1</span>) {<font></font>
                    cellIndexBulk += previousRow.cells[i].colSpan;<font></font>
                } <span class="hljs-keyword">else</span> {<font></font>
                    cellIndexBulk += <span class="hljs-number">1</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> ((cellIndexBulk - <span class="hljs-number">1</span>) &gt;= currentCellIndex) {<font></font>
                    previousCellIndex = i;<font></font>
                    <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">const</span> previousCell = previousRow.cells[previousCellIndex];<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (previousCell.classList.contains(fixationType + <span class="hljs-string">'_fixed_parent'</span>)) {<font></font>
                topOffset += previousCell.getBoundingClientRect().height;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (topOffset &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">if</span> (currentTDStyles.top) {<font></font>
                topOffset += &lt;any&gt;currentTDStyles.top.replace('px', '') - 0;<font></font>
            }<font></font>
<font></font>
            currentTD.style.top = topOffset + 'px';<font></font>
        }<font></font>
    }<font></font>
<font></font>
    //  <font></font>
    if (fixationType === 'column' || fixationType === 'both') {<font></font>
        //       <font></font>
        //     .<font></font>
        //   ,    .<font></font>
        let previousCell: HTMLTableCellElement = currentTD;<font></font>
        let leftOffset = 0;<font></font>
<font></font>
        while (previousCell = previousCell.previousElementSibling) {<font></font>
            if (previousCell.classList.contains(fixationType + '_fixed_parent')) {<font></font>
                leftOffset += previousCell.getBoundingClientRect().width;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        if (leftOffset &gt; 0) {<font></font>
            if (currentTDStyles.left) {<font></font>
                leftOffset += &lt;any&gt;currentTDStyles.left.replace('px', '') - 0;<font></font>
            }<font></font>
<font></font>
            currentTD.style.left = leftOffset + 'px';<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo verifica las etiquetas de los elementos marcados y agrega los par√°metros de las celdas fijas al valor de sangr√≠a. </font><font style="vertical-align: inherit;">En el caso de las filas adherentes, su altura se suma, para las columnas, su ancho. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/vj/ix/bf/vjixbfnbewh6_pb3smfcogdpevc.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un ejemplo de un informe con una l√≠nea superior adhesiva.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como resultado, el proceso se ve as√≠:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenemos el marcado de SSRS y lo pegamos en el lugar correcto en el DOM;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reconocer marcadores;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajuste los par√°metros para el comportamiento en cascada.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que el comportamiento de bloqueo se implementa completamente a trav√©s de CSS, y JS solo participa en la preparaci√≥n del documento entrante, la soluci√≥n funciona lo suficientemente r√°pido y sin retrasos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desafortunadamente, para IE, los bloques pegados tuvieron que desactivarse porque </font><font style="vertical-align: inherit;">no es compatible con la posici√≥n: propiedad adhesiva. </font><font style="vertical-align: inherit;">El resto, Safari, Mozilla Firefox y Chrome, hacen un excelente trabajo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Siga adelante.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problema n√∫mero 2. </font><font style="vertical-align: inherit;">Informe de exportaci√≥n</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para extraer un informe del sistema, debe (1) acceder al SSRS a trav√©s de ReportService para un objeto Blob, (2) obtener un enlace al objeto a trav√©s de la interfaz utilizando el m√©todo window.URL.createObjectURL, (3) colocar el enlace en la etiqueta y simular un clic para Subir archivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto funciona en Firefox, Safari y en todas las versiones de Chrome, excepto Apple. Para que IE, Edge y Chrome para iOS tambi√©n soportaran la funci√≥n, tuve que retroceder.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En IE y Edge, el evento simplemente no activar√° una solicitud del navegador para descargar el archivo. Estos navegadores tienen una funci√≥n tal que para simular un clic, se requiere la confirmaci√≥n del usuario para descargar, as√≠ como una clara indicaci√≥n de acciones adicionales. La soluci√≥n se encontr√≥ en el m√©todo window.navigator.msSaveOrOpenBlob (), que est√° disponible tanto en IE como en Edge. Simplemente sabe c√≥mo pedirle permiso al usuario para la operaci√≥n y aclarar qu√© hacer a continuaci√≥n. Entonces, determinamos si existe el m√©todo window.navigator.msSaveOrOpenBlob y actuamos en funci√≥n de la situaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chrome en iOS no ten√≠a ese truco y, en lugar de un informe, obtuvimos solo una p√°gina en blanco. </font><font style="vertical-align: inherit;">Deambulando por la Web, encontramos una historia similar, juzgando por qu√© en iOS 13 este error deber√≠a haberse solucionado. </font><font style="vertical-align: inherit;">Desafortunadamente, escribimos la aplicaci√≥n en los d√≠as de iOS 12, por lo que al final decidimos no perder m√°s tiempo y simplemente apagamos el bot√≥n en Chrome para iOS. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora sobre c√≥mo se ve el proceso de exportaci√≥n final a la interfaz de usuario. </font><font style="vertical-align: inherit;">Hay un bot√≥n en el componente de informe angular que inicia una cadena de pasos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a trav√©s de los par√°metros del evento, el controlador recibe el identificador del formato de exportaci√≥n (por ejemplo, "PDF");</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Env√≠a una solicitud a ReportService para recibir un objeto Blob para el formato especificado;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comprueba si el navegador es IE o Edge;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuando la respuesta proviene de ReportService:</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si es IE o Edge, llama a window.navigator.msSaveOrOpenBlob (fileStream, fileName);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de lo contrario, llama al m√©todo this.exportDownload (fileStream, fileName), donde fileStream es el Blob obtenido de la solicitud a ReportService, y fileName es el nombre del archivo a guardar. </font><font style="vertical-align: inherit;">El m√©todo crea una etiqueta oculta con un enlace a window.URL.createObjectURL (fileStream), simula un clic y elimina la etiqueta.</font></font></li>
</ul></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con esto resuelto, la √∫ltima aventura permaneci√≥.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problema n√∫mero 3. </font><font style="vertical-align: inherit;">Imprimir</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora podemos ver el informe en el portal y exportarlo a formatos XLS, PDF, DOCX. </font><font style="vertical-align: inherit;">Queda por implementar la impresi√≥n del documento para obtener un informe preciso de varias p√°ginas. </font><font style="vertical-align: inherit;">Si la tabla result√≥ estar dividida en p√°ginas, cada una de ellas deber√≠a contener encabezados, los mismos bloques adhesivos de los que hablamos en la secci√≥n anterior. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La opci√≥n m√°s f√°cil es tomar la p√°gina actual con el informe mostrado, ocultar todo lo superfluo usando CSS y enviarlo a imprimir usando el m√©todo window.print (). </font><font style="vertical-align: inherit;">Este m√©todo no funciona de inmediato por varias razones:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Årea de visualizaci√≥n no est√°ndar: el informe en s√≠ est√° contenido en un √°rea desplazable por separado para que la p√°gina no se extienda a dimensiones horizontales incre√≠bles. </font><font style="vertical-align: inherit;">El uso de window.print () recorta el contenido que no se ajusta a la pantalla;</font></font></li>
<li>   ,      ;</li>
<li>     ,       .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo esto se puede solucionar con JS y CSS, pero decidimos ahorrar tiempo a los desarrolladores y buscar una alternativa a window.print (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSRS puede darnos de inmediato un PDF listo para usar con una paginaci√≥n presentable. Esto nos salva de todas las dificultades de la versi√≥n anterior, la √∫nica pregunta es, ¬øpodemos imprimir el PDF a trav√©s de un navegador? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debido a que PDF es un est√°ndar de terceros, los navegadores lo admiten a trav√©s de varios complementos de visor. Sin plug-in, sin dibujos animados, por lo que nuevamente necesitamos una opci√≥n alternativa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øY si coloca el PDF en la p√°gina como una imagen y env√≠a esta p√°gina para imprimir? Ya hay bibliotecas y componentes para Angular que proporcionan esa representaci√≥n. Buscado, experimentado, implementado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para no tratar con los datos que no queremos imprimir, se decidi√≥ transferir el contenido representado a una nueva p√°gina, y all√≠ ya se ejecuta window.print (). </font><font style="vertical-align: inherit;">Como resultado, todo el proceso es el siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solicite ReportService para exportar el informe en formato PDF;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenemos el objeto Blob, lo convertimos en una URL (URL.createObjectURL (fileStream)), le damos la URL al visor de PDF para su representaci√≥n;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tomamos im√°genes del visor de PDF;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abra una nueva p√°gina y agregue un peque√±o marcado all√≠ (t√≠tulo, una peque√±a sangr√≠a);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregue la imagen del visor de PDF al marcado, llame a window.print ().</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de varias verificaciones, tambi√©n apareci√≥ un c√≥digo JS en la p√°gina, que, antes de imprimir, verifica que todas las im√°genes se hayan cargado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, la apariencia completa del documento est√° determinada por los par√°metros de la plantilla SSRS, y la interfaz de usuario no interfiere con este proceso. </font><font style="vertical-align: inherit;">Esto reduce la cantidad de posibles errores. </font><font style="vertical-align: inherit;">Dado que las im√°genes se transfieren para su impresi√≥n, estamos asegurados contra cualquier da√±o o deformaci√≥n del dise√±o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n hay desventajas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un gran informe pesar√° mucho, lo que afectar√° negativamente a las plataformas m√≥viles;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el dise√±o no se actualiza autom√°ticamente: los colores, las fuentes y otros elementos de dise√±o deben instalarse a nivel de plantilla.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, no se esperaba la adici√≥n frecuente de nuevas plantillas, por lo que la soluci√≥n era aceptable. </font><font style="vertical-align: inherit;">El rendimiento m√≥vil se ha dado por sentado.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La √∫ltima palabra</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As√≠ es como un proyecto normal nos hace buscar soluciones simples para tareas no triviales. </font><font style="vertical-align: inherit;">El producto final cumple totalmente con los requisitos de dise√±o y se ve hermoso. </font><font style="vertical-align: inherit;">Y lo m√°s importante, aunque no tuvimos que buscar los m√©todos de implementaci√≥n m√°s obvios, la tarea se complet√≥ m√°s r√°pido que si asumi√©ramos el m√≥dulo de informe original con todas las consecuencias. </font><font style="vertical-align: inherit;">Y al final, pudimos centrarnos en los objetivos comerciales del proyecto.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es487690/index.html">PHP Digest No. 173 (27 de enero - 10 de febrero de 2020)</a></li>
<li><a href="../es487694/index.html">C√≥mo Yandex.Cloud est√° alojado en Virtual Private Cloud y c√≥mo nuestros usuarios nos ayudan a implementar funciones √∫tiles</a></li>
<li><a href="../es487696/index.html">Eventos digitales en Mosc√∫ del 10 al 16 de febrero.</a></li>
<li><a href="../es487698/index.html">Eventos digitales en San Petersburgo del 10 al 16 de febrero.</a></li>
<li><a href="../es487702/index.html">Una selecci√≥n de art√≠culos sobre aprendizaje autom√°tico: estudios de casos, gu√≠as e investigaciones para enero de 2020</a></li>
<li><a href="../es487706/index.html">Descubrimiento de servicios en sistemas distribuidos utilizando el ejemplo de Consul. Alexander Sigachev</a></li>
<li><a href="../es487716/index.html">Perfecto SAST. Analizador</a></li>
<li><a href="../es487720/index.html">Sobre el corutinismo competitivo (usando la programaci√≥n reactiva como ejemplo)</a></li>
<li><a href="../es487724/index.html">BlazingPizza: aplicaci√≥n Blazor de principio a fin. Parte 2. Agregar un componente</a></li>
<li><a href="../es487728/index.html">Compilaci√≥n de @Pythonetc, enero de 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>