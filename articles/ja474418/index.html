<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤘🏻 ◼️ 🧐 DEFCON 27カンファレンス。macOSのハッカー製品の恩恵を受けています。パート1 😠 🤶🏿 🤳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ブリーフィングスピーチ。 macOSのマルウェアの新しいサンプルが発見されると、それは私たち自身の利益のために使用できる新しいハッキングの機会を評価する機会を私たちに提供します。つまり、人生は短いのですが、なぜあなた自身のマルウェアを書くのに費やすのでしょうか？
 
 まず、既存のマルウェアの「個人...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>DEFCON 27カンファレンス。macOSのハッカー製品の恩恵を受けています。パート1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/474418/"><blockquote><sup><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブリーフィングスピーチ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 macOSのマルウェアの新しいサンプルが発見されると、それは私たち自身の利益のために使用できる新しいハッキングの機会を評価する機会を私たちに提供します。つまり、人生は短いのですが、なぜあなた自身のマルウェアを書くのに費やすのでしょうか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、既存のマルウェアの「個人使用」に適応するための方法論について説明し、このアプローチの欠点と利点の両方を強調します。次に、インタラクティブなバックドア、ファイルの引き出し用の埋め込み、ランサムウェア、そしてもちろん、アドウェアなど、macOSのさまざまなマルウェアサンプルの兵器化について説明します。私たちの設定には、これらの悪意のあるプログラムが私たち自身のC＆Cサーバーからのタスクを受け入れたり、自動的にアクションを実行したりする、ランタイム環境のさまざまなバイナリ変更が含まれています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tv/rl/4e/tvrl4ea4ei1bog3dekukhvmico8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、元の状態では、これらのサンプルはアンチウイルス製品によって検出されています。したがって、従来のアンチウイルスプログラムの「ハッカー」ツールが見えないようにする変更を検討します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論として、Macユーザーをこのような変更された脅威から保護するために、このような脅威を検出できる新しいヒューリスティック手法を検討します。なぜこれが必要なのですか？これは人間の開発の通常のサイクルであり、私たちが目にする破壊が新しい技術の導入を意味し、新しい仕事を生み出す前に古いものを破壊することを理解していないからです。</font></font></sup></blockquote><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本日は、macOSハッキング製品に基づいて「大量破壊兵器」を作成するトピックについて説明します。私の名前はパトリックです。私はデジタルセキュリティのSynackアナリストです。また、MacセキュリティWebサイトとmacOS用の無料のObjective-Seeセキュリティスイートの作成者でもあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の人のマルウェアを自分たちの秘密の目的で作り直すことについて話し、これがなぜ素晴らしいアイデアなのかを説明します。次に、Mac向けのマルウェアのさまざまなサンプルがどのように正確に再作成されるかを示します。これは、エクスプロイトがAppleの組み込みのウ​​イルス対策サービスとサードパーティのウイルス対策ソフトウェアの両方から見えないようにするためです。最後に、このやり直したソフトウェア製品を検出するためのさまざまな一般的な手法について説明します。実際、私たちの最終的な目標は、Macユーザーがそのような脅威から確実に保護されるようにすることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自分のニーズに合わせてマルウェアを転用するプロセスを概念的に説明するスキームから始めましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ar/0h/qq/ar0hqqjxnmmdzvxhgdyo22--8bc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハッカーAが注意深く洗練されたフル機能のマルウェアを開発し、世界中のさまざまなコンピューターシステムに感染させたとします。ハッカーBは、偶然または感染したシステムから抽出して、このマルウェアを手に入れました。このハッカーは、この製品のサンプルを彼の研究室に置き、再プロファイルします。プロファイリングとは、既存のマルウェアの一部をお客様のニーズに合わせて再設計または再構成することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スライドは、改造後、ハッカーBがハッカーAが開発したインフラストラクチャとは異なるインフラストラクチャに対して、新しい目標に対してこのソフトウェアを使用できることを示しています。これはかなり合理的なアイデアです。なぜこれが必要なのかと尋ねるかもしれませんが、これを行う価値のある理由を少なくとも2つ挙げることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/je/92/ar/je92arzrz5ywc4c2ehpl1yijpci.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、資金が豊富な組織、非常にやる気があり技術的に武装したグループ、CIAなどの政府機関で働いているハッカーや、信じられないほど悪意のあるソフトウェアを開発している科学研究所全体があります。さらに、このフル機能のソフトウェアは、フィールドで繰り返しテストされています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はかなり怠惰で、コーディングするのではなく、ビーチでくつろいだり、サーフィンやヨガをしたりすることを好みます。これらの人たちはこのような効果的なハッカーソフトウェアを作成しているので、それを使用してニーズに合わせて作り直してみませんか？より多くの時間とお金を持っている人に私のためにすべてのハードワークをさせてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二に、誰かが変換されたプログラムを発見した場合でも、それらの作者は元の開発者に帰属し、私たちに帰属しません。これは非常に良いことです。 「パトリック、これが素晴らしいアイデアだとしたら、なぜ人々はまだこれをしていないのですか？」私は答えます：「彼らはこれをやっている！」特にコメントすることはできませんが、公開されたスライドは、NSAがマルウェアの再プロファイリングを使用して、一般的なウイルス対策プログラムの脆弱性をテストしたことを示しています。 New York Timesは、中国のハッカーも同様の手法を使用していると報告しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
やり直したハッカーソフトウェアを使用すると、これらの裕福な機関に二重の利点があります。まず、他の国で開発されたスパイウェアを、別の機関、別の国、またはサイバースパイ活動のAPTグループがすでにほとんどリスクなしに取り組んでいるという目標に反して使用しています。たとえば、NSAで作業していて、他のハッカーがすでに実行しているオブジェクトにハッキングしようとしているが、そこに独自のコードを挿入したくない場合は、他の人のソフトウェアを安全に再利用できます。同時に、そもそも疑われている人がすでにいるので、あなたの活動は秘密のままです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yi/v2/go/yiv2golydkeg9sy7da-izvcobzq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのような機関は密かに働くことを好むので、彼らはそのような問題への彼らの参加について学ぶ誰にも興味がなく、やり直したソフトウェアはこれに貢献します。もちろん、ハッカープログラムの改変に伴い、今日お話しする問題があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/81/en/bi81enenfuz14twl3sjbqwh2qwe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これらの問題は克服できないものではないことがわかります。他の誰かのマルウェアを乗っ取ってリメイクしたとします。まず、ソースコードがなく、バイナリコードのサンプルしかないため、リバースエンジニアリングを使用する必要があります。このソフトウェアが何をするか、どのように実装されるか、どのようにインストールされるか、どのような機能があるかを理解しようとするとき、これを分析の段階と呼びます。もちろん、通信するC＆Cサーバーを見つけます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらすべてに対処した後、第2段階が始まります。このマルウェアにパッチを適用する方法を考え出します。ソースがないため、バイナリレベルでパッチを開発しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの場合、このソフトウェアは独自のC＆Cサーバーと対話するため、このサーバーのアドレスを取得する場所と、データ交換に使用されるプロトコルを見つける方法がわかります。その後のみ、そこから、やり直したソフトウェアが展開される独自のC＆Cサーバーを作成し、新しい感染システムと対話することができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはよく知られているマルウェアを使用しているため、Appleまたはその他のウイルス対策セキュリティシステムには、この脅威のシグネチャが含まれている可能性があります。したがって、再プロファイリングの最終段階で、やり直しソフトウェアの検出を防ぐ方法を理解する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本当に悪いことを起こしたくない場合は、責任を持って再プロファイリングを行う必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dw/pm/vf/dwpmvfoigcizeeajk4o828oppo4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
macOS用のマルウェアを作り直そうとした例を紹介しましょう。パッチプロセス中に、バックアップアドレスをハッカーのC＆Cサーバーに変更するのを忘れていました。マルウェアの完全にやり直した部分を使用していることは確かでしたが、ある時点で、元のハッカーサーバーにバックアップを送信し、攻撃対象のインフラストラクチャにアクセスできるようにしました。したがって、他の人のソフトウェアの改変には非常に注意深く取り組む必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Mac用のマルウェアの再作​​成について具体的に説明します。その目的は、他の誰かのハッカーソフトウェアを作成することです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8p/av/zi/8pavzimr-jwncqt12sypeb-vbeg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のステップは、2つの基準に基づいて、変換するマルウェアのサンプルを選択することです。 1つ目は、このマルウェアが、インタラクティブなバックドアが必要か、暗号マイナーなどが必要かを判断できるようにすることです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oq/ko/r0/oqkor0zgt6egkpgqcg0heexqbx4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく、スパイウェアの帰属は、CIAまたはロシアのハッカーによるものかどうかに関係なく重要です。 Objective-See.comでは、macOS用の印象的なマルウェアのコレクションをまとめました。今日お話しするやり直しソフトウェアのすべてのサンプルは、このサイトからダウンロードできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変更するサンプルを選択したら、分析の時間になります。その主な目的は、リモートアクセスのようなものを見つけることです。マルウェアがリモートのC＆Cサーバーにアクセスする場合、それがどのようなサーバーであるか、および後で連絡できないようにソフトウェアを変更できるかどうかを確認する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/el/19/oz/el19ozfoidikywbelmn87bjzbao.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルウェアがリモートサーバーと通信しない場合でも、このプログラムが再度接続したときにこのプログラムを混乱させる方法を知るために、プロトコルに対処する必要があります。そしてもちろん、このマルウェアの機能を完全に理解する必要があります-マルウェアをリモート制御するために使用できるコマンドを知るために、それがどのように機能し、リモートを含むシステムとどのように相互作用するか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを理解したら、次は再構成またはプロファイルの作成を行います。これは通常、マルウェアにバイナリレベルでパッチを適用する必要があることを意味します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/op/2b/am/op2bamloaosdoqg6wkhjbv-sik0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスライドは、コードに埋め込まれた元のC＆Cサーバーのアドレスを見つけて、HEXエディターで必要なアドレスに置き換えることができることを示しています。つまり、変更後、このソフトウェアは私たち自身のサーバーと通信し、そこからタスクを受け取ることができるようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、マルウェアがバックドアまたは埋め込みであり、元のC＆Cサーバーから制御される場合は、独自の管理サーバーを作成し、プログラムが確実にログインし、それに接続されていることを確認して、すべての機能をリモートで使用できるようにする必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kf/i9/cn/kfi9cnlonrkb7gwzsdwrtprreta.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カスタムC＆Cサーバーは複雑すぎず、有能なPythonスクリプトを作成するだけですが、多くの目標に対してソフトウェアを使用する場合は、もっと深刻なものが必要になる場合があります。</font><font style="vertical-align: inherit;">以前のDefConは、ソフトウェアサンプルを分析するためにこれらのC＆Cサーバーの1つを作成する方法を述べました。</font><font style="vertical-align: inherit;">分析する各サンプルは、異なるプロトコルを使用する他のサンプルとは異なる可能性が高いため、変換されたソフトウェアのサンプルごとに個別のC＆Cサーバーが必要になります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FruitFlyバックドアの再作成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mac向けのマルウェア再設計の実際のサンプルを見てみましょう。 Macのセキュリティ専門家が最近発見した約15年前に作成されたこのバックドアは、FruitFlyまたはFruit Flyと呼ばれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リモートマルチタスクをサポートするこのフル機能のバックドアは、再プロファイリングの理想的な候補として私たちに役立っています。ファイルやシステムプロセスへの感染、ウェブカメラの制御、コマンドライン、キーロガーとしての機能、リモートで被害者のデスクトップのスクリーンショットを撮ることができ、macOSを実行している感染したコンピュータに関する情報を収集することができます。これらすべての機能を使用して、私たち自身の問題を解決するつもりでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/q2/ig/bv/q2igbv8bxidoucqh398afrut0w4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FruitFlyバックドアは非常にわかりにくいPerlスクリプトでしたが、注意深く見ると、そのロジックがコマンドライン引数を処理していることがわかります。このスクリプトは、特定のコマンドラインオプションまたはフラグが原因で何かが実行されているかどうかを確認していると言えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/m_/jc/ho/m_jchouqkbuxw5dh0zi7rafbayg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼は、コンピュータをC＆Cサーバーに接続するためのポートまたはポートの組み合わせを探していることがわかりました。つまり、コマンドラインを使用して独自のサーバーへの方向を作成できれば、元のPerlスクリプトや悪意のあるバイナリをやり直す必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このFruitFlyスクリプトをランチャーとして保存できるかどうかを考え始めました。スライドに示すように、独自のC＆Cサーバーのアドレスを埋め込むことができます。つまり、元のハッカーサーバーとの接続をバイパスして、このバックドアを簡単に再プロファイルしてサーバーに接続できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8k/9k/hc/8k9khcoxopqticqaojsmrgwdhig.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、このバックドアを使用するには、ユーザーのコンピューターにインストールする必要があります。嬉しいことに、pastebin.comから入手できるそのようなインストーラーをすでに書いています。これは、元のバックドアとまったく同じ方法でマルウェアをインストールする数行のコードです。このサンプルを分析するためにC＆Cサーバーも以前に作成したので、その動作のデモンストレーションを開始できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなリアルタイムのデモは常にリスクを伴うため、このマルウェアは仮想マシンではなく、自分の研究用ラップトップで実行します。繰り返します-変換されたマルウェアの全力をお見せするつもりです。実際の状況でのデモの方が信頼できるので、実際のハードウェアで動作しているこのソフトウェアを見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず最初に、C＆Cサーバーを起動します。システムが接続を待っていることがわかります。次に、インストーラーを介してマルウェアを実行し、このサーバーのIPアドレスを渡します。起動後、ウィンドウの右側にマルウェアがC＆Cサーバーに正常に接続されていることがわかります。また、このマルウェアが私の個人用ラップトップで実行されているプロセスに対して使用できるハッキングタスクもたくさんあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vl/n0/lw/vln0lwtlwelhpdr3y1v8zfasxkk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンド＃13を実行すると、このマルウェアがディレクトリ/ Users / Patrick / fpsaudのどこにインストールされているかがわかります。コマンド2を使用するとスクリーンショットを撮ることができ、パラメーター0を使用するとフルスクリーンのスクリーンショットを撮ることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mp/pc/3b/mppc3blujqwwj7mbaey7s33fvpg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、スクリーンショットを撮ってC＆Cサーバーに送信します。</font><font style="vertical-align: inherit;">ご覧のとおり、すべてが正常に機能しています。</font><font style="vertical-align: inherit;">これが、再設計されたFruitFlyバックドアの仕組みです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マイナーCreativeUpdateの変更</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、私たちの目的のためにCreativeUpdate暗号通貨マイナーを再作成することについて話します。</font><font style="vertical-align: inherit;">他の人のコンピュータを暗号マイニングに使用したいが、同時に時間、スキル、リソースがない場合に便利です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jg/wu/lp/jgwulpzh_d6c6qfz2fg597-cdrw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この暗号マイナーはトロイの木馬に統合され、MacUpdate.comから人気のあるサードパーティアプリケーションを通じて配布されます。</font><font style="vertical-align: inherit;">このスライドは、元のMozila開発者の署名がなく、いずれかのAdobe Creative Cloudサーバーからユーザーのコンピューターに暗号マイナーをダウンロードするFirefox Quantumブラウザーのインストール例を示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9a/ru/an/9aruanbz7pv85jg0irp7mgfjzb0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなトロイの木馬を含む感染したディスクイメージをマウントし、メインバイナリにリバースエンジニアリングを適用すると、「スクリプトを実行して実行する」-「スクリプトを実行して実行する」というメソッドが使用されることがわかります。それが逆コンパイラまたは逆アセンブラで何をするかを見ると、アプリケーションのリソースディレクトリの外にある「スクリプト」と呼ばれるファイルを実行するだけであることがわかります。まず、ユーザーが自分のコンピューターにダウンロードした人気のある製品（Firefoxブラウザーなど）のコピーを装ってトロイの木馬プログラムを起動するので、何も悪いことを疑うことはありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/ie/2e/yrie2eidsplxe3up0v9cb5nyy9o.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、このスクリプトでは、攻撃者のサーバーと通信しており、そこからmdworker.zipアーカイブをダウンロードしています。解凍中に、このアーカイブはmdworkerと呼ばれるものをシステムにインストールします。アーカイブから抽出されたMacOS.plistファイルを見ると、この非常に悪意のあるmdworkerバイナリがユーザーのコンピューターに保存されていることがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rx/i6/uq/rxi6uqgxuqtjbqcq5inuwtjuzag.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このバイナリに渡されるコマンドライン引数も確認できます。このバイナリmdworkerファイルを実行すると、鉱業会社Miner Gateが所有する完全に合法な暗号通貨マイナーであることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドライン引数は、マイニングの結果とマイニングの暗号通貨のタイプが送信されるマイナーアカウントも示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対応するパラメーターはコマンドラインを介して送信され、バイナリファイルには埋め込まれないため、Fruit Flyの場合と同様に、コマンドライン引数を代わりに使用して、このマルウェアを目的に再利用できます。したがって、まずプロパティリストのプロパティリストのファイルまたはマルウェアの.plistを変更して、自分のマイナーアカウントを指すようにし、マルウェアのすべてのコンポーネントをアーカイブに再度パックします。さらに、サーバーからアーカイブをダウンロードする代わりに、マルウェアアプリケーションに追加するだけです。起動するためにリモートサーバーを構成する必要がないため、これははるかに単純で自律的です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、スクリプトを再構成して、追加したアーカイブで機能するようにします。最後に、すべてをFirefox.dmgイメージに再パッケージ化し、開始できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xb/hl/c7/xbhlc73ts2ofwqfcdl0--pjifw4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つ目のデモに注目します。ファイルウィンドウに、悪意のあるスクリプト、mdworker.zipアーカイブ、アプリケーション設定ファイルAppSettings.plist、元のFirefoxブラウザなどのアプリケーションコンポーネントが表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qc/y9/0q/qcy90qwhi2c_htghgujrjbhlxog.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メインウィンドウで、ユーザーがダウンロードしたコンテンツが起動しようとしているように見えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/si/6-/qi/si6-qizmthmtmeipzrludaaxjne.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は自分のラップトップでこのアプリケーションを実行して、自分の暗号通貨マイニングに使用します。ブラウザーのアイコンをクリックすると、Firefoxブラウザーウィンドウが画面に表示され、外観はすべて問題なく表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプリケーションを起動した後、システムで実際に何が起こるかを確認するために、macOSターミナルウィンドウを画面に呼び出します。</font><font style="vertical-align: inherit;">マルウェアがどのようにインストールされ、mdworkerスクリプトが実行されているかがわかります。これは、すべてのマイニング操作がpatrick@objective-see.com宛に送信されるようにやり直しました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランサムウェアランサムウェア</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
お金を稼ぐ方法について話し始めたので、ランサムウェアランサムウェアプログラムを使用して、開発に時間を無駄にしないようにすることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7t/wn/rv/7twnrvk1wk853o2hvg_my32qkbm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例として、KeRangerアプリケーションを再作成する方法を見てみましょう。これは、ハッカーがmacOSコンピューターで使用した最初のフル機能のランサムウェアです。彼らはこのマルウェアに感染し、公式WebサイトでホストされているBit-Torrentファイルをダウンロードする人気のクライアントです。ユーザーがサイトにアクセスし、このクライアントをダウンロードすると、コンピューターが感染します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウイルスのバイナリコードは、感染するとGeneral.rtfというファイルが起動されることを示しています。テキストファイル拡張子がありますが、テキストではなく、macOSバイナリファイルです。数日間、スリープ状態になり、ハッカーのC＆Cサーバーに接続して、暗号化キーと復号化の指示を取得します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mi/eo/6i/mieo6iymxpoxcg116xarhs3izgg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、被害者のコンピューターのすべてのコンテンツをこのキーで暗号化し、ユーザーがMacを「フリーズ解除」するためにユーザーが実行しなければならない指示を画面に表示します。これは標準のランサムウェア手法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このソフトウェアを作り直すことについて話しましょう。まず、彼がサーバーに接続してファイルの暗号化を開始するのを3日間待ちたくありませんでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u6/ng/bt/u6ngbtuxi7brtza2nfjpth_l2zu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スライドを見るとわかるように、サーバーアドレスはランサムウェアバイナリに直接組み込まれているため、アプリケーションが「スリープ」状態のときにHEXエディターを使用してコードを貫通し、テスト用にローカルホスト127.0.0.1を使用してこのアドレスをC＆Cサーバーのアドレスに置き換えます。 。アプリケーションにはRSAキーと復号化の指示が必要なため、独自の公開RSAキーを取得し、指示と一緒にテキストファイルにパックして、サーバーを作成し、NetCatユーティリティを使用してそれに接続しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはすべて非常に簡単です。再利用されたKeRangerの動作を示すデモが表示されます。 NetCatは、元のハッカーサーバーではなく、サーバーへの接続を確立しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/an/fz/el/anfzelfpla0mab3nqouakkukl_w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ランサムウェアを起動するとすぐに、デスクトップ上のすべてのファイルの暗号化がバックグラウンドで開始されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/90/4c/nt/904cntgxcyw4fcvfxx1wogob-la.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
暗号化プロセスが完了すると、README_FOR_DECRIPT.txtを復号化するための手順が記載されたテキストファイルがデスクトップに表示されます。</font><font style="vertical-align: inherit;">ユーザーがそれを開くと、私のメッセージ「すべてのお金をwardle@objective-see.comに送ってください！」が表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/at/rf/ag/atrfagcuscbsrisiysy4atpxbhe.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンタルを作り直す</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
改造の最新モデルはウィンドトールと呼ばれます。これは、サイバー犯罪者のAPTグループの1つが開発した、複雑な持続的脅威に関連する優れたバックドアです。私たちは、彼らのエクスプロイトと私たちのニーズに合わせた独自のバックドアの両方を再プロファイルしようとしました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sk/ub/66/skub66ctvfoeenocme7-j8b0eea.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この攻撃の最も興味深い特性の1つは、マルウェア感染ベクトルです。ユーザーのコンピューターのオペレーティングシステムに感染する方法は、通常のmacOS関数、特にURLハンドラーを使用することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のブログでは、このプロセスの技術的な詳細が詳細に説明されていますが、ここで簡単に説明します。コンピューターにダウンロードされたアプリケーションがファイルシステムに保存されると、ユーザーがアプリケーションを起動する前に、macOSはカスタムURLハンドラーの内容を確認し、存在する場合はシステムがそれらを自動的に登録します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなハンドラーまたはアプリケーションが登録されると、たとえば、webページからmacOSがすぐに起動するURLにアクセスできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハッカーエクスプロイトはJavaで記述されており、2つの部分で構成されています。まず、Macオペレーティングシステムによって登録されたURLプロトコルハンドラースキームを含む悪意のあるアプリケーションがダウンロードされます。次に、Javaスクリプトの2番目の部分が使用され、マルウェアをダウンロードするこの登録済みURLハンドラーへの呼び出しが開始されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックドアの用語を使用すると、システムへの侵入の要素を含むエクスプロイトペイロードがあり、ユーザーファイルの収集と検査が可能になると言えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kw/-s/kf/kw-skfacnumohxmrjnbo_jkz9po.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセスモニターを実行すると、このマルウェアがシステムにどのように感染しているかを確認できます。</font><font style="vertical-align: inherit;">たとえば、組み込みの解凍ユーティリティを呼び出して、このエクスプロイトがユーザーのコンピューターから抽出するために準備したファイルを圧縮し、組み込みのシステムメカニズムを使用して攻撃者のC＆Cサーバーと通信し、盗んだファイルをそこに転送する方法を確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エクスプロイトはファイルアップロード機能もサポートしています。</font><font style="vertical-align: inherit;">逆アセンブラの機能を使用してSPF送信者ポリシーインフラストラクチャを見ると、一部の埋め込みC＆Cサーバーのアドレスが復号化され、ダウンロードされたファイルの名前の要求が開始され、最後にハッカーのC＆Cサーバーからこのファイルの要求が送信されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-q/ig/vd/-qigvdzvffym3nebnatyn_zvtek.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
24:00</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DEFCON 27カンファレンス。macOSのハッカー製品の恩恵を受けています。</font><font style="vertical-align: inherit;">パート2</font></font></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/InL3YA_6P6s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">広告のビット:)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いつもご利用いただきありがとうございます。</font><font style="vertical-align: inherit;">私たちの記事は好きですか？</font><font style="vertical-align: inherit;">もっと面白い資料を見たいですか？</font><font style="vertical-align: inherit;">注文やあなたの友人にそれを推薦することによって私たちをサポートしています</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 4.99からご開発者向けクラウドVPS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私たちはあなたのために発明したエントリーレベルのサーバのユニークなアナログのHabrユーザーのための30％割引</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（VPS（KVM）についての真実E5-2650 V4を6にコア）10GB DDR4 240GB SSD 1Gbps $ 20から、またはサーバーを共有するには？</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（オプションは、RAID1およびRAID10、最大24コア、最大40GB DDR4で利用可能です）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xdは2倍安いですか？</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">オランダでは、</font></b><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">199ドルから、インテルTetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV</font></a></b><font style="vertical-align: inherit;">を</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">2台</font></a></b><font style="vertical-align: inherit;">だけ持ってい</font><b><font style="vertical-align: inherit;">ます！</font></b></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デルR420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99から！</font></font></b></b><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">インフラストラクチャビルディングの構築方法</font></a><font style="vertical-align: inherit;">について</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">お</font></a><font style="vertical-align: inherit;">読みください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Dell R730xd E5-2650 v4サーバーを使用するクラスcは、1ペニーで9,000ユーロかかりますか？</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja474402/index.html">VavrコレクションAPIガイド</a></li>
<li><a href="../ja474404/index.html">Yandex（フロントエンド開発）2019のプログラミング選手権で解決された問題の分析</a></li>
<li><a href="../ja474406/index.html">ワイルドでのBlueKeepの初登場</a></li>
<li><a href="../ja474408/index.html">ページオブジェクトモデルの革命または進化？</a></li>
<li><a href="../ja474414/index.html">独自のボクセルエンジンを作成します</a></li>
<li><a href="../ja474420/index.html">Становление термостата: как это получилось</a></li>
<li><a href="../ja474424/index.html">混合トレーニング-それは何で、どのように機能するか</a></li>
<li><a href="../ja474426/index.html">アニメシリーズ「数学サークル」</a></li>
<li><a href="../ja474430/index.html">DevOpsDays Moscow-コミュニティがコミュニティのために行う会議</a></li>
<li><a href="../ja474434/index.html">PythonとDockerでサーバーの稼働時間を追跡する独自のTelegramボット</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>