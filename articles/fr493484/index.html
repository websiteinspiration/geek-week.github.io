<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👼🏻 🖌️ 💛 Votre C # est déjà «fonctionnel», laissez-le. 🤲🏿 👊🏾 📐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous présente la traduction de l'article original "Votre C # est déjà fonctionnel, mais seulement si vous le laissez" par Igal Tabac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Votre C # est déjà «fonctionnel», laissez-le.</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493484/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! Je vous présente la traduction de l'article original </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Votre C # est déjà fonctionnel, mais seulement si vous le laissez"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par Igal Tabachnik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a quelques jours, j'ai </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tweeté</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un extrait de code C # qui implémente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FizzBuzz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en utilisant certaines des nouvelles </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionnalités de C # 8.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le tweet «est devenu viral», plusieurs personnes ont admiré sa concision et sa fonctionnalité, tandis que d'autres m'ont demandé pourquoi je ne l'avais pas écrit en F #?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus de 4 ans se sont écoulés depuis la dernière fois que j'ai écrit en C #, et le fait que j'utilise habituellement la programmation fonctionnelle a clairement influencé la façon dont j'écris du code aujourd'hui. </font><font style="vertical-align: inherit;">L'extrait que j'ai écrit semble très net et naturel, mais certaines personnes ont exprimé des inquiétudes quant au fait qu'il ne ressemble pas au code C #.</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Il semble trop fonctionnel." </font><font style="vertical-align: inherit;">Ils m'ont écrit.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selon qui vous demandez, la «programmation fonctionnelle» signifie différentes choses pour différentes personnes. </font><font style="vertical-align: inherit;">Mais au lieu de discuter de sémantique, je voudrais expliquer pourquoi cette implémentation de FizzBuzz semble fonctionnelle.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons d'abord ce que fait ce code:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span><font></font>
{<font></font>
      <span class="hljs-function"><span class="hljs-keyword">string</span> <span class="hljs-title">FizzBuzz</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> x</span>)</span> =&gt; <font></font>
            (x % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>, x % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">switch</span><font></font>
            {  <font></font>
                  (<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>) =&gt; <span class="hljs-string">"FizzBuzz"</span>, <font></font>
                  (<span class="hljs-literal">true</span>, _) =&gt; <span class="hljs-string">"Fizz"</span>, <font></font>
                  (_, <span class="hljs-literal">true</span>) =&gt; <span class="hljs-string">"Buzz"</span>, <font></font>
                  _ =&gt; x.ToString()<font></font>
            };<font></font>
    <font></font>
      Enumerable.Range(<span class="hljs-number">1</span>, <span class="hljs-number">100</span> ) <font></font>
            .Select(FizzBuzz).ToList() <font></font>
            .ForEach(Console.WriteLine); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous créons une méthode locale, représentée par une expression lambda, dont le résultat est calculé à l'aide d'un tuple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La nouveauté ici est l'utilisation d'un tuple (paire) pour travailler avec le résultat du calcul de deux expressions ensemble (x% 3 = = 0 et x% 5 = = 0). Cela vous permet d'utiliser la correspondance de motifs pour déterminer le résultat final. Si aucune des options ne correspond, alors par défaut une représentation sous forme de chaîne du nombre sera retournée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, aucune des nombreuses "fonctionnalités" "fonctionnelles" utilisées dans ce morceau de code (y compris les boucles foreach de style LINQ) ne rend ce code fonctionnel en soi. Ce qui le rend fonctionnel, c'est que, à l'exception de la sortie du résultat sur la console, toutes les méthodes utilisées dans ce programme sont des expressions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, l'expression est une question qui a toujours une réponse. En termes de programmation, une expression est une combinaison de constantes, de variables, d'opérateurs et de fonctions calculés par le runtime pour calculer («retourner») une valeur. Pour illustrer la différence avec les instructions, écrivons une version plus familière de FizzBuzz pour les programmeurs C #:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span> <font></font>
{<font></font>
      <span class="hljs-keyword">foreach</span>( <span class="hljs-keyword">int</span> x <span class="hljs-keyword">in</span> Enumerable.Range(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>)) <font></font>
      {<font></font>
             FizzBuzz(x);<font></font>
      }<font></font>
} <font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FizzBuzz</span>(<span class="hljs-params"> <span class="hljs-keyword">int</span> x</span>)</span> <font></font>
{<font></font>
      <span class="hljs-keyword">if</span> (x % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>  &amp;&amp; x % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>) <font></font>
             Console.WriteLine(<span class="hljs-string">"FizzBuzz"</span>); <font></font>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x % <span class="hljs-number">3</span> == <span class="hljs-number">0</span> ) <font></font>
             Console.WriteLine(<span class="hljs-string">"Fizz"</span>); <font></font>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x % <span class="hljs-number">5</span> == <span class="hljs-number">0</span> ) <font></font>
             Console.WriteLine(<span class="hljs-string">"Buzz"</span>); <font></font>
      <span class="hljs-keyword">else</span><font></font>
             Console.WriteLine(x);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, c'est loin d'être un code "propre", et il peut être amélioré, mais on ne peut que convenir qu'il s'agit d'un code C # ordinaire. En examinant de plus près la méthode FizzBuzz, même en considérant sa simplicité, elle montre clairement plusieurs problèmes de conception. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, ce programme viole le premier des principes de SOLID - le principe de la responsabilité unique. Il mélange la logique du calcul de la valeur de sortie en fonction du nombre et de la sortie de cette valeur vers la console. En conséquence, il viole le principe d'inversion de dépendance (le dernier de SOLID), se connectant étroitement avec la sortie du résultat à la console. Enfin, une telle implémentation du programme rend difficile la réutilisation et le code sandbox. Bien sûr, pour un programme aussi simple comme celui-ci, cela n'a aucun sens d'entrer dans les subtilités de la conception, sinon quelque chose comme </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ça</font></a><font style="vertical-align: inherit;"> peut se révéler</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les problèmes ci-dessus peuvent être résolus en séparant la réception de la valeur et la sortie vers la console. </font><font style="vertical-align: inherit;">Même sans utiliser de constructions de langage fantaisistes, le simple retour de la valeur résultante au code appelant nous libère de la responsabilité d'utiliser cette valeur.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">FizzBuzz</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> x</span>)</span><font></font>
{<font></font>
      <span class="hljs-keyword">if</span> (x % <span class="hljs-number">3</span> == <span class="hljs-number">0</span> &amp;&amp; x % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>)<font></font>
            <span class="hljs-keyword">return</span> <span class="hljs-string">"FizzBuzz"</span>;<font></font>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>)<font></font>
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Fizz"</span>;<font></font>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>)<font></font>
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Buzz"</span>;<font></font>
      <span class="hljs-keyword">else</span><font></font>
            <span class="hljs-keyword">return</span> x.ToString();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, ce ne sont pas des changements radicaux, mais cela suffit déjà:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La méthode FizzBuzz est désormais une expression qui prend une valeur numérique et renvoie une chaîne.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'a pas d'autres responsabilités et effets cachés, ce qui en fait une fonction pure.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il peut être utilisé et testé indépendamment, sans dépendances et paramètres supplémentaires.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code qui appelle cette fonction est libre de faire quoi que ce soit avec le résultat - maintenant ce n'est pas notre responsabilité.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et c'est l'essence même de la programmation fonctionnelle - le programme se compose d'expressions qui aboutissent à des valeurs, et ces valeurs sont renvoyées au code appelant. En règle générale, ces expressions sont complètement indépendantes et le résultat de leur appel dépend uniquement des données d'entrée. Tout en haut, au point d'entrée (ou parfois appelé la «fin du monde»), les valeurs renvoyées par les fonctions se collectent et interagissent avec le reste du monde. Dans le jargon orienté objet, cela est parfois appelé «architecture de l'oignon» (ou «ports et adaptateurs») - un noyau propre composé d'une logique métier et d'une enveloppe extérieure impérative chargée d'interagir avec le monde extérieur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation d'expressions au lieu d'instructions est utilisée dans une certaine mesure par tous les langages de programmation. C # a évolué au fil du temps pour introduire des fonctions qui facilitent le travail avec les expressions: LINQ, les méthodes basées sur les expressions, la mise en correspondance de modèles, etc. Ces «fonctionnalités» sont souvent appelées «fonctionnelles» parce qu'elles existent - dans des langages comme F # ou Haskell, dans lesquels l'existence d'autre chose que des expressions est presque impossible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, ce style de programmation est désormais encouragé par l'équipe C #. Dans un récent discours au NDC London, Bill Wagner exhorte les développeurs à changer leurs habitudes (impératives) et à adopter des méthodes modernes:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/aUbXGs7YTGo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C # (et d'autres langages impératifs tels que Java) peuvent être utilisés de manière fonctionnelle, mais cela nécessite beaucoup d'efforts. </font><font style="vertical-align: inherit;">Ces langages font du style fonctionnel une exception, pas la norme. </font><font style="vertical-align: inherit;">Je vous encourage à apprendre des langages de programmation fonctionnels pour devenir un spécialiste de premier ordre.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493468/index.html">N'ayez pas peur de respirer profondément</a></li>
<li><a href="../fr493470/index.html">Des scientifiques découvrent de nouvelles planètes mineures en dehors de Neptune</a></li>
<li><a href="../fr493478/index.html">Hack The Box - Walkthrough Forest. Attaques de torréfaction AS-REP, DCSync et Pass-The-Hash</a></li>
<li><a href="../fr493480/index.html">Architecture pour débutants ou pourquoi vous n'avez pas besoin d'insérer un drapeau dans l'épée</a></li>
<li><a href="../fr493482/index.html">Rencontrez la tortue cybernétique, le prédécesseur de Roomba</a></li>
<li><a href="../fr493486/index.html">Les startups automobiles les plus intéressantes 2019-2020</a></li>
<li><a href="../fr493488/index.html">Unité + git = amitié: partie 1 set de gentleman</a></li>
<li><a href="../fr493496/index.html">ReactJS. Avertissement: impossible d'effectuer une mise à jour de l'état React sur un composant non monté. Ceci est un no-op, mais il indique un mémo</a></li>
<li><a href="../fr493504/index.html">Notre expérience de travail à distance dans la création de boutiques en ligne</a></li>
<li><a href="../fr493506/index.html">Pourquoi les géophysiciens croient-ils à la théorie de la terre plate au 21e siècle?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>