<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤵 🎅🏾 👩🏿‍🚒 さまざまなプラットフォームでのUEFI実装の問題と機能 📶 👨‍🚒 ⚾️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2000年の最初のEFI仕様のリリースから約19年が経過しました。インターフェイスがユーザー市場に参入して足場を築くまでに10年かかりました。現時点では、マザーボードのファームウェアにUEFIが搭載されていない最新のコンピューターはめったに見られません。インターフェース標準により、公式ドキュメントの...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>さまざまなプラットフォームでのUEFI実装の問題と機能</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/gaz-is/blog/493822/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2000年の最初のEFI仕様のリリースから約19年が経過しました。インターフェイスがユーザー市場に参入して足場を築くまでに10年かかりました。現時点では、マザーボードのファームウェアにUEFIが搭載されていない最新のコンピューターはめったに見られません。インターフェース標準により、公式ドキュメントの「肉」と数千ページが増加しました。平均的なユーザーの場合、セキュアブートが有効になっているときの衝突を除いて、何も変更されていません。しかし、仕事の面が開発に移行すると、すべてがより面白くなります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1f/ek/as/1fekaswnox-diqt-hgzmaiqnq4g.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UEFIのモジュラーアーキテクチャの概念そのものは、これらのモジュールを標準構成で使用できるだけでなく、独自のモジュールをダウンロードすることもできることを意味します。ファイルシステムドライバー（ネイティブefi-shy FATに限定されない？）、周辺機器ドライバー、アプリケーション、ブートローダー-手ですべてをロードできます。少しのシェルをロードすると便利です。 「より深く」一歩進んでファームウェアの内容を確認することで、SecureBootで踊ったり、スクリプトのレイヤーを作成したりする必要がなくなります（ハブのページに十分な記事があります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これに基づいて、OSをロードする前にさまざまなセキュリティ機能を実行する機能モジュールを作成するアイデアが生まれました。これは、さらに統合され、ブートインターフェイスとランタイムインターフェイスの両方のサービスに影響を与える一種の統合された信頼できるブート環境となり、ファームウェアのモジュールとディスク上のモジュールの間で影響を与えます。低レベルの介入なしに、そしてその後に、セキュリティ管理者の許可を得てのみ、「プッシュ」することはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアイデアの実装は、UEFIの膨大なニュアンスと微妙さを私たちにもたらしました。</font><font style="vertical-align: inherit;">順番に始めましょう。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プラットフォーム依存</font></font></h4><br>
<img src="https://habrastorage.org/webt/wn/pz/1f/wnpz1fwi6hrqqhoogamysefkdic.png" width="770"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プラットフォームに統合するときに最初に確認する必要があるのは、それを使用できるかどうかです。 UEFI仕様のバージョンは重要であり、ほとんどのデバイスでは、2.1から2.7の範囲で表示されます。新しい人はまだ研究スタンドを打っていません。古いものが見つかりましたが、必要なプロトコルが欠けていたり、実装に不正なドライバが作成されていたりするため、パフォーマンスが制限される可能性があります。たとえば、UnicodeCollat​​ionは十分ではないことがよくあります。smbiosにアクセスすると、文書化されていないエラーが発生し、SetVariable（）による言語変更関数が機能しません。ベンダーや新しさに応じて、何かが発生する可能性があります。これは、比較的新しいボードでもプロトコルを配置する必要がある場合があるためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの練習でも、Intel Bay Trail Dと32ビットファームウェアを搭載した2台のミニコンピューターに遭遇しました。まれなケースですが、一時的にモジュールを再コンパイルする必要がありました。実際、質問のように、将来、同じ容量のより近代的なプラットフォームに出会う​​でしょうか？そして、私たちが会ったら、どこで？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のステップは、統合する方法を決定することです。モジュールはファームウェアに組み込まれており、ファームウェアはボード上のSPIチップに配置され、Intel MEを搭載したPCHは近くにあります。そしてここで最も興味深い質問が発生します-そこに行く方法は？ 「ワニ」を持つ古き良きプログラマー-これは良いです、それは信頼できます。最後まで追いつかなくても、ボード上の点灯しているLEDをいつでも確認できます。プログラマーから十分な電力が供給されています。ファームウェアを備えたmikruha SOIC-16に非常にアクセスしやすいため、クリップを圧迫するよりもアダプターを工夫して脚にはんだ付けする方が簡単な古いHPモデルを除いて、ほとんど問題なく動作します。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/uu/ce/6b/uuce6bumbvwdovmxow0ntfoeynm.png" width="770"><br>
<img src="https://habrastorage.org/webt/qj/kf/k1/qjkfk14esp5_ol1vchn8fkaiwt4.png" width="770"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私は、彼らのおかげでflashromの執筆に貢献してくれたHabréの人々がいることを知っています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、プログラマーによるダンプ削除の信頼性と信頼性にもかかわらず、この方法は、UEFIにいくつかのマシンの何かをインストールする必要がある場合、またはインストールのターゲットプラットフォームが机上にない場合には適していません。幸いにも、メーカーはネイティブファームウェアユーティリティを残しました。Intel（CS）MEシステムツールキットのFPT（フラッシュプログラミングツール）とAmerican MegatrendsのAptioのAFU（AMIファームウェアアップデート）です。これらのユーティリティは、EFI環境とWindows、Linux、DOSオペレーティングシステムの両方から起動されます。ユーティリティは多少互換性があり、どちらも画像全体をではなくても、特定の領域を確実に検討できます。そして時には彼らはあなたに書き戻すことさえ許しました。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/hk/vz/pp/hkvzppckxwb02epv3ieytikh5y0.png" width="770"><br>
<img src="https://habrastorage.org/webt/we/qx/3y/weqx3ysvpinegiv9gxh9biw7xdg.png" width="770"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼は書いて書いていない</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、統合の道の最初の重大な障害が現れる場所です。すべてのマザーボードがファームウェア全体を読み取ることができるわけではなく</font><font style="vertical-align: inherit;">、ME領域</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">へのアクセス</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">禁止します</font></a><font style="vertical-align: inherit;">（MEはほとんど神聖です。インテルはそれを良い方法で読み取ることを許可しませんが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、悪い方法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では常にそうしたいとは限りません）。さらに少ない-署名されたカプセルでない限り、BIOS領域に何かを注ぎます。成功の可能性は、製造元とチップセットの鮮度によって大きく異なります。マザーボードの一部のモデルでは、面白い写真を見ることができます。古いベンダーのボードに記録されていなかったものは、新しい時に飛んでいきます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">IFRパーサー</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
が書き込み保護との戦いに役立つ場合がある</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、非表示の設定と変数のカーテンを開きます。</font><font style="vertical-align: inherit;">また、ハードコアジャンパーのみが役立つ場合もあり、録音へのアクセスまたはMEを「オフにする」ことができます（もちろん、提供されている場合）。</font></font><br>
 <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムの複雑な性質</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの場合、Acer、Asus、AsRock、およびGigabyteボードは、不必要な困難なしに書かれています。</font><font style="vertical-align: inherit;">Intel、HP、およびサーバーハードウェアは際立っています。</font><font style="vertical-align: inherit;">HPは、プログラムでそれ自体を書き込むことを許可するだけでなく、ファームウェアを変更しようとすることを誓います（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodeRush</font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整合性チェックの検索と無効化</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関する記事</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">があります</font></a><font style="vertical-align: inherit;">）。 Intelは多かれ少なかれ87番目のチップセットまで記録し、BIOS領域のゲートを開く要求に耳を貸さなくなりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intelでは、初めては面白かった。モジュールはUEFIToolユーティリティを使用してファームウェアにインポートされ、興味深いバグに遭遇しました：DXEボリュームの最後にすべてのフリーフォームの後にffsモジュールを挿入すると、組み立てられたイメージがボードを「ブリック」しました。解決策は、ネイティブDXEドライバーの後にモジュールを追加することでした。私たちはすぐにこれに到達しませんでした、そして、最初はIntelがHPのようなファームウェアの完全性を監視しているように見えました。後で、モジュールをインポートするための自動ユーティリティなしでは何もできないことが明らかになり、問題はそれを書いた後で問題がなくなるようになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバー側のハードウェアは、同時により単純でより複雑です。一方では、サーバーのBIOSを更新および変更するための追加の方法が常に存在します。他方、これらの同じBIOSでのカスタマイズの量は、サーバーで無駄にせず、かなり容量の大きいフラッシュメモリチップをインストールすることもないため、膨大な量になり、バックアップも行われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーにインストールする場合、IPMIを介してリモートからBIOSを更新できると便利です。確かに、これには良い方法でライセンスが必要ですが、もちろん支払い済みです。それが適切なタイミングで表示されない場合は、SupermicroサーバーのBIOSにモジュールを導入することで得たのと同様の、おかしな状況に陥る可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュールの導入後、セキュリティモジュールの1つによってブロックされたため、負荷が厳しくハングしました（サーバーBIOSの邪魔を考慮に入れていなかったため、それは起こりません）。 IPMIを介してBIOSを強制的にロールバックする機能がない場合、プログラマーの手に届きましたが、不運でした。標準のSOIC-8クリップはSOIC-16チップには十分ではありませんでした。まあ、大丈夫です。理論上、サーバーボードには接続されたメディアからバックアップする機能があり、ルートにあるSUPER.ROMイメージを取得します。しかし、このメカニズムは開始されません。システムによれば、すべてが正常で、すべてが機能するため、BIOSロールバックは必要ありません。何をすべきか！..話は結局、正しいクリップを探して街中を走り回り、電線を緊急に再はんだ付けし、私たちには理解できない順序で中国人によって塗りつけられ、そして最後に点滅しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レノボはさらに面白くなりました。ベンダーから受け取ったスイッチのケースの裏側に、ファームウェア用の2つの「mikruhs」、OS用のSSD、および固定バッテリーを備えた制御ボードが見つかりました。 BIOSは骨の折れる作業であることが判明しました。私は、修正されたイメージを決してプログラマーに負けずに食べたくありませんでした。何かを書き留めようとする試みの1つとして、コンソールubuntuを備えたフラッシュドライブをスイッチに挿入し（端末はグラフィックスを提供しませんでした）、非常に安全に起動しました。必要な処理を行った後、古いメモリからhalt -pコマンドを使用してシステムをオフにしました。スイッチは、その性質上、電源の不足を除いて、シャットダウンには適合していませんでしたが、これに対応できず、もう起動したくありませんでした。顔のリンクは一度消滅し、ファンは静かに鳴り響き、すべてのポートは何もしませんでした。再フラッシュは役に立たなかった、バッテリーは手袋のように座っていました。マウントを壊すのを恐れていました。その結果、忍耐力と接点の下での言葉のインスピレーションの力の下で薄い誘電体プレートが這い、揮発性メモリが消去され、スイッチが作動しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのチップから採取されたダンプの調査では、多くの興味深いことがわかりました。特に、メインファームウェアのNVRAM内の膨大な数の「無効な」エントリと、バックアップ内のいくつかの同様のエントリ。まあ、DXEドライバーのボリュームで以前に発生したデータハッシュではありません。スイッチの起動の問題の正確な原因について推測することしかできませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、ソフトウェア部分がその予期しないニュアンスを奪われることはめったにありません。 （異なるメーカーの）87番目のチップセットより前に来た多くのマザーボードには、シェルコンソールで「dh -v」コマンドを入力すると、無限のエラーストリームを生成する不快な機能があります。手動で入力する場合、これは重要ではありませんが、データをファイルに収集すると、残念なことにハングアップします。どちらの場合も、マシンを再起動する必要があります。同時に、データファイルが巨大なサイズに膨らまないことを嬉しく思います。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z-/rr/_k/z-rr_k9f6o7pmt_ezbza-ysrjzw.png" width="770"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ASRock H81M-DGSボードを搭載したKraftway BIOSは非常に厄介であることが判明しました。そのため、Ctrl Alt Del Delにハングアップして応答し、Resetのみが出力できるようになります。 Shell'eの起動スクリプト&lt;startup.nsh&gt;をスキップすると問題が発生しました。デフォルトの5つではなく、1秒で選択できます。おそらくこれらの問題は、KSS独自のモジュールによる変更が原因で発生している可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Asus H97-PLUSボードでは、ファームウェアに次の機能があります-BootOrderオーバーフロー。ほとんどの場合、理由はコード内のエラーにあります。おそらく、製造元はこれまでボードに接続されていたすべてのブートデバイスを保持したいと考えていましたが、1日に12を超える可能性があるとは計算していませんでした。したがって、BootOrderがオーバーフローすると、システムはブートプロセス中にハングします。クリーニングするには、すべての起動デバイスをオフにして、システムをオンにする必要があります。ファームウェアは自動的にクリアされ、システムはBIOSセットアップシェルで直接起動します。パフォーマンスは次のオーバーフローまで続きます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さまざまなベンダーのボードを使用した経験を要約すると、既知のモデルがすでにあるとしても、次のボードで対処するEFIレベルでの驚きを見つけることはほとんど不可能であるという結論に達します。</font><font style="vertical-align: inherit;">システムに関する情報を収集する段階で困難が生じる場合があるため、これは一種の宝くじです。</font><font style="vertical-align: inherit;">おそらくこれは、FPTまたはMEInfoの古いバージョンを実行しているときに、ME v11およびv12を搭載した最新のマザーボードが他にどのようにフリーズする可能性があるのか​​、製造業者に対する信頼できない研究理想主義と信頼の共有を持っています。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハードウェアプロトコルでの作業の問題</font></font></h4><br>
<img src="https://habrastorage.org/webt/j2/yo/ze/j2yozeg6zdyfa--juz_ycvvobbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
USBデバイスの操作を開始すると、いくつかの問題が表示されます-ドライブとトークン。周辺機器を操作するためのBIOSコードは、特定の周辺機器用の独立系ハードウェアベンダー（IHV）からのドライバーとアプリケーションの危険なカクテル、チップセットメーカー（この場合はIntel）のコード、BIOSメーカーのコードとコードであるので、これはよく起こりますマザーボードのメーカーから。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の「興味深い」状況</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
が発生しました</font><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">トークンが「検出されませんでした」。同時に、LEDが点灯します。ほとんどの場合、ホストコントローラーはUSBデバイスの初期リセット手順を実行しない、つまり電源が供給されますが、D +およびD-ラインの変更によるリセットは正しく機能せず、それがないと、トークンを使用したそれ以上の操作は無意味です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンピュータは、シェルをロードする前にフリーズします（ここでも、トークンが接続されています）。この場合、トークンがなければ、PCは正常に起動します。ライブ、それはこのように見えます：トークンがコネクターに突き出ている間、コンピューターは起動直後にクラッシュするようです。あなたはそれを取り出します-ロードは突然続きます。接続-再びぶら下げ。明らかな問題はUEFIにあり、その理由について推測することしかできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
USB_IOインターフェースを開くことができない状況。おそらく、スマートカードを操作するためのインターフェイス（USB CCID）のみに接続されています。一部のAMIドライバーは、EFI_OPEN_PROTOCOL_BY_DRIVERパラメーターを使用してUSB_IOを既に開いています。ドライバーにはGUIDを持つプロトコルがあります。</font></font><br>
<br>
<pre><code class="plaintext hljs">#define EFI_AMI_USB_CCID_PROTOCOL_GUID	 { 0x5FDEE00D, 0xDA40, 0x405A, { 0xB9, 0x2E, 0xCF, 0x4A, 0x80, 0xEA, 0x8F, 0x76} }<font></font>
 // Workaround.      EFI_OPEN_PROTOCOL_BY_DRIVER,  ,     EFI_OPEN_PROTOCOL_GET_PROTOCOL.<font></font>
 //<font></font>
 // Open USB I/O Protocol<font></font>
 //<font></font>
 Status = gBS-&gt;OpenProtocol (<font></font>
 ControllerHandle,<font></font>
 &amp;gEfiUsbIoProtocolGuid,<font></font>
 (VOID **) &amp;UsbIo,<font></font>
 This-&gt;DriverBindingHandle,<font></font>
 ControllerHandle,<font></font>
 EFI_OPEN_PROTOCOL_BY_DRIVER<font></font>
 );<font></font>
<font></font>
 if (EFI_ACCESS_DENIED == Status)<font></font>
 {		// AMI BIOS workaround (BindingStop will not be invoked)<font></font>
	 Status = gBS-&gt;OpenProtocol(<font></font>
		 ControllerHandle,<font></font>
		 &amp;gEfiUsbIoProtocolGuid,<font></font>
		 (VOID **)&amp;UsbIo,<font></font>
		 This-&gt;DriverBindingHandle,<font></font>
		 ControllerHandle,<font></font>
		 EFI_OPEN_PROTOCOL_GET_PROTOCOL<font></font>
	 );<font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、BindingStop（）は呼び出されません。デバイス抽出イベントは監視されず、ドライバーは無効なハンドルを使用しようとします。これは、HP Compaq Elite 8300 SFF PCやその他のPCで観察されました。これは、望ましくないドライバからの一種のベンダー保護、または定期的な開発バグのいずれかです。おそらくAMIは常にUSB CCIDの方向に何かを行っていますが、干渉ドライバーはUSB HID、USB MassStorageと同じAMI UHCIモジュールにあるため、アンロードできません。 UninstallInterface（）の場合も同様です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または別の興味深い機能。トークンが検出されなかったUEFI BIOSの1つで、USB_IOはデバイス記述子の読み取りを許可しましたが、EFI_INVALID_PARAMETERは次のUsbBulkTransfer（）に戻りました。さらに、これは一部のタイプのトークンでのみ発生し、完全に同じパラメーターで、他のトークンは完全に機能しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、プロトコルUsbBulkTransfer（）は、興味深いことにEFI_USB_IO_PROTOCOLプロトコルに実装されています。</font><font style="vertical-align: inherit;">無制限の時間、またはTimeoutパラメーターで指定された時間の保証されたパッケージ配信を目的としています。</font><font style="vertical-align: inherit;">ただし、大容量ファイルをUSBフラッシュドライブにコピーするときに削除されたMassStorageデバイスで実験が行われました。</font><font style="vertical-align: inherit;">PCがタイトにハングします。</font><font style="vertical-align: inherit;">USBフラッシュドライブを接続すると、PCはたるみ、何も起こらなかったかのようにファイルを書き込み続けました。</font><font style="vertical-align: inherit;">同じ状況がトークンにもありましたが、それ自体に固有の問題がありました。</font><font style="vertical-align: inherit;">これはアーキテクチャ上の問題であり、EFIではタイマー以外に割り込みはなく、デバイスはポーリングに従って動作します。</font><font style="vertical-align: inherit;">つまり、システムはUSBポーリングのどこかでクラッシュしましたが、タイムアウトに到達しませんでした。デバイスが再表示されたときに、操作を続行して完了しました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仮想化</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仮想環境についても言う必要があります。現在、EFI環境のエミュレーションをサポートする2つの主要なプラットフォームがあります。VMwareとVirtualBoxです。 「実際の」システムの場合と同様に、両者には相互作用する際に長所と短所があります。 VMware環境は、NVRAM変数を適切に処理しますが、DXEモジュールの初期化中にメッセージを視覚的に表示するときにつまずきます。起動可能なメディアの検索に関するネイティブメッセージが優先され、必要なものは残されます。反対に、VirtualBoxは必要なすべてを完全にレンダリングしますが、長い変数を覚えておきたくありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VMwareガーデンのもう1つの小さな石-それに組み込まれているFAT32ドライバーは、8.3形式でのみファイルの作成と編集をサポートします。</font><font style="vertical-align: inherit;">これが行われた理由は明らかではありませんが、これは明らかに注意が必要な制限です。</font><font style="vertical-align: inherit;">ドライバーの同様の実装が実際のプラットフォームで確認できる可能性がありますが、これまでのところそれらに遭遇していません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、仮想マシンでは、ファームウェアユーティリティ、プログラマー、ジャンパー、不快なチップに踊りはありません。</font><font style="vertical-align: inherit;">個別のROMファイル、UEFITool、および構成ファイルの行。</font><font style="vertical-align: inherit;">ほとんど牧歌。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終的には</font></font></h4><br>
<img src="https://habrastorage.org/webt/cb/qg/va/cbqgvany9ens-l7ippxwgzox9co.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CHIPSECからの要求のスライス。</font><font style="vertical-align: inherit;">彼らはそのような秘跡をどこで教えますか？</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、UEFIシェルでの開発と実装は、魅力的で創造的なプロセスです。</font><font style="vertical-align: inherit;">有名なフィールドでも、いつも新しいことに出会えます。</font><font style="vertical-align: inherit;">一方で、規格が開発されていることは励みになり、他方では、プロデューサーによる規格の具体的な実装があまりにも「創造的」であることは悲しいことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主な問題は次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファームウェア開発時のUEFI仕様からのベンダーの離脱。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装中のコードのエラー。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード内のNDV、統合中のポップアップ。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最後に重要なことですが、たとえば、MEI、HECIなどのPCIデバイスを介してMEと通信するためのプロトコルの説明など、公式（読み取り、オープン）のドキュメントに多くのものがないこと。</font><font style="vertical-align: inherit;">レジスタの説明は表示されますが、コマンドは表示されません。</font><font style="vertical-align: inherit;">GUIDを見つけますが、その目的は見つけません。</font><font style="vertical-align: inherit;">これにより、作業が長い分析に戻り、プラットフォームでデータと統計を収集し、逆アセンブラを使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状況はゆっくりではありますが確実に修正されており、標準の開発がかなり予測可能で非常に楽しいプロセスになるときは遠くないと思います。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vazimir Onipchuk、</font><font style="vertical-align: inherit;">
Gazinformservice LLCの</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハードウェアおよびソフトウェア保護製品グループの</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">責任者</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja493810/index.html">文書認識市場の5年間の集中的な開発</a></li>
<li><a href="../ja493814/index.html">バルセロナでのインタビューの仕方</a></li>
<li><a href="../ja493816/index.html">Gitガイド パーツ番号1：.gitディレクトリについて知っておく必要があるすべて</a></li>
<li><a href="../ja493818/index.html">Gitガイド パート番号2：ゴールデンルールとリベースのその他の基本</a></li>
<li><a href="../ja493820/index.html">Kubernetesの負荷分散と長期間の接続のスケーリング</a></li>
<li><a href="../ja493826/index.html">分割統治：水の電気分解の改善</a></li>
<li><a href="../ja493828/index.html">インターフェイスがビデオゲームのストーリーを伝える方法</a></li>
<li><a href="../ja493830/index.html">最初のインタビューでジュニアiOS開発者が尋ねる質問</a></li>
<li><a href="../ja493832/index.html">コロナウイルスCOVID-19配布ダッシュボード（React + Chart.js + BootstrapTable）</a></li>
<li><a href="../ja493840/index.html">レビュー：アサナ、ジラ、ビトリックス-24、トレロ、ユージャイル。何が好きで何が激怒しますか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>