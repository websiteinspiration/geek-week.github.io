<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🏭 ↖️ 🤬 Übertragen Sie Ihre Videos rund um die Uhr auf YouTube 🤶🏿 🚻 👩🏼‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Als Hobby filme ich kürzlich Vorträge eines bekannten Psychologen auf Video. Ich mounte und veröffentliche das Filmmaterial auf meiner Website. Vor ei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Übertragen Sie Ihre Videos rund um die Uhr auf YouTube</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493352/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als Hobby filme ich kürzlich Vorträge eines bekannten Psychologen auf Video. Ich mounte und veröffentliche das Filmmaterial auf meiner Website. Vor einem Monat hatte ich die Idee, diese Vorträge rund um die Uhr auf YouTube rund um die Uhr zu übertragen. Eine Art thematischer „Kanal“, der sich dem persönlichen Wachstum widmet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich weiß, wie man eine normale Sendung macht. Aber wie macht man daraus eine Sendung von Videodateien? Dass sie rund um die Uhr lief, flexibel und so autonom wie möglich war und gleichzeitig nicht von meinem Heimcomputer abhing. Das musste ich herausfinden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ti/vn/5u/tivn5utlpr-vmldtf9dh5hh7fku.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es dauerte mehrere Tage, um eine Lösung zu finden. Ich habe viele Foren und verschiedene Handbücher studiert, ohne die meine Sendung einfach nicht ausgefallen wäre. Und jetzt, wenn der Streich ein Erfolg ist, habe ich das Bedürfnis, meine Entscheidung zu teilen. Also erschien dieser Artikel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kurz gesagt, die endgültige Lösung war wie folgt: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS + ffmeg + Bash-Skript</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Unter dem Schnitt beschreibe ich die Schritte und spreche über die "Fallstricke", die während der Sendung entdeckt wurden.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 1 - Wohin geht die Sendung?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ganz am Anfang musste festgelegt werden, wo die Sendung durchgeführt wird und wo ihre Quelle sein wird. Das allererste, was mir in den Sinn kam, war </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von einem Heimcomputer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sammeln Sie Videos in einer Wiedergabeliste und spielen Sie sie in einem beliebigen Videoplayer ab. Nehmen Sie dann das Bildschirmbild auf und senden Sie es an YouTube. Aber ich habe diese Option fast sofort abgelehnt. Um es zu implementieren, müssen Sie Ihren Heimcomputer ständig eingeschaltet lassen. Dies ist das Geräusch der Kühler auch nachts und der erhöhte Energieverbrauch (+ 100-150 kWh pro Monat). Und es stellt sich heraus, dass Sie Ihren Heimcomputer für die Dauer der Übertragung nicht verwenden können. Jede Bewegung der Maus ist in der Sendung sichtbar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann begann ich mich mit </font><b><font style="vertical-align: inherit;">Cloud-Diensten</font></b><font style="vertical-align: inherit;"> zu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">befassen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ich suchte nach einem vorgefertigten Dienst, mit dem Sie Ihre Videos hochladen oder beispielsweise Links zu Videos von YouTube einfügen können, und alles wird in einer Non-Stop-Sendung zusammengefasst. Aber ich fand nichts passendes. Vielleicht sah ich schlecht aus. Das einzige, was für die Funktionalität geeignet ist, ist restream.io, ein Dienst, mit dem gleichzeitig auf mehreren Plattformen gesendet werden kann. Sie scheinen in der Lage zu sein, ihre Videos hochzuladen. Dieser Dienst wurde jedoch für ganz andere Zwecke entwickelt und sie erwarten, dass die Sendung nur ein paar Stunden dauern wird. Ich denke, wenn es über diesen Dienst möglich gewesen wäre, eine Rund-um-die-Uhr-Sendung zu organisieren, hätte dies auf zehn oder sogar Hunderte von Dollar pro Monat geschossen. Trotzdem wollte ich die Sendung entweder kostenlos oder mit minimalen finanziellen Investitionen organisieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wurde klar, dass Sie senden müssen</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein separates Gerät</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder sogar einen separaten Computer. Ich denke an etwas wie den Raspberri Pi. Und was? Er hat keinen Kühler. Ich habe das Video auf einem USB-Stick aufgenommen, ein Ethernet-Kabel angeschlossen und es an einem abgelegenen Ort liegen lassen. Es wird gesendet. Möglichkeit. Aber ich hatte weder das Board selbst noch die Erfahrung damit, also lehnte ich diese Option auch ab. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende stieß ich auf eine Diskussion, in der es darum ging, </font><b><font style="vertical-align: inherit;">einen eigenen Server zu</font></b><font style="vertical-align: inherit;"> erstellen</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sendungen. Dies war nicht genau das, wonach ich gesucht habe, aber ich habe die Hauptidee verstanden - Sie können den Server verwenden! In dieser Diskussion schlugen sie vor, eine Reihe von VPS + Nginx + OBS zu verwenden. Es wurde klar, dass dieser Haufen zu mir passen könnte. Das einzige, was mich verwirrte, war, dass ich den Server nie verwaltet habe und es schien mir, dass mein dedizierter Server verwirrt und teuer war. Ich beschloss herauszufinden, wie viel es kosten würde, einen Server in der Mindestkonfiguration zu mieten, und war angenehm überrascht.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mu/v8/ms/muv8msmvpgnhzj9z04nuhv_y0-s.jpeg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Preise sind in belarussischen Rubel und sie sind nur Krümel. Zum Verständnis sind 8 belarussische Rubel ungefähr 3,5 Dollar oder 240 russische Rubel. Verwenden Sie einen Monat lang einen vollwertigen Computer, der rund um die Uhr eingeschaltet ist und über einen schnellen Internetzugang verfügt. Aus irgendeinem Grund war diese Entdeckung für mich sehr erfreulich und ich ging mehrere Tage lang furchtbar glücklich wie ein Kind, das Weltraumraketen entdeckte :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Übrigens nutzte ich das Angebot der allerersten Website, die Google mir auf Anfrage „VPS-Verleih“ gab. Vielleicht gibt es noch mehr Budgetlösungen, aber dieser Preis passte zu mir und ich suchte nicht weiter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Erstellen eines Servers können Sie das Betriebssystem auswählen, unter dem er ausgeführt werden soll. </font><font style="vertical-align: inherit;">Auf jedem der aufgelisteten Systeme können Sie die Übertragung organisieren und eine Auswahl treffen, die auf Ihren Vorlieben und finanziellen Möglichkeiten basiert (für einen Server mit Windows wird eine zusätzliche Gebühr erhoben). </font><font style="vertical-align: inherit;">Ich habe mich für CentOS entschieden. </font><font style="vertical-align: inherit;">Nur weil ich ein bisschen Erfahrung mit ihr hatte.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cv/0a/wh/cv0awhhxim1w2fgglkrlupl5hgc.jpeg" alt="Bild"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 2 - Server-Setup</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Erstellen des Servers müssen Sie zunächst eine Verbindung über SSH herstellen. </font><font style="vertical-align: inherit;">Zuerst habe ich PuTTy verwendet, dann aber die Secure Shell App, die auf Google Chrome ausgeführt wird. </font><font style="vertical-align: inherit;">Es stellte sich also als bequemer für mich heraus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann habe ich den Hostnamen geändert, die Zeitsynchronisation auf dem Server eingerichtet, das System aktualisiert, mit iptables herumgespielt ... und ein paar Dinge getan, aber nicht, weil es notwendig war. </font><font style="vertical-align: inherit;">Es war nur interessant für mich, den Server einzurichten, und es hat bei mir funktioniert. </font><font style="vertical-align: inherit;">Ich liebe es, wenn sich herausstellt :) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber die Schritte, die getan werden müssen:</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbinden Sie das EPEL-Repository.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erhöhen Sie den FTP-Server (ich habe vsftp gewählt).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren Sie ffmpeg.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde keine Details des Teams nennen, diese Anweisung ist eher konzeptionell, um einen allgemeinen Aktionsplan zu vermitteln. Wenn Sie Probleme mit einem der Schritte haben, werden diese schnell durch eine Abfrage in einer Suchmaschine wie "CentOS Connect EPEL" oder "CentOS FTP Server Installation" behoben. Unter den ersten Links finden Sie detaillierte Schritt-für-Schritt-Anleitungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie ich bereits schrieb, brauchte ich ein paar VPS + Nginx + OBS. VPS - bereit. Aber hier zu den verbleibenden Punkten tauchten Fragen auf. OBS ist ein Broadcast-Programm, Open Broadcaster Software. Und es funktioniert nur mit Threads, d.h. Beispielsweise wird ein Bild von einer Webcam aufgenommen und gesendet. Oder Bildschirmaufnahme. Oder eine bereits laufende Sendung leitet zu einer anderen Site weiter. Und ich habe keinen Stream, ich habe nur eine Reihe von Videodateien, die ich zum Erstellen eines Streams benötige.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Er begann in diese Richtung zu graben und stieß auf ffmpeg. </font><font style="vertical-align: inherit;">FFmpeg ist eine Reihe kostenloser Open Source-Bibliotheken, mit denen Sie digitale Audio- und Videoaufnahmen in verschiedenen Formaten aufnehmen, konvertieren und übertragen können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und ich war sehr überrascht, wie viel ffmpeg kann. </font><font style="vertical-align: inherit;">Wenn Sie möchten, wird der Ton aus dem Video gezogen. </font><font style="vertical-align: inherit;">Wenn Sie möchten, wird ein Fragment des Videos ohne Transcodierung ausgeschnitten. </font><font style="vertical-align: inherit;">Wenn Sie möchten, wird es von einem Format in ein anderes konvertiert. </font><font style="vertical-align: inherit;">Und sehr viel mehr. </font><font style="vertical-align: inherit;">Bis zu dem Punkt, an dem Sie eine Datei für ihn angeben können, konvertiert er sie in einen Stream und überträgt sie selbst auf YouTube. </font><font style="vertical-align: inherit;">Alles, die Kette ist zusammengebaut. </font><font style="vertical-align: inherit;">Es bleibt nur die Nuancen zu verfeinern.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 3 - Broadcast-Setup</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir erstellen eine Sendung auf YouTube. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zu diesem Zeitpunkt benötigen wir nur einen Link und einen Übersetzungsschlüssel. </font><font style="vertical-align: inherit;">Im folgenden Screenshot sind sie rot hervorgehoben. </font><b><font style="vertical-align: inherit;">Laden Sie als</font></b></font><br>
<br>
<img src="https://habrastorage.org/webt/gr/a3/oo/gra3oogooafzdfjzhlqdqjjxr8o.jpeg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nächstes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Videodateien auf den Server hoch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , den wir senden möchten. </font><font style="vertical-align: inherit;">Tatsächlich wird FTP nur für diese Phase benötigt. </font><font style="vertical-align: inherit;">Wenn Sie eine andere bequeme Möglichkeit zum Hochladen von Dateien auf den Server haben, kann der FTP-Server weggelassen werden. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir streamen auf YouTube. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um die Übertragung zu starten, müssen Sie ffmpeg mit mehreren Attributen ausführen. </font><font style="vertical-align: inherit;">Hier ist der kürzeste Befehl, den ich bekommen habe:</font></font><br>
<br>
<pre><code class="bash hljs">ffmpeg -re -i lecture1.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attributentschlüsselung</font></font></b><div class="spoiler_text"><code>-re</code> – ,      .<br>
<br>
<code>-i</code> – ,    . ,       ,    -.       ,  <code>/usr/media/lecture1.mp4</code>.<br>
<br>
<code>-f</code> –    .    ,  ffmpeg « »     mp4  flv.<br>
<br>
    ,     YouTube     .. ,     ,   ,       .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn du alles richtig gemacht hast, sieht YouTube nach dem Ausführen dieses Befehls den übertragenen Stream. </font><font style="vertical-align: inherit;">Um die Sendung zu starten, musst du nur auf YouTube selbst auf die Schaltfläche "Sendung starten" klicken.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 4 - Autonomie hinzufügen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Herzliche Glückwünsche! Jetzt wissen Sie, wie Sie mit dem Senden aus einer Videodatei beginnen können. Für Rund-um-die-Uhr-Sendungen reicht dies jedoch nicht aus. Es ist wichtig, dass nach Beendigung der Wiedergabe des ersten Videos das nächste sofort gestartet wird. Wenn alle Videos angezeigt werden, beginnt die Wiedergabe von vorne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe mir die folgende Option ausgedacht: Erstellen Sie eine .sh-Datei, in der ich einen Befehl für jede Videodatei registriert und ganz am Ende einen Befehl zum Neustarten desselben Skripts angegeben habe. Es stellte sich als eine Art Rekursion heraus:</font></font><br>
<br>
<pre><code class="bash hljs"> 1... (   lecture1.mp4)<font></font>
 2... (   lecture2.mp4)<font></font>
 3... (   lecture3.mp4)<font></font>
bash start.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und ja, es hat funktioniert. Ich war mit mir zufrieden, startete eine Testsendung und ging schlafen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Morgen erwartete mich eine unangenehme Überraschung. Es stellte sich heraus, dass die Sendung nur ein paar Minuten dauerte und fast sofort endete, als ich meinen Computer ausschaltete. Die Untersuchung ergab, dass die auf diese Weise gestarteten Befehle ausgeführt werden, während der Benutzer auf dem Server autorisiert ist. Sobald ich die Verbindung getrennt hatte, wurde die Ausführung der von mir gestarteten Befehle unterbrochen. Um dies zu verhindern, reicht es aus, </font></font><code>bash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das Team </font><font style="vertical-align: inherit;">vor dem </font><font style="vertical-align: inherit;">Team hinzuzufügen </font></font><code>nohup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Auf diese Weise kann der laufende Prozess unabhängig von Ihrer Anwesenheit ausgeführt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die endgültige Mindestversion des Skripts sieht folgendermaßen aus:</font></font><br>
<br>
<pre><code class="bash hljs">ffmpeg -re -i lecture1.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%<font></font>
ffmpeg -re -i lecture2.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%<font></font>
ffmpeg -re -i lecture3.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%<font></font>
nohup bash start.sh $</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wobei start.sh die Datei ist, in die dieses Skript geschrieben ist. </font><font style="vertical-align: inherit;">Diese Datei sollte sich im selben Verzeichnis wie die Videodateien befinden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch Hinzufügen eines Dollarzeichens am Ende können Sie den Vorgang im Hintergrund starten, sodass Sie die Konsole weiterhin verwenden können, ohne die Übertragung zu unterbrechen. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aus Boni ergaben sich folgende Brötchen:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können die Wiedergabe von Dateien manuell umschalten. </font><font style="vertical-align: inherit;">Dazu müssen Sie den aktuell ausgeführten ffmpeg-Prozess "beenden". </font><font style="vertical-align: inherit;">Danach startet automatisch die Wiedergabe der nächsten Datei aus der Liste.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neue Videos können zur Sendung hinzugefügt werden, ohne die Sendung anzuhalten. </font><font style="vertical-align: inherit;">Laden Sie das Video einfach auf den Server hoch, fügen Sie den Befehl zum Ausführen dieser Datei im Skript hinzu und speichern Sie es. </font><font style="vertical-align: inherit;">Und alle. </font><font style="vertical-align: inherit;">In der nächsten Wiedergaberunde wird die neue Datei bereits zusammen mit den alten Dateien gesendet.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 5 - ffmpeg konfigurieren</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit könnte man grundsätzlich aufhören. Aber ich wollte die Sendung ein wenig freundlicher für das Publikum machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, eine Person ist zur Sendung gegangen, hat angefangen zu schauen, sie hat es gemocht und wollte diesen Vortrag von Anfang an sehen, und die Sendung beinhaltet kein Zurückspulen. Um eine Vorlesung von Anfang an anzusehen, muss eine Person auf meine Website gehen und eine Aufzeichnung der Vorlesung von Interesse erhalten. Und wie kann man verstehen, welcher Vortrag ihn interessiert? Die Seite hat 16 Vorträge und jede Woche gibt es nur mehr. Ich denke, dass selbst ich, der all diese Vorlesungen gedreht und bearbeitet hat, nicht in der Lage sein werde, anhand eines zufälligen Fragments festzustellen, um welche Vorlesung es sich handelt. Daher ist es notwendig, dass jede Vorlesung irgendwie bezeichnet wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Option, den Quellvideodateien im Bearbeitungsprogramm Untertitel hinzuzufügen, passte nicht zu mir. </font><font style="vertical-align: inherit;">Es musste sichergestellt werden, dass die Originaldateien verwendet wurden. </font><font style="vertical-align: inherit;">Um die von mir geforderte Sendung zu unterstützen, sind so wenig Körperbewegungen wie möglich erforderlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, dass ffmpeg mir auch dabei helfen kann. </font><font style="vertical-align: inherit;">Es verfügt über ein spezielles Attribut </font></font><code>-vf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mit dem Sie Text über das Video setzen können. </font><font style="vertical-align: inherit;">Um dem Video Text hinzuzufügen, müssen Sie dem Befehl das folgende Fragment hinzufügen:</font></font><br>
<br>
<pre><code class="bash hljs">-vf drawtext=<span class="hljs-string">"fontfile=OpenSans.ttf:text=' 13\:  .   ?':fontsize=26:fontcolor=white:borderw=1:bordercolor=black:x=40:y=670"</span></code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dekodierung von Parametern</font></font></b><div class="spoiler_text"><code>fontfile=</code> –    .       .          .        .<br>
<br>
<code>text=</code> – ,  ,     .<br>
<br>
<code>fontsize=</code> –    .<br>
<br>
<code>fontcolor=</code> –  .<br>
<br>
<code>borderw=</code> –       (         1 ).<br>
<br>
<code>bordercolor=</code> –  .<br>
<br>
<code>x=</code>  <code>y=</code> –  .  <code>0;0</code>     .      ,           1280720 .<br>
</div></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es sieht aus wie das:</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/jf/1n/sh/jf1nshia1hbk30-pjd5y6mztga0.jpeg" alt="Bild"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 6 - Bestimmen Sie die Sendequalität</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles, die Sendung ist fertig. FFmpeg sendet, Dateien spielen, meine Anwesenheit wird für die Übertragung nicht benötigt. Auch jede Vorlesung ist unterschrieben. Sieh so aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber eine andere Nuance tauchte auf - ich habe die minimale Serverkonfiguration gewählt und sie hat die Sendung nicht abgerufen. Serverkonfiguration: 1 Kern (wie 2,2 GHz), 1 Gigabyte RAM, 25 GB SSD. Es gab genügend RAM, aber der Prozessor wurde fast vollständig zu 100% geladen (und manchmal sogar zu 102-103% :) Dies führte dazu, dass die Sendung alle paar Sekunden einmal einfriert. Hässlich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie könnten einfach eine teurere Konfiguration mit zwei Kernen vornehmen. Der Vorteil besteht darin, dass bei Cloud-Technologien die Serverkonfiguration durch Drücken einiger Tasten geändert wird. </font><font style="vertical-align: inherit;">Aber ich wollte in die Leistung der minimalen Konfiguration passen. </font><font style="vertical-align: inherit;">Ich habe angefangen, die ffmpeg-Dokumentation zu studieren, und ja, dort gibt es auch Einstellungen, mit denen Sie die Belastung des Systems anpassen können.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine hohe Bildqualität kann auf zwei Arten erreicht werden: entweder durch eine hohe Prozessorlast oder durch einen großen ausgehenden Datenverkehr. </font><font style="vertical-align: inherit;">Es stellt sich heraus, dass der Kanal umso weniger Bandbreite benötigt, je mehr der Prozessor die Last übernehmen kann. </font><font style="vertical-align: inherit;">Oder Sie können den Prozessor nicht stark laden, benötigen dann aber einen breiten Kanal mit einem großen Verkehrsspielraum. </font><font style="vertical-align: inherit;">Wenn sowohl der Prozessor als auch die Größe des ausgehenden Kanals / Datenverkehrs eingeschränkt sind, müssen Sie die Bildqualität reduzieren, damit die Übertragung reibungslos verläuft.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mein Server hat einen 10-Mbit / s-Kanal. Diese Breite ist gerade mit einem Rand. Es gibt jedoch ein Verkehrslimit - 1 TB pro Monat. Um die Verkehrsbeschränkungen zu erfüllen, sollte mein ausgehender Stream daher ~ 300 Kb pro Sekunde nicht überschreiten, d.h. Die Bitrate des ausgehenden Streams sollte nicht mehr als 2,5 Mbit / s betragen. YouTube empfiehlt übrigens nur, mit einer solchen Bitrate zu senden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ffmpeg verwendet verschiedene Ansätze, um die Belastung des Systems zu regulieren. Gut geschrieben </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Am Ende habe ich zwei Attribute verwendet: </font></font><code>-crf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>-preset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konstanter Ratenfaktor (CRF)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Dies ist ein Koeffizient, aufgrund dessen Sie die Bildqualität anpassen können. </font><font style="vertical-align: inherit;">CRF kann zwischen 0 und 51 liegen, wobei 0 die Qualität der Quelldatei und 51 die schlechteste Qualität ist. </font><font style="vertical-align: inherit;">Es wird empfohlen, Werte zwischen 17 und 28 zu verwenden. Der Standardwert ist 23. Bei einem Verhältnis von 17 ist das Video optisch identisch mit dem Original, technisch jedoch nicht. </font><font style="vertical-align: inherit;">Die Dokumentation besagt auch, dass sich die Größe des endgültigen Videos in Abhängigkeit von der angegebenen CRF exponentiell ändert, d.h. </font><font style="vertical-align: inherit;">Durch Erhöhen des Koeffizienten um 6 Punkte wird die Bitrate des ausgehenden Videos verdoppelt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie CRF verwenden, können Sie das "Gewicht" des ausgehenden Bildes auswählen und dann mithilfe von </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voreinstellungen (-preset)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bestimmen, wie viel der Prozessor geladen wird. </font><font style="vertical-align: inherit;">Die Parameter für dieses Attribut haben Folgendes:</font></font><br>
<br>
<ul>
<li><code>ultrafast</code></li>
<li><code>superfast</code></li>
<li><code>veryfast</code></li>
<li><code>faster</code></li>
<li><code>fast</code></li>
<li><code>medium</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Standardwert</font></font></li>
<li><code>slow</code></li>
<li><code>slower</code></li>
<li><code>veryslow</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je „schneller“ der Parameter angegeben wird, desto höher ist die Belastung des Prozessors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich nahm zuerst die Voreinstellung auf, die für meinen Prozessor im Grunde genommen „hart“ war, und stellte dann die Last mithilfe von CRF feiner ein. </font><font style="vertical-align: inherit;">In meinem Fall wurde die Voreinstellung </font></font><code>fast</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">angezeigt, und für crf habe ich mich auf einen Wert von 24 festgelegt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles. </font><font style="vertical-align: inherit;">Der letzte Befehl zum Starten der Sendung Ich habe Folgendes erhalten:</font></font><br>
<br>
<pre><code class="bash hljs">ffmpeg -re -i lecture1.mp4 -vf drawtext=<span class="hljs-string">"fontfile=OpenSans.ttf:text=' 1\:   ':fontsize=26:fontcolor=white:borderw=1:bordercolor=black:x=40:y=670"</span> -c:v libx264 -preset fast -crf 24 -g 3 -f flv rtmp://a.rtmp.youtube.com/live2/%_%</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier gibt es nur zwei unbeschriebene Momente: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) </font></font><code>-c:v libx264</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- eine Angabe eines bestimmten Codecs für die Arbeit mit der Quelldatei. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) </font></font><code>-g 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- eine explizite Angabe der Anzahl der Keyframes. In diesem Fall wird angegeben, dass jeder dritte Frame der Schlüssel sein sollte. Der Standardwert ist entweder 5 oder 8, aber YouTube schwört, fragt mindestens 3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Welche Qualität der Sendung stellte sich heraus , zu </font><font style="vertical-align: inherit;">sehen ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Serverlast war wie folgt:</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/b5/3s/za/b53szauaywx3bdwoic-yebil1es.jpeg" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/webt/cq/jc/t4/cqjct4xhbz3zabriimgydbxvjaq.jpeg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Basierend auf den Überwachungsdaten ist klar, dass die Prozessorlast zwischen 70% und 95% variiert und die Übertragung in einer Woche nie 100% erreicht hat. Mit diesen Einstellungen reicht der Prozessor also aus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Laden einer Festplatte kann ich sagen, dass sie fast nicht geladen ist und eine normale Festplatte für die Übertragung ausreichen sollte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber die Menge des ausgehenden Verkehrs stört mich. Es stellt sich heraus, dass mein ausgehender Stream zwischen 450 und 650 KB pro Sekunde liegt. Für einen Monat werden es ungefähr 1,8 Terabyte sein. Möglicherweise müssen Sie Datenverkehr kaufen oder trotzdem zu einer Dual-Core-Konfiguration wechseln, weil Ich möchte die Bildqualität nicht reduzieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*** </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher kann ich sagen, dass das Einrichten einer solchen Sendung von Grund auf ungefähr 1-2 Stunden dauert. Darüber hinaus dauert es die meiste Zeit, bis das Video auf den Server hochgeladen ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Marketinginstrument hat sich der Start einer solchen Sendung nicht ausgezahlt. Wenn Sie die Ansichten so beenden, dass die YouTube-Algorithmen diese Sendung aufgreifen und aktiv in den Empfehlungen anzeigen, funktioniert möglicherweise etwas. In meinem Fall wurde es 16 Tage lang ununterbrochen ausgestrahlt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist ok. Die Sendung passt harmonisch auf die Hauptseite meiner Website. Es stellte sich als eine Art Gelegenheit heraus, sich schnell über den Dozenten und die Vorlesungen selbst zu entscheiden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und einen Moment. Es ist wichtig, dass die Sendung nicht das Urheberrecht anderer verletzt, da sie sonst blockiert wird. Ich bin ruhig für meine Sendung. Ich habe speziell musikalische Beilagen mit kostenlosem Gebrauch ausgewählt, und der Autor des Inhalts sitzt an einem benachbarten Computer und ist überhaupt nicht gegen mich, wenn ich seinen Inhalt verwende :)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn jedoch irgendwo im Hintergrund ein Radio im Hintergrund abgespielt wird oder Sie während der Bearbeitung Ihren Lieblingstrack verwendet haben oder ein Video aus einem beliebten Musikvideo, einer Serie oder einem Film aufgenommen haben, ist Ihre Sendung gefährdet. </font><font style="vertical-align: inherit;">Es ist auch wichtig, dass die Sendung mindestens eine minimale semantische Last trägt, da sie sonst als Spam blockiert werden kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*** </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles für mich. </font><font style="vertical-align: inherit;">Ich hoffe, dieses Handbuch wird jemandem gut dienen. </font><font style="vertical-align: inherit;">Nun, wenn Sie etwas hinzuzufügen haben - schreiben Sie, ich werde gerne Ergänzungen und Erläuterungen zum Artikel lesen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493336/index.html">Wie das Informatikzentrum das Online-Lernen übersetzte</a></li>
<li><a href="../de493340/index.html">SIL-Funktionen zwischen Versionen in Jira portierbar machen</a></li>
<li><a href="../de493342/index.html">Wie NSPK die Infrastruktur für den Übergang nach Udalenka vorbereitete</a></li>
<li><a href="../de493346/index.html">Wir haben es geschafft, Büros nach Udalenka zu verlegen, und Sie?</a></li>
<li><a href="../de493348/index.html">Machen Sie "udalenka" wieder großartig: Wie Sie das gesamte Unternehmen in 4 Schritten auf Remote-Arbeit übertragen können</a></li>
<li><a href="../de493356/index.html">Video @Databases Meetup: DBMS-Sicherheit, Tarantool in IoT, Greenplum für Big Data Analytics</a></li>
<li><a href="../de493360/index.html">Zwei Finger von Algol</a></li>
<li><a href="../de493362/index.html">Technischer Support "auf den Koffern". Wie wir ohne unnötige Nerven aus der Ferne arbeiten und die Dienste erhalten, die wir aus der Ferne benötigen</a></li>
<li><a href="../de493366/index.html">Was ist Windows PowerShell und was isst es? Teil 3: Übergeben von Parametern an Skripte und Funktionen, Erstellen von Cmdlets</a></li>
<li><a href="../de493374/index.html">Coronavirus - praktische Tipps und ein bisschen Theorie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>