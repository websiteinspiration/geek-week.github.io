<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß¢ ‚òòÔ∏è üë®üèª‚Äç‚öïÔ∏è Optimisation du rendu pour mobile, partie 2. Les principales familles de GPU mobiles modernes ü§æ üéé üîö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salutations, chers amoureux et professionnels, programmeurs graphiques! Commen√ßons la deuxi√®me partie de notre s√©rie d'articles sur l'optimisation du ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Optimisation du rendu pour mobile, partie 2. Les principales familles de GPU mobiles modernes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/playrix/blog/498564/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salutations, chers amoureux et professionnels, programmeurs graphiques! </font><font style="vertical-align: inherit;">Commen√ßons la deuxi√®me partie de notre s√©rie d'articles sur l'optimisation du rendu pour mobile. </font><font style="vertical-align: inherit;">Dans cette partie, nous consid√©rerons les principales familles de GPU pr√©sent√©es par les joueurs sur Mobile.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36d/cf7/711/36dcf7711d7ce68544c97bb8dc69ee32.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, consid√©rez un certain nombre de crit√®res selon lesquels les GPU mobiles peuvent √™tre class√©s. </font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noyaux de shader unifi√©s ou sp√©cialis√©s</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä l'√®re des premi√®res cartes vid√©o mobiles, avant la propagation d'effets complexes, il existait un point de vue selon lequel pour les shaders de fragments, la prise en charge de calculs avec une pr√©cision r√©duite √©tait suffisante. En effet, dans un mode d'affichage typique, 8 bits voire moins sont utilis√©s pour chaque canal de couleur. Cette vue a conduit √† l'utilisation de noyaux de shader sp√©cialis√©s. Pour les sommets, nous avons utilis√© des noyaux optimis√©s pour les transformations matricielles avec une pr√©cision accrue FP24 / FP32 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">highp</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Pour les pixels, noyaux qui fonctionnent plus efficacement avec une pr√©cision r√©duite FP16 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mediump</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Avec ce </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">highp</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ils n'√©taient pas pris en charge. </font><font style="vertical-align: inherit;">√Ä premi√®re vue, cette sp√©cialisation nous permet d'obtenir une r√©partition plus rationnelle des transistors sur la puce. </font><font style="vertical-align: inherit;">Cependant, en pratique, cela conduit √† des difficult√©s √† d√©velopper des effets complexes, ainsi qu'√† utiliser des textures haute r√©solution. </font><font style="vertical-align: inherit;">De plus, la sp√©cialisation de base peut conduire √† </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un goulot d'√©tranglement de sommet / fragment</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ce terme fait r√©f√©rence √† la situation o√π, en raison de la charge asym√©trique sur les noyaux des sommets et des pixels, certains des noyaux √©taient ¬´inactifs¬ª.&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/307/144/547/30714454751e34703835ce904cf5f40a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, les architectures modernes utilisent des c≈ìurs unifi√©s. </font><font style="vertical-align: inherit;">Ces noyaux peuvent prendre en charge le sommet, le pixel et d'autres t√¢ches de calcul en fonction de la charge.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ffe/d7c/363/ffed7c363ebecf0d390a0271c1a8b014.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jeu d'instructions vectorielles (SIMD) ou scalaires</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'esprit du d√©sir d'√©conomiser sur les transistors d√©crits ci-dessus, sp√©cialis√© dans les noyaux, la conception d'un ensemble d'instructions de shader a eu lieu. La plupart des transformations typiques des graphiques tridimensionnels fonctionnent avec 4 vecteurs composants. Par cons√©quent, les premiers GPU fonctionnaient sp√©cifiquement avec de tels op√©randes. Si le code du shader contenait des op√©rations scalaires h√©t√©rog√®nes qui ne pouvaient pas √™tre regroup√©es en op√©rations vectorielles par l'optimiseur, une partie de la puissance de calcul n'√©tait pas utilis√©e. Ce ph√©nom√®ne peut √™tre illustr√© comme suit:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b7/3dd/34a/6b73dd34a79eb4376ed816a37de4a4ae.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe un shader qui impl√©mente l'op√©ration d'ajout de multiplication commune: multipliez 2 op√©randes, puis ajoutez le troisi√®me. Lors de la compilation sur une architecture vectorielle conditionnelle (Vector ISA = Vector Instruction Set Architecture), nous obtenons une instruction vectorielle </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vMADD</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui fonctionne pour 1 horloge. Sur l'architecture scalaire conditionnelle, nous obtenons 4 instructions scalaires qui, gr√¢ce √† un pipeline am√©lior√©, s'ex√©cutent √©galement en 1 cycle d'horloge. Consid√©rons maintenant un shader sophistiqu√© qui effectue 2 op√©rations, mais sur 2 op√©randes composants.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/333/539/b2f/333539b2fb573f8f93ff518ca25f6e5c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas de l'architecture vectorielle, nous obtenons d√©j√† 2 instructions qui n√©cessitent 2 cycles d'horloge pour s'ex√©cuter. Cependant, aucune </font><font style="vertical-align: inherit;">action n'est prise </font><font style="vertical-align: inherit;">sur les composants </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.zw</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et la puissance de traitement est inactive. Dans le cas d'une architecture scalaire, ces m√™mes op√©rations peuvent √™tre regroup√©es dans 4 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sMADD</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scalaires </font><font style="vertical-align: inherit;">qui s'ex√©cutent dans le m√™me cycle d'horloge. Ainsi, sur l'architecture scalaire du fait de l'am√©lioration du pipeline, une densit√© de calculs plus √©lev√©e est atteinte. Cependant, comme cela sera montr√© ci-dessous, le vecteur </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISA</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est toujours pertinent. Il est donc logique d'appliquer des techniques de vectorisation pour le code de shader. Ils vous permettent d'obtenir des performances accrues sur les cartes vid√©o avec le vecteur </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISA</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En m√™me temps, en r√®gle g√©n√©rale, cela ne nuit pas aux performances sur des scalaires plus modernes</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'ISA</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base des caract√©ristiques ci-dessus, nous consid√©rerons les familles de GPU mobiles qui sont courantes √† notre √©poque. </font><font style="vertical-align: inherit;">Commen√ßons par la famille la plus courante. </font><font style="vertical-align: inherit;">Beaucoup de gens savent que nous parlons de cartes graphiques </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la soci√©t√© britannique </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ARM</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ARM n'est pas directement impliqu√© dans la production de puces, offrant plut√¥t la propri√©t√© intellectuelle. </font><font style="vertical-align: inherit;">Comme les autres cartes vid√©o mobiles, le Mali fait partie de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System on Chip (SoC)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est-√†-dire </font><font style="vertical-align: inherit;">fonctionne avec la </font><font style="vertical-align: inherit;">m√©moire </font><font style="vertical-align: inherit;">partag√©e pour le </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le bus.&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali utgard</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2008, les premiers repr√©sentants de l'architecture </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Utgard</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont </font><strong><font style="vertical-align: inherit;">n√©s</font></strong><font style="vertical-align: inherit;"> , pertinents jusqu'√† nos jours. </font><font style="vertical-align: inherit;">Ces cartes vid√©o sont nomm√©es selon le sch√©ma Mali-4 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xx</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MP </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o√π </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xx</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le num√©ro de mod√®le et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le nombre de c≈ìurs de fragments. </font><font style="vertical-align: inherit;">Au </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la sp√©cialit√© du noyau de shader </font><strong><font style="vertical-align: inherit;">Utgard</font></strong><font style="vertical-align: inherit;"> , et tous les mod√®les sont livr√©s avec un sommet seulement 1 noyau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autres caract√©ristiques de l'architecture Mali Utgard:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL ES 2.0&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manque de support </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">highp</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les noyaux fragment√©s</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jeu d'instructions vectorielles (il est logique de vectoriser les calculs)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgr√© la sp√©cification </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL ES</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilotes de</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cartes vid√©o </font><strong><font style="vertical-align: inherit;">Mali Utgard</font></strong><font style="vertical-align: inherit;"> compilent avec succ√®s des shaders de fragments qui utilisent </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pr√©cision </font><strong><font style="vertical-align: inherit;">haute r√©solution</font></strong><font style="vertical-align: inherit;"> (par exemple, la pr√©cision est d√©finie par d√©faut √† l'aide de la </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©cision flottante haute pr√©cision</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Mais la pr√©cision de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mediump est</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> effectivement utilis√©e </font><font style="vertical-align: inherit;">. Par cons√©quent, il est conseill√© de tester en outre tous les shaders pour les jeux mobiles sur ces cartes vid√©o. Selon les donn√©es recueillies par </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unity</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , fin 2019, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Utgard a</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> travaill√© sur des appareils pour environ 10% des joueurs. Et si vous d√©finissez les filtres appropri√©s sur </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">market.yandex.ru</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vous pouvez voir qu'en 2019 plus de 10 nouveaux t√©l√©phones avec des cartes vid√©o de cette architecture ont √©t√© annonc√©s.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/779/5a9/8ae/7795a98ae2da31ecf49131939087c21e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous √™tes pr√™t √† abandonner cette audience, il suffit de d√©finir l'exigence de prise en charge d'OpenGL ES 3.0 dans AndroidManifest.xml: </font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">uses-feature</span> <span class="hljs-attr">android:glEsVersion</span>=<span class="hljs-string">"0x00030000"</span> <span class="hljs-attr">android:required</span>=<span class="hljs-string">"true"</span>‚ÅÑ&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Utgard</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il n'y a actuellement aucun GPU mobile r√©pandu sans prise en charge d'OpenGL ES 3.0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter en particulier l'utilisation de textures haute r√©solution sur le </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Utgard</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dix bits de la mantisse avec </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pr√©cision </font><strong><font style="vertical-align: inherit;">moyenne</font></strong><font style="vertical-align: inherit;"> ne suffisent pas pour une texturation de haute qualit√© avec une r√©solution de texture sup√©rieure √† 1024 d'un c√¥t√©. </font><font style="vertical-align: inherit;">Cependant, bien qu'il ne </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prenne</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font><font style="vertical-align: inherit;">charge que la </font><font style="vertical-align: inherit;">pr√©cision </font><strong><font style="vertical-align: inherit;">mediump</font></strong><font style="vertical-align: inherit;"> dans les c≈ìurs de fragments </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Utgard</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vous pouvez obtenir </font><font style="vertical-align: inherit;">une pr√©cision des coordonn√©es de texture </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fp24</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lorsque vous utilisez </font><font style="vertical-align: inherit;">directement la </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variation</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">// vertex shader</span><font></font>
varying highp vec2 v_texc;<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
    v_texc = ‚Ä¶;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//  fragment shader</span><font></font>
...<font></font>
varying highp vec2 v_texc;<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
    gl_FragColor = texture2D(u_sampler, v_texc); <span class="hljs-comment">//  v_texc </span>
                                                 <span class="hljs-comment">//  </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En prime sur certaines architectures, cette approche vous permet de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©-</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> extraire le contenu de la texture avant d'ex√©cuter un </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fragment shader</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui minimise les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blocages</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en attendant les r√©sultats de l'√©chantillonnage de texture.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali midgard</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Utgard a √©t√©</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> remplac√© par l'architecture </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Midgard</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il existe plusieurs g√©n√©rations de cette architecture avec les noms des esp√®ces </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-6xx</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-7xx</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-8xx</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Malgr√© l'√¢ge de 8 ans, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Midgard</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut √™tre qualifi√© d'architecture moderne qui prend en charge la plupart des nouvelles fonctionnalit√©s:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noyaux de shader unifi√©s</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL ES 3.2 (shaders de calcul et de g√©om√©trie, tesselation ...)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, le Mali Midgard conserve le vecteur </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISA</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Compte tenu de l'utilisation g√©n√©ralis√©e de Mali Midgard (environ 25% de notre audience), la vectorisation de l'informatique devient appropri√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre caract√©ristique de Mali Midgard est la technologie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forward Pixel Kill</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Chaque pixel est calcul√© dans un flux s√©par√© du noyau du fragment. </font><font style="vertical-align: inherit;">Si, pendant l'ex√©cution du flux, il devient connu que le pixel r√©sultant sera bloqu√© par un pixel opaque d'une autre primitive, le flux se termine pr√©matur√©ment et les ressources lib√©r√©es sont utilis√©es pour d'autres calculs.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bifrost du Mali</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A c√¥t√© de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Midgard, l'</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> architecture </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bifrost se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> distingue par sa transition vers l' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISA</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scalaire </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Par rapport √† l'architecture pr√©c√©dente, le nombre maximal de c≈ìurs a √©t√© augment√© (de 16 √† 32) et une interface am√©lior√©e avec un processeur est prise en charge, ce qui permet un acc√®s coh√©rent √† la m√©moire partag√©e: les modifications du contenu de la m√©moire du processeur / GPU deviennent imm√©diatement ¬´visibles¬ª les unes aux autres malgr√© les caches, qui vous permet de simplifier la synchronisation.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De non officiel</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De nombreuses tentatives ont √©t√© faites pour d√©sosser les cartes vid√©o du </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> afin de cr√©er des </font><font style="vertical-align: inherit;">pilotes </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open Source</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Les travaux des personnes d√©vou√©es qui tentent de le faire nous permettent de jeter un coup d'≈ìil aux fonctionnalit√©s non document√©es des cartes vid√©o du </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ainsi, dans le projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PanFrost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">il</font></a><font style="vertical-align: inherit;"> existe un d√©sassembleur pour </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Midgard / Bifrost</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , avec lequel vous pouvez vous familiariser avec un ensemble d'instructions de shader (il n'y a pas d'informations officielles ouvertes sur ce sujet).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bbd/f31/751/bbdf3175137a886431a23de54239900e.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno</font></font></h2><br><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">Adreno</font></strong><font style="vertical-align: inherit;"> est la </font><font style="vertical-align: inherit;">
deuxi√®me famille de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mobiles la plus courante </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cette carte vid√©o est install√©e sur le </font><strong><font style="vertical-align: inherit;">SoC</font></strong><font style="vertical-align: inherit;"> , connu sous la marque </font><strong><font style="vertical-align: inherit;">Snapdragon</font></strong><font style="vertical-align: inherit;"> , de la soci√©t√© am√©ricaine </font><strong><font style="vertical-align: inherit;">Qualcomm</font></strong><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Snapdragon est install√© dans les smartphones haut de gamme de notre √©poque de </font><strong><font style="vertical-align: inherit;">Samsung</font></strong><font style="vertical-align: inherit;"> , </font><strong><font style="vertical-align: inherit;">Sony</font></strong><font style="vertical-align: inherit;"> et </font><font style="vertical-align: inherit;">autres.Les </font><font style="vertical-align: inherit;">
cartes vid√©o </font><strong><font style="vertical-align: inherit;">Adreno</font></strong><font style="vertical-align: inherit;"> actuelles </font><font style="vertical-align: inherit;">sont les familles de la s√©rie 3xx - 6xx. </font><font style="vertical-align: inherit;">Toutes ces s√©ries combinent les fonctionnalit√©s suivantes:</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noyaux de shader unifi√©s</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pseudo TBR (grandes tailles de tuiles situ√©es dans une m√©moire GPU d√©di√©e traditionnelle)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commutation automatique en mode de rendu imm√©diat en fonction de la nature de la sc√®ne ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlexRender</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jeu d'instructions scalaire</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä partir d' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno 4xx</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la prise en charge d' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL ES 3.1 est introduite</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et d' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno 5xx - Vulkan</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL ES 3.2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendu bas√© sur les tuiles Adreno</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les cartes vid√©o Adreno ont un GPU ¬´traditionnel¬ª appel√© </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GMEM</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Des volumes de 128 Ko √† 1536 Ko s'appliquent. Cela vous permet d'utiliser une taille de tuile plus grande par rapport aux architectures d'autres d√©veloppeurs de GPU mobiles. Sur Adreno, la taille des tuiles est dynamique et d√©pend du format de couleur utilis√©, du tampon de profondeur et du pochoir. Lorsque vous travaillez en </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode imm√©diat, le</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rendu se produit dans la m√©moire syst√®me. Il existe une extension GL ES qui vous permet de sp√©cifier le mode pr√©f√©r√©: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QCOM_binning_control</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cependant, les derni√®res recommandations de Qualcomm sugg√®rent de s'appuyer enti√®rement sur les pilotes GPU, qui d√©terminent eux-m√™mes le mode le plus pr√©f√©r√© pour le tampon de commande g√©n√©r√© par l'application.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous travaillez en mode </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TBR</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adreno fait 2 passes de vertex:</font></font><br>
<br>
<ol>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passe de binning</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - distribution des primitives par bin ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bacs</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , synonyme de tuiles)</font></font></li>
<li><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passe de sommet</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compl√®te </font><font style="vertical-align: inherit;">pour rendre uniquement les primitives qui tombent dans le chutier actuel</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant la </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passe Binning,</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adreno ne calcule que les positions des sommets. </font><font style="vertical-align: inherit;">Les autres attributs ne sont pas calcul√©s et le code inutile est supprim√© par l'optimiseur. </font><font style="vertical-align: inherit;">Dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation officielle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (9.2 Optimiser le traitement des sommets), il est recommand√© de stocker les informations sur les sommets n√©cessaires pour calculer les positions s√©par√©ment du reste des donn√©es. </font><font style="vertical-align: inherit;">Cela rend la mise en cache des donn√©es de sommet plus efficace.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Freedreno</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/83e/c3d/15d/83ec3d15dc03e81e81e7d867cae2b3a3.png" align="left" width="120"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrairement aux technologies ARM et Imagination, Qualcomm h√©site √† partager les d√©tails de la structure interne de ses GPU. </font><font style="vertical-align: inherit;">Cependant, gr√¢ce aux efforts de l'ing√©nieur inverse Rob Clark, on peut apprendre beaucoup du projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Freedreno</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le pilote open source </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour Linux. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rob Clark par Freedreno</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerVR par Imagination Technologies</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagination Technologies</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une soci√©t√© britannique sans usine c√©l√®bre pour le d√©veloppement de GPU pour les produits Apple. </font><font style="vertical-align: inherit;">La soci√©t√© a jou√© ce r√¥le jusqu'√† l'av√®nement de l'iPhone 8 / X, qui utilise le d√©veloppement interne d'Apple. </font><font style="vertical-align: inherit;">Bien que les recommandations sur les optimisations pour ces puces qui sont rest√©es inchang√©es, ainsi que les revendications de brevet contre Apple d'Imagination sugg√®rent qu'Apple a continu√© √† d√©velopper l'architecture PowerVR, un d√©veloppement original d'Imagination. </font><font style="vertical-align: inherit;">Au d√©but de 2020, Apple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est revenu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aux pratiques de licence avec Imagination Technologies. </font><font style="vertical-align: inherit;">En plus des appareils avec iOS / iPadOS, les cartes vid√©o PowerVR sont install√©es dans un grand nombre de smartphones et tablettes Android.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a9d/86d/b66/a9d86db66b2293beaf3b01d3d809573f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez la famille de cartes graphiques PowerVR que l'on trouve encore parmi les utilisateurs.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerVR SGX</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les premi√®res cartes graphiques PowerVR SGX sont apparues en 2009. </font><font style="vertical-align: inherit;">Il existe plusieurs g√©n√©rations de cette architecture: Series5, Series5XT et Series5XE. </font><font style="vertical-align: inherit;">Apple a utilis√© ces GPU jusqu'√† l'iPAD 4 / iPhone 5 / iPOD Touch 5. Les fonctionnalit√©s SGX suivantes peuvent √™tre cit√©es:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noyaux de shader unifi√©s</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL ES 2.0</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jeu d'instructions vectorielles</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prise en charge de la pr√©cision lowp 10 bits dans les shaders</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">faible performance des lectures de texture d√©pendante</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arr√™tons-nous sur certains d'entre eux plus en d√©tail.&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©cision Lowp</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerVR SGX sont les seuls GPU mobiles √† jour avec </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prise en</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> charge mat√©rielle </font><strong><font style="vertical-align: inherit;">lowp</font></strong><font style="vertical-align: inherit;"> . Les mod√®les PowerVR plus r√©cents, ainsi que tous les GPU modernes d'autres fournisseurs, utilisent en fait </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pr√©cision </font><strong><font style="vertical-align: inherit;">moyenne</font></strong><font style="vertical-align: inherit;"> . L'utilisation de </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowp</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le PowerVR SXG vous permet d'obtenir une densit√© de calcul plus √©lev√©e (plus d'op√©rations par cycle). Dans le m√™me temps, l'op√©ration swizzle (permutation des composantes vectorielles) pour </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowp</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , contrairement √† d'autres pr√©cisions, n'est pas gratuite. Cette fonctionnalit√©, ainsi que la gamme √©troite de valeurs fournies par lowp ([-2,2]), limitent sa port√©e. Dans le m√™me temps, le </font><strong><font style="vertical-align: inherit;">lowp</font></strong><font style="vertical-align: inherit;"> mal r√©gl√©</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entra√Ænant des artefacts sur la famille SGX ne sera pas visible sur toutes les autres cartes graphiques o√π la pr√©cision </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mediump</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera r√©ellement utilis√©e </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pour cette raison, vous devriez envisager de refuser d'utiliser </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowp</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les shaders.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La texture d√©pendante se lit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous le savez, les op√©rations d'√©chantillonnage de texture sont les plus lentes en raison de la n√©cessit√© d'attendre les r√©sultats de lecture de la m√©moire. Dans le cas du SoC mobile, nous parlons de m√©moire syst√®me partag√©e avec un CPU. Pour r√©duire le nombre d'acc√®s √† la m√©moire lente, des caches de texture sont utilis√©s. Pour √©viter les temps d'arr√™t au d√©but de la pixellisation √† l'aide d'une texture, il est judicieux de mettre en cache les zones utilis√©es √† l'avance. Si le shader de fragment utilise les coordonn√©es de texture transmises depuis le vertex shader sans modifications, la section de texture n√©cessaire √† la mise en cache peut √™tre d√©termin√©e avant l'ex√©cution du shader de fragment. Si le shader de fragment change la coordonn√©e de texture ou la calcule en utilisant les donn√©es d'une autre texture, alors ce n'est pas toujours possible. Par cons√©quent, l'ex√©cution du fragment shader peut ralentir.Les cartes graphiques PowerVR SGX sont particuli√®rement douloureuses dans ce sc√©nario. De plus, m√™me l'utilisation d'une permutation des composantes de la coordonn√©e de texture (swizzle) conduit √†</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">texture d√©pendante lue</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Voici un exemple de programme de shader sans </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lecture de texture d√©pendante</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programme vertex</font></font></strong><br>
<br>
<pre><code class="cpp hljs">attribute highp vec2 a_texc;<font></font>
varying highp vec2 v_texc;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
	gl_Position = ‚Ä¶<font></font>
	v_texc = a_texc;<font></font>
}<font></font>
<font></font>
</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programme de fragment</font></font></strong><br>
<br>
<pre><code class="cpp hljs">precision mediump <span class="hljs-keyword">float</span>;<font></font>
uniform sampler u_sampler;<font></font>
varying highp vec2 v_texc;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
	gl_FragColor = texture2D( u_sampler, v_texc ); <span class="hljs-comment">//  dependent texture read</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programme de fragment</font></font></strong><br>
<br>
<pre><code class="cpp hljs">precision mediump <span class="hljs-keyword">float</span>;<font></font>
uniform sampler u_sampler;<font></font>
varying highp vec2 v_texc;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
	gl_FragColor = texture2D( u_sampler, v_texc.yx ); <span class="hljs-comment">// dependent texture read!</span><font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerVR Rogue</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les cartes vid√©o PowerVR ont √©t√© d√©velopp√©es dans l'architecture </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rogue</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il existe plusieurs g√©n√©rations de cette architecture: de la s√©rie 6 √† la s√©rie 9. </font><font style="vertical-align: inherit;">Tous les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerVR Rogue</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ont ces caract√©ristiques:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noyaux de shader unifi√©s</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">architecture d'instruction scalaire</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prise en charge d'OpenGL ES 3.0+ (jusqu'√† 3.2, ainsi que de l'API Vulkan pour les nouvelles r√®gles)&nbsp;</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerVR TBDR</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme tous les GPU mobiles courants, PowerVR utilise un pipeline de tuiles. Mais contrairement √† ses concurrents, Imagination est all√© plus loin et a mis en ≈ìuvre une </font><font style="vertical-align: inherit;">pixellisation </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diff√©r√©e</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des primitives, permettant d'ignorer l'ombrage des pixels invisibles quel que soit l'ordre de rendu. Cette approche est appel√©e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rendu diff√©r√© bas√© sur les tuiles</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et le processus d'√©limination des pixels invisibles est </font><font style="vertical-align: inherit;">appel√© </font><font style="vertical-align: inherit;">suppression de surface cach√©e (HSR).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff2/2db/1dd/ff22db1dd631bb54e964aa24c96b437f.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppression de la surface cach√©e</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Il est recommand√© de dessiner la g√©om√©trie opaque sur transparent et de ne pas utiliser Z Prepass, ce qui dans le cas des cartes vid√©o PowerVR dans la plupart des sc√©narios entra√Ænera un travail inutile. </font><font style="vertical-align: inherit;">Cependant, plusieurs pixels transparents cons√©cutifs se chevauchant sont compl√®tement ombr√©s pour obtenir la bonne couleur, en tenant compte du m√©lange. </font><font style="vertical-align: inherit;">Le dernier pixel transparent peut √™tre supprim√© s'il est suivi d'un pixel opaque.&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Technologies d'imagination d'ouverture</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les cr√©ateurs de PowerVR ont fourni un acc√®s ouvert √† plus de documentation que les autres d√©veloppeurs de GPU. </font><font style="vertical-align: inherit;">L'architecture du pipeline graphique est d√©crite en d√©tail, ainsi qu'un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ensemble d'instructions pour l'architecture Rogue</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il existe un outil pratique </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVRShaderEditor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui vous permet de recevoir </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">instantan√©ment</font></a><font style="vertical-align: inherit;"> des informations de profilage sur le shader, ainsi que sa liste d√©mont√©e pour Rogue.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aba/b9a/19e/abab9a19e78e6ff40638d5cdf971615a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgr√© la pr√©sence limit√©e des cartes vid√©o PowerVR dans l'environnement des appareils bas√©s sur Android, il est logique d'√©tudier leur architecture pour la programmation comp√©tente des graphiques pour iOS.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU mobiles en mode imm√©diat</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons examin√© les familles de cartes vid√©o mobiles les plus courantes. </font><font style="vertical-align: inherit;">Toutes ces familles utilisaient une architecture de rendu de tuiles. </font><font style="vertical-align: inherit;">Cependant, il existe des cartes vid√©o mobiles qui utilisent l' </font><font style="vertical-align: inherit;">approche </font><font style="vertical-align: inherit;">traditionnelle </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en mode imm√©diat</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En voici quelques uns:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nVIdia (Tegra SoC)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toute la famille Intel √† l'exception de la r√©cente g√©n√©ration 11</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vivante GCxxxx (+ Arcturus GC8000)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une caract√©ristique des cartes vid√©o mobiles fonctionnant en </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode imm√©diat</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est l'op√©ration de nettoyage FBO co√ªteuse. </font><font style="vertical-align: inherit;">Rappelons que sur l'architecture de tuile, le nettoyage en plein √©cran acc√©l√®re le rendu, permettant au pilote de ne pas ajouter l'op√©ration de chargement de l'ancien contenu √† la m√©moire de tuile. </font><font style="vertical-align: inherit;">Sur les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU en mode imm√©diat</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mobile </font><strong><font style="vertical-align: inherit;">,</font></strong><font style="vertical-align: inherit;"> le nettoyage plein √©cran est une op√©ration longue qui permet, entre autres, √† ces GPU de ¬´calculer¬ª. </font><font style="vertical-align: inherit;">Si l'ajout de nettoyage n'acc√©l√®re pas, mais ralentit le rendu, alors nous travaillons tr√®s probablement avec </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un GPU en mode imm√©diat</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Bien s√ªr, n'oublions pas de mentionner que sur les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU en mode imm√©diat,</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> changer une cible est une proc√©dure ¬´conditionnellement libre¬ª.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©partition des diff√©rentes familles de GPU mobiles parmi nos joueurs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici les statistiques sur les GPU mobiles collect√©es aupr√®s de nos joueurs fin 2019:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7f/184/634/e7f1846345e5e8bf798bbf207a11885d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ci-dessous, nous ouvrons le segment ¬´Autres¬ª</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a3/f61/604/8a3f61604361a8c8e426ae0ae8920f05.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base de ces donn√©es, nous examinons la distribution du GPU en termes de leurs principales caract√©ristiques.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b41/b97/3d5/b41b973d5d8d01e817a558d838396d63.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les ALU vectorielles (unit√© de logique arithm√©tique) deviennent obsol√®tes et remplac√©es par des unit√©s scalaires. Aujourd'hui, l'essentiel des GPU mobiles avec un jeu d'instructions vectorielles est le </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali Midgard</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui peut √™tre consid√©r√© comme moyen en termes de performances. Parce que la vectorisation, en r√®gle g√©n√©rale, ne ralentit pas l'ex√©cution sur les ALU scalaires; il convient de consid√©rer la vectorisation comme une technique r√©elle pour optimiser les shaders pour mobile.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les noyaux de shaders sp√©cialis√©s sont obsol√®tes et remplac√©s par des noyaux unifi√©s. Le goulot d'√©tranglement du sommet du maillage squelettique n'est plus effrayant. Les noyaux sp√©cialis√©s sont utilis√©s uniquement sur la famille </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-4xx (Utgard)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Rappelez-vous que ces GPU ne prennent en charge que </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL ES 2.0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Notre audience en compte environ 3,5%.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, la grande majorit√© des GPU mobiles utilisent l'approche des tuiles. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le mode imm√©diat est</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devenu marginalis√© et est rapidement √©limin√© avec les cartes vid√©o qui l'utilisent. </font><font style="vertical-align: inherit;">La part des </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font><strong><font style="vertical-align: inherit;">mode imm√©diat</font></strong><font style="vertical-align: inherit;"> dans nos lecteurs est d'environ 0,7%. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liens utiles:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">developer.arm.com/solutions/graphics</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">developer.qualcomm.com/software/adreno-gpu-sdk/tools</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.imgtec.com/developers/powervr-sdk-tools/documentation/</font></font></a></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merci pour l'attention! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le prochain article de la s√©rie, nous examinerons les techniques d'optimisation des shaders pour Mobile.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr498548/index.html">Cr√©ation de votre propre package pour Laravel Nova: OptimalImage</a></li>
<li><a href="../fr498552/index.html">Quelles erreurs font les gestionnaires sur un site distant</a></li>
<li><a href="../fr498556/index.html">Hans Peter Lun et la naissance de l'algorithme de hachage</a></li>
<li><a href="../fr498560/index.html">Composants Web dans un vrai projet</a></li>
<li><a href="../fr498562/index.html">Contrairement √† la quarantaine: comment nous avons transf√©r√© nos stages dans un format distant</a></li>
<li><a href="../fr498566/index.html">Ing√©nierie de la r√©silience: notes de la conf√©rence REDeploy</a></li>
<li><a href="../fr498568/index.html">√Ä l'int√©rieur du microprocesseur sectionnel multipuce AM2901 des ann√©es 1970 d'AMD</a></li>
<li><a href="../fr498572/index.html">Des r√©ductions bizarres? Parts des fournisseurs de CRM √† l'occasion de la transition vers udalenka</a></li>
<li><a href="../fr498574/index.html">Pourquoi ai-je d√©cid√© de d√©velopper des jeux, ou un voyage nostalgique pour z√©ro</a></li>
<li><a href="../fr498576/index.html">Comment nous avons d√©velopp√© le champ de saisie de nouveaux messages dans notre messager (Gem4me)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>