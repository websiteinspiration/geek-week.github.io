<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèª üì∏ ‚ÅâÔ∏è Declarative programming of client-server applications on android. Part 2 üßëüèæ‚Äçü§ù‚Äçüßëüèº ü§µüèæ üôÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The previous article briefly showed the advantages of declarative programming of client-server applications for android in comparison with imperative....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Declarative programming of client-server applications on android. Part 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502024/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">previous article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> briefly showed the advantages of declarative programming of client-server applications for android in comparison with imperative. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we will write a small, but sufficient, project to evaluate the effectiveness of the DePro library. </font><font style="vertical-align: inherit;">It is part of one of the educational </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">examples of the library</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The design of all the screens that we describe is shown in the following figures:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f6c/afe/af5/f6cafeaf546e9467b0a1b71b122b7eeb.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/287/0cb/0b9/2870cb0b957f2ed4318cd78a137ebf3a.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/0d7/f08/980/0d7f08980838c23cc41258eca7a3093e.png" alt="image"><br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DRAWER screen CATALOG screen PRODUCT_LIST screen</font></font></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/5a1/32c/952/5a132c9529aadcf1101fe14137e4ff17.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/b4b/c8e/768/b4bc8e768bb0d616ddb4a4325986cdab.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/227/00e/5f5/22700e5f57ffbc8fc43429ee87f79b87.png" alt="image"><br>
<pre> CATALOG_           DESCRIPT          CHARACTERISTIC</pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/5a6/635/394/5a6635394bccc0473f79ed51b0fab8b6.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/150/f30/32f/150f3032f242fc892db119d5b0fc15a2.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/a0d/44f/49b/a0d44f49bd430384c67a9e6a81a4bbe1.png" alt="image"><br>
<pre> FITNESS           FITNESS_          </pre><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From these screens, their functionality is generally understood. The side menu contains two items ‚ÄúCatalog‚Äù and ‚ÄúFitness‚Äù. When you select an item, the corresponding screen is displayed. The CATALOG screen contains a horizontal "News" list. When you click on any ‚Äúnew product‚Äù, a screen with a description of this product is displayed. Description consists of two tabs: ‚ÄúDescription‚Äù and ‚ÄúCharacteristics‚Äù. Also on the CATALOG screen there is a drop-down list "Catalog". When you click on the down arrow, the directory opens (closes). When you click on the entire line, the PRODUCT_LIST screen is displayed with a list of products for the selected item in the catalog. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When you click on the item ‚ÄúFitness‚Äù, the FITNESS screen with a list of services is displayed. The list depends on the club selected in the spinner. When you try to exit the application, a warning dialog is displayed.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The server transfers data in json format to the application. </font><font style="vertical-align: inherit;">The data structure for each screen is described below. </font><font style="vertical-align: inherit;">In applications written in DePro from the API, only the URL is used, the data structure is needed only to correctly set the name (id) view, because the binding is carried out by name. </font><font style="vertical-align: inherit;">It is worth noting that data is an incomplete slice of real data. </font><font style="vertical-align: inherit;">Therefore, there may be no connections on names, images. </font><font style="vertical-align: inherit;">In particular, product images total 20 pcs. </font><font style="vertical-align: inherit;">Therefore, the same picture can be in many products.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API for example screens</font></font></b>
                        <div class="spoiler_text"> CATALOG    () URL depro/cron/news,  GET.       .     .<br>
<br>
 <br>
<br>
<pre><code class="plaintext hljs">    {<font></font>
        "product_id":4610,<font></font>
        "catalog_id":15984,<font></font>
        "product_name":"  20  6  ( 1*20) APRO",<font></font>
        "catalog_code":"ZRG-20kit",<font></font>
        "picture":"depro/cronimg/picture_1.jpeg",<font></font>
        "bar_code":"4824041010653",<font></font>
        "oem":"",<font></font>
        "price":175.98,<font></font>
        "brand":"APRO",<font></font>
        "product_code":"032578",<font></font>
        "gift":0,<font></font>
        "bonus":0,<font></font>
        "new_product":1,<font></font>
        "quantity":5<font></font>
    },<font></font>
    . . .<font></font>
</code></pre><br>
     URL depro/cron/catalog. <br>
<br>
   URL depro/cron/catalog_ex   catalog_id      id ,  .<br>
<br>
    :<br>
<br>
<pre><code class="plaintext hljs">[<font></font>
    {<font></font>
        "catalog_id":15510,<font></font>
        "parent_id":0,<font></font>
        "catalog_name":""<font></font>
    },<font></font>
    {<font></font>
        "catalog_id":15584,<font></font>
        "parent_id":0,<font></font>
        "catalog_name":""<font></font>
    },<font></font>
    . . .<font></font>
]<font></font>
</code></pre><br>
 PRODUCT_LIST URL depro/cron/product_list  : expandedLevel  catalog_id.<br>
 expandedLevel ‚Äî    (0, 1  2), catalog_id ‚Äî id  .<br>
<br>
   0  1    ,    ,                .<br>
<br>
 GET<br>
<br>
        ()<br>
<br>
       URL depro/cron/product_barcode  <br>
 barcode_scanner. <br>
<br>
       URL depro/cron/product_search   product_name.     LIKE.  product_name      .<br>
<br>
        .<br>
<br>
 DESCRIPT <br>
<br>
 : URL depro/cron/product_id   product_id.  GET.<br>
<br>
<br>
<br>
<pre><code class="plaintext hljs">{<font></font>
    "product_id":2942,<font></font>
    "catalog_id":15594,<font></font>
    "product_name":"   2110, 2111, 2112,  Sens ''  ",<font></font>
    "catalog_code":"23.3828"<font></font>
    ,"picture":"depro/cronimg/picture_16.jpeg",<font></font>
    "bar_code":"2000000148472",<font></font>
    "oem":"2112-3851010",<font></font>
    "price":103.02,<font></font>
    "brand":", . , ",<font></font>
    "product_code":"027729",<font></font>
    "gift":1,<font></font>
    "bonus":0,<font></font>
    "new_product":0,<font></font>
    "quantity":16<font></font>
}<font></font>
</code></pre><br>
: URL depro/cron/product_analog   product_id.  GET.<br>
<br>
<br>
<br>
<pre><code class="plaintext hljs">[<font></font>
    {<font></font>
        "product_id":561,<font></font>
        "catalog_id":15587,<font></font>
        "product_name":"   2110, 2111, 2112 (  16 . ) AURORA",<font></font>
        "catalog_code":"WP-LA2112",<font></font>
        "picture":"depro/cronimg/picture_12.jpeg",<font></font>
        "bar_code":"2900011680711",<font></font>
        "oem":"2112-1307010",<font></font>
        "price":188.16,<font></font>
        "brand":"AURORA, Poland",<font></font>
        "product_code":"016807",<font></font>
        "gift":0,<font></font>
        "bonus":1,<font></font>
        "new_product":0,<font></font>
        "quantity":15<font></font>
    },<font></font>
    . . .<font></font>
]</code></pre><br>
<br>
 CHARACTERISTIC URL depro/cron/product_charact   product_id.  GET.<br>
<br>
<br>
<pre><code class="plaintext hljs">[<font></font>
    {<font></font>
        "prop_id":2764,<font></font>
        "product_id":2942,<font></font>
        "name":"",<font></font>
        "value":", . , "<font></font>
    },<font></font>
    {<font></font>
        "prop_id":2765,<font></font>
        "product_id":2942,<font></font>
        "name":"   ",<font></font>
        "value":","<font></font>
    },<font></font>
    . . .<font></font>
]</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now consider our steps for writing an application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. In the studio we will create a new project. The name can be set at your discretion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Deployment of resources. As mentioned in the first article, resource files (XML) are used conventional. Therefore, in order not to waste time on known things, we simply download </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all the necessary resources</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unzip the resulting res_example.zip file. In the studio, delete the entire contents of the res folder. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Transfer the contents of the unzipped res folder to the res folder of the project. After that, taking into account the features of Android Studio, you may need to clear the project and / or run the Invalid Caches / Restart command. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Connection of the library </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the dependencies section of the build.gradle file of the module, you need to specify:</font></font><br>
<br>
<pre><code class="java hljs">    implementation <span class="hljs-string">'github.com/deprosystem/depro:compon:3.0.1'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the android section of the build.gradle file of the module, you need to specify:</font></font><br>
<br>
<pre><code class="java hljs">    packagingOptions {<font></font>
        exclude <span class="hljs-string">'META-INF/DEPENDENCIES'</span><font></font>
    }<font></font>
    compileOptions {<font></font>
        sourceCompatibility JavaVersion.VERSION_1_8<font></font>
        targetCompatibility JavaVersion.VERSION_1_8<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When choosing the minSdkVersion attribute, you need to consider that the library supports minSdkVersion = 17. After changing build.gradle, you need to synchronize the project. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Creation of necessary classes (files). </font><font style="vertical-align: inherit;">When working with the library, only 4 classes are used: MyDeclareScreens - all screens are described; </font><font style="vertical-align: inherit;">MyParams - set the necessary parameters for the application; </font><font style="vertical-align: inherit;">MyApp - the DePro library is initiated; </font><font style="vertical-align: inherit;">MainActivity - starting activity. </font><font style="vertical-align: inherit;">You can use your own class names. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create the class MyDeclareScreens.java. </font><font style="vertical-align: inherit;">Its contents are as follows:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyDeclareScreens</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DeclareScreens</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> String<font></font>
            MAIN = <span class="hljs-string">"main"</span>, DRAWER = <span class="hljs-string">"DRAWER"</span>, CATALOG = <span class="hljs-string">"CATALOG"</span>,<font></font>
            DESCRIPT = <span class="hljs-string">"DESCRIPT"</span>, CHARACTERISTIC = <span class="hljs-string">"CHARACTERISTIC"</span>,<font></font>
            PRODUCT_LIST = <span class="hljs-string">"PRODUCT_LIST"</span>, PRODUCT_DESCRIPT = <span class="hljs-string">"PRODUCT_DESCRIPT"</span>,<font></font>
            FITNESS = <span class="hljs-string">"FITNESS"</span>;<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">declare</span><span class="hljs-params">()</span> </span>{<font></font>
        activity(MAIN, R.layout.activity_main)<font></font>
                .navigator(finishDialog(R.string.attention, R.string.finishOk))<font></font>
                .drawer(R.id.drawer, R.id.content_frame, R.id.left_drawer, <span class="hljs-keyword">null</span>, DRAWER);<font></font>
<font></font>
        fragment(DRAWER, R.layout.fragment_drawer)<font></font>
                .menu(model(menu), view(R.id.recycler));<font></font>
<font></font>
        fragment(CATALOG, R.layout.fragment_catalog)<font></font>
                .navigator(handler(R.id.back, VH.OPEN_DRAWER))<font></font>
                .component(TC.RECYCLER_HORIZONTAL, model(Api.NEWS_PROD).pagination().progress(R.id.progr),<font></font>
                        view(R.id.recycler_news, R.layout.item_news_prod),<font></font>
                        navigator(start(PRODUCT_DESCRIPT)))<font></font>
                .component(TC.RECYCLER, model(Api.CATALOG),<font></font>
                        view(R.id.recycler, <span class="hljs-string">"expandedLevel"</span>, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]{R.layout.item_catalog_type_1,<font></font>
                                R.layout.item_catalog_type_2, R.layout.item_catalog_type_3})<font></font>
                                .expanded(R.id.expand, R.id.expand, model(Api.CATALOG_EX, <span class="hljs-string">"catalog_id"</span>)),<font></font>
                        navigator(start(PRODUCT_LIST)));<font></font>
<font></font>
        activity(PRODUCT_LIST, R.layout.activity_product_list, <span class="hljs-string">"%1$s"</span>, <span class="hljs-string">"catalog_name"</span>).animate(AS.RL)<font></font>
                .navigator(back(R.id.back))<font></font>
                .component(TC.RECYCLER, model(Api.PRODUCT_LIST, <span class="hljs-string">"expandedLevel,catalog_id"</span>),<font></font>
                        view(R.id.recycler, R.layout.item_product_list)<font></font>
                                .visibilityManager(visibility(R.id.bonus_i, <span class="hljs-string">"bonus"</span>),<font></font>
                                        visibility(R.id.gift_i, <span class="hljs-string">"gift"</span>),<font></font>
                                        visibility(R.id.newT, <span class="hljs-string">"new_product"</span>)),<font></font>
                        navigator(start(PRODUCT_DESCRIPT)));<font></font>
<font></font>
        activity(PRODUCT_DESCRIPT, R.layout.activity_product_descript, <span class="hljs-string">"%1$s"</span>, <span class="hljs-string">"catalog_name"</span>).animate(AS.RL)<font></font>
                .navigator(back(R.id.back))<font></font>
                .setValue(item(R.id.product_name, TS.PARAM, <span class="hljs-string">"product_name"</span>))<font></font>
                .component(TC.PAGER_F, view(R.id.pager, DESCRIPT, CHARACTERISTIC)<font></font>
                        .setTab(R.id.tabs, R.array.descript_tab_name));<font></font>
<font></font>
        fragment(DESCRIPT, R.layout.fragment_descript)<font></font>
                .component(TC.PANEL, model(Api.PRODUCT_ID, <span class="hljs-string">"product_id"</span>),<font></font>
                        view(R.id.panel).visibilityManager(visibility(R.id.bonus, <span class="hljs-string">"bonus"</span>)))<font></font>
                .component(TC.RECYCLER, model(Api.ANALOG_ID_PRODUCT,<span class="hljs-string">"product_id"</span>),<font></font>
                        view(R.id.recycler, R.layout.item_product_list).noDataView(R.id.not_analog)<font></font>
                                .visibilityManager(visibility(R.id.bonus_i, <span class="hljs-string">"bonus"</span>),<font></font>
                                        visibility(R.id.gift_i, <span class="hljs-string">"gift"</span>),<font></font>
                                        visibility(R.id.newT, <span class="hljs-string">"new_product"</span>)),<font></font>
                        navigator(start(<span class="hljs-number">0</span>, PRODUCT_DESCRIPT, PS.RECORD),<font></font>
                                handler(<span class="hljs-number">0</span>, VH.BACK))) ;<font></font>
<font></font>
        fragment(CHARACTERISTIC, R.layout.fragment_characteristic)<font></font>
                .component(TC.RECYCLER, model(Api.CHARACT_ID_PRODUCT, <span class="hljs-string">"product_id"</span>),<font></font>
                        view(R.id.recycler, <span class="hljs-string">"2"</span>, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[] {R.layout.item_property, R.layout.item_property_1}));<font></font>
<font></font>
        fragment(FITNESS, R.layout.fragment_fitness)<font></font>
                .navigator(handler(R.id.back, VH.OPEN_DRAWER))<font></font>
                .component(TC.SPINNER, model(JSON, getString(R.string.clubs)),<font></font>
                        view(R.id.spinner, R.layout.item_spin_drop, R.layout.item_spin_hider))<font></font>
                .component(TC.RECYCLER, model(Api.FITNESS, <span class="hljs-string">"clubId"</span>),<font></font>
                        view(R.id.recycler, R.layout.item_fitness), <span class="hljs-keyword">null</span>).eventFrom(R.id.spinner);<font></font>
    }<font></font>
<font></font>
    Menu menu = <span class="hljs-keyword">new</span> Menu()<font></font>
            .item(R.drawable.list, R.string.m_catalog, CATALOG, <span class="hljs-keyword">true</span>)<font></font>
            .divider()<font></font>
            .item(R.drawable.ic_aura, R.string.fitness, FITNESS);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will later describe all the DePro constructions used. </font><font style="vertical-align: inherit;">To connect the import, use the alt + enter keys. </font><font style="vertical-align: inherit;">Red will also be highlighted Api class in which the addresses for all requests are set. </font><font style="vertical-align: inherit;">Its contents will be given later. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create the class MyParams.java. </font><font style="vertical-align: inherit;">In most cases, default settings are sufficient. </font><font style="vertical-align: inherit;">In our case, we will set only the base URL.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyParams</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppParams</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setParams</span><span class="hljs-params">()</span> </span>{<font></font>
        baseUrl = <span class="hljs-string">"https://deprosystem.com/"</span>;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Change the content created by the studio of the MainActivity class to the following:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseActivity</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getNameScreen</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> MyDeclareScreens.MAIN;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the manifest for MainActivity, you can specify portrait orientation. </font><font style="vertical-align: inherit;">In principle, the library supports screen rotation, but in this version for screens of the activity () type, apart from the start, portrait orientation is also prescribed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create the MyApp class:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Application</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> MyApp instance;
    <span class="hljs-keyword">private</span> Context context;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> MyApp <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-keyword">null</span>) {<font></font>
            instance = <span class="hljs-keyword">new</span> MyApp();<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> instance;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">super</span>.onCreate();<font></font>
        instance = <span class="hljs-keyword">this</span>;<font></font>
        context = getApplicationContext();<font></font>
<font></font>
        DeclareParam.build(context)<font></font>
                .setAppParams(<span class="hljs-keyword">new</span> MyParams())<font></font>
                .setDeclareScreens(<span class="hljs-keyword">new</span> MyDeclareScreens());<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is a regular singleton in the onCreate method of which MyParams and MyDeclareScreens are set. </font></font><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remember to describe MyApp in the manifest.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
To finish, create the Api class:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Api</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String CATALOG = <span class="hljs-string">"depro/cron/catalog"</span>,<font></font>
            NEWS_PROD = <span class="hljs-string">"depro/cron/news_prod"</span>,<font></font>
            PRODUCT_LIST = <span class="hljs-string">"depro/cron/product_list"</span>,<font></font>
            PRODUCT_ID = <span class="hljs-string">"depro/cron/product_id"</span>,<font></font>
            ANALOG_ID_PRODUCT = <span class="hljs-string">"depro/cron/product_analog"</span>,<font></font>
            CHARACT_ID_PRODUCT = <span class="hljs-string">"depro/cron/product_charact"</span>,<font></font>
            FITNESS = <span class="hljs-string">"depro/cron/fitness"</span>,<font></font>
            CATALOG_EX = <span class="hljs-string">"depro/cron/catalog_ex"</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Now you can run the application for execution. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If everything is entered correctly, then when the application starts, all specified screens will be displayed (and work). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As we see, we have only five simple classes for the entire application. And four of them are auxiliary. Their contents are independent of the number of screens. The description, generally not trivial, of the screens also takes up a bit of space (less than 80 lines). Now we show that the description is not only not large, but also not complicated. To do this, we describe the operation of the used library components. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As indicated in the first article, screens in the library can be either activity or fragment, which sets the screen name (line) and layout. Links to screens are made by their names. The choice of which type of screen to use is carried out in the usual way.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAIN screen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So, from the design it can be seen that the start screen has a side menu and a container for fragments. In the markup of R.layout.activity_main, a standard DrawerLayout is set. Therefore, in the description of the MAIN screen, we specify the drawer component, to which we pass the id of the DrawerLayout itself and its containers for the sidebar and fragments. We also indicate the name of the screen (DRAWER), which will be displayed in the sidebar. The finishDialog navigator indicates that before exiting the application you need to issue a confirmation dialog. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DRAWER screen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Contains only one menu component with a menu type variable specified in the model, and a RecyclerView type markup element in the id view, which will display the menu. The menu itself indicates that the ‚ÄúCATALOG‚Äù menu item will be displayed in the fragments container when the menu starts.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CATALOG screen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Contains one horizontal New List. When receiving data from the server, his model uses pagination, and displays the progress in R.id.progr. If your Internet is fast, then you may not notice the appearance of a panel with progress. If you want to watch it, you can switch to a slower Internet, or change the background color of R.id.progr. In this case, you will at least see it blinking. For pagination, the parameters specified in AppParams by default are used. The view is given R.id.recycler_news with a RecyclerView and layout for items. When you click on any item in the list, the PRODUCT_DESCRIPT screen starts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Directory list is a drop down. The disclosure level is defined in the "expandedLevel" field. If it is not transmitted with the source data, the library itself will deal with this. The same parameter sets which layout from the list to use at each level of disclosure. The fact that the list is drop-down serves the expanded (...) functionality. The model will be set in the cator to receive data from the server for the next levels. The model specifies the address of the Api.CATALOG_EX request and the name of the request parameter ‚Äúcatalog_id‚Äù. In expanded, R.id.expand is also indicated - a markup element in items by clicking on which the list will be expanded and the id of the element that will be animatedly rotated by 180 degrees when expanding - closing the list. And finally, the navigator indicatesthat when you click on the list item, the PRODUCT_LIST screen will be called up.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The navigator, which refers to the entire screen, indicates that when you click on the R.id.back element, a side panel will open. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PRODUCT_LIST screen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
When specifying a screen, it is indicated that the current value of the catalog_name parameter will be shown in the header and the output animation will be from right to left (AS.RL). The list description is already familiar to us. The only thing for the presentation is the visibilityManager, which controls the visibility of the markup elements depending on the values ‚Äã‚Äãof the corresponding data. The navigator related to the entire screen indicates that when you click on the R.id.back element, you will be returned to the previous screen. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PRODUCT_DESCRIPT screen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
New to us is a component of type PAGER_F. It is associated with a regular ViewPager. He is shown a list of screens (fragments) to be displayed, and TabLayout (setTab) is connected. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The PRODUCT_DESCRIPT screen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appears in the DESCRIPTION tab. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A component of the PANEL type displays data obtained by the model. The ‚ÄúAnalogs‚Äù list displays a list of similar products, if any, or using the noDataView () functionality, the message ‚ÄúAnalogs are missing‚Äù. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CHARACTERISTIC screen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Displays a list of product features. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FITNESS screen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A component of type SPINNER displays a list of clubs with the option to select one. The list of clubs is set in the model as a json string.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The list of categories of classes is normal. </font><font style="vertical-align: inherit;">The eventFrom (...) functional indicates that when changing the component associated with R.id.spinner (in our case, the spiner), it is necessary to update the data. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code of the application discussed in the article can be viewed on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The article is for guidance only. </font><font style="vertical-align: inherit;">More fully with the capabilities of the DePro library is available in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en502008/index.html">Programming to the masses</a></li>
<li><a href="../en502012/index.html">Azure for Everyone: Introductory Course</a></li>
<li><a href="../en502014/index.html">Your employer: celebrate Freelancer Day</a></li>
<li><a href="../en502018/index.html">Podcast on the security of mobile devices and the development of protective solutions for them</a></li>
<li><a href="../en502020/index.html">RoadHunters.io - brings motorcyclists around the world</a></li>
<li><a href="../en502028/index.html">Vanya goes to grandmother or dynamic JavaScript adaptive</a></li>
<li><a href="../en502030/index.html">Web Services in Oracle</a></li>
<li><a href="../en502034/index.html">Controlled and uncontrolled components in React don't have to be complicated</a></li>
<li><a href="../en502038/index.html">Raising an atom, approach 2.0.1</a></li>
<li><a href="../en502040/index.html">About Phrasal Verbs-5 (up / down)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>