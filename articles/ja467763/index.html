<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏿 🌗 🐞 RTOSに関する真実。記事＃33。Nucleus SEリアルタイムオペレーティングシステムの使用 🌼 💆🏿 🚠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="これまでのこのシリーズの記事では、Nucleus SEが提供する機能について見てきました。それでは、実際のファームウェアアプリケーションでどのように使用できるかを見てみましょう。
 
 
 
 シリーズの以前の記事： #32. Nucleus SE: 
  #31. 
  #30. Nucleus ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>RTOSに関する真実。記事＃33。Nucleus SEリアルタイムオペレーティングシステムの使用</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467763/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これまでのこのシリーズの記事では、Nucleus SEが提供する機能について見てきました。</font><font style="vertical-align: inherit;">それでは、実際のファームウェアアプリケーションでどのように使用できるかを見てみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8y/ch/3t/8ych3tyabi2vdvohugo65t3uekk.png"><br>
<a name="habracut"></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シリーズの以前の記事：</font></font></b><div class="spoiler_text"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #32.  Nucleus SE:    </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #31.     </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #30.     Nucleus SE</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #29.   Nucleus SE</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #28.  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #27.  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #26. :     </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #25.   :    </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #24. :     </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #23. :    </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #22.  :     </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #21.  :    </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #20. :     </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #19. :    </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #18.   :     </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #17.   :    </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #16. </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #15.  :    </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #14.  :    </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #13.       API</a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #12.     </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #11. :     API</a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #10. :     </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #9. : </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #8. Nucleus SE:    </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #7. Nucleus SE: </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #6.   </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #5.     </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #4. ,    </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #3.   </a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> #2. :     <br>
 #1. : . </a> <br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nucleus SEとは何ですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEはリアルタイムオペレーティングシステムの中核であることはわかっていますが、それが他のアプリケーションにどのように適合するかを理解する必要があります。また、デスクトップオペレーティングシステム（Windowsなど）とは異なり、アプリケーションはNucleus SEで起動しないので、ぴったりです。カーネルは、組み込みデバイスで実行されるプログラムの一部です。これは、RTOSの最も一般的な使用例です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
高レベルの観点から見ると、組み込みアプリケーションは、CPUの起動時に開始されるある種のコードです。この場合、ハードウェアおよびソフトウェア環境が初期化され、次に</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数が呼び出されて</font><font style="vertical-align: inherit;">、メインアプリケーションコードが起動されます。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SE（および他の多くの同様のコア）を使用する場合の違いは、</font><b><font style="vertical-align: inherit;">main（）</font></b><font style="vertical-align: inherit;">関数が</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネルコードの一部です。この関数は、単純にカーネルのデータ構造を初期化してから、スケジューラーを呼び出します。これにより、アプリケーションコード（タスク）が起動します。ユーザーは、</font><font style="vertical-align: inherit;">任意のネイティブ初期化コード</font><font style="vertical-align: inherit;">を</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数に追加</font><font style="vertical-align: inherit;">でき</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEには一連の関数も含まれています-アプリケーションプログラミングインターフェース（API）で、通信やタスクの同期、タイマーの操作、メモリ割り当てなどの一連の関数を提供します。すべてのAPI関数は、このシリーズの記事の前半で説明されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのNucleus SEソフトウェアはソースコードとして提供されます（主にC）。特定のアプリケーションの要件に従ってコードを構成するには、条件付きコンパイルを使用します。これについては、この記事の「構成」セクションで詳しく説明しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードがコンパイルされた後、結果として得られるNucleus SEオブジェクトモジュールはアプリケーションコードモジュールに関連付けられ、単一のバイナリイメージが生成されます。これは通常、組み込みデバイスのフラッシュメモリに配置されます。</font><font style="vertical-align: inherit;">この静的バインディングの結果、すべてのシンボリック情報は、アプリケーションコードとカーネルコードの両方からアクセス可能なままになります。</font><font style="vertical-align: inherit;">これはデバッグに役立ちますが、Nucleus SEデータの誤用を避けるために注意が必要です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPUとツールのサポート</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEはソースコードとして提供されるため、移植可能でなければなりません。</font><font style="vertical-align: inherit;">ただし、このような低レベルで実行されるコード（コンテキストの切り替えが必要なスケジューラーを使用する場合、つまり、「実行して完了」以外のもの）は、アセンブリ言語から完全に独立することはできません。</font><font style="vertical-align: inherit;">この依存関係を最小限に抑え、新しいCPUへの移植に低レベルのプログラミングはほとんど必要ありません。</font><font style="vertical-align: inherit;">新しい開発ツールのセット（コンパイラー、アセンブラー、リンカーなど）を使用すると、移植の問題が発生する可能性もあります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nucleus SEアプリのセットアップ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEを効果的に使用するための鍵は、適切なセットアップです。</font><font style="vertical-align: inherit;">複雑に見えるかもしれませんが、実際にはすべてが非常に論理的であり、体系的なアプローチのみが必要です。</font><font style="vertical-align: inherit;">ほとんどすべての構成は、2つのファイル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuse_config.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuse_config.cを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">編集することによって行われます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuse_config.h設定</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このファイルは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブの単なる文字セットであり</font><font style="vertical-align: inherit;">、必要なカーネル構成を取得するために適切な値が割り当てられています。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuse_config.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><b><font style="vertical-align: inherit;">では</font></b><font style="vertical-align: inherit;">、デフォルトですべての文字が存在しますが、最小の設定が割り当てられています。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトカウンター</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
各タイプのカーネルオブジェクト</font><b><i><font style="vertical-align: inherit;">の</font></i></b><font style="vertical-align: inherit;">数は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_SEMAPHORE_NUMBER</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">形式のシンボル値によって設定されます</font><font style="vertical-align: inherit;">。ほとんどのオブジェクトでは、この値は0〜15の範囲で変動します。タスクは例外であり、少なくとも1つは存在する必要があります。実際、シグナルはタスクに関連付けられており、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_SIGNAL_SUPPOR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tを</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUEに</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">設定</font></b><font style="vertical-align: inherit;">することで</font><b><font style="vertical-align: inherit;">オンになる</font></b><font style="vertical-align: inherit;">ため、独立したオブジェクトではありません</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API関数アクティベーター</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各Nucleus SE API関数は、名前が関数名と一致するシンボル（たとえば、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_PIPE_JAM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUEに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">割り当てることにより、個別にアクティブ化できます</font><font style="vertical-align: inherit;">。これにより、アプリケーションに関数コードが含まれます。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スケジューラの選択と構成</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nucleus SEは、前の記事で説明したように、4種類のスケジューラをサポートしています。使用スケジューラを割り当てることによって設定されている</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にNUSE_SCHEDULER_TYPEを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のいずれかの値</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_RUN_TO_COMPLETION_SCHEDULER</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_TIME_SLICE_SCHEDULER</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_ROUND_ROBIN_SCHEDULER</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">又は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_PRIORITY_SCHEDULER</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その他のスケジューラパラメータも構成できます</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。NUSE_TIME_SLICE_TICKS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、タイムスライススケジューラのスロットあたりのティック数を示します。別のスケジューラーを使用する場合は、このパラメーターを0に設定する必要があります</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。NUSE_SCHEDULE_COUNT_SUPPORT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FALSE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">設定して</font><font style="vertical-align: inherit;">、スケジューラーカウンターメカニズムを有効または無効にでき</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_SUSPEND_ENABLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、多くのAPI関数のタスクロック（一時停止）を有効にします。つまり、そのような関数を呼び出すと、リソースが解放されるまで呼び出しタスクが一時停止する可能性があります。このオプションを選択するには、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_SUSPEND_ENABLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に設定する</font><b><font style="vertical-align: inherit;">必要が</font></b><font style="vertical-align: inherit;">あります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その他のパラメーターその他の</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
いくつかのパラメーターを</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TRUE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FALSE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">設定して、</font><font style="vertical-align: inherit;">他のカーネル関数をアクティブ化/非アクティブ化</font><font style="vertical-align: inherit;">することもでき</font><b><font style="vertical-align: inherit;">ます</font></b></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。NUSE_API_PARAMETER_CHECKING</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、API関数を呼び出すパラメーターをチェックするコードを追加します。一般的にデバッグに使用されます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NUSE_INITIAL_TASK_STATE_SUPPORT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、すべてのタスクの初期状態を</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NUSE_READY</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NUSE_PURE_SUSPEND</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として</font><b><font style="vertical-align: inherit;">設定し</font></b><font style="vertical-align: inherit;">ます。このオプションを無効にすると、すべてのタスクの初期状態は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NUSE_READYになり</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NUSE_SYSTEM_TIME_SUPPORT-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システム時間のサポート。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NUSE_INCLUDE_EVERYTHING</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Nucleus SEの設定に最大数の機能を追加するパラメータ。</font><font style="vertical-align: inherit;">これにより、すべてのオプション機能と、構成されたオブジェクトの各API関数がアクティブになります。</font><font style="vertical-align: inherit;">カーネルコードの新しい移植を検証するためにNucleus SE構成をすばやく作成するために使用されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuse_config.cの構成</font></font></h3><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuse_config.hで</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
カーネル構成を指定した後</font><font style="vertical-align: inherit;">、ROMに格納されているさまざまなデータ構造を初期化する必要があります。これは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuse_config.c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルで行われます</font><font style="vertical-align: inherit;">。データ構造の定義は条件付きコンパイルによって制御されるため、すべての構造は</font><font style="vertical-align: inherit;">デフォルトの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuse_config.c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルのコピー</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">含まれています</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクデータ</font></font></i></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;"> NUSE_Task_Start_Address []</font></b></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
配列</font><font style="vertical-align: inherit;">は、各タスクの開始アドレスの値で初期化する必要があります。これは通常、括弧なしの単なる関数名のリストです。タスクエントリ関数のプロトタイプも表示されます。デフォルトのファイルでは、タスクは</font><b><font style="vertical-align: inherit;">NUSE_Idle_Task（）</font></b><font style="vertical-align: inherit;">という名前で構成</font><font style="vertical-align: inherit;">されています。これはアプリケーションタスクに変更できます。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run to Completion以外のスケジューラーを使用する場合、各タスクには独自のスタックが必要です。タスクスタックごとに、RAMに配列を作成する必要があります。これらの配列は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADDR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型</font><font style="vertical-align: inherit;">である必要があり、それぞれのアドレスは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Task_Stack_Base []に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">格納されている必要があります</font><font style="vertical-align: inherit;">。配列のサイズを予測することは難しいため、測定値を使用することをお勧めします（この記事の「デバッグ」セクションを参照してください）。各配列のサイズ（つまり、スタック上のワード数）は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Task_Stack_Size []に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">格納する必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タスクの初期状態を示す機能が有効になっている場合（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_INITIAL_TASK_STATE_SUPPORT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーターを使用</font><font style="vertical-align: inherit;">）、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Task_Initial_State []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列を</font><font style="vertical-align: inherit;">状態で初期化する必要があります</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_READYまたはNUSE_PURE_SUSPEND</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーティション・プール・データ</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
少なくとも1つのパーティション・プールが構成されている場合は</font><font style="vertical-align: inherit;">、ROMに</font><font style="vertical-align: inherit;">それぞれのアレイ（タイプ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を</font><font style="vertical-align: inherit;">作成する必要があります</font><font style="vertical-align: inherit;">。これらの配列のサイズは次のように計算されます：（パーティションの数*（パーティションサイズ+ 1））。これらのセクションのアドレス（つまり、セクションの名前）は、対応する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Partition_Pool_Data_Address []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素に割り当てる必要があります</font><font style="vertical-align: inherit;">。各プールについて、パーティションの数とサイズは</font><font style="vertical-align: inherit;">それぞれ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Partition_Pool_Partition_Number []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Partition_Message_Size []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">配置する必要が</font><font style="vertical-align: inherit;">あります。</font></font><br>
 <br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キューデータ</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
少なくとも1つの</font><b><i><font style="vertical-align: inherit;">キュー</font></i></b><font style="vertical-align: inherit;">が構成されている場合は、</font><b><i><font style="vertical-align: inherit;">キュー</font></i></b><font style="vertical-align: inherit;">ごとに配列を作成する必要があります（タイプ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADDR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）RAM内。これらの配列のサイズは、各キュー内の要素の数です。これらの配列のアドレス（つまり、それらの名前）は、対応する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Queue_Data []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素に割り当てる必要があります</font><font style="vertical-align: inherit;">。各キューのサイズは、対応する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Queue_Size []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素に割り当てる必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ伝送チャネルのデータ</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
少なくとも1つのデータ伝送チャネルが構成されている場合は、そのアレイ（または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプ</font><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">アレイ</font><font style="vertical-align: inherit;">をRAMに</font><font style="vertical-align: inherit;">作成する必要があります（または</font><b><font style="vertical-align: inherit;">U8</font></b><font style="vertical-align: inherit;">ごとに</font><font style="vertical-align: inherit;">）。これらの配列のサイズは次のように計算されます：（チャネルサイズ*チャネルのメッセージサイズ）。これらの配列のアドレス（つまり、それらの名前）は、対応する</font><b><font style="vertical-align: inherit;">NUSE_Pipe_Data []</font></b><font style="vertical-align: inherit;">要素に割り当てる必要があります</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。チャネルごとに、そのメッセージのサイズとサイズが対応に割り当てなければならない</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Pipe_Size []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Pipe_Message_Size []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の要素</font><font style="vertical-align: inherit;">をそれぞれ、。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セマフォデータ</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
少なくとも1つのセマフォが設定されている場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Semaphore_Initial_Value []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列</font><font style="vertical-align: inherit;">は、カウントダウンの初期値で初期化する必要があります。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
タイマー</font><b><i><font style="vertical-align: inherit;">データ</font></i></b><font style="vertical-align: inherit;">少なくとも1つのタイマーが構成されている場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Timer_Initial_Time []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列を</font><font style="vertical-align: inherit;">カウンターの初期値で初期化する必要があります。さらに、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Timer_Reschedule_Time []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再起動値を割り当てる必要があります。</font><font style="vertical-align: inherit;">これらのタイマー値は、最初のタイマーサイクルの終了後に使用されます。</font><font style="vertical-align: inherit;">再起動値が0に設定されている場合、カウンターは1サイクル後に停止します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カウントメカニズムの完了をサポートするように構成されている場合（Pr </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_TIMER_EXPIRATION_ROUTINE_SUPPORT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、さらに2つの配列を作成する必要があります。</font><font style="vertical-align: inherit;">補完メカニズムのアドレス（括弧なしの関数名のリストのみ）は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Timer_Expiration_Routine_Address []に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置する必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">配列</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Timer_Expiration_Routine_Parameter []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、完了パラメーターの値で初期化する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どのAPIですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何らかの形のすべてのオペレーティングシステムには、API（アプリケーションプログラミングインターフェイス）があります。 Nucleus SEも例外ではなく、APIを構成する関数については、この一連の記事で詳しく説明しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEを使用してアプリケーションを作成するときは、前の記事で説明したようにAPIを使用する必要があることは明らかだと思われるかもしれません。ただし、これは常に当てはまるわけではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのユーザーにとって、Nucleus SE APIは、おそらくオペレーティングシステムAPIを使用した最初の経験でさえ、何か新しいものになります。そして、それは非常にシンプルなので、それはトピックへの良い導入として役立ちます。この場合、手順は明確です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のユーザーにとっては、代替のAPIがより魅力的なオプションになる場合があります。これが可能な状況は3つあります。</font></font><br>
<ol>
<li> Nucleus SE    ,         .   , ,   ,        .</li>
<li>     API   .      .</li>
<li>    ,   API   .   API ,    .</li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEの完全なソースコードは誰でも利用できるので、各API関数を編集して他のオペレーティングシステムと同等に見えるようにするために何も妨げられることはありません。ただし、時間がかかり、非常に非生産的です。より適切なアプローチは、「ラッパー」を作成することです。これを行う方法はいくつかありますが、最も簡単な方法は、</font><font style="vertical-align: inherit;">サードパーティのAPI関数をNucleus SE API関数にマップ</font><font style="vertical-align: inherit;">する一連の</font><b><font style="vertical-align: inherit;">#define</font></b><font style="vertical-align: inherit;">マクロ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">含む</font><font style="vertical-align: inherit;">ヘッダーファイル（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を</font><font style="vertical-align: inherit;">作成する</font><font style="vertical-align: inherit;">ことです。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus RTOS APIの機能を（部分的に）Nucleus SEに転送するラッパーは、Nucleus SEとともに配布されます。</font><font style="vertical-align: inherit;">Nucleus RTOSの使用経験がある開発者や、将来的にはこのRTOSへの移行が可能になる開発者にとって役立つ場合があります。</font><font style="vertical-align: inherit;">このラッパーは、同様のものを開発する際の例としても役立ちます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nucleus SEアプリケーションのデバッグ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルチタスクカーネルを使用して組み込みアプリケーションを作成することは困難な作業です。コードが機能することを確認し、エラーを検出することは困難な作業です。これはプロセッサ上で実行される単なるコードであるという事実にもかかわらず、複数のタスクを同時に実行すると、特定の実行スレッドに集中することが非常に難しくなります。複数のタスクが共通のコードを共有する場合、これはさらに複雑になります。最悪の場合、2つのタスクのコードがまったく同じです（ただし、異なるデータを処理します）。カーネルオブジェクトを実装して意味のある情報を表示するために使用されるデータ構造を解明することも、複雑さを増します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEで構築されたアプリケーションをデバッグするために、追加のライブラリやその他のサービスは必要ありません。</font><font style="vertical-align: inherit;">すべてのカーネルコードはデバッガーによって読み取り可能です。</font><font style="vertical-align: inherit;">したがって、すべてのシンボリック情報は調査に利用できます。</font><font style="vertical-align: inherit;">Nucleus SEアプリケーションを使用する場合、最新のデバッグツールを使用できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッガーの使用</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
組み込みシステム用に特別に設計されたデバッグツールは、存在してから30年で非常に強力になりました。組み込みアプリケーションの主な特徴は、デスクトッププログラムと比較して、すべての組み込みシステムが異なる（そしてすべてのパーソナルコンピューターが互いに非常に似ている）ことです。優れた組み込みデバッガは、柔軟性があり、さまざまな組み込みシステムやユーザーの要件に対応できる十分な設定が必要です。デバッガのカスタマイズ性はさまざまな形式で表現されますが、通常はスクリプトを作成する可能性があります。デバッガーがカーネルレベルのアプリケーションでうまく機能できるようにするのは、この機能です。以下では、デバッガを使用するいくつかのケースについて説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、デバッガは1つのプログラムではなく、ツールのファミリであることに注意してください。</font><font style="vertical-align: inherit;">デバッガーにはさまざまな操作モードがあり、仮想システムまたは実際のハードウェアでコードを開発するときに役立ちます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク依存のブレークポイント</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムに複数のタスクに共通のコードがある場合、デバッグ中の通常のブレークポイントの使用は複雑になります。ほとんどの場合、現在デバッグしている特定のタスクのコンテキストでブレークポイントに達したときにのみコードを停止する必要があります。これを行うには、タスクを考慮に入れるブレークポイントが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さいわい、最新のデバッガーでスクリプトを作成できることと、Nucleus SEの文字データを利用できることにより、タスク固有のブレークポイントを実装するのは非常に簡単です。必要なのは、タスクを区別するために教えたいブレークポイントに関連付けられる簡単なスクリプトを書くことだけです。このスクリプトは、興味のあるタスクのパラメーター（インデックス（ID））を取ります。スクリプトは、この値を現在のタスクのインデックスと単に比較します（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Task_Active</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">値が一致する場合、プログラムの実行は一時停止されます。</font><font style="vertical-align: inherit;">それらが異なる場合、実行は続行されます。</font><font style="vertical-align: inherit;">このスクリプトの実行がリアルタイムでのアプリケーションの実行に影響することは注目に値します（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻訳者注：これは、プログラムの実行が通常の操作に比べて遅くなることを意味します</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">ただし、スクリプトが非常に頻繁に実行されるループ内にない場合、この影響は最小限になります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネルオブジェクト情報</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEアプリケーションをデバッグするための明らかな必要性は、カーネルオブジェクトに関する情報を取得する機能です。それらの特性と現在のステータスは何ですか。これにより、次のような質問に対する回答を得ることができます。「このキューの期間と現在のキューの数は？」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、「情報」API呼び出し（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Queue_Information</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を使用するアプリケーションにデバッグコードを追加することで使用できます</font><font style="vertical-align: inherit;">。もちろん、これはアプリケーションに追加のコードが含まれていることを意味します。アプリケーションの実装後は必要ありません。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">して条件付きコンパイルを使用してこのコードをオンまたはオフにすることは、論理的な決定です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のデバッガーは、対象を絞った関数呼び出しを行うことができます。つまり、API関数を直接呼び出して情報を取得します。</font><font style="vertical-align: inherit;">これにより、追加のコードは不要になりますが、デバッガーがこのコードを使用できるように、このAPI関数を構成する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
代替の、より柔軟性がありますが、「非エージング」ではないアプローチは、カーネルオブジェクトのデータ構造への直接アクセスです。</font><font style="vertical-align: inherit;">ほとんどの場合、デバッガスクリプトを使用してこれを行うのが最善です。</font><font style="vertical-align: inherit;">この例では、キューのサイズは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Queue_Size []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から取得でき</font><font style="vertical-align: inherit;">、現在の使用量は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Queue_Data []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><font style="vertical-align: inherit;">取得できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">さらに、キュー内のメッセージは、キューデータ領域のアドレスを使用して表示できます（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_Queue_Data []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API呼び出しの戻り値</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くのAPI関数は、呼び出しがどれだけ正常に完了したかを示すステータス値を返します。これらの値を追跡し、それらが</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_SUCCESS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と等しくない</font><font style="vertical-align: inherit;">（つまり、値がゼロである）</font><font style="vertical-align: inherit;">場合にフラグを</font><b><font style="vertical-align: inherit;">付ける</font></b><font style="vertical-align: inherit;">と</font><b><font style="vertical-align: inherit;">便利</font></b><font style="vertical-align: inherit;">です。この追跡はデバッグ専用であるため、条件付きコンパイルは非常に適切です。グローバル変数（たとえば、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_API_Call_Status</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">の定義は、</font><font style="vertical-align: inherit;">条件付きでコンパイルできます（#defineディレクティブシンボルの制御下で）。次に、API呼び出しの定義の一部、つまり</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_API_Call_Status =</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も条件付きでコンパイルできます。たとえば、デバッグのために、通常は次のような呼び出しを行います</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。NUSE_Mailbox_Send（mbox、msg、NUSE_SUSPSEND）;</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次の形式になります：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NUSE_API_Call_Status = NUSE_Mailbox_Send（mbox、msg、NUSE_SUSPEND）; </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タスクのブロックがアクティブになっている場合、多くのAPI関数呼び出しは、呼び出しが正常に完了したこと、またはオブジェクトがリセットされたことに関する情報のみを返すことができます。</font><font style="vertical-align: inherit;">ただし、APIパラメータチェックが有効になっている場合、API呼び出しは他の多くの値を返すことができます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクスタックとスタックオーバーフローのサイズの設定</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタックオーバーフロー保護のトピックについては、以前の記事（＃31）で説明しました。デバッグ中に他のいくつかの可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタックのメモリ領域は、特性値で満たすことができます：すべて1またはすべて0以外の何か。その後、デバッガーを使用してメモリ領域と変更される値の量を監視できます。これにより、スタックの充満度を理解できます。すべてのメモリ領域が変更された場合、これはスタックがいっぱいであったことを意味するのではなく、そのサイズがかろうじて十分であることを意味し、これは危険です。テストを増やして継続する必要があります。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">記事31に</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
記載</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、診断を実装する場合、「保護ワード」という追加の領域をスタックメモリ領域の任意のエッジに配置できます。</font><font style="vertical-align: inherit;">デバッガを使用してこれらのワードへのアクセスを追跡できます。これらのワードへの書き込みを試みると、スタックのオーバーフローまたは枯渇が発生するためです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nucleus SE構成チェックリスト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nucleus SEは、アプリケーション要件を満たすように非常に柔軟でカスタマイズ可能なシステムとして設計されているため、かなりの数のカスタマイズ可能なパラメーターが必要です。</font><font style="vertical-align: inherit;">そのため、この記事全体では、実際にはNucleus SEの構成を取り上げています。</font><font style="vertical-align: inherit;">見落としがないように、Nucleus SE組み込みアプリケーションを作成するために実行する必要があるすべての主要なステップのチェックリストを次に示します。</font></font><br>
<ol>
<li><b> Nucleus SE.</b>   ,     Nucleus SE       ,        Nucleus SE     .</li>
<li><b>  CPU/.</b>             .</li>
<li><b>  .</b>     ,       ,    .</li>
<li><b>  .</b>        .       .  ,     .      16 . </li>
<li><b> .</b>     -   <b>main()</b>?</li>
<li><b> .</b>     4 ,       .</li>
<li><b>   </b>,     .</li>
<li><b>    .</b></li>
<li><b>.</b>   ,     .</li>
<li><b> .</b>    ,    .</li>
<li><b>  .</b> ,      .     .  —  16   .</li>
<li><b>  .</b>        ,   .</li>
<li><b>  .</b>        ,    (,      ).</li>
<li><b> API.</b>    API,   .</li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の記事（このシリーズの最後の記事）では、Nucleus SEの全体像をまとめ、Nucleus SE実装の作成とその使用に役立つ情報を提供します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者について：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Colin Wallsはエレクトロニクス業界で30年以上働いており、彼のほとんどの時間をファームウェアに費やしています。</font><font style="vertical-align: inherit;">現在は、Mentor Embedded（Mentor Graphicsの一部門）のファームウェアエンジニアです。</font><font style="vertical-align: inherit;">Colin Wallsは、会議やセミナー、数多くの技術記事の著者、ファームウェアに関する2冊の本で講演することがよくあります。</font><font style="vertical-align: inherit;">イギリス在住。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Colinの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロフェッショナル</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ブログ</font></a><font style="vertical-align: inherit;">、電子メール：colin_walls@mentor.com。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja467751/index.html">ブロックチェーン上の分散型メッセンジャーはどのように</a></li>
<li><a href="../ja467753/index.html">ワイヤレスデータ伝送の世界記録：11キロメートルあたり40 Gb /秒</a></li>
<li><a href="../ja467755/index.html">プリオン、カルシウム、微生物叢、食物ホルモン、アルツハイマー病</a></li>
<li><a href="../ja467759/index.html">UnixライクなOS開発-仮想アドレス空間（6）</a></li>
<li><a href="../ja467761/index.html">エネルギー、熱、水パート3：ラジオに行く</a></li>
<li><a href="../ja467765/index.html">Wi-Fiおよび他の多くの略語。AndroidアプリケーションのWi-Fiノードのデータを取得し、スウェルしない方法</a></li>
<li><a href="../ja467767/index.html">JSON-RPCフォロワーのためのその他のアメニティ</a></li>
<li><a href="../ja467769/index.html">人口情報を含む単一の連邦情報リソース</a></li>
<li><a href="../ja467771/index.html">緑のジュニアのオートリローダーが彼の<s> hot </ s>を書いたように。パート2. CSS</a></li>
<li><a href="../ja467773/index.html">珍しいリソースを調達し、最初の連絡をする</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>