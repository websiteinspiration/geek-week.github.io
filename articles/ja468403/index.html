<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍💻 👩‍✈️ 👸🏾 組み込みのソフトウェアアプリケーションランタイムコントロール 🤞🏻 🧜 🐔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="このパブリケーションは、C / C ++ / C＃で記述されたアプリケーションのランタイムに関するメトリック情報を収集および蓄積するための組み込みツールのソフトウェア実装を示しています。 
 
 記述されたアプローチの本質は、構造コンポーネントの実行時間に関するデータを抽出するためのアプリケーション...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>組み込みのソフトウェアアプリケーションランタイムコントロール</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468403/"><img src="https://habrastorage.org/webt/k1/xf/-b/k1xf-b3txxrnnl3dlfn6htckrmm.jpeg" align="right" width="40%"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このパブリケーションは、C / C ++ / C＃で記述されたアプリケーションのランタイムに関するメトリック情報を収集および蓄積するための組み込みツールのソフトウェア実装を示しています。 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記述されたアプローチの本質は、構造コンポーネントの実行時間に関するデータを抽出するためのアプリケーションのプログラムコードに「コントロールポイント」を含めることに基づいています：メソッド、関数、および{}ブロック。</font><font style="vertical-align: inherit;">抽出されたメトリック情報は内部データベースに蓄積され、アプリケーションの最後にその内容がファイルに保存されたテキストレポート形式に変換されます。</font><font style="vertical-align: inherit;">実行時間の組み込み制御の手段を使用することの適切性は、コードの問題領域を特定し、アプリケーションの一時的な劣化の原因を分析する必要があるためです：完全または部分的、または特定のソースデータのセットに現れます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C ++ / C＃ソースコードの例は、説明されているアプローチの可能な実装を示しています。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
進化的開発の各反復（たとえば、次のリリースのリリース）でのソフトウェアアプリケーションの開発には、次の基本的な手順が含まれます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能の開発とテスト。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAMの消費リソースの最適化。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランタイムメトリックの安定化。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの手順では、クリエイティブ（効果的なアルゴリズムの開発と実装、柔軟なソフトウェアアーキテクチャの構築など）だけでなく、日常的な作業も必要になります。後者のカテゴリには、アプリケーション実行の時間メトリックの安定化を目的としたアクティビティが含まれます。多くの場合、これは、開発者がソフトウェア製品の機能の拡張、ソフトウェアアーキテクチャの再構築、およびアプリケーションでの新しいスレッドの出現の結果である機能低下に直面している場合、かなり苦しい手順です。さらに、劣化の原因はそれらを検出するために特定の努力を必要とします。これは、高い勤勉さと開発者の責任（必要条件）だけでなく、しかし、これらの目的に使用されるツールの構成（十分な条件）も含みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーション時間メトリックの分析の問題を解決する効果的なアプローチの1つは、GNU </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gprof</font></font></b></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの専用のソフトウェア製品を使用することです</font><font style="vertical-align: inherit;">。このようなツールによって生成されたレポートの分析により、アプリケーション全体の実行に費やされたかなりの時間を占める「ボトルネック」（クラスのメソッドと関数）を特定できます。同時に、メソッドとプロシージャの実行に費やされた時間の妥当性は、開発者によって確かに認定されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、このクラスのソフトウェア製品は、原則として、クラスと関数のメソッドのレベルでプログラムコードの実行時間のメトリック分析を実行し、低いレベル（ただし、問題の分析の観点からは重要）を無視することにも注意してください。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{...}、for、while、do-until、if-else、それ以外の場合はtry-catch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブロック。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、制御されたソフトウェアブロックの時間メトリックに関する詳細情報を抽出して蓄積し、その後開発者向けのレポートを生成することを目的とした、実行時間ツールの組み込み制御の実装のための可能なソリューションの1つの主な内容を検討します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランタイムデータを取得する方法</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソフトウェアアプリケーションの機能は</font><font style="vertical-align: inherit;">、一意の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">状態の</font></a><font style="vertical-align: inherit;">有限セット</font><b><i><font style="vertical-align: inherit;">{St}</font></i></b><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">それらの間の</font><font style="vertical-align: inherit;">遷移</font><b><i><font style="vertical-align: inherit;">{Tr}</font></i></b><font style="vertical-align: inherit;">を持つ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抽象的なマシン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として解釈でき</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">
このアプローチのフレームワークでは、アプリケーションでの実行フローはすべて、その状態の順序付けられたシーケンスとそれらの間の遷移として解釈されます。この場合、実行時間コストの見積もりは、ある状態から別の状態への遷移のコストを無視できる値として無視して、渡された状態のセット全体の時間メトリックを合計することによって実行されます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><b><i><font style="vertical-align: inherit;"></font></i></b><font style="vertical-align: inherit;"></font><b><i><font style="vertical-align: inherit;"></font></i></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指定された制御点でのアプリケーションの実行時間に関するデータの抽出と蓄積は、以下で説明する組み込み制御ツールによって解決される主なタスクです。</font><b><font style="vertical-align: inherit;">PROFILE_ENTRY</font></b><font style="vertical-align: inherit;"> C ++マクロを</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配置することによってソースコードで宣言された各制御点について</font><font style="vertical-align: inherit;">、アプリケーション実行中の通過回数と時間メトリックが記録されます。制御点がプログラム階層の次のレベルに渡された瞬間からアプリケーションがその状態にある合計時間（ブロックを含む） 、クラスメソッド、関数など）。</font><font style="vertical-align: inherit;">
コントロールポイントの制御（初期登録とその時間メトリックの計算）は、</font><b><i><font style="vertical-align: inherit;">「timeManager」</font></i></b><font style="vertical-align: inherit;">オブジェクトによって実行されます</font></font><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><i><font style="vertical-align: inherit;"></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは単一のコピーで作成されます。チェックポイントを渡す各イベントは、オブジェクト</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'timeManager'</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって修正さ</font><font style="vertical-align: inherit;">れ、最初のパス中に、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'registerEntry'</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">としてオブザーバブルとして</font><b><i><font style="vertical-align: inherit;">登録され</font></i></b><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コントロールポイントが通過する</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たび</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に、</font><b><i><font style="vertical-align: inherit;">timerObject</font></i></b><font style="vertical-align: inherit;">オブジェクトが</font><b><i><font style="vertical-align: inherit;">作成され</font></i></b><font style="vertical-align: inherit;">、</font><b><i><font style="vertical-align: inherit;">作成</font></i></b><font style="vertical-align: inherit;">時刻が修正</font><b><i><font style="vertical-align: inherit;">され</font></i></b><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。実行時間は、アプリケーションがソフトウェア階層の現在のレベルを終了するときのチェックポイントに固定されています。この時点で、「破棄時間」Tの計算を伴う自動破棄timerObjectオブジェクトがあります。その結果、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">timeManager</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">チェックポイントを通過してその中に留まる回数が</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「1」に</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">増加します。</font></font><b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。すべての設定された制御点について</font><font style="vertical-align: inherit;">、アプリケーションが終了すると</font><font style="vertical-align: inherit;">、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> timeManager</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はレポートの後続のリリースでデータを蓄積します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eq/ze/7e/eqze7eww_flgezgdi08ncstlz7m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、アプリケーションの実行時間を制御するための組み込みツールを実装するソースC ++コードです。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//    </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;map&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;time.h&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> LONGEST_INT;<font></font>
<font></font>
<span class="hljs-comment">// ,    </span>
<span class="hljs-comment">//     </span>
<span class="hljs-comment">//     </span><font></font>
<font></font>
<span class="hljs-comment">//  ( )   </span>
<span class="hljs-comment">// ()  </span>
<span class="hljs-comment">//   </span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PROFILER_ENABLED </span><font></font>
<font></font>
<span class="hljs-comment">// CREATE_PROFILER  timeManager , </span>
<span class="hljs-comment">//                     </span>
<span class="hljs-comment">//                 ‘main()’ </span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span>  PROFILER_ENABLED</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATE_PROFILER timeManager tManager;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATE_PROFILER <span class="hljs-comment">//   CREATE_PROFILER.</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
<span class="hljs-comment">//INITIALIZE_PROFILER    timeManager </span>
<span class="hljs-comment">//                          </span>
<span class="hljs-comment">//                      ‘main()’</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span>  PROFILER_ENABLED</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INITIALIZE_PROFILER bool timeManager::object = false;\
	                        std::vector<span class="hljs-meta-string">&lt;registerEntry&gt; timeManager::entries;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INITIALIZE_PROFILER <span class="hljs-comment">//   INITIALIZE_PROFILER.</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
<span class="hljs-comment">//DELAY(_SECONDS)   ‘_SECONDS’ . </span>
<span class="hljs-comment">//                   , </span>
<span class="hljs-comment">//                    </span>
<span class="hljs-comment">//                </span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span>  PROFILER_ENABLED</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DELAY(_SECONDS) {clock_t clk_wait=clock()+((double)_ARG)*CLOCKS_PER_SEC;\
	                     while(clock()&lt;clk_wait) {}}</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DELAY(_SECONDS) <span class="hljs-comment">//    DELAY.</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
<span class="hljs-comment">//     ,</span>
<span class="hljs-comment">//     UNIX  WINDOWS</span>
<span class="hljs-comment">//      </span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span>  PROFILER_ENABLED</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MERGE2(x,y) x##y</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MERGE1(_X,_Y) MERGE2(_X,_Y)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> WIN32</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> UNIQUENAME prefix,postfix) MERGE1(prefix,postfix)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> UNIQUENAME(prefix,postfix) MERGE2(prefix,postfix)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GEN_SRC(_ARG1,_ARG2) static int UNIQUENAME(ind,_ARG2)=-1;\
	                     <span class="hljs-meta-keyword">if</span>(UNIQUENAME(ind,_ARG2)&lt;0)\
				UNIQUENAME(ind,_ARG2)=timeManager::add_entry(_ARG1);\
				timeManager::incr_counter(UNIQUENAME(ind,_ARG2));\
				 timerObject UNIQUENAME(tm,_ARG2)(UNIQUENAME(ind,_ARG2));</span><font></font>
<font></font>
<span class="hljs-comment">//PROFILE_ENTRY      </span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span>  PROFILER_ENABLED</span>
   <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> WIN32</span>
   <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PROFILE_ENTRY(_TITLE) GEN_SRC(_TITLE,__COUNTER__)</span>
   <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
   <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PROFILE_ENTRY(_TITLE) GEN_SRC(_TITLE,__LINE__)</span>
   <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PROFILE_ENTRY(_TITLE) <span class="hljs-comment">//    PROFILE_ENTRY.</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
<span class="hljs-comment">//        </span>
<span class="hljs-comment">//   </span>
<span class="hljs-comment">//    ,   timeManager </span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">registerEntry</span>
{</span>
  <span class="hljs-comment">//     (  )</span>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> entry_name;<font></font>
<font></font>
  <span class="hljs-comment">//     </span>
  <span class="hljs-comment">//     </span><font></font>
  LONGEST_INT covers_counter;<font></font>
<font></font>
  <span class="hljs-comment">//      </span>
  <span class="hljs-comment">//     (ticks) </span><font></font>
  LONGEST_INT elapsed_time;<font></font>
   <font></font>
  <span class="hljs-comment">//</span>
  registerEntry(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * title):entry_name(title),<font></font>
	                                covers_counter(<span class="hljs-number">0</span>),<font></font>
					      elapsed_time(<span class="hljs-number">0</span>) {}<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">//    </span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">timerObject</span>
{</span>
   <span class="hljs-comment">//   ,     </span>
   <span class="hljs-keyword">int</span> index;<font></font>
<font></font>
   <span class="hljs-comment">//   </span>
   <span class="hljs-keyword">clock_t</span> start_time;<font></font>
<font></font>
  <span class="hljs-keyword">public</span>:<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    timerObject(<span class="hljs-keyword">int</span> ind):index(ind),start_time(clock()) {}<font></font>
    <font></font>
    <span class="hljs-comment">//    “ ” </span>
    <span class="hljs-comment">//      </span>
    <span class="hljs-comment">//  </span>
    ~timerObject(<span class="hljs-keyword">void</span>)<font></font>
     {<font></font>
	   timeManager::incr_timer(index,(LONGEST_INT)(clock()-start_time));<font></font>
	 }<font></font>
 };<font></font>
<font></font>
<span class="hljs-comment">//    </span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">timeManager</span>
{</span>
  <span class="hljs-keyword">private</span>:<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;registerEntry&gt; entries;<font></font>
<font></font>
    <span class="hljs-comment">// ,     </span>
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> object;<font></font>
<font></font>
  <span class="hljs-keyword">public</span>:<font></font>
<font></font>
    <span class="hljs-comment">//     </span>
    <span class="hljs-comment">//  ,    </span>
    <span class="hljs-comment">//    </span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">add_entry</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * title)</span>
    </span>{<font></font>
	  entries.push_back(registerEntry(title));<font></font>
	  <span class="hljs-keyword">return</span> (((<span class="hljs-keyword">int</span>)entries.size())<span class="hljs-number">-1</span>);<font></font>
    }<font></font>
<font></font>
   <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//     </span>
   <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">incr_counter</span><span class="hljs-params">(<span class="hljs-keyword">int</span> profile_entry_id)</span>
   </span>{<font></font>
     entries[profile_entry_id].covers_counter++;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//  ‘value’     </span>
   <span class="hljs-comment">//     </span>
   <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">incr_timer</span><span class="hljs-params">(<span class="hljs-keyword">int</span> profile_entry_id, LONGEST_INT value)</span>
   </span>{<font></font>
     entries[profile_entry_id].elapsed_time += val;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//       </span>
   <span class="hljs-comment">//   </span>
   <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">report</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;<font></font>
<font></font>
   <span class="hljs-comment">// </span>
   timeManager(<span class="hljs-keyword">void</span>)<font></font>
   {<font></font>
     <span class="hljs-keyword">if</span>(!object)<font></font>
	    object = <span class="hljs-literal">true</span>;
     <span class="hljs-keyword">else</span><font></font>
     {<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n&lt;&lt;&gt;&gt;:    'timeManager' .\n"</span>);
        <span class="hljs-keyword">throw</span>;<font></font>
     }<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//        </span>
   <span class="hljs-comment">//   </span>
   <span class="hljs-keyword">virtual</span> ~timeManager(<span class="hljs-keyword">void</span>) {report();}<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">//     </span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp_entries</span><span class="hljs-params">(registerEntry &amp; first, 
		             registerEntry &amp; second)</span>
</span>{
  <span class="hljs-keyword">if</span>(first.entry_name.compare(second.entry_name)&gt;<span class="hljs-number">0</span>)
     <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//      </span>
<span class="hljs-comment">//    </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">timeManager::report</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
  <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-title">bar</span><span class="hljs-params">(<span class="hljs-number">72</span>,<span class="hljs-string">'*'</span>)</span></span>;<font></font>
<font></font>
  <span class="hljs-comment">//       </span>
  <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * REPORT_FILE = <span class="hljs-string">"C:\\tmProfile.txt"</span>;<font></font>
<font></font>
  FILE * fp = fopen(REPORT_FILE,<span class="hljs-string">"w"</span>);
  <span class="hljs-keyword">if</span>(!fp)<font></font>
  {<font></font>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n&lt;&lt;&gt;&gt;:       (%s)"</span>,REPORT_FILE);
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
<font></font>
  <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n#%s"</span>,bar.c_str());
  <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n#\n#      "</span>);
  <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n#\n#%s"</span>,bar.c_str());
  <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n#\n# %-35s %-15s %-20s"</span>,
         <span class="hljs-string">" "</span>,<span class="hljs-string">""</span>,<span class="hljs-string">" ()"</span>);<font></font>
<font></font>
  <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n# %-35s %-15s %-20s"</span>,
          <span class="hljs-string">"------------------"</span>,<span class="hljs-string">"-------------"</span>,<span class="hljs-string">"---------------\n#"</span>);<font></font>
<font></font>
   <span class="hljs-comment">//        </span>
   <span class="hljs-built_in">std</span>::sort(entries.begin(),entries.end(),cmp_entries);<font></font>
<font></font>
   <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> jj = <span class="hljs-number">0</span>; jj&lt; entries.size(); jj++)<font></font>
   {<font></font>
     <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n# %-35s %-16d"</span>, entries[jj].entry_name.c_str(), <font></font>
                                   entries[jj].covers_counter);<font></font>
     <span class="hljs-keyword">if</span>(entries[jj].covers_counter == <span class="hljs-number">0</span>)
        <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"%-20d"</span>,<span class="hljs-number">0</span>);
     <span class="hljs-keyword">else</span>
       <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"%-20.0f"</span>, <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">double</span>&gt;(entries[jj].elapsed_time)/
				     <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">double</span>&gt;(CLOCKS_PER_SEC));<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span>(entries.size() == <span class="hljs-number">0</span>)
      <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n# No covered profile entries found\n"</span>);<font></font>
<font></font>
   <span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">"\n#\n#%s\n"</span>,bar.c_str());<font></font>
   fclose(fp);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デモアプリケーションの構造を以下に示します。例として、組み込みのランタイム制御ツールの使用と、取得した結果の表を示します（詳細については、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付録1.デモアプリケーションのソースコードを</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照して</font><b><i><font style="vertical-align: inherit;">ください</font></i></b><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bg/ds/cg/bgdscgwtg66sw9cdwo1kacjeryy.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/oi/sw/kk/oiswkkxofhegr5uokrld8ttpdmg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セクションの</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">補足2. C＃アプリケーションの実行時間の組み込み制御の手段のソースコードは、C＃</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の組み込み制御の手段の同様の実装を示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
著者は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EREMEX</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって開発された</font><font style="vertical-align: inherit;">ソフトウェア製品の</font><font style="vertical-align: inherit;">一部として、面倒な（計算の観点から）メソッドとプロシージャの実行時間をプロファイリングするときに</font><font style="vertical-align: inherit;">、</font><b><font style="vertical-align: inherit;">TimeWatcher.StartWatch（）</font></b><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimeWatcher.StopWatch（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のペアを使用</font><font style="vertical-align: inherit;">し</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delta</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Design-電子機器のコンピューター支援設計システム。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、言及された製品の機能の1つの時間メトリックに関する簡単なレポートの例です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5_/ka/r-/5_kar-gqi4xmd2p9bfrtlqae3vc.jpeg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単な結論</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明したツールは、プログラムコードのさまざまな部分でアプリケーション実行時間に関するデータを収集するために使用できます。特に、次のことが可能です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション内の実行スレッドの時間メトリックに関するデータを収集して蓄積します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初級言語の構成要素に対して正確なプログラムコードの実行時間の推定を実行します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション実行フローの対応するセクションの組み込み制御ツールをオンおよびオフにすることにより、抽出されたデータの量を管理します </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション時間メトリックの安定性を監視（および低下を検出）する回帰テストを開発および適用します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論として、このパブリケーションの外では、マルチスレッド実行（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチスレッド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）アプリケーション</font><font style="vertical-align: inherit;">のコンテキストで説明されているアプリケーション組み込み制御手段に疑問が</font><font style="vertical-align: inherit;">あり、時間データ</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mメトリック</font><b><i><font style="vertical-align: inherit;">の</font></i></b><font style="vertical-align: inherit;">分析の正確性については提示されていません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">後者は、実際に</font><font color="blue"><font color="black"><font style="vertical-align: inherit;">は、ランタイムソフトウェアコンポーネントアプリケーション間</font></font></font><font color="blue"><b><i><font style="vertical-align: inherit;">の</font></i></b></font><font color="blue"><font color="black"><font style="vertical-align: inherit;">コストの</font></font></font><font color="blue"><b><i><font style="vertical-align: inherit;">tnositelnom分布</font></i></b></font><font color="blue"><b><font style="vertical-align: inherit;">に関する</font></b></font><font style="vertical-align: inherit;">最初の関連データの低下における最初のアプリケーションの</font><font style="vertical-align: inherit;">時間</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">による</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検出という事実によるもの</font><font color="blue"><font color="black"><font style="vertical-align: inherit;">です。</font></font></font><font color="blue"><font color="black"><font style="vertical-align: inherit;">この点で、得られたデータの正確さの問題は背景に薄れてきています。</font></font></font></font><font color="blue"><b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i></b> <font color="black"><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付録1.デモアプリケーションのソースコード</font></font></h3><br>
<pre><code class="cpp hljs"><span class="hljs-function">INITIALIZE_PROFILER
<span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> * argv[])</span>
</span>{
   <span class="hljs-comment">//create profile manager</span>
   <span class="hljs-function">CREATE_PROFILER
   <span class="hljs-title">PROFILE_ENTRY</span><span class="hljs-params">(<span class="hljs-string">"1 Main context"</span>)</span> 
   <span class="hljs-title">f11</span><span class="hljs-params">()</span></span>;
   <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> jj = <span class="hljs-number">0</span>;jj&lt;<span class="hljs-number">4</span>;jj++)<font></font>
       f12();<font></font>
   <font></font>
   f13 ();<font></font>
   f14 ();<font></font>
   f15 ();<font></font>
   f16 ();<font></font>
   f17();<font></font>
   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f11</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span><span class="hljs-comment">/////////////////////////////////////////</span>
</span>{<font></font>
   PROFILE_ENTRY (<span class="hljs-string">"2 f11()........................"</span>)
   <span class="hljs-keyword">for</span> (<span class="hljs-keyword">unsigned</span> jj = <span class="hljs-number">0</span>; jj&lt;<span class="hljs-number">5</span>; jj++)<font></font>
   {<font></font>
    PROFILE_ENTRY (<span class="hljs-string">"2 f11()::for(...){...} iterat-ing"</span>)<font></font>
    DELAY(<span class="hljs-number">1</span>)<font></font>
   }<font></font>
   <span class="hljs-comment">//profile entry for repeating </span>
   <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">nn</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;
   <span class="hljs-keyword">while</span>(nn &gt; <span class="hljs-number">0</span>)<font></font>
   {<font></font>
     PROFILE_ENTRY(<span class="hljs-string">"2 f11()::while(...){...} iterat-ing"</span>)<font></font>
     DELAY(<span class="hljs-number">1</span>)<font></font>
     nn--;<font></font>
   }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f12</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span><span class="hljs-comment">/////////////////////////////////////////</span>
</span>{<font></font>
  PROFILE_ENTRY(<span class="hljs-string">"3 f12()........................"</span>) 
  <span class="hljs-keyword">goto</span> ending;<font></font>
<font></font>
 {<font></font>
   PROFILE_ENTRY(<span class="hljs-string">"3 f12()::ignored code part"</span>)<font></font>
   DELAY(<span class="hljs-number">1</span>)<font></font>
 }<font></font>
 ending: PROFILE_ENTRY(<span class="hljs-string">"3 f12()::ending code part"</span>)<font></font>
         DELAY(<span class="hljs-number">2</span>)<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f13</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> <span class="hljs-comment">/////////////////////////////////////////</span>
</span>{<font></font>
   PROFILE_ENTRY(<span class="hljs-string">"4 f13()........................"</span>) <font></font>
   srand((<span class="hljs-keyword">unsigned</span>) time(<span class="hljs-literal">NULL</span>)/<span class="hljs-number">2</span>);
   <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> jj = <span class="hljs-number">0</span>; jj &lt; <span class="hljs-number">200</span>; jj++)<font></font>
   {<font></font>
     <span class="hljs-keyword">if</span>(rand()%<span class="hljs-number">2</span> == <span class="hljs-number">0</span>)<font></font>
     {<font></font>
       PROFILE_ENTRY(<span class="hljs-string">"4 f13()::even branch"</span>) <font></font>
	DELAY(<span class="hljs-number">0.01</span>)<font></font>
     }<font></font>
     <span class="hljs-keyword">else</span><font></font>
     {<font></font>
	PROFILE_ENTRY(<span class="hljs-string">"4 f13()::od branch"</span>) <font></font>
	DELAY(<span class="hljs-number">0.02</span>)<font></font>
     }<font></font>
   }<font></font>
}<font></font>
<span class="hljs-keyword">void</span> f14(<span class="hljs-keyword">void</span>)<span class="hljs-comment">/////////////////////////////////////////</span><font></font>
{<font></font>
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> depth = <span class="hljs-number">10</span>;<font></font>
  {<font></font>
    PROFILE_ENTRY(<span class="hljs-string">"5 f14() recursion"</span>) <font></font>
    depth--;<font></font>
    DELAY(<span class="hljs-number">0.5</span>)
    <span class="hljs-keyword">if</span>(depth == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  f14();<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f15</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span><span class="hljs-comment">/////////////////////////////////////////</span>
</span>{<font></font>
  PROFILE_ENTRY(<span class="hljs-string">"7 f15()........................"</span>) 
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> jj = <span class="hljs-number">0</span>; jj &lt; <span class="hljs-number">10</span>; jj++)<font></font>
  {<font></font>
    demo_class obj;<font></font>
    obj.method1();<font></font>
    obj.method2();<font></font>
    obj.method3();<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f16</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span><span class="hljs-comment">/////////////////////////////////////////</span>
</span>{<font></font>
  PROFILE_ENTRY(<span class="hljs-string">"8 f16()........................"</span>) 
  <span class="hljs-keyword">try</span><font></font>
  {<font></font>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> jj = <span class="hljs-number">10</span>; jj &gt;= <span class="hljs-number">0</span>; jj--)<font></font>
    {<font></font>
      PROFILE_ENTRY(<span class="hljs-string">"81 f16() try clause"</span>) <font></font>
      DELAY(<span class="hljs-number">1</span>)
      <span class="hljs-keyword">int</span> rr = <span class="hljs-number">200</span>/jj;<font></font>
     }<font></font>
   } <font></font>
   <span class="hljs-keyword">catch</span>(...)<font></font>
   {<font></font>
     PROFILE_ENTRY(<span class="hljs-string">"81 f16() catch clause"</span>)<font></font>
     DELAY(<span class="hljs-number">2</span>)
     <span class="hljs-keyword">return</span>;<font></font>
   }<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f17</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span><span class="hljs-comment">/////////////////////////////////////////</span>
</span>{<font></font>
  PROFILE_ENTRY(<span class="hljs-string">"9 f17()........................"</span>) <font></font>
  f21();<font></font>
  f22();<font></font>
  f23();<font></font>
  f24();<font></font>
  f25();<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f22</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span><span class="hljs-comment">/////////////////////////////////////////</span>
</span>{<font></font>
  PROFILE_ENTRY(<span class="hljs-string">"91 f22()........................"</span>) <font></font>
  DELAY(<span class="hljs-number">1</span>)<font></font>
  f221();<font></font>
  f222();<font></font>
  f223();<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f23</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{PROFILE_ENTRY(<span class="hljs-string">"91 f23()"</span>) <font></font>
 DELAY(<span class="hljs-number">1</span>)<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f24</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{PROFILE_ENTRY(<span class="hljs-string">"91 f24()"</span>) <font></font>
 DELAY(<span class="hljs-number">1</span>)<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f25</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{PROFILE_ENTRY(<span class="hljs-string">"91 f25()"</span>) <font></font>
 DELAY(<span class="hljs-number">1</span>)<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f221</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{PROFILE_ENTRY(<span class="hljs-string">"91 f221()"</span>) <font></font>
 DELAY(<span class="hljs-number">3</span>)<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f222</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{PROFILE_ENTRY(<span class="hljs-string">"91 f222()"</span>) <font></font>
 DELAY(<span class="hljs-number">4</span>)<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f223</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{PROFILE_ENTRY(<span class="hljs-string">"91 f223()"</span>) <font></font>
 DELAY(<span class="hljs-number">5</span>)<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">補足2.組み込みランタイムコントロールC＃アプリケーションのソースコード</font></font></h3><br>
<pre><code class="cpp hljs"><span class="hljs-comment">/// &lt;summary&gt;</span>
<span class="hljs-comment">///            </span>
<span class="hljs-comment">/// &lt;/summary&gt;</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimeWatcher</span>
{</span><font></font>
<font></font>
<span class="hljs-comment">/// &lt;summary&gt;</span>
<span class="hljs-comment">///           </span>
<span class="hljs-comment">/// &lt;/summary&gt;</span>
internal <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimeEntry</span>
{</span>
  <span class="hljs-comment">//    </span>
  <span class="hljs-keyword">public</span> Stopwatch timeWatch;<font></font>
 <font></font>
  <span class="hljs-comment">//      </span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">long</span> elapsedTime;<font></font>
 <font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TimeEntry</span><span class="hljs-params">()</span>
  </span>{<font></font>
    timeWatch = <span class="hljs-keyword">new</span> Stopwatch();<font></font>
    elapsedTime = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
 }<font></font>
<font></font>
<span class="hljs-comment">//       </span>
<span class="hljs-comment">//   </span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> enableTimeWatcher = <span class="hljs-literal">false</span>;<font></font>
 <font></font>
<span class="hljs-comment">//           </span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Dictionary&lt;<span class="hljs-built_in">string</span>, TimeEntry&gt; entryDictionary = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-built_in">string</span>, <font></font>
                                                                              TimeEntry&gt;();<font></font>
 <font></font>
<span class="hljs-comment">//        </span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">StartWatch</span><span class="hljs-params">(<span class="hljs-built_in">string</span> postfix = <span class="hljs-string">""</span>)</span>
</span>{
   <span class="hljs-keyword">if</span> (!enableTimeWatcher)
       <span class="hljs-keyword">return</span>;<font></font>
 <font></font>
   <span class="hljs-built_in">string</span> entryName = GetCurrentMethod();
   <span class="hljs-keyword">if</span> (postfix != <span class="hljs-string">""</span>)<font></font>
   {<font></font>
      entryName += postfix;<font></font>
   }<font></font>
 <font></font>
   <span class="hljs-comment">//    ,     </span>
   <span class="hljs-comment">//        </span>
   <span class="hljs-keyword">if</span> (!entryDictionary.ContainsKey(entryName))<font></font>
   {<font></font>
       entryDictionary.Add(entryName, <span class="hljs-keyword">new</span> TimeEntry());<font></font>
       entryDictionary[entryName].timeWatch.Start();<font></font>
   }<font></font>
   <span class="hljs-keyword">else</span><font></font>
   {<font></font>
      <span class="hljs-keyword">if</span> (entryDictionary[entryName].timeWatch.IsRunning)<font></font>
      {<font></font>
         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> System.InvalidOperationException(<span class="hljs-string">":    '"</span> <font></font>
                                                    + entryName <font></font>
                                                    + <span class="hljs-string">"'  ."</span>);<font></font>
      }<font></font>
      <span class="hljs-keyword">else</span><font></font>
         entryDictionary[entryName].timeWatch.Restart();<font></font>
   }<font></font>
 }<font></font>
 <font></font>
 <span class="hljs-comment">//       </span>
 <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">StopWatch</span><span class="hljs-params">(<span class="hljs-built_in">string</span> postfix = <span class="hljs-string">""</span>)</span>
 </span>{
    <span class="hljs-keyword">if</span> (!enableTimeWatcher)
        <span class="hljs-keyword">return</span>;<font></font>
 <font></font>
    <span class="hljs-built_in">string</span> entryName = GetCurrentMethod();<font></font>
 <font></font>
    <span class="hljs-keyword">if</span> (postfix != <span class="hljs-string">""</span>)<font></font>
    {<font></font>
       entryName += postfix;<font></font>
    }<font></font>
 <font></font>
    <span class="hljs-comment">//    ,     </span>
    <span class="hljs-keyword">if</span> (!entryDictionary.ContainsKey(entryName))<font></font>
    {<font></font>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> System.InvalidOperationException(<span class="hljs-string">":     -
           '"</span> + entryName + <span class="hljs-string">"'."</span>);<font></font>
    }<font></font>
 <font></font>
    <span class="hljs-keyword">if</span> (!entryDictionary[entryName].timeWatch.IsRunning)<font></font>
    {<font></font>
         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> System.InvalidOperationException 
         <span class="hljs-string">":        '"</span> + <font></font>
         entryName + <span class="hljs-string">"'."</span>);<font></font>
      }<font></font>
      entryDictionary[entryName].timeWatch.Stop();<font></font>
      entryDictionary[entryName].elapsedTime += <font></font>
                   entryDictionary[entryName].timeWatch.ElapsedMilliseconds;<font></font>
    }<font></font>
 <font></font>
    <span class="hljs-comment">//        </span>
    <span class="hljs-comment">//    </span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TimeWatchReport</span><span class="hljs-params">()</span>
    </span>{
       <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> bar = <span class="hljs-string">"============================================="</span>;<font></font>
 <font></font>
       <span class="hljs-keyword">if</span> (!enableTimeWatcher)
           <span class="hljs-keyword">return</span>;<font></font>
 <font></font>
       Console.WriteLine(<span class="hljs-string">""</span>);<font></font>
       Console.WriteLine(bar);<font></font>
       Console.WriteLine(<span class="hljs-string">"     (): "</span>);<font></font>
       Console.WriteLine(<span class="hljs-string">""</span>);<font></font>
 <font></font>
       <span class="hljs-keyword">int</span> maxLen = <span class="hljs-number">0</span>;<font></font>
       foreach (var timeEntry in entryDictionary)<font></font>
       {<font></font>
            <span class="hljs-keyword">if</span>(timeEntry.Key.Length &gt; maxLen)<font></font>
               maxLen = timeEntry.Key.Length;<font></font>
       }<font></font>
       maxLen++;<font></font>
       <span class="hljs-built_in">string</span> strFormat = <span class="hljs-string">"{0,"</span> + maxLen + <span class="hljs-string">"} ... {1,-10}"</span>;<font></font>
 <font></font>
       foreach (var timeEntry in entryDictionary)<font></font>
       {<font></font>
         Console.WriteLine(strFormat, timeEntry.Key, timeEntry.Value.elapsedTime);<font></font>
       }<font></font>
       Console.WriteLine(bar);<font></font>
       Console.WriteLine(<span class="hljs-string">""</span>);<font></font>
 <font></font>
       entryDictionary.Clear();<font></font>
       enableTimeWatcher = <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-comment">//         </span>
    <span class="hljs-comment">//      /tmw   </span>
    <span class="hljs-comment">//  </span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">InitTimeWatch</span><span class="hljs-params">()</span>
    </span>{
       <span class="hljs-keyword">if</span> (Environment.GetCommandLineArgs().Any(v =&gt; v == <span class="hljs-string">"/tmw"</span>))<font></font>
       {<font></font>
           <span class="hljs-keyword">if</span> (entryDictionary.Count &gt; <span class="hljs-number">0</span>)<font></font>
           {<font></font>
               TimeWatchReport();<font></font>
           }<font></font>
           entryDictionary.Clear();<font></font>
           enableTimeWatcher = <span class="hljs-literal">true</span>;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//       </span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> <span class="hljs-title">GetCurrentMethod</span><span class="hljs-params">()</span>
    </span>{<font></font>
       StackTrace st = <span class="hljs-keyword">new</span> StackTrace();<font></font>
       StackFrame sf = st.GetFrame(<span class="hljs-number">2</span>);
       <span class="hljs-keyword">return</span> sf.GetMethod().Name;<font></font>
    }<font></font>
  }</code></pre></font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468393/index.html">優れたマイクロコントローラを使用すると、時間は速く飛ぶか、週末のオシロスコープ</a></li>
<li><a href="../ja468395/index.html">クラウドセキュリティの監視。パート2</a></li>
<li><a href="../ja468397/index.html">OpenStreetMap No. 477の世界からのお知らせ（09/03/2019-09.09.2019）</a></li>
<li><a href="../ja468399/index.html">C / C ++。LinuxのGCCで作業するときに組み込みアプリケーションリソースを使用する方法</a></li>
<li><a href="../ja468401/index.html">ASP.NET Core + SPAでJWTを交換する安全な方法</a></li>
<li><a href="../ja468405/index.html">なんとなく2つのブラウザがスクロールバーに入り......</a></li>
<li><a href="../ja468407/index.html">5G-ウェブを遅くする可能性が高い技術</a></li>
<li><a href="../ja468409/index.html">Slackクライアントのサービスワーカー：ダウンロードの高速化とオフラインモード</a></li>
<li><a href="../ja468411/index.html">パフォーマンスの問題Moment.jsの解決に関するストーリー</a></li>
<li><a href="../ja468413/index.html">アクセラレーションinstagram.com。パート2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>