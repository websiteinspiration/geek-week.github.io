<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔃 🏴‍☠️ ⤵️ 什么是Windows PowerShell？它吃什么？第1部分：主要功能 ↔️ ◀️ 🎿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="从历史上看，Unix系统上的命令行实用程序比Windows上的开发更好，但是，随着新解决方案的出现，情况发生了变化。
 
 Windows PowerShell允许系统管理员自动执行大多数日常任务。借助它的帮助，您可以更改设置，停止和启动服务，以及执行大多数已安装应用程序的维护。将蓝色窗口视为另一个...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>什么是Windows PowerShell？它吃什么？第1部分：主要功能</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487876/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从历史上看，Unix系统上的命令行实用程序比Windows上的开发更好，但是，随着新解决方案的出现，情况发生了变化。</font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell允许系统管理员自动执行大多数日常任务。</font><font style="vertical-align: inherit;">借助它的帮助，您可以更改设置，停止和启动服务，以及执行大多数已安装应用程序的维护。</font><font style="vertical-align: inherit;">将蓝色窗口视为另一个命令解释器是错误的。</font><font style="vertical-align: inherit;">这种方法不能反映Microsoft提出的创新的实质。</font><font style="vertical-align: inherit;">实际上，Windows PowerShell的可能性要广泛得多：在简短的系列文章中，我们将尝试弄清楚Microsoft解决方案与较熟悉的工具有何不同。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主要特点&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，Windows PowerShell主要是带有脚本语言的命令外壳，该脚本语言最初是基于.NET Framework创建的，后来又基于.NET Core。与接受和返回文本数据的外壳不同，Windows PowerShell与具有属性和方法的.NET类一起使用。 PowerShell允许您执行普通命令，还可以访问COM，WMI和ADSI对象。它使用各种存储库（例如文件系统或Windows注册表）进行访问，即所谓的供应商（提供者）。值得注意的是，可以将可执行的PowerShell组件嵌入其他应用程序中以实现各种操作的功能，包括通过图形界面。反之亦然：许多Windows应用程序都通过PowerShell提供对其管理界面的访问。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell允许您执行以下操作：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改操作系统设置；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理服务和流程；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置服务器角色和组件；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装软件</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过特殊界面管理已安装的软件；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将可执行组件嵌入第三方程序中；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建脚本以自动执行管理任务；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用文件系统，Windows注册表，证书存储等。</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳和开发环境</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell有两种方式：除了具有命令外壳的控制台仿真器之外，还有集成的脚本环境（ISE）。</font><font style="vertical-align: inherit;">要访问命令行界面，只需在Windows菜单中选择适当的快捷方式，或从“运行”菜单中运行powershell.exe。</font><font style="vertical-align: inherit;">屏幕上会出现一个蓝色窗口，其功能与以前的cmd.exe明显不同。</font><font style="vertical-align: inherit;">对于Unix系统，命令外壳程序的用户熟悉自动补全和其他功能。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ds/gl/te/dsgltei5iog1igfonvgmqrprvpg.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要使用外壳，您需要记住一些按键组合：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上下箭头在历史记录中滚动以重复以前键入的命令；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该行末尾的向右箭头按字母顺序循环使用前一个命令。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + Home删除从光标位置到行首的键入文本；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + End删除从光标到行尾的文本。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F7显示带有键入命令的窗口，并允许您选择其中之一。</font><font style="vertical-align: inherit;">鼠标选择，复制粘贴，光标定位，删除，退格键也可以在控制台中运行-所有这些我们都喜欢。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4z/dz/8y/4zdz8ycsabniuypzx-tloxc9vk4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell ISE是一个成熟的开发环境，它通过代码编辑器，命令设计器，内置调试器和其他编程功能来支持选项卡和语法突出显示。</font><font style="vertical-align: inherit;">如果在命令名称之后在开发环境编辑器中编写连字符，则将在下拉列表中获得所有可用参数的类型。</font><font style="vertical-align: inherit;">您可以通过系统菜单中的快捷方式或使用powershell_ise.exe可执行文件启动PowerShell ISE。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yp/4o/wo/yp4owoc2brcx0vrosfgjkkb_vz4.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmdlet&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Windows PowerShell中，所谓的cmdlet这些是包含各种功能的专用.NET类。它们根据“动作对象”（或“动词名词”，如果您更喜欢）的原则命名，并且连字符分隔的连接词类似于自然语言句子中的谓词和主语。例如，Get-Help的字面意思是“ Get-Help”，或者在PowerShell中是“ Show-Help”。实际上，这与Unix系统中的man命令类似，并且需要以这种方式请求PowerShell中的手册，而不是通过使用--help或/？键来调用cmdlet。不要忘记在线PowerShell文档：Microsoft对此非常详细。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了Get之外，cmdlet中还使用了其他动词（严格来说不仅是动词）来指示动作。在下面的列表中，我们提供一些示例：</font></font><br>
<br>
<code>Add</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-添加；</font></font><br>
<code>Clear</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-干净；</font></font><br>
<code>Enable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-启用；</font></font><br>
<code>Disable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 关掉; </font></font><br>
<code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 创建; </font></font><br>
<code>Remove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-删除；</font></font><br>
<code>Set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-问；</font></font><br>
<code>Start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 跑; </font></font><br>
<code>Stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 停; </font></font><br>
<code>Export</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 出口; </font></font><br>
<code>Import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-进口。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有系统cmdlet，用户cmdlet和可选cmdlet：作为执行的结果，它们都返回一个对象或对象数组。它们不区分大小写，即从命令解释器的角度来看，Get-Help和get-help之间没有区别。 “;”字符用于分隔，但是只有在同一行上执行多个cmdlet时才必须设置该字符。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell cmdlet分为模块（NetTCPIP，Hyper-V等），并且存在Get-Command cmdlet可以按对象和操作进行搜索。</font><font style="vertical-align: inherit;">您可以像这样显示帮助：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gu/ek/ub/guekubdaoboz6eitvbzzqppmyvi.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
默认情况下，该命令显示简要帮助，但如有必要，会将参数（参数）传递给cmdlet。</font><font style="vertical-align: inherit;">例如，使用它们，您可以获得详细的（-Detailed参数）或完整的（-Full参数）帮助，并且还显示示例（-Examples参数）：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Examples</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell中的帮助已使用Update-Help cmdlet更新。如果命令行太长，则可通过编写服务字符``''并按Enter键将cmdlet的参数传递到下一个命令行-只需在一行上完成写命令然后在另一行上继续即可。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下是一些常见cmdlet的示例：&nbsp; </font></font><br>
<br>
<code>Get-Process</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-显示系统中正在运行的进程；</font></font><br>
<code>Get-Service</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-显示服务及其状态；</font></font><br>
<code>Get-Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-显示文件的内容。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于Windows PowerShell中经常使用的cmdlet和外部实用程序，有简短的同义词-别名（来自英语别名）。</font><font style="vertical-align: inherit;">例如，dir是Get-ChildItem的别名。</font><font style="vertical-align: inherit;">同义词列表包含来自Unix系统的命令类似物（ls，ps等），而help-help调用Get-Help cmdlet。</font><font style="vertical-align: inherit;">可以使用Get-Alias cmdlet查看同义词的完整列表：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/d-/p_/m-/d-p_m-vc7nnwcrq2weryyqbeb8o.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerShell脚本，功能，模块和语言</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell脚本存储为扩展名为.ps1的纯文本文件。您无法通过双击启动它们：您需要右键单击上下文菜单，然后选择“在PowerShell中运行”项。在控制台中，您将必须指定脚本的完整路径，或者转到适当的目录并写入文件名。运行脚本也受系统策略限制，并且要检查当前设置，可以使用Get-ExecutionPolicy cmdlet，它将提供以下值之一：</font></font><br>
<br>
<code>Restricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-禁止执行脚本（默认情况下）；</font></font><br>
<code>AllSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-仅允许启动由受信任的开发人员签名的脚本；</font></font><br>
<code>RemoteSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-允许运行签名和自定义脚本；</font></font><br>
<code>Unrestricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-允许运行任何脚本。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
管理员有两个选择。最安全的方法是对脚本进行签名，但这是一个非常严重的巫术-我们将在以下文章中对其进行处理。现在，我们将遵循阻力最小的路径并更改政策：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Set-ExecutionPolicy</span> RemoteSigned</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k7/da/gg/k7dagg4xwaerpartpet4k_5eaa4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为此，PowerShell将必须以管理员身份运行，尽管您可以使用特殊参数来更改当前用户的策略。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
脚本以面向对象的编程语言编写，其命令的命名与先前讨论的cmdlet的原理相同：“ Action-Object”（“动词名词”）。它的主要目的是自动化管理任务，但是它是一种成熟的解释型语言，具有所有必要的构造：条件分支，循环，变量，数组，对象，错误处理等。任何文本编辑器都适合编写脚本，但是启动Windows PowerShell ISE最方便。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以将参数传递给脚本，使其成为必需参数，还可以设置默认值。</font><font style="vertical-align: inherit;">此外，Windows PowerShell允许您创建函数并以与cmdlet相同的方式调用它们：为此，可以使用Function构造和花括号。</font><font style="vertical-align: inherit;">具有功能的脚本称为模块，扩展名为.psm1。</font><font style="vertical-align: inherit;">模块必须存储在PowerShell环境变量中定义的目录中。</font><font style="vertical-align: inherit;">您可以使用以下命令查看它们：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Env:\PSModulePath | <span class="hljs-built_in">Format-Table</span> <span class="hljs-literal">-AutoSize</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输送机</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在最后一个示例中，我们使用了Unix系统外壳用户熟悉的设计。在Windows PowerShell中，竖线还允许您将一个命令的输出传输到另一个命令的输入，但是管道的实现存在显着差异：这与字符集或某些文本无关。内置cmdlet或用户定义的函数返回对象或对象数组，也可以在输入处接收它们。像Bourne shell及其许多追随者一样，PowerShell通过管道简化了复杂的任务。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
管道的最简单示例如下所示：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zm/pm/l0/zmpml0zpq48xqcsbqga7c-lvkfo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，运行Get-Service cmdlet，然后将其接收的所有服务传递到Sort-Object cmdlet，以按Status属性进行排序。</font><font style="vertical-align: inherit;">管道上一部分的结果传递给哪个参数取决于其类型-通常这是一个InputObject。</font><font style="vertical-align: inherit;">此问题将在专门针对PowerShell编程语言的文章中详细讨论。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果愿意，可以继续执行链并将Sort-Object的结果传递给另一个cmdlet（它们将从左到右执行）。</font><font style="vertical-align: inherit;">顺便说一句，Windows熟悉的页面输出设计也可用于所有Unixoid：&nbsp;</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status | more</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在后台运行任务&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常，您需要在后台运行某个命令，以免等待在Shell会话中执行该命令的结果。</font><font style="vertical-align: inherit;">在Windows PowerShell中，有几种针对此情况的cmdlet：</font></font><br>
<br>
<code>Start-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-启动后台任务；</font></font><br>
<code>Stop-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-停止后台任务；</font></font><br>
<code>Get-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-查看后台任务列表；</font></font><br>
<code>Receive-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-查看后台任务的结果；</font></font><br>
<code>Remove-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-删除后台任务；</font></font><br>
<code>Wait-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-将后台任务转移回控制台。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要启动后台任务，我们使用Start-Job cmdlet并在大括号中指示一个命令或一组命令：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Start-Job</span> {<span class="hljs-built_in">Get-Service</span>}</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_l/v7/31/_lv731nqaggn7kyk7thfu1g4gzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以通过了解Windows PowerShell中的后台任务的名称来对其进行操作。</font><font style="vertical-align: inherit;">首先，学习如何显示它们：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Job</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tu/r4/ha/tur4halfauj3kro8ajjersimf8o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们显示Job1的结果：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Receive-Job</span> Job1 | more</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/od/yz/znodyzk81wsadjjacvg9tmeis9g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
很简单</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">远程命令执行</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell使您不仅可以在本地计算机上执行命令和脚本，还可以在远程计算机上甚至在整组计算机上执行命令和脚本。</font><font style="vertical-align: inherit;">做这件事有很多种方法：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许多cmdlet都有一个参数</font></font><code>-ComputerName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是这种方法将失败，例如，创建管道。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该cmdlet </font></font><code>Enter-PSSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许您在远程计算机上创建交互式会话。&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该cmdlet，</font></font><code>Invoke-Command</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在一台或多台远程计算机上执行命令或脚本。</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerShell版本</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自2006年首次发布以来，PowerShell发生了很大变化。该工具可用于在不同硬件平台（x86，x86-64，Itanium，ARM）上运行的许多系统：Windows XP，Windows Server 2003，Windows Vista，Windows Server 2008/2008 R2，Windows 7，Windows 8，Windows 8.1，Windows RT，Windows RT 8.1，Windows Server 2012/2012 R2，Windows 10，Windows Server 2016，GNU / Linux和OS X.最新版本6.2已于2018年1月10日发布。为早期版本编写的脚本更有可能在以后的版本中使用，但是反向移植可能会出现问题，因为经过多年的发展，PowerShell中出现了大量新的cmdlet。您可以使用$ PSVersionTable内置变量的PSVersion属性找出计算机上安装的外壳的版本：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PSVersionTable</span>.PSVersion</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ib/0o/8z/ib0o8zeqxrn7ye3ddykovsckmis.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还可以使用cmdlet：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> <span class="hljs-literal">-Name</span> PSVersionTable –ValueOnly</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3m/zc/r4/3mzcr4i_lettn4s_ulrqo_jpm8g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与Get-Host cmdlet相同。</font><font style="vertical-align: inherit;">实际上，有很多选择，但是要使用它们，您需要学习PowerShell编程语言，这是我们</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在下一篇文章</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中将要做的</font><font style="vertical-align: inherit;">。&nbsp;</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摘要&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoft已成功创建了一个功能强大的命令外壳程序，它具有用于开发脚本的便捷集成环境。它与Windows操作系统以及它们的软件和.NET Core平台的深度集成，与Unix世界中我们熟悉的方法不同。 PowerShell可以称为面向对象的外壳，因为cmdlet和用户定义的函数将返回对象或对象数组，并可以在输入处接收它们。我们认为所有Windows服务器管理员都应该拥有此工具：已经过了没有命令行就可以使用的时间。在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行Windows Server Core的低成本VPS上，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特别需要高级控制台外壳</font><font style="vertical-align: inherit;">，但这是另一回事了。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> 3:      ,  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> 4:   ,  <br>
</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN487862/index.html">Nyasha多少钱？</a></li>
<li><a href="../zh-CN487864/index.html">电子护照：加入世界惯例还是会冒着泄露个人数据的风险？</a></li>
<li><a href="../zh-CN487868/index.html">在iOS上使用VisionKit和Vision Framework进行文档扫描和文本识别</a></li>
<li><a href="../zh-CN487872/index.html">在家中用液态硅树脂模制模具</a></li>
<li><a href="../zh-CN487874/index.html">英特尔NUC Chaco Canyon-在需要的地方工作</a></li>
<li><a href="../zh-CN487878/index.html">数据科学家经常面试的5个SQL问题</a></li>
<li><a href="../zh-CN487882/index.html">Chrome会自动阻止令人讨厌的视频广告</a></li>
<li><a href="../zh-CN487884/index.html">开发交流之前我想知道的5件事</a></li>
<li><a href="../zh-CN487888/index.html">Umbraco CMS的CSRF</a></li>
<li><a href="../zh-CN487890/index.html">使用语音框架在iOS上将语音转换为文本</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>