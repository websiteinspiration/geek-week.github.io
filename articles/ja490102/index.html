<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛰️ 🉐 🤗 wcからD：単一の分岐のない712文字 ⏹️ 🛫 🐷</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hacker Newsで見つけた「Haskellでの80ラインプログラムのビート」を読んだ後、私はDの方が良いと判断しました。そして、私はD.  Note.perでwcを書きました。上記の記事を翻訳することを提案しました
 
0xd34df00d、しかし彼は彼の「Haskellの20行で勝つ：あなた...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>wcからD：単一の分岐のない712文字</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490102/"><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Hacker News</font></a><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">見つけた</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Haskellでの80ラインプログラムのビート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」を読んだ後</font><font style="vertical-align: inherit;">、私はDの方が良いと判断しました。</font><font style="vertical-align: inherit;">そして、私はD. </font><font style="vertical-align: inherit;">
Note.perで</font><font style="vertical-align: inherit;">wcを書き</font><font style="vertical-align: inherit;">ました。</font><font style="vertical-align: inherit;">上記の記事を翻訳することを提案しました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xd34df00d</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、しかし彼は彼の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Haskellの20行で勝つ：あなたのトイレを書く」に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基づいて作ることを好んだ</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして今、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事</font></font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ミントコイン」のリハッシュのように</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">増えてい</font></a><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのファイルで構成されます-34行と712文字。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースコード</font></font></b><div class="spoiler_text"><pre><code class="swift hljs"><span class="hljs-keyword">import</span> std.stdio : writefln, File;
<span class="hljs-keyword">import</span> std.algorithm : map, fold, splitter;
<span class="hljs-keyword">import</span> std.range : walkLength;
<span class="hljs-keyword">import</span> std.typecons : Yes;
<span class="hljs-keyword">import</span> std.uni : byCodePoint;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Line</span> </span>{<font></font>
	size_t chars;<font></font>
	size_t words;<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Output</span> </span>{<font></font>
	size_t lines;<font></font>
	size_t words;<font></font>
	size_t chars;<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Output</span> combine(<span class="hljs-type">Output</span> a, <span class="hljs-type">Line</span> b) pure nothrow {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Output</span>(a.lines + <span class="hljs-number">1</span>, a.words + b.words, a.chars + b.chars);<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Line</span> toLine(char[] l) pure {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Line</span>(l.byCodePoint.walkLength, l.splitter.walkLength);<font></font>
}<font></font>
<font></font>
void main(string[] args) {<font></font>
	auto f = <span class="hljs-type">File</span>(args[<span class="hljs-number">1</span>]);
	<span class="hljs-type">Output</span> o = f<font></font>
		.byLine(<span class="hljs-type">Yes</span>.keepTerminator)<font></font>
		.<span class="hljs-built_in">map</span>!(l =&gt; toLine(l))<font></font>
		.fold!(combine)(<span class="hljs-type">Output</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));<font></font>
<font></font>
	writefln!<span class="hljs-string">"%u %u %u %s"</span>(o.lines, o.words, o.chars, args[<span class="hljs-number">1</span>]);<font></font>
}</code></pre><br>
</div></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、彼は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D標準ライブラリ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">である</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Phobos</font></a><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">いますが、なぜでしょうか。</font><font style="vertical-align: inherit;">Phobosは美しく、すべてのDコンパイラに付属しており、プログラム自体にはifステートメントが含まれていません。</font><font style="vertical-align: inherit;">そして、Haskellのwc実装では、ifがいくつか使用されます。</font><font style="vertical-align: inherit;">Dプログラムには、メインプログラムに加えて、さらに3つの小さな関数が含まれています。</font><font style="vertical-align: inherit;">私はすべての機能を1つの範囲チェーンに簡単に配置できましたが、1行あたり80文字を超える可能性があります。</font><font style="vertical-align: inherit;">これがコードスタイルの基本原則です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dのwcはcoreutils wcより高速ですか？</font><font style="vertical-align: inherit;">いいえ、でもバージョンを書くのに15分かかりました（関数の名前を忘れたため、walkLengthを探す必要がありました）。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データファイル</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイト</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">46</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">906</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5 ms±1.9 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39.6 ms±7.8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.9 ms±2.1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">862</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64k</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.7 ms±2.0 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39.6 ms±7.8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.8 ms±2.1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">170万</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,600万</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">658.6ms±24.5ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">226.4 ms±29.5 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.102秒±0.022秒</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.1M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">671M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.4秒±0.058秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1秒±0.039秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.4秒±0.085秒</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メモリ：</font></font><div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データファイル</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2052K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7228K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7708K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2112K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7512K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7616K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2288K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42620K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7712K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2360K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50860K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7736K</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハスケルのトイレは速い？</font><font style="vertical-align: inherit;">大きなファイルの場合は確かですが、マルチスレッドを使用します。</font><font style="vertical-align: inherit;">小さなファイルの場合でも、GNU coreutilsが優先されます。</font><font style="vertical-align: inherit;">この段階では、私のバージョンはIOによって制限されている可能性が高く、いずれにしても非常に高速です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ある言語が別の言語より速いとは言いません。</font><font style="vertical-align: inherit;">マイクロベンチマークの最適化に時間を費やせば、おそらく勝利するでしょう。</font><font style="vertical-align: inherit;">しかし実際にはそうではありません。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、Dの関数型プログラミングはHaskellのFPにほぼ追いつくと主張します。</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dの範囲について少し</font></font></h3><br>
<img src="https://habrastorage.org/webt/gp/qe/oo/gpqeookkvehf2hdsowdegomcqai.png" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rangeは、基礎となるコレクション（存在する場合）に触れることなく反復できる抽象化です。</font><font style="vertical-align: inherit;">技術的には、範囲は、1つ以上のRangeインターフェースを実装する構造またはクラスにすることができます。</font><font style="vertical-align: inherit;">最も単純なフォームであるInputRangeには関数が必要です</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span></span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
および2つのメンバーまたはプロパティ </font></font><br>
<br>
<pre><code class="cpp hljs">T front;
<span class="hljs-keyword">bool</span> empty;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tは、範囲を反復処理する要素の一般的なタイプです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D範囲は特定のタイプです。</font><font style="vertical-align: inherit;">範囲がforeachステートメントに該当する場合、コンパイラは小さな変更を実行します。</font></font><br>
<br>
<pre><code class="cpp hljs">foreach (e; range) { ... }</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
になる </font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> __r = range; !__r.empty; __r.popFront()) {
    <span class="hljs-keyword">auto</span> e = __r.front;<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
auto e =はタイプを計算し、T e =と同等です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを念頭に置くと、foreachで使用できる範囲を簡単に作成できます。</font></font><br>
<br>
<pre><code class="java hljs">struct Iota {
	<span class="hljs-keyword">int</span> front;
	<span class="hljs-keyword">int</span> end;<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.front == <span class="hljs-keyword">this</span>.end;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{<font></font>
		++<span class="hljs-keyword">this</span>.front;<font></font>
	}<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-keyword">import</span> std.stdio;<font></font>
	foreach(it; Iota(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
イオタは範囲の非常に単純な例です。</font><font style="vertical-align: inherit;">基になるコレクションがなくてもジェネレータとして機能します。</font><font style="vertical-align: inherit;">最初から最後まで整数を1ずつ繰り返します。</font><font style="vertical-align: inherit;">このスニペットは、少しD構文を明らかにします。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@プロパティ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
属性</font><font style="vertical-align: inherit;">を使用すると、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">をメンバー変数と同じ方法で</font><font style="vertical-align: inherit;">使用できます</font><font style="vertical-align: inherit;">（括弧なしで関数を呼び出す）。</font><font style="vertical-align: inherit;">最後</font><font style="vertical-align: inherit;">の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empty</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ぶインスタンスデータを変更しないことを意味し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。組み込みの単体テストは0から10までの数値を出力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう1つの小さな機能は、明示的なコンストラクターがないことです。 Iota構造には2つのintメンバー変数があります。テストのforeachステートメントでは、2つのintを受け入れるコンストラクターがあるかのように、Iotaインスタンスを作成します。これは構造リテラルです。コンパイラDがこれを認識しても、構造に対応するコンストラクタがない場合、変数の宣言の順序に従って、構造のメンバーにintが割り当てられます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つのメンバー間の関係は単純です。</font><font style="vertical-align: inherit;">emptyがfalseの場合、frontはpopFrontを呼び出した後の反復後に新しい要素を返すことが保証されています。</font><font style="vertical-align: inherit;">popFrontを呼び出した後、空の値が変わる可能性があります。</font><font style="vertical-align: inherit;">これが真の場合、それは反復する要素がもうないことを意味し、フロントへのそれ以上の呼び出しは無効です。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InputRangeのドキュメントに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">よる</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">と</font></a><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空が返されるか、またはfalseが返される場合にのみ、frontを正しく計算できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frontは、popFrontを呼び出さずに範囲を計算したり、基になるデータを変更したりせずに数回計算でき、計算ごとに同じ結果が得られます</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
foreach式またはループの使用は、あまり機能的ではありません。</font><font style="vertical-align: inherit;">Iotaのすべての奇数を除外したいとします。</font><font style="vertical-align: inherit;">foreachブロックの内部にifを配置することもできますが、それでさらに悪化するだけです。</font><font style="vertical-align: inherit;">範囲をとる範囲と、要素が適切であるかどうかを決定する述語があれば、より良いでしょう。</font></font><br>
<br>
<pre><code class="java hljs">struct Filter {<font></font>
	Iota input;<font></font>
	<span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate</span>;<font></font>
<font></font>
	<span class="hljs-keyword">this</span>(Iota input, <span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate) </span>{
		<span class="hljs-keyword">this</span>.input = input;
		<span class="hljs-keyword">this</span>.predicate = predicate;
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testAndIterate</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">while</span>(!<span class="hljs-keyword">this</span>.input.empty<font></font>
				&amp;&amp; !<span class="hljs-keyword">this</span>.predicate(<span class="hljs-keyword">this</span>.input.front))<font></font>
		{<font></font>
			<span class="hljs-keyword">this</span>.input.popFront();<font></font>
		}<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">this</span>.input.popFront();
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">front</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.front;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.empty;<font></font>
	}<font></font>
}<font></font>
<font></font>
<span class="hljs-function">bool <span class="hljs-title">isEven</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	foreach(it; Filter(Iota(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>), &amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フィルターも非常にシンプルです。イオタと関数ポインターが必要です。</font><font style="vertical-align: inherit;">フィルターを作成するときは、testAndIterateを呼び出します。これは、空になるか述部がfalseを返すまでIotaから要素を取得します。</font><font style="vertical-align: inherit;">アイデアは、述語が何をフィルタリングし、何を残すかを決定することです。</font><font style="vertical-align: inherit;">フロントと空のプロパティはイオタに単純に変換されます。</font><font style="vertical-align: inherit;">実際に仕事をするのはpopFrontだけです。</font><font style="vertical-align: inherit;">現在のアイテムを返し、testAndIterateを呼び出します。</font><font style="vertical-align: inherit;">それで全部です。</font><font style="vertical-align: inherit;">これはフィルターの実装です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、testAndIterateにはwhileループがありますが、私の意見では、再帰を使用してそれを書き直すことはまったく愚かです。 Dが優れているのは、各タスクに適切な方法を使用できることです。関数型プログラミングは優れており、しばしば誇示されますが、そうでない場合もあります。小さなインラインアセンブラが必要な場合、またはもっと楽しい場合は、使用してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Filterを呼び出してもまだ見栄えがよくありません。</font><font style="vertical-align: inherit;">左から右に読むことに慣れている場合、フィルターはイオタの後に実行されても、イオタの前に表示されます。</font><font style="vertical-align: inherit;">Dはパイプステートメントを提供しませんが、統合関数呼び出し構文（UFCS）を使用します。</font><font style="vertical-align: inherit;">式を関数の最初のパラメーターに暗黙的に変換できる場合、その関数は、この式のメンバー関数であるかのように呼び出すことができます。</font><font style="vertical-align: inherit;">これはかなり複雑だと思います。</font><font style="vertical-align: inherit;">例が役立ちます：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-built_in">string</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a ~ <span class="hljs-string">"World"</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-built_in">string</span> a = foo(<span class="hljs-string">"Hello "</span>);
	<span class="hljs-built_in">string</span> b = <span class="hljs-string">"Hello "</span>.foo();<font></font>
	assert(a == b);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の例は、foo関数への2つの呼び出しを示しています。</font><font style="vertical-align: inherit;">アサートが意味するように、両方の呼び出しは同等です。</font><font style="vertical-align: inherit;">これは私たちのイオタフィルターの例にとって何を意味しますか？</font><font style="vertical-align: inherit;">UFCSでは、ユニットテストを次のように書き換えることができます。</font></font><br>
<br>
<pre><code class="swift hljs">unittest {<font></font>
	foreach(it; <span class="hljs-type">Iota</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>).<span class="hljs-type">Filter</span>(&amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
範囲のマップ/変換の実装は、すべての読者がアクセスできるようになっているはずです。</font><font style="vertical-align: inherit;">もちろん、テンプレートを使用してフィルターをより抽象化することができますが、これらは単なる詳細であり、概念的に新しいものはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、双方向など、さまざまなタイプの範囲があります。</font><font style="vertical-align: inherit;">これがあなたに与える機会を推測してください。</font><font style="vertical-align: inherit;">簡単なヒント：双方向の範囲には、backとpopBackという2つの新しいプリミティブがあります。</font><font style="vertical-align: inherit;">他の種類の範囲もありますが、上記の入力範囲を2度理解すると、ほとんどの場合それらを認識できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS明確にするために、独自のフィルター、マップ、またはフォールドを実装しないでください。</font><font style="vertical-align: inherit;">Phobos D標準ライブラリには、必要なものがすべて含まれています。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std.algorithm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std.rangeを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見て</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ください</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者について</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロバートシャデックはオルデンブルク大学でコンピューターサイエンスの修士号を取得しています。</font><font style="vertical-align: inherit;">彼の修士論文は「DMCD-キャッシングを備えた分散マルチスレッドDコンパイラ」と題され、ゼロからDコンパイラの作成に取り組みました。</font><font style="vertical-align: inherit;">彼は2012-2018年にコンピューターサイエンスの大学院生でした。</font><font style="vertical-align: inherit;">オルデンブルク大学で。</font><font style="vertical-align: inherit;">彼の博士論文は、グラフと組み合わせた定足数システムに焦点を当てています。</font><font style="vertical-align: inherit;">2018年以来、彼はSymmetry Investmentsで働いている彼の日常業務でDを使用することを嬉しく思っています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">対称投資について</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symmetry Investmentsは、香港、シンガポール、ロンドンにオフィスを持つグローバルな投資会社です。</font><font style="vertical-align: inherit;">私たちは、ニューヨークの主要なヘッジファンドからの分離に成功した後、2014年からビジネスを行っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symmetryでは、リスクを合理的に取り、お客様、パートナー、および従業員に価値を提供するよう努めています。私たちは、Win-Winの契約を生成する能力から利益を得ます-広い意味で。 Win-Winは、私たちの基本的な倫理的および戦略的原則です。双方にメリットのあるオプションを生成することにより、通常は互換性がないか反対であると見なされる視点を組み合わせ、各当事者が提供できるすべてのベストをカバーする独自のソリューションを作成できます。債券仲裁をグローバルマクロ戦略に再統合しています。私たちは人間と機械の統合の可能性に焦点を当てた技術を発明し、開発しています。機械が最も得意とするシステムを構築し、彼らが最善を尽くすために私たちは協力に基づいて実力主義を作ります：個人の貢献が個人的および集団的目標の両方に役立ち、それに応じて報酬が与えられる文化。私たちは、オーナーシップの感覚と、協力、自己実現、コミュニティのチーム精神の両方を大切にしています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symmetry Investmentsの人々は、2014年からCommunity Dのアクティブなメンバーになっています。</font><font style="vertical-align: inherit;">私たちは、excel-d、dpp、autowrap、libmir、その他のプロジェクトの開発を後援しました。</font><font style="vertical-align: inherit;">2018年にSymmetry Autumn of Codeを発表し、ロンドンでDConf 2019をホストしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
約 </font><font style="vertical-align: inherit;">翻訳者はいつものように酔っていたため、人間の用語の正確さを保証できず、前のセクションでは何も理解できません。</font><font style="vertical-align: inherit;">だから、個人的なコミュニケーションで訂正を送ってください。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja490088/index.html">UE4でマップを作成し続ける方法</a></li>
<li><a href="../ja490092/index.html">Andrei Zaretsky、Alexander Trukhanov：「料金はコーヒーを飲むのに十分でした」</a></li>
<li><a href="../ja490094/index.html">ルートに戻る：MBRから直接コンピューターを駆動します</a></li>
<li><a href="../ja490096/index.html">Raspberry Pi用の小さなUSBハブを簡単に作成する方法</a></li>
<li><a href="../ja490100/index.html">分散型スクーターレンタル用のソフトウェアを開発します。それは簡単だと誰が言ったのですか？</a></li>
<li><a href="../ja490104/index.html">ボッシュのスマートサンバイザー。プロトタイプテスト</a></li>
<li><a href="../ja490110/index.html">開発者からマネージャー、そしてその逆</a></li>
<li><a href="../ja490112/index.html">コード再利用パターンとしてのモナド</a></li>
<li><a href="../ja490114/index.html">Yandex.Practicum-データアナリスト。卒業</a></li>
<li><a href="../ja490118/index.html">SERMに関する最も重要な10の事実</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>