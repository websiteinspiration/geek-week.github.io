<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©â€ğŸ­ â¤µï¸ ğŸ”³ å±é™ºãªstdã®è©±:: enable_shared_from_thisã€ã¾ãŸã¯ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€ ğŸš ğŸ‘©â€ğŸ³ ğŸ‘©ğŸ¼â€ğŸ”¬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã®è¨˜äº‹ã§ã¯ã€std :: enable_shared_from_thisã‚’ä½¿ç”¨ã™ã‚‹ã¨è‡ªç„¶ã«ç™ºç”Ÿã™ã‚‹å±é™ºãªã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚ã“ã®è³‡æ–™ã¯ã€æœ€æ–°ã®C ++ãƒ†ã‚¯ãƒãƒ­ã‚¸ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ¥ç‚¹ã«ã‚ã‚Šã¾ã™ã€‚
 
 å‰æ›¸ã
 C ++ 11ã¯ã€ãƒ¡ãƒ¢ãƒªã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ç´ æ™´ã‚‰ã—ã„ãƒ„ãƒ¼ãƒ«ã‚’...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>å±é™ºãªstdã®è©±:: enable_shared_from_thisã€ã¾ãŸã¯ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471326/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®è¨˜äº‹ã§ã¯ã€std :: enable_shared_from_thisã‚’ä½¿ç”¨ã™ã‚‹ã¨è‡ªç„¶ã«ç™ºç”Ÿã™ã‚‹å±é™ºãªã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®è³‡æ–™ã¯ã€æœ€æ–°ã®C ++ãƒ†ã‚¯ãƒãƒ­ã‚¸ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ¥ç‚¹ã«ã‚ã‚Šã¾ã™ã€‚</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰æ›¸ã</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C ++ 11ã¯ã€ãƒ¡ãƒ¢ãƒªã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ç´ æ™´ã‚‰ã—ã„ãƒ„ãƒ¼ãƒ«ã‚’é–‹ç™ºè€…ã«æä¾›ã—ã¾ã—ãŸ-ã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿ãƒ¼std :: unique_ptrãŠã‚ˆã³std :: shared_ptr + std :: weak_ptrã®æŸã€‚</font><font style="vertical-align: inherit;">åˆ©ä¾¿æ€§ã¨å®‰å…¨æ€§ã®ãŸã‚ã®ã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿ãƒ¼ã®ä½¿ç”¨ã¯ã€ç”Ÿã®ãƒã‚¤ãƒ³ã‚¿ãƒ¼ã®ä½¿ç”¨ã‚’ã¯ã‚‹ã‹ã«ä¸Šå›ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿ãƒ¼ã¯ã€å®Ÿéš›ã«åºƒãä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">é–‹ç™ºè€…ãŒå‹•çš„ã«ä½œæˆã•ã‚ŒãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ä½œæˆ/å‰Šé™¤ã®æ­£ç¢ºã•ã‚’è¿½è·¡ã™ã‚‹ã‚ˆã‚Šã‚‚é«˜ã„ãƒ¬ãƒ™ãƒ«ã®å•é¡Œã«é›†ä¸­ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
std :: enable_shared_from_thisã‚¯ãƒ©ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚æ¨™æº–ã®ä¸€éƒ¨ã§ã‚ã‚Šã€æœ€åˆã«å‡ºä¼šã£ãŸã¨ãã¯ã‹ãªã‚Šå¥‡å¦™ã«è¦‹ãˆã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®è¨˜äº‹ã§ã¯ã€ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•™è‚²ãƒ—ãƒ­ã‚°ãƒ©ãƒ </font></font></h2><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAIIã¨ã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿</font></font></b><div class="spoiler_text">    â€”   <b>  </b>,   .     RAII (Resource acquisition is initialization),            ,     ,  :<br>
 â€” ;<br>
 â€”    ;<br>
 â€”   (http, websockets);<br>
 â€”   (threads);<br>
 â€” ;<br>
 â€”  (   ).<br>
      (        ,    deleter â€”      ), :<br>
 â€”      ;<br>
 â€”   ,<br>
  Â«Â»            â€”  (std::shared_ptr)   (std::unique_ptr).    Â« RAIIÂ»:    /  ,  /     .<br>
std::shared_ptr    .      (    std::shared_ptr)     (    std::weak_ptr,     std::shared_ptr).       ,     .   std::shared_ptr         ,           .                  .<br>
RAII     ,    delete/delete[]/free/close/reset/unlock, ..:<br>
 â€”     ;<br>
 â€”        ;<br>
 â€”        ;<br>
 â€”     c++      ,        .<br>
     ,  -        .<br>
     :<br>
 â€”        (     );<br>
 â€”    ,        .<br>
              .<br>
      :<br>
 â€”       â€”     ,      â€”         ;<br>
 â€”        (Valgrind, Clang LeakSanitizer  ..);<br>
 â€” Â«    Â»;<br>
 â€” Â«   Â»;<br>
 â€” Â«    Â».<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: enable_shared_from_this</font></font></b><div class="spoiler_text"> C++11    std::enable_shared_from_this.  ,     std::enable_shared_from_this,       .<br>
   std::enable_shared_from_this?<br>
  - ,     std::shared_ptr,    (shared_from_this())   (weak_from_this(),   C++17)   std::shared_ptr,     .  shared_from_this()  weak_from_this()     .<br>
<br>
<b>  ?     std::shared_ptr&lt;T&gt;(this)</b><br>
, .  std::shared_ptr',        ,      .      .<br>
<br>
   std::enable_shared_from_this       std::shared_ptr.   ,    ,   std::unique_ptr â€”    .    std::shared_ptr.<br>
<br>
<b>         ?</b><br>
, .    -:<br>
 â€”      ,    std::shared_ptr;<br>
 â€”    private  protected;<br>
 â€”  copy-  move-.<br>
   ,        â€”           std::shared_ptr,        .<br>
      ,      .<br>
 ,    PIMPL:     â€”  â€”      std::shared_ptr,         .<br>
<br>
std::enable_shared_from_this     ,       .<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦ç‚¹ã‚’ã¤ã‹ã‚€</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã§æä¾›ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">githubã§</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¬é–‹ã•ã‚Œã¦ã„</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰ã¯ã€ç¾ä»£ã®C ++ã®é€šå¸¸ã®å®‰å…¨ãªä½¿ç”¨ã‚’è£…ã£ãŸæ‚ªã„ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ç¤ºã—ã¦ã„ã¾ã™</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜ç’°å¼</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å•é¡Œã‚’äºˆå‘Šã™ã‚‹ã‚‚ã®ã¯ä½•ã‚‚ãªã„ã‚ˆã†ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹å®£è¨€ã¯å˜ç´”ã§ç°¡å˜ã«è¦‹ãˆã¾ã™ã€‚</font><font style="vertical-align: inherit;">1ã¤ã®ã€Œå°ã•ãªã€è©³ç´°ã‚’é™¤ã„ã¦-ä½•ã‚‰ã‹ã®ç†ç”±ã§std :: enable_shared_from_thisã‹ã‚‰ã®ç¶™æ‰¿ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleCyclic.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;functional&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleCyclic {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cyclic</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">std</span>::enable_shared_from_this&lt;Cyclic&gt;<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Cyclic&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    Cyclic(<span class="hljs-keyword">const</span> Cyclic&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    Cyclic(Cyclic&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    Cyclic&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> Cyclic&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    Cyclic&amp; <span class="hljs-keyword">operator</span>=(Cyclic&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
<font></font>
    ~Cyclic();<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Cyclic();<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::function&lt;<span class="hljs-keyword">void</span>(<span class="hljs-keyword">void</span>)&gt; _fn;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SimpleCyclic</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦å®Ÿè£…ã§ã¯ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleCyclic.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleCyclic.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleCyclic {<font></font>
Cyclic::Cyclic() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
Cyclic::~Cyclic()<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Cyclic&gt; <span class="hljs-title">Cyclic::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Cyclic&gt;(<span class="hljs-keyword">new</span> Cyclic);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Cyclic::doSomething</span><span class="hljs-params">()</span>
</span>{<font></font>
    _fn = [shis = shared_from_this()](){};<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SimpleCyclic</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleCyclic/SimpleCyclic.h"</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> simpleCyclic = SimpleCyclic::Cyclic::create();<font></font>
    simpleCyclic-&gt;doSomething();<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>N12SimpleCyclic6CyclicE::doSomething<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
doSomethingï¼ˆï¼‰é–¢æ•°ã®æœ¬ä½“ã§ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‡ªä½“ãŒ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€é…ç½®ã•ã‚ŒãŸstd :: shared_ptrã®è¿½åŠ ã®å¼·åŠ›ãªã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚æ¬¡ã«ã€ä¸€èˆ¬åŒ–ã•ã‚ŒãŸã‚­ãƒ£ãƒ—ãƒãƒ£ã‚’ä½¿ç”¨ã—ã¦ã€ã“ã®ã‚³ãƒ”ãƒ¼ã¯ã€ç„¡å®³ãªstd ::é–¢æ•°ã‚’è£…ã£ã¦ã‚¯ãƒ©ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒ©ãƒ ãƒ€é–¢æ•°ã«é…ç½®ã•ã‚Œã¾ã™ã€‚ doSomethingï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã™ã¨å¾ªç’°å‚ç…§ãŒç™ºç”Ÿã—ã€å¤–éƒ¨ã®å¼·åŠ›ãªãƒªãƒ³ã‚¯ãŒã™ã¹ã¦ç ´æ£„ã•ã‚ŒãŸå¾Œã§ã‚‚ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ç ´æ£„ã•ã‚Œãªããªã‚Šã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚ SimpleCyclic :: Cyclic ::ã€œCyclicãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯å‘¼ã³å‡ºã•ã‚Œã¾ã›ã‚“ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ãã‚Œè‡ªä½“ã‚’ã€Œä¿æŒã€ã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰ãŒçµã³ã¤ã„ã¦ã—ã¾ã„ã¾ã—ãŸã€‚</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/xp/jj/_a/xpjj_atj4bf0av8kar46ebxqqew.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“ã‹ã‚‰ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”»åƒ</font><font style="vertical-align: inherit;">ï¼‰</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã—ã¦ã€ã“ã‚Œã¯ã€Œã‚¾ãƒ³ãƒ“ã€ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã„ã„ãˆã€ã“ã‚Œã¯å˜ãªã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã§ã™ã€‚æœ€ã‚‚èˆˆå‘³æ·±ã„ã‚‚ã®ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªãœé–‹ç™ºè€…ã¯ã“ã‚Œã‚’æ›¸ã„ãŸã®ã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆæˆä¾‹ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒèª¿å’Œã—ã¦å–å¾—ã•ã‚Œã‚‹çŠ¶æ³ã«ã¤ã„ã¦ã¯ã€ç§ã¯çŸ¥ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã—ã¦ã€å‹•çš„ã‚³ãƒ¼ãƒ‰åˆ†æã¯ã‚µã‚¤ãƒ¬ãƒ³ãƒˆã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã„ã„ãˆã€Valgrindã¯æ­£ç›´ã«ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã‚’å ±å‘Šã—ã¾ã—ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚¹ãƒˆValgrind</font></font></b><div class="spoiler_text"><blockquote>96 (64 direct, 32 indirect) bytes in 1 blocks are <b>definitely lost</b> in loss record 29 of 46<br>
 in SimpleCyclic::Cyclic::create() in /Users/User/Projects/Zomby_antipattern_concept/SimpleCyclic/SimpleCyclic.cpp:15<br>
 1: malloc in /usr/local/Cellar/valgrind/HEAD-60ab74a/lib/valgrind/vgpreload_memcheck-amd64-darwin.so<br>
 2: operator new(unsigned long) in /usr/lib/libc++abi.dylib<br>
 3: SimpleCyclic::Cyclic::create() in /Users/User/Projects/Zomby_antipattern_concept/SimpleCyclic/SimpleCyclic.cpp:15<br>
 4: main in /Users/User/Projects/Zomby_antipattern_concept/SimpleCyclic/main.cpp:5<br>
</blockquote><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äºŒç’°å¼</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å ´åˆã€ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã¯å®Œå…¨ã«æ­£ã—ãç°¡æ½”ã«è¦‹ãˆã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç‰¹å®šã®å®Ÿè£…ã‚’std :: shared_ptrã«æ ¼ç´ã™ã‚‹ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã‚’å®£è¨€ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">å‰ã®ä¾‹ã¨ã¯ç•°ãªã‚Šã€ç¶™æ‰¿-from std :: enable_shared_from_this-ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pimplcyclic.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> PimplCyclic {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cyclic</span>
{</span>
<span class="hljs-keyword">public</span>:<font></font>
    Cyclic();<font></font>
    ~Cyclic();<font></font>
<font></font>
<span class="hljs-keyword">private</span>:
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Impl</span>;</span>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Impl&gt; _impl;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace PimplCyclic</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦å®Ÿè£…ã§ã¯ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pimplcyclic.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;functional&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"PimplCyclic.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> PimplCyclic {<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cyclic</span>:</span>:Impl : <span class="hljs-keyword">public</span> <span class="hljs-built_in">std</span>::enable_shared_from_this&lt;Cyclic::Impl&gt;<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:<font></font>
    ~Impl()<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span>
    </span>{<font></font>
        _fn = [shis = shared_from_this()](){};<font></font>
<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
    }<font></font>
<font></font>
<span class="hljs-keyword">private</span>:
    <span class="hljs-built_in">std</span>::function&lt;<span class="hljs-keyword">void</span>(<span class="hljs-keyword">void</span>)&gt; _fn;<font></font>
};<font></font>
<font></font>
Cyclic::Cyclic()<font></font>
    : _impl(<span class="hljs-built_in">std</span>::make_shared&lt;Impl&gt;())<font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (_impl) {<font></font>
        _impl-&gt;doSomething();<font></font>
    }<font></font>
}<font></font>
<font></font>
Cyclic::~Cyclic()<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
} <span class="hljs-comment">// namespace PimplCyclic</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"PimplCyclic/PimplCyclic.h"</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> pimplCyclic = PimplCyclic::Cyclic();<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>N11PimplCyclic6Cyclic4ImplE::doSomething<br>
N11PimplCyclic6CyclicE::~Cyclic<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Impl :: doSomethingï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã™ã¨ã€Implã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¾ªç’°å‚ç…§ãŒä½œæˆã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã¯æ­£ã—ãç ´å£Šã•ã‚Œã¦ã„ã¾ã™ãŒã€å®Ÿè£…ã¯ãƒªãƒ¼ã‚¯ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿PimplCyclic :: Cyclic :: Impl ::ã€œImplã¯å‘¼ã³å‡ºã•ã‚Œã¾ã›ã‚“ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹ã¯å†ã³åˆæˆã•ã‚Œã¦ã„ã¾ã™ãŒã€ä»Šå›ã¯ã‚ˆã‚Šå±é™ºã§ã™-æ‚ªã„æ©Ÿå™¨ã¯ã™ã¹ã¦å®Ÿè£…å†…ã«ã‚ã‚Šã€åºƒå‘Šã«ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã‚‰ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å¾ªç’°ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã€æ§‹ç¯‰ä»¥å¤–ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Valgrindã«ç›´é¢ã—ãŸå‹•çš„åˆ†æã§ã€ä»Šå›ã¯ãƒªãƒ¼ã‚¯ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚¹ãƒˆValgrind</font></font></b><div class="spoiler_text"><blockquote>96 bytes in 1 blocks are <b>definitely lost</b> in loss record 29 of 46<br>
 in PimplCyclic::Cyclic::Cyclic() in /Users/User/Projects/Zomby_antipattern_concept/PimplCyclic/PimplCyclic.cpp:28<br>
 1: malloc in /usr/local/Cellar/valgrind/HEAD-60ab74a/lib/valgrind/vgpreload_memcheck-amd64-darwin.so<br>
 2: operator new(unsigned long) in /usr/lib/libc++abi.dylib<br>
 3: std::__1::__libcpp_allocate(unsigned long, unsigned long) in /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/new:252<br>
 4: std::__1::allocator&lt;std::__1::__shared_ptr_emplace&lt;PimplCyclic::Cyclic::Impl, std::__1::allocator&lt;PimplCyclic::Cyclic::Impl&gt; &gt; &gt;::allocate(unsigned long, void const*) in /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/memory:1813<br>
 5: std::__1::shared_ptr&lt;PimplCyclic::Cyclic::Impl&gt; std::__1::shared_ptr&lt;PimplCyclic::Cyclic::Impl&gt;::make_shared&lt;&gt;() in /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/memory:4326<br>
 6: _ZNSt3__1L11make_sharedIN11PimplCyclic6Cyclic4ImplEJEEENS_9enable_ifIXntsr8is_arrayIT_EE5valueENS_10shared_ptrIS5_EEE4typeEDpOT0_ in /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/memory:4706<br>
 7: PimplCyclic::Cyclic::Cyclic() in /Users/User/Projects/Zomby_antipattern_concept/PimplCyclic/PimplCyclic.cpp:28<br>
 8: PimplCyclic::Cyclic::Cyclic() in /Users/User/Projects/Zomby_antipattern_concept/PimplCyclic/PimplCyclic.cpp:29<br>
 9: main in /Users/User/Projects/Zomby_antipattern_concept/PimplCyclic/main.cpp:5<br>
</blockquote><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿè£…ãŒstd :: shared_ptrã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹Pimplã‚’è¦‹ã‚‹ã®ã¯å°‘ã—ç–‘ã‚ã—ã„ã§ã™ã€‚</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”Ÿã®ãƒã‚¤ãƒ³ã‚¿ã«åŸºã¥ãå¤å…¸çš„ãªPimplã¯å¤ã™ãã‚‹ã®ã§ã€std :: unique_ptrã«ã¯ã€ã‚³ãƒ”ãƒ¼ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã®ç¦æ­¢ã‚’ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã«æ‹¡å¼µã™ã‚‹ã¨ã„ã†å‰¯ä½œç”¨ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã¯ã€æ‰€æœ‰æ¨©ã®ã‚¤ãƒ‡ã‚£ã‚ªãƒ ã‚’å®Ÿè£…ã—ã¾ã™ãŒã€ã“ã‚Œã¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã«å¯¾å¿œã—ã¦ã„ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">std :: shared_ptrã‚’ä½¿ç”¨ã—ã¦å®Ÿè£…ã‚’æ ¼ç´ã™ã‚‹ã“ã¨ã‹ã‚‰ã€ã‚¯ãƒ©ã‚¹ã¯å…±æœ‰æ‰€æœ‰æ¨©ã‚’æä¾›ã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ã¨çµè«–ä»˜ã‘ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯å¾“æ¥ã®ãƒªãƒ¼ã‚¯ã¨ã©ã®ã‚ˆã†ã«ç•°ãªã‚Šã¾ã™ã‹ï¼Ÿå¾Œç¶šã®å‰Šé™¤ãªã—ã§æ˜ç¤ºçš„ã«newã‚’å‘¼ã³å‡ºã™ã“ã¨ã«ã‚ˆã£ã¦ãƒ¡ãƒ¢ãƒªã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">åŒã˜ã‚ˆã†ã«ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨å®Ÿè£…ã®ã™ã¹ã¦ãŒç¾ã—ããªã‚Šã¾ã™-ãƒã‚°ã€‚</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã¯</font><font style="vertical-align: inherit;">è¶³å…ƒã«è‡ªåˆ†ã‚’æ’ƒã¤ãŸã‚ã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¾ä»£çš„ãª</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•ã‚’</font><font style="vertical-align: inherit;">è­°è«–ã—ã¦ã„</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€ä¸Šè¨˜ã®è³‡æ–™ã‹ã‚‰æ˜ã‚‰ã‹ã§ã™ï¼š</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿ãƒ¼ã‚’ãƒãƒ¼ãƒ‰ã«çµã³ä»˜ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -std :: enable_shared_from_thisã®ä½¿ç”¨ã¯ã€ã“ã‚Œã«è²¢çŒ®ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒãƒ¼ãƒ‰ã«çµã³ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã€å¤–éƒ¨ã®åŠ©ã‘ã¯ã»ã¨ã‚“ã©å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã—ã¦ä»Š-æ³¨æ„-è¨˜äº‹ã®é‡è¦ãªè³ªå•ï¼šã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿ãƒ¼ã«åŒ…ã¾ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®ç¨®é¡ã¯é‡è¦ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">éåŒæœŸå®Ÿè¡Œã®HTTPSæ¥ç¶šã«ã¤ã„ã¦ã€RAIIãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚±ã‚¢ã¨RAIIã®ã‚±ã‚¢ã«é•ã„ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplezomby</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ã®å¾Œç¶šã®ã™ã¹ã¦ã®ä¾‹ã«å…±é€šã®ã‚³ãƒ¼ãƒ‰ã¯ã€å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ç§»å‹•ã•ã‚Œã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã•ã‚„ã‹ãªåå‰ã®ãƒâ€‹â€‹ãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨æŠ½è±¡çš„ãªã‚¾ãƒ³ãƒ“ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±é€š/ Manager.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span>
{</span>
<span class="hljs-keyword">public</span>:<font></font>
    Manager() = <span class="hljs-keyword">default</span>;<font></font>
    Manager(<span class="hljs-keyword">const</span> Manager&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    Manager(Manager&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    Manager&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> Manager&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    Manager&amp; <span class="hljs-keyword">operator</span>=(Manager&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
<font></font>
    <span class="hljs-keyword">virtual</span> ~Manager() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> </span>= <span class="hljs-number">0</span>;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace Common</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªã‚¹ãƒŠãƒ¼ã®æŠ½è±¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€‚ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ã«å—ã‘å…¥ã‚Œã‚‹æº–å‚™ãŒã§ãã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±é€š/ Listener.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>
{</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-keyword">virtual</span> ~Listener() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Data = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>;<font></font>
<font></font>
    <span class="hljs-comment">// thread-safe</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processData</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;<span class="hljs-keyword">const</span> Data&gt; data)</span> </span>= <span class="hljs-number">0</span>;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace Common</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ãƒªã‚¹ãƒŠãƒ¼ã€‚</font><font style="vertical-align: inherit;">ç§ã®è¨˜äº‹ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Singletonã‚’å‘¼ã³å‡ºã™ã¨ãã«æœªå®šç¾©ã®å‹•ä½œã‚’å›é¿ã™ã‚‹ãŸã‚ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã€ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SingletonSharedã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’å®Ÿè£…ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±é€š/ Impl / WriteToConsoleListener.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;mutex&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WriteToConsoleListener</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Listener<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:<font></font>
    WriteToConsoleListener(<span class="hljs-keyword">const</span> WriteToConsoleListener&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    WriteToConsoleListener(WriteToConsoleListener&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    WriteToConsoleListener&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> WriteToConsoleListener&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    WriteToConsoleListener&amp; <span class="hljs-keyword">operator</span>=(WriteToConsoleListener&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
<font></font>
    ~WriteToConsoleListener() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;WriteToConsoleListener&gt; <span class="hljs-title">instance</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    <span class="hljs-comment">// blocking</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processData</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;<span class="hljs-keyword">const</span> Data&gt; data)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    WriteToConsoleListener();<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::mutex _mutex;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace Common</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±é€š/ Impl / WriteToConsoleListener.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"WriteToConsoleListener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {<font></font>
WriteToConsoleListener::WriteToConsoleListener() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
WriteToConsoleListener::~WriteToConsoleListener()<font></font>
{<font></font>
    <span class="hljs-keyword">auto</span> lock = <span class="hljs-built_in">std</span>::lock_guard(_mutex);
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;WriteToConsoleListener&gt; <span class="hljs-title">WriteToConsoleListener::instance</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">auto</span> inst = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;WriteToConsoleListener&gt;(<span class="hljs-keyword">new</span> WriteToConsoleListener);
    <span class="hljs-keyword">return</span> inst;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">WriteToConsoleListener::processData</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;<span class="hljs-keyword">const</span> Data&gt; data)</span>
</span>{
    <span class="hljs-keyword">if</span> (data) {
        <span class="hljs-keyword">auto</span> lock = <span class="hljs-built_in">std</span>::lock_guard(_mutex);
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; *data &lt;&lt; <span class="hljs-built_in">std</span>::flush;<font></font>
    }<font></font>
}<font></font>
<font></font>
} <span class="hljs-comment">// namespace Common</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦æœ€å¾Œã«ã€æœ€åˆã®ã‚¾ãƒ³ãƒ“ã¯ã€æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§æœ€ã‚‚ç‹¬å‰µçš„ã§ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager, <span class="hljs-keyword">public</span> <span class="hljs-built_in">std</span>::enable_shared_from_this&lt;Zomby&gt;<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Zomby();<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::atomic&lt;<span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;<font></font>
    Semaphore _semaphore = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">Zomby::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt;(<span class="hljs-keyword">new</span> Zomby());<font></font>
}<font></font>
<font></font>
Zomby::Zomby() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    _semaphore = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.detach();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ã¯ãƒ©ãƒ ãƒ€é–¢æ•°ã‚’åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã—ã€å®šæœŸçš„ã«æ–‡å­—åˆ—ã‚’ãƒªã‚¹ãƒŠãƒ¼ã«é€ä¿¡ã—ã¾ã™ã€‚ä»•äº‹ç”¨ã®ãƒ©ãƒ ãƒ€é–¢æ•°ã«ã¯ã€ã‚¾ãƒ³ãƒ“ã‚¯ãƒ©ã‚¹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã‚ã‚‹ã‚»ãƒãƒ•ã‚©ã¨ãƒªã‚¹ãƒŠãƒ¼ãŒå¿…è¦ã§ã™ã€‚ãƒ©ãƒ ãƒ€é–¢æ•°ã¯ãã‚Œã‚‰ã‚’å€‹åˆ¥ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¾ã›ã‚“ãŒã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¢ã‚°ãƒªã‚²ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ©ãƒ ãƒ€é–¢æ•°ãŒå®Œäº†ã™ã‚‹å‰ã«ã‚¾ãƒ³ãƒ“ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç ´æ£„ã™ã‚‹ã¨ã€æœªå®šç¾©ã®å‹•ä½œãŒç™ºç”Ÿã—ã¾ã™ã€‚ã“ã‚Œã‚’å›é¿ã™ã‚‹ãŸã‚ã«ã€ãƒ©ãƒ ãƒ€é–¢æ•°ã¯shared_from_thisï¼ˆï¼‰ã®å¼·åŠ›ãªã‚³ãƒ”ãƒ¼ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã¯ã€ã‚»ãƒãƒ•ã‚©ãŒfalseã«è¨­å®šã•ã‚Œã€ãã®å¾Œã€ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å¯¾ã—ã¦detachï¼ˆï¼‰ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚ã‚»ãƒãƒ•ã‚©ã‚’è¨­å®šã™ã‚‹ã¨ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã«ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ãŒæŒ‡ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã¯ã€detachï¼ˆï¼‰ã§ã¯ãªãã€joinï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
...ãã—ã¦ã€è¨±å®¹ã§ããªã„ã‹ã‚‚ã—ã‚Œãªã„ç„¡æœŸé™ã«å®Ÿè¡Œã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ã“ã‚Œã¯RAIIã®é•åã§ã™ã€‚</font><font style="vertical-align: inherit;">RAIIã¯ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’è§£æ”¾ã—ãŸå¾Œã§ã®ã¿ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’çµ‚äº†ã™ã‚‹ã“ã¨ã«ãªã£ã¦ã„ãŸï¼</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å³å¯†ã«è¨€ãˆã°-ã¯ã„ã€ã‚¾ãƒ³ãƒ“ã¯ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã¯ãªã</font><font style="vertical-align: inherit;">ã€ãƒªã‚½ãƒ¼ã‚¹ã®ãƒªãƒªãƒ¼ã‚¹ã‚’</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿè¡Œ</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">ã—ã€ãƒªãƒªãƒ¼ã‚¹ãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ã‚’</font></b><font style="vertical-align: inherit;">å”¯ä¸€ã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¿è¨¼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã„ã¤ã‹ç”Ÿç”£ã•ã‚ŒãŸ-å¤šåˆ†ã™ãã«ã€ã¾ãŸã¯å¤šåˆ†æœ¬å½“ã«ã§ã¯ãªã„ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€ãƒ¡ã‚¤ãƒ³ãŒæ—©ãä½œæ¥­ã‚’çµ‚äº†ã™ã‚‹å¯èƒ½æ€§ã•ãˆã‚ã‚Šã¾ã™-ãã®å¾Œã€ã‚¹ãƒ¬ãƒƒãƒ‰ã¯ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦å¼·åˆ¶çš„ã«ã‚¯ãƒªã‚¢ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—å®Ÿéš›ã«ã¯ã€ã€Œæ­£ã—ã„ã€RAIIã¨ã€Œé–“é•ã£ãŸã€RAIIã®é–“ã®ç·šã¯éå¸¸ã«ç´°ã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãŸã¨ãˆã°ã€ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§std :: filesystem :: removeï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã™ã€Œæ­£ã—ã„ã€RAIIã¯ã€ãã®åˆ¶å¾¡ã‚’è¿”ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚æ›¸ãè¾¼ã¿ã‚³ãƒãƒ³ãƒ‰ãŒã¾ã æ®ç™ºæ€§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã„ãšã‚Œã‹ã«ã‚ã‚Šã€æ­£ç›´ã«ãƒãƒ¼ãƒ‰ãƒ‡ã‚£ã‚¹ã‚¯ã®ç£æ°—ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãè¾¼ã¾ã‚Œãªã„ç¬é–“ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;chrono&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Impl/WriteToConsoleListener.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby/SimpleZomby.h"</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> writeToConsoleListener = Common::WriteToConsoleListener::instance();<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> simpleZomby = SimpleZomby::Zomby::create();<font></font>
        simpleZomby-&gt;runOnce(writeToConsoleListener);<font></font>
<font></font>
        <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">4500</span>));<font></font>
    } <span class="hljs-comment">// Zomby should be killed here</span><font></font>
<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-string">"============================================================\n"</span>
            &lt;&lt; <span class="hljs-string">"|                      Zomby was killed                    |\n"</span>
            &lt;&lt; <span class="hljs-string">"============================================================\n"</span>;
        <span class="hljs-keyword">if</span> (writeToConsoleListener) {<font></font>
            writeToConsoleListener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">5000</span>));<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‡ºåŠ›ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ã‚¾ãƒ³ãƒ“ã¯ã‚¹ã‚³ãƒ¼ãƒ—ã‚’é›¢ã‚ŒãŸå¾Œã§ã‚‚æ©Ÿèƒ½ã—ç¶šã‘ã¾ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ã‚¾ãƒ³ãƒ“ã¾ãŸã¯WriteToConsoleListenerã®ã„ãšã‚Œã«å¯¾ã—ã¦ã‚‚ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ãŒã‚ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€ã“ã®å ´åˆã®ãƒªã‚½ãƒ¼ã‚¹ã¯å®Ÿè¡Œã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœæ­¢ã™ã‚‹ã¯ãšã ã£ãŸã‚³ãƒ¼ãƒ‰ã¯ã€å¼•ãç¶šãåˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§æ©Ÿèƒ½ã—ã¾ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WriteToConsoleListenerãƒªãƒ¼ã‚¯ã¯ã€ç§ã®è¨˜äº‹ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Singletonã‚’å‘¼ã³å‡ºã™ã¨ãã«ä¸ç¢ºå®šãªå‹•ä½œã‚’å›é¿</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã‚‹ã€ã®SingletonWeakãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§é˜²ãã“ã¨ãŒã§ãã¾ã—ãŸãŒ</font><font style="vertical-align: inherit;">ã€ç§ã¯æ„å›³çš„ã«ã—ã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mg/qu/e3/mgque3fstboi4ot2hvdwniafixe.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“ã‹ã‚‰ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”»åƒ</font><font style="vertical-align: inherit;">ï¼‰</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªãœã€Œã‚¾ãƒ³ãƒ“ã€ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½¼ãŒæ®ºã•ã‚ŒãŸã®ã§ã€å½¼ã¯ã¾ã ç”Ÿãã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€å‰ã®ä¾‹ã®å¾ªç’°å‚ç…§ã¨ã©ã®ã‚ˆã†ã«ç•°ãªã‚Šã¾ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å¤±ã‚ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã¯å˜ãªã‚‹ãƒ¡ãƒ¢ãƒªã®ä¸€éƒ¨ã§ã¯ãªãã€ãã‚Œã‚’èµ·å‹•ã—ãŸã‚¹ãƒ¬ãƒƒãƒ‰ã¨ã¯ç„¡é–¢ä¿‚ã«ç‹¬ç«‹ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚‚ã®ã§ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œã‚¾ãƒ³ãƒ“ã€ã‚’ç ´å£Šã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚¹ã‚³ãƒ¼ãƒ—ã‚’é›¢ã‚ŒãŸå¾Œï¼ˆã¤ã¾ã‚Šã€ã‚¾ãƒ³ãƒ“ã«å¯¾ã™ã‚‹å¤–éƒ¨ã®å¼·ã„å‚ç…§ã¨å¼±ã„å‚ç…§ã‚’ã™ã¹ã¦ç ´æ£„ã—ãŸå¾Œï¼‰-ä¸å¯èƒ½ã§ã™ã€‚ã‚¾ãƒ³ãƒ“ã¯ã€è‡ªåˆ†è‡ªèº«ã‚’ç ´å£Šã™ã‚‹ã“ã¨ã‚’æ±ºå®šã—ãŸã¨ãã«ç ´å£Šã•ã‚Œã¾ã™ï¼ˆãã†ã§ã™ã€ãã‚Œã¯æ´»ç™ºãªè¡Œå‹•ã‚’ä¼´ã†ã‚‚ã®ã§ã™ï¼‰ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çµ‚äº†æ™‚ã«ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ãŒã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã¾ã§å­˜ç¶šã—ã¾ã™ã€‚ã‚‚ã¡ã‚ã‚“ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯ã‚¾ãƒ³ãƒ“ã‚³ãƒ¼ãƒ‰ã®çµ‚äº†æ¡ä»¶ã«ä½•ã‚‰ã‹ã®å½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã®å½±éŸ¿ã¯é–“æ¥çš„ã§å®Ÿè£…ã«ä¾å­˜ã—ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã—ã¦ã€ã‚¹ã‚³ãƒ¼ãƒ—ã‚’é›¢ã‚Œã‚‹å‰ã«ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’æ˜ç¤ºçš„ã«å‘¼ã³å‡ºã™ã“ã¨ã¯ã§ãã¾ã™ãŒã€ã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã‚ˆã£ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç¹°ã‚Šè¿”ã—ç ´æ£„ã•ã‚Œã‚‹ãŸã‚ã€æœªå®šç¾©ã®å‹•ä½œã‚’å›é¿ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã¯RAIIã¨ã®æˆ¦ã„ã§ã™ã€‚ã¾ãŸã¯ã€æ˜ç¤ºçš„ãªåˆæœŸåŒ–è§£é™¤ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™-ã“ã‚Œã¯RAIIã®æ‹’å¦ã§ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’é–‹å§‹ã—ã¦ã‹ã‚‰detachï¼ˆï¼‰ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ã®å ´åˆã¨ã©ã†é•ã†ã®ã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚¾ãƒ³ãƒ“ã®å ´åˆã€detachï¼ˆï¼‰ã®å˜ç´”ãªå‘¼ã³å‡ºã—ã¨ã¯å¯¾ç…§çš„ã«ã€ãƒ•ãƒ­ãƒ¼ã‚’åœæ­¢ã™ã‚‹ã¨ã„ã†è€ƒãˆãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã ã‘ã§ã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚é©åˆ‡ãªã‚¢ã‚¤ãƒ‡ã‚¢ãŒã‚ã‚‹ã¨ã€å•é¡Œã‚’éš ã™ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹ã¯ã¾ã åˆæˆã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éƒ¨åˆ†çš„ã«ã€‚</font><font style="vertical-align: inherit;">ã“ã®å˜ç´”ãªä¾‹ã§ã¯ã€shared_from_thisï¼ˆï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ååˆ†ãªç†ç”±ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãŸã¨ãˆã°ã€weak_from_thisï¼ˆï¼‰ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ãŸã‚Šã€ã‚¯ãƒ©ã‚¹ã®ã™ã¹ã¦ã®å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ãŸã‚Šã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€ã‚¿ã‚¹ã‚¯ãŒè¤‡é›‘ãªå ´åˆã€ãƒãƒ©ãƒ³ã‚¹ã¯</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shared_from_thisï¼ˆï¼‰ã«</font><font style="vertical-align: inherit;">ã‚·ãƒ•ãƒˆã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Valgrindã€Valgrindï¼</font><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“ã«å¯¾ã™ã‚‹è¿½åŠ ã®é˜²è¡›ç·šãŒã‚ã‚Šã¾ã™ï¼</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚²ã—ã„ã‹ãªã‚ã‚-ã—ã‹ã—ã€Valgrindã¯ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã‚’æ˜ã‚‰ã‹ã«ã—ã¾ã›ã‚“ã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãªãœç§ã¯çŸ¥ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">è¨ºæ–­ã§ã¯ã€</font><font style="vertical-align: inherit;">ã‚·ã‚¹ãƒ†ãƒ æ©Ÿèƒ½ã‚’ç¤ºã™</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œå¤±ã‚ã‚ŒãŸå¯èƒ½æ€§ã®ã‚ã‚‹ã€</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¨ãƒ³ãƒˆãƒªã®ã¿ãŒå­˜åœ¨ã—</font><font style="vertical-align: inherit;">ã¾ã™â€”ç©ºã®ãƒ¡ã‚¤ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ãã¨ã»ã¼åŒã˜é‡ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ¼ãƒ‰å‚ç…§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ä»–ã®å‹•çš„åˆ†æãƒ„ãƒ¼ãƒ«ã®æ–¹ãŒå„ªã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ãŒã€ãã‚Œã§ã‚‚ä¿¡é ¼ã§ãã‚‹å ´åˆã¯ã€ã“ã®ã¾ã¾èª­ã¿é€²ã‚ã¦ãã ã•ã„ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒ†ãƒƒãƒ”ãƒ³ã‚°ã‚¾ãƒ³ãƒ“</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ä¾‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚¹ãƒ†ãƒƒãƒ—resolveDnsName ---&gt; connectTcp ---&gt; establishedSsl ---&gt; sendHttpRequest ---&gt; readHttpReplyã‚’å®Ÿè¡Œã—ã€éåŒæœŸå®Ÿè¡Œã§ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆHTTPSæ¥ç¶šã®å‹•ä½œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å„ã‚¹ãƒ†ãƒƒãƒ—ã«ã¯ç´„1ç§’ã‹ã‹ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steppingzomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SteppingZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager, <span class="hljs-keyword">public</span> <span class="hljs-built_in">std</span>::enable_shared_from_this&lt;Zomby&gt;<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Zomby();<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::atomic&lt;<span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;<font></font>
    Semaphore _semaphore = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">resolveDnsName</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">connectTcp</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">establishSsl</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sendHttpRequest</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">readHttpReply</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SteppingZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steppingzomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SteppingZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> {
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doSomething</span><span class="hljs-params">(Common::Listener&amp; listener, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp;&amp; callingFunctionName)</span>
</span>{<font></font>
    listener.processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(callingFunctionName + <span class="hljs-string">" started\n"</span>));
    <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">1000</span>));<font></font>
    listener.processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(callingFunctionName + <span class="hljs-string">" finished\n"</span>));<font></font>
}<font></font>
} <span class="hljs-comment">// namespace</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SteppingZomby {<font></font>
Zomby::Zomby() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">Zomby::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt;(<span class="hljs-keyword">new</span> Zomby());<font></font>
}<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    _semaphore = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.detach();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SteppingZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;resolveDnsName();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;connectTcp();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;establishSsl();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;sendHttpRequest();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;readHttpReply();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::resolveDnsName</span><span class="hljs-params">()</span>
</span>{<font></font>
    doSomething(*_listener, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(<span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name()) + <span class="hljs-string">"::"</span> + __func__);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::connectTcp</span><span class="hljs-params">()</span>
</span>{<font></font>
    doSomething(*_listener, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(<span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name()) + <span class="hljs-string">"::"</span> + __func__);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::establishSsl</span><span class="hljs-params">()</span>
</span>{<font></font>
    doSomething(*_listener, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(<span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name()) + <span class="hljs-string">"::"</span> + __func__);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::sendHttpRequest</span><span class="hljs-params">()</span>
</span>{<font></font>
    doSomething(*_listener, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(<span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name()) + <span class="hljs-string">"::"</span> + __func__);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::readHttpReply</span><span class="hljs-params">()</span>
</span>{<font></font>
    doSomething(*_listener, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(<span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name()) + <span class="hljs-string">"::"</span> + __func__);<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SteppingZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;chrono&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SteppingZomby/SteppingZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Impl/WriteToConsoleListener.h"</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> writeToConsoleListener = Common::WriteToConsoleListener::instance();<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> steppingZomby = SteppingZomby::Zomby::create();<font></font>
        steppingZomby-&gt;runOnce(writeToConsoleListener);<font></font>
<font></font>
        <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">1500</span>));<font></font>
    } <span class="hljs-comment">// Zombies should be killed here</span><font></font>
<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-string">"============================================================\n"</span>
            &lt;&lt; <span class="hljs-string">"|                      Zomby was killed                    |\n"</span>
            &lt;&lt; <span class="hljs-string">"============================================================\n"</span>;
        <span class="hljs-keyword">if</span> (writeToConsoleListener) {<font></font>
            writeToConsoleListener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">5000</span>));<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>N13SteppingZomby5ZombyE::resolveDnsName started<br>
N13SteppingZomby5ZombyE::resolveDnsName finished<br>
N13SteppingZomby5ZombyE::connectTcp started<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N13SteppingZomby5ZombyE::connectTcp finished<br>
N13SteppingZomby5ZombyE::establishSsl started<br>
N13SteppingZomby5ZombyE::establishSsl finished<br>
N13SteppingZomby5ZombyE::sendHttpRequest started<br>
N13SteppingZomby5ZombyE::sendHttpRequest finished<br>
N13SteppingZomby5ZombyE::readHttpReply started<br>
N13SteppingZomby5ZombyE::readHttpReply finished<br>
N13SteppingZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ã®ä¾‹ã®ã‚ˆã†ã«ã€runOnceï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã™ã¨å¾ªç’°å‚ç…§ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ä»Šå›ã¯ZombyãŠã‚ˆã³WriteToConsoleListenerãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŒ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘¼ã³å‡ºã•ã‚Œã¾ã—ãŸã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒçµ‚äº†ã™ã‚‹ã¾ã§ã€ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãŒæ­£ã—ãè§£æ”¾ã•ã‚Œã¾ã—ãŸã€‚ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã¯ç™ºç”Ÿã—ã¦ã„ã¾ã›ã‚“ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã‚Œã§å•é¡Œã¯ä½•ã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å•é¡Œã¯ã€ã‚¾ãƒ³ãƒ“ã®å¯¿å‘½ãŒé•·ã™ãã‚‹ã“ã¨ã§ã™ã€‚ã‚¾ãƒ³ãƒ“ã¸ã®å¤–éƒ¨ã®å¼·ã„ãƒªãƒ³ã‚¯ã¨å¼±ã„ãƒªãƒ³ã‚¯ãŒã™ã¹ã¦ç ´å£Šã•ã‚Œã¦ã‹ã‚‰ç´„3ç§’åŠã§ã™ã€‚å½¼ãŒç”Ÿãã‚‹ã¹ãã ã£ãŸã‚ˆã‚Šã‚‚ç´„3ç§’é•·ã„ã€‚ãã—ã¦ã“ã‚Œã¾ã§ãšã£ã¨ã€å½¼ã¯HTTPSæ¥ç¶šã®å®Ÿè£…ã‚’ä¿ƒé€²ã™ã‚‹ã“ã¨ã«å¾“äº‹ã—ã¦ã„ã¾ã—ãŸã€‚çµæœãŒå¿…è¦ãªããªã£ãŸã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€‚å„ªã‚ŒãŸãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚¾ãƒ³ãƒ“ã‚’é˜»æ­¢ã—ã‚ˆã†ã¨ã—ãŸã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã‚ã€ãã‚Œã«ã¤ã„ã¦è€ƒãˆã¦ãã ã•ã„ã€ç§ãŸã¡ã¯ã‚ãªãŸãŒå¿…è¦ã¨ã—ãªã„ç­”ãˆã‚’å¾—ã¾ã—ãŸ...</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®HTTPSæ¥ç¶šã®å ´åˆã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ãŸã¡ã®å´</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®çµæœ</font><font style="vertical-align: inherit;">ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼š</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ãƒ¡ãƒ¢ãƒªæ¶ˆè²»; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -CPUæ¶ˆè²»ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -TCPãƒãƒ¼ãƒˆã®æ¶ˆè²»ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -é€šä¿¡ãƒãƒ£ãƒãƒ«ã®å¸¯åŸŸå¹…ï¼ˆè¦æ±‚ã¨å¿œç­”ã®ä¸¡æ–¹ãŒãƒ¡ã‚¬ãƒã‚¤ãƒˆã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -äºˆæœŸã—ãªã„ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚ˆã‚Šé«˜ã„ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å‹•ä½œã‚’æ··ä¹±ã•ã›ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™-é–“é•ã£ãŸå®Ÿè¡Œãƒ–ãƒ©ãƒ³ãƒã¸ã®é·ç§»ã¾ãŸã¯æœªå®šç¾©ã®å‹•ä½œã¾ã§å¿œç­”å‡¦ç†ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã™ã§ã«ç ´å£Šã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãƒªãƒ¢ãƒ¼ãƒˆå´</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå¿˜ã‚Œãªã„ã§ãã ã•ã„-HTTPSãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯èª°ã‹ã‚’å¯¾è±¡ã¨ã—ãŸã‚‚ã®ã§ã™ï¼‰-ã¾ã£ãŸãåŒã˜ãƒªã‚½ãƒ¼ã‚¹ã®æµªè²»ã§ã‚ã‚Šã€ãã‚ŒãŒå¯èƒ½ã§ã™ï¼š</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ä¼æ¥­ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§çŒ«ã®å†™çœŸã‚’å…¬é–‹ã™ã‚‹ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ã‚­ãƒƒãƒãƒ³ã®åºŠæš–æˆ¿ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -å–å¼•æ‰€ã§ã®å–å¼•æ³¨æ–‡ã®å®Ÿè¡Œ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‹ã‚‰ã®é€é‡‘ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -å¤§é™¸é–“å¼¾é“ãƒŸã‚µã‚¤ãƒ«ã®ç™ºå°„ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯ã€ã‚¾ãƒ³ãƒ“ã¸ã®å¼·ã„ãƒªãƒ³ã‚¯ã¨å¼±ã„ãƒªãƒ³ã‚¯ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¦ã€ã‚¾ãƒ³ãƒ“ã‚’é˜»æ­¢ã—ã‚ˆã†ã¨ã—ã¾ã—ãŸã€‚ HTTPSè¦æ±‚ã®é€²è¡Œã®åœæ­¢ãŒ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç™ºç”Ÿ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã‚‹ã¯ãšã§ã—ãŸ-é…ã™ããšã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ãƒ™ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã¯ã¾ã é€ä¿¡ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ã‚¾ãƒ³ãƒ“ã¯ç‹¬è‡ªã®æ–¹æ³•ã§æ±ºå®šã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯ã€ã‚¾ãƒ³ãƒ“ã®ä»£ã‚ã‚Šã«æ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€ãã‚Œã‚‰ã‚’å†åº¦ç ´å£Šã—ã¦ã€ãƒªã‚½ãƒ¼ã‚¹ã®æµªè²»ã‚’å¢—å¤§ã•ã›ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¶™ç¶šçš„ãªãƒ—ãƒ­ã‚»ã‚¹ï¼ˆWebsocketæ¥ç¶šãªã©ï¼‰ã®å ´åˆã€ãƒªã‚½ãƒ¼ã‚¹ã®æµªè²»ã¯æ•°æ™‚é–“ç¶šãå¯èƒ½æ€§ãŒã‚ã‚Šã€æ¥ç¶šãŒåˆ‡æ–­ã•ã‚ŒãŸã¨ãã«å®Ÿè£…ã«è‡ªå‹•å†æ¥ç¶šãƒ¡ã‚«ãƒ‹ã‚ºãƒ ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€é€šå¸¸ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒåœæ­¢ã™ã‚‹ã¾ã§ç¶šãã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ´ã‚¡ãƒ«ã‚°ãƒªãƒ³ãƒ‰ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒãƒ£ãƒ³ã‚¹ã¯ç„¡ã„ã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ãŒæ­£ã—ãè§£æ”¾ã•ã‚Œã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰ã§ã¯ãªãå¾ŒæœŸã§ã™ãŒã€å®Œå…¨ã«æ­£ã—ã„ã§ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boozdedzomby</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ä¾‹ã§ã¯ã€boost :: asioã‚’æ¨¡å€£ã—ãŸboozd :: azzioãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ¨¡é€ å“ã¯ã‹ãªã‚Šç²—é›‘ã§ã‚ã‚‹ã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€å•é¡Œã®æœ¬è³ªã‚’ç¤ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯é–¢æ•°io_context :: async_readï¼ˆã‚ªãƒªã‚¸ãƒŠãƒ«ã§ã¯ç„¡æ–™ã§ã™ãŒã€æœ¬è³ªã¯å¤‰æ›´ã—ã¾ã›ã‚“ï¼‰ãŒã‚ã‚Šã€ä»¥ä¸‹ã‚’å—ã‘å…¥ã‚Œã¾ã™ã€‚- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡å…ƒã¨ãªã‚‹ã‚¹ãƒˆãƒªãƒ¼ãƒ ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’è“„ç©ã§ãã‚‹ãƒãƒƒãƒ•ã‚¡ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿å–ã‚ŠãŒå®Œäº†ã™ã‚‹ã¨å‘¼ã³å‡ºã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
io_context :: async_readé–¢æ•°ã¯å³åº§ã«å®Ÿè¡Œã•ã‚Œã€å®Ÿè¡Œã®çµæœãŒã™ã§ã«ã‚ã‹ã£ã¦ã„ã‚‹å ´åˆï¼ˆãŸã¨ãˆã°ã€ã‚¨ãƒ©ãƒ¼ï¼‰ã§ã‚ã£ã¦ã‚‚ã€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å‘¼ã³å‡ºã™ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯ã€ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°é–¢æ•°io_context :: runï¼ˆï¼‰ã‹ã‚‰ã®ã¿å‘¼ã³å‡ºã•ã‚Œã¾ã™ï¼ˆã‚ªãƒªã‚¸ãƒŠãƒ«ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ãŒã§ãã‚‹ã¨ã™ãã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«è¨­è¨ˆã•ã‚ŒãŸä»–ã®é–¢æ•°ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> boozd::azzio {
<span class="hljs-keyword">using</span> buffer = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;;<font></font>
} <span class="hljs-comment">// namespace boozd::azzio</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stream.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;optional&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> boozd::azzio {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">stream</span>
{</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-keyword">virtual</span> ~stream() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-built_in">std</span>::optional&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace boozd::azzio</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io_context.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;functional&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;optional&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"buffer.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> boozd::azzio {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">stream</span>;</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">io_context</span>
{</span>
<span class="hljs-keyword">public</span>:<font></font>
    ~io_context();<font></font>
<font></font>
    <span class="hljs-keyword">enum</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">error_code</span> {</span>no_error, good_error, bad_error, unknown_error, known_error, well_known_error};
    <span class="hljs-keyword">using</span> handler = <span class="hljs-built_in">std</span>::function&lt;<span class="hljs-keyword">void</span>(error_code)&gt;;<font></font>
<font></font>
    <span class="hljs-comment">// Start an asynchronous operation to read a certain amount of data from a stream.</span>
    <span class="hljs-comment">// This function is used to asynchronously read a certain number of bytes of data from a stream.</span>
    <span class="hljs-comment">// The function call always returns immediately.</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">async_read</span><span class="hljs-params">(stream&amp; s, buffer&amp; b, handler&amp;&amp; handler)</span></span>;<font></font>
<font></font>
    <span class="hljs-comment">// Run the io_context object's event processing loop.</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:
    <span class="hljs-keyword">using</span> pack = <span class="hljs-built_in">std</span>::tuple&lt;stream&amp;, buffer&amp;&gt;;
    <span class="hljs-keyword">using</span> pack_optional = <span class="hljs-built_in">std</span>::optional&lt;pack&gt;;
    <span class="hljs-keyword">using</span> handler_optional = <span class="hljs-built_in">std</span>::optional&lt;handler&gt;;<font></font>
<font></font>
    pack_optional _pack_optional;<font></font>
    handler_optional _handler_optional;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace boozd::azzio</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io_context.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;chrono&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"io_context.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"stream.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> boozd::azzio {<font></font>
io_context::~io_context()<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">io_context::async_read</span><span class="hljs-params">(stream&amp; s, buffer&amp; b, io_context::handler&amp;&amp; handler)</span>
</span>{<font></font>
    _pack_optional.emplace(s, b);<font></font>
    _handler_optional.emplace(<span class="hljs-built_in">std</span>::move(handler));<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">io_context::run</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">if</span> (_pack_optional &amp;&amp; _handler_optional) {
        <span class="hljs-keyword">auto</span>&amp; [s, b] = *_pack_optional;
        <span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>::chrono;
        <span class="hljs-keyword">auto</span> start = steady_clock::now();
        <span class="hljs-keyword">while</span> (duration_cast&lt;milliseconds&gt;(steady_clock::now() - start).count() &lt; <span class="hljs-number">1000</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> read = s.read())<font></font>
                b.emplace_back(*read);<font></font>
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(milliseconds(<span class="hljs-number">100</span>));<font></font>
        }<font></font>
<font></font>
        (*_handler_optional)(error_code::no_error);<font></font>
    }<font></font>
}<font></font>
} <span class="hljs-comment">// namespace boozd::azzio</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ©ãƒ³ãƒ€ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹å”¯ä¸€ã®boozd :: azzio ::ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®å®Ÿè£…ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impl / random_stream.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"boozd/azzio/stream.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> boozd::azzio {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">random_stream</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> stream<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:<font></font>
    ~random_stream() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-built_in">std</span>::optional&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">read</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span></span>;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace boozd::azzio</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impl / random_stream.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"random_stream.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> boozd::azzio {<font></font>
boozd::azzio::random_stream::~random_stream()<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::optional&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">random_stream::read</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">if</span> (!(rand() &amp; <span class="hljs-number">0x1</span>))
        <span class="hljs-keyword">return</span> rand();<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::nullopt;<font></font>
}<font></font>
} <span class="hljs-comment">// namespace boozd::azzio</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BoozdedZombyã¯ã€ãƒ©ãƒ ãƒ€é–¢æ•°ã‚’åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ©ãƒ ãƒ€é–¢æ•°ã¯ã€async_readï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã—ã¦ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’ç™»éŒ²ã—ã€ãã®å¾Œã€runï¼ˆï¼‰ã‚’ä½¿ç”¨ã—ã¦boozd :: azzioã®å†…éƒ¨ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã®å¾Œã€boozd :: azzioã®å†…éƒ¨ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’å‘¼ã³å‡ºã™å‰ã§ã‚ã‚Œã°ã„ã¤ã§ã‚‚ãƒãƒƒãƒ•ã‚¡ãƒ¼ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«é›†ç´„ã•ã‚ŒãŸå¤šãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æœ‰åŠ¹æ€§ã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ã«ã€ãƒ©ãƒ ãƒ€é–¢æ•°ã¯shared_from_thisã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BoozdedZomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"boozd/azzio/buffer.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"boozd/azzio/io_context.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"boozd/azzio/impl/random_stream.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> BoozdedZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager, <span class="hljs-keyword">public</span> <span class="hljs-built_in">std</span>::enable_shared_from_this&lt;Zomby&gt;<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Zomby();<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::atomic&lt;<span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    Semaphore _semaphore = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;<font></font>
    boozd::azzio::random_stream _stream;<font></font>
    boozd::azzio::buffer _buffer;<font></font>
    boozd::azzio::io_context _context;<font></font>
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace BoozdedZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boozdedzomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"boozd/azzio/impl/random_stream.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"BoozdedZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> BoozdedZomby {<font></font>
Zomby::Zomby() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">Zomby::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt;(<span class="hljs-keyword">new</span> Zomby());<font></font>
}<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    _semaphore = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.detach();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"BoozdedZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()]() {
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_semaphore &amp;&amp; shis-&gt;_listener) {
            <span class="hljs-keyword">auto</span> handler = [shis](<span class="hljs-keyword">auto</span> errorCode) {
                <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; errorCode == boozd::azzio::io_context::error_code::no_error) {
                    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
                    buf &lt;&lt; <span class="hljs-string">"BoozdedZomby has got a fresh data: "</span>;
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> <span class="hljs-keyword">const</span> &amp;elem : shis-&gt;_buffer)<font></font>
                        buf &lt;&lt; elem &lt;&lt; <span class="hljs-string">' '</span>;<font></font>
                    buf &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
                    shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
                }<font></font>
            };<font></font>
            shis-&gt;_buffer.clear();<font></font>
            shis-&gt;_context.async_read(shis-&gt;_stream, shis-&gt;_buffer, handler);<font></font>
            shis-&gt;_context.run();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
} <span class="hljs-comment">// namespace BoozdedZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;chrono&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"BoozdedZomby/BoozdedZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Impl/WriteToConsoleListener.h"</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> writeToConsoleListener = Common::WriteToConsoleListener::instance();<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> boozdedZomby = BoozdedZomby::Zomby::create();<font></font>
        boozdedZomby-&gt;runOnce(writeToConsoleListener);<font></font>
<font></font>
        <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">4500</span>));<font></font>
    } <span class="hljs-comment">// Zombies should be killed here</span><font></font>
<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-string">"============================================================\n"</span>
            &lt;&lt; <span class="hljs-string">"|                      Zomby was killed                    |\n"</span>
            &lt;&lt; <span class="hljs-string">"============================================================\n"</span>;
        <span class="hljs-keyword">if</span> (writeToConsoleListener) {<font></font>
            writeToConsoleListener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">5000</span>));<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>BoozdedZomby has got a fresh data: 1144108930 101027544 1458777923 1115438165 74243042 <br>
BoozdedZomby has got a fresh data: 143542612 1131570933 <br>
BoozdedZomby has got a fresh data: 893351816 563613512 704877633 <br>
BoozdedZomby has got a fresh data: 1551901393 1399125485 1899894091 937186357 590357944 357571490 <br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
BoozdedZomby has got a fresh data: 1927702196 130060903 1083454666 2118797801 2035308228 824938981 <br>
BoozdedZomby has got a fresh data: 2020739063 1635339425 34075629 <br>
BoozdedZomby has got a fresh data: 2146319451 500782188 1269406752 884936716 892053144 <br>
BoozdedZomby has got a fresh data: 330111137 1723153177 1070477904 <br>
BoozdedZomby has got a fresh data: 343098142 280090412 589673557 889688008 2014119113 388471006 <br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
run_onceï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã—ãŸçµæœã€å¾ªç’°å‚ç…§ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“ã¯è¦–ç•Œã‚’é›¢ã‚ŒãŸå¾Œã‚‚åƒãç¶šã‘ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¸­ã«ä½œæˆã•ã‚ŒãŸå¤šãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯å‘¼ã³å‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸï¼š</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -boozdedZomby; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -writeToConsoleListener; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ã‚¾ãƒ³ãƒ“ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ãŒã‚ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ä¾‹ã¯å‰ã®ä¾‹ã¨ã©ã†é•ã†ã®ã§ã™ã‹ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã«ã‹ãªã‚Šè¿‘ã„ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã‚‚ã¯ã‚„åˆæˆä¾‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã¯ã€boost :: asioã‚’ä½¿ç”¨ã™ã‚‹ã¨è‡ªç„¶ã«ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã•ã‚‰ã«ã€å¼±ã„ãƒªãƒ³ã‚¯ã‚’å„ªå…ˆã—ã¦å¼·ã„ãƒªãƒ³ã‚¯ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã ã‘ã§ã¯ä¿®æ­£ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒãƒƒãƒ•ã‚¡ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼‰ã®æœ‰åŠ¹æ€§ãŒå¦¨ã’ã‚‰ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ´ã‚¡ãƒ«ã‚°ãƒªãƒ³ãƒ‰ï¼Ÿ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ²¿ã£ã¦ã€‚</font><font style="vertical-align: inherit;">ãƒªãƒ¼ã‚¯ã‚’æ¤œå‡ºã™ã‚‹ã“ã¨ã ã£ãŸã‚ˆã†ã§ã™ãŒã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡ç”Ÿã®ã‚¾ãƒ³ãƒ“</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å•é¡Œã¯ã¯ã‚‹ã‹ã«å›°é›£ã§ã™ï¼</font><font style="vertical-align: inherit;">ã ã‹ã‚‰èª°ã‚‚æ›¸ã„ã¦ã„ãªã„ï¼</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½¼ãŒæ›¸ã„ã¦ã„ã‚‹ã‚ˆã†ã«ã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://www.boost.org/doc/libs/master/libs/beast/example/http/client/async/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹Websocket </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://www.boost.org/doc/libs/master/libs/beast/example/http/client/async/"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ä¾‹</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å…¬å¼ã®ãƒ–ãƒ¼ã‚¹ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€BoozdedZomby + SteppingZombyãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã®è¨˜è¿°æ–¹æ³•ã‚’èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å½¼ã‚’æ­¢ã‚ã‚‹ã“ã¨ã¯ä¸å¯èƒ½ã§ã™ãŒã€èª°ã‚‚è©¦ã¿ã¦ã„ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">å…·ä½“çš„ã«ã¯ã€ãƒ‡ãƒ¢ã‚³ãƒ¼ãƒ‰ã§ã¯ã€ã‚¾ãƒ³ãƒ“ã®ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ãŒã€ã“ã‚Œã‚’ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã«è»¢é€ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã§ã€ã‚¨ãƒƒã‚¸ã«æ²¿ã£ã¦ã€ãŠãã‚‰ããƒ€ãƒ¼ã‚¯ã‚µã‚¤ãƒ‰ã§ã•ãˆæ­©ã„ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boost :: asio :: io_contextã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç ´å£Šã™ã‚‹ã“ã¨ã§ã€ã‚¾ãƒ³ãƒ“ã‚’æ­¢ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...é€”ä¸­ã§ã€ã“ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ä½ã‚“ã§ã„ã‚‹åˆ¥ã®nã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆãŠãã‚‰ãã‚¾ãƒ³ãƒ“ã§ã¯ãªã„ï¼‰ã‚’ç ´å£Šã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®ä»–ã®ä¾‹ï¼š</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ãƒªã‚½ãƒ¼ã‚¹ã§ã®åŒæ§˜ã®ä¾‹ã‚’æ¬¡ã«ç¤ºã—ã¾ã™ã€‚</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“ã§ã¯ã€äººãŒstackoverflowã«ã¤ã„ã¦è³ªå•ã—ã€ã‚³ãƒ¼ãƒ‰ã‚’ã‚ˆã‚Šã‚¾ãƒ³ãƒ“ã«ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€å½¼ã®æœ€æ„›ã®ã‚¾ãƒ³ãƒ“ãŒæ©Ÿèƒ½ã—ãªã„ç†ç”±ã‚’å°‹ã­ã‚‹åˆ¥ã®ã‚‚ã®ã§ã™ã€‚</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“ã‚’æ“ä½œã—ã¦ã„ã‚‹ã¨ãã®ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã«é–¢ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ€–ãŒã£ã¦ã„ã‚‹ç”·æ€§ãŒã„ã¾ã™</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµè«–</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚‚ã¡ã‚ã‚“ã€è¨˜äº‹ã§ã¯ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€ã®ã™ã¹ã¦ã®ç¨®é¡ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®ã‚¿ã‚¤ãƒ—ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã®å½¢ã§ã‚‚ã€æ–°ã—ã„ç‹¬ç«‹ã—ãŸã‚¿ã‚¤ãƒ—ã®å½¢ã§ã‚‚è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€ã‚³ãƒ¼ãƒ‰å†…ã§std ::ã‚¹ãƒ¬ãƒƒãƒ‰ãŒèµ·å‹•ã•ã‚ŒãŸã¨ãã ã‘ã§ãªãã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½œæ¥­ã®ã“ã®éƒ¨åˆ†ã‚’å¼•ãç¶™ãå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¾ªç’°ãƒªãƒ³ã‚¯ã¯ã€ä¾‹ã‚ˆã‚Šã‚‚é•·ããªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã€ã¾ãŸã¯å®šæœŸçš„ãªãƒãƒ¼ãƒªãƒ³ã‚°ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¼ãƒªãƒ³ã‚°ã«åŸºã¥ãã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¯ã™ã¹ã¦ãã‚Œã»ã©é‡è¦ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><b><font style="vertical-align: inherit;">å¸¸ã«</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é‡è¦ã§ã™</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãã‚Œè‡ªä½“ã¸ã®å¼·ã„å‚ç…§ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ã»ã¨ã‚“ã©ã®å ´åˆstd :: enable_shared_from_thisã‚’ä½¿ç”¨ã—ã¦ç”Ÿæˆã•ã‚Œã¾ã™ãŒã€å¤–éƒ¨ã‹ã‚‰æä¾›ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆå¼±ã„ãƒªãƒ³ã‚¯ã¨ã—ã¦å«ã‚ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™-ã‚¯ãƒ©ã‚¹è‡ªä½“ãŒå¼·åŠ›ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼‰ã€‚ãŠãã‚‰ãã€ã“ã®ãƒ«ãƒ¼ãƒ«ã«ã¯ã‚¨ã‚­ã‚¾ãƒãƒƒã‚¯ãªä¾‹å¤–ãŒ1ã¤ã ã‘ã‚ã‚Šã¾ã™ã€‚å¤–éƒ¨ã‚³ãƒ¼ãƒ‰ãŒã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®å¼·ã„å‚ç…§ã¾ãŸã¯å¼±ã„å‚ç…§ã‚’ãã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®1ã¤ã«æä¾›ã™ã‚‹å ´åˆã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‹•çš„ã‚³ãƒ¼ãƒ‰åˆ†æã§ã¯ã€ã“ã®ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€ç‰¹ã«ãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®SteppingZombyã‚’æ¤œå‡ºã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚é™çš„åˆ†æã®å¸Œæœ›ã‚‚ã»ã¨ã‚“ã©ã‚ã‚Šã¾ã›ã‚“-shared_from_thisã®æ­£ã—ã„ä½¿ç”¨ã¨èª¤ã£ãŸä½¿ç”¨ã®é–“ã«ã¯éå¸¸ã«ç´°ã„ç·šãŒã‚ã‚Šã¾ã™ï¼ˆã“ã®è¨˜äº‹ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€éå¸¸ã«å°ã•ãªä¿®æ­£ã‚’åŠ ãˆã‚‹ã“ã¨ã§ä¿®æ­£ã§ãã¾ã™-åˆè¨ˆ1è¡Œã‹ã‚‰6è¡Œã®ã‚³ãƒ¼ãƒ‰ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è‡ªå‹•ãƒ†ã‚¹ãƒˆã¯ãã‚Œã‚’ç‰¹å®šã—ã€é™¤å»ã®æ­£ã—ã•ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ãŒã€ãã®ãŸã‚ã«ã¯ä½•ã‚’æ¢ã™ã¹ãã‹ã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">çµ¶å¯¾ã«çŸ¥ã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚ã¡ã“ã¡ã§æ¤œç´¢ã™ã‚‹ã«ã¯ã€æ‰‹å‹•ã§è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ãŸã‚ã«ã¯ã€std :: enable_shared_from_thisã®ã™ã¹ã¦ã®ä½¿ç”¨æ³•ã‚’å†è€ƒã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™-ãã‚Œã‚‰ã¯</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éå¸¸ã«</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±é™ºã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PSï¼šæŠ•ç¥¨çµæœã«ã‚ˆã‚‹ã¨-ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ’é™¤ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã®è­°è«–ã‚’å«ã‚€åˆ¥ã®è¨˜äº‹ã‚’æº–å‚™ã—ã¾ã™ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja471310/index.html">ITã®æ•™è‚²ã ã‘ã§ãªãã€å°‚é–€å®¶ã«ã¤ã„ã¦ã®ç§ã®ä¸»è¦³çš„ãªæ„è¦‹</a></li>
<li><a href="../ja471312/index.html">Spring Professionalèªå®šã®æº–å‚™ã€‚æ˜¥ãƒ–ãƒ¼ãƒ„</a></li>
<li><a href="../ja471318/index.html">9æœˆã®æ©Ÿæ¢°å­¦ç¿’ã¨äººå·¥çŸ¥èƒ½ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆ</a></li>
<li><a href="../ja471320/index.html">ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…å‘ã‘ã®ãƒ„ãƒ¼ãƒ«ï¼šã‚ªãƒ¼ãƒ—ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨æ©Ÿæ¢°å­¦ç¿’ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></li>
<li><a href="../ja471324/index.html">ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ãƒ¢ãƒŠãƒªã‚¶ã‚’å¤¢è¦‹ã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja471330/index.html">æœˆé¢ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€‚ãƒ‘ãƒ¼ãƒˆ2</a></li>
<li><a href="../ja471332/index.html">æœˆé¢ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€‚ãƒ‘ãƒ¼ãƒˆ3</a></li>
<li><a href="../ja471334/index.html">è¦šãˆã‚‹ãŒã€è©°ã‚è¾¼ã¾ãªã„-ã€Œã‚«ãƒ¼ãƒ‰ã§ã€å­¦ã¶</a></li>
<li><a href="../ja471336/index.html">ãƒ›ãƒªãƒãƒ¼ã€‚ãƒ«ãƒãƒƒãƒˆã®æ­´å²ã€‚ãƒ‘ãƒ¼ãƒˆ6.ãƒ­ãƒƒã‚¯ï¼šLurkã€Tapeã€282ndãŠã‚ˆã³Chineseãƒ‘ã‚¹</a></li>
<li><a href="../ja471340/index.html">Drimsim vs Mate 20 Proãƒ©ã‚¦ãƒ³ãƒ‰ï¼ã—ã‹ã—ã€èª°ã®ãŸã‚ã«ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>