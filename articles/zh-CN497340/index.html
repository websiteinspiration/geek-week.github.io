<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“³ ğŸ¬ ğŸ˜¦ COVID-19ï¼šå¦‚ä½•åœæ­¢é˜…è¯»æ–°é—»å¹¶å¼€å§‹åˆ†ææ•°æ® ğŸ–ğŸ» â›ªï¸ ğŸ™‰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼å¤§çº¦ä¸€ä¸ªæœˆå‰ï¼Œæˆ‘ä¸€ç›´æ„Ÿåˆ°ç„¦è™‘ã€‚æˆ‘å¼€å§‹åƒå¾—ä¸å¥½ï¼Œç¡ä¸ç€è§‰ï¼Œä¸æ–­åœ°é˜…è¯»ï¼Œè§‚çœ‹ï¼Œå¬ç€å¤§é‡çš„å¤§æµè¡Œæ–°é—»ã€‚åŸºäºå®ƒä»¬ï¼Œå† çŠ¶ç—…æ¯’è¦ä¹ˆæ•è·äº†æˆ‘ä»¬çš„æ˜Ÿçƒï¼Œè¦ä¹ˆè§£æ”¾äº†æˆ‘ä»¬çš„æ˜Ÿçƒï¼Œæˆ–è€…æ˜¯é˜´è°‹å…±æµä¼š , , , â€¦ 
 

 , , youtube-telegram-instagram-tik-tok ( ) ( ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>COVID-19ï¼šå¦‚ä½•åœæ­¢é˜…è¯»æ–°é—»å¹¶å¼€å§‹åˆ†ææ•°æ®</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497340/"><p><img src="https://habrastorage.org/getpro/habr/post_images/f23/ace/620/f23ace6203f6d13d9c21bd23b03d7872.png" alt="å›¾ç‰‡"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å“ˆHaï¼</font><font style="vertical-align: inherit;">å¤§çº¦ä¸€ä¸ªæœˆå‰ï¼Œæˆ‘ä¸€ç›´æ„Ÿåˆ°ç„¦è™‘ã€‚</font><font style="vertical-align: inherit;">æˆ‘å¼€å§‹åƒå¾—ä¸å¥½ï¼Œç¡ä¸ç€è§‰ï¼Œä¸æ–­åœ°é˜…è¯»ï¼Œè§‚çœ‹ï¼Œå¬ç€å¤§é‡çš„å¤§æµè¡Œæ–°é—»ã€‚</font><font style="vertical-align: inherit;">åŸºäºå®ƒä»¬ï¼Œå† çŠ¶ç—…æ¯’è¦ä¹ˆæ•è·äº†æˆ‘ä»¬çš„æ˜Ÿçƒï¼Œè¦ä¹ˆè§£æ”¾äº†æˆ‘ä»¬çš„æ˜Ÿçƒï¼Œæˆ–è€…æ˜¯é˜´è°‹</font></font><del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±æµä¼š</font></font></del>  ,     ,       ,        â€¦ </p><br>
<p> ,   , youtube-telegram-instagram-tik-tok (  )     ( )      ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>     .</p><br>
<p>     <del> </del>      .   !</p><br>
<p><strong>UPD</strong>:   ''.</p><a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3>   </h3><br>
     COVID-19 â€”     ,   SARS-CoV-2 (2019-nCoV).        â€”    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a></blockquote><p>       ,  ,      .<br>
       . , , . </p><br>
<p>       ,   ,     .</p><br>
<p> : </p><br>
<ul>
<li>[+]  , ,     COVID-19   , [1, 3]</li>
<li>[+]  ,     ()  COVID-19,     Â«Â»   ,</li>
<li>[+]   ,        [2],</li>
<li>[+]              ,</li>
<li>[-]        COVID-19  ,</li>
<li>[+]     github ,   [3].</li>
</ul><br>
<p>               â€“   .      ,        ,   ,      .</p><br>
<p>     .    â€“   â€“  ,    ,        ,   .</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><p>    COVID-19:</p><br>
<pre><code class="plaintext hljs">#'<font></font>
#' Load COVID-19 spread: infected, recovered, and fatal cases<font></font>
#' Source: https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data/csse_covid_19_time_series<font></font>
#'<font></font>
load_covid_spread &lt;- function() {<font></font>
  require(dplyr)<font></font>
  require(data.table)<font></font>
  require(purrr)<font></font>
  require(tidyr)<font></font>
<font></font>
  load_time_series &lt;- function(.case_type) {<font></font>
<font></font>
    path_pattern &lt;- "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_%s_global.csv"<font></font>
<font></font>
    fread(sprintf(path_pattern, .case_type)) %&gt;% <font></font>
      rename(country = `Country/Region`) %&gt;% <font></font>
      select(-c(`Province/State`, Lat, Long)) %&gt;% <font></font>
      group_by(country) %&gt;% <font></font>
      summarise_if(is.numeric, sum) %&gt;% <font></font>
      ungroup %&gt;% <font></font>
      gather(key = "date", value = "n", -country) %&gt;% <font></font>
      mutate(date = mdy(date))<font></font>
  }<font></font>
<font></font>
  dt &lt;- load_time_series("confirmed") %&gt;% rename(confirmed_n = n) %&gt;% <font></font>
    inner_join(<font></font>
      load_time_series("recovered") %&gt;% rename(recovered_n = n),<font></font>
      by = c("country", "date")<font></font>
    ) %&gt;% <font></font>
    inner_join(<font></font>
      load_time_series("deaths") %&gt;% rename(deaths_n = n),<font></font>
      by = c("country", "date")<font></font>
    ) <font></font>
<font></font>
  stopifnot(nrow(dt) &gt; 0)<font></font>
<font></font>
  return(dt)<font></font>
}<font></font>
<font></font>
spread_raw &lt;- load_covid_spread()<font></font>
spread_raw %&gt;% sample_n(10)</code></pre><br>
<p>    :</p><br>
<pre><code class="plaintext hljs">#'<font></font>
#' Load countries stats<font></font>
#' Source: https://ods.ai/competitions/sberbank-covid19-forecast<font></font>
#'<font></font>
load_countries_stats &lt;- function() {<font></font>
  require(dplyr)<font></font>
  require(magrittr)<font></font>
<font></font>
  dt &lt;- fread("https://raw.githubusercontent.com/codez0mb1e/covid-19/master/data/countries.csv")<font></font>
<font></font>
  dt %&lt;&gt;%<font></font>
    select(-c(iso_alpha2, iso_numeric, name, official_name))<font></font>
<font></font>
  stopifnot(nrow(dt) &gt; 0)<font></font>
<font></font>
  return(dt)<font></font>
}<font></font>
<font></font>
countries_raw &lt;- load_countries_stats()<font></font>
countries_raw %&gt;% sample_n(10)</code></pre><br>
<p> :</p><br>
<pre><code class="plaintext hljs">data &lt;- spread_raw %&gt;% <font></font>
  # add country population<font></font>
  inner_join(<font></font>
    countries_raw %&gt;% transmute(ccse_name, country_iso = iso_alpha3, population) %&gt;% filter(!is.na(country_iso)), <font></font>
    by = c("country" = "ccse_name")<font></font>
  ) %&gt;% <font></font>
  # calculate active cases<font></font>
  mutate(<font></font>
    active_n = confirmed_n - recovered_n - deaths_n<font></font>
  ) %&gt;% <font></font>
  # calculate cases per 1M population<font></font>
  mutate_at(<font></font>
    vars(ends_with("_n")),<font></font>
    list("per_1M" = ~ ./population*1e6)<font></font>
  )<font></font>
<font></font>
## Calculte number of days since...<font></font>
get_date_since &lt;- function(dt, .case_type, .n) {<font></font>
  dt %&gt;% <font></font>
    group_by(country) %&gt;% <font></font>
    filter_at(vars(.case_type), ~ . &gt; .n) %&gt;% <font></font>
    summarise(since_date = min(date))<font></font>
}<font></font>
<font></font>
data %&lt;&gt;% <font></font>
  inner_join(<font></font>
    data %&gt;% get_date_since("confirmed_n", 0) %&gt;% rename(since_1st_confirmed_date = since_date),<font></font>
    by = "country"<font></font>
  ) %&gt;% <font></font>
  inner_join(<font></font>
    data %&gt;% get_date_since("confirmed_n_per_1M", 1) %&gt;% rename(since_1_confirmed_per_1M_date = since_date),<font></font>
    by = "country"<font></font>
  ) %&gt;% <font></font>
  inner_join(<font></font>
    data %&gt;% get_date_since("deaths_n_per_1M", .1) %&gt;% rename(since_dot1_deaths_per_1M_date = since_date),<font></font>
    by = "country"<font></font>
  ) %&gt;% <font></font>
  mutate_at(<font></font>
    vars(starts_with("since_")), <font></font>
    list("n_days" = ~ difftime(date, ., units = "days") %&gt;% as.numeric)<font></font>
  ) %&gt;% <font></font>
  mutate_at(<font></font>
    vars(ends_with("n_days")),<font></font>
    list(~ if_else(. &gt; 0, ., NA_real_))<font></font>
  )</code></pre><br>
<p>  :</p><br>
<pre><code class="plaintext hljs">theme_set(theme_minimal())<font></font>
<font></font>
lab_caption &lt;- paste0(<font></font>
  "Data source: Novel Coronavirus (COVID-19) Cases provided by Johns Hopkins University Center for Systems Science. \n",<font></font>
  sprintf("Last updated: %s. ", format(max(data$date), '%d %B, %Y')),<font></font>
  "Source code: github.com/codez0mb1e/covid-19"<font></font>
) <font></font>
<font></font>
filter_countries &lt;- function(dt) dt %&gt;% filter(country_iso %in% c("KOR", "ITA", "RUS", "CHN", "USA"))</code></pre></div></div><br>
<h2 id="absolyutnye-chisla"> </h2><br>
<p><em></em>:       .</p><br>
<p><em></em>:     ,  ,    100   50,      ( )    .</p><br>
<p><em></em>:     (),   .<br>
 :       .</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(data %&gt;% filter_countries, aes(x = date)) +<font></font>
  geom_col(aes(y = confirmed_n), alpha = .9) +<font></font>
<font></font>
  scale_x_date(date_labels = "%d %b", date_breaks = "7 days") +<font></font>
<font></font>
  facet_grid(country ~ .) +<font></font>
<font></font>
  labs(x = "", y = "# of cases", <font></font>
       title = "COVID-19 Spread (over time)", <font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(plot.caption = element_text(size = 8))</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d71/8fb/0a4/d718fb0a4410c0996a74160b08ac9ca8.png" alt="å›¾ç‰‡"></p><br>
<p> ,          ,   :  ,  ,     ,      .   ,    -,  ,      100K .</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(data %&gt;% filter_countries, aes(x = date)) +<font></font>
  geom_col(aes(y = confirmed_n), alpha = .9) +<font></font>
<font></font>
  scale_x_date(date_labels = "%d %b", date_breaks = "7 days") +<font></font>
  scale_y_log10() +<font></font>
<font></font>
  facet_grid(country ~ .) +<font></font>
<font></font>
  labs(x = "", y = "# of cases", <font></font>
       title = "COVID-19 Spread (over time)", <font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(plot.caption = element_text(size = 8))</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/a38/6a9/e69/a386a9e6921dabe427210272b7714493.png" alt="å›¾ç‰‡"></p><br>
<p>   ,      1  .</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(data  %&gt;% filter_countries, aes(x = date)) +<font></font>
  geom_col(aes(y = confirmed_n_per_1M), alpha = .9) +<font></font>
<font></font>
  scale_x_date(date_labels = "%d %b", date_breaks = "7 days") +<font></font>
<font></font>
  facet_grid(country ~ .) +<font></font>
<font></font>
  labs(x = "", y = "# of cases per 1M", <font></font>
       subtitle = "Infected cases per 1 million popultation",<font></font>
       title = "COVID-19 Spread (over time)", <font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(plot.caption = element_text(size = 8))</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/0e1/56d/2c3/0e156d2c38014d7d67411286f4e52d06.png" alt="å›¾ç‰‡"></p><br>
<p>   :</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(data  %&gt;% filter_countries, aes(x = date)) +<font></font>
  geom_col(aes(y = confirmed_n_per_1M), alpha = .9) +<font></font>
<font></font>
  scale_x_date(date_labels = "%d %b", date_breaks = "7 days") +<font></font>
  scale_y_log10() +<font></font>
<font></font>
  facet_grid(country ~ .) +<font></font>
<font></font>
  labs(x = "", y = "# of cases per 1M", <font></font>
       subtitle = "Infected cases per 1 million popultation",<font></font>
       title = "COVID-19 Spread (over time)", <font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(plot.caption = element_text(size = 8))</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/97d/1f8/50e/97d1f850e6ef8ec5deb1d233dac92eed.png" alt="å›¾ç‰‡"></p><br>
<p> ,        Â«Â»   ,       . </p><br>
<h2 id="tochka-otscheta"> </h2><br>
<p><em></em>:           (    )    .</p><br>
<p><em></em>:    (  ,  3,  +200%);  ,       .</p><br>
<p><em></em>:  ,  &gt;1     , &gt;0.1    ,   .</p><br>
<p>       ,     . </p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(<font></font>
  data %&gt;% filter_countries %&gt;% filter(!is.na(since_1st_confirmed_date_n_days)), <font></font>
  aes(x = since_1st_confirmed_date_n_days)<font></font>
  ) +<font></font>
<font></font>
  geom_col(aes(y = confirmed_n), alpha = .9) +<font></font>
  scale_y_log10() +<font></font>
<font></font>
  facet_grid(country ~ .) +<font></font>
<font></font>
  labs(x = "# of days since 1st infected case", y = "# of cases", <font></font>
       subtitle = "Infected cases since 1st infected case",<font></font>
       title = "COVID-19 Spread", <font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(plot.caption = element_text(size = 8))</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/7eb/0ff/2ba/7eb0ff2ba49ad52b657e9ef0399919ab.png" alt="å›¾ç‰‡"></p><br>
<p>      1  ,   ,      1    . </p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(<font></font>
  data %&gt;% filter_countries %&gt;% filter(!is.na(since_1_confirmed_per_1M_date_n_days)), <font></font>
  aes(x = since_1_confirmed_per_1M_date_n_days)<font></font>
  ) +<font></font>
<font></font>
  geom_col(aes(y = confirmed_n_per_1M), alpha = .9) +<font></font>
<font></font>
  scale_y_log10() +<font></font>
  xlim(c(0, 55)) +<font></font>
<font></font>
  facet_grid(country ~ .) +<font></font>
<font></font>
  labs(x = "# of days since 1 infected cases per 1M", y = "# of cases per 1M", <font></font>
       title = "COVID-19 Spread", <font></font>
       subtitle = "Since 1 infected cases per 1 million popultation",<font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(plot.caption = element_text(size = 8))</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/b94/288/4d6/b942884d681ab9fe47bb379cce396222.png" alt="å›¾ç‰‡"></p><br>
<p>     ,         Â«Â»     .</p><br>
<h2 id="kogo-schitaem"> </h2><br>
<p><em></em>:    Â«   Â»     .</p><br>
<p><em></em>:        ,  -      .</p><br>
<p><em></em>:       (       ).</p><br>
<p> ,    , ,       ( ).</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">plot_data &lt;- data %&gt;% <font></font>
  filter_countries %&gt;% <font></font>
  filter(!is.na(since_1_confirmed_per_1M_date_n_days)) %&gt;% <font></font>
  mutate(<font></font>
    confirmed_n_per_1M = confirmed_n_per_1M, <font></font>
    recovered_n_per_1M = -recovered_n_per_1M,<font></font>
    deaths_n_per_1M = -deaths_n_per_1M<font></font>
  ) %&gt;% <font></font>
  select(<font></font>
    country, since_1_confirmed_per_1M_date_n_days, ends_with("_n_per_1M")<font></font>
  ) %&gt;% <font></font>
  gather(<font></font>
    key = "case_state", value = "n_per_1M", -c(country, since_1_confirmed_per_1M_date_n_days, active_n_per_1M)<font></font>
  )<font></font>
<font></font>
ggplot(plot_data, aes(x = since_1_confirmed_per_1M_date_n_days)) +<font></font>
<font></font>
  geom_col(aes(y = n_per_1M, fill = case_state), alpha = .9) +<font></font>
  geom_line(aes(y = active_n_per_1M), color = "#0080FF", size = .25) +<font></font>
<font></font>
  scale_fill_manual(element_blank(), <font></font>
                    labels = c("confirmed_n_per_1M" = "Infected cases", "recovered_n_per_1M" = "Recovered cases", "deaths_n_per_1M" = "Fatal cases"),<font></font>
                    values = c("confirmed_n_per_1M" = "grey", "recovered_n_per_1M" = "gold", "deaths_n_per_1M" = "black")) +<font></font>
<font></font>
  xlim(c(0, 55)) +<font></font>
<font></font>
  facet_grid(country ~ ., scales = "free") +<font></font>
<font></font>
  labs(x = "# of days since 1 infected cases per 1M", y = "# of cases per 1M", <font></font>
       title = "COVID-19 Spread by Countries", <font></font>
       subtitle = "Active cases trend since 1 infected cases per 1 million popultation. \nBlue line - infected cases minus recovered and fatal.\nNegative values indicate recovered and fatal cases.", <font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(<font></font>
    legend.position = "top",<font></font>
    plot.caption = element_text(size = 8)<font></font>
  )</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/028/357/144/02835714416dd79a3125ecd3d648c694.png" alt="å›¾ç‰‡"></p><br>
<p>  ,                .</p><br>
<h2 id="vse-eto-bylo-davno">   </h2><br>
<p><em></em>:        ,      (   10   [  ,    ]).</p><br>
<p><em></em>:     ,    ;   (,             ).  , ,  .</p><br>
<p>     ARIMA    :</p><br>
<div class="spoiler"><b class="spoiler_title">   ARIMA</b><div class="spoiler_text"><pre><code class="plaintext hljs">forecast_cases &lt;- function(.country, .after_date, .forecast_horizont, .fun, ...) {<font></font>
<font></font>
  dt &lt;- data %&gt;% <font></font>
    # filter rows and cols<font></font>
    filter(<font></font>
      country == .country &amp; <font></font>
      date &lt; .after_date<font></font>
    ) %&gt;%<font></font>
    # convert to time-series<font></font>
    arrange(date) %&gt;% <font></font>
    select(active_n_per_1M)<font></font>
<font></font>
  dt %&gt;%  <font></font>
    ts(frequency = 7) %&gt;% <font></font>
    # ARIMA model<font></font>
    .fun(...) %&gt;% <font></font>
    # forecast<font></font>
    forecast(h = .forecast_horizont)<font></font>
}<font></font>
<font></font>
forecast_horizont &lt;- 7<font></font>
after_date &lt;- max(data$date) + days()<font></font>
<font></font>
countries_list &lt;- c("Belgium", "France", "Italy", "Netherlands", "Norway", "Portugal", "Spain", "Switzerland", "US", "Russia", "China", "Korea, South")<font></font>
<font></font>
pred &lt;- countries_list  %&gt;% <font></font>
  map_dfr(<font></font>
    function(.x) {<font></font>
<font></font>
      m &lt;- forecast_cases(.x, after_date, forecast_horizont, auto.arima)<font></font>
<font></font>
      n_days_max &lt;- max(data[data$country == .x, ]$since_1_confirmed_per_1M_date_n_days, na.rm = T)<font></font>
<font></font>
      tibble(<font></font>
        country = rep(.x, forecast_horizont),<font></font>
        since_1_confirmed_per_1M_date_n_days = seq(n_days_max + 1, n_days_max + forecast_horizont, by = 1),<font></font>
        pred = m$mean %&gt;% as.numeric %&gt;% round %&gt;% as.integer,<font></font>
        data_type = "Forecast"<font></font>
      )<font></font>
    }<font></font>
  )<font></font>
<font></font>
plot_data &lt;- data %&gt;% <font></font>
  filter(country %in% countries_list) %&gt;% <font></font>
  transmute(<font></font>
    country, active_n_per_1M, since_1_confirmed_per_1M_date_n_days, <font></font>
    data_type = "Historical data"<font></font>
  ) %&gt;% <font></font>
  bind_rows(<font></font>
    pred %&gt;% rename(active_n_per_1M = pred)<font></font>
  ) %&gt;% <font></font>
  mutate(<font></font>
    double_every_14d = (1 + 1/14)^since_1_confirmed_per_1M_date_n_days, # double every 2 weeks<font></font>
    double_every_7d = (1 + 1/7)^since_1_confirmed_per_1M_date_n_days, # double every week<font></font>
    double_every_3d = (1 + 1/3)^since_1_confirmed_per_1M_date_n_days, # double every 3 days<font></font>
    double_every_2d = (1 + 1/2)^since_1_confirmed_per_1M_date_n_days # double every 2 days<font></font>
  )<font></font>
<font></font>
active_n_per_1M_last &lt;- plot_data %&gt;% <font></font>
  group_by(country) %&gt;% <font></font>
  arrange(desc(since_1_confirmed_per_1M_date_n_days)) %&gt;% <font></font>
  filter(row_number() == 1) %&gt;% <font></font>
  ungroup<font></font>
<font></font>
plot_data %&lt;&gt;% <font></font>
  left_join(<font></font>
    active_n_per_1M_last %&gt;% transmute(country, active_n_per_1M_last = active_n_per_1M, since_1_confirmed_per_1M_date_n_days),<font></font>
    by = c("country", "since_1_confirmed_per_1M_date_n_days")<font></font>
  )</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(plot_data, aes(x = since_1_confirmed_per_1M_date_n_days)) +<font></font>
<font></font>
  geom_line(aes(y = double_every_7d), linetype = "dotted", color = "red", alpha = .65) +<font></font>
  geom_line(aes(y = double_every_3d), linetype = "dotted", color = "red", alpha = .75) + <font></font>
  geom_line(aes(y = double_every_2d), linetype = "dotted", color = "red", alpha = .85) + <font></font>
<font></font>
  geom_line(aes(y = active_n_per_1M, color = country, linetype = data_type), show.legend = T) +<font></font>
  geom_text(aes(y = active_n_per_1M_last + 20, label = country, color = country), <font></font>
            hjust = 0.5, vjust = 0, check_overlap = T, show.legend = F, fontface = "bold", size = 3.6) +<font></font>
<font></font>
  annotate(geom = "text", label = "Cases double \n every 2 days", x = 17, y = 1550, vjust = 0, size = 3.1) +<font></font>
  annotate(geom = "text", label = "...every 3 days", x = 25, y = 1800, vjust = 0, size = 3.1) +<font></font>
  annotate(geom = "text", label = "...every week", x = 50, y = 1500, vjust = 0, size = 3.1) +<font></font>
<font></font>
  scale_linetype_manual(values = c("longdash", "solid")) +<font></font>
<font></font>
  xlim(c(10, 55)) +<font></font>
  ylim(c(0, max(plot_data$active_n_per_1M))) +<font></font>
<font></font>
  labs(x = "# of days since 1 infected cases per 1M", y = "# of cases per 1M", <font></font>
       title = "COVID-19 Spread by Countries", <font></font>
       subtitle = "Active cases trend since 1 infected cases per 1 million popultation.", <font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(<font></font>
    legend.position = "bottom",<font></font>
    legend.title = element_blank(),<font></font>
    plot.caption = element_text(size = 8)<font></font>
  )</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/98d/104/a6f/98d104a6f0cb25f4ea943602f7e0f64f.png" alt="å›¾ç‰‡"></p><br>
<p>     COVID-19    ,       ,   ,       ,   ,    .</p><br>
<h2 id="zaklyuchenie"></h2><br>
<p>       ,     ,            ,      ,  .</p><br>
<p><em>   </em>               . <em>    </em> (    )     ,      ( ). <em>   () </em>                 .</p><br>
<h2 id="rezultat"></h2><br>
<p> 2          .</p><br>
<p><strong>   </strong> ( ):</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">ggplot(data %&gt;% filter(country %in% countries_list), aes(x = date)) +<font></font>
<font></font>
  geom_line(aes(y = confirmed_n, color = country), show.legend = T) +<font></font>
<font></font>
  scale_x_date(date_labels = "%d %b", date_breaks = "7 days") +<font></font>
<font></font>
  labs(x = "", y = "# of cases", <font></font>
       title = "COVID-19 Spread by Country", <font></font>
       subtitle = "Infected cases over time",<font></font>
       caption = lab_caption) +<font></font>
<font></font>
  theme(<font></font>
    legend.position = "bottom",<font></font>
    legend.title = element_blank(),<font></font>
    plot.caption = element_text(size = 8)<font></font>
  )<font></font>
![image](https://github.com/codez0mb1e/covid-19/raw/master/posts/img/_1.png)</code></pre></div></div><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/7f8/4d3/da4/7f84d3da4cb915efeb98d38970ea5ce3.png" alt="å›¾ç‰‡"></p><br>
<p><strong>        1    1  </strong> (,    ):</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/98d/104/a6f/98d104a6f0cb25f4ea943602f7e0f64f.png" alt="å›¾ç‰‡"></p><br>
<p><em>  !</em></p><br>
<br>
<p><strong> </strong>,    ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"></a>. </p><br>
<h3 id="references">References</h3><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">COVID-19 Data Repository by Johns Hopkins CSSE</a>, GitHub.</li>
<li>  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Kaggle COVID19 Global Forecasting</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Sberbank COVID-19 Forecast</a>.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">, ,  </a>, GitHub.</li>
</ol><br>
<p><em> !</em></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN497330/index.html">Chromeè¿œç¨‹æ¡Œé¢ã€‚è¿œç¨‹æ”¯æŒ</a></li>
<li><a href="../zh-CN497332/index.html">ä¼‘æ–¯é¡¿ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé—®é¢˜ã€‚ç³»ç»Ÿè®¾è®¡å¤±è´¥</a></li>
<li><a href="../zh-CN497334/index.html">è‡­åæ˜­è‘—çš„é”™è¯¯ä»¥åŠå¦‚ä½•ä»¥ClickHouseä¸ºä¾‹é¿å…å®ƒä»¬</a></li>
<li><a href="../zh-CN497336/index.html">90å¹´ä»£çš„è®¡ç®—æœºå“ç‰Œï¼Œç¬¬3éƒ¨åˆ†ï¼Œæœ€ç»ˆç‰ˆ</a></li>
<li><a href="../zh-CN497338/index.html">ä¸Šå‘¨è¿è¾“å‘ç”Ÿäº†ä»€ä¹ˆ-å±æœºæ­£åœ¨åŠ å‰§</a></li>
<li><a href="../zh-CN497342/index.html">æµè§ˆå™¨ä¿æŠ¤APIè¯·æ±‚ï¼šåœ¨å‰ç«¯å’Œåç«¯ä¹‹é—´å»ºç«‹å®‰å…¨çš„é€šä¿¡</a></li>
<li><a href="../zh-CN497346/index.html">ä½¿ç”¨Rustå’ŒLLVMå°†numpyï¼Œscikitå’ŒpandasåŠ é€Ÿ100å€ï¼šé‡‡è®¿å¼€å‘äººå‘˜Weld</a></li>
<li><a href="../zh-CN497350/index.html">è¿åæœåŠ¡æ¡æ¬¾å°šæœªæ„æˆçŠ¯ç½ª</a></li>
<li><a href="../zh-CN497356/index.html">ä½¿ç”¨RFMåˆ†ææŒ‰å¿ è¯šåº¦åŒºåˆ†å®¢æˆ·</a></li>
<li><a href="../zh-CN497358/index.html">PhpStorm 2020.1ï¼šæ”¯æŒcomposer.jsonï¼ŒPHPUnitå·¥å…·ï¼ŒPCOVå’ŒPHPDBGçš„ä»£ç è¦†ç›–ç‡ï¼ŒGrazieç­‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>