<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õìÔ∏è ü¶ä üòæ Prediksi Rangkaian Waktu Menggunakan Jaringan Syaraf Berulang ü•† üîÄ ‚Ü©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mode operasi jarak jauh dengan latar belakang isolasi diri universal dapat mengakibatkan konsekuensi yang sangat buruk. Dan kelelahan emosional - masi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Prediksi Rangkaian Waktu Menggunakan Jaringan Syaraf Berulang</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495884/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode operasi jarak jauh dengan latar belakang isolasi diri universal dapat mengakibatkan konsekuensi yang sangat buruk. Dan kelelahan emosional - masih ada di mana pun ia pergi: setelah semua, itu tidak jauh dari atap. Dalam hal ini, seperti banyak orang, ia mencoba untuk "menenangkan" dirinya sendiri dengan mengalokasikan waktu untuk kelas-kelas lain - dan mulai menerjemahkan artikel-artikel paling menarik dari bahasa Inggris ke dalam bahasa Rusia: "Kamu memberi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pembelajaran mesin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kepada massa!".) Kita harus membayar upeti: itu sangat mengganggu. Jika Anda memiliki saran untuk konten semantik dan terjemahan teks ini untuk pembaca berbahasa Rusia, bergabunglah dengan diskusi.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3d7/fe4/946/3d7fe49466cad76814b37e73ec1bc49a.jpg" alt="gambar"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, inilah terjemahan halaman </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peramalan Time series</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari bagian manual tensorflow: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tautan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Penambahan saya bersama dengan ilustrasi untuk terjemahan ditujukan untuk membantu memahami ide-ide dasar dalam salah satu bidang ML dan ekonometrik yang paling menarik secara umum - perkiraan waktu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengantar kecil sebelum terjemahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Manual ini adalah deskripsi prediksi suhu udara berdasarkan deret waktu satu dimensi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deret </font><i><font style="vertical-align: inherit;">waktu univariat)</font></i><font style="vertical-align: inherit;"> dan deret </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">waktu multivariat (</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deret </font><i><font style="vertical-align: inherit;">waktu multivariat)</font></i><font style="vertical-align: inherit;"> . Untuk setiap bagian, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">masukkan data</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus disiapkan sesuai. Dengan mempertimbangkan set data meteorologi yang dipertimbangkan dalam panduan ini, pemisahannya adalah sebagai berikut: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8fa/31a/a75/8fa31aa7531d8589dcee2ae93454a430.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk pertanyaan tentang apa yang harus diambil untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan untuk apa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yaitu, bagaimana mempersiapkan data untuk kelas pelatihan yang diawasi, maka akan menjadi jelas dari ilustrasi berikut. Saya hanya mencatat bahwa pembentukan vektor target (Y) untuk bekerja dengan seri waktu satu-dimensi dan multi-dimensi adalah sama: vektor target dikompilasi berdasarkan tanda </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T (degC)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(temperatur udara). Perbedaan di antara mereka adalah "terkubur" dalam pembentukan serangkaian fitur yang dimasukkan ke input model: dalam kasus seri waktu satu dimensi untuk memprediksi suhu di masa depan, vektor input (X) terdiri dari satu fitur: pada kenyataannya, suhu udara; dan untuk multidimensi - lebih dari satu: selain suhu udara, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p (mbar)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (tekanan atmosfer) dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rho (g / m ** 3)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (kelembaban) </font><font style="vertical-align: inherit;">digunakan dalam contoh panduan ini </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada awalnya, jauh-dangkal, sebuah contoh dengan peramalan suhu terlihat tidak meyakinkan dari sudut pandang menggunakan input multidimensi: untuk peramalan suhu, tanda yang paling relevan adalah suhu. Namun, ini sama sekali tidak terjadi: untuk mengembangkan perkiraan kualitatif suhu udara, banyak faktor harus diperhitungkan, hingga gesekan udara di permukaan bumi, dll. Selain itu, dalam praktiknya, beberapa hal jauh dari jelas, dan vektor target mungkin dalam bentuk gado-gado (atau borsch). Dalam hal ini, analisis data eksplorasi dengan pemilihan fitur yang paling relevan untuk pembentukan input multidimensi selanjutnya adalah satu-satunya keputusan yang tepat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, terjemahan manual disajikan di bawah ini. Teks tambahan akan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dicetak miring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peramalan Seri Waktu</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Panduan ini adalah pengantar perkiraan deret waktu menggunakan jaringan saraf berulang (RNS, dari English </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recurrent Neural Network, RNN</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Ini terdiri dari dua bagian: yang pertama menggambarkan prediksi suhu udara berdasarkan deret waktu satu dimensi, dan yang kedua - berdasarkan deret waktu multidimensi.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<font></font>
<font></font>
<span class="hljs-keyword">import</span> matplotlib <span class="hljs-keyword">as</span> mpl
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
mpl.rcParams[<span class="hljs-string">'figure.figsize'</span>] = (<span class="hljs-number">8</span>, <span class="hljs-number">6</span>)<font></font>
mpl.rcParams[<span class="hljs-string">'axes.grid'</span>] = <span class="hljs-literal">False</span>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperangkat data meteorologi</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Semua contoh penggunaan manual </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">urutan waktu dari data cuaca yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> direkam di stasiun hidrometeorologi di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Institut Biogeokimia dinamai </font><font style="vertical-align: inherit;">Max Planck</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kumpulan data ini mencakup pengukuran 14 indikator meteorologi yang berbeda (seperti suhu udara, tekanan atmosfer, kelembaban), yang dilakukan setiap 10 menit sejak 2003. </font><font style="vertical-align: inherit;">Untuk menghemat waktu dan penggunaan memori, manual ini akan menggunakan data yang mencakup periode 2009 hingga 2016. </font><font style="vertical-align: inherit;">Bagian dataset ini disiapkan oleh Fran√ßois Chollet untuk bukunya, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deep Learning with Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">zip_path = tf.keras.utils.get_file(<font></font>
    origin=<span class="hljs-string">'https://storage.googleapis.com/tensorflow/tf-keras-datasets/jena_climate_2009_2016.csv.zip'</span>,<font></font>
    fname=<span class="hljs-string">'jena_climate_2009_2016.csv.zip'</span>,<font></font>
    extract=<span class="hljs-literal">True</span>)<font></font>
csv_path, _ = os.path.splitext(zip_path)<font></font>
</code></pre><br>
<pre><code class="python hljs">df = pd.read_csv(csv_path)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat apa yang kita miliki.</font></font><br>
<br>
<pre><code class="python hljs">df.head()
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/d5d/bfa/539/d5dbfa539de3da5ca04103b2db380a70.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fakta bahwa periode rekaman pengamatan adalah 10 menit dapat diverifikasi oleh tabel di atas. Dengan demikian, dalam satu jam Anda akan memiliki 6 pengamatan. Pada gilirannya, 144 pengamatan (6x24) diakumulasikan per hari. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Katakanlah Anda ingin memprediksi suhu, yang akan dalam 6 jam di masa depan. Anda membuat ramalan ini berdasarkan data yang Anda miliki untuk periode tertentu: misalnya, Anda memutuskan untuk menggunakan 5 hari pengamatan. Oleh karena itu, untuk melatih model, Anda harus membuat interval waktu yang berisi 720 (5x144) pengamatan terakhir (karena konfigurasi yang berbeda dimungkinkan, kumpulan data ini merupakan dasar yang baik untuk eksperimen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi di bawah ini mengembalikan interval waktu di atas untuk melatih model. Argumen</font></font><code>history_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini adalah ukuran interval waktu terakhir, </font></font><code>target_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- argumen yang menentukan seberapa jauh ke masa depan yang harus dipelajari model untuk diprediksi. </font><font style="vertical-align: inherit;">Dengan kata lain, </font></font><code>target_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah vektor target yang perlu diprediksi.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">univariate_data</span>(<span class="hljs-params">dataset, start_index, end_index, history_size, target_size</span>):</span><font></font>
  data = []<font></font>
  labels = []<font></font>
<font></font>
  start_index = start_index + history_size<font></font>
  <span class="hljs-keyword">if</span> end_index <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
    end_index = len(dataset) - target_size<font></font>
<font></font>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(start_index, end_index):<font></font>
    indices = range(i-history_size, i)<font></font>
    <span class="hljs-comment"># Reshape data from (history_size,) to (history_size, 1)</span>
    data.append(np.reshape(dataset[indices], (history_size, <span class="hljs-number">1</span>)))<font></font>
    labels.append(dataset[i+target_size])<font></font>
  <span class="hljs-keyword">return</span> np.array(data), np.array(labels)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di kedua bagian manual, 300.000 baris data pertama akan digunakan untuk melatih model, yang tersisa untuk memvalidasi (memvalidasi) itu. </font><font style="vertical-align: inherit;">Dalam hal ini, jumlah data pelatihan sekitar 2100 hari.</font></font><br>
<br>
<pre><code class="python hljs">TRAIN_SPLIT = <span class="hljs-number">300000</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memastikan hasil yang dapat direproduksi, fungsi benih diatur.</font></font><br>
<br>
<pre><code class="python hljs">tf.random.set_seed(<span class="hljs-number">13</span>)
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 1. Peramalan berdasarkan seri waktu satu dimensi</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian pertama, Anda akan melatih model hanya menggunakan satu atribut - suhu; </font><font style="vertical-align: inherit;">model yang terlatih akan digunakan untuk memprediksi suhu di masa depan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memulai, kami mengekstrak hanya suhu dari kumpulan data.</font></font><br>
<br>
<pre><code class="python hljs">uni_data = df[<span class="hljs-string">'T (degC)'</span>]<font></font>
uni_data.index = df[<span class="hljs-string">'Date Time'</span>]<font></font>
uni_data.head()<font></font>
</code></pre><br>
<code>Date Time<br>
01.01.2009 00:10:00 -8.02<br>
01.01.2009 00:20:00 -8.41<br>
01.01.2009 00:30:00 -8.51<br>
01.01.2009 00:40:00 -8.31<br>
01.01.2009 00:50:00 -8.27<br>
Name: T (degC), dtype: float64<br>
</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan mari kita lihat bagaimana data ini berubah seiring waktu.</font></font><br>
<br>
<pre><code class="python hljs">uni_data.plot(subplots=<span class="hljs-literal">True</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/208/b35/242/208b35242d3ce1ed30bd25d12d956703.jpg" alt="gambar"><br>
<br>
<pre><code class="python hljs">uni_data = uni_data.values
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum melatih jaringan saraf tiruan (selanjutnya - JST), langkah penting adalah penskalaan data. </font><font style="vertical-align: inherit;">Salah satu cara umum melakukan penskalaan adalah standardisasi ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standardisasi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), dilakukan dengan mengurangi rata-rata dan membaginya dengan standar deviasi untuk setiap karakteristik. </font><font style="vertical-align: inherit;">Anda juga bisa menggunakan metode </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">tf.keras.utils.normalize</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang menskala nilai hingga rentang [0,1]. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : standardisasi hanya boleh dilakukan menggunakan data pelatihan.</font></font><br>
<br>
<pre><code class="python hljs">uni_train_mean = uni_data[:TRAIN_SPLIT].mean()<font></font>
uni_train_std = uni_data[:TRAIN_SPLIT].std()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melakukan standarisasi data.</font></font><br>
<br>
<pre><code class="python hljs">uni_data = (uni_data-uni_train_mean)/uni_train_std
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kami akan menyiapkan data untuk model dengan input satu dimensi. </font><font style="vertical-align: inherit;">20 pengamatan terakhir yang direkam dari suhu akan dimasukkan ke pintu masuk ke model, dan model harus dilatih untuk memprediksi suhu pada langkah waktu berikutnya.</font></font><br>
<br>
<pre><code class="python hljs">univariate_past_history = <span class="hljs-number">20</span>
univariate_future_target = <span class="hljs-number">0</span><font></font>
<font></font>
x_train_uni, y_train_uni = univariate_data(uni_data, <span class="hljs-number">0</span>, TRAIN_SPLIT,<font></font>
                                           univariate_past_history,<font></font>
                                           univariate_future_target)<font></font>
x_val_uni, y_val_uni = univariate_data(uni_data, TRAIN_SPLIT, <span class="hljs-literal">None</span>,<font></font>
                                       univariate_past_history,<font></font>
                                       univariate_future_target)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasil penerapan fungsi </font></font><code>univariate_data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history'</span>)
<span class="hljs-keyword">print</span> (x_train_uni[<span class="hljs-number">0</span>])
<span class="hljs-keyword">print</span> (<span class="hljs-string">'\n Target temperature to predict'</span>)
<span class="hljs-keyword">print</span> (y_train_uni[<span class="hljs-number">0</span>])
</code></pre><br>
<code>Single window of past history<br>
[[-1.99766294]<br>
 [-2.04281897]<br>
 [-2.05439744]<br>
 [-2.0312405 ]<br>
 [-2.02660912]<br>
 [-2.00113649]<br>
 [-1.95134907]<br>
 [-1.95134907]<br>
 [-1.98492663]<br>
 [-2.04513467]<br>
 [-2.08334362]<br>
 [-2.09723778]<br>
 [-2.09376424]<br>
 [-2.09144854]<br>
 [-2.07176515]<br>
 [-2.07176515]<br>
 [-2.07639653]<br>
 [-2.08913285]<br>
 [-2.09260639]<br>
 [-2.10418486]]<br>
<br>
Target temperature to predict<br>
-2.1041848598100876<br>
</code><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penambahan: menyiapkan data untuk model dengan input satu dimensi secara skematis ditunjukkan pada gambar berikut (untuk kenyamanan, dalam angka ini dan selanjutnya, data disajikan dalam bentuk mentah, sebelum standardisasi, dan juga tanpa atribut 'Tanggal waktu' sebagai indeks):</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/fa0/d0f/530/fa0d0f530b3496324425eeb5e52baff7.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sekarang data dipersiapkan dengan sesuai, pertimbangkan contoh konkret. </font><font style="vertical-align: inherit;">Informasi yang dikirimkan ke JST disorot dengan warna biru, palang merah menunjukkan nilai masa depan yang harus diprediksi JST.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_time_steps</span>(<span class="hljs-params">length</span>):</span>
  <span class="hljs-keyword">return</span> list(range(-length, <span class="hljs-number">0</span>))
</code></pre><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show_plot</span>(<span class="hljs-params">plot_data, delta, title</span>):</span>
  labels = [<span class="hljs-string">'History'</span>, <span class="hljs-string">'True Future'</span>, <span class="hljs-string">'Model Prediction'</span>]<font></font>
  marker = [<span class="hljs-string">'.-'</span>, <span class="hljs-string">'rx'</span>, <span class="hljs-string">'go'</span>]<font></font>
  time_steps = create_time_steps(plot_data[<span class="hljs-number">0</span>].shape[<span class="hljs-number">0</span>])
  <span class="hljs-keyword">if</span> delta:<font></font>
    future = delta<font></font>
  <span class="hljs-keyword">else</span>:<font></font>
    future = <span class="hljs-number">0</span><font></font>
<font></font>
  plt.title(title)<font></font>
  <span class="hljs-keyword">for</span> i, x <span class="hljs-keyword">in</span> enumerate(plot_data):
    <span class="hljs-keyword">if</span> i:<font></font>
      plt.plot(future, plot_data[i], marker[i], markersize=<span class="hljs-number">10</span>,<font></font>
               label=labels[i])<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
      plt.plot(time_steps, plot_data[i].flatten(), marker[i], label=labels[i])<font></font>
  plt.legend()<font></font>
  plt.xlim([time_steps[<span class="hljs-number">0</span>], (future+<span class="hljs-number">5</span>)*<span class="hljs-number">2</span>])<font></font>
  plt.xlabel(<span class="hljs-string">'Time-Step'</span>)
  <span class="hljs-keyword">return</span> plt
</code></pre><br>
<pre><code class="python hljs">show_plot([x_train_uni[<span class="hljs-number">0</span>], y_train_uni[<span class="hljs-number">0</span>]], <span class="hljs-number">0</span>, <span class="hljs-string">'Sample Example'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/589/38c/574/58938c5740abfb08ed0074a1233f512f.jpg" alt="gambar"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi dasar (tanpa melibatkan pembelajaran mesin)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sebelum memulai pelatihan model, kami akan menginstal solusi dasar sederhana ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baseline</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Ini terdiri dari yang berikut: untuk vektor input yang diberikan, metode solusi dasar "memindai" seluruh sejarah dan memprediksi nilai berikutnya sebagai rata-rata dari 20 pengamatan terakhir.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">baseline</span>(<span class="hljs-params">history</span>):</span>
  <span class="hljs-keyword">return</span> np.mean(history)
</code></pre><br>
<pre><code class="python hljs">show_plot([x_train_uni[<span class="hljs-number">0</span>], y_train_uni[<span class="hljs-number">0</span>], baseline(x_train_uni[<span class="hljs-number">0</span>])], <span class="hljs-number">0</span>,
           <span class="hljs-string">'Baseline Prediction Example'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/bed/941/0ef/bed9410ef6b96ad25ab68a0a3ebac05a.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat apakah kita bisa melampaui hasil "rata-rata" menggunakan jaringan saraf berulang. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jaringan Syaraf Berulang Jaringan</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
syaraf berulang (RNS) adalah jenis JST yang cocok untuk memecahkan masalah deret waktu. Langkah demi langkah RNS memproses urutan waktu data, memilah-milah elemen-elemennya dan mempertahankan keadaan internal yang diperoleh dengan memproses elemen-elemen sebelumnya. Anda dapat menemukan informasi lebih lanjut tentang RNS dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">panduan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berikut </font><font style="vertical-align: inherit;">. Panduan ini akan menggunakan lapisan khusus RNC yang disebut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Long Short-Term Memory ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LSTM</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih lanjut menggunakan</font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">tf.data</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acak, batch, dan cache kumpulan data. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahan: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih lanjut tentang metode acak, batch dan cache pada halaman </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tensorflow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></i><br>
<br>
<pre><code class="python hljs">BATCH_SIZE = <span class="hljs-number">256</span>
BUFFER_SIZE = <span class="hljs-number">10000</span><font></font>
<font></font>
train_univariate = tf.data.Dataset.from_tensor_slices((x_train_uni, y_train_uni))<font></font>
train_univariate = train_univariate.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_univariate = tf.data.Dataset.from_tensor_slices((x_val_uni, y_val_uni))<font></font>
val_univariate = val_univariate.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Visualisasi berikut akan membantu Anda memahami seperti apa data setelah pemrosesan batch. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/002/e4b/3ed/002e4b3ed48fa5d17f34ccee2cbfc40d.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dapat dilihat bahwa LSTM membutuhkan bentuk entri data tertentu, yang disediakan untuk itu.</font></font><br>
<br>
<pre><code class="python hljs">simple_lstm_model = tf.keras.models.Sequential([<font></font>
    tf.keras.layers.LSTM(<span class="hljs-number">8</span>, input_shape=x_train_uni.shape[<span class="hljs-number">-2</span>:]),<font></font>
    tf.keras.layers.Dense(<span class="hljs-number">1</span>)<font></font>
])<font></font>
<font></font>
simple_lstm_model.compile(optimizer=<span class="hljs-string">'adam'</span>, loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Periksa output model.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_univariate.take(<span class="hljs-number">1</span>):<font></font>
    print(simple_lstm_model.predict(x).shape)<font></font>
</code></pre><br>
<code>(256, 1)<br>
</code><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahan: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, RNS bekerja dengan urutan. </font><font style="vertical-align: inherit;">Ini berarti bahwa data yang dipasok ke input model harus memiliki bentuk berikut: </font></font><br>
<br>
<code>[,  , - ]</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bentuk data pelatihan untuk model dengan input satu dimensi memiliki bentuk berikut:</font></font></i><br>
<br>
<code>print(x_train_uni.shape)<br>
(299980, 20, 1)</code><br>
<cut></cut><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kita akan mempelajari modelnya. </font><font style="vertical-align: inherit;">Karena ukuran besar kumpulan data dan untuk menghemat waktu, setiap zaman hanya akan melalui 200 langkah ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">steps_per_epoch = 200</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) alih-alih data pelatihan lengkap, seperti yang biasanya dilakukan.</font></font><br>
<br>
<pre><code class="python hljs">EVALUATION_INTERVAL = <span class="hljs-number">200</span>
EPOCHS = <span class="hljs-number">10</span><font></font>
<font></font>
simple_lstm_model.fit(train_univariate, epochs=EPOCHS,<font></font>
                      steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                      validation_data=val_univariate, validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 2s 11ms/step - loss: 0.4075 - val_loss: 0.1351<br>
Epoch 2/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.1118 - val_loss: 0.0360<br>
Epoch 3/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0490 - val_loss: 0.0289<br>
Epoch 4/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0444 - val_loss: 0.0257<br>
Epoch 5/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0299 - val_loss: 0.0235<br>
Epoch 6/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0317 - val_loss: 0.0224<br>
Epoch 7/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0287 - val_loss: 0.0206<br>
Epoch 8/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0263 - val_loss: 0.0200<br>
Epoch 9/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0254 - val_loss: 0.0182<br>
Epoch 10/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0228 - val_loss: 0.0174<br>
</code><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prediksi menggunakan model LSTM sederhana</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Setelah menyelesaikan persiapan model LSTM sederhana, kami akan membuat beberapa prediksi.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_univariate.take(<span class="hljs-number">3</span>):<font></font>
  plot = show_plot([x[<span class="hljs-number">0</span>].numpy(), y[<span class="hljs-number">0</span>].numpy(),<font></font>
                    simple_lstm_model.predict(x)[<span class="hljs-number">0</span>]], <span class="hljs-number">0</span>, <span class="hljs-string">'Simple LSTM model'</span>)<font></font>
  plot.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf8/0f6/810/cf80f681038da62889884ae5de86722d.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini terlihat lebih baik daripada level dasar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang setelah Anda terbiasa dengan dasar-dasarnya, mari beralih ke bagian kedua, yang menjelaskan bekerja dengan rangkaian waktu multidimensi.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 2: Peramalan Seri Waktu Multidimensi</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang dinyatakan, dataset asli berisi 14 indikator meteorologi yang berbeda. </font><font style="vertical-align: inherit;">Untuk kesederhanaan dan kenyamanan, pada bagian kedua hanya tiga yang dipertimbangkan - suhu udara, tekanan atmosfer, dan kepadatan udara. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menggunakan lebih banyak fitur, nama mereka harus ditambahkan ke daftar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feature_considered</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">features_considered = [<span class="hljs-string">'p (mbar)'</span>, <span class="hljs-string">'T (degC)'</span>, <span class="hljs-string">'rho (g/m**3)'</span>]
</code></pre><br>
<pre><code class="python hljs">features = df[features_considered]<font></font>
features.index = df[<span class="hljs-string">'Date Time'</span>]<font></font>
features.head()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/1f8/589/b51/1f8589b51d64dcd9ba10e5f072df503e.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat bagaimana indikator ini berubah seiring waktu.</font></font><br>
<br>
<pre><code class="python hljs">features.plot(subplots=<span class="hljs-literal">True</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/7be/266/b59/7be266b59f38be1e4c365ee8562dffcd.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti sebelumnya, langkah pertama adalah membakukan data yang ditetapkan dengan perhitungan nilai rata-rata dan standar deviasi dari data pelatihan.</font></font><br>
<br>
<pre><code class="python hljs">dataset = features.values<font></font>
data_mean = dataset[:TRAIN_SPLIT].mean(axis=<span class="hljs-number">0</span>)<font></font>
data_std = dataset[:TRAIN_SPLIT].std(axis=<span class="hljs-number">0</span>)
</code></pre><br>
<pre><code class="python hljs">dataset = (dataset-data_mean)/data_std
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahan: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya dalam manual kita akan berbicara tentang perkiraan titik dan interval. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intinya adalah sebagai berikut. Jika Anda membutuhkan model untuk memprediksi satu nilai di masa mendatang (misalnya, nilai suhu setelah 12 jam) (model satu langkah / langkah tunggal), maka Anda harus melatih model tersebut sehingga hanya memprediksi satu nilai di masa mendatang. Jika tugasnya adalah memprediksi kisaran nilai di masa mendatang (misalnya, suhu per jam selama 12 jam berikutnya) (model multi-langkah), maka model tersebut juga harus dilatih untuk memprediksi kisaran nilai di masa mendatang. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/906/953/08e/90695308e69c21c37e772d98553209a4.png" alt="gambar"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prediksi titik</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dalam kasus ini, model dilatih untuk memprediksi satu nilai di masa mendatang berdasarkan beberapa riwayat yang tersedia.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi di bawah ini melakukan tugas yang sama mengatur interval waktu hanya dengan perbedaan bahwa di sini ia memilih pengamatan terbaru berdasarkan ukuran langkah yang diberikan.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">multivariate_data</span>(<span class="hljs-params">dataset, target, start_index, end_index, history_size,
                      target_size, step, single_step=False</span>):</span><font></font>
  data = []<font></font>
  labels = []<font></font>
<font></font>
  start_index = start_index + history_size<font></font>
  <span class="hljs-keyword">if</span> end_index <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
    end_index = len(dataset) - target_size<font></font>
<font></font>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(start_index, end_index):<font></font>
    indices = range(i-history_size, i, step)<font></font>
    data.append(dataset[indices])<font></font>
<font></font>
    <span class="hljs-keyword">if</span> single_step:<font></font>
      labels.append(target[i+target_size])<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
      labels.append(target[i:i+target_size])<font></font>
<font></font>
  <span class="hljs-keyword">return</span> np.array(data), np.array(labels)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam manual ini, JST beroperasi pada data selama lima (5) hari terakhir, yaitu 720 pengamatan (6x24x5). </font><font style="vertical-align: inherit;">Misalkan pemilihan data dilakukan tidak setiap 10 menit, tetapi setiap jam: tidak ada perubahan tajam yang diharapkan dalam 60 menit. </font><font style="vertical-align: inherit;">Oleh karena itu, sejarah lima hari terakhir terdiri dari 120 pengamatan (720/6). </font><font style="vertical-align: inherit;">Untuk model yang melakukan prediksi titik, tujuannya adalah nilai suhu setelah 12 jam di masa depan. </font><font style="vertical-align: inherit;">Dalam hal ini, vektor target akan menjadi suhu setelah 72 (12x6) pengamatan ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lihat tambahan berikut. - Approx. Translator</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<pre><code class="python hljs">past_history = <span class="hljs-number">720</span>
future_target = <span class="hljs-number">72</span>
STEP = <span class="hljs-number">6</span><font></font>
<font></font>
x_train_single, y_train_single = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>], <span class="hljs-number">0</span>,<font></font>
                                                   TRAIN_SPLIT, past_history,<font></font>
                                                   future_target, STEP,<font></font>
                                                   single_step=<span class="hljs-literal">True</span>)<font></font>
x_val_single, y_val_single = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>],<font></font>
                                               TRAIN_SPLIT, <span class="hljs-literal">None</span>, past_history,<font></font>
                                               future_target, STEP,<font></font>
                                               single_step=<span class="hljs-literal">True</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Periksa interval waktu.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history : {}'</span>.format(x_train_single[<span class="hljs-number">0</span>].shape))
</code></pre><br>
<code>Single window of past history : (120, 3)<br>
</code><br>
<pre><code class="python hljs">train_data_single = tf.data.Dataset.from_tensor_slices((x_train_single, y_train_single))<font></font>
train_data_single = train_data_single.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_data_single = tf.data.Dataset.from_tensor_slices((x_val_single, y_val_single))<font></font>
val_data_single = val_data_single.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br>
<pre><code class="python hljs">single_step_model = tf.keras.models.Sequential()<font></font>
single_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">32</span>,<font></font>
                                           input_shape=x_train_single.shape[<span class="hljs-number">-2</span>:]))<font></font>
single_step_model.add(tf.keras.layers.Dense(<span class="hljs-number">1</span>))<font></font>
<font></font>
single_step_model.compile(optimizer=tf.keras.optimizers.RMSprop(), loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan memeriksa sampel kami dan mendapatkan kurva kehilangan pada tahap pelatihan dan verifikasi.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_single.take(<span class="hljs-number">1</span>):<font></font>
  print(single_step_model.predict(x).shape)<font></font>
</code></pre><br>
<code>(256, 1)<br>
</code><br>
<pre><code class="python hljs">single_step_history = single_step_model.fit(train_data_single, epochs=EPOCHS,<font></font>
                                            steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                                            validation_data=val_data_single,<font></font>
                                            validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 4s 18ms/step - loss: 0.3090 - val_loss: 0.2646<br>
Epoch 2/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2624 - val_loss: 0.2435<br>
Epoch 3/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2616 - val_loss: 0.2472<br>
Epoch 4/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2567 - val_loss: 0.2442<br>
Epoch 5/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2263 - val_loss: 0.2346<br>
Epoch 6/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2416 - val_loss: 0.2643<br>
Epoch 7/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2411 - val_loss: 0.2577<br>
Epoch 8/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2410 - val_loss: 0.2388<br>
Epoch 9/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2447 - val_loss: 0.2485<br>
Epoch 10/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2388 - val_loss: 0.2422<br>
</code><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_train_history</span>(<span class="hljs-params">history, title</span>):</span>
  loss = history.history[<span class="hljs-string">'loss'</span>]<font></font>
  val_loss = history.history[<span class="hljs-string">'val_loss'</span>]<font></font>
<font></font>
  epochs = range(len(loss))<font></font>
<font></font>
  plt.figure()<font></font>
<font></font>
  plt.plot(epochs, loss, <span class="hljs-string">'b'</span>, label=<span class="hljs-string">'Training loss'</span>)<font></font>
  plt.plot(epochs, val_loss, <span class="hljs-string">'r'</span>, label=<span class="hljs-string">'Validation loss'</span>)<font></font>
  plt.title(title)<font></font>
  plt.legend()<font></font>
<font></font>
  plt.show()<font></font>
</code></pre><br>
<pre><code class="python hljs">plot_train_history(single_step_history,
                   <span class="hljs-string">'Single Step Training and validation loss'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/baa/481/4df/baa4814df5d278c7be5a4daf629ec8e0.jpg" alt="gambar"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahan: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Persiapan data untuk model dengan prediksi titik kinerja input multidimensi ditampilkan secara skematis pada gambar berikut. </font><font style="vertical-align: inherit;">Untuk kenyamanan dan representasi yang lebih visual dari persiapan data, argumennya </font></font><code>STEP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah 1. Perhatikan bahwa dalam fungsi generator yang diberikan, </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argumen tersebut </font></font><code>STEP </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dimaksudkan hanya untuk pembentukan sejarah</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan bukan untuk vektor target. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bfd/c0b/ef1/bfdc0bef1203da6840adcb4311455645.png" alt="gambar"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam hal ini, ia </font></font><code>x_train_single</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memiliki formulir </font></font><code>(299280, 720, 3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika </font></font><code>STEP=6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, formulir akan mengambil bentuk berikut: </font></font><code>(299280, 120, 3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan kecepatan fungsi akan meningkat secara signifikan. </font><font style="vertical-align: inherit;">Secara umum, Anda perlu memberikan kredit kepada programmer: generator yang disajikan dalam manual sangat lahap dalam hal konsumsi memori. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Melakukan prediksi titik</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang setelah model dilatih, kami akan melakukan beberapa prediksi pengujian. Sejarah pengamatan 3 tanda selama lima hari terakhir, dipilih setiap jam (interval waktu = 120), dimasukkan ke input model. Karena tujuan kami adalah untuk meramalkan hanya suhu, nilai suhu sebelumnya ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">histori</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">ditampilkan dengan warna biru pada grafik </font><font style="vertical-align: inherit;">. Perkiraan dibuat setengah hari ke depan (karenanya kesenjangan antara sejarah dan nilai prediksi).</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_single.take(<span class="hljs-number">3</span>):<font></font>
  plot = show_plot([x[<span class="hljs-number">0</span>][:, <span class="hljs-number">1</span>].numpy(), y[<span class="hljs-number">0</span>].numpy(),<font></font>
                    single_step_model.predict(x)[<span class="hljs-number">0</span>]], <span class="hljs-number">12</span>,
                   <span class="hljs-string">'Single Step Prediction'</span>)<font></font>
  plot.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/6ac/a5b/ce3/6aca5bce3fef9de56f1fac299da5527c.jpg" alt="gambar"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perkiraan interval</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dalam kasus ini, berdasarkan beberapa riwayat yang tersedia, model dilatih untuk memprediksi interval nilai masa depan. </font><font style="vertical-align: inherit;">Jadi, berbeda dengan model yang memprediksi hanya satu nilai di masa depan, model ini memprediksi urutan nilai di masa depan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan, seperti dalam kasus dengan prediksi titik kinerja model, untuk model yang melakukan prediksi interval, data pelatihan adalah pengukuran setiap jam selama lima hari terakhir (720/6). </font><font style="vertical-align: inherit;">Namun, dalam hal ini, model harus dilatih untuk memprediksi suhu selama 12 jam ke depan. </font><font style="vertical-align: inherit;">Karena pengamatan dicatat setiap 10 menit, output dari model harus terdiri dari 72 prediksi. </font><font style="vertical-align: inherit;">Untuk menyelesaikan tugas ini, perlu menyiapkan set data lagi, tetapi dengan interval target yang berbeda.</font></font><br>
<br>
<pre><code class="python hljs">future_target = <span class="hljs-number">72</span>
x_train_multi, y_train_multi = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>], <span class="hljs-number">0</span>,<font></font>
                                                 TRAIN_SPLIT, past_history,<font></font>
                                                 future_target, STEP)<font></font>
x_val_multi, y_val_multi = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>],<font></font>
                                             TRAIN_SPLIT, <span class="hljs-literal">None</span>, past_history,<font></font>
                                             future_target, STEP)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Periksa pilihan.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history : {}'</span>.format(x_train_multi[<span class="hljs-number">0</span>].shape))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'\n Target temperature to predict : {}'</span>.format(y_train_multi[<span class="hljs-number">0</span>].shape))
</code></pre><br>
<code>Single window of past history : (120, 3)<br>
<br>
Target temperature to predict : (72,)<br>
</code><br>
<pre><code class="python hljs">train_data_multi = tf.data.Dataset.from_tensor_slices((x_train_multi, y_train_multi))<font></font>
train_data_multi = train_data_multi.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_data_multi = tf.data.Dataset.from_tensor_slices((x_val_multi, y_val_multi))<font></font>
val_data_multi = val_data_multi.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahan: perbedaan dalam pembentukan vektor target untuk "model interval" dari "model titik" terlihat pada gambar berikut. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/190/5c6/845/1905c6845d2746a1f0bc6ae88f913b99.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan menyiapkan visualisasi.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">multi_step_plot</span>(<span class="hljs-params">history, true_future, prediction</span>):</span>
  plt.figure(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))<font></font>
  num_in = create_time_steps(len(history))<font></font>
  num_out = len(true_future)<font></font>
<font></font>
  plt.plot(num_in, np.array(history[:, <span class="hljs-number">1</span>]), label=<span class="hljs-string">'History'</span>)<font></font>
  plt.plot(np.arange(num_out)/STEP, np.array(true_future), <span class="hljs-string">'bo'</span>,<font></font>
           label=<span class="hljs-string">'True Future'</span>)
  <span class="hljs-keyword">if</span> prediction.any():<font></font>
    plt.plot(np.arange(num_out)/STEP, np.array(prediction), <span class="hljs-string">'ro'</span>,<font></font>
             label=<span class="hljs-string">'Predicted Future'</span>)<font></font>
  plt.legend(loc=<span class="hljs-string">'upper left'</span>)<font></font>
  plt.show()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada grafik ini dan selanjutnya yang serupa, riwayat dan data masa depan adalah setiap jam.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> train_data_multi.take(<span class="hljs-number">1</span>):<font></font>
  multi_step_plot(x[<span class="hljs-number">0</span>], y[<span class="hljs-number">0</span>], np.array([<span class="hljs-number">0</span>]))
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/245/beb/236/245beb236bc1f87f2d611ce8d2c0bc81.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena tugas ini sedikit lebih rumit dari yang sebelumnya, model akan terdiri dari dua lapisan LSTM. </font><font style="vertical-align: inherit;">Akhirnya, karena 72 prediksi dilakukan, layer output memiliki 72 neuron.</font></font><br>
<br>
<pre><code class="python hljs">multi_step_model = tf.keras.models.Sequential()<font></font>
multi_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">32</span>,<font></font>
                                          return_sequences=<span class="hljs-literal">True</span>,<font></font>
                                          input_shape=x_train_multi.shape[<span class="hljs-number">-2</span>:]))<font></font>
multi_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">16</span>, activation=<span class="hljs-string">'relu'</span>))<font></font>
multi_step_model.add(tf.keras.layers.Dense(<span class="hljs-number">72</span>))<font></font>
<font></font>
multi_step_model.compile(optimizer=tf.keras.optimizers.RMSprop(clipvalue=<span class="hljs-number">1.0</span>), loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan memeriksa sampel kami dan mendapatkan kurva kehilangan pada tahap pelatihan dan verifikasi.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_multi.take(<span class="hljs-number">1</span>):
  <span class="hljs-keyword">print</span> (multi_step_model.predict(x).shape)
</code></pre><br>
<code>(256, 72)<br>
</code><br>
<pre><code class="python hljs">multi_step_history = multi_step_model.fit(train_data_multi, epochs=EPOCHS,<font></font>
                                          steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                                          validation_data=val_data_multi,<font></font>
                                          validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 21s 103ms/step - loss: 0.4952 - val_loss: 0.3008<br>
Epoch 2/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.3474 - val_loss: 0.2898<br>
Epoch 3/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.3325 - val_loss: 0.2541<br>
Epoch 4/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.2425 - val_loss: 0.2066<br>
Epoch 5/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.1963 - val_loss: 0.1995<br>
Epoch 6/10<br>
200/200 [==============================] - 18s 90ms/step - loss: 0.2056 - val_loss: 0.2119<br>
Epoch 7/10<br>
200/200 [==============================] - 18s 91ms/step - loss: 0.1978 - val_loss: 0.2079<br>
Epoch 8/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.1957 - val_loss: 0.2033<br>
Epoch 9/10<br>
200/200 [==============================] - 18s 90ms/step - loss: 0.1977 - val_loss: 0.1860<br>
Epoch 10/10<br>
200/200 [==============================] - 18s 88ms/step - loss: 0.1904 - val_loss: 0.1863<br>
</code><br>
<pre><code class="python hljs">plot_train_history(multi_step_history, <span class="hljs-string">'Multi-Step Training and validation loss'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/479/600/430/4796004305bd5b839ead7c35120ddc69.png" alt="gambar"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Melakukan Prediksi Interval</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Jadi, mari kita cari tahu seberapa sukses JST yang terlatih mengatasi dengan perkiraan nilai suhu di masa depan.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_multi.take(<span class="hljs-number">3</span>):<font></font>
  multi_step_plot(x[<span class="hljs-number">0</span>], y[<span class="hljs-number">0</span>], multi_step_model.predict(x)[<span class="hljs-number">0</span>])
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/a3a/2fa/3cd/a3a2fa3cd17ec79c04d9ab44a3d3ad2c.jpg" alt="gambar"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langkah selanjutnya</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Panduan ini adalah pengantar singkat untuk perkiraan seri waktu menggunakan RNS. Sekarang Anda dapat mencoba memprediksi pasar saham dan menjadi miliarder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(seperti aslinya, begitu saja :). - Catatan penerjemah)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, Anda dapat menulis generator sendiri untuk menyiapkan data alih-alih fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uni / multivariate_data</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menggunakan memori lebih efisien. Anda juga dapat membiasakan diri dengan karya " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">time series windowing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " dan membawa ide-idenya ke panduan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk pemahaman lebih lanjut, Anda disarankan untuk membaca Bab 15 buku </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúPembelajaran Mesin Terapan dengan Scikit-Learn, Keras, dan TensorFlow‚Äù</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Aurelien Geron, Edisi 2) dan Bab 6 buku</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Belajar Dalam dengan Python"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Francois Scholl). </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penambahan akhir </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat tinggal di rumah, jaga kesehatan Anda tidak hanya, tetapi juga kasihan pada komputer dengan mengeksekusi contoh manual pada set data terpotong. </font><font style="vertical-align: inherit;">Misalnya, dengan mempertimbangkan proporsi 70x30 (pelatihan / pengujian), Anda dapat membatasi sebagai berikut:</font></font></i><br>
<br>
<pre><code class="python hljs">dataset = features[<span class="hljs-number">300000</span>:].values<font></font>
TRAIN_SPLIT = <span class="hljs-number">85000</span></code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495850/index.html">Kehidupan sehari-hari Scrum-Masters: tim dan transformasi diri</a></li>
<li><a href="../id495852/index.html">LDA pada artikel LiveJournal + visualisasi</a></li>
<li><a href="../id495854/index.html">Bagaimana cara melarikan diri dari Covid dan dari pengawasan?</a></li>
<li><a href="../id495856/index.html">Intel DevCloud for oneAPI - layanan cloud untuk pengembang yang duduk di rumah</a></li>
<li><a href="../id495858/index.html">Terpencil dan mandiri: pengalaman ruang untuk membantu penduduk bumi</a></li>
<li><a href="../id495888/index.html">PyCon Russia telah membuka CFP untuk pembicara masa depan. Formulir Partisipasi dan Topik yang Diharapkan</a></li>
<li><a href="../id495890/index.html">Mengkonfigurasi Bundel Nginx / LetsEncrypt di Docker Swarm</a></li>
<li><a href="../id495892/index.html">Apakah Anda benar-benar tahu apa itu array?</a></li>
<li><a href="../id495894/index.html">Pengukuran Kinerja Javascript</a></li>
<li><a href="../id495896/index.html">Paket Penggunaan-suara: Efek Suara di Aplikasi Bereaksi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>