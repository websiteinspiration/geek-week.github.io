<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍🌾 🥡 👩🏻‍🎨 Robot ROS et Neural Grid Beggar 🚣🏻 👏 🌄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habituellement, deux de ces questions se posent pour ces métiers: «comment?» et pour quoi?" La publication elle-même est consacrée à la première quest...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Robot ROS et Neural Grid Beggar</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500150/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habituellement, deux de ces questions se posent pour ces métiers: «comment?» et pour quoi?" La publication elle-même est consacrée à la première question, et je répondrai immédiatement à la seconde: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
j'ai commencé ce projet afin de maîtriser la robotique, à commencer par le Raspberry Pi et la caméra. Comme vous le savez, l'un des meilleurs moyens d'apprendre quelque chose est de proposer une tâche technique et d'essayer de l'accomplir, tout en acquérant les compétences nécessaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À cette époque, je n'avais toujours pas d'idées brillantes dans le domaine de la robotique, alors j'ai décidé de faire un projet exclusivement amusant - un robot mendiant. Le résultat est un robot autonome sur le Raspberry Pi et le ROS, utilisant le Movidius Neural Cumpute Stick pour détecter les visages. Il erre dans la pièce, cherche des gens, et secoue une canette devant eux. Voici à quoi ressemble ce robot:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pt/wp/nt/ptwpntdd13lkskxbxjuhoyx1oom.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le robot se déplace au hasard dans la pièce, et s'il remarque une personne, il s'enroule et secoue un pot pour de petites choses. </font><font style="vertical-align: inherit;">Pour le plaisir, je lui ai ajouté une petite expression faciale - il sait bouger ses sourcils: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2x/lm/aw/2xlmaw5tm_hogsuqfuvqwjmeblk.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
après la première tentative, le robot essaie de retrouver son visage en vue, se tourne vers la personne et secoue à nouveau la banque. </font><font style="vertical-align: inherit;">Mais que se passe-t-il si vous partez en ce moment:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/8x/xz/ko8xxzvzo_owit62gkv8z3wn1ik.gif"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Robot</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai pris l'idée d'un robot mendiant du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">magazine Popular Mechanics</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">La paternité du prototype de Chris Eckert appelé Gimme semble très esthétique.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/374/8d6/dbc/3748d6dbcb97d04751dacd866eb94e07.jpg" alt="image" width="300" height="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je voulais me concentrer davantage sur la fonctionnalité, donc le boîtier a été assemblé à partir de matériaux improvisés. </font><font style="vertical-align: inherit;">En particulier, les coins en PVC se sont révélés être le matériau le plus polyvalent avec lequel vous pouvez connecter presque deux parties. </font><font style="vertical-align: inherit;">Il semble qu'à l'heure actuelle, le robot soit composé à cinq pour cent de coins en PVC et de vis M3. </font><font style="vertical-align: inherit;">Le boîtier lui-même se compose de trois plates-formes stratifiées sur lesquelles la tête et toute l'électronique sont montées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La base du robot est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspberry Pi 2B</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et le code est écrit en C ++ et se trouve sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vision</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour percevoir la réalité, le robot utilise la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caméra Paspberry Pi Camera Module v2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui peut être contrôlée à l'aide de la bibliothèque </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RaspiCam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la détection des visages, j'ai essayé plusieurs approches différentes. La qualité des détecteurs classiques d'OpenCV ne m'a pas satisfait, donc finalement je suis arrivé à une solution plutôt non standard. Détection de personnes engagées dans le réseau neuronal, fonctionnant sur l'appareil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Movidius Neural Compute Stick (NCS)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sous le cadre de contrôle </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenVINO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NCS est un tel matériel pour le lancement efficace de réseaux de neurones, à l'intérieur desquels se trouvent plusieurs processeurs vectoriels spécialement conçus pour cela. L'appareil est connecté via USB et ne consomme que 1 Watt d'énergie. Ainsi, le NCS agit comme un co-processeur pour le Raspberry Pi, qui ne tire pas le réseau neuronal. Pendant que le NCS traite la trame suivante, le processeur Paspberry est libre pour d'autres opérations. Il convient de noter que pour un fonctionnement optimal de l'appareil, une interface USB 3.0 est requise, qui n'est pas disponible sur les anciennes versions de Raspberry; avec USB 2.0, cela fonctionne aussi, mais plus lentement. Aussi, afin de ne pas bloquer les connecteurs USB Raspberry, je lui connecte le NCS via un court câble USB. J'ai écrit en détail sur l'utilisation du Neural Compute Stick </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans mon article précédent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, j'ai essayé de m'entraîner</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propre détecteur de visage avec architecture MobileNet + SSD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur des ensembles de données ouverts. Le détecteur fonctionnait vraiment, mais pas très stable: avec la détérioration inévitable des conditions de prise de vue (exposition et clichés flous), la qualité du détecteur s'affaissait fortement. Cependant, après un certain temps, des détecteurs de visage prêts à l'emploi sont apparus dans OpenVINO, et je suis passé à un détecteur avec l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">architecture SqueezeNet light + SSD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui non seulement fonctionnait mieux dans diverses conditions de prise de vue, mais était également plus rapide. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de télécharger l'image sur le NCS pour obtenir les prévisions du détecteur, l'image doit être prétraitée. Le détecteur de mon choix fonctionne avec des images en couleur</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>300</mn><mo>&amp;#x00D7;</mo><mn>300</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.815ex" height="2.009ex" viewBox="0 -755.5 4225.9 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-D7" x="1723" y="0"></use><g transform="translate(2724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>300</mn><mo>×</mo><mn>300</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">300 \times 300</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, donc l'image doit d'abord être compressée. Pour ce faire, j'utilise l'algorithme de mise à l'échelle le plus léger - la méthode du plus proche voisin (INTER_NEAREST dans la bibliothèque OpenCV). Cela fonctionne un peu plus rapidement que les méthodes d'interpolation et n'affecte presque pas le résultat. Il convient également de prêter attention à l'ordre des canaux d'image: le détecteur attend l'ordre BGR, vous devez donc le définir pour la caméra.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai également essayé de séparer le traitement vidéo en deux flux, dont l'un a reçu l'image suivante de la caméra et l'a traitée, et l'autre à ce moment-là a téléchargé l'image précédente sur NCS et a attendu les résultats du détecteur. Avec ce schéma, techniquement, la vitesse de traitement augmente, mais le délai entre la réception de la trame et la réception des détections pour elle augmente également. En raison de ce retard par rapport à la réalité, la surveillance du visage devient seulement plus difficile, donc j'ai finalement refusé ce schéma. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de détecter réellement les visages, ils doivent également être suivis pour éviter les erreurs de détection. Pour ce faire, j'utilise le tracker léger </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simple Online Realtime Tracker (SORT)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ce tracker simple se compose de deux parties: l' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">algorithme hongrois</font></a><font style="vertical-align: inherit;"> est utilisé pour faire correspondre les objets sur les images adjacentes</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et de prédire la trajectoire de l'objet, s'il disparaît subitement - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filtre de Kalman</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pendant que je jouais avec le suivi du visage, j'ai trouvé que les trajectoires prédites par le filtre de Kalman peuvent être très invraisemblables avec des mouvements brusques, ce qui ne fait que compliquer le processus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, j'ai désactivé le filtre de Kalman, ne laissant que l'algorithme de correspondance de visage et le compteur du nombre séquentiel d'images sur lesquelles le visage a été détecté - de cette façon, je me débarrasse des faux positifs du détecteur. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plateforme supérieure, de gauche à droite: caméra, servos pour contrôler la tête et les sourcils, interrupteur, bornes d'alimentation, Big Red Button.</font></font></i><br>
<img src="https://habrastorage.org/webt/hb/ky/kk/hbkykkpwtkhtfl39aonaop5indg.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trafic</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le mouvement, le robot dispose de cinq servos: deux servos à rotation continue FS5103R font tourner les roues; Il y a deux autres FS5109M ordinaires, dont l'un fait tourner la tête et l'autre secoue la boîte; enfin, le petit SG90 remue les sourcils.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour être honnête, les mini-servos SG90 me semblaient être une poubelle - l'un de mes servos avait la mauvaise largeur d'impulsion de contrôle, et un seul a survécu parmi les quatre autres. En toute honnêteté, j'ai accidentellement pris l'un des domestiques avec mon coude, mais les deux autres ne pouvaient tout simplement pas supporter la charge (je les utilisais pour la tête et la boîte). Même le dernier servo, qui a obtenu le travail le plus simple - déplacer les sourcils, doit pousser un bâton de temps en temps pour qu'il ne se coince pas. Avec d'autres servos, je n'ai remarqué aucun problème. Il est vrai que les servos à rotation continue doivent parfois être calibrés afin qu'ils ne tournent pas à l'état inactif - pour cela, il y a un petit régulateur sur eux qui peut être tourné avec un tournevis à tête d'horloge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'avère que la gestion des servos avec Raspberry n'est pas si simple. Premièrement, ils sont contrôlés par</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modulation de largeur d'impulsion (PWM / PWM)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et sur Raspberry il n'y a que deux broches sur lesquelles </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PWM est pris en charge par le matériel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Deuxièmement, bien sûr, Raspberry ne pourra pas alimenter les servos, il ne le supportera pas. Heureusement, ces problèmes sont résolus à l'aide d'un contrôleur PWM externe. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adafruit PCA9685</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un contrôleur PWM à 16 canaux qui peut être contrôlé via l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interface I2C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il est également très pratique de disposer de bornes pour l'alimentation des servos. De plus, [théoriquement] il est possible de chaîner jusqu'à 62 contrôleurs, tout en recevant jusqu'à 992 broches de contrôle - pour cela, vous devez attribuer une adresse unique à chaque contrôleur à l'aide de cavaliers spéciaux. Donc, si vous avez soudainement besoin d'une armée de servos - vous savez quoi faire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contrôler le PCA9685, il existe une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bibliothèque de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> haut niveau </font><font style="vertical-align: inherit;">qui agit comme une extension </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WiringPi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Travailler avec cette chose est assez pratique - lors de l'initialisation, il crée 16 broches virtuelles dans lesquelles vous pouvez écrire un signal PWM, mais vous devez d'abord calculer le nombre de ticks. </font><font style="vertical-align: inherit;">Pour tourner le servo-levier à un certain angle dans la plage [0, 180], vous devez d'abord traduire cet angle dans la plage de longueurs d'impulsion de contrôle en millisecondes [SERVO_MS_MIN, SERVO_MS_MAX]. </font><font style="vertical-align: inherit;">Pour tous mes servos, ces valeurs sont respectivement d'environ 0,6 ms et 2,4 ms. </font><font style="vertical-align: inherit;">En général, ces valeurs peuvent être trouvées dans la fiche technique du servo, mais la pratique a montré qu'elles peuvent différer, il peut donc être nécessaire de les sélectionner. </font><font style="vertical-align: inherit;">Divisez ensuite la valeur résultante par 20 ms (la valeur standard de la durée du cycle de contrôle) et multipliez par le nombre maximal de graduations PCA9685 (4096):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">driveDegs</span><span class="hljs-params">(<span class="hljs-keyword">float</span> angle, <span class="hljs-keyword">int</span> pin)</span> </span>{
    <span class="hljs-keyword">int</span> ticks = (<span class="hljs-keyword">int</span>) (PCA_MAX_PWM * (angle/<span class="hljs-number">180.0f</span>*(SERVO_MS_MAX-SERVO_MS_MIN) + SERVO_MS_MIN) / <span class="hljs-number">20.0f</span>); <font></font>
    pwmWrite(pin, ticks);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De même, cela se fait avec des servos à rotation continue - au lieu d'un angle, nous définissons la vitesse dans la plage [-1,1].</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai assemblé le châssis du robot, ainsi que le corps, à partir de moyens improvisés: je mets des roues de meuble sur les servo-entraînements à rotation continue, et un support de boule de meuble fait office de troisième roue. Auparavant, au lieu de cela, une roue se tenait sur un support rotatif, mais avec un tel châssis, il était difficile de faire des virages précis, j'ai donc dû le remplacer. Il y a aussi une petite roue sous la boîte pour transférer une partie du poids du servo au boîtier. Une chose simple qui n'était pas évidente pour moi au départ était que les servo-leviers doivent être fixés avec une vis, en particulier pour les roues, afin qu'ils ne tombent pas en cours de route. À cause d'une telle stupidité, j'ai dû refaire le châssis une fois. J'ai également fait du robot un large pare-chocs fait de coins en PVC pour qu'il ne se coince pas si souvent.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, ce que vous pouvez faire à ce sujet. Tout d'abord, vous pouvez secouer le pot et bouger les sourcils - pour cela, il vous suffit de tourner le servo-levier à des angles présélectionnés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxièmement, vous pouvez tourner la tête. Je ne voulais pas que la tête tourne à la vitesse maximale du servo, car il y a un appareil photo dessus. Par conséquent, j'ai décidé de réduire la vitesse par programme: je dois tourner le levier d'un petit angle, puis attendre quelques millisecondes - et ainsi de suite jusqu'à ce que l'angle souhaité soit atteint. Dans ce cas, il est nécessaire de se souvenir de la position absolue actuelle de la tête et de vérifier à chaque fois si elle a dépassé les limites autorisées (sur mon robot, elle est dans la plage de [10, 90] degrés).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Troisièmement, vous pouvez changer la direction du mouvement en modifiant la vitesse de rotation des roues. </font><font style="vertical-align: inherit;">De la même manière, vous pouvez faire pivoter la plate-forme, par exemple, pour suivre le visage. </font><font style="vertical-align: inherit;">La vitesse angulaire de rotation dépend à la fois des servos eux-mêmes et de leur emplacement sur le châssis, il est donc plus facile de la mesurer une fois puis de la prendre en compte dans les virages. </font><font style="vertical-align: inherit;">Pour trouver le délai nécessaire entre l'activation des moteurs en rotation et leur désactivation, vous devez diviser le module d'angle par la vitesse angulaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, vous pouvez faire pivoter la tête et le châssis simultanément et de manière asynchrone afin de ne pas perdre de temps. </font><font style="vertical-align: inherit;">Je le fais comme ça:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> waitRotation = <span class="hljs-built_in">std</span>::async(<span class="hljs-built_in">std</span>::launch::async, rotatePlatform, platformAngle);<font></font>
success = driveHead(headAngle);<font></font>
waitRotation.wait();<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plateforme centrale, de gauche à droite: PCA9685, bus d'alimentation, Raspberry Pi, MCP3008 ADC</font></font></i><br>
<img src="https://habrastorage.org/webt/bq/q1/8_/bqq18_ilwmgadlcsz0ydepdk44u.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La navigation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, je n'ai rien compliqué, donc le robot utilise uniquement deux télémètres infrarouges Sharp GP2Y0A02YK pour la navigation. Ce n'est pas aussi simple, car les capteurs sont analogiques, mais Raspberry, contrairement à Arduino, n'a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas d'entrées analogiques</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ce problème est résolu par le convertisseur analogique-numérique (ADC / ADC) - j'utilise le MCP3008 10 bits et 8 canaux. Il est vendu comme un microcircuit séparé, il a donc dû être soudé à une carte de circuit imprimé et des broches y ont également été soudées pour le rendre plus pratique à connecter. De plus, sur les conseils de mon bati, qui tâtonne davantage dans les circuits, j'ai soudé deux condensateurs (céramique et électrolytique) entre les jambes de l'alimentation et le sol pour absorber le bruit de la partie numérique de l'ensemble du circuit. Les capteurs ne produisent pas plus de trois volts à la sortie, donc 3,3 V avec Raspberry peuvent être connectés en tant que tension ADC de référence (VREF) - la même que pour l'alimentation MCP3008 (VDD). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le MCP3008 peut être contrôlé via l'interface </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et pour cela, il est encore plus facile de trouver du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code prêt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à l' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">emploi sur GitHub</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malgré cela, pour un travail pratique avec l'ADC, vous aurez besoin de quelques danses avec un tambourin.</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> <span class="hljs-title">analogRead</span><span class="hljs-params">(mcp3008Spi &amp;adc, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> channel)</span>
</span>{
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> spi_data[<span class="hljs-number">3</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> val = <span class="hljs-number">0</span>;<font></font>
<font></font>
    spi_data[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;  <span class="hljs-comment">// start bit</span>
    spi_data[<span class="hljs-number">1</span>] = <span class="hljs-number">0b10000000</span> | ( channel &lt;&lt; <span class="hljs-number">4</span>); <span class="hljs-comment">// mode and channel</span>
    spi_data[<span class="hljs-number">2</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// anything</span>
    adc.spiWriteRead(spi_data, <span class="hljs-keyword">sizeof</span>(spi_data));<font></font>
  <font></font>
    <span class="hljs-comment">// read value, combine last two bits of second byte with whole third byte</span>
    val = (spi_data[<span class="hljs-number">1</span>]&lt;&lt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0b1100000000</span>; <font></font>
    val |= (spi_data[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0xff</span>);
    <span class="hljs-keyword">return</span> val;<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois octets doivent être envoyés au MCP3008, où le bit de début est écrit dans le premier octet, et le numéro de mode et de canal (0-7) dans le second. </font><font style="vertical-align: inherit;">Nous récupérons également trois octets, après quoi nous devons coller les deux bits les moins significatifs du deuxième octet avec tous les bits du troisième. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous pouvons obtenir les valeurs des capteurs, nous devons les calibrer, car les deux capteurs peuvent différer légèrement l'un de l'autre. </font><font style="vertical-align: inherit;">En général, l'affichage à distance en raison de la puissance du signal de ces capteurs est non linéaire et pas très simple ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour plus de détails voir fiche technique, pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Par conséquent, il suffit de prendre deux coefficients, multipliés par lesquels les capteurs donneront une valeur de 1,0 à une distance égale et significative.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lectures des capteurs peuvent être assez bruyantes, en particulier sur les obstacles difficiles, donc j'utilise une moyenne mobile à pondération exponentielle (EWMA) pour lisser le signal de chaque capteur. </font><font style="vertical-align: inherit;">J'ai sélectionné les paramètres de lissage à l'œil, afin que le signal ne fasse pas de bruit et ne soit pas loin derrière la réalité. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vue de face: banque, télémètres et pare-chocs.</font></font></i><br>
<img src="https://habrastorage.org/webt/kb/vw/l-/kbvwl-usmln86iqj8aq236ifhpo.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nutrition</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, évaluons le courant que le robot va consommer (à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propos de la consommation actuelle de framboise et de périphériques</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspberry Pi 2B: pas moins de 350 mA, mais plus sous charge (jusqu'à 750-820 mA (?));</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appareil photo: environ 250 mA;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neural Compute Stick: consommation d'énergie déclarée de 1 watt, à une tension de 5 volts sur USB, elle est de 200 mA;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs IR: 33 mA chacun ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fiche technique, pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></li>
<li>MCP3008:  ,  0.5  (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">, pdf</a>);</li>
<li>PCA9685:  , 6  (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">, pdf</a>);</li>
<li>:  ~150-200   1500-2000     (stall current),          (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> FS5109M, pdf</a>)</li>
<li>HDMI (   ): 50 ;</li>
<li> +  ( ): ~200 .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au total, on peut estimer que 1,5 à 2,5 ampères devraient être suffisants, à condition que tous les servos ne se déplacent pas simultanément sous une lourde charge. Dans le même temps, Raspberry a besoin d'une tension conditionnelle de 5 volts, et pour les servos - de 4,8 à 6 volts. Reste à trouver une source d'alimentation répondant à ces exigences. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, j'ai décidé d'alimenter le robot à partir de batteries au format 18650. Si vous prenez deux </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batteries ROBITON 3.4 / Li18650</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (3,6 volts, 3400 mAh, courant de décharge maximum 4875 mA) et les connectez en série, elles peuvent produire jusqu'à 4,8 ampères à une tension de 7,2 volts. Avec un courant de consommation de 1,5 à 2,5 ampères, ils devraient être suffisants pour une heure ou deux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les batteries, en passant, ont un hic: malgré le facteur de forme indiqué 18650, leurs tailles sont loin d'être</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>18</mn><mo>&amp;#x00D7;</mo><mn>650</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.653ex" height="2.009ex" viewBox="0 -755.5 3725.4 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-D7" x="1223" y="0"></use><g transform="translate(2223,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>18</mn><mo>×</mo><mn>650</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">18 \times 650</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mm - ils sont plus longs de plusieurs millimètres grâce au circuit de contrôle de charge intégré. Pour cette raison, j'ai dû poignarder le compartiment de la batterie avec un couteau pour qu'ils y tiennent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne reste plus qu'à abaisser la tension à 5 volts. Pour cela, j'utilise deux convertisseurs DC-DC abaisseur séparés </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DFRobot Power Module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ce morceau de fer vous permet d'abaisser la tension à une tension d'entrée de 3,6-25 volts et une différence de tension d'au moins 0,6 volts. Pour plus de commodité, il dispose d'un interrupteur qui vous permet de sélectionner exactement 5 volts à la sortie, ou vous pouvez configurer une tension de sortie arbitraire à l'aide d'un régulateur spécial. J'ai réglé les deux convertisseurs à 5 volts; l'un d'eux alimente la framboise via un connecteur micro-USB, et le second alimente les servos via les terminaux PCA9685. Ceci est nécessaire afin de maximiser l'alimentation électrique des parties logiques et électriques du robot afin qu'elles n'interfèrent pas entre elles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au stade du débogage, j'ai utilisé une alimentation chinoise de 9 volts, 2 ampères au lieu des batteries, et c'était suffisant pour que le robot fonctionne - je l'ai connecté, comme les batteries, à deux convertisseurs DC-DC. Par conséquent, pour plus de commodité, j'ai créé des bornes sur le robot, auxquelles vous pouvez connecter une alimentation ou un compartiment à piles au choix. Cela a beaucoup aidé lorsque j'ai complètement réécrit tout le code sur ROS, et j'ai dû déboguer le robot pendant longtemps, y compris les servos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour plus de commodité, j'ai également dû faire un "bus d'alimentation" - en fait, juste un morceau de la carte avec trois rangées de broches connectées pour la masse, 3,3v et 5v, respectivement. Le bus se connecte aux broches Raspberry correspondantes. Seuls les télémètres infrarouges sont alimentés par le bus 5v et les MCP3008 et PCA9685 par le bus 3,3v.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et bien sûr, selon la bonne vieille tradition, j'ai mis le gros bouton rouge sur le robot - quand il est pressé, il interrompt simplement tout le circuit d'alimentation. </font><font style="vertical-align: inherit;">Il n'était pas nécessaire de l'utiliser pour un arrêt d'urgence, mais allumer le robot à l'aide d'un bouton est vraiment plus pratique. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plateforme inférieure, de gauche à droite: compartiment batterie, NCS, convertisseurs DC-DC, servo variateurs avec roues, télémètres.</font></font></i><br>
<img src="https://habrastorage.org/webt/od/tf/6b/odtf6b5gksijt0nhbflim7wrh1m.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrôle du robot</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas de Wi-Fi sur le Raspberry Pi 2B, je dois donc me connecter via ssh via un câble Ethernet (au fait, cela peut être fait </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directement depuis l'ordinateur portable, sans utiliser de routeur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Il s'avère que ce schéma: nous nous connectons via ssh via le câble, démarrons le robot et retirons le câble. Ensuite, il peut être remis à sa place pour accéder à nouveau à la framboise. Il existe des solutions plus élégantes, mais j'ai décidé de ne pas compliquer les choses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que le robot puisse être facilement arrêté sans s'éteindre, j'ai ajouté un interrupteur soviétique massif (à partir d'un sous-marin?). Lorsque vous l'éteignez, le programme se termine et le robot s'arrête. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le commutateur se connecte à la terre et à l'une des broches Raspberry GPIO, et vous pouvez y lire à l'aide de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la bibliothèque WiringPi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs">wiringPiSetup();<font></font>
pinMode(PIN_SWITCH, INPUT);<font></font>
pullUpDnControl(PIN_SWITCH, PUD_UP);<font></font>
<span class="hljs-keyword">bool</span> value = digitalRead(BB_PIN_SWITCH);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter qu'avec cette connexion, la tension sur la broche doit être augmentée jusqu'à 3,3 V, et en même temps, elle produira un signal haut à l'état ouvert et un signal bas à l'état fermé.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre tous ensemble</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Threads</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Maintenant, tout ce qui précède doit être combiné en un seul programme qui contrôle le robot. </font><font style="vertical-align: inherit;">Dans la première version du robot, je l'ai fait en utilisant des threads ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pthread</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Cette version est dans la branche </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">master</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais le code y est assez effrayant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le programme fonctionne en quatre fils: un fil prend des images de la caméra et démarre le détecteur sur le NCS; </font><font style="vertical-align: inherit;">le deuxième flux lit les données des télémètres; </font><font style="vertical-align: inherit;">le troisième thread surveille le commutateur et définit la variable globale </font></font><code>is_running</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'il est éteint; Le thread principal est responsable du comportement du robot et de l'asservissement. Les threads ont des pointeurs en commun avec le thread principal, par lesquels ils écrivent les résultats de leur travail. J'ai limité les vecteurs qui stockent les informations sur les faces trouvées par le détecteur au mutex, et déclaré les autres variables communes plus simples comme atomiques. Pour coordonner le flux du détecteur de visage avec le fil principal, un indicateur </font></font><code>face_processed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est réinitialisé lorsqu'un nouveau résultat provient du détecteur et augmente lorsque le fil principal utilise ce résultat pour sélectionner un comportement - cela est nécessaire afin de ne pas traiter les anciennes données qui peuvent ne pas être pertinentes après avoir déménagé. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
version </font><b><font style="vertical-align: inherit;">ROS</font></b><font style="vertical-align: inherit;"> avec les streams fonctionnait bien, mais j'ai commencé tout cela pour apprendre quelque chose, alors pourquoi pas en même temps master</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ros</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font><font style="vertical-align: inherit;">J'entends ce framework depuis longtemps, et j'ai même dû travailler un peu avec lui sur un hackathon, donc à la fin j'ai décidé de réécrire tout le code sur ROS. </font><font style="vertical-align: inherit;">Cette version du code se trouve dans la branche par défaut de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ros</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et semble beaucoup plus décente. </font><font style="vertical-align: inherit;">Il est clair que la mise en œuvre sur ROS sera presque certainement plus lente que la mise en œuvre sur les flux en raison des frais d'envoi de messages et de tout le reste - la seule question est de savoir combien?</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Concept ROS</font></font></b>
                        <div class="spoiler_text">ROS (Robot Operating System) —     ,             ,   ,        .<br>
<br>
    ,  ,  ,     (node), ,    ,       .<br>
<br>
      (topic)      (message)  ,         -    . <br>
<br>
    —   (service).         ,       ,     .      « »,    .<br>
<br>
         <code>.msg</code>  <code>.srv</code> .          .<br>
<br>
 ROS    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> </a>.<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour mon robot, je n'ai utilisé aucun package prêt à l'emploi avec des algorithmes de ROS, j'ai uniquement conçu le code du robot dans un package séparé composé de cinq nœuds communiquant entre eux à l'aide de messages et de services ROS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nœud le plus simple </font></font><code>switch_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,, surveille l'état du commutateur. Dès que le commutateur est désactivé, le nœud commence à spammer des messages non informatifs du type </font></font><code>bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de la rubrique </font></font><code>terminator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. C'est un signal au nœud principal qu'il est temps de terminer le travail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième nœud ,, </font></font><code>sensor_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lit périodiquement les lectures des deux télémètres IR et les envoie au sujet dans </font></font><code>sensor_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un message. De plus, ce nœud est responsable du traitement du signal: mise à l'échelle par des facteurs d'étalonnage et moyenne mobile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Troisième nœud</font></font><code>camera_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est responsable de tout ce qui concerne les visages: il prend des images de la caméra, les traite, reçoit les résultats du détecteur, les passe à travers le tracker, puis trouve le visage le plus proche du centre du cadre - le robot n'utilise pas le reste de toute façon, mais vous voulez faire des messages plus petits. Les messages que le nœud envoie au sujet </font></font><code>camera_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contiennent le numéro de la trame, le fait d'avoir un visage (car il faut aussi savoir l'absence d'un visage), les coordonnées relatives du coin supérieur gauche, la largeur et la hauteur du visage. Voici à quoi ressemble la description du type de message dans le fichier </font></font><code>DetectionBox.msg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">int64 count<font></font>
bool present<font></font>
float32 x<font></font>
float32 y<font></font>
float32 width<font></font>
float32 height<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le quatrième noeud ,, </font></font><code>servo_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est responsable des servos. Premièrement, il prend en charge un service </font></font><code>servo_action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui permet à l'une des actions d'être exécutée par les servos par son numéro: mettre le nœud entier dans son état initial (sourcils, inclinaison, tête, arrêt du châssis); remettre la tête dans son état initial; secouez le pot; dépeindre avec un sourcil l'une des trois expressions (bon, neutre, mal). Deuxièmement, en utilisant le service, </font></font><code>servo_speed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous pouvez définir de nouvelles vitesses pour les deux roues en les envoyant dans la demande. Les deux services ne retournent rien. Enfin, il existe un service </font></font><code>servo_head_platform</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui vous permet de faire pivoter la tête et / ou le châssis d'un certain angle par rapport à la position actuelle. Ce service revient </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'il était possible de tourner la tête au moins partiellement, et</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sinon, dans le cas où la tête est déjà au bord de l'angle admissible, et nous essayons de la tourner encore plus loin. </font><font style="vertical-align: inherit;">Si les deux angles de la demande sont différents de zéro, le service tourne de manière asynchrone, comme indiqué ci-dessus. </font><font style="vertical-align: inherit;">Dans la boucle principale, le nœud d'asservissement ne fait rien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici, par exemple, une description du service </font></font><code>servo_head_platform</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">float32 head_delta<font></font>
float32 platform_delta<font></font>
---<font></font>
bool head_success<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chacun des nœuds répertoriés prend en charge un service </font></font><code>terminate_{switch, camera, sensor, servo}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec une demande de réponse vide, ce qui arrête le fonctionnement du nœud. </font><font style="vertical-align: inherit;">Il est mis en œuvre de cette manière:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Du code</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs">...
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">atomic_bool</span> is_running; <span class="hljs-comment">// global</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">terminate_node</span><span class="hljs-params">(std_srvs::Empty::Request &amp;req, std_srvs::Empty::Response &amp;ignored)</span> </span>{<font></font>
    is_running = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> </span>{<font></font>
    is_running = <span class="hljs-literal">true</span>;<font></font>
    ...<font></font>
    <span class="hljs-keyword">while</span> (is_running &amp;&amp; ros::ok()) {
        <span class="hljs-comment">// do stuff</span><font></font>
    }<font></font>
    ...<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nœud a une variable globale </font></font><code>is_running</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dont la valeur détermine le cycle principal du nœud. Le service réinitialise simplement cette variable et la boucle principale est interrompue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe également un nœud principal </font></font><code>beggar_bot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans lequel la logique de base du robot est implémentée. Avant le début de la boucle principale, il s'abonne aux rubriques </font></font><code>sensor_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>camera_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enregistre le contenu des messages dans des variables globales dans les fonctions de rappel. Il est également abonné au sujet </font></font><code>terminator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dont le rappel réinitialise l'indicateur </font></font><code>is_running</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, interrompant la boucle principale. De plus, avant le début du cycle, le nœud annonce les interfaces pour les services du nœud d'asservissement et attend quelques secondes que les autres nœuds démarrent. Une fois la boucle principale terminée, ce nœud appelle les services</font></font><code>terminate_{switch, camera, sensor, servo}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, désactivant ainsi tous les autres nœuds, puis le désactivant lui-même. Autrement dit, lorsque le commutateur est désactivé, les cinq nœuds terminent l'opération. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le passage à ROS m'a obligé à changer beaucoup la structure du programme. Par exemple, auparavant, il était possible de modifier la vitesse de la roue avec une fréquence élevée, et cela fonctionnait bien, mais le service ROS fonctionne un ordre de grandeur plus lentement, j'ai donc dû réécrire le code afin que le service ne soit appelé que lorsque la vitesse change vraiment (en "mode paresseux"). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ROS vous permet également d'exécuter assez commodément tous les nœuds du robot. Pour ce faire, vous devez écrire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un fichier de lancement .launch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> répertoriant tous les nœuds et autres attributs du robot au format xml, puis exécuter la commande:</font></font><br>
<br>
<pre><code class="plaintext hljs">roslaunch beggar_bot robot.launch</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROS vs pthread</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Maintenant, enfin, vous pouvez comparer la vitesse de la version ROS et de la version pthread. </font><font style="vertical-align: inherit;">Je le fais de cette façon: le thread / nœud responsable de travailler avec la caméra considère son FPS (comme l'élément le plus lent), à condition que tout le reste fonctionne également. </font><font style="vertical-align: inherit;">Pour la version pthread, j'ai toujours obtenu FPS 9,99 ou plus, pour la version ROS, il s'est avéré environ 8,3. </font><font style="vertical-align: inherit;">En fait, cela suffit pour un tel jouet, mais les frais généraux sont assez visibles.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comportement du robot</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'idée est assez simple: si le robot voit une personne, il doit se diriger vers lui et secouer la boîte. Secouer le pot est assez simple et amusant, mais vous devez d'abord vous rendre à la personne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe une fonction </font></font><code>follow_face</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui, s'il y a un visage dans le cadre, fait tourner le châssis et la tête du robot dans sa direction (seule la face la plus proche du centre est prise en compte). Cela est nécessaire pour que le robot garde toujours son cap sur une personne, s'il est dans le cadre, et regarde également directement en face lorsqu'il secoue un pot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La </font></font><code>camera_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">même variable est utilisée </font><font style="vertical-align: inherit;">pour synchroniser cette fonction avec le sujet </font><font style="vertical-align: inherit;">.</font></font><code>face_processed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, comme dans la version avec flux. L'idée est la même: nous voulons traiter les données une seule fois, car le robot est en mouvement constant. La fonction attend d'abord que le rappel du sujet avec les détections abaisse l'indicateur que la dernière trame a été traitée. Pendant qu'elle attend, elle appelle constamment </font></font><code>ros::spinOnce()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour recevoir de nouveaux messages (en général, cela doit être fait partout où le programme attend de nouvelles données). S'il y a un visage dans le cadre, les angles sont calculés, ce qui nécessite de faire pivoter la plate-forme et la tête - cela peut être fait en connaissant les coordonnées relatives du centre du visage et le champ de vision de la caméra horizontalement et verticalement. Après cela, vous pouvez appeler le service </font></font><code>servo_head_platform</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et déplacer le robot.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a un point subtil: les informations sur la position du visage sont en retard sur le mouvement réel du visage et peuvent être en retard sur les mouvements du robot lui-même. Par conséquent, le robot peut surestimer l'angle de rotation, à cause duquel la tête commence à se déplacer d'avant en arrière avec une amplitude croissante. Pour éviter cela, je fais des retards après le déplacement (300 ms) et saute également une image après le déplacement. Dans le même but, les angles de rotation du châssis et de la tête sont multipliés par un facteur de 0,8 (les composants P du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contrôleur PID ont du</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sens </font><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fonction</font></font><code>follow_face</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renvoie le statut d'une personne. </font><font style="vertical-align: inherit;">Une personne peut: être absente, être suffisamment proche du centre, trop éloignée du robot; </font><font style="vertical-align: inherit;">une autre option - lorsque nous avons tourné le robot et ne savons pas ce qui est arrivé au visage (dans le processus de recherche); </font><font style="vertical-align: inherit;">il y a encore un cas rare où la tête est à la frontière, c'est pourquoi il est impossible de se tourner vers le visage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une chose assez simple se produit dans la boucle principale:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appelez </font></font><code>follow_face</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jusqu'à ce que la personne ait un certain statut (n'importe lequel, sauf «dans le processus de recherche»). </font><font style="vertical-align: inherit;">À la fin de cette étape, le robot regardera directement le visage.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le visage est trouvé et qu'il est proche: </font></font><br>
 <ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secouez la boîte;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retrouver le visage;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le visage est en place, faites une bonne expression avec les sourcils et secouez à nouveau le pot;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le visage a disparu, faites une expression de colère avec les sourcils;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retournez-vous, allez au début du cycle.</font></font></li>
</ol><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il n'y a personne (ou c'est loin) - navigation dans la pièce:</font></font><br>
 <ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il n'y a pas d'obstacles des deux côtés, avancez (si le visage a été trouvé, mais s'est avéré trop éloigné, le robot ira vers la personne);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si les obstacles sont proches des deux côtés, faites un tour aléatoire dans la plage </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x222A;</mo><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>180</mn><mo>,</mo><mo>&amp;#x2212;</mo><mn>90</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.479ex" height="2.634ex" viewBox="0 -809.3 9678.3 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2C" x="1279" y="0"></use><g transform="translate(1724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5D" x="3226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-222A" x="3726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5B" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2212" x="4895" y="0"></use><g transform="translate(5673,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2C" x="7175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2212" x="7620" y="0"></use><g transform="translate(8398,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5D" x="9399" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy="false">]</mo><mo>∪</mo><mo stretchy="false">[</mo><mo>−</mo><mn>180</mn><mo>,</mo><mo>−</mo><mn>90</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">[90, 180] \cup [-180, -90]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si l'obstacle n'est que d'un côté, tournez dans la direction opposée à un angle aléatoire </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>90</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.815ex" height="2.634ex" viewBox="0 -809.3 2503.7 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2C" x="779" y="0"></use><g transform="translate(1224,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5D" x="2225" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>90</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">[0, 90]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le mouvement vers l'avant continue trop longtemps (peut-être bloqué), reculez un peu et faites un tour aléatoire dans la plage </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x222A;</mo><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>180</mn><mo>,</mo><mo>&amp;#x2212;</mo><mn>90</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.479ex" height="2.634ex" viewBox="0 -809.3 9678.3 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2C" x="1279" y="0"></use><g transform="translate(1724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5D" x="3226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-222A" x="3726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5B" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2212" x="4895" y="0"></use><g transform="translate(5673,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2C" x="7175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-2212" x="7620" y="0"></use><g transform="translate(8398,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhiWyMxQAxdtoLQjmCT2bvACqUgbwQ#MJMAIN-5D" x="9399" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy="false">]</mo><mo>∪</mo><mo stretchy="false">[</mo><mo>−</mo><mn>180</mn><mo>,</mo><mo>−</mo><mn>90</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">[90, 180] \cup [-180, -90]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font></font></li>
</ol><br>
 </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet algorithme ne prétend pas être une forte intelligence artificielle, cependant, un comportement aléatoire et un large pare-chocs permettent au robot de se lever de presque n'importe quelle position tôt ou tard.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgré son apparente simplicité, ce projet couvre de nombreux sujets non triviaux: travail avec capteurs analogiques, travail avec PWM, vision par ordinateur, coordination des tâches asynchrones. </font><font style="vertical-align: inherit;">De plus, c'est juste incroyablement amusant. </font><font style="vertical-align: inherit;">Probablement, plus loin, je ferai quelque chose de plus significatif, mais plus avec un parti pris dans l'apprentissage profond. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En bonus - la galerie:</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/el/cw/jd/elcwjdoa21liogjvhakstzg-yru.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/il/12/fp/il12fpucbbreblnwyb2ojwsfmwu.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/3w/kr/7m/3wkr7mfjqjo2b_f9kvekia82ztq.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/z4/3q/wr/z43qwrmlfgwndbi3dw-jnvxzqew.jpeg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500140/index.html">"Jusqu'à 10 mille": plus de 25 avis sur les écouteurs</a></li>
<li><a href="../fr500142/index.html">Gérer les droits au niveau de l'installation</a></li>
<li><a href="../fr500144/index.html">David O'Brien (Xirus): Mesures! Métrique! Métrique! Partie 1</a></li>
<li><a href="../fr500146/index.html">Recherche d'emploi en Allemagne en tant que chef de produit et plus encore. Partie 3/5. Ce que vous devez faire avant de commencer à envoyer des CV</a></li>
<li><a href="../fr500148/index.html">Filtre pare-feu Mikrotik: script générant la base d'une politique de filtrage</a></li>
<li><a href="../fr500152/index.html">Comment j'ai intégré POS-terminal et FR IKKM-Touch dans 1C: entreprise</a></li>
<li><a href="../fr500154/index.html">Apprentissage automatique confidentiel. Bibliothèque PySyft</a></li>
<li><a href="../fr500158/index.html">Interaction de SwiftUI avec Redux</a></li>
<li><a href="../fr500160/index.html">Éléments visuels</a></li>
<li><a href="../fr500162/index.html">Super tutoriel de traitement de données sportives python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>