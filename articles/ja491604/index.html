<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍟 🛏️ ↩️ 高水準言語コンパイラーまたはマウスの歌を備えたネイティブFPGAソフトプロセッサー 🌘 ☝🏿 🏴</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="高水準言語コンパイラまたはマウスの歌を備えた独自のFPGAソフトプロセッサ-高水準言語コンパイラをスタックプロセッサコアに適合させた経験
 
 ソフトウェアプロセッサの一般的な問題は、特にそれらの命令システムが一般的なプロセッサコアの1つの命令のサブセットでない場合は、開発ツールが不足していることで...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>高水準言語コンパイラーまたはマウスの歌を備えたネイティブFPGAソフトプロセッサー</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491604/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高水準言語コンパイラまたはマウスの歌を備えた独自のFPGAソフトプロセッサ-高水準言語コンパイラをスタックプロセッサコアに適合させた経験</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソフトウェアプロセッサの一般的な問題は、特にそれらの命令システムが一般的なプロセッサコアの1つの命令のサブセットでない場合は、開発ツールが不足していることです。この場合、開発者はこの問題を解決する必要があります。その直接的な解決策は、アセンブラー言語コンパイラーを作成することです。ただし、プロジェクトの開発の過程で、たとえば要件の変更などによりコマンドシステムが変更される可能性があるため、現代の現実では、アセンブラで作業することが常に便利であるとは限りません。したがって、ソフトウェアプロセッサ用の高水準言語コンパイラ（JAV）を簡単に実装するタスクが重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonコンパイラ-Uzhは、ソフトウェアプロセッサ用のソフトウェアを開発するための簡単で便利なツールキットのようです。プリミティブとマクロをターゲット言語の関数として定義するためのツールキットにより、重要な場所をプロセッサーのアセンブリ言語で実装できます。このホワイトペーパーでは、スタックアーキテクチャプロセッサ用のコンパイラ適応の主要なポイントについて説明します。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エピグラフの代わりに：</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたが成体のマウスを取り、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それを慎重に持って、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それに針を詰め込む</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
と、ハリネズミができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このハリネズミなら、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
鼻が詰まって、呼吸しないように、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どこか深く、川に投げ込む</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とラフができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このラフなら</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、悪徳で頭を</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
抱えて、尾で強く</font><font style="vertical-align: inherit;">引っ張れば</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ヘビができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これならもう</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
二枚ナイフを用意したのに… </font><font style="vertical-align: inherit;">
でも、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たぶん彼は死ぬだろう</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">けど、アイディアはいい！</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 多くの場合、測定機器、研究機器を実装する場合、システムのメインコアとして再構成可能なFPGA / FPGAソリューションを使用することが推奨されます。このアプローチには、作業のロジックを簡単かつ迅速に変更できること、およびデータ処理と制御信号のハードウェアアクセラレーションにより、多くの利点があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デジタル信号処理、組み込み制御システム、データ取得および分析システムなどの幅広いタスクに対して、アプローチはそれ自体が証明されており、FPGAロジックによって実装された1つのソリューションブロックを1つまたは一般的な管理と調整のため、およびユーザーまたは外部デバイス/ノードとの相互作用を実装するためのいくつかのソフトウェアプロセッサ </font><font style="vertical-align: inherit;">この場合のソフトウェアプロセッサの使用により、システム制御アルゴリズムまたは個々のノードの相互作用アルゴリズムのデバッグと検証に費やす時間をわずかに減らすことができます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">典型的なウィッシュリスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 多くの場合、この場合のソフトプロセッサは超高性能を必要としません（簡単に実現できるため、FPGAの論理リソースとハードウェアリソースを使用しています）。</font><font style="vertical-align: inherit;">それらは非常に単純です（そして現代のマイクロコントローラーの観点から-ほとんど原始的）。</font><font style="vertical-align: inherit;">複雑な割り込みシステムなしで実行でき、特定のノードまたはインターフェースでのみ機能します。特定のコマンドシステムをサポートする必要はありません。</font><font style="vertical-align: inherit;">それらは多数存在する可能性がありますが、それぞれは特定のアルゴリズムまたはサブプログラムのセットのみを実行できます。</font><font style="vertical-align: inherit;">現在のタスクの要件に応じて、ソフトプロセッサの容量は、バイトの倍数ではなく、任意の値にすることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソフトプロセッサの一般的なターゲットは次のとおりです。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドシステムの十分な機能。タスクに最適化されている可能性があります。</font></font></li>
<li>   , ..      ;</li>
<li> –   ,        .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 もちろん、ソフトウェアプロセッサの問題は、特に命令システムが一般的なプロセッサコアの1つの命令のサブセットではない場合、それらの開発ツールがないことです。</font><font style="vertical-align: inherit;">この場合、開発者はこの問題を解決する必要があります。</font><font style="vertical-align: inherit;">その直接的な解決策は、ソフトウェアプロセッサ用のアセンブラ言語コンパイラを作成することです。</font><font style="vertical-align: inherit;">ただし、現代の現実では、特に要件の変更などによりプロジェクトの開発中にチームシステムが変更された場合は特に、アセンブラーで作業することが常に便利であるとは限りません。</font><font style="vertical-align: inherit;">したがって、ソフトプロセッサ用の高水準言語コンパイラ（HLV）を簡単に実装するという要件を上記の要件に追加することは論理的です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースコンポーネント</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 スタックプロセッサは、次のように高い割合のコンプライアンスでこれらの要件を満たします。</font><font style="vertical-align: inherit;">レジスタをアドレス指定する必要はありません。コマンドのビット深度は小さい場合があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらのデータのビット深度は変化する可能性があり、コマンドシステムのビット深度とは関係ありません。</font><font style="vertical-align: inherit;">コンパイル中のプログラムコードの中間表現（仮想スタックマシン、またはコンテキストフリーの文法-ストアオートマトン）の事実上の（いくつかの注意点はありますが）ハードウェア実装であるため、低コストであらゆる言語の文法を実行可能なコードに変換することが可能です。</font><font style="vertical-align: inherit;">さらに、スタックプロセッサの場合、フォート言語は実質的に「ネイティブ」言語です。</font><font style="vertical-align: inherit;">スタックプロセッサ用のFortコンパイラの実装にかかる人件費は、アセンブラのそれに匹敵し、将来のプログラムの実装における柔軟性と効率が大幅に向上します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リアルタイムに近いモードでスマートセンサーからデータを収集するためのシステムを構築するタスクがあるため、[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font><font style="vertical-align: inherit;">で説明されているソフトプロセッサの参照ソリューション（いわゆるリファレンスデザイン）としてFortプロセッサが選択されました</font><font style="vertical-align: inherit;">（以下、作者のニックネームでwhiteTigerプロセッサと呼ばれることもあります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その主な機能：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データとリターンスタックを分離する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハーバードメモリ構成アーキテクチャ（アドレススペースを含む、別個のプログラムとデータメモリ）;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シンプルなパラレルバスを使用した周辺機器による拡張。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセッサはパイプラインを使用せず、コマンドの実行はプッシュプルです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドとオペランドをフェッチします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> コマンドの実行と結果の保存。</font></font></li>
</ol></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 プロセッサには、プログラムコードのUARTローダーが追加されています。これにより、FPGAのプロジェクトを再コンパイルせずに実行可能プログラムを変更できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FPGAのブロックメモリの構成に関しては、命令の容量は9ビットに設定されています。データのビット深度は32ビットに設定されていますが、基本的には任意です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセッサコードは、特定のライブラリを使用せずにVHDLで記述されているため、どのメーカーのFPGAでもこのプロジェクトを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
比較的広く使用され、「入力しきい値」を下げ、コードを再利用してコード開発を適用する場合は、フォート以外のJavaエンジンに切り替える方が適切です（これは、この言語の複雑さとコードの可読性に関する鉱山ストリームプログラマーの迷信と誤解が原因の1つです） （ちなみに、この作品の著者の1人は、Cのような言語について同様の意見を持っています）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの要因に基づいて、ソフトウェアプロセッサとJava言語エンジンを「バ​​インド」する実験のためにPython言語（Python）が選択されました。これは、開発者の生産性とコードの可読性の向上に焦点を当てた高レベルの汎用プログラミング言語であり、構造、オブジェクト指向、機能、命令、アスペクト指向などのいくつかのプログラミングパラダイムをサポートします[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初心者開発者のために、その拡張MyHDL [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]は</font><font style="vertical-align: inherit;">興味深い</font><font style="vertical-align: inherit;">Pythonでハードウェア要素および構造を記述し、VHDLまたはVerilogコードにそれらを変換することを可能にします。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しばらく前に、Uzhコンパイラ[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font><font style="vertical-align: inherit;">が発表され</font><font style="vertical-align: inherit;">ました-Zmey FPGAソフトウェアプロセッサ用の小さなコンパイラ（マルチスレッドサポート付き32ビットスタックアーキテクチャ-バージョン/変更/検証のチェーンを追跡する場合-ZmeyはwhiteTigerプロセッサの遠い子孫です）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uzhは有望raddslツールキット（迅速DSLコンパイラのプロトタイプを作成するためのツールのセット）に基づいて、また、パイソンの静的にコンパイルされたサブセットである</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、作業の方向の選択に影響を与えた要因は、おおよそ次のように定式化できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FPGA上のデバイスやシステムの初心者向けの「エントリしきい値」を下げるツールへの関心（構文的には、PythonはVHDLほど初心者には「怖い」ではありません）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> プロジェクトで調和と単一のスタイルを追求する（Pythonでソフトウェアプロセッサに必要なハードウェアブロックとソフトウェアを記述することは理論的には可能です）;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 偶然の偶然。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小さく「ほとんど」意味のないニュアンス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Zmeyプロセッサのソースコードは公開されていませんが、その動作原理といくつかのアーキテクチャ機能の説明が利用可能です。</font><font style="vertical-align: inherit;">スタックも可能ですが、whiteTigerプロセッサとの主な違いがいくつかあります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタックはソフトウェアです。</font><font style="vertical-align: inherit;">ポインタで表され、データメモリのさまざまなアドレスに配置されます。</font></font></li>
<li>     ,      - ;</li>
<li>          ;</li>
<li>  ,         .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 したがって、Uzhコンパイラはこれらの機能を考慮に入れます。コンパイラはPythonコードを受け入れ、出力でブートストリームを生成してプログラムメモリとプロセッサデータメモリを開始します。重要な点は、すべての言語機能がコンパイル段階で利用できることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uzhコンパイラーをインストールするには、そのアーカイブをダウンロードし、任意の便利なフォルダーに解凍します（キリル文字とスペースを含むパスを避けるために、特殊なソフトウェアの一般的な推奨事項に従うことをお勧めします）。また、raddslツールキットをダウンロードして、コンパイラのメインフォルダに解凍する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイラーのテストフォルダーにはソフトプロセッサ用のプログラムの例が含まれ、srcフォルダーにはコンパイラー要素のソーステキストが含まれています。</font><font style="vertical-align: inherit;">便宜上、内容を含む小さなバッチファイル（拡張子.cmd）を作成することをお</font></font><b><code>c.py C:\D\My_Docs\Documents\uzh-master\tests\abc.py</code> </b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">勧めします。ここで、abc.pyはソフ​​トプロセッサ用のプログラムを含むファイルの名前です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尾を噛むヘビ、または鉄とソフトウェアをラッピングするヘビ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 UzhをwhiteTigerプロセッサに適応させるには、いくつかの変更が必要になるだけでなく、プロセッサ自体も少し修正する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸い、コンパイラーで調整する場所は多くありません。</font><font style="vertical-align: inherit;">主な「ハードウェア依存」ファイル：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asm.py-アセンブラーと数値の形成（リテラル）;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gen.py-低レベルのコード生成規則（関数、変数、遷移、条件）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stream.py-ブートストリームの形成。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macro.py-実際にはマクロ定義-ハードウェア固有の機能を備えた基本言語の拡張。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 オリジナルのwhiteTigerプロセッサデザインでは、UARTローダーはプログラムメモリのみを初期化します。</font><font style="vertical-align: inherit;">ブートローダーのアルゴリズムはシンプルですが、十分に確立されており、信頼性があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ローダーは、特定の制御バイトを受信すると、プロセッサリセットの内部ラインにアクティブレベルを設定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2番目のバイトコマンドは、メモリアドレスカウンターをリセットします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下は、送信された単語のノートブックのシーケンスであり、ノートブック番号と組み合わせて、最も若いものから始まります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> パックされたノートブックの各バイトの後に、1組の制御バイトが続きます。最初の制御バイトはメモリ書き込み許可ラインのアクティブレベルを設定し、2番目はそれをリセットします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パックされたノートブックのシーケンスが完了すると、リセットラインのアクティブレベルが制御バイトによって削除されます。 </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 コンパイラもデータメモリを使用するため、データメモリも初期化できるようにローダーを変更する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データメモリはプロセッサコアのロジックに含まれるため、そのデータと制御ラインを多重化する必要があります。</font><font style="vertical-align: inherit;">このために、追加の信号DataDinBtemp、LoaderAddrB、DataWeBtempが導入されています-データ、アドレス、メモリ内のポートの記録解像度。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ブートローダーのコードは次のようになります。</font></font><br>
<br>
<pre><code class="vhdl hljs">uart_unit: <span class="hljs-keyword">entity</span> work.uart
<span class="hljs-comment">--uart_unit: entity uart</span>
  <span class="hljs-keyword">Generic</span> <span class="hljs-keyword">map</span>(<font></font>
    ClkFreq =&gt; <span class="hljs-number">50_000_000</span>,<font></font>
    Baudrate =&gt; <span class="hljs-number">115200</span>)
  <span class="hljs-keyword">port</span> <span class="hljs-keyword">map</span>(<font></font>
    clk =&gt; clk,<font></font>
    rxd =&gt; rx,<font></font>
    txd =&gt; tx,<font></font>
    dout =&gt; receivedByte,<font></font>
    received =&gt; received,<font></font>
    din =&gt; transmitByte,<font></font>
    transmit =&gt; transmit);<font></font>
    <font></font>
<span class="hljs-keyword">process</span>(clk)
<span class="hljs-keyword">begin</span>
  <span class="hljs-keyword">if</span> rising_edge(clk) <span class="hljs-keyword">then</span>
    <span class="hljs-keyword">if</span> received = <span class="hljs-string">'1'</span> <span class="hljs-keyword">then</span>
      <span class="hljs-keyword">case</span> conv_integer(receivedByte) <span class="hljs-keyword">is</span>
      <span class="hljs-comment">-- 0-F   - 0-3 bits</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">0</span> <span class="hljs-keyword">to</span> <span class="hljs-number">15</span> =&gt; CodeDinA(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);<font></font>
		                  DataDinBtemp(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);
      <span class="hljs-comment">-- 10-1F -4-7bits</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">16</span> <span class="hljs-keyword">to</span> <span class="hljs-number">31</span> =&gt; CodeDinA(<span class="hljs-number">7</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">4</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);<font></font>
		                   DataDinBtemp(<span class="hljs-number">7</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">4</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>); 
      <span class="hljs-comment">-- 20-2F -8bit </span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">32</span> <span class="hljs-keyword">to</span> <span class="hljs-number">47</span> =&gt; CodeDinA(<span class="hljs-number">8</span>) &lt;= receivedByte(<span class="hljs-number">0</span>);<font></font>
	                   DataDinBtemp(<span class="hljs-number">11</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">8</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);
	  <span class="hljs-keyword">when</span> <span class="hljs-number">48</span> <span class="hljs-keyword">to</span> <span class="hljs-number">63</span> =&gt; DataDinBtemp(<span class="hljs-number">15</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">12</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);
	  <span class="hljs-keyword">when</span> <span class="hljs-number">64</span> <span class="hljs-keyword">to</span> <span class="hljs-number">79</span> =&gt; DataDinBtemp(<span class="hljs-number">19</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">16</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);
	  <span class="hljs-keyword">when</span> <span class="hljs-number">80</span> <span class="hljs-keyword">to</span> <span class="hljs-number">95</span> =&gt; DataDinBtemp(<span class="hljs-number">23</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">20</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);
	  <span class="hljs-keyword">when</span> <span class="hljs-number">96</span> <span class="hljs-keyword">to</span> <span class="hljs-number">111</span> =&gt; DataDinBtemp(<span class="hljs-number">27</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">24</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);
        <span class="hljs-keyword">when</span> <span class="hljs-number">112</span> <span class="hljs-keyword">to</span> <span class="hljs-number">127</span> =&gt; DataDinBtemp(<span class="hljs-number">31</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">28</span>) &lt;= receivedByte(<span class="hljs-number">3</span> <span class="hljs-keyword">downto</span> <span class="hljs-number">0</span>);<font></font>
<font></font>
      <span class="hljs-comment">-- F0 addr=0</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">240</span> =&gt; CodeAddrA &lt;= (<span class="hljs-keyword">others</span> =&gt; <span class="hljs-string">'0'</span>);
      <span class="hljs-comment">-- F1 - WE=1</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">241</span> =&gt; CodeWeA &lt;= <span class="hljs-string">'1'</span>;
      <span class="hljs-comment">-- F2 WE=0 addr++</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">242</span> =&gt; CodeWeA &lt;= <span class="hljs-string">'0'</span>; CodeAddrA &lt;= CodeAddrA + <span class="hljs-number">1</span>;
      <span class="hljs-comment">-- F3 RESET=1</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">243</span> =&gt; int_reset &lt;= <span class="hljs-string">'1'</span>;
      <span class="hljs-comment">-- F4 RESET=0</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">244</span> =&gt; int_reset &lt;= <span class="hljs-string">'0'</span>;<font></font>
<font></font>
      <span class="hljs-comment">-- F5 addr=0</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">245</span> =&gt; LoaderAddrB &lt;= (<span class="hljs-keyword">others</span> =&gt; <span class="hljs-string">'0'</span>);
      <span class="hljs-comment">-- F6 - WE=1</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">246</span> =&gt; DataWeBtemp &lt;= <span class="hljs-string">'1'</span>;
      <span class="hljs-comment">-- F7 WE=0 addr++</span>
        <span class="hljs-keyword">when</span> <span class="hljs-number">247</span> =&gt; DataWeBtemp &lt;= <span class="hljs-string">'0'</span>; LoaderAddrB &lt;= LoaderAddrB + <span class="hljs-number">1</span>;<font></font>
		  <font></font>
		  <font></font>
        <span class="hljs-keyword">when</span> <span class="hljs-keyword">others</span> =&gt; <span class="hljs-keyword">null</span>;
      <span class="hljs-keyword">end</span> <span class="hljs-keyword">case</span>;
    <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span>;
  <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span>;
<span class="hljs-keyword">end</span> <span class="hljs-keyword">process</span>;<font></font>
<font></font>
<span class="hljs-comment">---- end of loader</span><font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アクティブなリセットレベルでは、DataDinBtemp、LoaderAddrB、DataWeBtemp信号が対応するデータメモリポートに接続されます。</font></font><br>
<br>
<pre><code class="vhdl hljs">…
    <span class="hljs-keyword">if</span> reset = <span class="hljs-string">'1'</span> <span class="hljs-keyword">or</span> int_reset = <span class="hljs-string">'1'</span> <span class="hljs-keyword">then</span>
      DSAddrA &lt;= (<span class="hljs-keyword">others</span> =&gt; <span class="hljs-string">'0'</span>);      <font></font>
      <font></font>
      RSAddrA &lt;= (<span class="hljs-keyword">others</span> =&gt; <span class="hljs-string">'0'</span>);<font></font>
      RSAddrB &lt;= (<span class="hljs-keyword">others</span> =&gt; <span class="hljs-string">'0'</span>);<font></font>
      RSWeA &lt;= <span class="hljs-string">'0'</span>;<font></font>
      <font></font>
      DataAddrB &lt;= LoaderAddrB;<font></font>
		DataDinB&lt;=DataDinBtemp;<font></font>
		DataWeB&lt;=DataWeBtemp;<font></font>
      DataWeA &lt;= <span class="hljs-string">'0'</span>;<font></font>
…<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブートローダーアルゴリズムに従って、stream.pyモジュールを変更する必要があります。現在、2つの機能があります。最初の関数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-get_val（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -入力ワードを必要な数の</font><i><font style="vertical-align: inherit;">テトラッドに</font></i><font style="vertical-align: inherit;">分割します。したがって、whiteTigerプロセッサの9ビット命令の場合、それらは3つのテトラッドのグループ、および8つのテトラッドのシーケンスの32ビットデータに変換されます。 2番目の関数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">make（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ブートストラップを直接形成します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストリームモジュールの最終的な形式：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_val</span>(<span class="hljs-params">x, by_4</span>):</span><font></font>
  r = []<font></font>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(by_4):<font></font>
    r.append((x &amp; <span class="hljs-number">0xf</span>) | (i &lt;&lt; <span class="hljs-number">4</span>))<font></font>
    x &gt;&gt;= <span class="hljs-number">4</span>
  <span class="hljs-keyword">return</span> r<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make</span>(<span class="hljs-params">code, data, core=<span class="hljs-number">0</span></span>):</span>
  <span class="hljs-comment">#        0  </span>
  stream = [<span class="hljs-number">243</span>,<span class="hljs-number">245</span>] 
  <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data:
    <span class="hljs-comment">#    32- </span>
    <span class="hljs-comment">#         </span>
    stream += get_val(x, <span class="hljs-number">8</span>) + [<span class="hljs-number">246</span>, <span class="hljs-number">247</span>]
  <span class="hljs-comment">#       0</span>
  stream += [<span class="hljs-number">240</span>]
  <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> code:
    <span class="hljs-comment">#    9-  </span>
    <span class="hljs-comment">#         </span>
    stream += get_val(x, <span class="hljs-number">3</span>) + [<span class="hljs-number">241</span>, <span class="hljs-number">242</span>]
  <span class="hljs-comment">#  </span>
  stream.append(<span class="hljs-number">244</span>)<font></font>
<font></font>
  <span class="hljs-keyword">return</span> bytearray(stream)<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 コンパイラーの以下の変更は、プロセッサーコマンドシステム（コマンドニーモニックとコマンドオペコードが書き込まれます）と数値を表現/コンパイルする方法を記述するasm.pyモジュールに影響します-リテラル。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドはディクショナリにパックされ、lite（）関数はリテラルを担当します。コマンドシステムですべてが単純な場合-ニーモニックと対応するオペコードのリストが変更されるだけで、リテラルの状況は少し異なります。 Zmeyプロセッサには8ビットの命令があり、リテラルを操作するための特別な命令がいくつかあります。 whiteTigerでは、9番目のビットは、オペコードがコマンドであるか、数値の一部であるかを示します。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ワードの最上位（9番目）ビットが1の場合、オペコードは数値として解釈されます。たとえば、数値の符号が付いた4つの連続したオペコードは、結果として32ビットの数値を形成します。</font><font style="vertical-align: inherit;">番号の終わりの記号は、コマンドのオペコードの存在です。明確性と均一性を確保するために、番号の決定の終わりは、NOPコマンドのオペコード（「操作なし」）です。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、変更されたlit（）関数は次のようになります。</font></font><br>
<br>
<pre><code class="python hljs">
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">lit</span>(<span class="hljs-params">x</span>):</span>
  x &amp;= <span class="hljs-number">0xffffffff</span><font></font>
  r = [] <font></font>
  <span class="hljs-keyword">if</span> (x&gt;&gt;<span class="hljs-number">24</span>) &amp; <span class="hljs-number">255</span> :<font></font>
    r.append(int((x&gt;&gt;<span class="hljs-number">24</span>) &amp; <span class="hljs-number">255</span>) | <span class="hljs-number">256</span>)
  <span class="hljs-keyword">if</span> (x&gt;&gt;<span class="hljs-number">16</span>) &amp; <span class="hljs-number">255</span>:<font></font>
    r.append(int((x&gt;&gt;<span class="hljs-number">16</span>) &amp; <span class="hljs-number">255</span>) | <span class="hljs-number">256</span>)
  <span class="hljs-keyword">if</span> (x&gt;&gt;<span class="hljs-number">8</span>) &amp; <span class="hljs-number">255</span>:<font></font>
    r.append(int((x&gt;&gt;<span class="hljs-number">8</span>) &amp; <span class="hljs-number">255</span>) | <span class="hljs-number">256</span>)<font></font>
  r.append(int(x &amp; <span class="hljs-number">255</span>) | <span class="hljs-number">256</span>)<font></font>
  r += asm(<span class="hljs-string">"NOP"</span>)
  <span class="hljs-keyword">return</span> list(r)<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主で最も重要な変更/定義はgen.pyモジュールにあります。</font><font style="vertical-align: inherit;">このモジュールは、アセンブラーレベルでの高レベルコードの作業/実行の基本ロジックを定義します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件付きおよび無条件ジャンプ。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数を呼び出して引数を渡す。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数から戻り、結果を返す。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムメモリ、データメモリ、スタックのサイズの調整。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセッサの起動時の一連のアクション。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Javaをサポートするには、プロセッサはメモリとポインタをかなりランダムに処理でき、ローカル変数関数を格納するためのメモリ領域が必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zmeyプロセッサでは、リターンスタックを使用してローカル変数と関数引数を操作します-関数引数はそれに転送され、その後の作業中に、リターンスタックのポインターレジスタを介してアクセスされます（読み取り、上/下の変更、ポインターアドレスでの読み取り）。スタックは物理的にデータメモリに配置されているため、このような操作は基本的にメモリ操作になり、グローバル変数は同じメモリ内に配置されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
whiteTigerでは、リターンスタックとデータスタックはアドレス空間を持つ専用ハードウェアスタックであり、スタックポインター命令はありません。したがって、関数に引数を渡したり、ローカル変数を操作したりする操作は、データメモリを通じて整理する必要があります。データスタックの容量を増やして、比較的大きなデータアレイを格納できる可能性がある場合は、あまり意味がありません。わずかに大きなデータメモリを用意する方が論理的です。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ローカル変数を操作するために、専用のLocalRegレジスタが追加されました。そのタスクは、ローカル変数に割り当てられたメモリ領域（一種のヒープ）へのポインタを格納することです。それを操作するための操作も追加されました（cpu.vhdファイル-コマンド定義領域）：</font></font><br>
<br>
<pre><code class="vhdl hljs">
          <span class="hljs-comment">-- group 1; pop 0; push 1;</span>
          <span class="hljs-keyword">when</span> cmdLOCAL =&gt; DSDinA &lt;= LocalReg;
			 <span class="hljs-keyword">when</span> cmdLOCALadd =&gt; DSDinA &lt;= LocalReg; LocalReg &lt;= LocalReg+<span class="hljs-number">1</span>;
			 <span class="hljs-keyword">when</span> cmdLOCALsubb =&gt; DSDinA &lt;= LocalReg; LocalReg &lt;= LocalReg-<span class="hljs-number">1</span>;<font></font>
…<font></font>
          <span class="hljs-comment">-- group 2; pop 1; push 0;</span>
          <span class="hljs-keyword">when</span> cmdSETLOCAL =&gt; LocalReg &lt;= DSDinA;<font></font>
…<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LOCAL-LocalRegポインターの現在の値をデータスタックに返します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SETLOCAL-データスタックから受け取った新しいポインタ値を設定します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LOCALadd-ポインターの現在の値をデータスタックに残し、1ずつインクリメントします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LOCALsubb-ポインターの現在の値をデータスタックに残し、値を1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
減らし</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。LOCALaddおよびLOCALsubbが追加され、関数パラメーターを渡す操作中のティック数を減らします。逆も同様です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元のwhiteTigerとは異なり、データメモリ接続はわずかに変更されました。現在、メモリ内ポートはデータスタックの最初のセルの出力によって常にアドレス指定され、データスタックの2番目のセルの出力はその入力に供給されます。</font></font><br>
<br>
<pre><code class="vhdl hljs"><span class="hljs-comment">-- ++</span>
DataAddrB &lt;= DSDoutA(DataAddrB<span class="hljs-symbol">'range</span>);<font></font>
DataDinB &lt;= DSDoutB;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 STOREおよびFETCHコマンドを実行するためのロジックも少し修正されました。FETCHはデータスタックの最上部にあるメモリ内のポートの出力値を受け取り、STOREはポートBの書き込みイネーブル信号を制御するだけです。</font></font><br>
<br>
<pre><code class="vhdl hljs">…
          <span class="hljs-comment">-- group 3; pop 1; push 1;</span>
          <span class="hljs-keyword">when</span> cmdFETCH =&gt; DSDinA &lt;= DataDoutB;<font></font>
…<font></font>
          <span class="hljs-keyword">when</span> cmdSTORE =&gt;            <font></font>
            DataWeB &lt;= <span class="hljs-string">'1'</span>;<font></font>
…<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングの一部として、および低レベル（およびFort言語のコンパイラレベル）でのループのハードウェアサポートの一部として、ループカウンターのスタックがwhiteTigerコアに追加されました（アクションは、データを宣言してスタックを返す場合と同様です）。</font></font><br>
<br>
<pre><code class="vhdl hljs">…
<span class="hljs-comment">--  </span>
<span class="hljs-keyword">type</span> TCycleStack <span class="hljs-keyword">is</span> <span class="hljs-keyword">array</span>(<span class="hljs-number">0</span> <span class="hljs-keyword">to</span> LocalSize-<span class="hljs-number">1</span>) <span class="hljs-keyword">of</span> DataSignal;
<span class="hljs-keyword">signal</span> CycleStack: TCycleStack;
<span class="hljs-keyword">signal</span> CSAddrA, CSAddrB: StackAddrSignal;
<span class="hljs-keyword">signal</span> CSDoutA, CSDoutB: DataSignal;
<span class="hljs-keyword">signal</span> CSDinA, CSDinB: DataSignal;
<span class="hljs-keyword">signal</span> CSWeA, CSWeB: <span class="hljs-built_in">std_logic</span>;<font></font>
…<font></font>
<span class="hljs-comment">--  </span>
<span class="hljs-keyword">process</span>(clk)
<span class="hljs-keyword">begin</span>
  <span class="hljs-keyword">if</span> rising_edge(clk) <span class="hljs-keyword">then</span>
    <span class="hljs-keyword">if</span> CSWeA = <span class="hljs-string">'1'</span> <span class="hljs-keyword">then</span><font></font>
      CycleStack(conv_integer(CSAddrA)) &lt;= CSDinA;<font></font>
      CSDoutA &lt;= CSDinA;<font></font>
    <span class="hljs-keyword">else</span><font></font>
      CSDoutA &lt;= CycleStack(conv_integer(CSAddrA));<font></font>
    <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span>;
  <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span>;
<span class="hljs-keyword">end</span> <span class="hljs-keyword">process</span>;<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイクルカウンターコマンドが追加されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DO-サイクルの反復回数をデータスタックからカウンタースタックに移動し、インクリメントされた命令カウンターの値をリターンスタックに配置します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LOOP-カウンターのゼロ化をチェックし、到達しない場合は、カウンタースタックの一番上の要素がデクリメントされ、戻りスタックの一番上のアドレスへの遷移が実行されます。カウンタースタックのトップがゼロの場合、トップエレメントがリセットされ、リターンスタックのトップからサイクルの先頭までのリターンアドレスもリセットされます。</font></font><br>
<br>
<pre><code class="vhdl hljs">
	<span class="hljs-keyword">when</span> cmdDO =&gt; <span class="hljs-comment">-- DO - </span>
               RSAddrA &lt;= RSAddrA + <span class="hljs-number">1</span>; <span class="hljs-comment">-- </span>
               RSDinA &lt;= ip + <span class="hljs-number">1</span>;<font></font>
               RSWeA &lt;= <span class="hljs-string">'1'</span>;<font></font>
				<font></font>
               CSAddrA &lt;= CSAddrA + <span class="hljs-number">1</span>; <span class="hljs-comment">--</span><font></font>
         		CSDinA &lt;= DSDoutA;<font></font>
 		         CSWeA &lt;= <span class="hljs-string">'1'</span>;<font></font>
		         DSAddrA &lt;= DSAddrA - <span class="hljs-number">1</span>; <span class="hljs-comment">--</span>
		         ip &lt;= ip + <span class="hljs-number">1</span>;	<span class="hljs-comment">-- </span><font></font>
<font></font>
      <span class="hljs-keyword">when</span> cmdLOOP =&gt; <span class="hljs-comment">--            </span>
           <span class="hljs-keyword">if</span> conv_integer(CSDoutA) = <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
	          ip &lt;= ip + <span class="hljs-number">1</span>;	<span class="hljs-comment">-- </span>
		         RSAddrA &lt;= RSAddrA - <span class="hljs-number">1</span>; <span class="hljs-comment">-- </span>
		         CSAddrA &lt;= CSAddrA - <span class="hljs-number">1</span>; <span class="hljs-comment">-- </span>
            <span class="hljs-keyword">else</span>
		         CSDinA &lt;= CSDoutA - <span class="hljs-number">1</span>;<font></font>
		         CSWeA &lt;= <span class="hljs-string">'1'</span>;<font></font>
		         ip &lt;= RSDoutA(ip<span class="hljs-symbol">'range</span>);
            <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span>;<font></font>
			 <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、gen.pyモジュールのコードの変更を開始できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* _SIZE変数にはコメントは不要で、プロセッサコアプロジェクトで指定された値の置換のみが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
STUBリストは、遷移アドレスの場所を作成してコンパイラーで埋めるための一時的なスタブです（現在の値は、コードメモリの24ビットアドレス空間に対応します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
STARTUPリスト-リセット後にカーネルによって実行される一連のアクションを設定します。この場合、ローカル変数のメモリの開始アドレスは900に設定され、開始点への遷移（何も変更しない場合、アプリケーションの開始/エントリポイントはデータメモリアドレスのコンパイラに書き込まれます） 2）：</font></font><br>
<br>
<pre><code class="python hljs">STARTUP = asm(<span class="hljs-string">"""
900  SETLOCAL
2 NOP FETCH JMP
"""</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
func（）の定義は、関数が呼び出されたときに実行されるアクション、つまり関数引数をローカル変数の領域に転送すること、関数の独自のローカル変数のメモリ割り当てを規定しています。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">@act</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>(<span class="hljs-params">t, X</span>):</span><font></font>
  t.c.entry = t.c.globs[X]<font></font>
  t.c.entry[<span class="hljs-string">"offs"</span>] = len(t.c.code) <span class="hljs-comment"># - 1</span>
  args = t.c.entry[<span class="hljs-string">"args"</span>]<font></font>
  temps_size = len(t.c.entry[<span class="hljs-string">"locs"</span>]) - args
<span class="hljs-comment">#      </span>
  t.out = asm(<span class="hljs-string">"LOCALadd STORE "</span> * args)
  <span class="hljs-keyword">if</span> temps_size:
<span class="hljs-comment">#      </span>
    t.out += asm(<span class="hljs-string">"LOCAL %d PLUS SETLOCAL"</span> % temps_size)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Epilog（）は、関数から戻るときのアクションを定義します-一時変数のメモリを解放して、呼び出しポイントに戻ります。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">epilog</span>(<span class="hljs-params">t, X</span>):</span>
  locs_size = len(t.c.entry[<span class="hljs-string">"locs"</span>])
<span class="hljs-comment">#    </span>
  t.out = asm(<span class="hljs-string">"RET"</span>)
  <span class="hljs-keyword">if</span> locs_size:
<span class="hljs-comment">#    ()  </span>
    t.out = asm(<span class="hljs-string">"LOCAL %d MINUS SETLOCAL"</span> % locs_size) + t.out
  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数の操作はそれらのアドレスを介して行われます。このための重要な定義はpush_local（）で、データスタックに「高レベル」変数のアドレスを残します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push_local</span>(<span class="hljs-params">t, X</span>):</span>
<span class="hljs-comment">#          </span>
<span class="hljs-comment">#  </span>
  t.out = asm(<span class="hljs-string">"LOCAL %d MINUS"</span> % get_loc_offset(t, X))
  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の重要なポイントは、条件付き遷移と無条件遷移です。</font><font style="vertical-align: inherit;">whiteTigerプロセッサの条件付きジャンプは、データスタックの2番目の要素が0かどうかをチェックし、条件が満たされた場合はスタックの一番上のアドレスにジャンプします。</font><font style="vertical-align: inherit;">無条件ジャンプは、命令カウンターの値をスタックの一番上の値に設定するだけです。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">@act</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">goto_if_0</span>(<span class="hljs-params">t, X</span>):</span><font></font>
  push_label(t, X)<font></font>
  t.out += asm(<span class="hljs-string">"IF"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-meta">@act</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">goto</span>(<span class="hljs-params">t, X</span>):</span><font></font>
  push_label(t, X)<font></font>
  t.out += asm(<span class="hljs-string">"JMP"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の2つの定義は、ビットシフト演算を指定します。低レベルでループが適用されます（コードのサイズがいくらか向上します）。オリジナルでは、コンパイラーは必要な数の基本シフト演算を続けて配置します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">@act</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shl_const</span>(<span class="hljs-params">t, X</span>):</span>
  t.out = asm(<span class="hljs-string">"%d DO SHL LOOP"</span> %(X<span class="hljs-number">-1</span>))
  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-meta">@act</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shr_const</span>(<span class="hljs-params">t, X</span>):</span>
  t.out = asm(<span class="hljs-string">"%d DO SHR LOOP"</span> %(X<span class="hljs-number">-1</span>))
  <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
低レベルでのコンパイラの主な定義は、言語操作とメモリの操作に関する一連のルールです。</font></font><br>
<br>
<pre><code class="python hljs">stmt = rule(alt(<font></font>
  seq(Push(Int(X)), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"%d"</span> % v.X))),<font></font>
  seq(Push(Local(X)), push_local),<font></font>
  seq(Push(Global(X)), push_global),<font></font>
  seq(Load(), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"NOP FETCH"</span>))),<font></font>
  seq(Store(), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"STORE"</span>))),<font></font>
  seq(Call(), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"CALL"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"+"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"PLUS"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"-"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"MINUS"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"&amp;"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"AND"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"|"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"OR"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"^"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"XOR"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"*"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"MUL"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"&lt;"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"LESS"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"&gt;"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"GREATER"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"=="</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"EQUAL"</span>))),<font></font>
  seq(BinOp(<span class="hljs-string">"~"</span>), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"NOT"</span>))),<font></font>
  seq(ShlConst(X), shl_const),<font></font>
  seq(ShrConst(X), shr_const),<font></font>
  seq(Func(X), func),<font></font>
  seq(Label(X), label),<font></font>
  seq(Return(X), epilog),<font></font>
  seq(GotoIf0(X), goto_if_0),<font></font>
  seq(Goto(X), goto),<font></font>
  seq(Nop(), to(<span class="hljs-keyword">lambda</span> v: asm(<span class="hljs-string">"NOP"</span>))),<font></font>
  seq(Asm(X), to(<span class="hljs-keyword">lambda</span> v: asm(v.X)))<font></font>
))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
macro.pyモジュールを使用すると、ターゲットプロセッサのアセンブラでマクロ定義を使用して、ターゲット言語の辞書を「拡張」できます。</font><font style="vertical-align: inherit;">Javaコンパイラの場合、macro.pyの定義は、言語の「ネイティブ」演算子および関数と変わりません。</font><font style="vertical-align: inherit;">そのため、たとえば、元のコンパイラでは、外部ポートの値のI / O関数が定義されていました。</font><font style="vertical-align: inherit;">メモリとローカル変数の操作のテストシーケンスと時間遅延操作が追加されました。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">@macro(1,0)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testasm</span>(<span class="hljs-params">c,x</span>):</span>
  <span class="hljs-keyword">return</span> Asm(<span class="hljs-string">"1 1 OUTPORT 0 1 OUTPORT 11 10 STORE 10 FETCH 1 OUTPORT  15 100 STORE 100  FETCH 1 OUTPORT"</span>)<font></font>
<font></font>
<span class="hljs-meta">@macro(1,0)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testlocal</span>(<span class="hljs-params">c,x</span>):</span>
   <span class="hljs-keyword">return</span> Asm(<span class="hljs-string">"1 100 STORE 2 101 STORE 100 SETLOCAL LOCAL NOP FETCH 1 OUTPORT LOCAL 1 PLUS NOP FETCH 1 OUTPORT"</span>)<font></font>
<font></font>
<span class="hljs-meta">@prim(1, 0)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delay</span>(<span class="hljs-params">c, val</span>):</span>
  <span class="hljs-keyword">return</span> [val, Asm(<span class="hljs-string">"DO LOOP"</span>)]<font></font>
<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 私たちのプロセッサ用の小さなテスト高レベルプログラムには、階乗を計算するための関数の定義と、1から7までの階乗値のシリアル出力を無限ループでポートに実装するメイン関数が含まれています。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fact</span>(<span class="hljs-params">n</span>):</span>
  r = <span class="hljs-number">1</span>
  <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">1</span>:<font></font>
    r *= n<font></font>
    n -= <span class="hljs-number">1</span>
  <span class="hljs-keyword">return</span> r<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
  n=<span class="hljs-number">1</span>
  <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<font></font>
     digital_write(<span class="hljs-number">1</span>, fact(n))<font></font>
     delay(<span class="hljs-number">10</span>)<font></font>
     n=(n+<span class="hljs-number">1</span>)&amp;<span class="hljs-number">0x7</span><font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、たとえば、単純なスクリプトによって、またはコマンドラインからシーケンスによって、</font><font style="vertical-align: inherit;">
コンパイルのために起動できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その結果、ブートファイルstream.binが生成され、シリアルポートを介してFPGAのプロセッサコアに転送できます（現代の現実では、コンバーターが提供する仮想シリアルポートを介して） USB-UARTインターフェース）。</font><font style="vertical-align: inherit;">結果として、プログラムはプログラムメモリの146ワード（9ビット）とデータメモリの3ワードを占有します。</font></font><br>
<code>c.py C:\D\My_Docs\Documents\uzh-master\tests\fact2.py<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 一般に、Uzhコンパイラーは、ソフトウェアプロセッサのソフトウェア開発のための簡単で便利なツールのようです。</font><font style="vertical-align: inherit;">これは、少なくともプログラマーの使いやすさの点では、アセンブラーに代わる優れた手段です。</font><font style="vertical-align: inherit;">プリミティブとマクロをターゲット言語の関数として定義するためのツールキットにより、重要な場所をプロセッサーのアセンブリ言語で実装できます。</font><font style="vertical-align: inherit;">スタックアーキテクチャプロセッサの場合、コンパイラ適応手順は複雑すぎず、時間がかかりません。</font><font style="vertical-align: inherit;">これは、コンパイラーのソースコードの可用性が役立つ場合にちょうど当てはまると言えます。コンパイラーの主要なセクションが変化しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FPGAアルテラのCyclone Vシリーズのプロセッサ合成（32ビット容量、4Kワードのプログラムメモリおよび1K RAM）の結果は、次のようになります。</font></font><br>
<br>
<pre><code class="plaintext hljs">Family	Cyclone V<font></font>
Device	5CEBA4F23C7<font></font>
Logic utilization (in ALMs)	694 / 18,480 ( 4 % )<font></font>
Total registers	447<font></font>
Total pins	83 / 224 ( 37 % )<font></font>
Total virtual pins	0<font></font>
Total block memory bits	72,192 / 3,153,920 ( 2 % )<font></font>
Total DSP Blocks	2 / 66 ( 3 % )<font></font>
</code></pre><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文献</font></font></b></i><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VHDLのForthプロセッサ// </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m.habr.com/en/post/149686</font></font></a></li>
<li><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Python-</font></a><font style="vertical-align: inherit;">ウィキペディア// </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en.wikipedia.org/wiki/Python</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PythonでFPGAを開始_ Habr // </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m.habr.com/en/post/439638</font></font></a></li>
<li><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">MyHDL</font></a><font style="vertical-align: inherit;"> // </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.myhdl.org</font></font></a> </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub-true-grue_uzh_ Uzhコンパイラ// </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/true-grue/uzh</font></font></a> </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub-DSLコンパイラのラピッドプロトタイピング用のtrue-grue_raddsl_ツール// </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/true-grue/raddsl</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sovietov.com/txt/dsl_python_conf.pdf</font></font></a> </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作者は、ZmeyソフトウェアプロセッサとUzhコンパイラの開発者に、相談と忍耐に感謝しています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja491590/index.html">個人データと情報セキュリティの保護に関する推奨事項を分析します-注意すべき点</a></li>
<li><a href="../ja491592/index.html">銀河モデルから原子まで-AI実装の簡単なトリックは、シミュレーションを数十億倍高速化します</a></li>
<li><a href="../ja491594/index.html">懐疑論で迎えられた完璧な秘密を約束する新しい暗号法</a></li>
<li><a href="../ja491600/index.html">都市とデータ：データサイエンスを使用したプラハのオブジェクトの歩行距離の分析</a></li>
<li><a href="../ja491602/index.html">ポッドキャスト：初心者のITエディターの仕事が一種の「軍事ドラマ」である理由とそれを使って何をするか</a></li>
<li><a href="../ja491606/index.html">スタートメニューとミニマップの作り方</a></li>
<li><a href="../ja491608/index.html">カップヘッドと戦争の神からのアニメーションのヒント</a></li>
<li><a href="../ja491610/index.html">宣言的なデータフィルタリングを前面に配置。Js / ts</a></li>
<li><a href="../ja491612/index.html">Sberbankの優先株と普通株の例を使用したPythonでの2つの株の相場のダイナミクスの比較</a></li>
<li><a href="../ja491614/index.html">Masterhostが運命付けられた理由：内部の​​様子</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>