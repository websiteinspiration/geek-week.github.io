<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’— ğŸ––ğŸ» ğŸ¥¨ Awal termudah dalam STM melalui "satu tempat" ğŸŒ ğŸ‘©â€â¤ï¸â€ğŸ‘¨ ğŸ‘´ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mungkin, waktu perang agama AVR melawan STM telah berlalu, tetapi tidak, tidak, ya, ada pecahnya bentrokan antara kedua kubu. Hampir semua publikasi t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Awal termudah dalam STM melalui "satu tempat"</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488380/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mungkin, waktu perang agama AVR melawan STM telah berlalu, tetapi tidak, tidak, ya, ada pecahnya bentrokan antara kedua kubu. Hampir semua publikasi tentang kerajinan AVR pasti akan memiliki komentar seperti "Ya, seberapa banyak Anda dapat bercinta dengan nenek Anda, sekarang saatnya untuk beralih ke STM", kemudian variasi pada subjek harga, jumlah kaki, dan timer. Jika STMshcher lebih maju, pasti akan ada indikasi bahwa tidak ada DMA di AVR dan tidak akan, karena itu AVR harus mati. Mengapa DMA blink-voltmeter-termometer sederhana, sebuah gunung pengatur waktu 16 bit, 100 kaki dan 12 bit ADC, tidak ada yang biasanya menjelaskan. Mengapa kita membutuhkan alat penuai seperti itu dalam perangkat yang Tiny13 dapat dengan mudah mengeluarkannya, yang pada saat yang sama tidak dimuat bahkan pada sepertiga dari sumber dayanya, tidak ada yang akan mengerti. Anda hanya perlu beralih ke STM32, dan hanya itu. Untuk di sini</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan harus saya katakan, orang memiliki keinginan untuk hal baru. Tetapi sungguh, dapatkah saya mencoba? Bagaimana jika Anda menyukainya? Berikut ini hanya Referensi Manual untuk STM32F103C8T6 yang populer, yang menjadi dasar tablet Blue 1126 halaman paling masif, yang entah bagaimana itu tidak benar-benar memiliki "awal yang cepat". Bahkan utilitas terpisah, sehingga dibenci oleh para tetua â€œkalokubâ€, dan itu harus dipelajari, apa itu. Ya, dan setelah mempelajari Cube, sepertinya tidak akan dimulai dalam 5 menit, tapak yang dihasilkan olehnya bukanlah bahan bacaan yang paling mudah diakses untuk malam itu, itu hanya untuk masuk ke dahi, yang tidak semua orang bisa diskusikan.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Banyak artikel, mirip dengan yang ini, tentang awal yang cepat dan mudah di STM pantas untuk diskusi terpisah. Untuk semua artikel seperti itu, pada awalnya saya sangat bingung oleh satu keadaan. Tidak ada penjelasan terperinci tentang apa yang sebenarnya kami tulis di sini. Sekelompok tangkapan layar tentang cara membuat proyek, lalu segera tembok kode, lakukan seperti ini! Dan apa yang ada di sana, mengapa itu, mengapa demikian, di mana untuk mendapatkan semua kata-kata yang tampaknya dapat dimengerti ini, tidak ada yang menyelidiki, karena pasukan kehabisan ketika menulis manual tentang menginstal Cale dan Kuba, dan meluncurkan proyek. Hanya setelah beberapa waktu, masing-masing untuk masing-masing, pemahaman tentang apa yang terjadi dan mengapa datang. Pada gilirannya, saya mengusulkan cara untuk memulai bukan dari awal, seperti orang lain, tetapi dari akhir. Sekarang kita akan melakukan yang sebaliknya, jangan mengkonfigurasi controller, menulis kode dan memulai debutnya, tetapi segera lanjutkan ke debug,dan catat tindakan kami dalam bentuk kode.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami memasang Keil sebagai lingkungan bebas (hingga kode 32KB). Kami tidak akan menjelaskan tindakan ini, ini ada di Internet, dan langkah demi langkah penginstal harus dikuasai oleh orang yang masuk ke STM. Kami memulai proyek: Project-New uVision Project, membuat folder dan file proyek. Jendela pemilihan pengontrol terbuka, masukkan 103C8 ke dalam pencarian dan sepakati satu-satunya model yang dipilih. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kita sampai ke jendela pemilihan perpustakaan:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4v/ox/yf/4voxyfdppukch2gamrnsguvzbfk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita menempatkan tiga daw: CMSIS-CORE, Device-Startup dan Device-GPIO. Set ini cukup untuk memantulkan kaki, menerangi LED. Maka Anda masih harus mengonfigurasi, Anda tidak bisa mendapatkan apa pun dari ini. Alt + F7 meluncurkan jendela pengaturan yang terletak Pilihan Proyek untuk Target, di mana pada tab "Output" Anda perlu memeriksa kotak centang "Buat HEX-File" untuk membuat file firmware yang akan kami unggah ke controller. Selanjutnya, di tab "Debug", kami memilih ST-Link, yang, pada kenyataannya, akan memuat firmware dan debut: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kd/uw/6l/kduw6ltbrav_uadgbbrp93w5oke.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan tombol "Pengaturan" di sebelah jendela pilihan pemrogram, kita menuju ke jendela "Pengaturan Driver Cortex-M Target", di mana di " Unduh Flash "put a daw" Reset and Run ".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di pohon proyek, klik kanan pada folder "Grup Sumber 1", di wizard yang terbuka, buat file main.c, di mana kami akan segera menulis kode. Di main.c yang dibuka, klik kanan pada penyertaan pertama dan paling penting: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qc/zp/ju/qczpjupur2s0vqx-reffsuzy5qo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambahkan kode yang terdiri dari main dan sementara tak berujung:</font></font><br>
<br>
<pre><code class="plaintext hljs">#include "stm32f10x.h"                  // Device header<font></font>
int main(){<font></font>
	while(1){<font></font>
	}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anehnya, ini saja untuk saat ini, ini adalah program yang sudah jadi dan dapat dipahami yang mengkompilasi dan memuat dengan benar ke dalam pengontrol. Kami menekan F7 dan kami melihat bahwa firmware telah berhasil dipasang, tidak ada kesalahan atau peringatan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4b/bs/d3/4bbsd3ca51m6nmrx4gon6a_rwyw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mulai saat ini, controller sepenuhnya dapat diakses oleh kami, kami dapat memasukkannya di bawah garis debug dan memelintirnya ke segala arah, dan itu akan merespons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tombol Ctrl + F5 menuntun kita ke debug, dan tombol "System Viewer Windows" memungkinkan Anda untuk meluncurkan windows untuk mengendalikan register register dan mengendalikan kaki-kaki GPIO. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1e/ri/u1/1eriu1hhnribtydyhsaq-i36lr4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih lanjut, saya sarankan Anda masih menggunakan Manual Referensi, terutama karena Anda bahkan tidak perlu mengunduhnya, itu tersedia dengan mengklik pada tab "Buku" pada menu "Lihat":</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fx/4j/hm/fx4jhmgymzqzczhfcqto1wusr2m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang saya mengusulkan untuk menggunakan alasan berikut. Dari pinout pada Blue Tablet, dapat dilihat bahwa LED menggantung di kaki port 13. Banyak sumber daya Internet dan diskusi selalu menyebutkan bahwa sebelum Anda melakukan sesuatu di STM, Anda perlu mengaktifkan sesuatu, jika tidak, atur jam. Tanpa basa-basi lagi, kami menulis di kotak pencarian pembaca pdf apa yang kami butuhkan, yaitu, aktifkan port C: â€œPORT C CLOCK ENABLEâ€. Kita </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qf/lh/vs/qflhvsoyc3fhyds54-clxwq0eqo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
masuk </font><font style="vertical-align: inherit;">ke gambar berikut: </font><font style="vertical-align: inherit;">Dari sini kita dapat menyimpulkan bahwa clocking port C diaktifkan dalam register IOPCEN. Dengan pengetahuan ini, kami membuka tab RCC dalam mode debug, dan memasukkan nama ini di bilah pencarian: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z0/x4/3q/z0x43qbnbga_-q0voxoajotxuqs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tandai kotak centang yang diperlukan dengan tanda centang, dan mulai saat ini kami menganggap port C diaktifkan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, mengingat AVR yang telah lama menderita, kita akan mencari pengaturan pin yang sebenarnya. Agar bisa berfungsi, perlu dijelaskan apa sebenarnya yang kita inginkan darinya. Dan kami ingin melompat dengan nomor kaki 13 port C, untuk ini kita perlu mengatur mode operasinya. Di bilah pencarian di Manual Referensi, kami mengemudi di "Konfigurasi port bit", yang menyatakan keinginan kami untuk membaca di mana pengaturan leg disembunyikan. Pencarian membawa kita ke tabel dari mana mengikuti bahwa untuk menetapkan kaki sebagai output, perlu untuk mengkonfigurasi register MODE dan CNF: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/od/c4/ot/odc4oti0osjwy9qvuax79slsqv4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari tabel No. 20 jelas bahwa untuk menetapkan kaki sebagai output Push-Pull, perlu mengatur ulang register CNF0 dan CNF1, dan kondisi pasangan. MODE0 dan MODE1 dijelaskan dalam tabel No. 21, saya akan memilih opsi atas, hingga 10MHz, MODE0 = 1, MODE1 = 0. Inilah yang akan saya lakukan di jendela GPIOC untuk register CNF13 dan MODE13</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-n/x5/y3/-nx5y33grvntsdchwf7emhxlgnc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kami telah mengkonfigurasi jam dan mode operasi port. Sudah waktunya untuk mencari tahu bagaimana cara melompat kaki. Dalam bahasa Inggris, atur bit port ditulis sebagai â€œSet bit portâ€, dan kami akan mencari frasa ini dalam manual: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nw/l8/r2/nwl8r2ne5djl9o3hmpwxg2eigg0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pencarian menuntun kami ke halaman dengan tabel, yang dengan jelas menunjukkan bahwa register BSRR, yang terdiri dari pasangan BS dan BR, bertanggung jawab untuk mengatur status kaki port , Bit set dan Bit reset, masing-masing. Kami menemukan register ini di jendela GPIOC dalam mode debug dan menikmati kontrol nomor leg 13 secara langsung dengan memasukkan jackdaws dengan mouse ke dalam kotak centang yang sesuai:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ob/vj/c3/obvjc3gnvzem1sh6tecfly7quyk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LED pada papan pil biru menggantung di antara kaki dan VCC, oleh karena itu mengendalikannya kembali ke nama register. Bit Set (register BS13) memadamkannya, dan Bit Reset (register BR13) menyalakannya. Ini adalah register operasi atom, mereka direset setelah mengatur kotak centang. Dimungkinkan untuk mengontrol kaki melalui register ODR, (klausa 9.2.4 Register data output port (GPIOx_ODR) dalam manual referensi), itu dengan jelas menunjukkan apa yang menyebabkan instalasi dan reset mengarah pada gagak. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nv/rd/ou/nvrdouc1ano_fn8gdpdplk2v5rq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LED hijau hijau dan redup menunjukkan bahwa semuanya berfungsi dengan benar. Tetap hanya menulis semua ini dalam bentuk kode di main.c. Di sinilah kismis muncul, yang membedakan metode ini untuk memahami pengontrol STM melalui debug dari yang lain yang seluruh internet dikotori. Saya sarankan hanya menulis ulang apa yang kita lihat di jendela debug ke dalam kode. Contoh:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kq/f9/ww/kqf9wwqdt2ydqoz9ovv1f9k2xt0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atur mode operasi port dan aktifkan clocking; </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/a-/fk/iua-fkaw0im1tjbpxqm4kwpruio.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mereka menyalakan kaki pelabuhan, menunggu, mematikannya, dan seterusnya:</font></font><br>
<br>
<pre><code class="plaintext hljs">#include "stm32f10x.h"                  // Device header<font></font>
<font></font>
int main(){<font></font>
	RCC-&gt;APB2ENR=0x00000010;			//  <font></font>
	GPIOC-&gt;CRH=0x44144444;			//   Push-Pull  10MHz<font></font>
	int i;								//     / <font></font>
	while(1){<font></font>
		GPIOC-&gt;ODR=0x00002000;		//  LED,      <font></font>
		i=2000000;					//    <font></font>
		while (i) i--;					// <font></font>
		GPIOC-&gt;ODR=0x00000000;		//  LED<font></font>
		i=2000000;					//  <font></font>
		while (i) i--;					<font></font>
	}<font></font>
}<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja metode ini jauh dari yang terbaik dan tidak benar, tetapi menurut saya yang paling dimengerti dan sederhana. Selain itu, ia memperkenalkan untuk bekerja dengan lembar data (manual referensi) dan tidak menakut-nakuti, seperti membaca mana dan menulis footcloth kode multi-halaman untuk Blink. Ya, tidak ada lapisan abstraksi, banyak yang telah terlewatkan, tetapi saya pikir Anda dapat memaafkan ini untuk awal yang sederhana. Membaca mana dan pekerjaan yang benar dengan register kemudian, sekarang kita memiliki LED berkedip dan pada dasarnya kita mengerti bagaimana dan apa yang kita lakukan, dan yang paling penting, dari mana semua singkatan ini berasal. Jika saya pernah ditunjukkan cara mempelajari STM ini sebelumnya, mungkin saya tidak akan mengumpulkan lebih dari 9000 programmer berbeda untuk AVR di mana tidak ada debug, tetapi akan langsung digunakan di Cortex. Memang, dalam AVR tidak ada debug yang dapat dipahami dan diakses, tetapi bagaimanapun, masih terlalu dini untuk melupakan Tiny13. Dia melakukan tugasnya.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id488368/index.html">Apa yang saya pelajari saat mengerjakan proyek skala besar pertama saya</a></li>
<li><a href="../id488370/index.html">TDD untuk mikrokontroler. Bagian 2: Bagaimana mata-mata menyingkirkan kecanduan</a></li>
<li><a href="../id488374/index.html">Telegram + 1C + Webhooks + Apache + Sertifikat yang ditandatangani sendiri</a></li>
<li><a href="../id488376/index.html">Ketika prinsip "ke neraka dengan segalanya, ambil dan lakukan itu!" tidak bekerja: catatan penunda</a></li>
<li><a href="../id488378/index.html">Secara singkat tentang penamaan di JS</a></li>
<li><a href="../id488382/index.html">Saya menambahkan penundaan 3-25 detik ke situs yang saya kunjungi</a></li>
<li><a href="../id488386/index.html">Kasus untuk menerapkan alat analisis anomali jaringan: serangan melalui plug-in browser</a></li>
<li><a href="../id488388/index.html">Relogin dan HTTP Basic Auth</a></li>
<li><a href="../id488390/index.html">Cara membuat teman bot Telegram dengan OpenId Connect</a></li>
<li><a href="../id488392/index.html">Gambar yang siap produksi untuk k8s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>