<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘²ğŸ» ğŸ§›ğŸ¼ ğŸ•´ğŸ¿ 120 + fpsæ—¶æœ‰æ•°ç™¾ä¸‡ä¸ªç²¾çµ ğŸ‘¸ ğŸ§“ğŸ¾ ğŸŒ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¦‚æœæ‚¨åœ¨DOTS è®ºå›ä¸Šå¾˜å¾Šï¼Œæ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°æœ‰å…³ä½œè€…å¦‚ä½•ç¼–å†™èƒ½å¤Ÿæ¸²æŸ“ä¸€ç™¾ä¸‡ä¸ªåŠ¨ç”»ç²¾çµçš„åº“çš„ç±»ä¼¼å¸–å­ï¼Œä½†ä»ç„¶åªèƒ½è·å¾—60fpsã€‚æˆ‘åˆ›å»ºäº†è‡ªå·±çš„DOTS Spriteæ¸²æŸ“å™¨ï¼Œå¯¹æˆ‘ä»¬çš„æ¸¸æˆæ¥è¯´è¶³å¤Ÿå¥½äº†ï¼Œä½†æ˜¯ä¸èƒ½åº”ä»˜ä¸€ç™¾ä¸‡ä¸ªã€‚æˆ‘å¾ˆå¥½å¥‡
 
 å› æ­¤ï¼Œæˆ‘åˆ†å‰äº†çŸ¥è¯†åº“ï¼Œå¹¶å†³å®šæ£€æŸ¥å®ƒæ˜¯å¦å¯ä»¥åœ¨å­¦æœ¯ç•Œä½¿ç”¨ã€‚æˆ‘å¯¹ä»–åš...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>120 + fpsæ—¶æœ‰æ•°ç™¾ä¸‡ä¸ªç²¾çµ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496826/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/867/3ce/d0a/8673ced0a9e85041d6dac0d3cee54858.png" alt="å›¾ç‰‡"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨åœ¨</font><font style="vertical-align: inherit;">DOTS </font></font><a rel="nofollow" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®ºå›ä¸Š</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾˜å¾Š</font><font style="vertical-align: inherit;">ï¼Œæ‚¨å¯ä»¥åœ¨</font></font><a rel="nofollow" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°</font><font style="vertical-align: inherit;">æœ‰å…³ä½œè€…å¦‚ä½•ç¼–å†™èƒ½å¤Ÿæ¸²æŸ“ä¸€ç™¾ä¸‡ä¸ªåŠ¨ç”»ç²¾çµçš„åº“çš„</font><a rel="nofollow" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ç±»ä¼¼å¸–å­ï¼Œä½†</font></a><font style="vertical-align: inherit;">ä»ç„¶åªèƒ½è·å¾—60fpsã€‚</font><font style="vertical-align: inherit;">æˆ‘åˆ›å»ºäº†è‡ªå·±çš„</font></font><a rel="nofollow" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOTS Spriteæ¸²æŸ“å™¨</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¯¹æˆ‘ä»¬çš„</font></font><a rel="nofollow" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¸¸æˆ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥è¯´è¶³å¤Ÿå¥½äº†</font><font style="vertical-align: inherit;">ï¼Œä½†æ˜¯ä¸èƒ½åº”ä»˜ä¸€ç™¾ä¸‡ä¸ªã€‚</font><font style="vertical-align: inherit;">æˆ‘å¾ˆå¥½å¥‡</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œæˆ‘åˆ†å‰äº†çŸ¥è¯†åº“ï¼Œå¹¶å†³å®šæ£€æŸ¥å®ƒæ˜¯å¦å¯ä»¥åœ¨å­¦æœ¯ç•Œä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">æˆ‘å¯¹ä»–åšäº†ä¸€ç‚¹å®éªŒï¼Œçœ‹ç€ä»–å¦‚ä½•æ¸²æŸ“ä¸€ä¸ªç²¾çµï¼Œä¸€ç™¾ä¸ªï¼Œç„¶åæ•°åƒä¸ªã€‚</font><font style="vertical-align: inherit;">äº‹å®è¯æ˜ï¼Œä»–è¿˜æ²¡æœ‰å‡†å¤‡å¥½åœ¨æˆ‘ä»¬çš„æ¸¸æˆä¸­ä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">å®ƒç¼ºå°‘æŸäº›æ–¹é¢ï¼Œä¾‹å¦‚ï¼Œä»ååˆ°å‰å¯¹ç²¾çµè¿›è¡Œæ’åºã€‚</font><font style="vertical-align: inherit;">æˆ‘è¯•å›¾å†™ä¸€ä¸ªè¿™ä¸ªåŠŸèƒ½çš„hackã€‚</font><font style="vertical-align: inherit;">å½“æˆ‘é˜…è¯»ä»£ç æ—¶ï¼Œæˆ‘æ„è¯†åˆ°å¯èƒ½å€¼å¾—ç¼–å†™ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„å…¨æ–°åº“ã€‚</font><font style="vertical-align: inherit;">æˆ‘åªéœ€è¦å¼„æ¸…æ¥šå®ƒå¦‚ä½•æ¸²æŸ“ç²¾çµï¼Œä½†æ˜¯æˆ‘å·²ç»ç†è§£äº†åŸç†ã€‚</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºç¡€</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæˆ‘æƒ³é‡æ–°åˆ›å»ºè¿™ç§æ¸²æŸ“æŠ€æœ¯ï¼Œé‚£ä¹ˆæˆ‘éœ€è¦åšæœ€ç®€å•çš„äº‹æƒ…ï¼šæ¸²æŸ“ä¸€ä¸ªå•ç‹¬çš„ç²¾çµã€‚è¯¥åº“ä½¿ç”¨ComputeBuffersã€‚ä»–ä»¬å¿…é¡»ä½¿ç”¨è®¡ç®—ç€è‰²å™¨å°†è®¡ç®—è½¬ç§»åˆ°GPUã€‚æˆ‘ä¸çŸ¥é“åœ¨å±å¹•ä¸Šæ¸²æŸ“æŸäº›ä¸œè¥¿çš„å¸¸è§„ç€è‰²å™¨ä¸­å¯ä»¥ä½¿ç”¨ä»€ä¹ˆã€‚æ‚¨å¯ä»¥å°†å®ƒä»¬æ„ŸçŸ¥ä¸ºå¯ä»¥åˆ†é…ç»™æè´¨çš„æ•°å­—æ•°ç»„ï¼Œç„¶åç€è‰²å™¨è®¿é—®è¿™äº›æè´¨ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä¼ è¾“æ•°æ®ï¼Œä¾‹å¦‚ä½ç½®ï¼Œæ—‹è½¬ï¼Œæ¯”ä¾‹ï¼Œuvåæ ‡ï¼Œé¢œè‰²ã€‚ä¸‹é¢æ˜¯åŸºäºè¿™ä¸ªå¾ˆæ£’çš„åº“ä¿®æ”¹çš„ç€è‰²å™¨ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  Shader <span class="hljs-string">"Instanced/ComputeBufferSprite"</span> {<font></font>
    Properties {<font></font>
        _MainTex (<span class="hljs-string">"Albedo (RGB)"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
    }<font></font>
    <font></font>
    SubShader {<font></font>
        Tags{<font></font>
            <span class="hljs-string">"Queue"</span>=<span class="hljs-string">"Transparent"</span>
            <span class="hljs-string">"IgnoreProjector"</span>=<span class="hljs-string">"True"</span>
            <span class="hljs-string">"RenderType"</span>=<span class="hljs-string">"Transparent"</span><font></font>
        }<font></font>
        Cull Back<font></font>
        Lighting Off<font></font>
        ZWrite On<font></font>
        Blend One OneMinusSrcAlpha<font></font>
        Pass {<font></font>
            CGPROGRAM<font></font>
            <span class="hljs-comment">// Upgrade <span class="hljs-doctag">NOTE:</span> excluded shader from OpenGL ES 2.0 because it uses non-square matrices</span><font></font>
            #pragma exclude_renderers gles<font></font>
<font></font>
            #pragma vertex vert<font></font>
            #pragma fragment frag<font></font>
            #pragma target <span class="hljs-number">4.5</span><font></font>
<font></font>
            #include <span class="hljs-string">"UnityCG.cginc"</span><font></font>
<font></font>
            sampler2D _MainTex;<font></font>
<font></font>
            <span class="hljs-comment">// xy for position, z for rotation, and w for scale</span><font></font>
            StructuredBuffer&lt;float4&gt; transformBuffer;<font></font>
<font></font>
            <span class="hljs-comment">// xy is the uv size, zw is the uv offset/coordinate</span><font></font>
            StructuredBuffer&lt;float4&gt; uvBuffer; <font></font>
<font></font>
	        StructuredBuffer&lt;float4&gt; colorsBuffer;<font></font>
<font></font>
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">v2f</span>{</span><font></font>
                float4 pos : SV_POSITION;<font></font>
                float2 uv: TEXCOORD0;<font></font>
		        fixed4 color : COLOR0;<font></font>
            };<font></font>
<font></font>
            <span class="hljs-function">float4x4 <span class="hljs-title">rotationZMatrix</span><span class="hljs-params">(<span class="hljs-keyword">float</span> zRotRadians)</span> </span>{
                <span class="hljs-keyword">float</span> c = <span class="hljs-built_in">cos</span>(zRotRadians);
                <span class="hljs-keyword">float</span> s = <span class="hljs-built_in">sin</span>(zRotRadians);<font></font>
                float4x4 ZMatrix  = <font></font>
                    float4x4( <font></font>
                       c,  -s, <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,a<font></font>
                       s,  c,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,
                       <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">0</span>,
                       <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>);
                <span class="hljs-keyword">return</span> ZMatrix;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-function">v2f <span class="hljs-title">vert</span> <span class="hljs-params">(appdata_full v, uint instanceID : SV_InstanceID)</span> </span>{<font></font>
                float4 transform = transformBuffer[instanceID];<font></font>
                float4 uv = uvBuffer[instanceID];<font></font>
                <font></font>
                <span class="hljs-comment">//rotate the vertex</span>
                v.vertex = mul(v.vertex - float4(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>), rotationZMatrix(transform.z));<font></font>
                <font></font>
                <span class="hljs-comment">//scale it</span>
                float3 worldPosition = float3(transform.x, transform.y, -transform.y/<span class="hljs-number">10</span>) + (v.vertex.xyz * transform.w);<font></font>
                <font></font>
                v2f o;<font></font>
                o.pos = UnityObjectToClipPos(float4(worldPosition, <span class="hljs-number">1.0f</span>));<font></font>
                <font></font>
                <span class="hljs-comment">// XY here is the dimension (width, height). </span>
                <span class="hljs-comment">// ZW is the offset in the texture (the actual UV coordinates)</span><font></font>
                o.uv =  v.texcoord * uv.xy + uv.zw;<font></font>
                <font></font>
		        o.color = colorsBuffer[instanceID];<font></font>
                <span class="hljs-keyword">return</span> o;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-function">fixed4 <span class="hljs-title">frag</span> <span class="hljs-params">(v2f i)</span> : SV_Target</span>{<font></font>
                fixed4 col = tex2D(_MainTex, i.uv) * i.color;<font></font>
				clip(col.a - <span class="hljs-number">1.0</span> / <span class="hljs-number">255.0</span>);<font></font>
                col.rgb *= col.a;<font></font>
<font></font>
				<span class="hljs-keyword">return</span> col;<font></font>
            }<font></font>
<font></font>
            ENDCG<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å˜é‡transformBufferï¼ŒuvBufferå’ŒcolorsBufferæ˜¯æˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨ComputeBufferså®šä¹‰çš„â€œæ•°ç»„â€ã€‚</font><font style="vertical-align: inherit;">è¿™å°±æ˜¯æˆ‘ä»¬ç°åœ¨ï¼ˆç°åœ¨ï¼‰æ¸²æŸ“ç²¾çµçš„å…¨éƒ¨ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ç”¨äºæ¸²æŸ“å•ä¸ªç²¾çµçš„MonoBehaviourè„šæœ¬ï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ComputeBufferBasic</span> : <span class="hljs-title">MonoBehaviour</span> {<font></font>
    [<span class="hljs-meta">SerializeField</span>]
    <span class="hljs-keyword">private</span> Material material;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> Mesh mesh;<font></font>
    <font></font>
    <span class="hljs-comment">// Transform here is a compressed transform information</span>
    <span class="hljs-comment">// xy is the position, z is rotation, w is the scale</span>
    <span class="hljs-keyword">private</span> ComputeBuffer transformBuffer;<font></font>
    <font></font>
    <span class="hljs-comment">// uvBuffer contains float4 values in which xy is the uv dimension and zw is the texture offset</span>
    <span class="hljs-keyword">private</span> ComputeBuffer uvBuffer;
    <span class="hljs-keyword">private</span> ComputeBuffer colorBuffer;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">uint</span>[] args = {
        <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span><font></font>
    };<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> ComputeBuffer argsBuffer;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Awake</span>(<span class="hljs-params"></span>)</span> {
        <span class="hljs-keyword">this</span>.mesh = CreateQuad();<font></font>
        <font></font>
        <span class="hljs-keyword">this</span>.transformBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-number">1</span>, <span class="hljs-number">16</span>);
        <span class="hljs-keyword">float</span> scale = <span class="hljs-number">0.2f</span>;
        <span class="hljs-keyword">this</span>.transformBuffer.SetData(<span class="hljs-keyword">new</span> float4[]{ <span class="hljs-keyword">new</span> float4(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, scale) });
        <span class="hljs-keyword">int</span> matrixBufferId = Shader.PropertyToID(<span class="hljs-string">"transformBuffer"</span>);
        <span class="hljs-keyword">this</span>.material.SetBuffer(matrixBufferId, <span class="hljs-keyword">this</span>.transformBuffer);<font></font>
        <font></font>
        <span class="hljs-keyword">this</span>.uvBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-number">1</span>, <span class="hljs-number">16</span>);
        <span class="hljs-keyword">this</span>.uvBuffer.SetData(<span class="hljs-keyword">new</span> float4[]{ <span class="hljs-keyword">new</span> float4(<span class="hljs-number">0.25f</span>, <span class="hljs-number">0.25f</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) });
        <span class="hljs-keyword">int</span> uvBufferId = Shader.PropertyToID(<span class="hljs-string">"uvBuffer"</span>);
        <span class="hljs-keyword">this</span>.material.SetBuffer(uvBufferId, <span class="hljs-keyword">this</span>.uvBuffer);<font></font>
        <font></font>
        <span class="hljs-keyword">this</span>.colorBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-number">1</span>, <span class="hljs-number">16</span>);
        <span class="hljs-keyword">this</span>.colorBuffer.SetData(<span class="hljs-keyword">new</span> float4[]{ <span class="hljs-keyword">new</span> float4(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) });
        <span class="hljs-keyword">int</span> colorsBufferId = Shader.PropertyToID(<span class="hljs-string">"colorsBuffer"</span>);
        <span class="hljs-keyword">this</span>.material.SetBuffer(colorsBufferId, <span class="hljs-keyword">this</span>.colorBuffer);<font></font>
<font></font>
        <span class="hljs-keyword">this</span>.argsBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.args.Length * <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">uint</span>), ComputeBufferType.IndirectArguments);
        <span class="hljs-keyword">this</span>.argsBuffer.SetData(<span class="hljs-keyword">this</span>.args);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Bounds BOUNDS = <span class="hljs-keyword">new</span> Bounds(Vector2.zero, Vector3.one);<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params"></span>)</span> {   
        <span class="hljs-comment">// Draw</span>
        Graphics.DrawMeshInstancedIndirect(<span class="hljs-keyword">this</span>.mesh, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.material, BOUNDS, <span class="hljs-keyword">this</span>.argsBuffer);<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">// This can be refactored to a utility class</span>
    <span class="hljs-comment">// Just added it here for the article</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Mesh <span class="hljs-title">CreateQuad</span>(<span class="hljs-params"></span>)</span> {<font></font>
        Mesh mesh = <span class="hljs-keyword">new</span> Mesh();<font></font>
        Vector3[] vertices = <span class="hljs-keyword">new</span> Vector3[<span class="hljs-number">4</span>];<font></font>
        vertices[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> Vector3(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
        vertices[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> Vector3(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
        vertices[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> Vector3(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<font></font>
        vertices[<span class="hljs-number">3</span>] = <span class="hljs-keyword">new</span> Vector3(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<font></font>
        mesh.vertices = vertices;<font></font>
<font></font>
        <span class="hljs-keyword">int</span>[] tri = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">6</span>];<font></font>
        tri[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<font></font>
        tri[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;<font></font>
        tri[<span class="hljs-number">2</span>] = <span class="hljs-number">1</span>;<font></font>
        tri[<span class="hljs-number">3</span>] = <span class="hljs-number">2</span>;<font></font>
        tri[<span class="hljs-number">4</span>] = <span class="hljs-number">3</span>;<font></font>
        tri[<span class="hljs-number">5</span>] = <span class="hljs-number">1</span>;<font></font>
        mesh.triangles = tri;<font></font>
<font></font>
        Vector3[] normals = <span class="hljs-keyword">new</span> Vector3[<span class="hljs-number">4</span>];<font></font>
        normals[<span class="hljs-number">0</span>] = -Vector3.forward;<font></font>
        normals[<span class="hljs-number">1</span>] = -Vector3.forward;<font></font>
        normals[<span class="hljs-number">2</span>] = -Vector3.forward;<font></font>
        normals[<span class="hljs-number">3</span>] = -Vector3.forward;<font></font>
        mesh.normals = normals;<font></font>
<font></font>
        Vector2[] uv = <span class="hljs-keyword">new</span> Vector2[<span class="hljs-number">4</span>];<font></font>
        uv[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> Vector2(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
        uv[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> Vector2(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<font></font>
        uv[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> Vector2(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);<font></font>
        uv[<span class="hljs-number">3</span>] = <span class="hljs-keyword">new</span> Vector2(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<font></font>
        mesh.uv = uv;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> mesh;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬æŒ‰é¡ºåºå¤„ç†æ­¤ä»£ç ã€‚</font><font style="vertical-align: inherit;">å¯¹äºæè´¨ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ç§æ–°æè´¨ï¼Œç„¶åä¸ºå…¶è®¾ç½®ä¸Šè¿°ç€è‰²å™¨ã€‚</font><font style="vertical-align: inherit;">ç»™å®ƒåˆ†é…ä¸€ä¸ªçº¹ç†/ç²¾çµè¡¨ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä½¿ç”¨åº“ä¸­çš„Spriteå·¥ä½œè¡¨ï¼Œè¿™æ˜¯ä¸€ä¸ª4x4 Spriteè¡¨æƒ…ç¬¦å·å›¾æ ‡ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d63/5a4/533/d635a4533eb5868518829ce674b91463.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é‡Œçš„ç½‘æ ¼æ˜¯ç”±CreateQuadï¼ˆï¼‰åˆ›å»ºçš„ç½‘æ ¼ã€‚å®ƒåªæ˜¯ç”±ä¸¤ä¸ªä¸‰è§’å½¢ç»„æˆçš„å››è¾¹å½¢ã€‚æ¥ä¸‹æ¥æ˜¯ä¸‰ä¸ªComputeBufferå˜é‡ï¼Œç¨åæˆ‘ä»¬å°†ä¸ºå…¶å®šä¹‰ææ–™ã€‚æˆ‘ç”¨ä¸ç€è‰²å™¨ä¸­çš„StructuredBufferå˜é‡ç›¸åŒçš„æ–¹å¼å‘½åå®ƒä»¬ã€‚è¿™ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†æ˜¯æ›´æ–¹ä¾¿ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
argså’ŒargsBufferå˜é‡å°†ç”¨äºè°ƒç”¨Graphics.DrawMeshInstancedIndirectï¼ˆï¼‰ã€‚æ–‡æ¡£åœ¨</font></font><a rel="noreferrer noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ä¸€ä¸ªå‡½æ•°éœ€è¦ä¸€ä¸ªå…·æœ‰äº”ä¸ªuintå€¼çš„ç¼“å†²åŒºã€‚åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œåªæœ‰å‰ä¸¤ä¸ªå¾ˆé‡è¦ã€‚ç¬¬ä¸€ä¸ªæ˜¯ç´¢å¼•çš„æ•°é‡ï¼Œå¯¹äºæˆ‘ä»¬çš„å››è¾¹å½¢ï¼Œå®ƒæ˜¯6ã€‚ç¬¬äºŒä¸ªæ˜¯å››è¾¹å½¢å°†è¢«æ¸²æŸ“çš„æ¬¡æ•°ï¼Œå³1ã€‚æˆ‘ä¹Ÿå°†å…¶è¡¨ç¤ºä¸ºç€è‰²å™¨ç”¨æ¥ç´¢å¼•StructuredBufferçš„æœ€å¤§å€¼ã€‚åƒé‚£æ ·ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; count; ++i) {<font></font>
    CallShaderUsingThisIndexForBuffers(i);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Awakeï¼ˆï¼‰æ–¹æ³•åªæ˜¯ä¸ºææ–™åˆ†é…å‡†å¤‡ComputeBuffersã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ä»¥0.2fçš„æ¯”ä¾‹ä¸”ä¸æ—‹è½¬çš„æ–¹å¼åœ¨ç‚¹ï¼ˆ0ï¼Œ0ï¼‰ä¸Šæ¸²æŸ“ç²¾çµã€‚</font><font style="vertical-align: inherit;">å¯¹äºUVï¼Œæˆ‘ä»¬ä½¿ç”¨å·¦ä¸‹è§’çš„ç²¾çµï¼ˆäº²å»è¡¨æƒ…ç¬¦å·ï¼‰ã€‚</font><font style="vertical-align: inherit;">ç„¶åæˆ‘ä»¬åˆ†é…ç™½è‰²ã€‚</font><font style="vertical-align: inherit;">argsæ•°ç»„è®¾ç½®ä¸ºargsBufferã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨Updateï¼ˆï¼‰ä¸­ï¼Œæˆ‘ä»¬ä»…è°ƒç”¨Graphics.DrawMeshInstancedIndirectï¼ˆï¼‰ã€‚</font><font style="vertical-align: inherit;">ï¼ˆæˆ‘è¿˜ä¸å¤ªäº†è§£å¦‚ä½•åœ¨è¿™é‡Œä½¿ç”¨BOUNDSå¹¶å°†å…¶ä»åº“ä¸­å¤åˆ¶å‡ºæ¥ã€‚ï¼‰</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åçš„æ­¥éª¤å°†æ˜¯ä½¿ç”¨æ­£äº¤ç›¸æœºå‡†å¤‡ä¸€ä¸ªåœºæ™¯ã€‚</font><font style="vertical-align: inherit;">åˆ›å»ºå¦ä¸€ä¸ªGameObjectå¹¶æ·»åŠ ComputeBufferBasicç»„ä»¶ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä½¿ç”¨åˆšåˆšæ˜¾ç¤ºçš„ç€è‰²å™¨ä¸ºå…¶è®¾ç½®æè´¨ã€‚</font><font style="vertical-align: inherit;">åœ¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ad/09e/0ef/6ad09e0efabcc7c1556094947fa6b12b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å“¦è€¶ï¼</font><font style="vertical-align: inherit;">ä½¿ç”¨ComputeBufferæ¸²æŸ“çš„ç²¾çµã€‚</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœå¯ä»¥åšä¸€ä¸ªï¼Œå°±å¯ä»¥åšå¾ˆå¤š</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ—¢ç„¶æˆ‘ä»¬å·²ç»å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨ComputeBuffersæ¸²æŸ“ä¸€ä¸ªç²¾çµï¼Œæˆ‘ä»¬å¯ä»¥ç”»å¾ˆå¤šä¸œè¥¿ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æˆ‘åˆ›å»ºçš„å¦ä¸€ä¸ªè„šæœ¬ï¼Œè¯¥è„šæœ¬å…·æœ‰æ•°é‡å‚æ•°ï¼Œå¹¶ä»¥éšæœºçš„ä½ç½®ï¼Œæ¯”ä¾‹ï¼Œæ—‹è½¬å’Œé¢œè‰²æ¸²æŸ“æŒ‡å®šæ•°é‡çš„ç²¾çµï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ComputeBufferMultipleSprites</span> : <span class="hljs-title">MonoBehaviour</span> {<font></font>
    [<span class="hljs-meta">SerializeField</span>]
    <span class="hljs-keyword">private</span> Material material;<font></font>
    <font></font>
    [<span class="hljs-meta">SerializeField</span>]
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> minScale = <span class="hljs-number">0.15f</span>;<font></font>
    <font></font>
    [<span class="hljs-meta">SerializeField</span>]
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> maxScale = <span class="hljs-number">0.2f</span>;  <font></font>
<font></font>
    [<span class="hljs-meta">SerializeField</span>]
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> count;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> Mesh mesh;<font></font>
    <font></font>
    <span class="hljs-comment">// Matrix here is a compressed transform information</span>
    <span class="hljs-comment">// xy is the position, z is rotation, w is the scale</span>
    <span class="hljs-keyword">private</span> ComputeBuffer transformBuffer;<font></font>
    <font></font>
    <span class="hljs-comment">// uvBuffer contains float4 values in which xy is the uv dimension and zw is the texture offset</span>
    <span class="hljs-keyword">private</span> ComputeBuffer uvBuffer;
    <span class="hljs-keyword">private</span> ComputeBuffer colorBuffer;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">uint</span>[] args;<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> ComputeBuffer argsBuffer;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Awake</span>(<span class="hljs-params"></span>)</span> {<font></font>
        QualitySettings.vSyncCount = <span class="hljs-number">0</span>;<font></font>
        Application.targetFrameRate = <span class="hljs-number">-1</span>;<font></font>
        <font></font>
        <span class="hljs-keyword">this</span>.mesh = CreateQuad();<font></font>
        <font></font>
        <span class="hljs-comment">// Prepare values</span>
        float4[] transforms = <span class="hljs-keyword">new</span> float4[<span class="hljs-keyword">this</span>.count];<font></font>
        float4[] uvs = <span class="hljs-keyword">new</span> float4[<span class="hljs-keyword">this</span>.count];<font></font>
        float4[] colors = <span class="hljs-keyword">new</span> float4[<span class="hljs-keyword">this</span>.count];<font></font>
<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> maxRotation = Mathf.PI * <span class="hljs-number">2</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.count; ++i) {
            <span class="hljs-comment">// transform</span>
            <span class="hljs-keyword">float</span> x = UnityEngine.Random.Range(<span class="hljs-number">-8f</span>, <span class="hljs-number">8f</span>);
            <span class="hljs-keyword">float</span> y = UnityEngine.Random.Range(<span class="hljs-number">-4.0f</span>, <span class="hljs-number">4.0f</span>);
            <span class="hljs-keyword">float</span> rotation = UnityEngine.Random.Range(<span class="hljs-number">0</span>, maxRotation);
            <span class="hljs-keyword">float</span> scale = UnityEngine.Random.Range(<span class="hljs-keyword">this</span>.minScale, <span class="hljs-keyword">this</span>.maxScale);<font></font>
            transforms[i] = <span class="hljs-keyword">new</span> float4(x, y, rotation, scale);<font></font>
            <font></font>
            <span class="hljs-comment">// UV</span>
            <span class="hljs-keyword">float</span> u = UnityEngine.Random.Range(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>) * <span class="hljs-number">0.25f</span>;
            <span class="hljs-keyword">float</span> v = UnityEngine.Random.Range(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>) * <span class="hljs-number">0.25f</span>;<font></font>
            uvs[i] = <span class="hljs-keyword">new</span> float4(<span class="hljs-number">0.25f</span>, <span class="hljs-number">0.25f</span>, u, v);<font></font>
            <font></font>
            <span class="hljs-comment">// color</span>
            <span class="hljs-keyword">float</span> r = UnityEngine.Random.Range(<span class="hljs-number">0f</span>, <span class="hljs-number">1.0f</span>);
            <span class="hljs-keyword">float</span> g = UnityEngine.Random.Range(<span class="hljs-number">0f</span>, <span class="hljs-number">1.0f</span>);
            <span class="hljs-keyword">float</span> b = UnityEngine.Random.Range(<span class="hljs-number">0f</span>, <span class="hljs-number">1.0f</span>);<font></font>
            colors[i] = <span class="hljs-keyword">new</span> float4(r, g, b, <span class="hljs-number">1.0f</span>);<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-keyword">this</span>.transformBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-keyword">this</span>.count, <span class="hljs-number">16</span>);
        <span class="hljs-keyword">this</span>.transformBuffer.SetData(transforms);
        <span class="hljs-keyword">int</span> matrixBufferId = Shader.PropertyToID(<span class="hljs-string">"transformBuffer"</span>);
        <span class="hljs-keyword">this</span>.material.SetBuffer(matrixBufferId, <span class="hljs-keyword">this</span>.transformBuffer);<font></font>
        <font></font>
        <span class="hljs-keyword">this</span>.uvBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-keyword">this</span>.count, <span class="hljs-number">16</span>);
        <span class="hljs-keyword">this</span>.uvBuffer.SetData(uvs);
        <span class="hljs-keyword">int</span> uvBufferId = Shader.PropertyToID(<span class="hljs-string">"uvBuffer"</span>);
        <span class="hljs-keyword">this</span>.material.SetBuffer(uvBufferId, <span class="hljs-keyword">this</span>.uvBuffer);<font></font>
        <font></font>
        <span class="hljs-keyword">this</span>.colorBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-keyword">this</span>.count, <span class="hljs-number">16</span>);
        <span class="hljs-keyword">this</span>.colorBuffer.SetData(colors);
        <span class="hljs-keyword">int</span> colorsBufferId = Shader.PropertyToID(<span class="hljs-string">"colorsBuffer"</span>);
        <span class="hljs-keyword">this</span>.material.SetBuffer(colorsBufferId, <span class="hljs-keyword">this</span>.colorBuffer);<font></font>
<font></font>
        <span class="hljs-keyword">this</span>.args = <span class="hljs-keyword">new</span> <span class="hljs-keyword">uint</span>[] {
            <span class="hljs-number">6</span>, (<span class="hljs-keyword">uint</span>)<span class="hljs-keyword">this</span>.count, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span><font></font>
        };<font></font>
        <span class="hljs-keyword">this</span>.argsBuffer = <span class="hljs-keyword">new</span> ComputeBuffer(<span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.args.Length * <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">uint</span>), ComputeBufferType.IndirectArguments);
        <span class="hljs-keyword">this</span>.argsBuffer.SetData(<span class="hljs-keyword">this</span>.args);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Bounds BOUNDS = <span class="hljs-keyword">new</span> Bounds(Vector2.zero, Vector3.one);<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params"></span>)</span> {   
        <span class="hljs-comment">// Draw</span>
        Graphics.DrawMeshInstancedIndirect(<span class="hljs-keyword">this</span>.mesh, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.material, BOUNDS, <span class="hljs-keyword">this</span>.argsBuffer);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Mesh <span class="hljs-title">CreateQuad</span>(<span class="hljs-params"></span>)</span> {
        <span class="hljs-comment">// Just the same as previous code. I told you this can be refactored.</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸æ¸²æŸ“å•ä¸ªç²¾çµç›¸æ¯”ï¼Œå‡ ä¹æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚</font><font style="vertical-align: inherit;">ä¸åŒä¹‹å¤„åœ¨äºï¼Œç°åœ¨æˆ‘ä»¬æ­£åœ¨å‡†å¤‡å…·æœ‰åºåˆ—åŒ–å˜é‡</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">count</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡å®šçš„Xå†…å®¹çš„æ•°ç»„</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬è¿˜åœ¨argsæ•°ç»„ä¸­è®¾ç½®äº†ç¬¬äºŒä¸ªæ•°å­—ï¼Œå°†å…¶è®¾ç½®ä¸º</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">count</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨æ­¤è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å°†countè®¾ç½®ä¸ºä»»ä½•å€¼ï¼Œå®ƒå°†ç”ŸæˆæŒ‡å®šæ•°é‡çš„spriteï¼Œä½†æ˜¯å®ƒå°†ä»…åœ¨ä¸€ä¸ªdrawè°ƒç”¨ä¸­å‘ˆç°å®ƒä»¬ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/867/3ce/d0a/8673ced0a9e85041d6dac0d3cee54858.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯10,000ä¸ªéšæœºç²¾çµã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºä»€ä¹ˆå°†minScaleå’ŒmaxScaleåºåˆ—åŒ–å˜é‡ï¼Ÿ</font><font style="vertical-align: inherit;">å½“æˆ‘ç”¨600,000ä¸ªç²¾çµæµ‹è¯•ä»£ç æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°é€Ÿåº¦é™è‡³60fpsä»¥ä¸‹ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæºåº“å…·æœ‰ä¸€ç™¾ä¸‡çš„èƒ½åŠ›ï¼Œé‚£ä¹ˆæ­¤ä»£ç ä¸ºä»€ä¹ˆä¼šå¤±è´¥ï¼Ÿ</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dd4/cc3/e49/dd4cc3e49da54e6719fbbae76f89df0c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯600,000ä¸ªç²¾çµã€‚</font><font style="vertical-align: inherit;">å®ƒå·¥ä½œç¼“æ…¢ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å»ºè®®è¿™å¯èƒ½æ˜¯ç”±äºé‡æ–°ç»˜åˆ¶ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘åˆ¶ä½œäº†minScaleå’ŒmaxScaleåºåˆ—åŒ–å‚æ•°ï¼Œå¹¶è®¾ç½®äº†è¾ƒå°çš„æ•°å­—ï¼Œå¦‚0.01å’Œ0.02ã€‚</font><font style="vertical-align: inherit;">ç›´åˆ°é‚£æ—¶ï¼Œæˆ‘æ‰èƒ½å¤Ÿä»¥è¶…è¿‡60fpsçš„é€Ÿåº¦ï¼ˆç”±ç¼–è¾‘å™¨çš„åˆ†æå™¨åˆ¤æ–­ï¼‰é‡æ–°åˆ›å»ºä¸€ç™¾ä¸‡ä¸ªç²¾çµã€‚</font><font style="vertical-align: inherit;">ä¹Ÿè®¸è¯¥ä»£ç å…·æœ‰æ›´å¤šåŠŸèƒ½ï¼Œä½†è°éœ€è¦ä¸€ç™¾ä¸‡ä¸ªç²¾çµï¼Ÿ</font><font style="vertical-align: inherit;">åœ¨æˆ‘ä»¬çš„æ¸¸æˆä¸­ï¼Œä¸éœ€è¦è¿™ä¸ªæ•°å­—çš„å››åˆ†ä¹‹ä¸€ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a45/a64/c8c/a45a64c8c1879767c9f7e082010ed102.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ç™¾ä¸‡ä¸ªå°ç²¾çµã€‚</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¢æŸ¥å™¨</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œæˆ‘æƒ³çœ‹çœ‹è¿™æ®µä»£ç å¦‚ä½•åœ¨æµ‹è¯•ç‰ˆæœ¬ä¸­å·¥ä½œã€‚</font><font style="vertical-align: inherit;">æˆ‘çš„è½¦å­çš„ç‰¹ç‚¹ï¼š3.7 GHzï¼ˆ4æ ¸ï¼‰ï¼Œ16 GB RAMï¼ŒRadeon RX460ã€‚è¿™æ˜¯æˆ‘å¾—åˆ°çš„ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/545/b87/a2e/545b87a2ec0774f7dc725c77c0c2e73d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æ‚¨æ‰€è§ï¼Œä¸€åˆ‡éƒ½å¾ˆå¿«ã€‚</font><font style="vertical-align: inherit;">å¯¹Graphics.DrawMeshInstancedIndirectï¼ˆï¼‰çš„è°ƒç”¨æ˜¾ç¤ºä¸º0æ¯«ç§’ã€‚</font><font style="vertical-align: inherit;">å°½ç®¡æˆ‘ä¸å¤ªç¡®å®šæ˜¯å¦è¦æ‹…å¿ƒGfx.PresentFrameã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb3/e43/929/bb3e43929f9d19e72daeda524863bbaf.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ²¡é‚£ä¹ˆå¿«</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°½ç®¡ç»“æœä»¤äººå°è±¡æ·±åˆ»ï¼Œä½†åœ¨å®é™…æ¸¸æˆä¸­ï¼Œä»£ç å°†ä»¥ä¸åŒçš„æ–¹å¼ä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">æœ€é‡è¦çš„ç¼ºå¤±æ–¹é¢æ˜¯å­ç”»é¢çš„æ’åºã€‚</font><font style="vertical-align: inherit;">å¹¶ä¸”å®ƒå°†å ç”¨å¤§éƒ¨åˆ†CPUèµ„æºã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œå¯¹äºç§»åŠ¨çš„ç²¾çµï¼Œå°†éœ€è¦åœ¨æ¯å¸§ä¸­æ›´æ–°ComputeBuffersã€‚</font><font style="vertical-align: inherit;">è¿˜æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚</font><font style="vertical-align: inherit;">æˆ‘å¹¶ä¸æœŸæœ›åœ¨ä¸€ä¸ªå®é™…çš„å·¥ä½œæ¡†æ¶ä¸­å¯ä»¥è¾¾åˆ°ä¸€ç™¾ä¸‡ï¼Œä½†æ˜¯å¦‚æœæˆ‘åœ¨ä¸åˆ°2æ¯«ç§’çš„æ—¶é—´å†…è¾¾åˆ°300,000ï¼Œé‚£ä¹ˆè¿™å¯¹æˆ‘æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚</font><font style="vertical-align: inherit;">DOTSè‚¯å®šä¼šå¯¹æ­¤æœ‰æ‰€å¸®åŠ©ï¼Œä½†è¿™æ˜¯å¦ä¸€ç¯‡æ–‡ç« çš„ä¸»é¢˜ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496816/index.html">ä½ èƒ½æ„Ÿè§‰åˆ°å€™é€‰äººï¼Œä»–è¿˜æ´»ç€å—ï¼Ÿ</a></li>
<li><a href="../zh-CN496818/index.html">æ¯ä¸ªæ ¸å¿ƒæ¯ç§’æ¯ç§’æ•°åä¸‡æ¡è·¯ç”±ã€‚Yandexè·¯ç”±ä½“éªŒ</a></li>
<li><a href="../zh-CN496820/index.html">åœ°å½¢é™·é˜±</a></li>
<li><a href="../zh-CN496822/index.html">ç¾å›½çš„åˆ›ä¸šå…¬å¸å¦‚ä½•æ­»äºå† çŠ¶ç—…æ¯’</a></li>
<li><a href="../zh-CN496824/index.html">æ‚¨çš„åŒ—æ¬§å·¥ä½œç¯å¢ƒ</a></li>
<li><a href="../zh-CN496828/index.html">åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æœ‰è¶£çš„è‡ªç”±èŒä¸šè€…ï¼Ÿï¼ˆå‰§é€ï¼šä¸æ˜¯Upworkï¼‰</a></li>
<li><a href="../zh-CN496830/index.html">ä»€ä¹ˆæ˜¯ç´§æ€¥äº¤æµï¼Œä¸ºä»€ä¹ˆéœ€è¦çŸ¥é“</a></li>
<li><a href="../zh-CN496832/index.html">æ‘„å½±ä¹‹æ—…ï¼šITMOæ–°ç‰©ç†ç ”ç©¶æ‰€çš„æ··åˆçº³ç±³å…‰å­å­¦å’Œå…‰ç”µå­å­¦å®éªŒå®¤æ­£åœ¨åšä»€ä¹ˆ</a></li>
<li><a href="../zh-CN496836/index.html">QSerializerï¼šç®€å•JSON / XMLåºåˆ—åŒ–çš„è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="../zh-CN496838/index.html">Slackä½¿ç”¨çš„é¡¹ç›®éƒ¨ç½²æ–¹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>