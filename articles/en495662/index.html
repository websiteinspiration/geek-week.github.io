<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🤝‍👨🏾 👂🏽 💰 Protecting and Hacking the Xbox 360 (Part 2) 🤛🏾 👐🏻 👩🏽‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The last time we left the Xbox 360 scene at a time when it became clear to the developers that DVD-ROM protection is easy to do, and you definitely ne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Protecting and Hacking the Xbox 360 (Part 2)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495662/"><img src="https://habrastorage.org/webt/wl/me/q-/wlmeq-sqggbyahmwznmt8q_nsd8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">last time</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we left the Xbox 360 scene at a time when it became clear to the developers that DVD-ROM protection is easy to do, and you definitely need to do something about it. </font><font style="vertical-align: inherit;">Attempts to rectify the situation by updating the software of the set-top box itself were unsuccessful, and Philips &amp; Lite-On entered the battlefield, the DVD drives of which with each new model became more and more advanced in terms of protection. </font><font style="vertical-align: inherit;">But the hacking methods each time became more and more sophisticated. </font><font style="vertical-align: inherit;">In this part, I will tell you how Microsoft tried to fix the situation with unlicensed discs, and what methods for flashing a DVD drive can get to when literally everything is closed.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meet - PLDS DG-16D2S 74850c</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Philips &amp; LiteOn DG-16D2S drive began to be installed in game consoles in 2008, and put it right up to 2011, when a new, “slim” version of the console came out. </font><font style="vertical-align: inherit;">Here is our hero:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3l/u5/2q/3lu52qm0gcrqxcbiyvpxnr8l_nm.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, the researchers immediately took up and found out:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the drive is very similar to the previous model, Philips &amp; Benq VAD6038</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the firmware is stored inside the controller, do not consider the programmer</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does not enter service mode, even on VIA chipsets</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Even the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MT1319</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> controller </font><font style="vertical-align: inherit;">on the board is flooded with a compound:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wb/f_/h2/wbf_h2pdynpvyyadbrdpnqunpqc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It looked like Microsoft had finally made an “unbreakable” drive and everyone would have a hard time. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, after some time, the developer of modified firmware for the Xbox 360 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reported that the drive is amenable and the development of custom firmware is already underway:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva: i have found some things that are not yet known about the lite-on, it will be done!</font></font></blockquote><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I do not want to wait, change!</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
While custom firmware was being developed (and it was being developed for almost six months), people wanted to flash "here and now." </font><font style="vertical-align: inherit;">And at the end of August 2008, researchers found an </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://web.archive.org/web/20181011221135/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interesting trick</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Turn on the prefix</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open the DVD drive tray</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We pull out the power of the DVD-drive</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Push the tray in the middle</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insert drive power</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After these magical actions, the drive spits out its secret key in UART! </font><font style="vertical-align: inherit;">It remained to assemble the simplest COM-UART adapter on one transistor and poke it at a point on the board at the time of power-up:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ef/hc/6i/efhc6iwq8xcwfzr8i59nlnx_vdo.jpeg"></div><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(historically reliable reconstruction using an adapter from those times)</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
According to my assumptions, this “feature” was left for service centers so that it would be easy to replace the drive with a new one in the event of a breakdown. </font><font style="vertical-align: inherit;">It is difficult to come up with another explanation for the presence of such functionality. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As soon as the key is received, you can write it to the used firmware, change its name to “PLDS DG-16D2S” and play as if nothing had happened! </font><font style="vertical-align: inherit;">(The first revisions of the Xbox 360 were not famous for reliability, because there were many used TS-H943 drives on the market, shot from half-dead consoles). </font><font style="vertical-align: inherit;">This step has strongly come back in the future, but at that time gamers were happy.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5w/q5/wu/5wq5wuxfiol6khr45p7jf5nduam.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There was a problem in all this idyll, and it came from where they had not expected. </font><font style="vertical-align: inherit;">What’s the matter - the Xbox 360 drive has a non-standard and short power cable:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/9v/xj/wg9vxjuhhxpnwfnxdu_oqghmijc.jpeg" width="600"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are small tabs on the plug for proper orientation in the connector:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ck/yd/tv/ckydtvt3_hbwzspwcl9ox4yhici.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The key reading operation is conveniently carried out “on the back” when the drive is upside down. </font><font style="vertical-align: inherit;">But they forgot to turn the not too flexible power cable, the length of the limiters on the plug was not enough, as a result, 12 volts went to the wrong contacts at all, and a magic haze flew out of the board ...</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xb/zw/np/xbzwnpttjwbdgirlmlcbkjnfuq8.jpeg" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Those who were “lucky” to burn the drive were advised to carefully assemble the prefix back and hand over nothing to the store under warranty. </font><font style="vertical-align: inherit;">Often the store did not steam at all and accepted such consoles without even checking the warranty seal.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hooray, firmware!</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, after almost six months of waiting, for the Christmas holidays </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> released the iXtreme 1.5 firmware release, from which we learned:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and his team considered firmware dissolution of the chip body</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The key is still read by the semi-retracted tray method</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To enter the service mode and record the firmware, you need to erase the drive!</font></font></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I was sure that I had a photo with a half-dissolved MT1319 connected to the programmer, but I could not find it. </font><font style="vertical-align: inherit;">As soon as I find it, I'll add it right here (if anyone has it, send it, please). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The “erase before recording” feature caused problems for the people - the computer could freeze, go to BSOD. </font><font style="vertical-align: inherit;">Even if everything “went this way”, after erasing the drive, of course, was not determined by the system and had to enter the service mode “blindly”. </font><font style="vertical-align: inherit;">In general, people pretty badly hit his nerves. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There were experimenters who pressed the “erase” button simply out of curiosity, without having read the key before, even despite the warnings:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pp/up/e7/ppupe7hf18eazd8fairfhcubb9u.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But the main goal was achieved - the “non-flashable” LiteOn finally became flashed, and craftsmen with straight arms could flash the drive on their own.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DG-16D2S 83850c</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, Microsoft came to their senses and began to install a drive with a new firmware version, 83850s, in which the UART key reading functionality no longer worked. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surprisingly, it turned out that LiteOn 83850c gave the key via SATA, and with the same witchcraft with a half-open tray! </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=http://web.archive.org/web/20090804212054/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foundmy.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> released the </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=http://web.archive.org/web/20090804212054/" rel="nofollow"><font style="vertical-align: inherit;">LO83info</font></a><font style="vertical-align: inherit;"> utility that read the key, but issued it in encrypted form. </font><font style="vertical-align: inherit;">It was proposed to send the key to the authors by mail and for $ 42 receive a decrypted version.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/o2/f8/du/o2f8dufd2iwp5nf970dkb0wq_la.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The program lasted for four days, after which Maximus and Geremia released a free key decryptor :) How many authors managed to earn these days is unknown.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4y/sw/bh/4yswbh2cgyqvrjevbjp_jrtvy3g.jpeg"></div><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DG-16D2S 93450c</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A freebie with easy reading of keys could not last long - LiteOn 83850c v2, which did not yield to the tricks of LO83Info, soon began to fall into, and then LiteOn 93450c was completely put into consoles. </font><font style="vertical-align: inherit;">All methods of reading the key are closed, the key cannot be </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
prefixed </font><font style="vertical-align: inherit;">without the key ... </font><font style="vertical-align: inherit;">They were not sad for long, enthusiasts found this hardware bug:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cut off part of the supply roads</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solder a 22 ohm resistor through the switch</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">short circuit power through 22 ohms to GND!</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, the voltage on the USB flash drive inside the processor sagged so much that only 0xFF was read instead of the data, the drive was sure that the firmware had already been erased and entered the service mode! </font><font style="vertical-align: inherit;">Well, after entering the service mode, it remained only to open the resistor and read the entire USB flash drive:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/f4/qq/rm/f4qqrmh6iq4058kdzdvwwd8pjb0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This “flashing” method killed even more drives than UART. </font><font style="vertical-align: inherit;">Imagine what a schoolboy can do with a Soviet soldering iron in an attempt to solder two wires according to the scheme? </font><font style="vertical-align: inherit;">This is how it should be:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/8t/wi/ve/8twivetamxwsdgste4ybra7rhd4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But this could be seen on the forums:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/us/zv/ur/uszvurjtb8wsltxn2nddp_won3e.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m6/il/or/m6ilordx8xk52jv6xyseuyavc-c.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gm/ju/70/gmju70nn6cmkqycs5buqc4jvpmo.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, and since the vulnerability is hardware, they could no longer fix this with Microsoft firmware update, LiteOn DG-16D2S finally went into the category of flash drives. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They stopped feeling completely sad when they discovered an even more interesting hack:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">turn on the drive</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">turn off the 3.3v power line (the 1.8v line remains active)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ground point MPX01</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">turn on 3.3v</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We go into the service and read the key from RAM! ??</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/iz/nf/fe/iznffeggfew1x-ltf6mo9idasxy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The MPX01 point in the drive is responsible for whether the firmware will be decrypted at startup. </font><font style="vertical-align: inherit;">Closing it to GND, we force the drive to skip the decryption stage, because of which it tries to start the garbage and goes into error. </font><font style="vertical-align: inherit;">And already from this state, he allows you to enter the limited service mode and read RAM! </font><font style="vertical-align: inherit;">And due to the fact that we did not clean 1.8v, the RAM was not reset and our key still lies there. </font><font style="vertical-align: inherit;">That's it.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New - PLDS DG-16D4S 9504</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Along with the Slim version of the console in the Xbox 360, the DVD drive has also been updated. </font><font style="vertical-align: inherit;">Even the design of the drive changed, his legs disappeared and he became even more like a brick:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/x2/2w/5w/x22w5wpjden1x3whqvcbo7qspf4.png" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The drive controller has also changed, now everyone was </font><b><font style="vertical-align: inherit;">driven by the MT1335</font></b><font style="vertical-align: inherit;"> chip</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/v3/ru/th/v3ruth5rgzkoel9zwi0zwwha44y.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surprisingly, the new model, unlike its predecessor, could be read and written without any problems. </font><font style="vertical-align: inherit;">The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maximus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> team quickly dealt with this </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ahead of the planet, they released a utility for reading / writing a key / firmware called "Tarablinda":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/bo/3u/pubo3unhez9nmwlangtiknjrepm.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, Liteon D4S firmware for research was also obtained by dissolving the chip:</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/c3/ai/dr/c3aidrxrazmtf9z954kt4cyeaws.jpeg" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And while </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is developing ... people </font><font style="vertical-align: inherit;">are </font><b><font style="vertical-align: inherit;">shoving the old-fashioned</font></b><font style="vertical-align: inherit;"> used ear drives again! </font><font style="vertical-align: inherit;">Having cut legs and warped the body:</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/ji/hl/wnjihltaudu3nqysbz2yivtlu7w.png" width="350"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But take it and block it!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This time, Microsoft decided to approach from the other side. </font><font style="vertical-align: inherit;">Since people still find ways to read the key, let's forbid overwriting it! </font><font style="vertical-align: inherit;">In the new consoles, they began to detect DG-16D4S drives of versions 0225, 0401 and 1071, in which the internal SPI flash memory was locked! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The lock was performed using the status register and legs of the WP flash memory:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nn/vz/zl/nnvzzliftjd8ggth6hqbo48roi8.jpeg" width="600"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But here they came up with a method very similar to how LiteOn 93450c was overcome:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cut off the power road</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">turn on the drive, go to the service</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">poke a resistor of 18 ohms to the cut off</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">give the unlock command!</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/v3/hd/6y/v3hd6y-rgvviibdbfdhldfosz1y.jpeg" width="600"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In exactly the same way, the supply voltage of the SPI flash memory sagged, something clicked in her electronic brains and the unlock successfully completed. </font><font style="vertical-align: inherit;">This worked only on flash drives from the company MXIC:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bg/dv/js/bgdvjsvn0rjiqafkqug1ohzwhlw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For Winbond, they came up with an even crazier unlock method. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fact is that the DVD drive processor was not integral. </font><font style="vertical-align: inherit;">On top of it, a chip of the same flash memory was glued to it with a sandwich, connected to the main crystal by thin wires. </font><font style="vertical-align: inherit;">And the Write Protect (WP) wiring we needed, despite the fact that it was tightly wound to ground, was quite successfully above all others:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/17/z2/ju/17z2juztxeywml0jvavy9c-qg8s.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There was an idea to somehow cut it, and then give the unlock command. </font><font style="vertical-align: inherit;">And yes, it was here that people went to accurately and accurately drill a chip with a millimeter drill!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tg/tf/ng/tgtfngelrsisc5ra_9i18u78hki.jpeg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, if accurately marked and neatly acted, you can achieve a great chance of success. </font><font style="vertical-align: inherit;">Naturally, inexperienced movements were done like this:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fj/yl/c_/fjylc_tgwqqh03ogqgd9ngmbsda.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or so:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/la/o8/u9/lao8u9okzcibuwkwpecar9tcbj0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But it wasn’t so bad - MT1335WE chips after (or instead of) unsuccessful unlocking could be resolved to compatible MT1339E with an external USB flash drive removed from Chinese drives:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/r9/w4/4q/r9w44qvz2rb95wqhllxsfflxnz8.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The result - again, victory is not on the side of Microsoft, discs are written, drives are flashed.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AP 2.5, XGD3, ...</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoft not only improved the firmware of the drives, but also finalized the protection of the game discs themselves. </font><font style="vertical-align: inherit;">And here they came off in full: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the format of the disk itself was changed</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The old XGD2 format contained, like a regular two-layer DVD, about 7.5 GB of data. </font><font style="vertical-align: inherit;">The new </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XGD3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> used a slightly larger disk area, almost to the very edge, due to which 8.5 GB of data already fit in. </font><font style="vertical-align: inherit;">The usual means of "disc" can not be written.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/v8/tj/70/v8tj704zlqfwynql8xcfuxscr7o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secondly, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dae.bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> file was added to the system itself </font><font style="vertical-align: inherit;">, containing additional checks for specific games. </font><font style="vertical-align: inherit;">The prefix asked the drive on which physical sector of the disk the specific data is located and compared with the samples. </font><font style="vertical-align: inherit;">Unlike stamped licenses according to one template, the data placement on the recorded discs could differ.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/c3/b8/ei/c3b8eijszxuow4ku2n-7sv6klfc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interestingly, only a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">few popular games</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> were protected in this way </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Thirdly, to support all the innovations, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all DVD drives</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on all consoles </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">were updated</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the next update of the system!</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LiteOn D2S updated and closed simple key reading methods</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Previously flashing LiteOn D4S 9504 updated and locked on record</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Those with prefixes "flashed" normally - had to "flash" again</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Who changed the drive to another model - got an error and a non-working prefix</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ek/cb/th/ekcbthjncjriggmfnpymw5wq100.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In very old Samsung TS-H943 DVD drives it was not possible to implement AP 2.5 checks, so only XGD3 format support was added in their update. </font><font style="vertical-align: inherit;">Most unlucky were the players who were replaced with Samsung with LiteOn firmware - they had to look for a new drive and change it back. </font><font style="vertical-align: inherit;">The owners of LiteOn D4S 9504 were very disappointed, they had to unlock the chip for re-firmware. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But here everything went around. </font><font style="vertical-align: inherit;">It turned out that 7.5 GB is not the limit, and on ordinary two-layer discs it is quite possible to record 8 GB or more, which was required for XGD3 games. </font><font style="vertical-align: inherit;">On ordinary writing drives, the recording did not go to the end (by 97%), as long as there was enough space - such discs also worked, although there was a threat of detection and subsequent ban. </font><font style="vertical-align: inherit;">Further </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> released a program with support for some computer DVD cutters, which tricked the drive, removed restrictions and forced it to write the entire surface of the disc:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qm/fp/nj/qmfpnjywh1qwphtf_a3qzilnh6q.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva also</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> made firmware for Xbox 360 drives - iXtreme LT + to bypass new protections - ready-made answers directly from the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dae.bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> file </font><b><font style="vertical-align: inherit;">were</font></b><font style="vertical-align: inherit;"> written to the game disc, the firmware responded “by template”, everyone is happy. </font><font style="vertical-align: inherit;">But Microsoft also acted in a rather obvious way - in the next system update they changed </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dae.bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the pirates stopped working, the disks had to be patched and burned again:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xh/ur/do/xhurdofjqay6jwhk3mhnvvk9oz0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After some time, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> became thoughtful, and said that he had figured out how to solve AP 2.5 once and for all, saying that wait for iXtreme LT + 3.0. By the way, by that time the number of questions “well, when is the new firmware ??” in the IRC channels where </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was sitting </font><font style="vertical-align: inherit;">so increased that someone made the whole site c4evaspeaks.com, where all his quotes (literally everything!) and news on the firmware topic were saved:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vc/mk/pr/vcmkprcaun5c4jdor9sc_hydn1y.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/14/hm/1s/14hm1sa-_xvsj22urhch7fqvvd4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In iXtreme LT + 3.0, instead of the “pattern matching” answer, special data on disk geometry was used. </font><font style="vertical-align: inherit;">In fact, the licensed disc was scanned, generated and recorded on the game disc with a special “card”, by which the firmware calculated and correctly answered any AP 2.5 requests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On this, the saga with AP 2.5 ended with the victory of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and its firmware. </font><font style="vertical-align: inherit;">There were attempts to ban players whose AP 2.5 checks worked, but either the bans hooked honest players, or they failed to prove the fact of piracy and 100% reliability of the checks, but the bans also stopped.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Legend - PLDS DG-16D5S 1175</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The final point in the struggle for drives put LiteOn DG-16D5S:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/y0/ed/jo/y0edjoonuhg1grvcacbdkpn0ieg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It contained the MT1332E controller, which did not enter the service mode by known methods, and, according to rumors, the key was not stored in ROM:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/d1/kh/0j/d1kh0jgav9xzpki23t3rws_wrn4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There were attempts to read the ROM by dissolving the case and soldering with wiring:</font></font><br>
<img src="https://habrastorage.org/webt/-a/nq/w4/-anqw4j8o1_awgp8pm9xybmyvoo.jpeg"><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/an/3j/kb/an3jkbvckvayd-jhdqe-au9-anq.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yes, inside it was also a sandwich from proca and flash drive:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zt/6d/ti/zt6dtinz9e5wszugaqpaw-7xfpo.jpeg" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is information that there were also software methods for reading firmware from it; I personally downloaded the laid out dumps on one of the forums. </font><font style="vertical-align: inherit;">In any case, this time in the public domain there are no tools for reading the key from the drive itself. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instead, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> developed the iXtreme LTU (Lite Touch Ultimate) firmware, which used data extracted from the set-top box itself (through hacking the system itself) and required replacing the drive circuit board. </font><font style="vertical-align: inherit;">The custom printed circuit board was exactly the same as the one from the 16D5S, but the processor on it could be reflashed:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xi/qm/dz/xiqmdz7kkjiiglbtifmxrrts5t4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
More adventurous "firmware wizards" independently went to the suppliers of unlocked MT1332 and simply soldered the chip on the board. </font><font style="vertical-align: inherit;">These chips were shot from Chinese DVD players on the same chip:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gm/cg/6x/gmcg6xxqi7sne7fgkoojwo2f8ao.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soon, the MT1332 chips corny ended! </font><font style="vertical-align: inherit;">Then the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maximus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> team </font><font style="vertical-align: inherit;">developed an unusual thing - Cryptocop:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vp/8y/vt/vp8yvtld_y3vmqokw29kqezc6f0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This chip, attached on the side of the board, did the magic thing - at startup it loaded a new bootrom into MT1335 / MT1339, after which the LTU firmware designed for MT1332 started up and worked perfectly. But there were enough chips - MT1335 was removed from used drives of the previous model, 16D </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> S, MT1339 - from Chinese drives or from suppliers. The normal version of LTU for MT1339 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> refused to compile (otherwise people would just </font><b><font style="vertical-align: inherit;">install</font></b><font style="vertical-align: inherit;"> old drives and not buy their boards). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But when already the reserves of LTU boards ran out, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> made an amazing feint with his ears - he compiled the iXtreme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LTU2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> firmware for the </font><b><font style="vertical-align: inherit;">MT1319</font></b><font style="vertical-align: inherit;"> chip! This processor was in the very first LiteOn with "thick" consoles. And yes, they started riveting and selling new LTU2 boards:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/a1/yv/ad/a1yvadbb09aah4lznlip5s0txd4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, finally, the Chinese joined the holiday, who started making boards based on MT1309, the more common MT1319 brother with an external flash drive:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m1/lk/q5/m1lkq5y6scf4c9nbkd7asocmwei.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The era of Xbox 360 firmware ended when a new revision of the console came out, on which you can’t get the key either from the system or from the DVD drive. </font><font style="vertical-align: inherit;">But more about that in the next part! </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection and hacking Xbox 360, Part 1 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection and hacking Xbox 360, Part 2 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection and hacking Xbox 360, Part 3</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Any details, details, nuances - ask in the comments!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495642/index.html">Start collecting errors in copy functions</a></li>
<li><a href="../en495644/index.html">TS Total Sight. Event collection, incident analysis, and threat response automation tool</a></li>
<li><a href="../en495646/index.html">What non-stressful podcasts to listen to on the weekend</a></li>
<li><a href="../en495658/index.html">Where to get audio for machine learning: a selection of open libraries licensed under Creative Commons</a></li>
<li><a href="../en495660/index.html">NVMe over Fiber Channel. What is it and where is it needed?</a></li>
<li><a href="../en495670/index.html">Migrating from a seamless Data Lake to a distributed Data Mesh</a></li>
<li><a href="../en495674/index.html">Exploring electromagnetic fields using an SDR receiver and OpenCV</a></li>
<li><a href="../en495676/index.html">ETL process for retrieving email data in Apache Airflow</a></li>
<li><a href="../en495678/index.html">Competition VK Sup. Track ML. 4th place. How?</a></li>
<li><a href="../en495682/index.html">API reverse for its android application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>