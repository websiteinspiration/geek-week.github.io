<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ£Ô∏è üîå ü•ã Como Gatsby contornou o Next.js ü§òüèæ üè¥ üë®üèº‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O autor do artigo, cuja tradu√ß√£o publicamos hoje, trabalha como programador na Antler. Esta empresa √© um gerador de inicializa√ß√£o global. H√° dias de d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Como Gatsby contornou o Next.js</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/500228/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O autor do artigo, cuja tradu√ß√£o publicamos hoje, trabalha como programador na Antler. </font><font style="vertical-align: inherit;">Esta empresa √© um gerador de inicializa√ß√£o global. </font><font style="vertical-align: inherit;">H√° dias de demonstra√ß√£o na Antler v√°rias vezes ao ano, reunindo muitos criadores de startups e investidores de todo o mundo. </font><font style="vertical-align: inherit;">A situa√ß√£o em torno do COVID-19 for√ßou o Antler a traduzir seus eventos para um formato online.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/hq/r9/an/hqr9anmkfyicv4znlhi2ynk16rm.jpeg"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A empresa queria garantir que os visitantes de seus eventos virtuais, sem se distra√≠rem com nada e sem ficarem presos em lugar algum, pudessem ver a coisa mais importante. </font><font style="vertical-align: inherit;">Ou seja, as id√©ias de startups apresentadas ao p√∫blico, expressas como o conte√∫do das p√°ginas da web. </font><font style="vertical-align: inherit;">Os dias de demonstra√ß√£o virtual podem ser de interesse para um p√∫blico bastante amplo. </font><font style="vertical-align: inherit;">Alguns membros desse p√∫blico podem participar pela primeira vez em algo assim. </font><font style="vertical-align: inherit;">Portanto, a empresa teve que fazer tudo da melhor maneira poss√≠vel e fornecer carregamento em alta velocidade de p√°ginas representando startups. </font><font style="vertical-align: inherit;">Eles decidiram que esse √© apenas o caso quando um aplicativo da web progressivo de alto desempenho (PWA, Progressive Web App) pode ser √∫til. </font><font style="vertical-align: inherit;">O principal problema foi encontrar a tecnologia certa para o desenvolvimento do PWA.</font></font><br>
<a name="habracut"></a><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f54/6f9/1fa/f546f91fa52e40c139cc78fe26b1ad06.gif"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renderiza√ß√£o de servidor ou gerador de site est√°tico?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, apresentarei um pouco ao curso. Todos os nossos projetos s√£o baseados no React e na biblioteca Material-UI. Como resultado, inicialmente decidimos n√£o nos afastar dessa pilha de tecnologias, o que nos permitiria garantir alta velocidade de desenvolvimento e tornar o novo projeto compat√≠vel com o que j√° possu√≠mos. A principal diferen√ßa entre este novo projeto e nossos outros aplicativos React foi que o banco de dados para eles foi criado usando o aplicativo create-react-app e que eles foram totalmente renderizados no cliente (CSR, Client-Side Rendering). Isso, em particular, levou ao fato de que, quando o aplicativo foi carregado inicialmente, os usu√°rios foram for√ßados a observar uma tela branca em branco enquanto o c√≥digo JavaScript do projeto estava carregando, processando e executando.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precis√°vamos de um n√≠vel inflex√≠vel de desempenho. Portanto, come√ßamos a pensar em usar a renderiza√ß√£o do lado do servidor (SSR, renderiza√ß√£o do servidor) ou um gerador de site est√°tico (SSG, Static Site Generator) para que o carregamento inicial dos aplicativos fosse o mais r√°pido poss√≠vel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nossos dados s√£o armazenados no Cloud Firestore e os acessamos usando o Algolia. Isso nos permite controlar, no n√≠vel do campo do banco de dados, o acesso p√∫blico aos dados com chaves de API restritas. Isso tamb√©m melhora o desempenho da consulta. Por experi√™ncia, sabemos que as consultas do Algolia s√£o mais r√°pidas que o normal e que o SDK JavaScript do Firestore compactado tem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">86 KB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de tamanho </font><font style="vertical-align: inherit;">. No caso da Alg√≥lia, isso √© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,5 Kb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, quer√≠amos tornar os dados que fornecemos aos clientes o mais atualizados poss√≠vel. Isso nos ajudaria a corrigir rapidamente dados err√¥neos que poderiam ser publicados acidentalmente. Embora a pr√°tica padr√£o do SSG preveja a implementa√ß√£o de solicita√ß√µes de dados relevantes durante a montagem do projeto, esper√°vamos que em nosso banco de dados os dados fossem gravados com bastante frequ√™ncia. Em particular, estamos falando sobre a grava√ß√£o de dados iniciada por administradores usando a interface </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">firetable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e por iniciativa dos fundadores dos projetos, usando o portal da web. Isso leva √† montagem competitiva do projeto. Al√©m disso, devido aos recursos estruturais do nosso banco de dados, pequenas altera√ß√µes podem levar a novas opera√ß√µes de montagem do projeto. Isso torna nosso pipeline de CI / CD extremamente ineficiente. Portanto, precisamos que as solicita√ß√µes para receber dados do reposit√≥rio sejam executadas toda vez que um usu√°rio solicita o carregamento de uma p√°gina. Infelizmente, isso significava que nossa solu√ß√£o n√£o seria um exemplo de um projeto SSG "limpo".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inicialmente, nosso aplicativo foi criado com base no Gatsby, pois j√° usamos p√°ginas de entrada criadas no Gatsby e um deles j√° utilizava a biblioteca Material-UI. </font><font style="vertical-align: inherit;">A primeira vers√£o do projeto formou uma p√°gina que, enquanto os dados estavam sendo carregados, exibia um "esqueleto". </font><font style="vertical-align: inherit;">Ao mesmo tempo, a primeira tinta de conten√ß√£o (FCP) estava na regi√£o de 1 segundo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d75/578/718/d7557871834d0d244f8501327d68810d.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download do "esqueleto" da p√°gina com carregamento de dados subsequente</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A solu√ß√£o acabou sendo interessante, mas teve suas desvantagens, porque os dados para a sa√≠da da p√°gina foram baixados por iniciativa do cliente:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para visualizar o conte√∫do da p√°gina, os usu√°rios teriam que esperar pelo download desta p√°gina e pelos dados exibidos nela, obtidos atrav√©s de 4 solicita√ß√µes √† Algolia.</font></font></li>
<li>    JS-    .   ,  React   ¬´¬ª      .         DOM.</li>
<li>         .  ,  ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, no fim de semana prolongado, decidi experimentar a vers√£o SSR do projeto criado usando o Next.js. Felizmente para mim, a documenta√ß√£o da Material-UI teve um exemplo de projeto para o Next.js. Portanto, n√£o precisei aprender toda essa estrutura do zero. Eu apenas tive que examinar algumas partes do tutorial e da documenta√ß√£o. Eu converti o aplicativo em um projeto que foi renderizado no servidor. Quando um usu√°rio solicitou o carregamento da p√°gina, o servidor executou solicita√ß√µes de dados necess√°rias para preencher a p√°gina. Esta etapa nos permitiu resolver os tr√™s problemas acima. Aqui est√£o os resultados do teste para duas op√ß√µes de aplicativo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b60/0da/cda/b600dacda702f25e97808ed9f762ff8c.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultados da pesquisa de aplicativos usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google PageSpeed ‚Äã‚ÄãInsights</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . √Ä esquerda, Gatsby (SSG), √† direita, o Next.js (SSR) ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem original</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O FCP para a vers√£o do Next.js do projeto era cerca de tr√™s vezes maior do que para a vers√£o baseada no Gatsby. A vers√£o do Gatsby do projeto tinha um √çndice de velocidade de 3,3 segundos, enquanto a vers√£o Next.js tinha 6,2 segundos. O tempo para o primeiro byte (TTFB, Tempo at√© o primeiro byte) foi de 2,56 segundos no Next.js e de 10 a 20 ms no Gatsby.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deve-se notar que a vers√£o Next.js. do site foi implantada em outro servi√ßo (aqui usamos os servi√ßos ZEIT Now e Firebase Hosting - isso tamb√©m pode afetar o aumento do TTFB). Mas, apesar disso, ficou claro que a transfer√™ncia de opera√ß√µes de upload de dados para o servidor fazia o site parecer mais lento, apesar do fato de que todos os materiais da p√°gina eram carregados aproximadamente ao mesmo tempo. O fato √© que, na vers√£o Next.js. do projeto, o usu√°rio por algum tempo v√™ apenas uma p√°gina em branco em branco.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e0/8a2/ab3/6e08a2ab3bcb4c06471cc92545848d8a.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Captura de tela mostrando o carregamento de duas vers√µes de um aplicativo. </font><font style="vertical-align: inherit;">O download n√£o foi conclu√≠do ao mesmo tempo. </font><font style="vertical-align: inherit;">Os registros s√£o sincronizados no momento em que voc√™ pressiona a tecla Enter.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tudo isso nos fornece uma li√ß√£o importante do campo do desenvolvimento da Web: voc√™ precisa fornecer feedback visual aos usu√°rios. </font><font style="vertical-align: inherit;">Um</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> estudo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descobriu que aplicativos que usam telas esquel√©ticas parecem carregar mais rapidamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, esse resultado n√£o corresponde ao clima que voc√™ pode ter percebido se ler artigos sobre desenvolvimento web nos √∫ltimos anos. </font><font style="vertical-align: inherit;">Ou seja, estamos falando do fato de que n√£o h√° nada de errado em usar os recursos do cliente e que o SSR n√£o √© uma solu√ß√£o abrangente para problemas de desempenho.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desempenho de gera√ß√£o de site est√°tico: comparando Gatsby e Next.js</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enquanto as duas estruturas em considera√ß√£o, Gatsby e Next.js, s√£o conhecidas, respectivamente, por sua capacidade de gerar sites est√°ticos e renderiza√ß√£o de servidor, o </font><font style="vertical-align: inherit;">suporte ao SSG foi aprimorado </font><font style="vertical-align: inherit;">no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js 9.3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o que o torna um concorrente do Gatsby. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No momento da reda√ß√£o deste artigo, a capacidade do Next.js. de gerar sites est√°ticos ainda era muito recente. Ela tinha pouco mais de um m√™s. Ela ainda √© reportada na primeira p√°gina do projeto. Agora, n√£o h√° muitas compara√ß√µes dos recursos SSG do Gatsby e Next.js (ou talvez ainda n√£o existam tais compara√ß√µes). Como resultado, decidi realizar meu pr√≥prio experimento.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Retornei a vers√£o Gatsby do projeto ao estado em que os dados foram baixados no cliente e fiz com que as duas vers√µes do aplicativo tivessem exatamente o mesmo conjunto de recursos. Ou seja, eu tive que remover o que os plugins do Gatsby s√£o respons√°veis: fun√ß√µes de SEO, gerando favicons, manifesto de PWA. Para comparar exclusivamente pacotes JavaScript criados por estruturas, n√£o inclu√≠ imagens e outros conte√∫dos baixados de fontes externas nos projetos. Ambas as vers√µes do aplicativo foram implantadas na plataforma Firebase Hosting. Para refer√™ncia, duas vers√µes do aplicativo foram criadas com base no Gatsby 2.20.9 e Next.js 9.3.4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Corri o Lighthouse no meu computador 6 vezes para cada vers√£o. Os resultados mostraram uma pequena vantagem para Gatsby.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82a/522/059/82a522059afba13a70e62df76144b6e6.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Valores m√©dios obtidos ap√≥s o lan√ßamento de 6 Lighthouse para cada estrutura ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem original</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Em termos de avalia√ß√£o geral de desempenho, a vers√£o Next.js ficou apenas ligeiramente atr√°s da vers√£o Gatsby. O mesmo vale para FCP e Speed ‚Äã‚ÄãIndex. O pr√≥ximo atraso em potencial da primeira entrada para a vers√£o Next.js. √© um pouco maior que na vers√£o Gatsby.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender melhor o que est√° acontecendo, virei para a guia Rede das ferramentas de desenvolvedor do Chrome. Como se viu, na vers√£o Next.js. do projeto, o n√∫mero de fragmentos nos quais o c√≥digo JavaScript √© dividido √© 3 a mais do que na vers√£o Gatsby (excluindo arquivos de manifesto), mas o c√≥digo compactado √© 20 KB menor. As solicita√ß√µes extras necess√°rias para baixar esses arquivos superam tanto os benef√≠cios de um pacote menor que prejudicam o desempenho?</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27b/d84/d9a/27bd84d9aad10ae1f3421a0f829c3fa2.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na vers√£o Gatsby do projeto, 7 solicita√ß√µes s√£o executadas para baixar 379 KB de dados. Na vers√£o Next.js. do projeto - 12 solicita√ß√µes para baixar 359 KB de dados ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem original</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Se voc√™ analisar o desempenho do JavaScript, as ferramentas do desenvolvedor dizem que a vers√£o Next.js. do projeto precisa de 300 ms adicionais para a primeira renderiza√ß√£o e que esta vers√£o gaste mais tempo na tarefa Avaliar Script. Nas ferramentas do desenvolvedor, essa tarefa foi marcada como uma "tarefa longa".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24b/1be/11c/24b1be11c62fc6a1561a413555e53c0f.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An√°lise do desempenho de diferentes op√ß√µes de projeto usando a guia Desempenho das ferramentas de desenvolvedor do Chrome ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem original</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
. Comparei o c√≥digo do projeto para descobrir se existem diferen√ßas na implementa√ß√£o que possam afetar o desempenho. Com exce√ß√£o da remo√ß√£o de c√≥digos e corre√ß√µes desnecess√°rias associadas aos tipos TypeScript ausentes, a √∫nica diferen√ßa era a implementa√ß√£o de rolagem suave da p√°gina ao passar para partes individuais. Esse recurso foi introduzido anteriormente por um arquivo</font></font><code>gatsby-browser.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e foi movido para um</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> componente importado dinamicamente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Como resultado, esse c√≥digo seria executado apenas em um navegador. (Usamos o pacote npm de</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rolagem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suave</font><font style="vertical-align: inherit;">e, ao import√°-lo, ele precisa de um objeto</font></font><code>window</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) Esse problema pode ser o culpado, mas n√£o sei como ele √© tratado no Next.js.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby √© mais conveniente do ponto de vista do desenvolvedor</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No final, decidi optar pela vers√£o Gatsby do projeto. Al√©m disso, aqui n√£o levei em considera√ß√£o a vantagem de desempenho muito pequena que o Gatsby mostrou em compara√ß√£o com o mecanismo SSG Next.js. (n√£o vou me apegar seriamente √† vantagem de 0,6 segundos?). O fato √© que, na vers√£o Gatsby do projeto, muitos recursos do PWA j√° est√£o implementados, e n√£o vi o ponto de t√™-los implementados novamente na vers√£o Next.js. do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando eu estava criando a primeira vers√£o do Gatsby do projeto, pude adicionar rapidamente alguns recursos √∫teis do PWA ao projeto. Por exemplo, para adicionar a cada p√°gina minhas pr√≥prias metatags necess√°rias para o SEO, eu apenas tive que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ler o manual</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para equipar o projeto com um manifesto do PWA, eu s√≥ precisava usar o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">plug-in</font></a><font style="vertical-align: inherit;"> apropriado</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para equipar o projeto com favicons que suportariam todas as plataformas dispon√≠veis (e, neste caso, ainda h√° uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bagun√ßa terr√≠vel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), eu nem precisei fazer nada, pois o suporte a favicon faz parte do plugin respons√°vel pelo manifesto. √â muito confort√°vel!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A implementa√ß√£o dos mesmos recursos na vers√£o Next.js do aplicativo exigiria mais trabalho. Eu precisaria procurar manuais de treinamento, todos os tipos de "melhores pr√°ticas". E o fato de que eu teria sucesso, de qualquer maneira, n√£o me daria nenhuma vantagem. Afinal, a vers√£o Next.js. do projeto n√£o difere em desempenho superior √† vers√£o Gatsby. Al√©m disso, esse foi o motivo pelo qual decidi simplesmente desativar os recursos correspondentes da vers√£o Gatsby do projeto, comparando-a com a vers√£o Next.js. A documenta√ß√£o do Next.js √© mais concisa que a do Gatsby (talvez o fato seja que o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js seja</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menor que o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Eu realmente gosto do tutorial gamificado do Next.js. </font><font style="vertical-align: inherit;">Mas a documenta√ß√£o mais extensa do Gatsby √© mais valiosa com o desenvolvimento real do PWA, embora √† primeira vista pare√ßa enorme.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/010/138/800/0101388008c84ce2dda5f6f8f522cf6d.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documenta√ß√£o do Gatsby √â</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
verdade, n√£o consigo ficar calado sobre os pontos fortes do Next.js.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gra√ßas ao tutorial e √† documenta√ß√£o concisa do Next.js, parece que essa estrutura pode ser aprendida mais rapidamente que o Gatsby.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O sistema de carregamento de dados usado no Next.js √© baseado em fun√ß√µes ass√≠ncronas e na API de busca. </font><font style="vertical-align: inherit;">Como resultado, ao desenvolver o Next.js., o desenvolvedor n√£o tem a sensa√ß√£o de que precisa aprender o GraphQL para aproveitar ao m√°ximo os recursos da estrutura.</font></font></li>
<li> Next.js    TypeScript,      Gatsby        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   </a> (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>).     Next.js      ,     ,        ,        .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Devido ao fato de o Next.js ter aprimorado o suporte ao SSG, essa estrutura se tornou uma ferramenta poderosa que permite, no n√≠vel de cada p√°gina individual, escolher o m√©todo de trabalhar com ela. </font><font style="vertical-align: inherit;">Pode ser SSR, SSG ou CSR. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, se eu pudesse gerar esse aplicativo de uma forma completamente est√°tica, o Next.js me serviria melhor, pois eu poderia usar a API-Algolia JS padr√£o e manter o c√≥digo para carregar dados </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no mesmo arquivo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que e c√≥digo do componente. </font><font style="vertical-align: inherit;">Como o Algolia n√£o possui uma API GraphQL integrada e n√£o h√° um plug-in do Gatsby para o Algolia, a implementa√ß√£o de um mecanismo desse tipo no Gatsby exigiria a adi√ß√£o desse c√≥digo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a um novo arquivo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">E isso vai contra a maneira declarativa intuitiva de descrever as p√°ginas.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre maneiras adicionais de melhorar o desempenho do projeto</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de resolvermos o problema de escolher uma estrutura, note-se que existem maneiras adicionais de melhorar o desempenho do projeto que n√£o est√£o relacionadas √† estrutura. </font><font style="vertical-align: inherit;">Essas melhorias podem elevar a classifica√ß√£o do projeto Lighthouse para 100.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista de discuss√£o de mar√ßo da</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algolia </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> foi recomendado adicionar uma dica </font></font><code>preconnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para aumentar ainda mais a velocidade da execu√ß√£o da consulta. </font><font style="vertical-align: inherit;">(√â verdade, infelizmente, o fragmento de c√≥digo errado √© fornecido no boletim. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c√≥digo correto.)</font></font></li>
<li>    .   JS-  CSS-,  webpack- Gatsby.   Gatsby  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>   .  ,       ,   Netlify  Amazon S3. ,  Firebase Hosting,  ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usamos imagens JPEG e PNG carregadas por criadores de inicializa√ß√£o no aplicativo. </font><font style="vertical-align: inherit;">N√≥s n√£o os compactamos e otimizamos. </font><font style="vertical-align: inherit;">Melhorar esse aspecto de nosso aplicativo √© um grande desafio e est√° al√©m do escopo deste projeto. </font><font style="vertical-align: inherit;">Al√©m disso, seria √≥timo se todas essas imagens fossem convertidas para o formato WebP. </font><font style="vertical-align: inherit;">Como resultado, ter√≠amos que armazenar imagens usando apenas um formato gr√°fico altamente eficiente. </font><font style="vertical-align: inherit;">Infelizmente, como em muitos outros recursos do PWA, a equipe de desenvolvimento do Safari WebKit √© viciante com o suporte ao WebP. </font><font style="vertical-align: inherit;">Agora √© o √∫nico navegador principal que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o suporta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> esse formato.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se resumirmos brevemente o que est√°vamos falando aqui, podemos dizer o seguinte:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A sa√≠da da vers√£o "esquel√©tica" da p√°gina durante o carregamento de dados pelo cliente cria ao usu√°rio uma sensa√ß√£o de opera√ß√£o mais r√°pida do site do que quando o usu√°rio visualiza uma p√°gina em branco enquanto o servidor est√° carregando dados.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A vers√£o gatsby do site era apenas um pouco mais r√°pida que a vers√£o Next.js. </font><font style="vertical-align: inherit;">No entanto, o sistema de plug-in Gatsby e a documenta√ß√£o do projeto de alta qualidade aumentam a usabilidade dessa estrutura para o desenvolvedor.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Queridos leitores! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ usa geradores de sites est√°ticos ou sistemas de renderiza√ß√£o no lado do servidor para acelerar seus projetos?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt500216/index.html">Esque√ßa o antropoceno: entramos na era sint√©tica</a></li>
<li><a href="../pt500218/index.html">Modelo epidemiol√≥gico Covid-19</a></li>
<li><a href="../pt500220/index.html">Discos de vinil e cassetes diretamente no seu Android</a></li>
<li><a href="../pt500222/index.html">Telefones sem fio da British WWI Biplanes</a></li>
<li><a href="../pt500224/index.html">Nariz eletr√¥nico DIY</a></li>
<li><a href="../pt500232/index.html">Aprendendo Akka.NET: Servidor de um jogo online simples</a></li>
<li><a href="../pt500234/index.html">Por que fiz um projeto de contabilidade de despesas pessoais para o Git + JS</a></li>
<li><a href="../pt500238/index.html">Diga-me o que est√° incomodando voc√™</a></li>
<li><a href="../pt500244/index.html">Fora da matriz</a></li>
<li><a href="../pt500246/index.html">Protegendo e invadindo o Xbox 360 (parte 3)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>