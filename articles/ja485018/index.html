<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🚒 🚩 ❇️ Unity LWRPでコードを使用してシェーダーを作成する 🈹 🙅🏼 🚓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前書き
 こんにちは、ハブル。本日は、スクリプト可能なレンダリングパイプライン（SRP）パイプラインの例の1つであるライトウェイトレンダリングパイプライン（LWRP）を使用して、Unityでクラシックテキストシェーダーを（ほとんど）すばやく簡単に書き始める方法について少しお話します。
 
 しかし、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Unity LWRPでコードを使用してシェーダーを作成する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485018/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
こんにちは、ハブル。</font><font style="vertical-align: inherit;">本日</font><font style="vertical-align: inherit;">は、</font><b><font style="vertical-align: inherit;">スクリプト可能なレンダリングパイプライン（SRP）</font></b><font style="vertical-align: inherit;">パイプ</font><b><font style="vertical-align: inherit;">ラインの</font></b><font style="vertical-align: inherit;">例の1つである</font><b><font style="vertical-align: inherit;">ライトウェイトレンダリングパイプライン（LWRP）</font></b><font style="vertical-align: inherit;">を使用して、Unityで</font><font style="vertical-align: inherit;">クラシック</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テキスト</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーを</font><font style="vertical-align: inherit;">（ほとんど）すばやく簡単に書き始める方法について少しお話します</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、シェーダーグラフはどうですか？</font></font></h4><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shader Graph</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、シンプルなエフェクトのプロトタイピングまたは作成に便利で迅速なツールです。</font><font style="vertical-align: inherit;">ただし、場合によっては、複雑で複雑なものを作成する必要があり、その後、ノード、カスタム関数、サブグラフの数が信じられないほど増加します。そのため、最も熟練したグラフィックプログラマでさえ、この混乱全体に混乱し始めます。</font><font style="vertical-align: inherit;">先験的に自動生成されたコードは手動で書くよりも優れているわけではないことは誰もが理解しています。ノードのレイアウトに誤りがあると、頂点シェーダーの既知の計算結果がフラグメントで繰り返しカウントされるという事実につながる可能性があるためです。</font><font style="vertical-align: inherit;">ノードを使うよりも、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扱うほうが快適な人がいます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">理由は異なるかもしれませんが、本質は同じです-ノードについては、コードを長持ちさせます！</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/b24/96d/bc6/b2496dbc64e311b3f6e51a4edfc87078.png" alt="2020-01-19-17-07-35"></a><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、座ってLWRPで通常のテキストシェーダーを作成することの問題は何ですか？</font><font style="vertical-align: inherit;">そして問題は</font><font style="vertical-align: inherit;">、LWRPでは</font><font style="vertical-align: inherit;">誰もが好む</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">標準サーフェス</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーがサポートされていないことです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それを使用しようとすると、次のようになります。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/c7d/f7a/a25/c7df7aa255f2fa81a2a95ef88ef249e2.png" alt="2020-01-19-17-16-16"></a> <br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーコード</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">Shader <span class="hljs-string">"Custom/NewSurfaceShader"</span><font></font>
{<font></font>
    Properties<font></font>
    {<font></font>
        _Color (<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<font></font>
        _MainTex (<span class="hljs-string">"Albedo (RGB)"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
        _Glossiness (<span class="hljs-string">"Smoothness"</span>, Range(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)) = <span class="hljs-number">0.5</span>
        _Metallic (<span class="hljs-string">"Metallic"</span>, Range(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)) = <span class="hljs-number">0.0</span><font></font>
    }<font></font>
    SubShader<font></font>
    {<font></font>
        Tags { <span class="hljs-string">"RenderType"</span>=<span class="hljs-string">"Opaque"</span> }<font></font>
        LOD <span class="hljs-number">200</span><font></font>
<font></font>
        CGPROGRAM<font></font>
        <span class="hljs-comment">// Physically based Standard lighting model, and enable shadows on all light types</span><font></font>
        #pragma surface surf Standard fullforwardshadows<font></font>
<font></font>
        <span class="hljs-comment">// Use shader model 3.0 target, to get nicer looking lighting</span>
        #pragma target <span class="hljs-number">3.0</span><font></font>
<font></font>
        sampler2D _MainTex;<font></font>
<font></font>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Input</span>
        {</span><font></font>
            float2 uv_MainTex;<font></font>
        };<font></font>
<font></font>
        half _Glossiness;<font></font>
        half _Metallic;<font></font>
        fixed4 _Color;<font></font>
<font></font>
        <span class="hljs-comment">// Add instancing support for this shader. You need to check 'Enable Instancing' on materials that use the shader.</span>
        <span class="hljs-comment">// See https://docs.unity3d.com/Manual/GPUInstancing.html for more information about instancing.</span>
        <span class="hljs-comment">// #pragma instancing_options assumeuniformscaling</span><font></font>
        UNITY_INSTANCING_BUFFER_START(Props)<font></font>
            <span class="hljs-comment">// put more per-instance properties here</span><font></font>
        UNITY_INSTANCING_BUFFER_END(Props)<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">surf</span> <span class="hljs-params">(Input IN, inout SurfaceOutputStandard o)</span>
        </span>{
            <span class="hljs-comment">// Albedo comes from a texture tinted by color</span><font></font>
            fixed4 c = tex2D (_MainTex, IN.uv_MainTex) * _Color;<font></font>
            o.Albedo = c.rgb;<font></font>
            <span class="hljs-comment">// Metallic and smoothness come from slider variables</span><font></font>
            o.Metallic = _Metallic;<font></font>
            o.Smoothness = _Glossiness;<font></font>
            o.Alpha = c.a;<font></font>
        }<font></font>
        ENDCG<font></font>
    }<font></font>
    FallBack <span class="hljs-string">"Diffuse"</span>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、頂点とフラグメントの部分を持つ通常のanliteシェーダーを作成しようとすることが思い浮かびます。</font><font style="vertical-align: inherit;">そして幸いにも、すべてが機能します：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/8bf/559/bd1/8bf559bd19494ef9fd18364c2983b494.png" alt="2020-01-19-17-22-46"></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーコード</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">Shader <span class="hljs-string">"Unlit/NewUnlitShader"</span><font></font>
{<font></font>
    Properties<font></font>
    {<font></font>
        _MainTex (<span class="hljs-string">"Texture"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
    }<font></font>
    SubShader<font></font>
    {<font></font>
        Tags { <span class="hljs-string">"RenderType"</span>=<span class="hljs-string">"Opaque"</span> }<font></font>
        LOD <span class="hljs-number">100</span><font></font>
<font></font>
        Pass<font></font>
        {<font></font>
            CGPROGRAM<font></font>
            #pragma vertex vert<font></font>
            #pragma fragment frag<font></font>
            <span class="hljs-comment">// make fog work</span><font></font>
            #pragma multi_compile_fog<font></font>
<font></font>
            #include <span class="hljs-string">"UnityCG.cginc"</span><font></font>
<font></font>
            struct appdata<font></font>
            {<font></font>
                float4 vertex : POSITION;<font></font>
                float2 uv : TEXCOORD0;<font></font>
            };<font></font>
<font></font>
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">v2f</span>
            {</span><font></font>
                float2 uv : TEXCOORD0;<font></font>
                UNITY_FOG_COORDS(<span class="hljs-number">1</span>)<font></font>
                float4 vertex : SV_POSITION;<font></font>
            };<font></font>
<font></font>
            sampler2D _MainTex;<font></font>
            float4 _MainTex_ST;<font></font>
<font></font>
            <span class="hljs-function">v2f <span class="hljs-title">vert</span> <span class="hljs-params">(appdata v)</span>
            </span>{<font></font>
                v2f o;<font></font>
                o.vertex = UnityObjectToClipPos(v.vertex);<font></font>
                o.uv = TRANSFORM_TEX(v.uv, _MainTex);<font></font>
                UNITY_TRANSFER_FOG(o,o.vertex);<font></font>
                <span class="hljs-keyword">return</span> o;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-function">fixed4 <span class="hljs-title">frag</span> <span class="hljs-params">(v2f i)</span> : SV_Target
            </span>{
                <span class="hljs-comment">// sample the texture</span><font></font>
                fixed4 col = tex2D(_MainTex, i.uv);<font></font>
                <span class="hljs-comment">// apply fog</span><font></font>
                UNITY_APPLY_FOG(i.fogCoord, col);<font></font>
                <span class="hljs-keyword">return</span> col;<font></font>
            }<font></font>
            ENDCG<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、どうして悲しむことはできません。私たちは光、影、ライトマップ、そして愛する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PBR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なしでは、傍観者として裸の</font><font style="vertical-align: inherit;">ままでいるようでした。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、すべてを手で書くこともできます</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></i><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/46f/3b4/dc7/46f3b4dc795e2ad51508942405c3854f.png" alt="2020-01-19-17-55-56"></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーコード</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">Shader <span class="hljs-string">"TheProxor/Simple Lit"</span><font></font>
{<font></font>
    Properties<font></font>
    {<font></font>
        _MainTex(<span class="hljs-string">"Texture"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
    }<font></font>
<font></font>
    SubShader<font></font>
    {<font></font>
        Tags { <span class="hljs-string">"RenderType"</span> = <span class="hljs-string">"Opaque"</span> }<font></font>
        LOD <span class="hljs-number">100</span><font></font>
<font></font>
        Pass<font></font>
        {<font></font>
             CGPROGRAM<font></font>
            #pragma vertex vert<font></font>
            #pragma fragment frag<font></font>
            <span class="hljs-comment">// make fog work</span><font></font>
            #pragma multi_compile_fog<font></font>
<font></font>
            #include <span class="hljs-string">"UnityCG.cginc"</span> 
            #include <span class="hljs-string">"UnityLightingCommon.cginc"</span> <font></font>
<font></font>
            struct appdata<font></font>
            {<font></font>
                float4 vertex : POSITION;<font></font>
                float2 uv : TEXCOORD0;<font></font>
                float3 normal : NORMAL;<font></font>
            };<font></font>
<font></font>
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">v2f</span>
            {</span><font></font>
                float2 uv : TEXCOORD0;<font></font>
                UNITY_FOG_COORDS(<span class="hljs-number">1</span>)<font></font>
                float4 vertex : SV_POSITION;<font></font>
                fixed4 diffuse : COLOR0;<font></font>
            };<font></font>
<font></font>
            sampler2D _MainTex;<font></font>
            float4 _MainTex_ST;<font></font>
<font></font>
            <span class="hljs-function">v2f <span class="hljs-title">vert</span><span class="hljs-params">(appdata v)</span>
            </span>{<font></font>
                v2f o;<font></font>
                o.vertex = UnityObjectToClipPos(v.vertex);<font></font>
                o.uv = TRANSFORM_TEX(v.uv, _MainTex);<font></font>
                UNITY_TRANSFER_FOG(o,o.vertex);<font></font>
                half3 worldNormal = UnityObjectToWorldNormal(v.normal);<font></font>
                half nl = max(<span class="hljs-number">0</span>, dot(worldNormal, _WorldSpaceLightPos0.xyz));<font></font>
                o.diffuse = nl * _LightColor0;<font></font>
                <span class="hljs-keyword">return</span> o;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-function">fixed4 <span class="hljs-title">frag</span><span class="hljs-params">(v2f i)</span> : SV_Target
            </span>{
                <span class="hljs-comment">// sample the texture</span><font></font>
                fixed4 col = tex2D(_MainTex, i.uv);<font></font>
               <span class="hljs-comment">// apply fog</span><font></font>
               UNITY_APPLY_FOG(i.fogCoord, col);<font></font>
               col *= i.diffuse;<font></font>
               <span class="hljs-keyword">return</span> col;<font></font>
            }<font></font>
        ENDCG<font></font>
    }<font></font>
    }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが機能しているように見えますが、これは単なる拡散照明です。</font><font style="vertical-align: inherit;">次はどうする？</font><font style="vertical-align: inherit;">手ですべてを返却し続けることはできますが、長くて退屈であり、PBRは返却できず、すべてのLWRPチップが失われます。</font><font style="vertical-align: inherit;">したがって、1回のマジックストロークですべてを返すには、LWRPを選択するしかありません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ご存じのとおり、LWRPは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forward-rendererに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基づいて構築されています。つまり、LWRPには</font><font style="vertical-align: inherit;">独自のLitForwardPassがあり、どこかで説明する必要があります。</font><font style="vertical-align: inherit;">明らかに、どこかにこれがすべて記述されているCGIncludeがあります。</font><font style="vertical-align: inherit;">ここで私たちは楽しい冒険に出発しました：</font></font><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％localappdata％\ Unity \ cache \ packages \ packages.unity.com \ com.unity.render-pipelines.lightweight @（LWRP version）\</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、指定されたアドレスに</font><b><font style="vertical-align: inherit;">到達</font></b><font style="vertical-align: inherit;">し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shaders</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに移動</font><font style="vertical-align: inherit;">すると、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lit.shader</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれる興味深いシェーダーが1つ見つかります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">実際、私たちは検索が終わったと言えます。ここにあります-切望されたシェーダー。</font><font style="vertical-align: inherit;">中に入って-次のコンテンツを見つけます：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">点灯シェーダー</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">Shader <span class="hljs-string">"Lightweight Render Pipeline/Lit"</span><font></font>
{<font></font>
    Properties<font></font>
    {<font></font>
        <span class="hljs-comment">// Specular vs Metallic workflow</span>
        [HideInInspector] _WorkflowMode(<span class="hljs-string">"WorkflowMode"</span>, Float) = <span class="hljs-number">1.0</span><font></font>
        <font></font>
        [MainColor] _BaseColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">1</span>)<font></font>
        [MainTexture] _BaseMap(<span class="hljs-string">"Albedo"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
        _Cutoff(<span class="hljs-string">"Alpha Cutoff"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span><font></font>
<font></font>
        _Smoothness(<span class="hljs-string">"Smoothness"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span>
        _GlossMapScale(<span class="hljs-string">"Smoothness Scale"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">1.0</span>
        _SmoothnessTextureChannel(<span class="hljs-string">"Smoothness texture channel"</span>, Float) = <span class="hljs-number">0</span><font></font>
<font></font>
        [Gamma] _Metallic(<span class="hljs-string">"Metallic"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.0</span>
        _MetallicGlossMap(<span class="hljs-string">"Metallic"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
        _SpecColor(<span class="hljs-string">"Specular"</span>, Color) = (<span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>)<font></font>
        _SpecGlossMap(<span class="hljs-string">"Specular"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
        [ToggleOff] _SpecularHighlights(<span class="hljs-string">"Specular Highlights"</span>, Float) = <span class="hljs-number">1.0</span>
        [ToggleOff] _EnvironmentReflections(<span class="hljs-string">"Environment Reflections"</span>, Float) = <span class="hljs-number">1.0</span><font></font>
<font></font>
        _BumpScale(<span class="hljs-string">"Scale"</span>, Float) = <span class="hljs-number">1.0</span>
        _BumpMap(<span class="hljs-string">"Normal Map"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"bump"</span> {}<font></font>
<font></font>
        _OcclusionStrength(<span class="hljs-string">"Strength"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">1.0</span>
        _OcclusionMap(<span class="hljs-string">"Occlusion"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
        _EmissionColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<font></font>
        _EmissionMap(<span class="hljs-string">"Emission"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
        <span class="hljs-comment">// Blending state</span>
        [HideInInspector] _Surface(<span class="hljs-string">"__surface"</span>, Float) = <span class="hljs-number">0.0</span>
        [HideInInspector] _Blend(<span class="hljs-string">"__blend"</span>, Float) = <span class="hljs-number">0.0</span>
        [HideInInspector] _AlphaClip(<span class="hljs-string">"__clip"</span>, Float) = <span class="hljs-number">0.0</span>
        [HideInInspector] _SrcBlend(<span class="hljs-string">"__src"</span>, Float) = <span class="hljs-number">1.0</span>
        [HideInInspector] _DstBlend(<span class="hljs-string">"__dst"</span>, Float) = <span class="hljs-number">0.0</span>
        [HideInInspector] _ZWrite(<span class="hljs-string">"__zw"</span>, Float) = <span class="hljs-number">1.0</span>
        [HideInInspector] _Cull(<span class="hljs-string">"__cull"</span>, Float) = <span class="hljs-number">2.0</span><font></font>
<font></font>
        _ReceiveShadows(<span class="hljs-string">"Receive Shadows"</span>, Float) = <span class="hljs-number">1.0</span>        
        <span class="hljs-comment">// Editmode props</span>
        [HideInInspector] _QueueOffset(<span class="hljs-string">"Queue offset"</span>, Float) = <span class="hljs-number">0.0</span><font></font>
        <font></font>
        <span class="hljs-comment">// ObsoleteProperties</span>
        [HideInInspector] _MainTex(<span class="hljs-string">"BaseMap"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
        [HideInInspector] _Color(<span class="hljs-string">"Base Color"</span>, Color) = (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>)<font></font>
        [HideInInspector] _GlossMapScale(<span class="hljs-string">"Smoothness"</span>, Float) = <span class="hljs-number">0.0</span>
        [HideInInspector] _Glossiness(<span class="hljs-string">"Smoothness"</span>, Float) = <span class="hljs-number">0.0</span>
        [HideInInspector] _GlossyReflections(<span class="hljs-string">"EnvironmentReflections"</span>, Float) = <span class="hljs-number">0.0</span><font></font>
    }<font></font>
<font></font>
    SubShader<font></font>
    {<font></font>
        <span class="hljs-comment">// Lightweight Pipeline tag is required. If Lightweight render pipeline is not set in the graphics settings</span>
        <span class="hljs-comment">// this Subshader will fail. One can add a subshader below or fallback to Standard built-in to make this</span>
        <span class="hljs-comment">// material work with both Lightweight Render Pipeline and Builtin Unity Pipeline</span>
        Tags{<span class="hljs-string">"RenderType"</span> = <span class="hljs-string">"Opaque"</span> <span class="hljs-string">"RenderPipeline"</span> = <span class="hljs-string">"LightweightPipeline"</span> <span class="hljs-string">"IgnoreProjector"</span> = <span class="hljs-string">"True"</span>}<font></font>
        LOD <span class="hljs-number">300</span><font></font>
<font></font>
        <span class="hljs-comment">// ------------------------------------------------------------------</span>
        <span class="hljs-comment">//  Forward pass. Shades all light in a single pass. GI + emission + Fog</span><font></font>
        Pass<font></font>
        {<font></font>
            <span class="hljs-comment">// Lightmode matches the ShaderPassName set in LightweightRenderPipeline.cs. SRPDefaultUnlit and passes with</span>
            <span class="hljs-comment">// no LightMode tag are also rendered by Lightweight Render Pipeline</span>
            Name <span class="hljs-string">"ForwardLit"</span>
            Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"LightweightForward"</span>}<font></font>
<font></font>
            Blend[_SrcBlend][_DstBlend]<font></font>
            ZWrite[_ZWrite]<font></font>
            Cull[_Cull]<font></font>
<font></font>
            HLSLPROGRAM<font></font>
            <span class="hljs-comment">// Required to compile gles 2.0 with standard SRP library</span>
            <span class="hljs-comment">// All shaders must be compiled with HLSLcc and currently only gles is not using HLSLcc by default</span><font></font>
            #pragma prefer_hlslcc gles<font></font>
            #pragma exclude_renderers d3d11_9x<font></font>
            #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
            <span class="hljs-comment">// -------------------------------------</span>
            <span class="hljs-comment">// Material Keywords</span><font></font>
            #pragma shader_feature _NORMALMAP<font></font>
            #pragma shader_feature _ALPHATEST_ON<font></font>
            #pragma shader_feature _ALPHAPREMULTIPLY_ON<font></font>
            #pragma shader_feature _EMISSION<font></font>
            #pragma shader_feature _METALLICSPECGLOSSMAP<font></font>
            #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
            #pragma shader_feature _OCCLUSIONMAP<font></font>
<font></font>
            #pragma shader_feature _SPECULARHIGHLIGHTS_OFF<font></font>
            #pragma shader_feature _ENVIRONMENTREFLECTIONS_OFF<font></font>
            #pragma shader_feature _SPECULAR_SETUP<font></font>
            #pragma shader_feature _RECEIVE_SHADOWS_OFF<font></font>
<font></font>
            <span class="hljs-comment">// -------------------------------------</span>
            <span class="hljs-comment">// Lightweight Pipeline keywords</span><font></font>
            #pragma multi_compile _ _MAIN_LIGHT_SHADOWS<font></font>
            #pragma multi_compile _ _MAIN_LIGHT_SHADOWS_CASCADE<font></font>
            #pragma multi_compile _ _ADDITIONAL_LIGHTS_VERTEX _ADDITIONAL_LIGHTS<font></font>
            #pragma multi_compile _ _ADDITIONAL_LIGHT_SHADOWS<font></font>
            #pragma multi_compile _ _SHADOWS_SOFT<font></font>
            #pragma multi_compile _ _MIXED_LIGHTING_SUBTRACTIVE<font></font>
<font></font>
            <span class="hljs-comment">// -------------------------------------</span>
            <span class="hljs-comment">// Unity defined keywords</span><font></font>
            #pragma multi_compile _ DIRLIGHTMAP_COMBINED<font></font>
            #pragma multi_compile _ LIGHTMAP_ON<font></font>
            #pragma multi_compile_fog<font></font>
<font></font>
            <span class="hljs-comment">//--------------------------------------</span>
            <span class="hljs-comment">// GPU Instancing</span><font></font>
            #pragma multi_compile_instancing<font></font>
            <font></font>
            #pragma vertex LitPassVertex<font></font>
            #pragma fragment LitPassFragment<font></font>
<font></font>
            #include <span class="hljs-string">"LitInput.hlsl"</span>
            #include <span class="hljs-string">"LitForwardPass.hlsl"</span><font></font>
            ENDHLSL<font></font>
        }<font></font>
<font></font>
        Pass<font></font>
        {<font></font>
            Name <span class="hljs-string">"ShadowCaster"</span>
            Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"ShadowCaster"</span>}<font></font>
<font></font>
            ZWrite On<font></font>
            ZTest LEqual<font></font>
            Cull[_Cull]<font></font>
<font></font>
            HLSLPROGRAM<font></font>
            <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
            #pragma prefer_hlslcc gles<font></font>
            #pragma exclude_renderers d3d11_9x<font></font>
            #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
            <span class="hljs-comment">// -------------------------------------</span>
            <span class="hljs-comment">// Material Keywords</span><font></font>
            #pragma shader_feature _ALPHATEST_ON<font></font>
<font></font>
            <span class="hljs-comment">//--------------------------------------</span>
            <span class="hljs-comment">// GPU Instancing</span><font></font>
            #pragma multi_compile_instancing<font></font>
            #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
            #pragma vertex ShadowPassVertex<font></font>
            #pragma fragment ShadowPassFragment<font></font>
<font></font>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/ShadowCasterPass.hlsl"</span><font></font>
            ENDHLSL<font></font>
        }<font></font>
<font></font>
        Pass<font></font>
        {<font></font>
            Name <span class="hljs-string">"DepthOnly"</span>
            Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"DepthOnly"</span>}<font></font>
<font></font>
            ZWrite On<font></font>
            ColorMask <span class="hljs-number">0</span><font></font>
            Cull[_Cull]<font></font>
<font></font>
            HLSLPROGRAM<font></font>
            <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
            #pragma prefer_hlslcc gles<font></font>
            #pragma exclude_renderers d3d11_9x<font></font>
            #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
            #pragma vertex DepthOnlyVertex<font></font>
            #pragma fragment DepthOnlyFragment<font></font>
<font></font>
            <span class="hljs-comment">// -------------------------------------</span>
            <span class="hljs-comment">// Material Keywords</span><font></font>
            #pragma shader_feature _ALPHATEST_ON<font></font>
            #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
            <span class="hljs-comment">//--------------------------------------</span>
            <span class="hljs-comment">// GPU Instancing</span><font></font>
            #pragma multi_compile_instancing<font></font>
<font></font>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/DepthOnlyPass.hlsl"</span><font></font>
            ENDHLSL<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// This pass it not used during regular rendering, only for lightmap baking.</span><font></font>
        Pass<font></font>
        {<font></font>
            Name <span class="hljs-string">"Meta"</span>
            Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"Meta"</span>}<font></font>
<font></font>
            Cull Off<font></font>
<font></font>
            HLSLPROGRAM<font></font>
            <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
            #pragma prefer_hlslcc gles<font></font>
            #pragma exclude_renderers d3d11_9x<font></font>
<font></font>
            #pragma vertex LightweightVertexMeta<font></font>
            #pragma fragment LightweightFragmentMeta<font></font>
<font></font>
            #pragma shader_feature _SPECULAR_SETUP<font></font>
            #pragma shader_feature _EMISSION<font></font>
            #pragma shader_feature _METALLICSPECGLOSSMAP<font></font>
            #pragma shader_feature _ALPHATEST_ON<font></font>
            #pragma shader_feature _ _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
            #pragma shader_feature _SPECGLOSSMAP<font></font>
<font></font>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitMetaPass.hlsl"</span><font></font>
<font></font>
            ENDHLSL<font></font>
        }<font></font>
        Pass<font></font>
        {<font></font>
            Name <span class="hljs-string">"Lightweight2D"</span>
            Tags{ <span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"Lightweight2D"</span> }<font></font>
<font></font>
            Blend[_SrcBlend][_DstBlend]<font></font>
            ZWrite[_ZWrite]<font></font>
            Cull[_Cull]<font></font>
<font></font>
            HLSLPROGRAM<font></font>
            <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
            #pragma prefer_hlslcc gles<font></font>
            #pragma exclude_renderers d3d11_9x<font></font>
<font></font>
            #pragma vertex vert<font></font>
            #pragma fragment frag<font></font>
            #pragma shader_feature _ALPHATEST_ON<font></font>
            #pragma shader_feature _ALPHAPREMULTIPLY_ON<font></font>
<font></font>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
            #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/Utils/Lightweight2D.hlsl"</span><font></font>
            ENDHLSL<font></font>
        }<font></font>
<font></font>
<font></font>
    }<font></font>
    FallBack <span class="hljs-string">"Hidden/InternalErrorShader"</span>
    CustomEditor <span class="hljs-string">"UnityEditor.Rendering.LWRP.ShaderGUI.LitShader"</span><font></font>
}<font></font>
</code></pre><br>
</div></div> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
編集を容易にするためにそれを拡張し、include-sを削除するだけです。</font><font style="vertical-align: inherit;">まあ、あなた自身の方法で少し変更します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のようなものが得られます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/f1f/add/a94/f1fadda94d14fcd9cd518f99c7489ce8.png" alt="2020-01-19-18-28-13"></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終的なUberシェーダー</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">
Shader <span class="hljs-string">"TheProxor/LWRP/Dissolve + Vertex Offset"</span><font></font>
{<font></font>
            Properties<font></font>
            {<font></font>
                <span class="hljs-comment">// Specular vs Metallic workflow</span>
                [HideInInspector] _WorkflowMode(<span class="hljs-string">"WorkflowMode"</span>, Float) = <span class="hljs-number">1.0</span><font></font>
<font></font>
                [MainColor][HideInInspector] _BaseColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">1</span>)<font></font>
                [MainTexture][HideInInspector] _BaseMap(<span class="hljs-string">"Albedo"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HideInInspector]_Cutoff(<span class="hljs-string">"Alpha Cutoff"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span><font></font>
<font></font>
                [HideInInspector]_Smoothness(<span class="hljs-string">"Smoothness"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span>
                [HideInInspector]_GlossMapScale(<span class="hljs-string">"Smoothness Scale"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">1.0</span>
                [HideInInspector]_SmoothnessTextureChannel(<span class="hljs-string">"Smoothness texture channel"</span>, Float) = <span class="hljs-number">0</span><font></font>
<font></font>
                [Gamma][HideInInspector] _Metallic(<span class="hljs-string">"Metallic"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.0</span>
                [HideInInspector]_MetallicGlossMap(<span class="hljs-string">"Metallic"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HideInInspector]_SpecColor(<span class="hljs-string">"Specular"</span>, Color) = (<span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>)<font></font>
                [HideInInspector]_SpecGlossMap(<span class="hljs-string">"Specular"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HideInInspector][ToggleOff] _SpecularHighlights(<span class="hljs-string">"Specular Highlights"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector][ToggleOff] _EnvironmentReflections(<span class="hljs-string">"Environment Reflections"</span>, Float) = <span class="hljs-number">1.0</span><font></font>
<font></font>
                [HideInInspector]_BumpScale(<span class="hljs-string">"Scale"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector]_BumpMap(<span class="hljs-string">"Normal Map"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"bump"</span> {}<font></font>
<font></font>
                [HideInInspector]_OcclusionStrength(<span class="hljs-string">"Strength"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">1.0</span>
                [HideInInspector]_OcclusionMap(<span class="hljs-string">"Occlusion"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HDR][HideInInspector]_EmissionColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<font></font>
                [HideInInspector]_EmissionMap(<span class="hljs-string">"Emission"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                <span class="hljs-comment">// Blending state</span>
                [HideInInspector] _Surface(<span class="hljs-string">"__surface"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _Blend(<span class="hljs-string">"__blend"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _AlphaClip(<span class="hljs-string">"__clip"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _SrcBlend(<span class="hljs-string">"__src"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector] _DstBlend(<span class="hljs-string">"__dst"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _ZWrite(<span class="hljs-string">"__zw"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector] _Cull(<span class="hljs-string">"__cull"</span>, Float) = <span class="hljs-number">2.0</span><font></font>
<font></font>
                [HideInInspector]_ReceiveShadows(<span class="hljs-string">"Receive Shadows"</span>, Float) = <span class="hljs-number">1.0</span>
                <span class="hljs-comment">// Editmode props</span>
                [HideInInspector] _QueueOffset(<span class="hljs-string">"Queue offset"</span>, Float) = <span class="hljs-number">0.0</span><font></font>
<font></font>
                <span class="hljs-comment">// ObsoleteProperties</span>
                [HideInInspector] _MainTex(<span class="hljs-string">"BaseMap"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
                [HideInInspector] _Color(<span class="hljs-string">"Base Color"</span>, Color) = (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>)<font></font>
                [HideInInspector] _GlossMapScale(<span class="hljs-string">"Smoothness"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _Glossiness(<span class="hljs-string">"Smoothness"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _GlossyReflections(<span class="hljs-string">"EnvironmentReflections"</span>, Float) = <span class="hljs-number">0.0</span><font></font>
<font></font>
                <font></font>
<font></font>
                <span class="hljs-comment">//   </span>
                _DissolveMap(<span class="hljs-string">"Dissolve Map"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
                _DissolveFactor(<span class="hljs-string">"Dissolve Factor"</span>, Range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) = <span class="hljs-number">0.0</span>
                _DissolveWidth(<span class="hljs-string">"Dissolve Width"</span>, Range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) = <span class="hljs-number">0.0</span>
                [HDR]_DissolveColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<font></font>
            }<font></font>
<font></font>
            SubShader<font></font>
            {<font></font>
                <span class="hljs-comment">// Lightweight Pipeline tag is required. If Lightweight render pipeline is not set in the graphics settings</span>
                <span class="hljs-comment">// this Subshader will fail. One can add a subshader below or fallback to Standard built-in to make this</span>
                <span class="hljs-comment">// material work with both Lightweight Render Pipeline and Builtin Unity Pipeline</span>
                Tags{<span class="hljs-string">"RenderType"</span> = <span class="hljs-string">"Opaque"</span> <span class="hljs-string">"RenderPipeline"</span> = <span class="hljs-string">"LightweightPipeline"</span> <span class="hljs-string">"IgnoreProjector"</span> = <span class="hljs-string">"True"</span>}<font></font>
                LOD <span class="hljs-number">300</span><font></font>
<font></font>
                <span class="hljs-comment">// ------------------------------------------------------------------</span>
                <span class="hljs-comment">//  Forward pass. Shades all light in a single pass. GI + emission + Fog</span><font></font>
                Pass<font></font>
                {<font></font>
                <span class="hljs-comment">// Lightmode matches the ShaderPassName set in LightweightRenderPipeline.cs. SRPDefaultUnlit and passes with</span>
                <span class="hljs-comment">// no LightMode tag are also rendered by Lightweight Render Pipeline</span>
                Name <span class="hljs-string">"ForwardLit"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"LightweightForward"</span>}<font></font>
<font></font>
                Blend[_SrcBlend][_DstBlend]<font></font>
                ZWrite[_ZWrite]<font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard SRP library</span>
                <span class="hljs-comment">// All shaders must be compiled with HLSLcc and currently only gles is not using HLSLcc by default</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
                #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Material Keywords</span><font></font>
                #pragma shader_feature _NORMALMAP<font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _ALPHAPREMULTIPLY_ON<font></font>
                #pragma shader_feature _EMISSION<font></font>
                #pragma shader_feature _METALLICSPECGLOSSMAP<font></font>
                #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
                #pragma shader_feature _OCCLUSIONMAP<font></font>
<font></font>
                #pragma shader_feature _SPECULARHIGHLIGHTS_OFF<font></font>
                #pragma shader_feature _ENVIRONMENTREFLECTIONS_OFF<font></font>
                #pragma shader_feature _SPECULAR_SETUP<font></font>
                #pragma shader_feature _RECEIVE_SHADOWS_OFF<font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Lightweight Pipeline keywords</span><font></font>
                #pragma multi_compile _ _MAIN_LIGHT_SHADOWS<font></font>
                #pragma multi_compile _ _MAIN_LIGHT_SHADOWS_CASCADE<font></font>
                #pragma multi_compile _ _ADDITIONAL_LIGHTS_VERTEX _ADDITIONAL_LIGHTS<font></font>
                #pragma multi_compile _ _ADDITIONAL_LIGHT_SHADOWS<font></font>
                #pragma multi_compile _ _SHADOWS_SOFT<font></font>
                #pragma multi_compile _ _MIXED_LIGHTING_SUBTRACTIVE<font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Unity defined keywords</span><font></font>
                #pragma multi_compile _ DIRLIGHTMAP_COMBINED<font></font>
                #pragma multi_compile _ LIGHTMAP_ON<font></font>
                #pragma multi_compile_fog<font></font>
<font></font>
                <span class="hljs-comment">//--------------------------------------</span>
                <span class="hljs-comment">// GPU Instancing</span><font></font>
                #pragma multi_compile_instancing<font></font>
<font></font>
                #pragma vertex LitPassVertex<font></font>
                #pragma fragment LitPassFragment<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Lighting.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Core.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.core/ShaderLibrary/CommonMaterial.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/SurfaceInput.hlsl"</span><font></font>
<font></font>
                #ifdef _SPECULAR_SETUP<font></font>
                    #define SAMPLE_METALLICSPECULAR(uv) SAMPLE_TEXTURE2D(_SpecGlossMap, sampler_SpecGlossMap, uv)<font></font>
                #<span class="hljs-keyword">else</span><font></font>
                    #define SAMPLE_METALLICSPECULAR(uv) SAMPLE_TEXTURE2D(_MetallicGlossMap, sampler_MetallicGlossMap, uv)<font></font>
                #endif<font></font>
<font></font>
<font></font>
<font></font>
                struct Attributes<font></font>
                {<font></font>
                    float4 positionOS   : POSITION;<font></font>
                    float3 normalOS     : NORMAL;<font></font>
                    float4 tangentOS    : TANGENT;<font></font>
                    float2 texcoord     : TEXCOORD0;<font></font>
                    float2 lightmapUV   : TEXCOORD1;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                };<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Varyings</span>
                {</span><font></font>
                    float2 uv                       : TEXCOORD0;<font></font>
                    DECLARE_LIGHTMAP_OR_SH(lightmapUV, vertexSH, <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _ADDITIONAL_LIGHTS</span><font></font>
                    float3 positionWS               : TEXCOORD2;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _NORMALMAP</span>
                    half4 normalWS                  : TEXCOORD3;    <span class="hljs-comment">// xyz: normal, w: viewDir.x</span>
                    half4 tangentWS                 : TEXCOORD4;    <span class="hljs-comment">// xyz: tangent, w: viewDir.y</span>
                    half4 bitangentWS                : TEXCOORD5;    <span class="hljs-comment">// xyz: bitangent, w: viewDir.z</span>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    half3 normalWS                  : TEXCOORD3;<font></font>
                    half3 viewDirWS                 : TEXCOORD4;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    half4 fogFactorAndVertexLight   : TEXCOORD6; <span class="hljs-comment">// x: fogFactor, yzw: vertex light</span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _MAIN_LIGHT_SHADOWS</span><font></font>
                    float4 shadowCoord              : TEXCOORD7;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    float4 positionCS               : SV_POSITION;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                    UNITY_VERTEX_OUTPUT_STEREO<font></font>
<font></font>
<font></font>
                    float3 uvDissolve			    : TEXCOORD8; <font></font>
                };<font></font>
<font></font>
<font></font>
                CBUFFER_START(UnityPerMaterial)<font></font>
                    float4 _BaseMap_ST;<font></font>
                    half4 _BaseColor;<font></font>
                    half4 _SpecColor;<font></font>
                    half4 _EmissionColor;<font></font>
                    half _Cutoff;<font></font>
                    half _Smoothness;<font></font>
                    half _Metallic;<font></font>
                    half _BumpScale;<font></font>
                    half _OcclusionStrength;<font></font>
                    float4 _DissolveMap_ST; <span class="hljs-comment">//    _DissolveMap</span>
                    <span class="hljs-keyword">float</span> _DissolveFactor;
                    <span class="hljs-keyword">float</span> _DissolveWidth;<font></font>
                    float4 _DissolveColor;<font></font>
                <span class="hljs-function">CBUFFER_END

                <span class="hljs-title">TEXTURE2D</span><span class="hljs-params">(_OcclusionMap)</span></span>;       SAMPLER(sampler_OcclusionMap);<font></font>
                TEXTURE2D(_MetallicGlossMap);   SAMPLER(sampler_MetallicGlossMap);<font></font>
                TEXTURE2D(_SpecGlossMap);       SAMPLER(sampler_SpecGlossMap);<font></font>
                TEXTURE2D(_DissolveMap);        SAMPLER(sampler_DissolveMap);<font></font>
<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">SampleMetallicSpecGloss</span><span class="hljs-params">(float2 uv, half albedoAlpha)</span>
                </span>{<font></font>
                    half4 specGloss;<font></font>
<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _METALLICSPECGLOSSMAP</span><font></font>
                    specGloss = SAMPLE_METALLICSPECULAR(uv);<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A</span><font></font>
                    specGloss.a = albedoAlpha * _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    specGloss.a *= _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span> <span class="hljs-comment">// _METALLICSPECGLOSSMAP</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> _SPECULAR_SETUP</span><font></font>
                    specGloss.rgb = _SpecColor.rgb;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    specGloss.rgb = _Metallic.rrr;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A</span><font></font>
                    specGloss.a = albedoAlpha * _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    specGloss.a = _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    <span class="hljs-keyword">return</span> specGloss;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half <span class="hljs-title">SampleOcclusion</span><span class="hljs-params">(float2 uv)</span>
                </span>{
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _OCCLUSIONMAP</span>
                    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Controls things like these by exposing SHADER_QUALITY levels (low, medium, high)</span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(SHADER_API_GLES)</span>
                    <span class="hljs-keyword">return</span> SAMPLE_TEXTURE2D(_OcclusionMap, sampler_OcclusionMap, uv).g;
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    half occ = SAMPLE_TEXTURE2D(_OcclusionMap, sampler_OcclusionMap, uv).g;<font></font>
                    <span class="hljs-keyword">return</span> LerpWhiteTo(occ, _OcclusionStrength);
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
                    <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span>;
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">InitializeStandardLitSurfaceData</span><span class="hljs-params">(float2 uv, out SurfaceData outSurfaceData)</span>
                </span>{<font></font>
                    half4 albedoAlpha = SAMPLE_TEXTURE2D(_BaseMap, sampler_BaseMap, uv);<font></font>
                   <span class="hljs-comment">// half4 albedoAlpha = SampleAlbedoAlpha(uv, TEXTURE2D_ARGS(_BaseMap, sampler_BaseMap));</span><font></font>
                    outSurfaceData.alpha = Alpha(albedoAlpha.a, _BaseColor, _Cutoff);<font></font>
<font></font>
                    half4 specGloss = SampleMetallicSpecGloss(uv, albedoAlpha.a);<font></font>
                    outSurfaceData.albedo = albedoAlpha.rgb * _BaseColor.rgb;<font></font>
<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> _SPECULAR_SETUP</span>
                    outSurfaceData.metallic = <span class="hljs-number">1.0</span>h;<font></font>
                    outSurfaceData.specular = specGloss.rgb;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    outSurfaceData.metallic = specGloss.r;<font></font>
                    outSurfaceData.specular = half3(<span class="hljs-number">0.0</span>h, <span class="hljs-number">0.0</span>h, <span class="hljs-number">0.0</span>h);
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    outSurfaceData.smoothness = specGloss.a;<font></font>
                    outSurfaceData.normalTS = SampleNormal(uv, TEXTURE2D_ARGS(_BumpMap, sampler_BumpMap), _BumpScale);<font></font>
                    outSurfaceData.occlusion = SampleOcclusion(uv);<font></font>
                    outSurfaceData.emission = SampleEmission(uv, _EmissionColor.rgb, TEXTURE2D_ARGS(_EmissionMap, sampler_EmissionMap));<font></font>
                   <span class="hljs-comment">// outSurfaceData.emission = _EmissionColor.rgb * SAMPLE_TEXTURE2D(_EmissionMap, sampler_EmissionMap, uv);</span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitializeInputData</span><span class="hljs-params">(Varyings input, half3 normalTS, out InputData inputData)</span>
                </span>{<font></font>
                    inputData = (InputData)<span class="hljs-number">0</span>;<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _ADDITIONAL_LIGHTS</span><font></font>
                    inputData.positionWS = input.positionWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _NORMALMAP</span><font></font>
                    half3 viewDirWS = half3(input.normalWS.w, input.tangentWS.w, input.bitangentWS.w);<font></font>
                    inputData.normalWS = TransformTangentToWorld(normalTS,<font></font>
                        half3x3(input.tangentWS.xyz, input.bitangentWS.xyz, input.normalWS.xyz));<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    half3 viewDirWS = input.viewDirWS;<font></font>
                    inputData.normalWS = input.normalWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    inputData.normalWS = NormalizeNormalPerPixel(inputData.normalWS);<font></font>
                    viewDirWS = SafeNormalize(viewDirWS);<font></font>
<font></font>
                    inputData.viewDirectionWS = viewDirWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(_MAIN_LIGHT_SHADOWS) &amp;&amp; !defined(_RECEIVE_SHADOWS_OFF)</span><font></font>
                    inputData.shadowCoord = input.shadowCoord;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
                    inputData.shadowCoord = float4(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
                    inputData.fogCoord = input.fogFactorAndVertexLight.x;<font></font>
                    inputData.vertexLighting = input.fogFactorAndVertexLight.yzw;<font></font>
                    inputData.bakedGI = SAMPLE_GI(input.lightmapUV, input.vertexSH, inputData.normalWS);<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">///////////////////////////////////////////////////////////////////////////////</span>
                <span class="hljs-comment">//                  Vertex and Fragment functions                            //</span>
                <span class="hljs-comment">///////////////////////////////////////////////////////////////////////////////</span><font></font>
<font></font>
                <span class="hljs-comment">//Standard (Physically Based) shader</span>
                <span class="hljs-function">Varyings <span class="hljs-title">LitPassVertex</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    Varyings output = (Varyings)<span class="hljs-number">0</span>;<font></font>
<font></font>
<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    UNITY_TRANSFER_INSTANCE_ID(input, output);<font></font>
                    UNITY_INITIALIZE_VERTEX_OUTPUT_STEREO(output);<font></font>
<font></font>
<font></font>
                    input.positionOS.xyz += normalize(input.positionOS.xyz) * <span class="hljs-built_in">sin</span>(input.positionOS.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
<font></font>
                    VertexPositionInputs vertexInput = GetVertexPositionInputs(input.positionOS.xyz);<font></font>
                    VertexNormalInputs normalInput = GetVertexNormalInputs(input.normalOS, input.tangentOS);<font></font>
                    half3 viewDirWS = GetCameraPositionWS() - vertexInput.positionWS;<font></font>
                    half3 vertexLight = VertexLighting(vertexInput.positionWS, normalInput.normalWS);<font></font>
                    half fogFactor = ComputeFogFactor(vertexInput.positionCS.z);<font></font>
<font></font>
                    output.uv = TRANSFORM_TEX(input.texcoord, _BaseMap);<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _NORMALMAP</span><font></font>
                    output.normalWS = half4(normalInput.normalWS, viewDirWS.x);<font></font>
                    output.tangentWS = half4(normalInput.tangentWS, viewDirWS.y);<font></font>
                    output.bitangentWS = half4(normalInput.bitangentWS, viewDirWS.z);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    output.normalWS = NormalizeNormalPerVertex(normalInput.normalWS);<font></font>
                    output.viewDirWS = viewDirWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    OUTPUT_LIGHTMAP_UV(input.lightmapUV, unity_LightmapST, output.lightmapUV);<font></font>
                    OUTPUT_SH(output.normalWS.xyz, output.vertexSH);<font></font>
<font></font>
                    output.fogFactorAndVertexLight = half4(fogFactor, vertexLight);<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _ADDITIONAL_LIGHTS</span><font></font>
                    output.positionWS = vertexInput.positionWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(_MAIN_LIGHT_SHADOWS) &amp;&amp; !defined(_RECEIVE_SHADOWS_OFF)</span><font></font>
                    output.shadowCoord = GetShadowCoord(vertexInput);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    output.positionCS = vertexInput.positionCS;<font></font>
<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">// Used in Standard (Physically Based) shader</span>
                <span class="hljs-function">half4 <span class="hljs-title">LitPassFragment</span><span class="hljs-params">(Varyings input)</span> : SV_Target
                </span>{<font></font>
                    input.uv += _Time.x * <span class="hljs-number">10</span>;<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    UNITY_SETUP_STEREO_EYE_INDEX_POST_VERTEX(input);<font></font>
<font></font>
                    SurfaceData surfaceData;<font></font>
                    InitializeStandardLitSurfaceData(input.uv, surfaceData);<font></font>
<font></font>
                    InputData inputData;<font></font>
                    InitializeInputData(input, surfaceData.normalTS, inputData);<font></font>
                    <font></font>
                    float4 mask = SAMPLE_TEXTURE2D(_DissolveMap, sampler_DissolveMap, input.uv);<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> (mask.r &gt; _DissolveFactor)<font></font>
                        discard;<font></font>
<font></font>
                    <span class="hljs-keyword">bool</span> outline = mask.r &gt; _DissolveFactor - _DissolveWidth;<font></font>
                    surfaceData.emission *= outline * _DissolveColor;<font></font>
                    half4 color = LightweightFragmentPBR(inputData, surfaceData.albedo, surfaceData.metallic, surfaceData.specular, surfaceData.smoothness, surfaceData.occlusion, surfaceData.emission, surfaceData.alpha);<font></font>
                    color *= lerp(<span class="hljs-number">1</span>, _DissolveColor, outline);<font></font>
<font></font>
                    color.rgb = MixFog(color.rgb, inputData.fogCoord);<font></font>
                    <font></font>
                    <span class="hljs-keyword">return</span> color;<font></font>
                }<font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            <span class="hljs-comment">//</span><font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"ShadowCaster"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"ShadowCaster"</span>}<font></font>
<font></font>
                ZWrite On<font></font>
                ZTest LEqual<font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
                #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Material Keywords</span><font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
<font></font>
                <span class="hljs-comment">//--------------------------------------</span>
                <span class="hljs-comment">// GPU Instancing</span><font></font>
                #pragma multi_compile_instancing<font></font>
                #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
                #pragma vertex ShadowPassVertex<font></font>
                #pragma fragment ShadowPassFragment<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>             
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Core.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Shadows.hlsl"</span><font></font>
<font></font>
                float3 _LightDirection;<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Attributes</span>
                {</span><font></font>
                    float4 positionOS   : POSITION;<font></font>
                    float3 normalOS     : NORMAL;<font></font>
                    float2 texcoord     : TEXCOORD0;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                };<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Varyings</span>
                {</span><font></font>
                    float2 uv           : TEXCOORD0;<font></font>
                    float4 positionCS   : SV_POSITION;<font></font>
                };<font></font>
<font></font>
                CBUFFER_START(UnityPerMaterial)<font></font>
                    float4 _DissolveMap_ST; <span class="hljs-comment">//    _DissolveMap</span>
                    <span class="hljs-keyword">float</span> _DissolveFactor;
                <span class="hljs-function">CBUFFER_END

                <span class="hljs-title">TEXTURE2D</span><span class="hljs-params">(_DissolveMap)</span></span>;        SAMPLER(sampler_DissolveMap);<font></font>
<font></font>
                <span class="hljs-function">float4 <span class="hljs-title">GetShadowPositionHClip</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    float3 positionWS = TransformObjectToWorld(input.positionOS.xyz);<font></font>
                    float3 normalWS = TransformObjectToWorldNormal(input.normalOS);<font></font>
<font></font>
                    float4 positionCS = TransformWorldToHClip(ApplyShadowBias(positionWS, normalWS, _LightDirection));<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> UNITY_REVERSED_Z</span><font></font>
                    positionCS.z = min(positionCS.z, positionCS.w * UNITY_NEAR_CLIP_VALUE);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    positionCS.z = max(positionCS.z, positionCS.w * UNITY_NEAR_CLIP_VALUE);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    <span class="hljs-keyword">return</span> positionCS;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">Varyings <span class="hljs-title">ShadowPassVertex</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    Varyings output;<font></font>
                    input.positionOS.xyz += normalize(input.positionOS.xyz) * <span class="hljs-built_in">sin</span>(input.positionOS.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    output.uv = TRANSFORM_TEX(input.texcoord, _BaseMap);<font></font>
                    output.positionCS = GetShadowPositionHClip(input);<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">ShadowPassFragment</span><span class="hljs-params">(Varyings input)</span> : SV_TARGET
                </span>{<font></font>
                     float4 mask = SAMPLE_TEXTURE2D(_DissolveMap, sampler_DissolveMap, input.uv);<font></font>
<font></font>
                     <span class="hljs-keyword">if</span> (mask.r &gt; _DissolveFactor)<font></font>
                         discard;<font></font>
<font></font>
                    Alpha(SampleAlbedoAlpha(input.uv, TEXTURE2D_ARGS(_BaseMap, sampler_BaseMap)).a, _BaseColor, _Cutoff);<font></font>
                    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
<font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"DepthOnly"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"DepthOnly"</span>}<font></font>
<font></font>
                ZWrite On<font></font>
                ColorMask <span class="hljs-number">0</span><font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
                #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
                #pragma vertex DepthOnlyVertex<font></font>
                #pragma fragment DepthOnlyFragment<font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Material Keywords</span><font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
                <span class="hljs-comment">//--------------------------------------</span>
                <span class="hljs-comment">// GPU Instancing</span><font></font>
                #pragma multi_compile_instancing<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Core.hlsl"</span><font></font>
<font></font>
                #ifndef LIGHTWEIGHT_DEPTH_ONLY_PASS_INCLUDED<font></font>
                #define LIGHTWEIGHT_DEPTH_ONLY_PASS_INCLUDED<font></font>
<font></font>
                struct Attributes<font></font>
                {<font></font>
                    float4 position     : POSITION;<font></font>
                    float2 texcoord     : TEXCOORD0;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                };<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Varyings</span>
                {</span><font></font>
                    float2 uv           : TEXCOORD0;<font></font>
                    float4 positionCS   : SV_POSITION;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                    UNITY_VERTEX_OUTPUT_STEREO<font></font>
                };<font></font>
<font></font>
                <span class="hljs-function">Varyings <span class="hljs-title">DepthOnlyVertex</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    Varyings output = (Varyings)<span class="hljs-number">0</span>;<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    UNITY_INITIALIZE_VERTEX_OUTPUT_STEREO(output);<font></font>
<font></font>
                    input.position.xyz += normalize(input.position.xyz) * <span class="hljs-built_in">sin</span>(input.position.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
<font></font>
                    output.uv = TRANSFORM_TEX(input.texcoord, _BaseMap);<font></font>
                    output.positionCS = TransformObjectToHClip(input.position.xyz);<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">DepthOnlyFragment</span><span class="hljs-params">(Varyings input)</span> : SV_TARGET
                </span>{<font></font>
                    UNITY_SETUP_STEREO_EYE_INDEX_POST_VERTEX(input);<font></font>
<font></font>
                    Alpha(SampleAlbedoAlpha(input.uv, TEXTURE2D_ARGS(_BaseMap, sampler_BaseMap)).a, _BaseColor, _Cutoff);<font></font>
                    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            <span class="hljs-comment">//</span><font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"Meta"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"Meta"</span>}<font></font>
<font></font>
                Cull Off<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
<font></font>
                #pragma vertex LightweightVertexMeta<font></font>
                #pragma fragment LightweightFragmentMeta<font></font>
<font></font>
                #pragma shader_feature _SPECULAR_SETUP<font></font>
                #pragma shader_feature _EMISSION<font></font>
                #pragma shader_feature _METALLICSPECGLOSSMAP<font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _ _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
                #pragma shader_feature _SPECGLOSSMAP<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/MetaInput.hlsl"</span><font></font>
<font></font>
                #ifndef LIGHTWEIGHT_LIT_META_PASS_INCLUDED<font></font>
                #define LIGHTWEIGHT_LIT_META_PASS_INCLUDED<font></font>
<font></font>
<font></font>
<font></font>
                Varyings LightweightVertexMeta(Attributes input)<font></font>
                {<font></font>
                    Varyings output;<font></font>
                    output.positionCS = MetaVertexPosition(input.positionOS, input.uv1, input.uv2,<font></font>
                        unity_LightmapST, unity_DynamicLightmapST);<font></font>
                    output.uv = TRANSFORM_TEX(input.uv0, _BaseMap);<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">LightweightFragmentMeta</span><span class="hljs-params">(Varyings input)</span> : SV_Target
                </span>{<font></font>
                    SurfaceData surfaceData;<font></font>
                    InitializeStandardLitSurfaceData(input.uv, surfaceData);<font></font>
<font></font>
                    BRDFData brdfData;<font></font>
                    InitializeBRDFData(surfaceData.albedo, surfaceData.metallic, surfaceData.specular, surfaceData.smoothness, surfaceData.alpha, brdfData);<font></font>
<font></font>
                    MetaInput metaInput;<font></font>
                    metaInput.Albedo = brdfData.diffuse + brdfData.specular * brdfData.roughness * <span class="hljs-number">0.5</span>;<font></font>
                    metaInput.SpecularColor = surfaceData.specular;<font></font>
                    metaInput.Emission = surfaceData.emission;<font></font>
<font></font>
                    <span class="hljs-keyword">return</span> MetaFragment(metaInput);<font></font>
                }<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"Lightweight2D"</span>
                Tags{ <span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"Lightweight2D"</span> }<font></font>
<font></font>
                Blend[_SrcBlend][_DstBlend]<font></font>
                ZWrite[_ZWrite]<font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
<font></font>
                #pragma vertex vert<font></font>
                #pragma fragment frag<font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _ALPHAPREMULTIPLY_ON<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/Utils/Lightweight2D.hlsl"</span><font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
<font></font>
            }<font></font>
                FallBack <span class="hljs-string">"Hidden/InternalErrorShader"</span>
                CustomEditor <span class="hljs-string">"UnityEditor.Rendering.LWRP.ShaderGUI.LitShaderEditor"</span><font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず最初に、結果のシェーダーの内容を確認する必要があります。</font><font style="vertical-align: inherit;">まず、次の行に関心があります。</font></font><br>
<br>
<pre><code class="cpp hljs">CustomEditor <span class="hljs-string">"UnityEditor.Rendering.LWRP.ShaderGUI.LitShaderEditor"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが覚えているように、元のそれは次のとおりでした：</font></font><br>
<br>
<pre><code class="cpp hljs">CustomEditor <span class="hljs-string">"UnityEditor.Rendering.LWRP.ShaderGUI.LitShader"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは何ですか？なぜですか？</font><font style="vertical-align: inherit;">この質問への答えは非常に簡単です。よく見ると、シェーダーには非常に多くの種類の定義があり、奇妙なことに、アクティブ化と非アクティブ化が必要です。これは、しばらくの間、コードから実行する必要があるため、カスタムインスペクターが必要です。</font><font style="vertical-align: inherit;">さらに、カスタムインスペクターを使用すると、組み込みのプロパティだけでなく、シェーダーで必要になる可能性のあるプロパティも編集できます。</font><font style="vertical-align: inherit;">元のシェーダーにはすでにカスタムインスペクターが含まれているため、次のパスに沿ってそれを探すために自信を持って踏み込みます。</font></font><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％localappdata％\ Unity \ cache \ packages \ packages.unity.com \ com.unity.render-pipelines.lightweight@6.9.2 \ Editor \ ShaderGUI \ Shaders \</font></font></i></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 実際には、BaseShaderGUIから継承されたLitShader.csファイルに関心があります。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LitShader</span> : <span class="hljs-title">BaseShaderGUI</span><font></font>
{<font></font>
...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メインバッチはBaseShaderGUI.csで正確に実行されます。これは、1レベル上のフォルダーにあります。 </font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BaseShaderGUI</span> : <span class="hljs-title">ShaderGUI</span><font></font>
{<font></font>
...<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのスクリプトを取得して</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Editor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに入れます</font><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">スクリプト</font><font style="vertical-align: inherit;">がない場合は作成します。そうしないと、UnityEditor名前空間がビルドに含まれていないため、プロジェクトのビルド中にエラーが自然に発生します）。</font><font style="vertical-align: inherit;">もちろん、1000のエラー</font><font style="vertical-align: inherit;">は、エディターウィンドウでシリアル化可能なbool型の変数である</font><font style="vertical-align: inherit;">インターネット型</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SavedBoolに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関連する</font><font style="vertical-align: inherit;">ものです。</font><font style="vertical-align: inherit;">これは、材料の折り曲げ部分の状態を維持するために行われます。</font><font style="vertical-align: inherit;">実際、修正のために簡単な操作を行っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変化する：</font></font><br>
<br>
<pre><code class="cs hljs">SavedBool m_SurfaceOptionsFoldout;<font></font>
SavedBool m_SurfaceInputsFoldout;<font></font>
SavedBool m_AdvancedFoldout;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で：</font></font><br>
<br>
<pre><code class="cs hljs">AnimatedValues.AnimBool m_SurfaceOptionsFoldout;<font></font>
AnimatedValues.AnimBool m_SurfaceInputsFoldout;<font></font>
AnimatedValues.AnimBool m_AdvancedFoldout;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、カスタムプロパティを追加する別の変数を追加します。</font></font><br>
<br>
<pre><code class="cs hljs">AnimatedValues.AnimBool m_OtherFoldout;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、スクリプト内の確立された伝統に従って、セクションの名前と説明をカスタムパラメータとともに追加する必要があります。 </font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Styles</span><font></font>
{<font></font>
    <span class="hljs-comment">// Catergories      </span><font></font>
    ...<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent OtherOptions = 
    <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Your own options"</span>, <span class="hljs-string">"You own custom options"</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、ここで少しトリックをしましょう。</font><font style="vertical-align: inherit;">ご覧のとおり、すべての標準プロパティに対して</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HideInInspector</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性を設定しました。</font><b><font style="vertical-align: inherit;">この</font></b><font style="vertical-align: inherit;">属性は</font><font style="vertical-align: inherit;">、その名前から、このプロパティがインスペクタで非表示になることを直接示しています。</font><font style="vertical-align: inherit;">ただし、これは材料の標準検査官にのみ関連しますが、どれが該当しますか？</font><font style="vertical-align: inherit;">そうです、カスタム！</font><font style="vertical-align: inherit;">これは、すべての組み込みプロパティが何らかの方法でレンダリングされることを意味します。</font><font style="vertical-align: inherit;">それらを非表示にしましょう：</font></font><br>
<br>
<pre><code class="cpp hljs"><font></font>
...<font></font>
[MainColor][HideInInspector] _BaseColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">1</span>)<font></font>
[MainTexture][HideInInspector] _BaseMap(<span class="hljs-string">"Albedo"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
[HideInInspector]_Cutoff(<span class="hljs-string">"Alpha Cutoff"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span>
[HideInInspector]_Smoothness(<span class="hljs-string">"Smoothness"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span>
[HideInInspector]_GlossMapScale(<span class="hljs-string">"Smoothness Scale"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">1.0</span>
[HideInInspector]_SmoothnessTextureChannel(<span class="hljs-string">"Smoothness texture channel"</span>, Float) = <span class="hljs-number">0</span><font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、カスタムエディターのコード内では、標準インスペクターのレンダリングを呼び出すだけです。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGUI</span>(<span class="hljs-params">...</span>)</span><font></font>
{<font></font>
   ...<font></font>
   m_OtherFoldout.<span class="hljs-keyword">value</span> = EditorGUILayout.BeginFoldoutHeaderGroup(m_OtherFoldout.<span class="hljs-keyword">value</span>, Styles.OtherOptions);
   <span class="hljs-keyword">if</span> (m_OtherFoldout.<span class="hljs-keyword">value</span>)<font></font>
   {<font></font>
         <span class="hljs-keyword">base</span>.OnGUI(materialEditorIn, properties);<font></font>
         EditorGUILayout.Space();<font></font>
   }<font></font>
   EditorGUILayout.EndFoldoutHeaderGroup();            <font></font>
   ...<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果は明らかです。</font><font style="vertical-align: inherit;">
そして、両方のスクリプトのコードは次のとおりです。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/81e/d13/4b6/81ed134b69e689252cc2325dd59bc24b.png" alt="2020-01-19-22-58-23"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BaseShaderEditor.cs</font></font></b><div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.Rendering;
<span class="hljs-keyword">using</span> UnityEditor.Rendering;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">UnityEditor</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BaseShaderEditor</span> : <span class="hljs-title">ShaderGUI</span><font></font>
    {<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> EnumsAndClasses</span><font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> SurfaceType<font></font>
        {<font></font>
            Opaque,<font></font>
            Transparent<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> BlendMode<font></font>
        {<font></font>
            Alpha,   <span class="hljs-comment">// Old school alpha-blending mode, fresnel does not affect amount of transparency</span>
            Premultiply, <span class="hljs-comment">// Physically plausible transparency mode, implemented as alpha pre-multiply</span><font></font>
            Additive,<font></font>
            Multiply<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> SmoothnessSource<font></font>
        {<font></font>
            BaseAlpha,<font></font>
            SpecularAlpha<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> RenderFace<font></font>
        {<font></font>
            Front = <span class="hljs-number">2</span>,<font></font>
            Back = <span class="hljs-number">1</span>,<font></font>
            Both = <span class="hljs-number">0</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Styles</span><font></font>
        {<font></font>
            <span class="hljs-comment">// Catergories</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent SurfaceOptions =
                <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Surface Options"</span>, <span class="hljs-string">"Controls how LWRP renders the Material on a screen."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent SurfaceInputs = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Surface Inputs"</span>,
                <span class="hljs-string">"These settings describe the look and feel of the surface itself."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent AdvancedLabel = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Advanced"</span>,
                <span class="hljs-string">"These settings affect behind-the-scenes rendering and underlying calculations."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent surfaceType = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Surface Type"</span>,
                <span class="hljs-string">"Select a surface type for your texture. Choose between Opaque or Transparent."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent blendingMode = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Blending Mode"</span>,
                <span class="hljs-string">"Controls how the color of the Transparent surface blends with the Material color in the background."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent cullingText = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Render Face"</span>,
                <span class="hljs-string">"Specifies which faces to cull from your geometry. Front culls front faces. Back culls backfaces. None means that both sides are rendered."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent alphaClipText = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Alpha Clipping"</span>,
                <span class="hljs-string">"Makes your Material act like a Cutout shader. Use this to create a transparent effect with hard edges between opaque and transparent areas."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent alphaClipThresholdText = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Threshold"</span>,
                <span class="hljs-string">"Sets where the Alpha Clipping starts. The higher the value is, the brighter the  effect is when clipping starts."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent receiveShadowText = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Receive Shadows"</span>,
                <span class="hljs-string">"When enabled, other GameObjects can cast shadows onto this GameObject."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent baseMap = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Base Map"</span>,
                <span class="hljs-string">"Specifies the base Material and/or Color of the surface. If you’ve selected Transparent or Alpha Clipping under Surface Options, your Material uses the Texture’s alpha channel or color."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent emissionMap = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Emission Map"</span>,
                <span class="hljs-string">"Sets a Texture map to use for emission. You can also select a color with the color picker. Colors are multiplied over the Texture."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent normalMapText =
                <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Normal Map"</span>, <span class="hljs-string">"Assigns a tangent-space normal map."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent bumpScaleNotSupported =
                <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Bump scale is not supported on mobile platforms"</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent fixNormalNow = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Fix now"</span>,
                <span class="hljs-string">"Converts the assigned texture to be a normal map format."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent queueSlider = <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Priority"</span>,
                <span class="hljs-string">"Determines the chronological rendering order for a Material. High values are rendered first."</span>);<font></font>
<font></font>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> GUIContent OtherOptions =
                <span class="hljs-keyword">new</span> GUIContent(<span class="hljs-string">"Your own options"</span>, <span class="hljs-string">"You own custom options"</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> Variables</span><font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialEditor materialEditor { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty surfaceTypeProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty blendModeProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty cullingProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty alphaClipProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty alphaCutoffProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty receiveShadowsProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-comment">// Common Surface Input properties</span><font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty baseMapProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty baseColorProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty emissionMapProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty emissionColorProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">protected</span> MaterialProperty queueOffsetProp { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> m_FirstTimeApply = <span class="hljs-literal">true</span>;<font></font>
<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">string</span> k_KeyPrefix = <span class="hljs-string">"LightweightRP:Material:UI_State:"</span>;<font></font>
<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> m_HeaderStateKey = <span class="hljs-literal">null</span>;<font></font>
<font></font>
        <span class="hljs-comment">// Header foldout states</span><font></font>
<font></font>
        AnimatedValues.AnimBool m_SurfaceOptionsFoldout;<font></font>
<font></font>
        AnimatedValues.AnimBool m_SurfaceInputsFoldout;<font></font>
<font></font>
        AnimatedValues.AnimBool m_AdvancedFoldout;<font></font>
<font></font>
        AnimatedValues.AnimBool m_OtherFoldout;<font></font>
<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> queueOffsetRange = <span class="hljs-number">50</span>;
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-comment">// General Functions              //</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> GeneralFunctions</span><font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MaterialChanged</span>(<span class="hljs-params">Material material</span>)</span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FindProperties</span>(<span class="hljs-params">MaterialProperty[] properties</span>)</span><font></font>
        {<font></font>
            surfaceTypeProp = FindProperty(<span class="hljs-string">"_Surface"</span>, properties);<font></font>
            blendModeProp = FindProperty(<span class="hljs-string">"_Blend"</span>, properties);<font></font>
            cullingProp = FindProperty(<span class="hljs-string">"_Cull"</span>, properties);<font></font>
            alphaClipProp = FindProperty(<span class="hljs-string">"_AlphaClip"</span>, properties);<font></font>
            alphaCutoffProp = FindProperty(<span class="hljs-string">"_Cutoff"</span>, properties);<font></font>
            receiveShadowsProp = FindProperty(<span class="hljs-string">"_ReceiveShadows"</span>, properties, <span class="hljs-literal">false</span>);<font></font>
            baseMapProp = FindProperty(<span class="hljs-string">"_BaseMap"</span>, properties, <span class="hljs-literal">false</span>);<font></font>
            baseColorProp = FindProperty(<span class="hljs-string">"_BaseColor"</span>, properties, <span class="hljs-literal">false</span>);<font></font>
            emissionMapProp = FindProperty(<span class="hljs-string">"_EmissionMap"</span>, properties, <span class="hljs-literal">false</span>);<font></font>
            emissionColorProp = FindProperty(<span class="hljs-string">"_EmissionColor"</span>, properties, <span class="hljs-literal">false</span>);<font></font>
            queueOffsetProp = FindProperty(<span class="hljs-string">"_QueueOffset"</span>, properties, <span class="hljs-literal">false</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGUI</span>(<span class="hljs-params">MaterialEditor materialEditorIn, MaterialProperty[] properties</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (materialEditorIn == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"materialEditorIn"</span>);<font></font>
<font></font>
            FindProperties(properties); <span class="hljs-comment">// MaterialProperties can be animated so we do not cache them but fetch them every event to ensure animated values are updated correctly</span><font></font>
            materialEditor = materialEditorIn;<font></font>
            Material material = materialEditor.target <span class="hljs-keyword">as</span> Material;<font></font>
<font></font>
            <span class="hljs-comment">// Make sure that needed setup (ie keywords/renderqueue) are set up if we're switching some existing</span>
            <span class="hljs-comment">// material to a lightweight shader.</span>
            <span class="hljs-keyword">if</span> (m_FirstTimeApply)<font></font>
            {<font></font>
                OnOpenGUI(material, materialEditorIn);<font></font>
                m_FirstTimeApply = <span class="hljs-literal">false</span>;<font></font>
            }<font></font>
<font></font>
            ShaderPropertiesGUI(material);<font></font>
<font></font>
            m_OtherFoldout.<span class="hljs-keyword">value</span> = EditorGUILayout.BeginFoldoutHeaderGroup(m_OtherFoldout.<span class="hljs-keyword">value</span>, Styles.OtherOptions);
            <span class="hljs-keyword">if</span> (m_OtherFoldout.<span class="hljs-keyword">value</span>)<font></font>
            {<font></font>
                <span class="hljs-keyword">base</span>.OnGUI(materialEditorIn, properties);<font></font>
                EditorGUILayout.Space();<font></font>
            }<font></font>
            EditorGUILayout.EndFoldoutHeaderGroup();<font></font>
            <font></font>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> obj <span class="hljs-keyword">in</span> materialEditor.targets)<font></font>
                MaterialChanged((Material)obj);<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnOpenGUI</span>(<span class="hljs-params">Material material, MaterialEditor materialEditor</span>)</span><font></font>
        {<font></font>
            <span class="hljs-comment">// Foldout states</span>
            m_HeaderStateKey = k_KeyPrefix + material.shader.name; <span class="hljs-comment">// Create key string for editor prefs</span>
            m_SurfaceOptionsFoldout = <span class="hljs-keyword">new</span> AnimatedValues.AnimBool(<span class="hljs-literal">true</span>);<font></font>
            m_SurfaceInputsFoldout = <span class="hljs-keyword">new</span> AnimatedValues.AnimBool(<span class="hljs-literal">true</span>);<font></font>
            m_AdvancedFoldout = <span class="hljs-keyword">new</span> AnimatedValues.AnimBool(<span class="hljs-literal">true</span>);<font></font>
            m_OtherFoldout = <span class="hljs-keyword">new</span> AnimatedValues.AnimBool(<span class="hljs-literal">true</span>);<font></font>
<font></font>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> obj <span class="hljs-keyword">in</span> materialEditor.targets)<font></font>
                MaterialChanged((Material)obj);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ShaderPropertiesGUI</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (material == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"material"</span>);<font></font>
<font></font>
            EditorGUI.BeginChangeCheck();<font></font>
<font></font>
            m_SurfaceOptionsFoldout.<span class="hljs-keyword">value</span> = EditorGUILayout.BeginFoldoutHeaderGroup(m_SurfaceOptionsFoldout.<span class="hljs-keyword">value</span>, Styles.SurfaceOptions);
            <span class="hljs-keyword">if</span> (m_SurfaceOptionsFoldout.<span class="hljs-keyword">value</span>)<font></font>
            {<font></font>
                DrawSurfaceOptions(material);<font></font>
                EditorGUILayout.Space();<font></font>
            }<font></font>
            EditorGUILayout.EndFoldoutHeaderGroup();<font></font>
<font></font>
            m_SurfaceInputsFoldout.<span class="hljs-keyword">value</span> = EditorGUILayout.BeginFoldoutHeaderGroup(m_SurfaceInputsFoldout.<span class="hljs-keyword">value</span>, Styles.SurfaceInputs);
            <span class="hljs-keyword">if</span> (m_SurfaceInputsFoldout.<span class="hljs-keyword">value</span>)<font></font>
            {<font></font>
                DrawSurfaceInputs(material);<font></font>
                EditorGUILayout.Space();<font></font>
            }<font></font>
            EditorGUILayout.EndFoldoutHeaderGroup();<font></font>
<font></font>
            m_AdvancedFoldout.<span class="hljs-keyword">value</span> = EditorGUILayout.BeginFoldoutHeaderGroup(m_AdvancedFoldout.<span class="hljs-keyword">value</span>, Styles.AdvancedLabel);
            <span class="hljs-keyword">if</span> (m_AdvancedFoldout.<span class="hljs-keyword">value</span>)<font></font>
            {<font></font>
                DrawAdvancedOptions(material);<font></font>
                EditorGUILayout.Space();<font></font>
            }<font></font>
            EditorGUILayout.EndFoldoutHeaderGroup();<font></font>
<font></font>
            DrawAdditionalFoldouts(material);<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
            {<font></font>
                <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> obj <span class="hljs-keyword">in</span> materialEditor.targets)<font></font>
                    MaterialChanged((Material)obj);<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-comment">// Drawing Functions              //</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> DrawingFunctions</span><font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawSurfaceOptions</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            DoPopup(Styles.surfaceType, surfaceTypeProp, Enum.GetNames(<span class="hljs-keyword">typeof</span>(SurfaceType)));
            <span class="hljs-keyword">if</span> ((SurfaceType)material.GetFloat(<span class="hljs-string">"_Surface"</span>) == SurfaceType.Transparent)<font></font>
                DoPopup(Styles.blendingMode, blendModeProp, Enum.GetNames(<span class="hljs-keyword">typeof</span>(BlendMode)));<font></font>
<font></font>
            EditorGUI.BeginChangeCheck();<font></font>
            EditorGUI.showMixedValue = cullingProp.hasMixedValue;<font></font>
            <span class="hljs-keyword">var</span> culling = (RenderFace)cullingProp.floatValue;<font></font>
            culling = (RenderFace)EditorGUILayout.EnumPopup(Styles.cullingText, culling);<font></font>
            <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
            {<font></font>
                materialEditor.RegisterPropertyChangeUndo(Styles.cullingText.text);<font></font>
                cullingProp.floatValue = (<span class="hljs-keyword">float</span>)culling;<font></font>
                material.doubleSidedGI = (RenderFace)cullingProp.floatValue != RenderFace.Front;<font></font>
            }<font></font>
<font></font>
            EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
<font></font>
            EditorGUI.BeginChangeCheck();<font></font>
            EditorGUI.showMixedValue = alphaClipProp.hasMixedValue;<font></font>
            <span class="hljs-keyword">var</span> alphaClipEnabled = EditorGUILayout.Toggle(Styles.alphaClipText, alphaClipProp.floatValue == <span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
                alphaClipProp.floatValue = alphaClipEnabled ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;<font></font>
            EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (alphaClipProp.floatValue == <span class="hljs-number">1</span>)<font></font>
                materialEditor.ShaderProperty(alphaCutoffProp, Styles.alphaClipThresholdText, <span class="hljs-number">1</span>);<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (receiveShadowsProp != <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                EditorGUI.BeginChangeCheck();<font></font>
                EditorGUI.showMixedValue = receiveShadowsProp.hasMixedValue;<font></font>
                <span class="hljs-keyword">var</span> receiveShadows =<font></font>
                    EditorGUILayout.Toggle(Styles.receiveShadowText, receiveShadowsProp.floatValue == <span class="hljs-number">1.0f</span>);
                <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
                    receiveShadowsProp.floatValue = receiveShadows ? <span class="hljs-number">1.0f</span> : <span class="hljs-number">0.0f</span>;<font></font>
                EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawSurfaceInputs</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            DrawBaseProperties(material);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawAdvancedOptions</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            materialEditor.EnableInstancingField();<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (queueOffsetProp != <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                EditorGUI.BeginChangeCheck();<font></font>
                EditorGUI.showMixedValue = queueOffsetProp.hasMixedValue;<font></font>
                <span class="hljs-keyword">var</span> queue = EditorGUILayout.IntSlider(Styles.queueSlider, (<span class="hljs-keyword">int</span>)queueOffsetProp.floatValue, -queueOffsetRange, queueOffsetRange);
                <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
                    queueOffsetProp.floatValue = queue;<font></font>
                EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawAdditionalFoldouts</span>(<span class="hljs-params">Material material</span>)</span> { }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawBaseProperties</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (baseMapProp != <span class="hljs-literal">null</span> &amp;&amp; baseColorProp != <span class="hljs-literal">null</span>) <span class="hljs-comment">// Draw the baseMap, most shader will have at least a baseMap</span><font></font>
            {<font></font>
                materialEditor.TexturePropertySingleLine(Styles.baseMap, baseMapProp, baseColorProp);<font></font>
                <span class="hljs-comment">// TODO Temporary fix for lightmapping, to be replaced with attribute tag.</span>
                <span class="hljs-keyword">if</span> (material.HasProperty(<span class="hljs-string">"_MainTex"</span>))<font></font>
                {<font></font>
                    material.SetTexture(<span class="hljs-string">"_MainTex"</span>, baseMapProp.textureValue);
                    <span class="hljs-keyword">var</span> baseMapTiling = baseMapProp.textureScaleAndOffset;<font></font>
                    material.SetTextureScale(<span class="hljs-string">"_MainTex"</span>, <span class="hljs-keyword">new</span> Vector2(baseMapTiling.x, baseMapTiling.y));<font></font>
                    material.SetTextureOffset(<span class="hljs-string">"_MainTex"</span>, <span class="hljs-keyword">new</span> Vector2(baseMapTiling.z, baseMapTiling.w));<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawEmissionProperties</span>(<span class="hljs-params">Material material, <span class="hljs-keyword">bool</span> keyword</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> emissive = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">var</span> hadEmissionTexture = emissionMapProp.textureValue != <span class="hljs-literal">null</span>;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (!keyword)<font></font>
            {<font></font>
                materialEditor.TexturePropertyWithHDRColor(Styles.emissionMap, emissionMapProp, emissionColorProp,<font></font>
                    <span class="hljs-literal">false</span>);<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                <span class="hljs-comment">// Emission for GI?</span><font></font>
                emissive = materialEditor.EmissionEnabledProperty();<font></font>
<font></font>
                EditorGUI.BeginDisabledGroup(!emissive);<font></font>
                {<font></font>
                    <span class="hljs-comment">// Texture and HDR color controls</span><font></font>
                    materialEditor.TexturePropertyWithHDRColor(Styles.emissionMap, emissionMapProp,<font></font>
                        emissionColorProp,<font></font>
                        <span class="hljs-literal">false</span>);<font></font>
                }<font></font>
                EditorGUI.EndDisabledGroup();<font></font>
            }<font></font>
<font></font>
            <span class="hljs-comment">// If texture was assigned and color was black set color to white</span>
            <span class="hljs-keyword">var</span> brightness = emissionColorProp.colorValue.maxColorComponent;
            <span class="hljs-keyword">if</span> (emissionMapProp.textureValue != <span class="hljs-literal">null</span> &amp;&amp; !hadEmissionTexture &amp;&amp; brightness &lt;= <span class="hljs-number">0f</span>)<font></font>
                emissionColorProp.colorValue = Color.white;<font></font>
<font></font>
            <span class="hljs-comment">// LW does not support RealtimeEmissive. We set it to bake emissive and handle the emissive is black right.</span>
            <span class="hljs-keyword">if</span> (emissive)<font></font>
            {<font></font>
                material.globalIlluminationFlags = MaterialGlobalIlluminationFlags.BakedEmissive;<font></font>
                <span class="hljs-keyword">if</span> (brightness &lt;= <span class="hljs-number">0f</span>)<font></font>
                    material.globalIlluminationFlags |= MaterialGlobalIlluminationFlags.EmissiveIsBlack;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawNormalArea</span>(<span class="hljs-params">MaterialEditor materialEditor, MaterialProperty bumpMap, MaterialProperty bumpMapScale = <span class="hljs-literal">null</span></span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (bumpMapScale != <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                materialEditor.TexturePropertySingleLine(Styles.normalMapText, bumpMap,<font></font>
                    bumpMap.textureValue != <span class="hljs-literal">null</span> ? bumpMapScale : <span class="hljs-literal">null</span>);
                <span class="hljs-keyword">if</span> (bumpMapScale.floatValue != <span class="hljs-number">1</span> &amp;&amp;<font></font>
                    UnityEditorInternal.InternalEditorUtility.IsMobilePlatform(<font></font>
                        EditorUserBuildSettings.activeBuildTarget))<font></font>
                    <span class="hljs-keyword">if</span> (materialEditor.HelpBoxWithButton(Styles.bumpScaleNotSupported, Styles.fixNormalNow))<font></font>
                        bumpMapScale.floatValue = <span class="hljs-number">1</span>;<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                materialEditor.TexturePropertySingleLine(Styles.normalMapText, bumpMap);<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawTileOffset</span>(<span class="hljs-params">MaterialEditor materialEditor, MaterialProperty textureProp</span>)</span><font></font>
        {<font></font>
            materialEditor.TextureScaleOffsetProperty(textureProp);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-comment">// Material Data Functions        //</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> MaterialDataFunctions</span><font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetMaterialKeywords</span>(<span class="hljs-params">Material material, Action&lt;Material&gt; shadingModelFunc = <span class="hljs-literal">null</span>, Action&lt;Material&gt; shaderFunc = <span class="hljs-literal">null</span></span>)</span><font></font>
        {<font></font>
            <span class="hljs-comment">// Clear all keywords for fresh start</span>
            material.shaderKeywords = <span class="hljs-literal">null</span>;
            <span class="hljs-comment">// Setup blending - consistent across all LWRP shaders</span><font></font>
            SetupMaterialBlendMode(material);<font></font>
            <span class="hljs-comment">// Receive Shadows</span>
            <span class="hljs-keyword">if</span> (material.HasProperty(<span class="hljs-string">"_ReceiveShadows"</span>))<font></font>
                CoreUtils.SetKeyword(material, <span class="hljs-string">"_RECEIVE_SHADOWS_OFF"</span>, material.GetFloat(<span class="hljs-string">"_ReceiveShadows"</span>) == <span class="hljs-number">0.0f</span>);
            <span class="hljs-comment">// Emission</span>
            <span class="hljs-keyword">if</span> (material.HasProperty(<span class="hljs-string">"_EmissionColor"</span>))<font></font>
                MaterialEditor.FixupEmissiveFlag(material);<font></font>
            <span class="hljs-keyword">bool</span> shouldEmissionBeEnabled =<font></font>
                (material.globalIlluminationFlags &amp; MaterialGlobalIlluminationFlags.EmissiveIsBlack) == <span class="hljs-number">0</span>;
            <span class="hljs-keyword">if</span> (material.HasProperty(<span class="hljs-string">"_EmissionEnabled"</span>) &amp;&amp; !shouldEmissionBeEnabled)<font></font>
                shouldEmissionBeEnabled = material.GetFloat(<span class="hljs-string">"_EmissionEnabled"</span>) &gt;= <span class="hljs-number">0.5f</span>;<font></font>
            CoreUtils.SetKeyword(material, <span class="hljs-string">"_EMISSION"</span>, shouldEmissionBeEnabled);
            <span class="hljs-comment">// Normal Map</span>
            <span class="hljs-keyword">if</span> (material.HasProperty(<span class="hljs-string">"_BumpMap"</span>))<font></font>
                CoreUtils.SetKeyword(material, <span class="hljs-string">"_NORMALMAP"</span>, material.GetTexture(<span class="hljs-string">"_BumpMap"</span>));
            <span class="hljs-comment">// Shader specific keyword functions</span><font></font>
            shadingModelFunc?.Invoke(material);<font></font>
            shaderFunc?.Invoke(material);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetupMaterialBlendMode</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (material == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"material"</span>);<font></font>
<font></font>
            <span class="hljs-keyword">bool</span> alphaClip = material.GetFloat(<span class="hljs-string">"_AlphaClip"</span>) == <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span> (alphaClip)<font></font>
            {<font></font>
                material.EnableKeyword(<span class="hljs-string">"_ALPHATEST_ON"</span>);<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                material.DisableKeyword(<span class="hljs-string">"_ALPHATEST_ON"</span>);<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">var</span> queueOffset = <span class="hljs-number">0</span>; <span class="hljs-comment">// queueOffsetRange;</span>
            <span class="hljs-keyword">if</span> (material.HasProperty(<span class="hljs-string">"_QueueOffset"</span>))<font></font>
                queueOffset = queueOffsetRange - (<span class="hljs-keyword">int</span>)material.GetFloat(<span class="hljs-string">"_QueueOffset"</span>);<font></font>
<font></font>
            SurfaceType surfaceType = (SurfaceType)material.GetFloat(<span class="hljs-string">"_Surface"</span>);
            <span class="hljs-keyword">if</span> (surfaceType == SurfaceType.Opaque)<font></font>
            {<font></font>
                <span class="hljs-keyword">if</span> (alphaClip)<font></font>
                {<font></font>
                    material.renderQueue = (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.RenderQueue.AlphaTest;<font></font>
                    material.SetOverrideTag(<span class="hljs-string">"RenderType"</span>, <span class="hljs-string">"TransparentCutout"</span>);<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span><font></font>
                {<font></font>
                    material.renderQueue = (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.RenderQueue.Geometry;<font></font>
                    material.SetOverrideTag(<span class="hljs-string">"RenderType"</span>, <span class="hljs-string">"Opaque"</span>);<font></font>
                }<font></font>
                material.renderQueue += queueOffset;<font></font>
                material.SetInt(<span class="hljs-string">"_SrcBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.One);<font></font>
                material.SetInt(<span class="hljs-string">"_DstBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.Zero);<font></font>
                material.SetInt(<span class="hljs-string">"_ZWrite"</span>, <span class="hljs-number">1</span>);<font></font>
                material.DisableKeyword(<span class="hljs-string">"_ALPHAPREMULTIPLY_ON"</span>);<font></font>
                material.SetShaderPassEnabled(<span class="hljs-string">"ShadowCaster"</span>, <span class="hljs-literal">true</span>);<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                BlendMode blendMode = (BlendMode)material.GetFloat(<span class="hljs-string">"_Blend"</span>);
                <span class="hljs-keyword">var</span> queue = (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.RenderQueue.Transparent;<font></font>
<font></font>
                <span class="hljs-comment">// Specific Transparent Mode Settings</span>
                <span class="hljs-keyword">switch</span> (blendMode)<font></font>
                {<font></font>
                    <span class="hljs-keyword">case</span> BlendMode.Alpha:<font></font>
                        material.SetInt(<span class="hljs-string">"_SrcBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.SrcAlpha);<font></font>
                        material.SetInt(<span class="hljs-string">"_DstBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.OneMinusSrcAlpha);<font></font>
                        material.DisableKeyword(<span class="hljs-string">"_ALPHAPREMULTIPLY_ON"</span>);
                        <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> BlendMode.Premultiply:<font></font>
                        material.SetInt(<span class="hljs-string">"_SrcBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.One);<font></font>
                        material.SetInt(<span class="hljs-string">"_DstBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.OneMinusSrcAlpha);<font></font>
                        material.EnableKeyword(<span class="hljs-string">"_ALPHAPREMULTIPLY_ON"</span>);
                        <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> BlendMode.Additive:<font></font>
                        material.SetInt(<span class="hljs-string">"_SrcBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.One);<font></font>
                        material.SetInt(<span class="hljs-string">"_DstBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.One);<font></font>
                        material.DisableKeyword(<span class="hljs-string">"_ALPHAPREMULTIPLY_ON"</span>);
                        <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> BlendMode.Multiply:<font></font>
                        material.SetInt(<span class="hljs-string">"_SrcBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.DstColor);<font></font>
                        material.SetInt(<span class="hljs-string">"_DstBlend"</span>, (<span class="hljs-keyword">int</span>)UnityEngine.Rendering.BlendMode.Zero);<font></font>
                        material.DisableKeyword(<span class="hljs-string">"_ALPHAPREMULTIPLY_ON"</span>);<font></font>
                        material.EnableKeyword(<span class="hljs-string">"_ALPHAMODULATE_ON"</span>);
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
                <span class="hljs-comment">// General Transparent Material Settings</span>
                material.SetOverrideTag(<span class="hljs-string">"RenderType"</span>, <span class="hljs-string">"Transparent"</span>);<font></font>
                material.SetInt(<span class="hljs-string">"_ZWrite"</span>, <span class="hljs-number">0</span>);<font></font>
                material.renderQueue = queue + queueOffset;<font></font>
                material.SetShaderPassEnabled(<span class="hljs-string">"ShadowCaster"</span>, <span class="hljs-literal">false</span>);<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-comment">// Helper Functions               //</span>
        <span class="hljs-comment"><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span><span class="hljs-doctag">///</span></span>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> HelperFunctions</span><font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TwoFloatSingleLine</span>(<span class="hljs-params">GUIContent title, MaterialProperty prop1, GUIContent prop1Label,
            MaterialProperty prop2, GUIContent prop2Label, MaterialEditor materialEditor, <span class="hljs-keyword">float</span> labelWidth = <span class="hljs-number">30f</span></span>)</span><font></font>
        {<font></font>
            EditorGUI.BeginChangeCheck();<font></font>
            EditorGUI.showMixedValue = prop1.hasMixedValue || prop2.hasMixedValue;<font></font>
            Rect rect = EditorGUILayout.GetControlRect();<font></font>
            EditorGUI.PrefixLabel(rect, title);<font></font>
            <span class="hljs-keyword">var</span> indent = EditorGUI.indentLevel;
            <span class="hljs-keyword">var</span> preLabelWidth = EditorGUIUtility.labelWidth;<font></font>
            EditorGUI.indentLevel = <span class="hljs-number">0</span>;<font></font>
            EditorGUIUtility.labelWidth = labelWidth;<font></font>
            Rect propRect1 = <span class="hljs-keyword">new</span> Rect(rect.x + preLabelWidth, rect.y,<font></font>
                (rect.width - preLabelWidth) * <span class="hljs-number">0.5f</span>, EditorGUIUtility.singleLineHeight);
            <span class="hljs-keyword">var</span> prop1val = EditorGUI.FloatField(propRect1, prop1Label, prop1.floatValue);<font></font>
<font></font>
            Rect propRect2 = <span class="hljs-keyword">new</span> Rect(propRect1.x + propRect1.width, rect.y,<font></font>
                propRect1.width, EditorGUIUtility.singleLineHeight);<font></font>
            <span class="hljs-keyword">var</span> prop2val = EditorGUI.FloatField(propRect2, prop2Label, prop2.floatValue);<font></font>
<font></font>
            EditorGUI.indentLevel = indent;<font></font>
            EditorGUIUtility.labelWidth = preLabelWidth;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
            {<font></font>
                materialEditor.RegisterPropertyChangeUndo(title.text);<font></font>
                prop1.floatValue = prop1val;<font></font>
                prop2.floatValue = prop2val;<font></font>
            }<font></font>
<font></font>
            EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoPopup</span>(<span class="hljs-params">GUIContent label, MaterialProperty property, <span class="hljs-keyword">string</span>[] options</span>)</span><font></font>
        {<font></font>
            DoPopup(label, property, options, materialEditor);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoPopup</span>(<span class="hljs-params">GUIContent label, MaterialProperty property, <span class="hljs-keyword">string</span>[] options, MaterialEditor materialEditor</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (property == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"property"</span>);<font></font>
<font></font>
            EditorGUI.showMixedValue = property.hasMixedValue;<font></font>
<font></font>
            <span class="hljs-keyword">var</span> mode = property.floatValue;<font></font>
            EditorGUI.BeginChangeCheck();<font></font>
            mode = EditorGUILayout.Popup(label, (<span class="hljs-keyword">int</span>)mode, options);
            <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
            {<font></font>
                materialEditor.RegisterPropertyChangeUndo(label.text);<font></font>
                property.floatValue = mode;<font></font>
            }<font></font>
<font></font>
            EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// Helper to show texture and color properties</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Rect <span class="hljs-title">TextureColorProps</span>(<span class="hljs-params">MaterialEditor materialEditor, GUIContent label, MaterialProperty textureProp, MaterialProperty colorProp, <span class="hljs-keyword">bool</span> hdr = <span class="hljs-literal">false</span></span>)</span><font></font>
        {<font></font>
            Rect rect = EditorGUILayout.GetControlRect();<font></font>
            EditorGUI.showMixedValue = textureProp.hasMixedValue;<font></font>
            materialEditor.TexturePropertyMiniThumbnail(rect, textureProp, label.text, label.tooltip);<font></font>
            EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (colorProp != <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                EditorGUI.BeginChangeCheck();<font></font>
                EditorGUI.showMixedValue = colorProp.hasMixedValue;<font></font>
                <span class="hljs-keyword">int</span> indentLevel = EditorGUI.indentLevel;<font></font>
                EditorGUI.indentLevel = <span class="hljs-number">0</span>;<font></font>
                Rect rectAfterLabel = <span class="hljs-keyword">new</span> Rect(rect.x + EditorGUIUtility.labelWidth, rect.y,<font></font>
                    EditorGUIUtility.fieldWidth, EditorGUIUtility.singleLineHeight);<font></font>
                <span class="hljs-keyword">var</span> col = EditorGUI.ColorField(rectAfterLabel, GUIContent.none, colorProp.colorValue, <span class="hljs-literal">true</span>,
                    <span class="hljs-literal">false</span>, hdr);<font></font>
                EditorGUI.indentLevel = indentLevel;<font></font>
                <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
                {<font></font>
                    materialEditor.RegisterPropertyChangeUndo(colorProp.displayName);<font></font>
                    colorProp.colorValue = col;<font></font>
                }<font></font>
                EditorGUI.showMixedValue = <span class="hljs-literal">false</span>;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> rect;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// Copied from shaderGUI as it is a protected function in an abstract class, unavailable to others</span><font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> new <span class="hljs-keyword">static</span> MaterialProperty <span class="hljs-title">FindProperty</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> propertyName, MaterialProperty[] properties</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> FindProperty(propertyName, properties, <span class="hljs-literal">true</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// Copied from shaderGUI as it is a protected function in an abstract class, unavailable to others</span><font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> new <span class="hljs-keyword">static</span> MaterialProperty <span class="hljs-title">FindProperty</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> propertyName, MaterialProperty[] properties, <span class="hljs-keyword">bool</span> propertyIsMandatory</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>; index &lt; properties.Length; ++index)<font></font>
            {<font></font>
                <span class="hljs-keyword">if</span> (properties[index] != <span class="hljs-literal">null</span> &amp;&amp; properties[index].name == propertyName)
                    <span class="hljs-keyword">return</span> properties[index];<font></font>
            }<font></font>
            <span class="hljs-keyword">if</span> (propertyIsMandatory)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"Could not find MaterialProperty: '"</span> + propertyName + <span class="hljs-string">"', Num properties: "</span> + (<span class="hljs-keyword">object</span>)properties.Length);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
    }<font></font>
}</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LitShaderEditor.cs</font></font></b><div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.Rendering;
<span class="hljs-keyword">using</span> UnityEditor.Rendering.LWRP;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">UnityEditor.Rendering.LWRP.ShaderGUI</span><font></font>
{<font></font>
    <span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LitShaderEditor</span> : <span class="hljs-title">BaseShaderEditor</span><font></font>
    {<font></font>
        <span class="hljs-comment">// Properties</span>
        <span class="hljs-keyword">private</span> LitGUI.LitProperties litProperties;<font></font>
<font></font>
        <span class="hljs-comment">// collect properties from the material properties</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FindProperties</span>(<span class="hljs-params">MaterialProperty[] properties</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">base</span>.FindProperties(properties);<font></font>
            litProperties = <span class="hljs-keyword">new</span> LitGUI.LitProperties(properties);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// material changed check</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MaterialChanged</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (material == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"material"</span>);<font></font>
<font></font>
            SetMaterialKeywords(material, LitGUI.SetMaterialKeywords);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// material main surface options</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawSurfaceOptions</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (material == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"material"</span>);<font></font>
<font></font>
            <span class="hljs-comment">// Use default labelWidth</span>
            EditorGUIUtility.labelWidth = <span class="hljs-number">0f</span>;<font></font>
<font></font>
            <span class="hljs-comment">// Detect any changes to the material</span><font></font>
            EditorGUI.BeginChangeCheck();<font></font>
            <span class="hljs-keyword">if</span> (litProperties.workflowMode != <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                DoPopup(LitGUI.Styles.workflowModeText, litProperties.workflowMode, Enum.GetNames(<span class="hljs-keyword">typeof</span>(LitGUI.WorkflowMode)));<font></font>
            }<font></font>
            <span class="hljs-keyword">if</span> (EditorGUI.EndChangeCheck())<font></font>
            {<font></font>
                <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> obj <span class="hljs-keyword">in</span> blendModeProp.targets)<font></font>
                    MaterialChanged((Material)obj);<font></font>
            }<font></font>
            <span class="hljs-keyword">base</span>.DrawSurfaceOptions(material);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// material main surface inputs</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawSurfaceInputs</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">base</span>.DrawSurfaceInputs(material);<font></font>
            LitGUI.Inputs(litProperties, materialEditor, material);<font></font>
            DrawEmissionProperties(material, <span class="hljs-literal">true</span>);<font></font>
            DrawTileOffset(materialEditor, baseMapProp);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// material main advanced options</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DrawAdvancedOptions</span>(<span class="hljs-params">Material material</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (litProperties.reflections != <span class="hljs-literal">null</span> &amp;&amp; litProperties.highlights != <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                EditorGUI.BeginChangeCheck();<font></font>
                {<font></font>
                    materialEditor.ShaderProperty(litProperties.highlights, LitGUI.Styles.highlightsText);<font></font>
                    materialEditor.ShaderProperty(litProperties.reflections, LitGUI.Styles.reflectionsText);<font></font>
                    EditorGUI.BeginChangeCheck();<font></font>
                }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">base</span>.DrawAdvancedOptions(material);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AssignNewShaderToMaterial</span>(<span class="hljs-params">Material material, Shader oldShader, Shader newShader</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (material == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"material"</span>);<font></font>
<font></font>
            <span class="hljs-comment">// _Emission property is lost after assigning Standard shader to the material</span>
            <span class="hljs-comment">// thus transfer it before assigning the new shader</span>
            <span class="hljs-keyword">if</span> (material.HasProperty(<span class="hljs-string">"_Emission"</span>))<font></font>
            {<font></font>
                material.SetColor(<span class="hljs-string">"_EmissionColor"</span>, material.GetColor(<span class="hljs-string">"_Emission"</span>));<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">base</span>.AssignNewShaderToMaterial(material, oldShader, newShader);<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (oldShader == <span class="hljs-literal">null</span> || !oldShader.name.Contains(<span class="hljs-string">"Legacy Shaders/"</span>))<font></font>
            {<font></font>
                SetupMaterialBlendMode(material);<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
            }<font></font>
<font></font>
            SurfaceType surfaceType = SurfaceType.Opaque;<font></font>
            BlendMode blendMode = BlendMode.Alpha;<font></font>
            <span class="hljs-keyword">if</span> (oldShader.name.Contains(<span class="hljs-string">"/Transparent/Cutout/"</span>))<font></font>
            {<font></font>
                surfaceType = SurfaceType.Opaque;<font></font>
                material.SetFloat(<span class="hljs-string">"_AlphaClip"</span>, <span class="hljs-number">1</span>);<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldShader.name.Contains(<span class="hljs-string">"/Transparent/"</span>))<font></font>
            {<font></font>
                <span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> legacy shaders did not provide physically based transparency</span>
                <span class="hljs-comment">// therefore Fade mode</span><font></font>
                surfaceType = SurfaceType.Transparent;<font></font>
                blendMode = BlendMode.Alpha;<font></font>
            }<font></font>
            material.SetFloat(<span class="hljs-string">"_Surface"</span>, (<span class="hljs-keyword">float</span>)surfaceType);<font></font>
            material.SetFloat(<span class="hljs-string">"_Blend"</span>, (<span class="hljs-keyword">float</span>)blendMode);<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (oldShader.name.Equals(<span class="hljs-string">"Standard (Specular setup)"</span>))<font></font>
            {<font></font>
                material.SetFloat(<span class="hljs-string">"_WorkflowMode"</span>, (<span class="hljs-keyword">float</span>)LitGUI.WorkflowMode.Specular);<font></font>
                Texture texture = material.GetTexture(<span class="hljs-string">"_SpecGlossMap"</span>);
                <span class="hljs-keyword">if</span> (texture != <span class="hljs-literal">null</span>)<font></font>
                    material.SetTexture(<span class="hljs-string">"_MetallicSpecGlossMap"</span>, texture);<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                material.SetFloat(<span class="hljs-string">"_WorkflowMode"</span>, (<span class="hljs-keyword">float</span>)LitGUI.WorkflowMode.Metallic);<font></font>
                Texture texture = material.GetTexture(<span class="hljs-string">"_MetallicGlossMap"</span>);
                <span class="hljs-keyword">if</span> (texture != <span class="hljs-literal">null</span>)<font></font>
                    material.SetTexture(<span class="hljs-string">"_MetallicSpecGlossMap"</span>, texture);<font></font>
            }<font></font>
<font></font>
            MaterialChanged(material);<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、シェーダーの内部を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に注意する点は、シェーダーにはパスが5つしかないことです。</font><font style="vertical-align: inherit;">それらについて少し詳しく説明します。</font></font><br>
<br>
<ol>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ForwardLit：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォワードパス。ここでは、ライト、PBR、フォグを考慮しています。</font></font></li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ShadowCaster：これ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が影の計算です。</font></font></li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DepthOnly：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">深度（Zバッファ）。</font></font></li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メタ：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベイクライト（ライトマップ）。</font></font></li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lightweight2D：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スプライトとUI。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、Unityにはいくつかの異なるシェーダーコンパイラーとクロスコンパイラーがあります。</font><font style="vertical-align: inherit;">SRPにはHLSLccが必要です。</font><font style="vertical-align: inherit;">OpenGL ESグラフィカルAPI（Androidなど）を使用するプラットフォームでは、HLSLccはデフォルトでは使用されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、接続を強制します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> prefer_hlslcc gles</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、DirectX 9はサポートされていないため、強制的に無効にします。 </font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> exclude_renderers d3d11_9x</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コード自体の記述に関しては、CGではなく純粋なHLSLで記述していること以外は何も変更されていないため、シェーダープログラムの本体は次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs">HLSLPROGRAM<font></font>
...<font></font>
ENDHLSL</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、我々はまだのようなおなじみのグローバル変数にアクセスしてい</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_time</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_ScreenParams</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_WorldSpaceCameraPosを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ただし、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityCG.cgincで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明されていた多くの標準機能は</font><font style="vertical-align: inherit;">利用できなくなりました。ほとんどの場合、これは種々のマトリックス変換に適用され、例えば、のアナログ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityObjectToClipPos（位置）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">である</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TransformWorldToHClip（POSITION） </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">ウェル、または霧のために-の代わりに</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNITY_APPLY_FOG（fogCoord、色）、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在使用する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MixFog（色、fogCoordを）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、同じ魔法のパスをたどり、Core.hlslファイルを見つけます。</font></font><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％localappdata％\ Unity \ cache \ packages \ packages.unity.com \ com.unity.render-pipelines.lightweight @（LWRP version）\ ShaderLibrary \ Core.hlsl</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
利用可能な機能の完全なリストを見つけることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、定数バッファ（CBUFFER）とUnityPerMaterialについても触れておきます。</font><font style="vertical-align: inherit;">定数バッファーは、それぞれGPUでめったに変更されないデータを格納するために使用され、シェーダー変数を格納するために使用できます。</font><font style="vertical-align: inherit;">これを行うには、マクロ</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBUFFER_START</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBUFFER_ENDを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cpp hljs">CBUFFER_START(UnityPerMaterial)<font></font>
      float4 _BaseMap_ST;<font></font>
      half4 _BaseColor;<font></font>
      half4 _SpecColor;<font></font>
      half4 _EmissionColor;<font></font>
      half _Cutoff;<font></font>
      half _Smoothness;<font></font>
      half _Metallic;<font></font>
      half _BumpScale;<font></font>
      half _OcclusionStrength;<font></font>
CBUFFER_END</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グローバル変数またはパラメーターで設定されたさまざまな変数の宣言（コードやアニメーションなどから）は、シェーダープログラムの本体内で昔ながらの方法で行われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LWRPは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityPerObject</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityPerMaterialの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2種類の定数バッファーを使用し</font><font style="vertical-align: inherit;">ます。これらのバッファーは一度バインドされ、レンダリング中に使用できるようになります。大まかに言うと、これはレンダリング中に定数バッファーが再補強されないか、マテリアルに対してセットパスが呼び出されないことを意味します。これは、複数のシェーダーが同じ定数バッファーを共有する場合に有益です。これは、LWRPがこのために異なる材料をパッケージ化できるためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、シェーダーの構造を注意深く調べると、ほとんどの標準データがどこでも定数バッファーを使用していることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
詳細については、すべての違いについてですが、英語では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、SurfaceDataをよく見ると：</font></font><br>
<pre><code class="cpp hljs">SurfaceData surfaceData;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは</font><b><font style="vertical-align: inherit;">ShaderGraphの</font></b><font style="vertical-align: inherit;">大事な</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PBRマスター</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であることに</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">気付くでしょう</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h4><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だから、今は完全に手を解き放っています。つまり、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バッカナルを配置する</font><font style="vertical-align: inherit;">時が来</font><font style="vertical-align: inherit;">ました！</font><font style="vertical-align: inherit;">例</font><font style="vertical-align: inherit;">として</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertex Displacement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dissolve Effect</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">追加して</font><font style="vertical-align: inherit;">、残りをダンスしましょう。</font><font style="vertical-align: inherit;">
すべてのパスが目の前にあり、すべてを包括的に編集できるので非常に便利です。</font><font style="vertical-align: inherit;">
プロパティについて説明しましょう：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/8dd/01d/ed6/8dd01ded67bfb91cc0e7e4f505276524.gif" alt="LVRP_TextShaders_2020-01-20_21-08-42.gif"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs">Properties<font></font>
{<font></font>
       ...<font></font>
       _DissolveMap(<span class="hljs-string">"Dissolve Map"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
       _DissolveFactor(<span class="hljs-string">"Dissolve Factor"</span>, Range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) = <span class="hljs-number">0.0</span>
       _DissolveWidth(<span class="hljs-string">"Dissolve Width"</span>, Range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) = <span class="hljs-number">0.0</span>
       [HDR]_DissolveColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは間違いなく、インスペクターのお気に入りのタブに表示され</font><font style="vertical-align: inherit;">
ます。変数を追加します。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/3ea/b11/b16/3eab11b16256aa0099e07e6172ba9557.png" alt="2020-01-20_22-55-14.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs">CBUFFER_START(UnityPerMaterial)<font></font>
     ...<font></font>
     float4 _DissolveMap_ST; <span class="hljs-comment">//    _DissolveMap</span>
<span class="hljs-function">CBUFFER_END

<span class="hljs-title">TEXTURE2D</span><span class="hljs-params">(_DissolveMap)</span></span>;        SAMPLER(sampler_DissolveMap);             
<span class="hljs-keyword">float</span> _DissolveFactor;
<span class="hljs-keyword">float</span> _DissolveWidth;<font></font>
float4 _DissolveColor;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、ジオメトリを酔った愚痴に送ります。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">Varyings <span class="hljs-title">LitPassVertex</span><span class="hljs-params">(Attributes input)</span>
</span>{<font></font>
    ...<font></font>
    input.positionOS.xyz += normalize(input.positionOS.xyz) * <span class="hljs-built_in">sin</span>(input.positionOS.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に影：</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function">Varyings <span class="hljs-title">ShadowPassVertex</span><span class="hljs-params">(Attributes input)</span>
</span>{<font></font>
       ...<font></font>
       input.positionOS.xyz += normalize(input.positionOS.xyz) * <span class="hljs-built_in">sin</span>(input.positionOS.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
       ...         <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
奥行き：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">Varyings <span class="hljs-title">DepthOnlyVertex</span><span class="hljs-params">(Attributes input)</span>
</span>{<font></font>
       ...<font></font>
       input.position.xyz += normalize(input.position.xyz) * <span class="hljs-built_in">sin</span>(input.position.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
       ...         <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、ここで時間と動きをディゾルブします。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">half4 <span class="hljs-title">LitPassFragment</span><span class="hljs-params">(Varyings input)</span> : SV_Target
</span>{<font></font>
      ...<font></font>
      <span class="hljs-comment">// UV   </span>
      input.uv += _Time.x * <span class="hljs-number">10</span>;
      <span class="hljs-comment">//     Dissolve </span><font></font>
      float4 mask = SAMPLE_TEXTURE2D(_DissolveMap, sampler_DissolveMap, input.uv);<font></font>
      <span class="hljs-keyword">if</span> (mask.r &gt; _DissolveFactor)<font></font>
          discard;<font></font>
      <span class="hljs-comment">// </span>
      <span class="hljs-keyword">bool</span> outline = mask.r &gt; _DissolveFactor - _DissolveWidth;
      <span class="hljs-comment">//    </span><font></font>
      surfaceData.emission *= outline * _DissolveColor;<font></font>
      <span class="hljs-comment">//,    PBR-  </span><font></font>
      half4 color = LightweightFragmentPBR(inputData, surfaceData.albedo, surfaceData.metallic, surfaceData.specular, surfaceData.smoothness, surfaceData.occlusion, surfaceData.emission, surfaceData.alpha);<font></font>
      <span class="hljs-comment">//     </span>
      color *= lerp(<span class="hljs-number">1</span>, _DissolveColor, outline);<font></font>
      ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、Dissolveを影に入れると、手首を振るだけで正しい影が得られます。これは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーグラフ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">実現するのが</font><font style="vertical-align: inherit;">非常に難しい</font><font style="vertical-align: inherit;">ため、次</font><font style="vertical-align: inherit;">の数行のコードだけです。</font></font><br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-function">half4 <span class="hljs-title">ShadowPassFragment</span><span class="hljs-params">(Varyings input)</span> : SV_TARGET
</span>{<font></font>
      ...<font></font>
      float4 mask = SAMPLE_TEXTURE2D(_DissolveMap, sampler_DissolveMap, input.uv);<font></font>
      <span class="hljs-keyword">if</span> (mask.r &gt; _DissolveFactor)<font></font>
          discard;<font></font>
      ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、最終的なシェーダーコード：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleDissolve</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">
Shader <span class="hljs-string">"TheProxor/LWRP/Dissolve + Vertex Offset"</span><font></font>
{<font></font>
            Properties<font></font>
            {<font></font>
                <span class="hljs-comment">// Specular vs Metallic workflow</span>
                [HideInInspector] _WorkflowMode(<span class="hljs-string">"WorkflowMode"</span>, Float) = <span class="hljs-number">1.0</span><font></font>
<font></font>
                [MainColor][HideInInspector] _BaseColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">1</span>)<font></font>
                [MainTexture][HideInInspector] _BaseMap(<span class="hljs-string">"Albedo"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HideInInspector]_Cutoff(<span class="hljs-string">"Alpha Cutoff"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span><font></font>
<font></font>
                [HideInInspector]_Smoothness(<span class="hljs-string">"Smoothness"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span>
                [HideInInspector]_GlossMapScale(<span class="hljs-string">"Smoothness Scale"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">1.0</span>
                [HideInInspector]_SmoothnessTextureChannel(<span class="hljs-string">"Smoothness texture channel"</span>, Float) = <span class="hljs-number">0</span><font></font>
<font></font>
                [Gamma][HideInInspector] _Metallic(<span class="hljs-string">"Metallic"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.0</span>
                [HideInInspector]_MetallicGlossMap(<span class="hljs-string">"Metallic"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HideInInspector]_SpecColor(<span class="hljs-string">"Specular"</span>, Color) = (<span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>)<font></font>
                [HideInInspector]_SpecGlossMap(<span class="hljs-string">"Specular"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HideInInspector][ToggleOff] _SpecularHighlights(<span class="hljs-string">"Specular Highlights"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector][ToggleOff] _EnvironmentReflections(<span class="hljs-string">"Environment Reflections"</span>, Float) = <span class="hljs-number">1.0</span><font></font>
<font></font>
                [HideInInspector]_BumpScale(<span class="hljs-string">"Scale"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector]_BumpMap(<span class="hljs-string">"Normal Map"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"bump"</span> {}<font></font>
<font></font>
                [HideInInspector]_OcclusionStrength(<span class="hljs-string">"Strength"</span>, Range(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">1.0</span>
                [HideInInspector]_OcclusionMap(<span class="hljs-string">"Occlusion"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                [HDR][HideInInspector]_EmissionColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<font></font>
                [HideInInspector]_EmissionMap(<span class="hljs-string">"Emission"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
<font></font>
                <span class="hljs-comment">// Blending state</span>
                [HideInInspector] _Surface(<span class="hljs-string">"__surface"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _Blend(<span class="hljs-string">"__blend"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _AlphaClip(<span class="hljs-string">"__clip"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _SrcBlend(<span class="hljs-string">"__src"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector] _DstBlend(<span class="hljs-string">"__dst"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _ZWrite(<span class="hljs-string">"__zw"</span>, Float) = <span class="hljs-number">1.0</span>
                [HideInInspector] _Cull(<span class="hljs-string">"__cull"</span>, Float) = <span class="hljs-number">2.0</span><font></font>
<font></font>
                [HideInInspector]_ReceiveShadows(<span class="hljs-string">"Receive Shadows"</span>, Float) = <span class="hljs-number">1.0</span>
                <span class="hljs-comment">// Editmode props</span>
                [HideInInspector] _QueueOffset(<span class="hljs-string">"Queue offset"</span>, Float) = <span class="hljs-number">0.0</span><font></font>
<font></font>
                <span class="hljs-comment">// ObsoleteProperties</span>
                [HideInInspector] _MainTex(<span class="hljs-string">"BaseMap"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
                [HideInInspector] _Color(<span class="hljs-string">"Base Color"</span>, Color) = (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>)<font></font>
                [HideInInspector] _GlossMapScale(<span class="hljs-string">"Smoothness"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _Glossiness(<span class="hljs-string">"Smoothness"</span>, Float) = <span class="hljs-number">0.0</span>
                [HideInInspector] _GlossyReflections(<span class="hljs-string">"EnvironmentReflections"</span>, Float) = <span class="hljs-number">0.0</span><font></font>
<font></font>
                <font></font>
<font></font>
                <span class="hljs-comment">//</span>
                _DissolveMap(<span class="hljs-string">"Dissolve Map"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}<font></font>
                _DissolveFactor(<span class="hljs-string">"Dissolve Factor"</span>, Range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) = <span class="hljs-number">0.0</span>
                _DissolveWidth(<span class="hljs-string">"Dissolve Width"</span>, Range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) = <span class="hljs-number">0.0</span>
                [HDR]_DissolveColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<font></font>
            }<font></font>
<font></font>
            SubShader<font></font>
            {<font></font>
                <span class="hljs-comment">// Lightweight Pipeline tag is required. If Lightweight render pipeline is not set in the graphics settings</span>
                <span class="hljs-comment">// this Subshader will fail. One can add a subshader below or fallback to Standard built-in to make this</span>
                <span class="hljs-comment">// material work with both Lightweight Render Pipeline and Builtin Unity Pipeline</span>
                Tags{<span class="hljs-string">"RenderType"</span> = <span class="hljs-string">"Opaque"</span> <span class="hljs-string">"RenderPipeline"</span> = <span class="hljs-string">"LightweightPipeline"</span> <span class="hljs-string">"IgnoreProjector"</span> = <span class="hljs-string">"True"</span>}<font></font>
                LOD <span class="hljs-number">300</span><font></font>
<font></font>
                <span class="hljs-comment">// ------------------------------------------------------------------</span>
                <span class="hljs-comment">//  Forward pass. Shades all light in a single pass. GI + emission + Fog</span><font></font>
                Pass<font></font>
                {<font></font>
                <span class="hljs-comment">// Lightmode matches the ShaderPassName set in LightweightRenderPipeline.cs. SRPDefaultUnlit and passes with</span>
                <span class="hljs-comment">// no LightMode tag are also rendered by Lightweight Render Pipeline</span>
                Name <span class="hljs-string">"ForwardLit"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"LightweightForward"</span>}<font></font>
<font></font>
                Blend[_SrcBlend][_DstBlend]<font></font>
                ZWrite[_ZWrite]<font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard SRP library</span>
                <span class="hljs-comment">// All shaders must be compiled with HLSLcc and currently only gles is not using HLSLcc by default</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
                #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Material Keywords</span><font></font>
                #pragma shader_feature _NORMALMAP<font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _ALPHAPREMULTIPLY_ON<font></font>
                #pragma shader_feature _EMISSION<font></font>
                #pragma shader_feature _METALLICSPECGLOSSMAP<font></font>
                #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
                #pragma shader_feature _OCCLUSIONMAP<font></font>
<font></font>
                #pragma shader_feature _SPECULARHIGHLIGHTS_OFF<font></font>
                #pragma shader_feature _ENVIRONMENTREFLECTIONS_OFF<font></font>
                #pragma shader_feature _SPECULAR_SETUP<font></font>
                #pragma shader_feature _RECEIVE_SHADOWS_OFF<font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Lightweight Pipeline keywords</span><font></font>
                #pragma multi_compile _ _MAIN_LIGHT_SHADOWS<font></font>
                #pragma multi_compile _ _MAIN_LIGHT_SHADOWS_CASCADE<font></font>
                #pragma multi_compile _ _ADDITIONAL_LIGHTS_VERTEX _ADDITIONAL_LIGHTS<font></font>
                #pragma multi_compile _ _ADDITIONAL_LIGHT_SHADOWS<font></font>
                #pragma multi_compile _ _SHADOWS_SOFT<font></font>
                #pragma multi_compile _ _MIXED_LIGHTING_SUBTRACTIVE<font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Unity defined keywords</span><font></font>
                #pragma multi_compile _ DIRLIGHTMAP_COMBINED<font></font>
                #pragma multi_compile _ LIGHTMAP_ON<font></font>
                #pragma multi_compile_fog<font></font>
<font></font>
                <span class="hljs-comment">//--------------------------------------</span>
                <span class="hljs-comment">// GPU Instancing</span><font></font>
                #pragma multi_compile_instancing<font></font>
<font></font>
                #pragma vertex LitPassVertex<font></font>
                #pragma fragment LitPassFragment<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Lighting.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Core.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.core/ShaderLibrary/CommonMaterial.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/SurfaceInput.hlsl"</span><font></font>
<font></font>
                #ifdef _SPECULAR_SETUP<font></font>
                    #define SAMPLE_METALLICSPECULAR(uv) SAMPLE_TEXTURE2D(_SpecGlossMap, sampler_SpecGlossMap, uv)<font></font>
                #<span class="hljs-keyword">else</span><font></font>
                    #define SAMPLE_METALLICSPECULAR(uv) SAMPLE_TEXTURE2D(_MetallicGlossMap, sampler_MetallicGlossMap, uv)<font></font>
                #endif<font></font>
<font></font>
<font></font>
<font></font>
                struct Attributes<font></font>
                {<font></font>
                    float4 positionOS   : POSITION;<font></font>
                    float3 normalOS     : NORMAL;<font></font>
                    float4 tangentOS    : TANGENT;<font></font>
                    float2 texcoord     : TEXCOORD0;<font></font>
                    float2 lightmapUV   : TEXCOORD1;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                };<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Varyings</span>
                {</span><font></font>
                    float2 uv                       : TEXCOORD0;<font></font>
                    DECLARE_LIGHTMAP_OR_SH(lightmapUV, vertexSH, <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _ADDITIONAL_LIGHTS</span><font></font>
                    float3 positionWS               : TEXCOORD2;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _NORMALMAP</span>
                    half4 normalWS                  : TEXCOORD3;    <span class="hljs-comment">// xyz: normal, w: viewDir.x</span>
                    half4 tangentWS                 : TEXCOORD4;    <span class="hljs-comment">// xyz: tangent, w: viewDir.y</span>
                    half4 bitangentWS                : TEXCOORD5;    <span class="hljs-comment">// xyz: bitangent, w: viewDir.z</span>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    half3 normalWS                  : TEXCOORD3;<font></font>
                    half3 viewDirWS                 : TEXCOORD4;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    half4 fogFactorAndVertexLight   : TEXCOORD6; <span class="hljs-comment">// x: fogFactor, yzw: vertex light</span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _MAIN_LIGHT_SHADOWS</span><font></font>
                    float4 shadowCoord              : TEXCOORD7;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    float4 positionCS               : SV_POSITION;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                    UNITY_VERTEX_OUTPUT_STEREO<font></font>
<font></font>
<font></font>
                    float3 uvDissolve			    : TEXCOORD8; <font></font>
                };<font></font>
<font></font>
<font></font>
                CBUFFER_START(UnityPerMaterial)<font></font>
                    float4 _BaseMap_ST;<font></font>
                    half4 _BaseColor;<font></font>
                    half4 _SpecColor;<font></font>
                    half4 _EmissionColor;<font></font>
                    half _Cutoff;<font></font>
                    half _Smoothness;<font></font>
                    half _Metallic;<font></font>
                    half _BumpScale;<font></font>
                    half _OcclusionStrength;<font></font>
                    float4 _DissolveMap_ST; <span class="hljs-comment">//    _DissolveMap</span><font></font>
<font></font>
                <span class="hljs-function">CBUFFER_END

                <span class="hljs-title">TEXTURE2D</span><span class="hljs-params">(_OcclusionMap)</span></span>;       SAMPLER(sampler_OcclusionMap);<font></font>
                TEXTURE2D(_MetallicGlossMap);   SAMPLER(sampler_MetallicGlossMap);<font></font>
                TEXTURE2D(_SpecGlossMap);       SAMPLER(sampler_SpecGlossMap);<font></font>
                TEXTURE2D(_DissolveMap);        SAMPLER(sampler_DissolveMap);<font></font>
                <font></font>
                <span class="hljs-keyword">float</span> _DissolveFactor;
                <span class="hljs-keyword">float</span> _DissolveWidth;<font></font>
                float4 _DissolveColor;<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">SampleMetallicSpecGloss</span><span class="hljs-params">(float2 uv, half albedoAlpha)</span>
                </span>{<font></font>
                    half4 specGloss;<font></font>
<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _METALLICSPECGLOSSMAP</span><font></font>
                    specGloss = SAMPLE_METALLICSPECULAR(uv);<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A</span><font></font>
                    specGloss.a = albedoAlpha * _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    specGloss.a *= _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span> <span class="hljs-comment">// _METALLICSPECGLOSSMAP</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> _SPECULAR_SETUP</span><font></font>
                    specGloss.rgb = _SpecColor.rgb;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    specGloss.rgb = _Metallic.rrr;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A</span><font></font>
                    specGloss.a = albedoAlpha * _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    specGloss.a = _Smoothness;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    <span class="hljs-keyword">return</span> specGloss;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half <span class="hljs-title">SampleOcclusion</span><span class="hljs-params">(float2 uv)</span>
                </span>{
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _OCCLUSIONMAP</span>
                    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Controls things like these by exposing SHADER_QUALITY levels (low, medium, high)</span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(SHADER_API_GLES)</span>
                    <span class="hljs-keyword">return</span> SAMPLE_TEXTURE2D(_OcclusionMap, sampler_OcclusionMap, uv).g;
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    half occ = SAMPLE_TEXTURE2D(_OcclusionMap, sampler_OcclusionMap, uv).g;<font></font>
                    <span class="hljs-keyword">return</span> LerpWhiteTo(occ, _OcclusionStrength);
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
                    <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span>;
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">InitializeStandardLitSurfaceData</span><span class="hljs-params">(float2 uv, out SurfaceData outSurfaceData)</span>
                </span>{<font></font>
                    half4 albedoAlpha = SAMPLE_TEXTURE2D(_BaseMap, sampler_BaseMap, uv);<font></font>
                   <span class="hljs-comment">// half4 albedoAlpha = SampleAlbedoAlpha(uv, TEXTURE2D_ARGS(_BaseMap, sampler_BaseMap));</span><font></font>
                    outSurfaceData.alpha = Alpha(albedoAlpha.a, _BaseColor, _Cutoff);<font></font>
<font></font>
                    half4 specGloss = SampleMetallicSpecGloss(uv, albedoAlpha.a);<font></font>
                    outSurfaceData.albedo = albedoAlpha.rgb * _BaseColor.rgb;<font></font>
<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> _SPECULAR_SETUP</span>
                    outSurfaceData.metallic = <span class="hljs-number">1.0</span>h;<font></font>
                    outSurfaceData.specular = specGloss.rgb;<font></font>
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    outSurfaceData.metallic = specGloss.r;<font></font>
                    outSurfaceData.specular = half3(<span class="hljs-number">0.0</span>h, <span class="hljs-number">0.0</span>h, <span class="hljs-number">0.0</span>h);
                    <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    outSurfaceData.smoothness = specGloss.a;<font></font>
                    outSurfaceData.normalTS = SampleNormal(uv, TEXTURE2D_ARGS(_BumpMap, sampler_BumpMap), _BumpScale);<font></font>
                    outSurfaceData.occlusion = SampleOcclusion(uv);<font></font>
                    outSurfaceData.emission = SampleEmission(uv, _EmissionColor.rgb, TEXTURE2D_ARGS(_EmissionMap, sampler_EmissionMap));<font></font>
                   <span class="hljs-comment">// outSurfaceData.emission = _EmissionColor.rgb * SAMPLE_TEXTURE2D(_EmissionMap, sampler_EmissionMap, uv);</span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitializeInputData</span><span class="hljs-params">(Varyings input, half3 normalTS, out InputData inputData)</span>
                </span>{<font></font>
                    inputData = (InputData)<span class="hljs-number">0</span>;<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _ADDITIONAL_LIGHTS</span><font></font>
                    inputData.positionWS = input.positionWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _NORMALMAP</span><font></font>
                    half3 viewDirWS = half3(input.normalWS.w, input.tangentWS.w, input.bitangentWS.w);<font></font>
                    inputData.normalWS = TransformTangentToWorld(normalTS,<font></font>
                        half3x3(input.tangentWS.xyz, input.bitangentWS.xyz, input.normalWS.xyz));<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    half3 viewDirWS = input.viewDirWS;<font></font>
                    inputData.normalWS = input.normalWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    inputData.normalWS = NormalizeNormalPerPixel(inputData.normalWS);<font></font>
                    viewDirWS = SafeNormalize(viewDirWS);<font></font>
<font></font>
                    inputData.viewDirectionWS = viewDirWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(_MAIN_LIGHT_SHADOWS) &amp;&amp; !defined(_RECEIVE_SHADOWS_OFF)</span><font></font>
                    inputData.shadowCoord = input.shadowCoord;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
                    inputData.shadowCoord = float4(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
                    inputData.fogCoord = input.fogFactorAndVertexLight.x;<font></font>
                    inputData.vertexLighting = input.fogFactorAndVertexLight.yzw;<font></font>
                    inputData.bakedGI = SAMPLE_GI(input.lightmapUV, input.vertexSH, inputData.normalWS);<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">///////////////////////////////////////////////////////////////////////////////</span>
                <span class="hljs-comment">//                  Vertex and Fragment functions                            //</span>
                <span class="hljs-comment">///////////////////////////////////////////////////////////////////////////////</span><font></font>
<font></font>
                <span class="hljs-comment">//Standard (Physically Based) shader</span>
                <span class="hljs-function">Varyings <span class="hljs-title">LitPassVertex</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    Varyings output = (Varyings)<span class="hljs-number">0</span>;<font></font>
<font></font>
<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    UNITY_TRANSFER_INSTANCE_ID(input, output);<font></font>
                    UNITY_INITIALIZE_VERTEX_OUTPUT_STEREO(output);<font></font>
<font></font>
<font></font>
                    input.positionOS.xyz += <span class="hljs-built_in">sin</span>(input.positionOS.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
<font></font>
                    VertexPositionInputs vertexInput = GetVertexPositionInputs(input.positionOS.xyz);<font></font>
                    VertexNormalInputs normalInput = GetVertexNormalInputs(input.normalOS, input.tangentOS);<font></font>
                    half3 viewDirWS = GetCameraPositionWS() - vertexInput.positionWS;<font></font>
                    half3 vertexLight = VertexLighting(vertexInput.positionWS, normalInput.normalWS);<font></font>
                    half fogFactor = ComputeFogFactor(vertexInput.positionCS.z);<font></font>
<font></font>
                    output.uv = TRANSFORM_TEX(input.texcoord, _BaseMap);<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _NORMALMAP</span><font></font>
                    output.normalWS = half4(normalInput.normalWS, viewDirWS.x);<font></font>
                    output.tangentWS = half4(normalInput.tangentWS, viewDirWS.y);<font></font>
                    output.bitangentWS = half4(normalInput.bitangentWS, viewDirWS.z);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    output.normalWS = NormalizeNormalPerVertex(normalInput.normalWS);<font></font>
                    output.viewDirWS = viewDirWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    OUTPUT_LIGHTMAP_UV(input.lightmapUV, unity_LightmapST, output.lightmapUV);<font></font>
                    OUTPUT_SH(output.normalWS.xyz, output.vertexSH);<font></font>
<font></font>
                    output.fogFactorAndVertexLight = half4(fogFactor, vertexLight);<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _ADDITIONAL_LIGHTS</span><font></font>
                    output.positionWS = vertexInput.positionWS;<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(_MAIN_LIGHT_SHADOWS) &amp;&amp; !defined(_RECEIVE_SHADOWS_OFF)</span><font></font>
                    output.shadowCoord = GetShadowCoord(vertexInput);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    output.positionCS = vertexInput.positionCS;<font></font>
<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">// Used in Standard (Physically Based) shader</span>
                <span class="hljs-function">half4 <span class="hljs-title">LitPassFragment</span><span class="hljs-params">(Varyings input)</span> : SV_Target
                </span>{<font></font>
                    input.uv += _Time.x * <span class="hljs-number">10</span>;<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    UNITY_SETUP_STEREO_EYE_INDEX_POST_VERTEX(input);<font></font>
<font></font>
                    SurfaceData surfaceData;<font></font>
                    InitializeStandardLitSurfaceData(input.uv, surfaceData);<font></font>
<font></font>
                    InputData inputData;<font></font>
                    InitializeInputData(input, surfaceData.normalTS, inputData);<font></font>
                    <font></font>
                    float4 mask = SAMPLE_TEXTURE2D(_DissolveMap, sampler_DissolveMap, input.uv);<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> (mask.r &gt; _DissolveFactor)<font></font>
                        discard;<font></font>
<font></font>
                    <span class="hljs-keyword">bool</span> outline = mask.r &gt; _DissolveFactor - _DissolveWidth;<font></font>
                    surfaceData.emission *= outline * _DissolveColor;<font></font>
                    half4 color = LightweightFragmentPBR(inputData, surfaceData.albedo, surfaceData.metallic, surfaceData.specular, surfaceData.smoothness, surfaceData.occlusion, surfaceData.emission, surfaceData.alpha);<font></font>
                    color *= lerp(<span class="hljs-number">1</span>, _DissolveColor, outline);<font></font>
<font></font>
                    color.rgb = MixFog(color.rgb, inputData.fogCoord);<font></font>
                    <font></font>
                    <span class="hljs-keyword">return</span> color;<font></font>
                }<font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            <span class="hljs-comment">//</span><font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"ShadowCaster"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"ShadowCaster"</span>}<font></font>
<font></font>
                ZWrite On<font></font>
                ZTest LEqual<font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
                #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Material Keywords</span><font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
<font></font>
                <span class="hljs-comment">//--------------------------------------</span>
                <span class="hljs-comment">// GPU Instancing</span><font></font>
                #pragma multi_compile_instancing<font></font>
                #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
                #pragma vertex ShadowPassVertex<font></font>
                #pragma fragment ShadowPassFragment<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>             
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Core.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Shadows.hlsl"</span><font></font>
<font></font>
                float3 _LightDirection;<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Attributes</span>
                {</span><font></font>
                    float4 positionOS   : POSITION;<font></font>
                    float3 normalOS     : NORMAL;<font></font>
                    float2 texcoord     : TEXCOORD0;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                };<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Varyings</span>
                {</span><font></font>
                    float2 uv           : TEXCOORD0;<font></font>
                    float4 positionCS   : SV_POSITION;<font></font>
                };<font></font>
<font></font>
                CBUFFER_START(UnityPerMaterial)<font></font>
                    float4 _DissolveMap_ST; <span class="hljs-comment">//    _DissolveMap</span>
                    <span class="hljs-keyword">float</span> _DissolveFactor;
                <span class="hljs-function">CBUFFER_END

                <span class="hljs-title">TEXTURE2D</span><span class="hljs-params">(_DissolveMap)</span></span>;        SAMPLER(sampler_DissolveMap);<font></font>
<font></font>
                <span class="hljs-function">float4 <span class="hljs-title">GetShadowPositionHClip</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    float3 positionWS = TransformObjectToWorld(input.positionOS.xyz);<font></font>
                    float3 normalWS = TransformObjectToWorldNormal(input.normalOS);<font></font>
<font></font>
                    float4 positionCS = TransformWorldToHClip(ApplyShadowBias(positionWS, normalWS, _LightDirection));<font></font>
<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> UNITY_REVERSED_Z</span><font></font>
                    positionCS.z = min(positionCS.z, positionCS.w * UNITY_NEAR_CLIP_VALUE);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><font></font>
                    positionCS.z = max(positionCS.z, positionCS.w * UNITY_NEAR_CLIP_VALUE);<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                    <span class="hljs-keyword">return</span> positionCS;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">Varyings <span class="hljs-title">ShadowPassVertex</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    Varyings output;<font></font>
                    input.positionOS.xyz += normalize(input.positionOS.xyz) * <span class="hljs-built_in">sin</span>(input.positionOS.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    output.uv = TRANSFORM_TEX(input.texcoord, _BaseMap);<font></font>
                    output.positionCS = GetShadowPositionHClip(input);<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">ShadowPassFragment</span><span class="hljs-params">(Varyings input)</span> : SV_TARGET
                </span>{<font></font>
                     float4 mask = SAMPLE_TEXTURE2D(_DissolveMap, sampler_DissolveMap, input.uv);<font></font>
<font></font>
                     <span class="hljs-keyword">if</span> (mask.r &gt; _DissolveFactor)<font></font>
                         discard;<font></font>
<font></font>
                    Alpha(SampleAlbedoAlpha(input.uv, TEXTURE2D_ARGS(_BaseMap, sampler_BaseMap)).a, _BaseColor, _Cutoff);<font></font>
                    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
<font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"DepthOnly"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"DepthOnly"</span>}<font></font>
<font></font>
                ZWrite On<font></font>
                ColorMask <span class="hljs-number">0</span><font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
                #pragma target <span class="hljs-number">2.0</span><font></font>
<font></font>
                #pragma vertex DepthOnlyVertex<font></font>
                #pragma fragment DepthOnlyFragment<font></font>
<font></font>
                <span class="hljs-comment">// -------------------------------------</span>
                <span class="hljs-comment">// Material Keywords</span><font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
                <span class="hljs-comment">//--------------------------------------</span>
                <span class="hljs-comment">// GPU Instancing</span><font></font>
                #pragma multi_compile_instancing<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/Core.hlsl"</span><font></font>
<font></font>
                #ifndef LIGHTWEIGHT_DEPTH_ONLY_PASS_INCLUDED<font></font>
                #define LIGHTWEIGHT_DEPTH_ONLY_PASS_INCLUDED<font></font>
<font></font>
                struct Attributes<font></font>
                {<font></font>
                    float4 position     : POSITION;<font></font>
                    float2 texcoord     : TEXCOORD0;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                };<font></font>
<font></font>
                <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Varyings</span>
                {</span><font></font>
                    float2 uv           : TEXCOORD0;<font></font>
                    float4 positionCS   : SV_POSITION;<font></font>
                    UNITY_VERTEX_INPUT_INSTANCE_ID<font></font>
                    UNITY_VERTEX_OUTPUT_STEREO<font></font>
                };<font></font>
<font></font>
                <span class="hljs-function">Varyings <span class="hljs-title">DepthOnlyVertex</span><span class="hljs-params">(Attributes input)</span>
                </span>{<font></font>
                    Varyings output = (Varyings)<span class="hljs-number">0</span>;<font></font>
                    UNITY_SETUP_INSTANCE_ID(input);<font></font>
                    UNITY_INITIALIZE_VERTEX_OUTPUT_STEREO(output);<font></font>
<font></font>
                    input.position.xyz += normalize(input.position.xyz) * <span class="hljs-built_in">sin</span>(input.position.x) * <span class="hljs-built_in">sin</span>(_Time.x * <span class="hljs-number">100</span>);<font></font>
<font></font>
                    output.uv = TRANSFORM_TEX(input.texcoord, _BaseMap);<font></font>
                    output.positionCS = TransformObjectToHClip(input.position.xyz);<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">DepthOnlyFragment</span><span class="hljs-params">(Varyings input)</span> : SV_TARGET
                </span>{<font></font>
                    UNITY_SETUP_STEREO_EYE_INDEX_POST_VERTEX(input);<font></font>
<font></font>
                    Alpha(SampleAlbedoAlpha(input.uv, TEXTURE2D_ARGS(_BaseMap, sampler_BaseMap)).a, _BaseColor, _Cutoff);<font></font>
                    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            <span class="hljs-comment">//</span><font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"Meta"</span>
                Tags{<span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"Meta"</span>}<font></font>
<font></font>
                Cull Off<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
<font></font>
                #pragma vertex LightweightVertexMeta<font></font>
                #pragma fragment LightweightFragmentMeta<font></font>
<font></font>
                #pragma shader_feature _SPECULAR_SETUP<font></font>
                #pragma shader_feature _EMISSION<font></font>
                #pragma shader_feature _METALLICSPECGLOSSMAP<font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _ _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A<font></font>
<font></font>
                #pragma shader_feature _SPECGLOSSMAP<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/ShaderLibrary/MetaInput.hlsl"</span><font></font>
<font></font>
                #ifndef LIGHTWEIGHT_LIT_META_PASS_INCLUDED<font></font>
                #define LIGHTWEIGHT_LIT_META_PASS_INCLUDED<font></font>
<font></font>
<font></font>
<font></font>
                Varyings LightweightVertexMeta(Attributes input)<font></font>
                {<font></font>
                    Varyings output;<font></font>
                    output.positionCS = MetaVertexPosition(input.positionOS, input.uv1, input.uv2,<font></font>
                        unity_LightmapST, unity_DynamicLightmapST);<font></font>
                    output.uv = TRANSFORM_TEX(input.uv0, _BaseMap);<font></font>
                    <span class="hljs-keyword">return</span> output;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-function">half4 <span class="hljs-title">LightweightFragmentMeta</span><span class="hljs-params">(Varyings input)</span> : SV_Target
                </span>{<font></font>
                    SurfaceData surfaceData;<font></font>
                    InitializeStandardLitSurfaceData(input.uv, surfaceData);<font></font>
<font></font>
                    BRDFData brdfData;<font></font>
                    InitializeBRDFData(surfaceData.albedo, surfaceData.metallic, surfaceData.specular, surfaceData.smoothness, surfaceData.alpha, brdfData);<font></font>
<font></font>
                    MetaInput metaInput;<font></font>
                    metaInput.Albedo = brdfData.diffuse + brdfData.specular * brdfData.roughness * <span class="hljs-number">0.5</span>;<font></font>
                    metaInput.SpecularColor = surfaceData.specular;<font></font>
                    metaInput.Emission = surfaceData.emission;<font></font>
<font></font>
                    <span class="hljs-keyword">return</span> MetaFragment(metaInput);<font></font>
                }<font></font>
                <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
            Pass<font></font>
            {<font></font>
                Name <span class="hljs-string">"Lightweight2D"</span>
                Tags{ <span class="hljs-string">"LightMode"</span> = <span class="hljs-string">"Lightweight2D"</span> }<font></font>
<font></font>
                Blend[_SrcBlend][_DstBlend]<font></font>
                ZWrite[_ZWrite]<font></font>
                Cull[_Cull]<font></font>
<font></font>
                HLSLPROGRAM<font></font>
                <span class="hljs-comment">// Required to compile gles 2.0 with standard srp library</span><font></font>
                #pragma prefer_hlslcc gles<font></font>
                #pragma exclude_renderers d3d11_9x<font></font>
<font></font>
                #pragma vertex vert<font></font>
                #pragma fragment frag<font></font>
                #pragma shader_feature _ALPHATEST_ON<font></font>
                #pragma shader_feature _ALPHAPREMULTIPLY_ON<font></font>
<font></font>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/LitInput.hlsl"</span>
                #include <span class="hljs-string">"Packages/com.unity.render-pipelines.lightweight/Shaders/Utils/Lightweight2D.hlsl"</span><font></font>
                ENDHLSL<font></font>
            }<font></font>
<font></font>
<font></font>
            }<font></font>
                FallBack <span class="hljs-string">"Hidden/InternalErrorShader"</span>
                CustomEditor <span class="hljs-string">"UnityEditor.Rendering.LWRP.ShaderGUI.LitShaderEditor"</span><font></font>
}<font></font>
</code></pre></div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、ここで在庫を取る時間です。</font><font style="vertical-align: inherit;">明らかになったように、LWRPでは、コードを使用してシェーダーを作成することが可能であり、必要な場合さえあります。これは、手を離して、照明システムなど松葉杖なしでクールなものを作成するのに役立つためです。</font><font style="vertical-align: inherit;">もちろん、これは便利でおなじみの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">標準サーフェスシェーダー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と比較することはできませんが</font><font style="vertical-align: inherit;">、いつかLWRPとHDRPで同じ便利なアナログを書くようになるかもしれませんが、それについては別の機会に詳しく説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
役立つリンク：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事のすべての資料を含むリポジトリー資料の</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">準備中にこれが見つかりました、非公式のドキュメント</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LWRPのドキュメント</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja485008/index.html">Swiftプロパティラッパー</a></li>
<li><a href="../ja485010/index.html">泣かないで、女の子！ハブレに関する手紙にvc.ruを入れて作者に返信する</a></li>
<li><a href="../ja485012/index.html">JavaScriptとReactjsでControl Inversionを使用してコード処理を簡素化する方法</a></li>
<li><a href="../ja485014/index.html">インタビューについて文句を言うべきですか？</a></li>
<li><a href="../ja485016/index.html">Selectelのマネージドデータベース：Welcome to Beta</a></li>
<li><a href="../ja485022/index.html">Playme Sigma：機能的で手頃な価格のDVR</a></li>
<li><a href="../ja485024/index.html">GraalVMコンパイラーの最適化の背後には何がありますか？</a></li>
<li><a href="../ja485026/index.html">ジョージア州のIT専門家の機会</a></li>
<li><a href="../ja485028/index.html">CRM 2020</a></li>
<li><a href="../ja485030/index.html">トップ8 IEO料金と資本金</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>