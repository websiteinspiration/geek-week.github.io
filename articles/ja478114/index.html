<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💣 📗 🌈 Schemathesis：APIスキーマのプロパティベースのテスト 👨‍❤️‍💋‍👨 👩🏾‍🤝‍👩🏻 🦓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="写真クリス・キーツのUnsplash
 

私たちを含む多くの企業は、スケーラビリティの向上と開発サイクルの高速化のために、モノリスからマイクロサービスに切り替えています。私たちはまだモノリシックなプロジェクトを持っていますが、それらは次第に一連の小さくてきちんとしたマイクロサービスに置き換えられて...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Schemathesis：APIスキーマのプロパティベースのテスト</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478114/"><p><img src="https://habrastorage.org/webt/yu/fw/w8/yufww8clxjcmtho2brj373fdubu.jpeg" alt="画像"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写真</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリス・キーツ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unsplash</font></font></a></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちを含む多くの企業は、スケーラビリティの向上と開発サイクルの高速化のために、モノリスからマイクロサービスに切り替えています。</font><font style="vertical-align: inherit;">私たちはまだモノリシックなプロジェクトを持っていますが、それらは次第に一連の小さくてきちんとしたマイクロサービスに置き換えられています。</font></font></p><br>
<p>   Open API 3.0         .     ,      ,       ,         .</p><br>
<p>            ,                     .</p><a name="habracut"></a><br>
<hr><br>
<p>   Open API 3.0     , (    Swagger 2.0)  ,          .     ,          ,           .</p><br>
<p>           .  :</p><br>
<ul>
<li> ,  ;</li>
<li>    (,  ,<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> apispec</a>);</li>
<li>     (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">connexion</a>);</li>
</ul><br>
<p>       1:1            .         ,           —     ,      .</p><br>
<p>    ,   ,   ,    ,      .</p><br>
<hr><br>
<p>             ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Zally</a>  Zalando),    ,             .</p><br>
<p>, example-based          ,           .           , -         ,          .</p><br>
<p>     property-based  (PBT)  Open API .    ,     Haskell  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">QuickCheck</a> Koen Claessen  John Hughes  1999 .    PBT      ,  Python,     .   ,    Hypothesis   David R. MacIver.</p><br>
<p>     ,      ,           .    ,          ,      .     ,      .</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/fffbec1dbb2958a49cbc142a794ea232.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99360581" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-add-py" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-add-py-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-add-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">add</span>(<span class="pl-s1">a</span>, <span class="pl-s1">b</span>):</td>
      </tr>
      <tr>
        <td id="file-add-py-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-add-py-LC2" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">a</span> <span class="pl-c1">+</span> <span class="pl-s1">b</span></td>
      </tr>
      <tr>
        <td id="file-add-py-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-add-py-LC3" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-add-py-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-add-py-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-add-py-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-add-py-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">test_add</span>(<span class="pl-s1">a</span>, <span class="pl-s1">b</span>):</td>
      </tr>
      <tr>
        <td id="file-add-py-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-add-py-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">assert</span> <span class="pl-en">add</span>(<span class="pl-s1">a</span>, <span class="pl-s1">b</span>) <span class="pl-c1">==</span> <span class="pl-en">add</span>(<span class="pl-s1">b</span>, <span class="pl-s1">a</span>)</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">add.py</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p>  , Hypothesis   ,       :</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/16e8ba494bd849b973f190c5673104fd.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99360616" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-hypothesis-py" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-hypothesis-py-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-hypothesis-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">from</span> <span class="pl-s1">hypothesis</span> <span class="pl-k">import</span> <span class="pl-s1">strategies</span> <span class="pl-k">as</span> <span class="pl-s1">st</span>, <span class="pl-s1">given</span></td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-hypothesis-py-LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-hypothesis-py-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-v">NUMBERS</span> <span class="pl-c1">=</span> <span class="pl-s1">st</span>.<span class="pl-en">integers</span>() <span class="pl-c1">|</span> <span class="pl-s1">st</span>.<span class="pl-en">floats</span>()</td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-hypothesis-py-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-hypothesis-py-LC5" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-hypothesis-py-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-en">@<span class="pl-s1">given</span>(<span class="pl-s1">a</span><span class="pl-c1">=</span><span class="pl-v">NUMBERS</span>, <span class="pl-s1">b</span><span class="pl-c1">=</span><span class="pl-v">NUMBERS</span>)</span></td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-hypothesis-py-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">test_add</span>(<span class="pl-s1">a</span>, <span class="pl-s1">b</span>):</td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-hypothesis-py-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">assert</span> <span class="pl-en">add</span>(<span class="pl-s1">a</span>, <span class="pl-s1">b</span>) <span class="pl-c1">==</span> <span class="pl-en">add</span>(<span class="pl-s1">b</span>, <span class="pl-s1">a</span>)</td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-hypothesis-py-LC9" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-hypothesis-py-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-hypothesis-py-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># Falsifying example: test_add(a=0, b=nan)</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">hypothesis.py</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p>PBT           .       API ?</p><br>
<p>,        ,  :</p><br>
<ul>
<li>  ;</li>
<li>     ,     ;</li>
<li>       ;</li>
</ul><br>
<p>    :</p><br>
<ul>
<li>    ,   ;</li>
<li>     HTTP ;</li>
<li>      ;</li>
</ul><br>
<p>,            ,    .   ,     ,        PBT.</p><br>
<hr><br>
<p>       ,    Python     — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">swagger-conformance</a>,    .     Open API           swagger-conformance.      — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">hypothesis-jsonschema</a>,      Hypothesis — Zac Hatfield-Dodds.   ,    .      Python   ,   .</p><br>
<p>    Open API  JSON Schema    ,          .             Hypothesis, hypothesis-jsonschema  pytest,     Open API  Swagger .</p><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Schemathesis</a>,         Testing Platform   Kiwi.com.  :</p><br>
<ul>
<li> Open API &amp; Swagger   JSON Schema;</li>
<li> hypothesis-jsonschema    Hypothesis ;</li>
<li>    CLI  Python </li>
</ul><br>
<p>Schemathesis                        .</p><br>
<p>          :</p><br>
<ul>
<li>  ;</li>
<li>    ;</li>
<li>   WSGI ;</li>
<li>     ;</li>
<li>     ,       ;</li>
</ul><br>
<p>    Schemathesis           .               .          API  ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> https://github.com/Stranger6667/schemathesis-example</a>.    ,              Schemathesis.</p><br>
<p>   :</p><br>
<ul>
<li><code>POST /api/bookings</code>  —   </li>
<li><code>GET /api/bookings/{booking_id}/ </code> —     ID</li>
</ul><br>
<p>    ,      <code>127.0.0.1:8080</code>.</p><br>
<p>Schemathesis      command-line    Python ,       ,     .<br>
         .  Booking    :</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/fca69738e11d2c86b8bb5454bb735587.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99361843" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-booking_v1-yaml" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-yaml ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-booking_v1-yaml-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-booking_v1-yaml-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">components</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-booking_v1-yaml-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">schemas</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-booking_v1-yaml-LC3" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">Booking</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-booking_v1-yaml-LC4" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">properties</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-booking_v1-yaml-LC5" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">id</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-booking_v1-yaml-LC6" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">type</span>: <span class="pl-s">integer</span></td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-booking_v1-yaml-LC7" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">name</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-booking_v1-yaml-LC8" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">type</span>: <span class="pl-s">string</span></td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-booking_v1-yaml-LC9" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">is_active</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-booking_v1-yaml-LC10" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">type</span>: <span class="pl-s">boolean</span></td>
      </tr>
      <tr>
        <td id="file-booking_v1-yaml-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-booking_v1-yaml-LC11" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">type</span>: <span class="pl-s">object</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">booking_v1.yaml</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p>Open API 3  Booking </p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/342ddc27b3b183916a95aeb9dba08b52.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99361860" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-booking_db-sql" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-sql ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-booking_db-sql-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-booking_db-sql-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">CREATE</span> <span class="pl-k">TABLE</span> <span class="pl-en">bookings</span> (</td>
      </tr>
      <tr>
        <td id="file-booking_db-sql-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-booking_db-sql-LC2" class="blob-code blob-code-inner js-file-line">    id <span class="pl-k">INTEGER</span> <span class="pl-k">PRIMARY KEY</span>,</td>
      </tr>
      <tr>
        <td id="file-booking_db-sql-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-booking_db-sql-LC3" class="blob-code blob-code-inner js-file-line">    name <span class="pl-k">VARCHAR</span>(<span class="pl-c1">30</span>),</td>
      </tr>
      <tr>
        <td id="file-booking_db-sql-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-booking_db-sql-LC4" class="blob-code blob-code-inner js-file-line">    is_active <span class="pl-k">BOOLEAN</span></td>
      </tr>
      <tr>
        <td id="file-booking_db-sql-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-booking_db-sql-LC5" class="blob-code blob-code-inner js-file-line">);</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">booking_db.sql</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p>   .</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/59325ba758a750215348d0493c05c169.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99361908" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-create_booking-py" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-create_booking-py-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-create_booking-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># models.py</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-create_booking-py-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">import</span> <span class="pl-s1">attr</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-create_booking-py-LC3" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-create_booking-py-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-en">@<span class="pl-s1">attr</span>.<span class="pl-s1">s</span>(<span class="pl-s1">slots</span><span class="pl-c1">=</span><span class="pl-c1">True</span>)</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-create_booking-py-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">class</span> <span class="pl-v">Booking</span>:</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-create_booking-py-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">id</span>: <span class="pl-s1">int</span> <span class="pl-c1">=</span> <span class="pl-s1">attr</span>.<span class="pl-en">ib</span>()</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-create_booking-py-LC7" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">name</span>: <span class="pl-s1">str</span> <span class="pl-c1">=</span> <span class="pl-s1">attr</span>.<span class="pl-en">ib</span>()</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-create_booking-py-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">is_active</span>: <span class="pl-s1">bool</span> <span class="pl-c1">=</span> <span class="pl-s1">attr</span>.<span class="pl-en">ib</span>()</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-create_booking-py-LC9" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-create_booking-py-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">asdict</span> <span class="pl-c1">=</span> <span class="pl-s1">attr</span>.<span class="pl-s1">asdict</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-create_booking-py-LC11" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-create_booking-py-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># db.py</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-create_booking-py-LC13" class="blob-code blob-code-inner js-file-line"><span class="pl-k">from</span> . <span class="pl-k">import</span> <span class="pl-s1">models</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-create_booking-py-LC14" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-create_booking-py-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-k">async</span> <span class="pl-k">def</span> <span class="pl-en">create_booking</span>(<span class="pl-s1">pool</span>, *, <span class="pl-s1">booking_id</span>: <span class="pl-s1">int</span>, <span class="pl-s1">name</span>: <span class="pl-s1">str</span>, <span class="pl-s1">is_active</span>: <span class="pl-s1">bool</span>) -&gt; <span class="pl-s1">models</span>.<span class="pl-v">Booking</span>:</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-create_booking-py-LC16" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">row</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-s1">pool</span>.<span class="pl-en">fetchrow</span>(</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-create_booking-py-LC17" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"INSERT INTO bookings (id, name, is_active) VALUES ($1, $2, $3) RETURNING *"</span>, </td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-create_booking-py-LC18" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">booking_id</span>, <span class="pl-s1">name</span>, <span class="pl-s1">is_active</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-create_booking-py-LC19" class="blob-code blob-code-inner js-file-line">    )</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-create_booking-py-LC20" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">models</span>.<span class="pl-v">Booking</span>(<span class="pl-c1">**</span><span class="pl-s1">row</span>)</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-create_booking-py-LC21" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-create_booking-py-LC22" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># views.py</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-create_booking-py-LC23" class="blob-code blob-code-inner js-file-line"><span class="pl-k">from</span> <span class="pl-s1">aiohttp</span> <span class="pl-k">import</span> <span class="pl-s1">web</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-create_booking-py-LC24" class="blob-code blob-code-inner js-file-line"><span class="pl-k">from</span> . <span class="pl-k">import</span> <span class="pl-s1">db</span></td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-create_booking-py-LC25" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-create_booking-py-LC26" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-create_booking-py-LC27" class="blob-code blob-code-inner js-file-line"><span class="pl-k">async</span> <span class="pl-k">def</span> <span class="pl-en">create_booking</span>(<span class="pl-s1">request</span>: <span class="pl-s1">web</span>.<span class="pl-v">Request</span>, <span class="pl-s1">body</span>) -&gt; <span class="pl-s1">web</span>.<span class="pl-v">Response</span>:</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-create_booking-py-LC28" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">booking</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-s1">db</span>.<span class="pl-en">create_booking</span>(</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-create_booking-py-LC29" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">request</span>.<span class="pl-s1">app</span>[<span class="pl-s">"db"</span>], <span class="pl-s1">booking_id</span><span class="pl-c1">=</span><span class="pl-s1">body</span>[<span class="pl-s">"id"</span>], <span class="pl-s1">name</span><span class="pl-c1">=</span><span class="pl-s1">body</span>[<span class="pl-s">"name"</span>], <span class="pl-s1">is_active</span><span class="pl-c1">=</span><span class="pl-s1">body</span>[<span class="pl-s">"is_active"</span>]</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-create_booking-py-LC30" class="blob-code blob-code-inner js-file-line">    )</td>
      </tr>
      <tr>
        <td id="file-create_booking-py-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-create_booking-py-LC31" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">web</span>.<span class="pl-en">json_response</span>(<span class="pl-s1">booking</span>.<span class="pl-en">asdict</span>())</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">create_booking.py</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p> Python </p><br>
<p>        ?</p><br>
<p>  Schemathesis     :</p><br>
<pre><code class="bash hljs">$ schemathesis run<font></font>
-M POST<font></font>
-E /bookings/<font></font>
http://0.0.0.0:8080/api/openapi.json</code></pre><br>
<p>  , <code>--method</code>  <code>--endpoint</code>         .</p><br>
<p><img src="https://habrastorage.org/webt/lq/jp/bo/lqjpbojstkgjw8ql5ukd5sm-t5m.png"></p><br>
<p>Schemathesis CLI   Python ,        ,         Hypothesis,      .          :</p><br>
<pre><code class="plaintext hljs">File "/example/views.py", line 13, in create_booking<font></font>
   request.app["db"], booking_id=body["id"], name=body["name"], is_active=body["is_active"]<font></font>
KeyError: 'id'</code></pre><br>
<p>  ,    <code>id</code>      .</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/7332aff208565ff1b4bf755836e476a4.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99361975" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-booking_v2-yaml" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-yaml ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-booking_v2-yaml-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-booking_v2-yaml-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">components</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-booking_v2-yaml-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">schemas</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-booking_v2-yaml-LC3" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">Booking</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-booking_v2-yaml-LC4" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">properties</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-booking_v2-yaml-LC5" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">id</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-booking_v2-yaml-LC6" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">type</span>: <span class="pl-s">integer</span></td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-booking_v2-yaml-LC7" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">name</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-booking_v2-yaml-LC8" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">type</span>: <span class="pl-s">string</span></td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-booking_v2-yaml-LC9" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">is_active</span>:</td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-booking_v2-yaml-LC10" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">type</span>: <span class="pl-s">boolean</span></td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-booking_v2-yaml-LC11" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">type</span>: <span class="pl-s">object</span></td>
      </tr>
      <tr>
        <td id="file-booking_v2-yaml-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-booking_v2-yaml-LC12" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">required</span>: <span class="pl-s">[id, name, is_active]</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">booking_v2.yaml</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p>        :</p><br>
<p><img src="https://habrastorage.org/webt/ut/gp/dp/utgpdpdppx1hzmmwbn0ylyhkloy.png"></p><br>
<p> !     :</p><br>
<pre><code class="plaintext hljs">asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "bookings_pkey"<font></font>
DETAIL:  Key (id)=(0) already exists.</code></pre><br>
<p>,              ID ! ,       —  ,      ..</p><br>
<p>          ,  PBT         .</p><br>
<p> , Schemathesis       Python .        —       .      .</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/7039f20fbfa8e8bda2376c83c90b5aba.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99362227" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-get_booking-yaml" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-yaml ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-get_booking-yaml-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-get_booking-yaml-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">paths</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-get_booking-yaml-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">/bookings/{booking_id}</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-get_booking-yaml-LC3" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">parameters</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-get_booking-yaml-LC4" class="blob-code blob-code-inner js-file-line">      - <span class="pl-ent">description</span>: <span class="pl-s">Booking ID to retrieve</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-get_booking-yaml-LC5" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">in</span>: <span class="pl-s">path</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-get_booking-yaml-LC6" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">name</span>: <span class="pl-s">booking_id</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-get_booking-yaml-LC7" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">required</span>: <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-get_booking-yaml-LC8" class="blob-code blob-code-inner js-file-line">        <span class="pl-ent">schema</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-get_booking-yaml-LC9" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">format</span>: <span class="pl-s">int32</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-get_booking-yaml-LC10" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">type</span>: <span class="pl-s">integer</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-get_booking-yaml-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">get</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-get_booking-yaml-LC12" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">summary</span>: <span class="pl-s">Get a booking by ID</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-get_booking-yaml-LC13" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">operationId</span>: <span class="pl-s">example.views.get_booking_by_id</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-get_booking-yaml-LC14" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">responses</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-get_booking-yaml-LC15" class="blob-code blob-code-inner js-file-line">        <span class="pl-s"><span class="pl-pds">"</span><span class="pl-ent">200</span><span class="pl-pds">"</span></span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-yaml-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-get_booking-yaml-LC16" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">description</span>: <span class="pl-s">OK</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">get_booking.yaml</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p> Open API 3</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/28c49f84f45cda690bb514ce4724dd03.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99362258" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-get_booking-py" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-get_booking-py-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-get_booking-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># db.py</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-get_booking-py-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">async</span> <span class="pl-k">def</span> <span class="pl-en">get_booking_by_id</span>(<span class="pl-s1">pool</span>, *, <span class="pl-s1">booking_id</span>: <span class="pl-s1">int</span>) -&gt; <span class="pl-v">Optional</span>[<span class="pl-s1">models</span>.<span class="pl-v">Booking</span>]:</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-get_booking-py-LC3" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">row</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-s1">pool</span>.<span class="pl-en">fetchrow</span>(</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-get_booking-py-LC4" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"SELECT * FROM bookings WHERE id = $1"</span>, <span class="pl-s1">booking_id</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-get_booking-py-LC5" class="blob-code blob-code-inner js-file-line">    )</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-get_booking-py-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> <span class="pl-s1">row</span> <span class="pl-c1">is</span> <span class="pl-c1">not</span> <span class="pl-c1">None</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-get_booking-py-LC7" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">return</span> <span class="pl-s1">models</span>.<span class="pl-v">Booking</span>(<span class="pl-c1">**</span><span class="pl-s1">row</span>)</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-get_booking-py-LC8" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-get_booking-py-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># views.py</span></td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-get_booking-py-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-k">async</span> <span class="pl-k">def</span> <span class="pl-en">get_booking_by_id</span>(<span class="pl-s1">request</span>: <span class="pl-s1">web</span>.<span class="pl-v">Request</span>, <span class="pl-s1">booking_id</span>: <span class="pl-s1">int</span>) -&gt; <span class="pl-s1">web</span>.<span class="pl-v">Response</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-get_booking-py-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">booking</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-s1">db</span>.<span class="pl-en">get_booking_by_id</span>(<span class="pl-s1">request</span>.<span class="pl-s1">app</span>[<span class="pl-s">"db"</span>], <span class="pl-s1">booking_id</span><span class="pl-c1">=</span><span class="pl-s1">booking_id</span>)</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-get_booking-py-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> <span class="pl-s1">booking</span> <span class="pl-c1">is</span> <span class="pl-c1">not</span> <span class="pl-c1">None</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-get_booking-py-LC13" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-s1">booking</span>.<span class="pl-en">asdict</span>()</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-get_booking-py-LC14" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">else</span>:</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-get_booking-py-LC15" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">data</span> <span class="pl-c1">=</span> {}</td>
      </tr>
      <tr>
        <td id="file-get_booking-py-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-get_booking-py-LC16" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">web</span>.<span class="pl-en">json_response</span>(<span class="pl-s1">data</span>)</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">get_booking.py</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p>   Schemathesis   .    ,        .</p><br>
<p>           — <code>schemathesis.from_&lt;something&gt;</code>. ,      <code>pytest</code> ,      ( <code>schemathesis.from_pytest_fixture</code>      ),           8080 :</p><br>
<div class="oembed"><script type="text/javascript" src="https://gist.github.com/1c76ccc2add71283785ef62bae466768.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist99362088" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-schemathesis_test-py" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-schemathesis_test-py-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-schemathesis_test-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">import</span> <span class="pl-s1">schemathesis</span></td>
      </tr>
      <tr>
        <td id="file-schemathesis_test-py-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-schemathesis_test-py-LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-schemathesis_test-py-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-schemathesis_test-py-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">schema</span> <span class="pl-c1">=</span> <span class="pl-s1">schemathesis</span>.<span class="pl-en">from_uri</span>(<span class="pl-s">"http://0.0.0.0:8080/api/openapi.json"</span>)</td>
      </tr>
      <tr>
        <td id="file-schemathesis_test-py-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-schemathesis_test-py-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-schemathesis_test-py-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-schemathesis_test-py-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-en">@<span class="pl-s1">schema</span>.<span class="pl-s1">parametrize</span>(<span class="pl-s1">method</span><span class="pl-c1">=</span><span class="pl-s">"GET"</span>, <span class="pl-s1">endpoint</span><span class="pl-c1">=</span><span class="pl-s">"/bookings/{booking_id}"</span>)</span></td>
      </tr>
      <tr>
        <td id="file-schemathesis_test-py-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-schemathesis_test-py-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">test_get_booking</span>(<span class="pl-s1">case</span>):</td>
      </tr>
      <tr>
        <td id="file-schemathesis_test-py-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-schemathesis_test-py-LC7" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">case</span>.<span class="pl-en">call</span>()</td>
      </tr>
      <tr>
        <td id="file-schemathesis_test-py-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-schemathesis_test-py-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">assert</span> <span class="pl-s1">response</span>.<span class="pl-s1">status_code</span> <span class="pl-c1">&lt;</span> <span class="pl-c1">500</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">schemathesis_test.py</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>
<p>    schema.parametrize   case    ,               .    :</p><br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; case<font></font>
Case(<font></font>
   path='/bookings/{booking_id}',<font></font>
   method='GET',<font></font>
   base_url='&lt;a href="http://0.0.0.0:8080/api%27"&gt;http://0.0.0.0:8080/api'&lt;/a&gt;,<font></font>
   path_parameters={'booking_id': 2147483648},<font></font>
   headers={},<font></font>
   cookies={},<font></font>
   query={},<font></font>
   body=None,<font></font>
   form_data={}<font></font>
)</code></pre><br>
<p><code>Case.call()</code>            <code>requests</code>.</p><br>
<p>     <code>pytest</code> ( <code>unittest</code>  ):</p><br>
<pre><code class="bash hljs">$ pytest test_example.py -v</code></pre><br>
<p><img src="https://habrastorage.org/webt/na/wm/dg/nawmdgl_sqqawpg4kzype9xy6_0.png"></p><br>
<p>   :</p><br>
<pre><code class="plaintext hljs">asyncpg.exceptions.DataError: <font></font>
invalid input for query argument $1: 2147483648 (value out of int32 range)</code></pre><br>
<p>        ,         .  <code>format: int32</code>  —      .</p><br>
<hr><br>
<p>         ,   ,   ,    .   , Schemathesis  property-based          .        :</p><br>
<ul>
<li>    ;</li>
<li>  (-   );</li>
<li>DoS  ( -   );</li>
<li>     ( -        );</li>
<li>     .</li>
</ul><br>
<p>     , ,             .                 ,    PagerDuty  .</p><br>
<p>                 <code>Schemathesis</code>, <code>Hypothesis</code>, <code>hypothesis-jsonschema</code>  <code>pytest</code>,        .     .</p><br>
<p>  !</p><br>
<p>    Gitter ,           — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://gitter.im/kiwicom/schemathesis</a></p><br>
<p><strong></strong>:</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Apispec</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Connexion</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Zally</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">QuickCheck</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Hypothesis</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Swagger-conformance</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Hypothesis-jsonschema </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Schemathesis</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトの例</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja478098/index.html">「スマート」スピーカーからの「ハッカーサイバー兵器」と、高品質のネタバレが科学とITジャーナリズムを台無しにした方法について</a></li>
<li><a href="../ja478100/index.html">将来の鉄道はどうなるのでしょうか？</a></li>
<li><a href="../ja478104/index.html">今週の結果：GoogleはAIで成功していますが、Stadiaではうまくいきません。Durovが訴えられ、農家がVRをテストしています</a></li>
<li><a href="../ja478106/index.html">「完全な」GUIを検索します。初心者向け</a></li>
<li><a href="../ja478110/index.html">モバイルCICDエクスペリエンス：多くのモバイルアプリケーションのための1つのFastlane標準</a></li>
<li><a href="../ja478116/index.html">電気自動車GACイーノ146</a></li>
<li><a href="../ja478118/index.html">SamsPcbGuideパート13：IBISモデルの使用</a></li>
<li><a href="../ja478120/index.html">Lee SedollはAlphaGoのためにBig Goを離れます。どういう意味ですか？</a></li>
<li><a href="../ja478122/index.html">アリスはすべてを覚えています</a></li>
<li><a href="../ja478124/index.html">C ++プログラムをコンパイルするプロセス</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>