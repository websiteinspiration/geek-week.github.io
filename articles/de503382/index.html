<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüéì ‚úîÔ∏è üéπ Gehen Sie auf einem sauberen Feld spazieren oder sammeln Sie MAC-Adressen von Wi-Fi-Ger√§ten in der N√§he ‚ò¢Ô∏è üõÇ üë®‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich beginne alle meine √∂ffentlichen Reden (zum Gl√ºck gibt es nicht so viele) mit der expliziten oder impliziten Erw√§hnung der These: ‚ÄûUnsere Branche i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Gehen Sie auf einem sauberen Feld spazieren oder sammeln Sie MAC-Adressen von Wi-Fi-Ger√§ten in der N√§he</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503382/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich beginne alle meine √∂ffentlichen Reden (zum Gl√ºck gibt es nicht so viele) mit der expliziten oder impliziten Erw√§hnung der These: ‚ÄûUnsere Branche ist komplex, Probleme k√∂nnen bei jedem, selbst dem offensichtlichsten Schritt aufgedeckt werden, und es ist optimistisch anzunehmen, dass alles einfach und leicht sein wird - naiv.‚Äú . Seltsamerweise ist diese einfache Idee, die durch jahrelanges F√ºllen von Zapfen erhalten wurde, manchmal eine Offenbarung f√ºr erfahrene Fachleute, obwohl es den Anschein hat, als ob all die hektische Begeisterung und der Glaube an die Unfehlbarkeit ihrer eigenen Ideen und Praktiken lange Zeit verwittert sein sollten. Ich erz√§hle Ihnen eine Geschichte dar√ºber, ein Beispiel f√ºr ein einfaches Projekt auf den ersten Blick.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/vd/fg/lyvdfgr98fqlrow-vtmumb4ucbw.jpeg"><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eines sch√∂nen Tages warf mir ein Freund einen Link zu einem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interessanten Startup</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Die Jungs schlugen vor, dass Vertreter kleiner Unternehmen aus dem Service- und Vertriebssektor einen Zugangspunkt (mit einem Captive-Portal) f√ºr ihre Kunden einrichten, um das Internet zu verbreiten und gleichzeitig die MAC-Adressen von Smartphones vorbeikommender Personen zu sammeln. Der Zweck dieser Aktion ist sehr einfach: Mit einer gro√üen Anzahl von Werbenetzwerken k√∂nnen Sie auf die Liste der Ger√§teadressen zielen. Wenn Sie die Werbefirma an vorbeikommende Benutzer weiterleiten, werden wir h√∂chstwahrscheinlich neue Besucher empfangen (weil sie nahe ist und "irgendwo habe ich sie bereits gesehen"). . Jene. eine solche Verteilung von virtuellen Flyern. Ein Freund fragte, wie das gemacht wird und ob wir das wieder machen k√∂nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein kurzes Googeln zu diesem Thema enth√ºllte den Mechanismus einer solchen Datenerfassung. Der WiFi-Adapter wurde im Air Listening-Modus gestartet und lief durch die Kan√§le, um Pakete zu erfassen, zu analysieren und die empfangenen Daten zu aggregieren. Es gab auch fertige offene Dienstprogramme daf√ºr, zum Beispiel Airodump-ng von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aircrack-ng</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jene. Zur Wiederholung m√ºssen wir dieses Dienstprogramm nur ausf√ºhren, vorzugsweise auf einem separaten kompakten und tragbaren Ger√§t, und die empfangenen Daten in die Datenbank verschieben, aus der wir dann vorgefertigte Listen mit MAC-Adressen f√ºr Werbenetzwerke erhalten. Es scheint, dass die Aufgabe einfach ist, h√∂chstens an einem - zwei Abenden gem√§chlicher Arbeit, fast alles ist fertig. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies war nat√ºrlich nie der Fall.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie wissen, ist das, was Jupiter erlaubt ist, dem Bullen nicht erlaubt. </font><font style="vertical-align: inherit;">Und wenn Einzelzahler eingesetzt werden, m√ºssen Sie zun√§chst Rechenressourcen und Speicher opfern. </font><font style="vertical-align: inherit;">Auf das Opfer von Ressourcen folgt das Opfer von Entwicklungs- und Debugging-Komfort - nicht jedes System erm√∂glicht das Ziehen von Kompilierungswerkzeugen auf das Ger√§t. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anfangs wollten wir etwas Einfaches und Billiges nehmen, zum Beispiel </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Orange Pi Zero-</font></a><font style="vertical-align: inherit;"> Boxen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Legen Sie dort airodump-ng ab und leiten Sie die vom Dienstprogramm ausgegebenen Daten an den Server weiter, wo sie sicher in die Datenbank gestellt werden k√∂nnen. </font><font style="vertical-align: inherit;">Ich hatte Erfahrung mit solchen verteilten Systemen mit einem dedizierten Zentrum (obwohl dort virtuelle Maschinen als Arbeitspferde fungierten und √ºber die Cloud-API durch dasselbe Zentrum wie erforderlich, aber nicht durch den Punkt gehoben wurden), sodass ein Teil des Codes erfolgreich in ein neues Projekt migriert wurde .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Tool zum Weiterleiten von Daten an den Server war die einfachste geschriebene Erlang-Anwendung, die Daten aus dem Ether-D√§mpfer ziehen (analysieren), serialisieren (Erlangs native Serialisierung) und √ºber den Web-Socket √ºber HTTPS an den Server √ºbertragen sollte (ohne Verdacht zu erregen) DPI-Systeme und keine eigenen Protokolle erfinden). Die im Orange Pi verwendeten Allwinner H2 + -Prozessoren sind leistungsstark genug, um direkt auf dem Ger√§t zusammengebaut und debuggt zu werden. Auch hier ist theoretisch alles in Ordnung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Praxis hat begonnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Wie sich herausstellte, war das integrierte WLAN in Orange Pi nur gut geeignet, um einen Zugangspunkt aufzunehmen und Daten auf den Server zu werfen. Genauer gesagt, nicht der Adapter selbst, sondern die Unterst√ºtzung seines Chipsatzes im Kernel. F√ºr die meisten IoT-Projekte w√ºrde dies wahrscheinlich ausreichen. Wir waren jedoch bereit f√ºr diesen Schlag, da eine vorl√§ufige Studie der Aircrack-ng-Website eine sehr klare und zweideutige Aussage ergab: "Es wird nicht √ºberall funktionieren. Wenn dies nicht unsere Schuld ist, werden wir eine Liste der getesteten Chips√§tze beif√ºgen." Fast alle Atheros-Ger√§te (von Qualcomm gekauft) und Ralink (von MediaTek gekauft) wurden in der Liste gefunden, was einige Aussichten f√ºr den √úbergang von uners√§ttlichen chinesischen ARMs zu asketischeren MIPS von den Chips√§tzen f√ºr Router inspirierte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber w√§hrend dies alles von Rotz und St√∂cken geht, d.h. Prototyp - Sie m√ºssen das Problem hier und jetzt l√∂sen. Daher haben wir solche Exoten in unserer technologischen Zeit (wenn die drahtlose Kommunikation leichter ist) als Wi-Fi-USB-Adapter genutzt. Das Studium der Kompatibilit√§tsliste und der Vergleich mit dem Sortiment des n√§chstgelegenen Gesch√§fts ergab ein Opfer - den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLink DWA-160</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Revision C1 (dies ist wichtig, da andere Hardware-Revisionen einen anderen Chip verwendeten und Kopfschmerzen bei der Durchsetzung der Arbeit verursachten). Dual-Band, bei dem nicht mit dem Fahrer getanzt werden muss, da die Unterst√ºtzung schon lange im Kernel vorhanden ist, hat sich diese Pfeife sp√§ter bei anderen Projekten als n√ºtzlich erwiesen. Deshalb habe ich sie gekauft, wahrscheinlich alle (f√ºnf St√ºcke), die in unserer Provinzstadt erh√§ltlich waren.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bl/7t/z7/bl7tz7yaohb2gfeh1ekkjha31us.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem ich sichergestellt hatte, dass das Ger√§t funktioniert, verband ich es mit einem Einplatinenger√§t und schaltete den integrierten WLAN-Adapter aus, mit der Erwartung, dass das Internet √ºber die Ethernet-Schnittstelle verf√ºgbar sein w√ºrde. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cy/em/nk/cyemnk-n5d2lzg1aximnuzddg4q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das zweite Schwein wurde durch Luftknacken gelegt. Diese Dienstprogramme wurden mit dem Ziel des </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hackens erstellt.</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WiFi-Penetrationspr√ºfungen, d.h. wurde von Hackern f√ºr Hacker geschrieben. Ich wei√ü nicht, dank welcher Logik sie es vorgezogen haben, den drahtlosen √Ñtherkipper nicht in Form eines herk√∂mmlichen Unix-Way-Ansatzes zu verwenden, um strukturierten Text zur weiteren Verarbeitung auszuspucken, sondern um eine vollwertige Begriffsschnittstelle zu erstellen, auf der Informationen in nahezu Echtzeit angezeigt werden k√∂nnen (und die Terminaleinstellungen ber√ºcksichtigt werden). von entdeckten Netzwerken und Ger√§ten, aber genau das haben sie getan. Ja, ich fand die Python-API mit einem unbekannten Grad an Bereitschaft f√ºr all dies, aber die Prototyping-Spinne, die in meinem Kopf lebte, verbot strengstens, eine andere Sprache zu ziehen und zu einer anderen zu wechseln (wir erinnern uns, der Serverteil war bereits teilweise fertig und geschrieben war weit entfernt von Python-e) oder, Gott bewahre, implementieren Sie Airodumping auf der Basis von tcpdump. Und folglichIch musste nach Problemumgehungen suchen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gl√ºcklicherweise begannen drahtlose Hacker, etwas zu vermuten, das in der Benutzeroberfl√§che st√§ndig dumm ist, und implementierten daher das regelm√§√üige Hochladen von allem, was in Form von CSV-Dateien gefunden und aggregiert wurde. Mit einem festgelegten Intervall. Du kannst schon damit leben. Nat√ºrlich wurde die naive Option - das Dienstprogramm auszuf√ºhren und die Datei auf einem Timer erneut zu lesen - sofort von Hand gegeben. Bei der Arbeit an einem Laptop schlug die √úbertragung auf eine einzelne Karte beim Lesen der Datei aus offensichtlichen Gr√ºnden fehl - manchmal hatte das Dienstprogramm einfach keine Zeit, alles zu entladen, und einige der Daten gingen unwiederbringlich verloren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die L√∂sung hierf√ºr war der Inotify-Mechanismus im Kernel, der √ºber Dateivorg√§nge informiert. Sobald mein Code die √Ñnderungen an der Datendatei sah, leitete er das Lesen mit einer leichten Verz√∂gerung ein (eher mit einem rein psychologischen Wert, um den Autor zu beruhigen). Die Experimente zeigten, dass in diesem Fall keine Lesefehler und Datenverluste auftreten. Gut, sch√∂n, CSV-Parsim, in interne Strukturen einf√ºgen und an den Server senden. Wir speichern es auf dem Server in PostgreSQL (danke f√ºr jsonb) und danach ist es bereits m√∂glich, Abfragen durchzuf√ºhren, Formulare zu entladen usw. Wir werden die einfachste Autorisierung mithilfe eines symmetrischen Schl√ºssels hinzuf√ºgen, damit wir dort keinen M√ºll stopfen und die Daten an den Punkt binden k√∂nnen, an dem das Ger√§t installiert ist. Alles scheint in Ordnung zu sein. Sie k√∂nnen in den Kampf ziehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, jetzt wie. Die Testanordnung dieser Kette (und das Schreiben und Debuggen von Code dauerte wirklich ein paar Abende) ergab eine lustige Tatsache: Die Anzahl der Adressen, die pro Tag in unserem B√ºro gefangen wurden, schwankte weit genug von √∂ffentlich zug√§nglichen Orten, um ein paar tausend St√ºck. Ja, nat√ºrlich gab es ein kleines Hotel in der N√§he (es war in der Zeit vor der Quarant√§ne, keine √úberraschung), aber es gibt trotzdem viel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe das Wissen √ºber die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Struktur der MAC-Adresse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aktualisiert und daran erinnert, dass mobile Ger√§te h√§ufig lokale Adressen generieren, um ihre wahren MAC-Adressen zu verbergen. Ich habe den Serverteil mit einem einfachen Filter ge√§ndert, der alle Broadcast- und lokalen Adressen am Eingang bereinigt. Die Liste wurde um eine Gr√∂√üenordnung reduziert und sah bereits wie die Wahrheit aus. Alles war bereit f√ºr Feldversuche.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie wissen, funktionieren Prototypen beim Wechsel des Standorts von einem warmen und komfortablen B√ºro zu r√ºcksichtslosen Kampfbedingungen in der Regel nicht mehr normal. Daher sollte der Implementierungsprozess von einem Tascheningenieur begleitet werden, der alle aufkommenden Probleme behebt. Andererseits ist auch bekannt, dass ein Ger√§t, das zu Beginn des Betriebs kein zus√§tzliches Tanzen mit einem Tamburin erfordert, wahrscheinlich bald und unwiderruflich ausf√§llt. Dies spiegelte sich sicherlich in Murphys Gesetzen wider, aber leider ist der Autor dieser Zeilen zu faul, um zu √ºberpr√ºfen, welche, daher werden wir uns auf den Begriff "Gemeinheitsgesetz" einigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erste Installation enth√ºllte sofort eine Reihe von Fehlern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstens verf√ºgen die meisten chinesischen Prototyping-Boards im Gegensatz zu NAND / NOR-Flash-Chips √ºber einen Langzeit-microSD-Speicher. Eine Ausnahme wird nur f√ºr leistungsstarkes SoC gemacht, das f√ºr diese Aufgabe eindeutig redundant ist. Leider ist MicroSD der unmittelbare Kopfschmerz des Bedieners - Oxidation der Pads, Ausfall von SD-Karten, Abh√§ngigkeit der Kontakte von der Temperatur im Inneren des Geh√§uses (was betr√§chtlich ist, die chinesischen Chips sind nicht sehr energieeffizient und die Karten werden h√§ufig vollst√§ndig basierend auf berechnet Spitzenstromverbrauch, also ohne zus√§tzlichen K√ºhler, na ja, auf keinen Fall). Es stellte sich also heraus, dass das System beim Ausschalten des Ger√§ts nicht mehr funktionsf√§hig war - Dateien mit dem ERTS-Bytecode wurden besch√§digt, nachdem die Anwendung nach dem Neustart nicht mehr funktionierte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite unangenehme Moment - zum Zeitpunkt der Installation wurde das Internet von einem LTE-Router bereitgestellt und war, gelinde gesagt, im Gegensatz zu einem B√ºrokabel von mittelm√§√üiger Qualit√§t. Das Netzwerk funkelte st√§ndig, die Anwendung wurde h√§ufig wieder verbunden oder starb sogar an angesammelten Nachrichten in den Warteschlangen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich sind beide Probleme √ºberwindbar. Beispielsweise w√ºrde der Datenverlust durch die Suche nach der optimalen Kombination aus einer guten MicroSD-Karte und den Dateisystemeinstellungen beseitigt, und die Instabilit√§t der Verbindung k√∂nnte durch vorl√§ufige Datenaggregation, kurze Sendesitzungen, rechtzeitige Entladung usw. ausgeglichen werden. Die aufgedeckten Probleme sind jedoch eine Gelegenheit, dar√ºber nachzudenken, ob der richtige Weg gew√§hlt wurde. Die Notwendigkeit einer dauerhaften Verbindung zum Server hat die Ereignisdatenerfassung beendet, wenn das Ger√§t an einen externen Akku geh√§ngt und in einen Rucksack geworfen wird, dessen Besitzer zu einem Massenereignis geht, bei dem Sie nat√ºrlich keine Stabilit√§t der Verbindung erwarten k√∂nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dementsprechend bestand der n√§chste Schritt darin, den Serverteil zu verlassen und das Data Warehouse direkt auf dem Ger√§t zu lokalisieren. Um lange und sehr trostlose Experimente mit SD-Karten zu vermeiden, wurde au√üerdem beschlossen, in der n√§chsten Iteration Steckbrettmodelle mit Flash-Chips zu verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Moment erinnerte ich mich daran, dass es in meiner Sammlung ein wundervolles </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carambola 2-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Brett </font><font style="vertical-align: inherit;">der litauischen Genossen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8Devices gab</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Und wenn Sie zu ihrer Website gehen, finden Sie ein noch kompakteres Ger√§t auf demselben Chip namens </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Centipede</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Fr√ºhere Experimente mit dieser Ger√§teklasse haben gezeigt, dass Erlang vollst√§ndig in die zugewiesenen 16 MB Flash-Speicher passt (und ein wenig f√ºr die Anwendung √ºbrig bleibt). Das einzige Minus (was eher ein Plus ist) ist das MIPS mit geringem Stromverbrauch und die Notwendigkeit einer Kreuzkompilierung, was das Erstellen einer Erlang-Anwendung etwas trivialer macht. Da es sich jedoch bereits um eine bekannte Route handelte, habe ich ein paar Hundertf√º√üer bestellt und bisher die vorhandene Version, die mit dem Server funktioniert, nach Carambol portiert.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ll/x6/sq/llx6sqtfo4vwd4bvbi8tvvcmzsg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als die Komponenten ankamen, begann eine neue Phase. Der AR9331-Chip wurde erfolgreich von Aircrack-ng unterst√ºtzt, Daten k√∂nnen von der Ethernet-Schnittstelle abgerufen werden, die neuesten Versionen von OpenWRT und ERTS wurden gesammelt und erfolgreich getestet. Die Anwendung wurde neu geschrieben - ein Teil des Codes wurde in den Ger√§tecode verschoben, Daten wurden in einem separaten Prozess gesammelt und regelm√§√üig in Form eines serialisierten Erlang-Begriffs in eine Datei geschrieben. Hierzu wurde die einfachste webbasierte Schnittstelle gezeichnet, die Daten √ºber Websocket empf√§ngt. Die Ports f√ºr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inotify</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erlexec werden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit OpenWRT sicher kompiliert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nur eines war verwirrt - 300 Kilobyte blieben in den Daten. Es ist nicht so klein, wenn Sie nur die MAC-Adressen von Client-Ger√§ten speichern, aber airodump-ng bietet Ihnen viel interessantere Informationen, einschlie√ülich Access Point-Adressen, deren ESSIDs usw., an die Sie sich auch gerne erinnern w√ºrden. Nur f√ºr den Fall. Okay, wir werden auf die Umst√§nde reagieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sammeln, pr√ºfen. Ein Problem wird im laufenden Betrieb aufgedeckt. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openwrt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie wir alle wissen, handelt es sich hierbei um einen so minimalistischen Linux-Build, der speziell f√ºr Ger√§te mit begrenztem Speicher entwickelt wurde. Infolgedessen warf es von dort heraus, dass es m√∂glich war, schmerzlos wegzuwerfen, und vereinfachte das, was vereinfacht werden konnte, einschlie√ülich des Mehrspielermodus. Jene. Es ist eine g√§ngige Praxis, wenn der Code von root ausgeht und mit maximalen Berechtigungen arbeitet, was nat√ºrlich Probleme im Zusammenhang mit Gruppen, Benutzern und der Kontrolle ihrer Aktionen erleichtert. Ja, ja, der Buchstabe S in der Abk√ºrzung IoT ist f√ºr die Sicherheit verantwortlich. Das </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Problem</font></a><font style="vertical-align: inherit;"> ist, dass </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erlexec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mit dem ich airodump-ng ausgef√ºhrt und verwaltet habe, kann keine Operationen unter dem Stamm ausf√ºhren. Dazu ben√∂tigt es einen zus√§tzlichen Benutzer, f√ºr den es die ihm zugewiesenen Prozesse erzeugt. Und wenn Sie einen zus√§tzlichen Benutzer mit einer anderen Berechtigungsstufe erstellen ... wird korrekt verhindert, dass Airodump das Netzwerkger√§t erreicht. Das Aufheben dieser Einschr√§nkung aus der Bibliothek schien ein langsamer Prozess zu sein, daher wurde erlexec durch Ports ersetzt - den integrierten Mechanismus zum Starten von Prozessen von Drittanbietern in Erlang. Eine Kleinigkeit, aber unangenehm.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So werden die Ger√§te empfangen, neu geflasht und arbeiten sogar unter Gew√§chshausbedingungen. Wir fangen die Batterie, werfen die Kiste in den Rucksack und gehen ins Einkaufszentrum. Am n√§chsten Tag schauen wir uns das Ergebnis an - ein Fiasko, eine Datendatei mit der L√§nge Null - entweder war nicht gen√ºgend Speicherplatz vorhanden oder eine Verzerrung der Leistung funktionierte nicht in einem sehr guten Moment. Wir korrigieren den Code so, dass das Speichern in zwei Schritten erfolgt - zuerst wurde eine tempor√§re Datei erstellt, dann wurde die aktuelle ersetzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die H√§nde konnten jedoch die Funktionsf√§higkeit dieser Option nicht √ºberpr√ºfen - das n√§chste Spielzeug - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onion Omega2 +</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf dem Mediatek 7688 kam in Sicht. Wie ihre Br√ºder, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der LinkIt Smart 7688-Designer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , gab es </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viele Dinge</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Wichtigste ist jedoch doppelt so viel Flash-Speicher, sodass Sie sich keine Sorgen mehr √ºber den Platzmangel bei der Datenspeicherung machen m√ºssen. okay </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir bestellen, warten. Monat. Zwei. Geduld platzt - wir schreiben an die Amerikaner zum Thema ‚ÄûWo ist die Ware, Zin‚Äú. Stille. Er√∂ffnen Sie einen Streit √ºber PayPal. Die Amerikaner wachen auf. Sie sagen: "Oh, unser Auftragsannahmesystem ist ausgefallen. Jetzt senden wir alles." Sie senden, wir warten drei Wochen. Fuh, das Ger√§t ist zur Hand und funktioniert sogar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yb/3a/ph/yb3aphpjdskqkkfcqlzw25pobuc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier m√ºssen wir einen kleinen Exkurs machen - trotz der Tatsache, dass ich mehrere LinkIt Smart-Boards zu Fu√ü erreichbar hatte, betrachtete ich sie nicht als Plattform, da zu Beginn der Saga ein Versuch, sie als Erfassungsger√§te zu verwenden, fehlschlug. Dann wurden die Treiber f√ºr den Chip in Form von zusammengesetzten Modulen f√ºr bestimmte Versionen des Kernels geliefert, und dies wurde anscheinend zur Ursache f√ºr die Inoperabilit√§t. In den neuesten Versionen von OpenWRT wurden sowohl native Unterst√ºtzung f√ºr 7688 als auch ein offener Treiber angezeigt. Dies ist daher eine Gelegenheit, die Vorgehensweise bei diesen Ger√§ten zu √ºberdenken.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war jedoch √ºblich, WiFi direkt auf dem Chip f√ºr den vorgesehenen Zweck zu verwenden - schlie√ülich ben√∂tigt das Ger√§t mindestens eine Steuerschnittstelle und auch vor Ort, um zu verstehen, ob es funktioniert oder nicht. Es w√§re auch n√ºtzlich, die erhaltenen Daten zu betrachten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dementsprechend kombinieren wir die vorherigen Ans√§tze - wir verwenden die einzige auf dem MiniDoc angezeigte USB-Schnittstelle f√ºr eine WiFi-Pfeife zum Scannen des Raums und das integrierte WiFi -, um das Ger√§t als Zugangspunkt mit geringem Stromverbrauch zu steuern. Wir sammeln, pr√ºfen, alles funktioniert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber der Appetit kommt mit dem Essen. Zun√§chst einmal ist die Datendatei in Form der Erlang-Serialisierung eine Menge echter Maniacs, und ein etwas breiteres Spektrum speziell ausgebildeter Fachkr√§fte ben√∂tigt etwas Einfacheres. Zus√§tzlich zum Hinzuf√ºgen von Daten aus dem Airodump m√∂chte ich auch die genaue Messzeit und vorzugsweise zumindest eine Art Referenz auf den Standort des Ger√§ts im Weltraum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir binden zwischen einer WiFi-Pfeife und einem USB-Hub-Ger√§t ein. Die Einstellungen (und sie h√§ngen bei OpenWRT von der Position des Ger√§ts am Bus ab) sind bewaldet, dies sind jedoch geringf√ºgige Kleinigkeiten. Richtig. Wir nehmen den USB-GPS-Empf√§nger gl√ºcklicherweise bereits erprobt und mit dem geschriebenen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Code</font></a><font style="vertical-align: inherit;"> aus den Tr√ºmmern</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NMEA-0183-Analyse (der Code musste nat√ºrlich trotzdem korrigiert werden). Wir pr√ºfen - das Ger√§t wird vom System nicht sicher erkannt, es fehlen eindeutig die Treiber. Wir sammeln die seriellen USB-Treiber und legen sie auf dem Ger√§t ab - auch Stille. Dann erinnern wir uns, dass in gro√üen Systemen die GPS-Pfeife nicht als ttyUSBx, sondern als ttyACMx erkannt wurde, d.h. USB GSM Modem. Gut, gut, der zweite Aufruf, Treiber hinzuzuf√ºgen, Erfolg.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir nehmen den Code, integrieren ihn in die Anwendung. </font><font style="vertical-align: inherit;">F√ºgen Sie der Anwendung sqlite3 als Speicher hinzu. </font><font style="vertical-align: inherit;">Jetzt ist es nicht mehr erforderlich, die Verf√ºgbarkeit des Datensatzes im Status zu √ºberpr√ºfen, und im Allgemeinen wird die Arbeit mit Daten auf eine kleine Anzahl von Zeilen vereinfacht. </font><font style="vertical-align: inherit;">Alles in allem lernen wir, wenn wir Daten hinzuf√ºgen, um GPS-Messungen durchzuf√ºhren, den JS-Code im Gesicht zu korrigieren, um ihn bei einem unvollst√§ndigen Datensatz anzuzeigen (dies kann passieren, wenn GPS noch keine Satelliten erfasst hat und die Luftscan-Daten bereits eingehen). </font><font style="vertical-align: inherit;">Wir √ºberpr√ºfen die Arbeit - sie scheint zu leben. </font><font style="vertical-align: inherit;">Sie k√∂nnen einen Zwischensieg erkl√§ren.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/vd/fg/lyvdfgr98fqlrow-vtmumb4ucbw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr ein paar Wochen ununterbrochener Arbeit - viele Daten sowohl zu Sendern in der Luft als auch zu Kunden. </font><font style="vertical-align: inherit;">Jetzt k√§mpfe ich mit der Versuchung, dieses Ger√§t Infobes anzubieten, um den Rundfunk in den anvertrauten Gebieten zu kontrollieren, und dem Staat, um die Bewegung der Telefone der B√ºrger zu kontrollieren. </font><font style="vertical-align: inherit;">Es ist nat√ºrlich ein Witz, sie selbst wissen bereits alles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle oben beschriebenen Pr√ºfungen sind also nur ein Haustierprojekt mit sehr geringer Komplexit√§t (es war fast sofort klar, was und wie zu tun ist), mangelnder Hardwareentwicklung (hi, Physik) und Zugang zu einem etwas mehr oder weniger vollst√§ndigen Produkt. </font><font style="vertical-align: inherit;">Nein, nat√ºrlich kann nicht ausgeschlossen werden, dass der Autor dieser Zeilen ein dichter Amateur ist, und echte Gurus gehen an einem Abend zwischen Abendtee und einem Glas Cognac diesen Weg, aber die Erfahrung hat bisher nur eines gezeigt: IT ist kompliziert und Optimismus wird finanziell und seri√∂s bestraft und motivierend, und diejenigen, die sagen, "alles ist einfach", sind entweder Genies oder Gauner, und der zweite ist wahrscheinlicher.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503364/index.html">HandsAppMVP: iOS-Architektur f√ºr das Outsourcing der Studioentwicklung</a></li>
<li><a href="../de503366/index.html">Warum wird ein Bindestrich zur Frage? Oder Probleme beim Codieren von Daten in SQL</a></li>
<li><a href="../de503368/index.html">Gigantomania: Warum wiegen moderne Spiele so viel?</a></li>
<li><a href="../de503372/index.html">Ethereum 2.0 kann aufgrund von Fehlern, Problemen und Konkurrenten erneut verz√∂gert werden</a></li>
<li><a href="../de503380/index.html">Asynchrone Jobs in Django mit Sellerie</a></li>
<li><a href="../de503386/index.html">Agile Coach gesunde Person</a></li>
<li><a href="../de503388/index.html">Digitalisierung der Panik: DIT von Moskau gegen Moskauer - ein runder Tisch am 23. Mai</a></li>
<li><a href="../de503390/index.html">Warum setzt Intel auf die Chipentwicklung f√ºr das Genie von Jim Keller?</a></li>
<li><a href="../de503394/index.html">Erfahrung in Aktieninvestitionen</a></li>
<li><a href="../de503398/index.html">Wie man schnell eine thematische Modellierung eines Forums erstellt oder was Menschen mit Z√∂liakie st√∂rt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>