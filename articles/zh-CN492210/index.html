<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏂🏾 🧜🏻 👻 Infinidat存储架构技术概述 🤛🏾 👨‍👩‍👦 ☃️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="InfiniBox是一种现代存储系统，可立即插入魔术方块的右侧。它的独特性是什么？
 
 简要背景
 
 什么是InfiniBox？这是一个Infinidat存储系统。什么是Infinidat？这是由Moshe Yanay（Symmetrix和XIV的创建者）创建的公司，用于实施理想的企业级存储项目...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Infinidat存储架构技术概述</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492210/"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfiniBox</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一种现代存储系统，可立即插入魔术方块的右侧。它的独特性是什么？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简要背景</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
什么是InfiniBox？这是一个Infinidat存储系统。什么是Infinidat？这是由</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moshe Yanay</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Symmetrix和XIV的创建者）</font><font style="vertical-align: inherit;">创建的公司，</font><font style="vertical-align: inherit;">用于实施理想的企业级存储项目。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该公司是作为软件开发人员创建的，该软件安装在经过验证的设备（即SDS）上，但是是一个整体。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本文中，我们将介绍InfiniBox存储系统，其体系结构，其工作方式以及以相对较低的价格获得的高可靠性（99.99999％），性能和容量。</font><font style="vertical-align: inherit;">由于存储系统的基础是其软件，尤其是对于该系统，主要重点将放在软件上，因此不会有任何漂亮的照片腺体。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为什么您在市场上需要另一个存储系统？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
许多任务需要非常大的容量，而可靠性和性能也很重要。</font><font style="vertical-align: inherit;">例如，云系统，大型公司的标准任务，物联网，基因研究，大型结构的安全系统。</font><font style="vertical-align: inherit;">很难找到适合此类任务的最佳存储系统，尤其是在价格方面。</font><font style="vertical-align: inherit;">着眼于此类任务，构建了InfiniBox的软件体系结构。</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">寻址</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如何存储无限量的数据？通过提供无限的地址空间。为此，InfiniBox使用VUA-虚拟用户地址空间。用户可以在InfiniBox上创建的所有对象（卷，快照，文件系统）都包含在此VUA中，这些对象的总大小是VUA的当前大小。寻址很薄，并且不与磁盘关联：也就是说，VUA的大小可能比可用磁盘容量大得多，并且实际上是无限的。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hh/mx/xs/hhmxxskcrjwf_rbzdyhxxmm7jve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们需要将此空间划分为我们要服务的部分，以便更轻松地使用它们。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gb/pi/0w/gbpi0w95uknx_rqid5hh8hqegue.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
整个地址空间分为6部分-VU（虚拟单元-虚拟部分）。每个对象的地址空间（例如卷）均在这些部分之间平均分配。录制以64kB的块进行，在此过程中，您可以非常简单，迅速地了解此卷地址所属的VU（LBA / 64kB余数的除法，取模功能，在最少的CPU周期内就可以很快完成）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了以较小的空间简化工作之外，VU还是从物理磁盘进行抽象的第一级，并且是控制器级系统容错的基础。例如，有3个控制器（物理服务器），每个控制器负责操作，并且是两个VU的主要控制器，以及另外两个VU的备用控制器。该控制器不为其保留的VU提供服务，但同时从另一个控制器接收该VU的元数据和写入操作，因此在主控制器发生故障的情况下，它将立即接管该VU的所有工作。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/su/va/ac/suvaaczayqssttnruu0ocpx8-x0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果一个控制器发生故障，其他两个控制器将接管其任务-使用其VU。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p8/xs/om/p8xsomueay67tpcedjgu-f0thf8.png"><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">寻址，快照，缓存</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/-u/ll/dj/-ulldjlhq6aigcmhhlc_nwevew0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VUA是可供用户使用的虚拟地址空间，实际上是无限的。 VDA（虚拟磁盘地址）是虚拟内部存储空间。它的大小由硬盘驱动器的数量和容量（减去奇偶校验，元数据和更换故障驱动器的空间）预先严格确定。 VUA和VDA之间的连接是通过</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（前缀树）进行组织的。树中的每个条目都是从用户空间（VUA）到内部空间（VDA）的指针。以前缀树的形式寻址允许您寻址任何大小的块。也就是说，将任何大小的元素（文件，串行数据流，对象）添加到磁盘后，都可以使用树中的一条记录对其进行寻址，并且树保持紧凑。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，树的最重要特征是搜索和扩展树时的高性能。</font><font style="vertical-align: inherit;">当需要在磁盘上查找具有给定地址的块时，将在读取操作期间执行搜索。</font><font style="vertical-align: inherit;">树的扩展发生在写操作期间，当我们将新数据添加到磁盘时，必须在树上添加一个可以找到它的地址。</font><font style="vertical-align: inherit;">在使用大型结构时，性能非常重要，并且前缀树使您可以在将来（例如在磁盘容量增加的情况下）获得巨大利润。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关于VUA和VDA之间的关系可以说：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VUA大小可能远远超过VDA大小</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在将精简配置写入其中之前，VUA与VDA无关</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多个VUA可以引用一个VDA（快照/克隆）</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，通过VUA和VDA的组织，它们之间的连接以及这些连接的寻址，您可以实现非常快的快照和自动精简配置。由于创建快照仅是更新内存中的元数据，并且是工作时不断发生的操作，因此实际上此操作不需要任何时间。通常，在创建快照时，经典存储系统会停止更新元数据和/或I / O，以保证事务的完整性。这导致不均匀的I / O延迟。所讨论的系统的工作原理不同：什么都不会停止，并且块元数据中的时间戳（64 + 4KB）用于确定操作是否在快照中。因此，系统可以拍摄数十万张照片，而不会减慢工作速度，具有数百个快照的卷和没有快照的卷的性能没有什么不同。由于所有操作都在内存中完成，并且它们是常规过程，因此可以在卷组上每秒拍摄几十个快照。这使您可以在快照上实现异步复制，并且副本之间的差异只需几秒钟甚至更少，而且又不影响性能，这也很重要。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看一下整个系统，数据如何运行。通过所有三个控制器（服务器）的端口接收操作。端口驱动程序在用户空间中工作，如果端口上事件的任何组合使驱动程序挂起，则您可以简单地重新启动它们。在经典实现中，这是在内核中完成的，而问题是通过重新启动整个控制器来解决的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，将流分为64KB + 4KB的部分。这些额外的4KB是什么？这是防止静默错误的保护措施，它包含校验和，时间以及有关该操作的其他信息，这些信息用于对该操作进行分类，并用于优化缓存和预读。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qn/xh/kc/qnxhkcpwyay-2u13sc5ccppxlo4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录缓存是一件非常简单的事情，不能说阅读。如果我们知道要读取的内容，则读取缓存效果很好。经典系统使用顺序访问预读算法。但是，随心所欲怎么办？完全随机访问在实际应用程序中极为罕见，即使正确模拟它也是非常困难的，编写一个真正的随机数生成器是一项相当有趣的任务。但是，如果像传统系统那样单独考虑每个I / O操作，则除了完全顺序的操作外，所有其他操作都是任意且不可预测的。但是，如果您花了一段时间查看整个I / O流，则可以看到结合了不同操作的模式。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
系统缓存基本上对卷，文件，基于VUA的任何逻辑结构一无所知。缓存仅基于节的行为和属性来查看节及其元数据，这使您可以查找实际连接的不同应用程序之间的依赖关系。对于输入输出操作，构造活动矢量。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v1/49/6h/v1496h5gppmbn3yfz1zlqewaxkc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
系统累积统计信息，构建这些活动向量，然后尝试识别当前的I / O并将其绑定到已知向量或构建新的向量。识别后，根据向量进行预测读取，即预测应用程序行为，并对看似任意的负载执行预测读取。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">刻录到光盘</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
14个部分以条带形式组装在一起以进行固定。这是通过一个特殊的过程完成的，该过程为这种条带选择部分。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/j4/uf/koj4ufxyiqfiypwqvq5qdu-jos8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，考虑两个奇偶校验部分-条带已准备好写入磁盘。奇偶校验是通过基于XOR的几次运算来计算的，这比基于Reed-Solomon代码的速度快两倍。进一步的条带（14 + 2个部分）分配给RAID组（RG）。 RAID组只是用于存储多个条带的对象，仅此而已。条带按如下所示进行分组，一个在另一个之上，垂直列称为RAID组的成员。 VDS（虚拟磁盘空间）是可用于用户数据的磁盘空间，而VDA是其中的地址。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mi/fn/pv/mifnpvoq0j5vdi-wfoopskwsc8c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RAID组的一列或成员被写入一个机架（磁盘单元）中的一个磁盘（PD-物理驱动器）。写入RAID组成员的位置称为磁盘分区（DP-Drive Partition）。磁盘上DP的数量是恒定的，等于264，其大小取决于磁盘的大小。这种设计使您可以均匀地加载所有磁盘。同时，该算法将一个RAID组中的列尽可能远地分布在不同的磁盘和架子上。这导致以下事实：当两个磁盘发生故障时，它们上的公共条带数量同时最小，并且系统在几分钟之内从保护状态N切换到N + 1，从而立即重建了缺少两列的那些条带（可靠性为7个9）。 ）</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ik/_n/gq/ik_ngqabo6gnxy3csl2-malsvxi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，整个系统的逻辑设计看起来非常简单，并在下图中显示。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/i4/kh/99/i4kh99x3ihbgyb4zlhyuhq2uhx0.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物理实施</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
该系统的构造使其所有组件均根据N + 2或2N方案得到保护，包括阵列内部的电源和数据通道。这是电源实现图。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ATS（自动转换开关）-ATS，相位开关</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BBU（备用电池）-UPS，不间断电源</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
节点-控制器</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ie/zo/jh/iezojhvdfwnmlbq_j6at6-thqxc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过此方案，您可以在复杂事件（例如，电源故障和一个电源电路的临时关闭）中保护控制器和内存的完整性。 UPS易于管理，可让您获取准确的充电信息并灵活更改缓存大小，以便控制器始终有时间对其进行重置。也就是说，与传统方案不同，当仅在电池充满电时才打开缓存时，系统会更早地开始主动使用缓存。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是系统内数据通道的示意图。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/m9/xt/e-/m9xte-au9b0hnp6ej8tf2b8e7hc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
控制器通过Infiniband互连，并通过SAS连接到驱动器。每个控制器都可以访问系统中的每个磁盘。此外，如果控制器和磁盘之间的连接不起作用，则控制器可以通过Infiniband通过充当代理的另一个控制器请求数据。机架包含用于同时访问磁盘的SAS交换机。每个磁盘架包含60个磁盘，磁盘架可以是2个，4个或8个，总共多达480个3、4、6、8或12 TB磁盘。未经压缩，可供用户使用的总容量超过4.1PB。说到压缩，为了实现压缩而不损失性能，不对内存进行压缩，结果，系统有时会以更快的速度打开压缩工作-在读取时，您需要读取的内容较少，有足够的处理器能力，刻录时，答案直接来自内存，直接刻录到光盘的过程中异步进行压缩。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
控制器内部包含两组磁盘：一组磁盘用于刷新RAM，另一组磁盘用于SSD上的读取操作（每个系统最多368TB）。</font><font style="vertical-align: inherit;">如此大的缓存可以预测性地读取大块数据，并且由于以接近相同的访问频率选择条带中的数据，因此这样的大块数据不仅减少了物理磁盘上的负载，而且在不久的将来有很大的需求机会。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结束语</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
因此，我们讨论了一个非常有趣的存储系统，该系统具有现代架构，并提供高容量，高可靠性，出色的性能和足够的成本。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cq/mb/r0/cqmbr0e4khu8bkuc0nlmz08vaja.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资料来源</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://techfieldday.com/video/infinidat-solution-deep-dive/ </font></font></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://support.infinidat.com/hc/zh-CN</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN492190/index.html">Russian SaaS 2019-结果</a></li>
<li><a href="../zh-CN492192/index.html">寻找卓越的口袋</a></li>
<li><a href="../zh-CN492200/index.html">测试自动化：Java还是Python？</a></li>
<li><a href="../zh-CN492202/index.html">Коронавирус COVID-19: только факты, без паники</a></li>
<li><a href="../zh-CN492204/index.html">在Power BI中构建报表时如何解决错误，以及如何构建大数据上传系统</a></li>
<li><a href="../zh-CN492212/index.html">开源软件门户的前端开发：分享经验</a></li>
<li><a href="../zh-CN492214/index.html">为什么走路时值得开会？被黑手党证实的科学证明</a></li>
<li><a href="../zh-CN492216/index.html">在构建阶段在.Net应用程序中保存值</a></li>
<li><a href="../zh-CN492218/index.html">要记住的图标设计规则</a></li>
<li><a href="../zh-CN492220/index.html">熊猫的5个鲜为人知的秘密</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>