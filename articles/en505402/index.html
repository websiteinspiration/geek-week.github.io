<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎮 🛏️ 👩🏿‍🏫 Superimposing a 2d texture on a 3d object using p5.js (part 2 - applying a pattern to a cube) 👨🏾 🤓 🦉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the second part of the project in which we impose a dynamic 2d pattern on a 3d object. You can start with the first part ( Part 1 ) or simply ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Superimposing a 2d texture on a 3d object using p5.js (part 2 - applying a pattern to a cube)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505402/"><img src="https://habrastorage.org/webt/4s/4t/rf/4s4trfjd_x_iewiw8ectzn3cqva.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the second part of the project in which we impose a dynamic 2d pattern on a 3d object. </font><font style="vertical-align: inherit;">You can start with the first part ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) or simply copy the resulting code a few paragraphs below. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some time ago, I created a pattern that was generated using several lines of code in the p5.js library.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p5.js is a Javascript library created in 2014. </font><font style="vertical-align: inherit;">Its main goal is to become a window into the world of programming for designers, artists, teachers and other representatives of creative professions. </font><font style="vertical-align: inherit;">It supports both animation and diagrams, easily translates to web format.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now I’ll tell you how to make the final part - apply a pattern to a 3d object (in this case, a cube).</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To start working from scratch, you need to create a project in the online editor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">editor.p5js.org.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We continue to change the following code:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> r=<span class="hljs-number">10</span>
<span class="hljs-keyword">let</span> a=<span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> =<span class="hljs-number">20</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{<font></font>
  background(<span class="hljs-number">220</span>);<font></font>
  createCanvas(<span class="hljs-number">400</span>, <span class="hljs-number">400</span>);<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">draw</span>(<span class="hljs-params"></span>) </span>{<font></font>
translate(<span class="hljs-number">200</span>,<span class="hljs-number">200</span>)
  <span class="hljs-keyword">let</span> x = r+*cos(a);
  <span class="hljs-keyword">let</span> y = r+*sin(a);<font></font>
  fill(<span class="hljs-number">255</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<font></font>
  ellipse (x,y,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);<font></font>
   =  + <span class="hljs-number">0.06</span>
  a = a + <span class="hljs-number">0.3</span><font></font>
    <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To make our canvas voluminous, we need to add the WEBGL parameter to the function that creates our canvas: createCanvas (400,400, WEBGL). Since the reference point for such an object is already in the center, we can (and need to!) Remove the translate (200,200), which performed the correction in a flat image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To diversify the color scheme and make a more spectacular image, let's replace the fill () parameters with our variables r, a, c - now with each new iteration of the infinite draw () loop, the color of the ellipses will change slightly. Also, let's add some distance between the circles and the tilt angles by changing the rate of change of the variables c and a.</font></font><br>
<br>
<pre><code class="javascript hljs">   =  + <span class="hljs-number">0.06</span>
  a = a + <span class="hljs-number">0.3</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a final improvement, let's add push () before our pattern code and pop () after. </font><font style="vertical-align: inherit;">Framing in this way makes the code isolated - it will not be affected by other objects that we will create.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> r=<span class="hljs-number">10</span>
<span class="hljs-keyword">let</span> a=<span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> c=<span class="hljs-number">20</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{<font></font>
  background(<span class="hljs-number">220</span>);<font></font>
  createCanvas(<span class="hljs-number">400</span>, <span class="hljs-number">400</span>, WEBGL);<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">draw</span>(<span class="hljs-params"></span>) </span>{<font></font>
  push()<font></font>
  <span class="hljs-keyword">let</span> x = r+c*cos(a);
  <span class="hljs-keyword">let</span> y = r+c*sin(a);<font></font>
  fill(r,a,c);<font></font>
  ellipse (x,y,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);<font></font>
  c = c + <span class="hljs-number">0.09</span>
  a = a + <span class="hljs-number">0.8</span><font></font>
  pop()<font></font>
}<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/fo/di/7n/fodi7nd_wup_avsim2xk4yqcugy.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the end, we get something like this. </font><font style="vertical-align: inherit;">It's time to create a cube. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the same draw () function, after pop () we add the box code:</font></font><br>
<br>
<pre><code class="javascript hljs">  push()<font></font>
  box(<span class="hljs-number">200</span>)<font></font>
  pop()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now the box with a size of 200 is turned to us only on one side and looks like just a square. To estimate the volume, we need to deploy it. To do this, add the fourth variable, top, to the r, a, c ones already there, angle with the default value 0. For this parameter to affect our cube, after the second push (), but before creating the box. add three functions: rotateX (), rotateY (), rotateZ () with the angle parameter for each. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is logical that an object with a rotation angle of 0 degrees will not spin, therefore, we add a change in the value of the variable angle to 0.003 (for starters it will be enough). As a result, we get the following code:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> r=<span class="hljs-number">10</span>
<span class="hljs-keyword">let</span> a=<span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> c=<span class="hljs-number">20</span>
<span class="hljs-keyword">let</span> angle = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{<font></font>
  background(<span class="hljs-number">220</span>);<font></font>
  createCanvas(<span class="hljs-number">400</span>, <span class="hljs-number">400</span>, WEBGL);<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">draw</span>(<span class="hljs-params"></span>) </span>{<font></font>
  push()<font></font>
  <span class="hljs-keyword">let</span> x = r+c*cos(a);
  <span class="hljs-keyword">let</span> y = r+c*sin(a);<font></font>
  fill(r,a,c);<font></font>
  ellipse (x,y,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);<font></font>
  c = c + <span class="hljs-number">0.09</span>
  a = a + <span class="hljs-number">0.8</span><font></font>
  pop()<font></font>
  <font></font>
  push()<font></font>
  rotateX(angle), <font></font>
  rotateY(angle), <font></font>
  rotateZ(angle)<font></font>
  box(<span class="hljs-number">200</span>)<font></font>
  angle = angle + <span class="hljs-number">0.003</span><font></font>
  pop()<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since our background is created only once (it is in setup) - we catch the first bug our cube erases the background when rotated. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w5/cx/dt/w5cxdthj4s6tyqx3jea88dnt9ng.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To fix it, you can simply transfer background (200) inside the draw () function. However, now we are catching another problem - our circles begin to disappear, as they did at the beginning, because now they are overwritten with each new cycle and appear only for a split second from nothingness. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To solve this problem, we need to create a new variable (for example, art) without a default value at the very beginning next to other top-level variables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inside the setup () function, we equate it to the createGraphics (400,400) function, and then use it in other places.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Make sure that you set the same parameters as when creating the Canvas to maintain dimensionality.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now inside the pattern code, we add the art variable through the dot to the ellipse and its properties (such as fill () and others, if you created them). </font></font><br>
<br>
<pre><code class="javascript hljs">art.fill(r,a,c);<font></font>
  art.ellipse (x,y,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, it remains to impose the pattern on the cube as a texture. </font><font style="vertical-align: inherit;">To do this, add the texture (art) property inside the cube-box code. </font><font style="vertical-align: inherit;">The logic is as follows: we create the essence of a graphical isolated object art, which calls the function of creating a pattern with the specified properties, and then we give art as a property parameter a texture for the cube.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> r=<span class="hljs-number">10</span>
<span class="hljs-keyword">let</span> a=<span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> c=<span class="hljs-number">20</span>
<span class="hljs-keyword">let</span> angle = <span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> art<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{<font></font>
  createCanvas(<span class="hljs-number">400</span>, <span class="hljs-number">400</span>, WEBGL);<font></font>
  art = createGraphics(<span class="hljs-number">400</span>,<span class="hljs-number">400</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">draw</span>(<span class="hljs-params"></span>) </span>{<font></font>
  background(<span class="hljs-number">220</span>);<font></font>
  push()<font></font>
  <span class="hljs-keyword">let</span> x = r+c*cos(a);
  <span class="hljs-keyword">let</span> y = r+c*sin(a);<font></font>
  art.fill(r,a,c);<font></font>
  art.ellipse (x,y,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);<font></font>
  c = c + <span class="hljs-number">0.09</span>
  a = a + <span class="hljs-number">0.8</span><font></font>
  pop()<font></font>
  <font></font>
  push()<font></font>
  texture(art)<font></font>
  rotateX(angle), <font></font>
  rotateY(angle), <font></font>
  rotateZ(angle)<font></font>
  box(<span class="hljs-number">200</span>)<font></font>
  angle = angle + <span class="hljs-number">0.003</span><font></font>
  pop()<font></font>
}</code></pre><br>
<img src="https://habrastorage.org/webt/en/ya/ds/enyads2ckbcarldnouacdfmsz8m.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It remains to solve the last problem: our pattern begins to appear from the corners of the cube. </font><font style="vertical-align: inherit;">To start from the center, we can simply add half the width and length of the cube to the x and y parameter to shift the center of the start of drawing the pattern.</font></font><br>
<br>
<pre><code class="javascript hljs">art.ellipse (x+<span class="hljs-number">200</span>,y+<span class="hljs-number">200</span>,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);</code></pre><br>
<img src="https://habrastorage.org/webt/gw/cf/uy/gwcfuybz_4rc4eb7xclxv0b7x74.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to diversify the pattern, you can try just changing the parameters or even adding several intersecting patterns, for example, from another project - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to recreate the effect of the moire pattern in the p5.js library for a beginner (quick guide)</font></font></a><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ The idea and part of the source code is taken from the Nazia Fakhruddin article: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating 2D texture on a 3D shape in p5.js</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
→ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link to the project results</font></font></a></blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en505388/index.html">Treezor - Leader in Banking Services at Société Générale</a></li>
<li><a href="../en505390/index.html">F # community founder: “OOP and AF of the brain must die” // We are doomed # 7</a></li>
<li><a href="../en505394/index.html">Antiquities: Nokia E90, the latest communicator</a></li>
<li><a href="../en505398/index.html">The dark and light sides of work at Yandex</a></li>
<li><a href="../en505400/index.html">What should the models look like?</a></li>
<li><a href="../en505404/index.html">The easiest way to learn English with TED videos</a></li>
<li><a href="../en505412/index.html">Secure access to a smart home in the absence of a public IP (part 2)</a></li>
<li><a href="../en505416/index.html">MikroTik in repeater mode - just like One-Two-Three</a></li>
<li><a href="../en505418/index.html">[Question] Have you seen people who use mobile content subscriptions?</a></li>
<li><a href="../es486176/index.html">Memo de correspondencia de correo electrónico corporativo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>