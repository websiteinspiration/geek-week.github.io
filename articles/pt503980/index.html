<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê™ ‚èÆÔ∏è üë©üèø‚Äçüé® Monitorar a temperatura em um local remoto por meios "improvisados" üéâ üíü üë®üèΩ‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em 2019, quando era poss√≠vel sair sem passe, fui solicitado a fazer um monitoramento remoto da temperatura na casa da vila. As condi√ß√µes foram as segu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Monitorar a temperatura em um local remoto por meios "improvisados"</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503980/"><img src="https://habrastorage.org/webt/sz/sx/wa/szsxwal5ggvev3m8b6_gdflrqic.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em 2019, quando era poss√≠vel sair sem passe, fui solicitado a fazer um monitoramento remoto da temperatura na casa da vila. As condi√ß√µes foram as seguintes. H√° uma casa particular com internet, na casa h√° uma caldeira a g√°s para aquecimento. A caldeira mant√©m uma certa temperatura no sistema de aquecimento, ligando e desligando periodicamente. No estado desligado, o pavio de espera est√° ativado. O exaustor √© instalado com erros; portanto, um vento forte sopra periodicamente o pavio e o aquecimento para de funcionar. Para que no inverno a √°gua no sistema de aquecimento n√£o congele, √© necess√°rio acender manualmente o pavio. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesta casa, as pessoas aparecem uma vez por m√™s, ent√£o voc√™ n√£o pode ficar sem um sistema de monitoramento. A seguir, a declara√ß√£o do problema e sua implementa√ß√£o da maneira mais "pregui√ßosa" que encontrei em 2 meses.</font></font><br>
<a name="habracut"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Declara√ß√£o do problema</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Se o pavio se apagar, a temperatura na casa come√ßar√° a cair gradualmente. Quando cair abaixo de 15 graus, envie uma notifica√ß√£o de "email" para o "cliente". O pr√≥prio "cliente" toma uma decis√£o, quer ir sozinho ou ligar para os vizinhos que acendem o pavio. Condi√ß√£o principal: ‚ÄúSem configura√ß√£o. Eu trouxe, liguei e tudo funciona. ‚Äù </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sele√ß√£o da base do elemento</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu tinha 2 meses para o desenvolvimento (a tarefa foi definida no outono, estava longe de ser geada). Nesta situa√ß√£o, o ESP8266 implora por si. H√° Wi-fi em casa, as bibliotecas para medir a temperatura s√£o escritas para v√°rios sensores. Eu tinha um sensor de temperatura ESP e DS18b20, ent√£o adiei este projeto por um tempo devido ao trabalho no trabalho principal. Quase dois meses se passaram e era hora de entregar uma solu√ß√£o pronta, mas n√£o iniciei. Olhei em volta e decidi usar uma solu√ß√£o pronta com algumas modifica√ß√µes. Eu tinha um controlador dom√©stico inteligente baseado em Z-Wave gratuito. Ele consiste em RaspberryPi e uma placa de expans√£o, o que o torna um controlador dom√©stico inteligente. RaspberryPi comprado no Avito por 1500r. meio ano atr√°s, e eu tinha uma placa de expans√£o usada. Novos custos 6000r.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ak/gn/wx/akgnwxiuscrrzzz9vm1vwiuamle.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ comprar tudo na loja, o pre√ßo √© de cerca de 13000r. e √© chamado de "Controlador RaZberry". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu n√£o tinha um sensor de temperatura pronto compat√≠vel com a onda Z. </font></font><br>
<img src="https://habrastorage.org/webt/4w/bh/yj/4wbhyjjyjfqh1o89gr4ppmbkkt4.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu fiz isso com base no ZUNo (na loja por volta de 3000r., Recebi um dos prot√≥tipos de gra√ßa) e um sensor de temperatura selado DS18B20. </font></font><br>
<img src="https://habrastorage.org/webt/bg/un/da/bgundabhtaylxrckn99nicuoqt0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O ZUNo √© uma placa compat√≠vel com Arduino com um transceptor de r√°dio embutido. O esbo√ßo para ela foi tirado sem altera√ß√µes no site do fabricante ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://z-uno.z-wave.me/examples/1-wire-ds18b20-temperature-sensor/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) A partir deste esbo√ßo, o ZUNo pesquisa o sensor de temperatura a cada 30 segundos e envia uma notifica√ß√£o ao controlador via r√°dio. O ZUNo n√£o dorme enquanto aguarda. Sou eu que o esbo√ßo √© primitivo, n√£o economiza recursos nem no pr√≥prio microcontrolador nem na eletricidade. Mas ele faz exatamente o que eu preciso! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O ZUNo √© preenchido ‚Äúperfeitamente‚Äù com adesivo hot melt em uma caixa de pl√°stico. </font></font><br>
<img src="https://habrastorage.org/webt/2g/3q/ts/2g3qtsd1dgzhkaxgjikfykhqsfg.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele tirou 2 fios do gabinete: alimentado por USB e um sensor de temperatura. Acabou de forma confi√°vel, por isso n√£o √© assustador abandon√°-lo e parece decente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O controlador conectado via cabo Ethernet ao roteador. O cabo n√£o p√¥de ser usado. RaspberryPi pode usar Wi-fi. Mas como o principal requisito foi "ativado e esquecido", n√£o corri riscos ao pr√©-configurar a rede wi-fi no raspberryPi.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O RaspberryPi foi conectado a uma carga de 2 amp√®res do telefone. O sensor de temperatura consome at√© 50 mA, portanto, √© conectado ao conector USB do RaspberryPi. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o de framboesa</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 A imagem foi tirada daqui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">storage.z-wave.me/z-way-server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamada "razberry.img.zip". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instalei a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagem no cart√£o SD do RaspberryPi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o RaspberryPi for iniciado, o servidor Z-way (software dom√©stico inteligente) tamb√©m ser√° iniciado. Mas √© uma vers√£o antiga, precisa ser atualizada. Nas configura√ß√µes, h√° um bot√£o para atualiza√ß√£o, mas ningu√©m o usa e ele n√£o funciona. </font></font><br>
<img src="https://habrastorage.org/webt/oj/md/ob/ojmdobj0ypyg4f2rt59m0uqtvu0.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 √â muito mais "conveniente" usar as instru√ß√µes para atualiza√ß√£o. Ela est√° neste </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">endere√ßo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para inserir os comandos descritos neste manual, voc√™ precisa abrir um terminal no RaspberryPi. </font><font style="vertical-align: inherit;">Isso pode ser feito via ssh ou conectando um monitor a um teclado. </font><font style="vertical-align: inherit;">O segundo monitor e teclado est√£o sempre comigo, ao contr√°rio do roteador, ent√£o escolhi a segunda op√ß√£o. </font><font style="vertical-align: inherit;">Como estou desenvolvendo um sistema incorporado aut√¥nomo, √© necess√°rio fornecer um cron√¥metro de vigil√¢ncia para aumentar a confiabilidade. </font><font style="vertical-align: inherit;">Mesmo assim, o RaspberryPi n√£o √© um controlador industrial e o sistema Z-wave, tamb√©m n√£o √© recomendado us√°-lo em decis√µes cr√≠ticas; contarei com congelamentos peri√≥dicos, que s√≥ podem ser encerrados reiniciando o software ou o sistema operacional inteiro no RaspberryPi. </font><font style="vertical-align: inherit;">Vou reiniciar todo o sistema operacional todos os dias √†s 12:00. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, adicionei uma linha ao arquivo executado ap√≥s o in√≠cio do sistema operacional.</font></font><br>
<pre><code class="python hljs"><span class="hljs-comment">#sudo vi /etc/rc.local</span>
shutdown -r <span class="hljs-number">12</span>:<span class="hljs-number">00</span></code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comandos vi b√°sicos</font></font></b>
                        <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se eu quiser repetir e esquecer </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 "i" - comece a digitar vi </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ": wq!" </font><font style="vertical-align: inherit;">- salvar e sair do vi</font></font><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O sensor de temperatura montado com base no ZUNo tamb√©m n√£o √© o ideal; se voc√™ o conectar ao RaspberryPi, ele ser√° reiniciado todos os dias. Assim, melhora significativamente a confiabilidade do sistema como um todo. O sistema operacional permanece o ponto fraco. Se congelar e n√£o reiniciar √†s 12:00, n√£o h√° nada a ser feito. Tem que chamar um "especialista" para distorcer a comida. No entanto, este sistema operacional foi testado e depurado melhor do que os outros componentes deste projeto (espero). Voc√™ tem que correr esse risco. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o do software do servidor Z-way</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Para inserir a parte gr√°fica do software do servidor Z-way, ele energizou o equipamento e, ap√≥s alguns minutos, utilizou o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servi√ßo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Este servi√ßo procura RaspberryPi com um servidor Z-way em execu√ß√£o na rede local e exibe seus endere√ßos IP. Voc√™ tamb√©m pode conectar-se a um RaspberryPi remoto aqui. Para configurar isso, escolhi um RaspberryPi local. Defina um nome de usu√°rio e senha e lembre-se do ID de seis d√≠gitos. Isso √© suficiente para uma conex√£o remota. </font></font><br>
<img src="https://habrastorage.org/webt/rj/ag/bu/rjagbunwspmpbw10-zydr2hhfza.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ID para conex√£o remota. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Adicionado um sensor de temperatura. Esta √© uma a√ß√£o padr√£o. </font></font><br>
<img src="https://habrastorage.org/webt/cl/fh/s2/clfhs2ni524ui0knrehemt9jbm4.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Aplicativos adicionados-&gt; Aplicativos locais-&gt; Email ME </font></font><br>
<img src="https://habrastorage.org/webt/8w/bp/sn/8wbpsnhpnnt3wbduvmo-mnothse.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3) Especificou o nome do elemento e o endere√ßo de email com o texto da carta </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4) Adicionou a condi√ß√£o sob a qual a carta ser√° enviada. Nada muito complicado. </font></font><br>
<img src="https://habrastorage.org/webt/ya/gb/iy/yagbiy4qxnhipjy-ibhbjoxgily.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verifica√ß√£o final </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conectou o RaspberryPi a um roteador atrav√©s de um cabo, energia aplicada, conectou um sensor t√©rmico.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu esfriei o sensor de temperatura e recebi uma carta, depois mais uma e outra. Enquanto a temperatura estiver abaixo de 15 graus, o "cliente" receber√° cartas. √â bom, voc√™ n√£o vai perder. (Olhando para o futuro, direi que o cliente tamb√©m n√£o recebeu e-mails, por isso recebi v√°rias centenas de cartas da minha "ideia". Meu cliente de e-mail as colocou convenientemente em cadeias e n√£o causou nenhum desconforto). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para ver rapidamente a temperatura da casa no telefone, instalei o aplicativo Z-way. </font></font><br>
<img src="https://habrastorage.org/webt/ep/l7/-x/epl7-xz8vc3g2yfhvps2-jmnrda.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o posso dizer que √© r√°pido, conveniente, mas permite que voc√™ se conecte remotamente ao servidor Z-way no RaspberryPi e observe a temperatura. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante duas noites, olhando ao redor, montei um sistema de monitoramento de temperatura para um objeto remoto. Anteriormente, o ZUNo e o controlador Razberry eram considerados brinquedos caros. Por√©m, ap√≥s a remo√ß√£o solene do meu equipamento do posto de "combate", onde v√°rias vezes determinou o mau funcionamento do sistema de aquecimento durante o inverno, fui respeitado por esses produtos. E h√° algo a respeitar. A Internet e a luz desapareciam periodicamente, mas ap√≥s a retomada do arquivamento, a comunica√ß√£o era restaurada. Agora, desmontei esse "complexo" em pe√ßas de reposi√ß√£o e entendi sua principal for√ßa. Tendo uma placa controladora Razberry que pode ser inserida no RaspberryPi ou atrav√©s de um adaptador UART em qualquer computador, um ou dois ZUNo, um conjunto b√°sico de sensores e atuadores mais simples, voc√™ pode resolver rapidamente o problema.N√£o gosto da palavra "f√°cil" e n√£o tenho a experi√™ncia de usar equipamentos "inteligentes" de outros fabricantes, mas em dois dias recebi um conjunto pronto de equipamentos que √© suficiente para conectar √† energia, al√©m de um aplicativo em um smartphone, um aplicativo da web em um computador e notifica√ß√µes por e-mail.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt503964/index.html">DataStore - CRUD (Criar exclus√£o de atualiza√ß√£o de leitura)</a></li>
<li><a href="../pt503966/index.html">O aplicativo Social Monitoring foi criado a partir de um rastreador de caminh√£o de lixo</a></li>
<li><a href="../pt503968/index.html">Como fazer o rob√¥ se mover com precis√£o? Vis√£o geral e recursos da rob√≥tica da plataforma Studuino</a></li>
<li><a href="../pt503970/index.html">PuppetConf 2016. Kubernetes para administradores de sistema. Parte 1</a></li>
<li><a href="../pt503972/index.html">Teste de streaming em 4 redes sociais e escolha a melhor op√ß√£o</a></li>
<li><a href="../pt503982/index.html">Sobre orcs e estruturas</a></li>
<li><a href="../pt503988/index.html">Como a "luz rodopiante" entrou nas redes √≥pticas</a></li>
<li><a href="../pt503990/index.html">Estou cansado do fato de que programadores comuns personificam desenvolvedores e desonram o setor. Eles pioram o mundo</a></li>
<li><a href="../pt503992/index.html">Como dar uma palestra / webinar bacana: 16 dicas de tr√™s palestrantes em s√©rie. Eventos Leader-IT # 2</a></li>
<li><a href="../pt503994/index.html">An√∫ncio do Webinar da Quest Software para gerenciamento remoto de esta√ß√£o de trabalho e seguran√ßa cibern√©tica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>