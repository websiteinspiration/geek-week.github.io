<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â¬…ï¸ ğŸ‘¨ğŸ»â€ğŸ¤ ğŸ‘ƒğŸ¼ Unityç¼–è¾‘å™¨å†é™©è®°ï¼šåºåˆ—åŒ–çš„Matryoshka ğŸ¡ ğŸ¤ ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç®€çŸ­ä»‹ç»
 é€šå¸¸ï¼Œä¸ºäº†è¿›å…¥æˆ‘ä»¬æ„Ÿå…´è¶£çš„åºåˆ—åŒ–å±æ€§é¢†åŸŸï¼Œæ‰‹åŠ¨ç–—æ³•å»ºè®®æˆ‘ä»¬ä½¿ç”¨FindPropertyRelativeï¼ˆï¼‰æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­æ·»åŠ å˜é‡åã€‚
 
 ç”±äºæŸäº›åŸå› ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸æ€»æ˜¯å¾ˆæ–¹ä¾¿ã€‚åŸå› å¯èƒ½éå¸¸å¤šæ ·ã€‚ä¾‹å¦‚ï¼Œå˜é‡çš„åç§°å¯ä»¥æ›´æ”¹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹éåºåˆ—åŒ–çš„å±æ€§è¿›è¡Œæµé¼»è¡€çš„è®¿é—®ï¼Œæˆ‘ä»¬éœ€è¦å¯¹getter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Unityç¼–è¾‘å™¨å†é™©è®°ï¼šåºåˆ—åŒ–çš„Matryoshka</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502836/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç®€çŸ­ä»‹ç»</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šå¸¸ï¼Œä¸ºäº†è¿›å…¥æˆ‘ä»¬æ„Ÿå…´è¶£çš„åºåˆ—åŒ–å±æ€§é¢†åŸŸï¼Œæ‰‹åŠ¨ç–—æ³•å»ºè®®æˆ‘ä»¬ä½¿ç”¨FindPropertyRelativeï¼ˆï¼‰æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­æ·»åŠ å˜é‡åã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”±äºæŸäº›åŸå› ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸æ€»æ˜¯å¾ˆæ–¹ä¾¿ã€‚åŸå› å¯èƒ½éå¸¸å¤šæ ·ã€‚ä¾‹å¦‚ï¼Œå˜é‡çš„åç§°å¯ä»¥æ›´æ”¹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹éåºåˆ—åŒ–çš„å±æ€§è¿›è¡Œæµé¼»è¡€çš„è®¿é—®ï¼Œæˆ‘ä»¬éœ€è¦å¯¹getter-setteræˆ–ä»€è‡³æ˜¯åºåˆ—åŒ–å¯¹è±¡çš„æ–¹æ³•çš„è®¿é—®ã€‚æˆ‘ä»¬ä¸ä¼šé—®â€œä¸ºä»€ä¹ˆæ‚¨æ ¹æœ¬éœ€è¦è¿™ä¸ªâ€å’Œâ€œä¸ºä»€ä¹ˆæ²¡æœ‰ä¼ ç»Ÿæ–¹å¼å°±ä¸èƒ½åšâ€çš„é—®é¢˜ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦-å°±æ˜¯è¿™æ ·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œè®©æˆ‘ä»¬å¼„æ¸…æ¥šå¦‚ä½•ä»åºåˆ—åŒ–å±æ€§ä¸­è·å–æ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡åŠå…¶æ‰€æœ‰çˆ¶å¯¹è±¡ï¼Œè€Œä¸ä¼šé™·å…¥å……æ»¡é™·é˜±çš„åºåˆ—åŒ–é“è·¯ä¸Šã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„ã€‚</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æ–‡æ„å‘³ç€æ‚¨å·²ç»çŸ¥é“å¦‚ä½•ä½¿ç”¨UnityEditorï¼Œè‡³å°‘ä¸€æ¬¡ç¼–å†™äº†è‡ªå®šä¹‰PropertyDrawersï¼Œå¹¶ä¸”è‡³å°‘é€šä¿—åœ°äº†è§£äº†åºåˆ—åŒ–å±æ€§ä¸åºåˆ—åŒ–å¯¹è±¡çš„åŒºåˆ«ã€‚</font></font><br>
<br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åºåˆ—åŒ–è·¯å¾„</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œå°†æ‰€æœ‰ç‚¹éƒ½æ”¾åœ¨Oä¸Šã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ€åŸå§‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰MonoBehaviourçš„æŸä¸ªç»§æ‰¿äººç±»åˆ«ï¼Œå¹¶ä¸”å®ƒå…·æœ‰æŸä¸ªå±äºåºåˆ—åŒ–ç±»åˆ«çš„å­—æ®µï¼Œæ˜¾ç„¶ä¸æ˜¯A.K.A.ç¥åœ£unitç‰›çš„ç»§æ‰¿äººã€‚</font><font style="vertical-align: inherit;">UnityEngine.Objectã€‚</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ExamplePulsar</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
...<font></font>
        [<span class="hljs-meta">Space</span>][Header(<span class="hljs-string">"Example Sandbox Inspector Field"</span>)]
        <span class="hljs-keyword">public</span> SandboxField sandboxField;<font></font>
...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼ŒSandboxFieldæ˜¯å…·æœ‰Seriâ€‹â€‹alizableå±æ€§çš„ç±»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦è®¿é—®æ‰€æœ‰è€…çš„MonoBehaviourå¹¶ä¸æ˜¯é—®é¢˜ï¼š</font></font><br>
<br>
<pre><code class="cs hljs">UnityEngine.Object serializationRoot = property.serializedObject.targetObject;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥æŒ‰asè¿›è¡Œæ“ä½œï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬ä¸éœ€è¦å®ƒäº†ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¯¹åºåˆ—åŒ–å­—æ®µæœ¬èº«å¾ˆæ„Ÿå…´è¶£ï¼Œä»¥ä¾¿ä½¿ç”¨æ‰€æœ‰äºŒåä¸€ç‚¹æ¥ç»˜åˆ¶å®ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-w/3n/th/-w3nthkn0gmcdeuvpqlw2zctxhy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹åºåˆ—åŒ–è·¯å¾„ï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">string</span> serializationPath = property.propertyPath;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œåºåˆ—åŒ–è·¯å¾„å°†åŒ…å«æˆ‘ä»¬çš„ä¸€ä¸ªå­—æ®µï¼Œå¹¶å°†è¿”å›â€œ sandboxFieldâ€ï¼Œä»ä¸­æˆ‘ä»¬æ—¢ä¸å†·ä¹Ÿä¸çƒ­ï¼Œå› ä¸ºå¯¹äºç¬¬ä¸€å±‚åµŒå¥—ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å˜é‡çš„åç§°ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå˜é‡çš„åç§°å·²è¿”å›ç»™æˆ‘ä»¬ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯·æ³¨æ„ï¼Œé€”ä¸­æ²¡æœ‰çˆ¶MonoBehaviourã€‚</font><font style="vertical-align: inherit;">ç°åœ¨æ²¡å…³ç³»ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å¼€å§‹æ‹†å¸çœ‹èµ·æ¥åƒè¿™æ ·çš„ä¿„ç½—æ–¯ç©å¶æ—¶ï¼Œå®ƒå°†å˜å¾—å¾ˆé‡è¦ï¼š</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nestedClassVariable.exampleSandboxesList.Array.data [0] .evenMoreNested.Array.data [0]</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†ä»¥åä¸ä¼šè¢«æ•è·ï¼Œåœ¨åµŒå¥—å±æ€§æ—¶ï¼Œæˆ‘ä»¬å°†æå‰æ‰§è¡Œâ€‹â€‹ä»¥ä¸‹æ“ä½œï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">string</span>[] path = property.propertyPath.Split(<span class="hljs-string">'.'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æˆ‘ä»¬æœ‰äº†åºåˆ—åŒ–è·¯å¾„çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯åœ¨æœ€åŸå§‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦é›¶èŠ‚ç‚¹ã€‚</font><font style="vertical-align: inherit;">æ‹¿ç€ï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">string</span> pathNode = path[<span class="hljs-number">0</span>];</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰“å¼€ä¸€ç‚¹åå°„ï¼Œç„¶åä»è¿™é‡Œè·å¾—è§†é‡ï¼š</font></font><br>
<br>
<pre><code class="cs hljs">Type objectType = serializationRoot.GetType();<font></font>
FieldInfo objectFieldInfo = objectType.GetField(pathNode);<font></font>
<span class="hljs-keyword">object</span> field = objectFieldInfo.GetValue(serializationRoot);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬æŠŠè¿™ä¸ªé¡¹ç›®çš„é€Ÿåº¦é—®é¢˜æŠ›ä¹‹è„‘åã€‚å¯¹äºå°‘é‡æ­¤ç±»å­—æ®µå’Œå°‘é‡åµŒå¥—ï¼Œåå°„çš„æˆæœ¬å°†å¤§å¤§ä½äºæ¸²æŸ“æœŸé—´UnityEditorè¿›è¡Œçš„æ‰€æœ‰æ“ä½œã€‚å¦‚æœæ‚¨éœ€è¦è¯æ˜-åœ¨githubä¸Šï¼ŒUnityå¼€å‘äººå‘˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿ï¼ŒUnityCsReferenceï¼Œçœ‹çœ‹æ‚¨çš„é—²æš‡æ—¶é—´ï¼Œä¾‹å¦‚ObjectFieldæ¸²æŸ“çš„å®ç°æ–¹å¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼Œè¿™</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿˜ä¸æ˜¯ï¼ˆå“ˆå“ˆï¼‰</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€åˆ‡ã€‚æˆ‘ä»¬æœ‰äº†è¿™ä¸ªé¢†åŸŸï¼Œæˆ‘ä»¬å¾ˆé«˜å…´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒåšä»»ä½•æˆ‘ä»¬æƒ³åšçš„äº‹æƒ…ï¼Œç”šè‡³å°è¯•ç¼–å†™æ‰€æœ‰å½±å“æˆ‘ä»¬é¢†åŸŸçš„æ‰€æœ‰æŒ‰é’®å’Œé‡è¦åŠ¨ä½œçš„è‡ªå®šä¹‰UnityEventï¼Œæ— è®ºå®ƒæŒ‚åœ¨ä»€ä¹ˆå¯¹è±¡ä¸Šã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è‡³å°‘ï¼Œè™½ç„¶å®ƒæŒ‚åœ¨è¯¥å¯¹è±¡çš„æ ¹éƒ¨ï¼Œä½†ä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ï¼Œä½†ç°åœ¨å·²ç»ä¸é‚£ä¹ˆå¤šäº†ã€‚</font><font style="vertical-align: inherit;">åœ¨åºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨ç­‰å¾…æ•°ç»„å’Œå„ç§åˆ—è¡¨ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯å°†æˆ‘ä»¬æ”¾å…¥æ‹–é‹ä¸­ï¼ŒåŠæ—¶å‘ä¸Šæ›´æ”¹å…ƒç´ æ•°é‡ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¯¹æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åœ¨æ•°ç»„æœ¬èº«ä¸‹è¿›è¡ŒæŒ–æ˜ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æŠµæŠ—è¿™ç§ç©å¶</font></font></b>
                        <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/l7/do/h3/l7doh3b9j_da24zsw9rc-7xefjs.png"></div></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœåºåˆ—åŒ–è·¯å¾„ä¸­æ²¡æœ‰æ•°ç»„ï¼Œé‚£ä¹ˆä»»åŠ¡å°†å˜å¾—å¾®ä¸è¶³é“ï¼šæˆ‘ä»¬å°†éå†åºåˆ—åŒ–èŠ‚ç‚¹ï¼Œç›´åˆ°åˆ°è¾¾é“¾çš„æœ«ç«¯ã€‚</font><font style="vertical-align: inherit;">ç±»ä¼¼äºä»¥ä¸‹ä»£ç ï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">object</span> currentObject = serializationRoot;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; directSearchDepth; i++)<font></font>
{<font></font>
       <span class="hljs-keyword">string</span> pathNode = path[i];<font></font>
       Type objectType = currentObject.GetType();<font></font>
       FieldInfo objectFieldInfo = objectType.GetField(pathNode);<font></font>
       <span class="hljs-keyword">object</span> nextObject = objectFieldInfo.GetValue(currentObject);<font></font>
       currentObject = nextObject;<font></font>
}<font></font>
<span class="hljs-keyword">return</span> currentObject;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨ç­‰å¾…ä¸¤ä¸ªä»¤äººä¸å¿«çš„æ¶ˆæ¯ã€‚</font><font style="vertical-align: inherit;">æˆ‘å°†ä»ç¬¬äºŒä¸ªå¼€å§‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‡‡å–nextObjectçš„æ­¥éª¤å¯èƒ½çªç„¶è¿”å›nullè€Œä¸æ˜¯é¢„æœŸçš„å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">é€šå¸¸ï¼Œè¿™æ˜¯åœ¨æˆ‘ä»¬é¦–å…ˆåœ¨æ£€æŸ¥å™¨ä¸­åˆ›å»ºçˆ¶å¯¹è±¡æ—¶å‘ç”Ÿçš„ï¼Œå¹¶ä¸”åºåˆ—åŒ–è·¯å¾„å·²ç»å­˜åœ¨ï¼Œä½†æ˜¯ç›¸åº”çš„å­—æ®µä¸å­˜åœ¨ï¼ˆè¿™å°†ä¸ºæˆ‘ä»¬å¸¦æ¥æ›´å¤šä¾¿åˆ©ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½ç«‹å³ä½¿ç”¨return nullä»æ–¹æ³•ä¸­æ·»åŠ å‡ºå£ï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">object</span> nextObject = objectFieldInfo.GetValue(currentObject);
<span class="hljs-keyword">if</span> (nextObject == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
currentObject = nextObject;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â€œç­‰ä¸€ä¸‹ï¼</font><font style="vertical-align: inherit;">- ä½ è¯´ã€‚</font><font style="vertical-align: inherit;">â€œå¦‚æœè¿”å›é›¶ï¼Œé‚£ä¹ˆåœ¨OnGUIä¸­è¯¥æ€ä¹ˆåŠï¼Ÿâ€ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç­”ï¼šæ²¡æœ‰ã€‚</font><font style="vertical-align: inherit;">æ²¡ä»€ä¹ˆã€‚</font><font style="vertical-align: inherit;">åªéœ€è¿”å›å³å¯è·³è¿‡æ­¤ç»˜åˆ¶æ­¥éª¤ï¼Œç­‰å¾…åˆ›å»ºå­—æ®µã€‚</font><font style="vertical-align: inherit;">ä¸€åˆ‡éƒ½ä¸ä¼šå‘ç”Ÿã€‚</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGUI</span>(<span class="hljs-params">Rect position, SerializedProperty property, GUIContent label</span>)</span><font></font>
{<font></font>
       SandboxField sandboxField = GetTarget&lt;T&gt;(property);<font></font>
       <span class="hljs-keyword">if</span> (sandboxField == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<font></font>
â€¦<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é‡Œçš„GetTargetï¼ˆï¼‰æ˜¯ç›¸åº”çš„å‡½æ•°ï¼Œå®ƒä»å±æ€§ä¸­è·å–åºåˆ—åŒ–çš„å¯¹è±¡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¡ºä¾¿è¯´ä¸€å¥ï¼Œæˆ‘å»ºè®®æ‚¨ä¸è¦å°†æˆ‘ä»¬æ„Ÿå…´è¶£çš„é¢†åŸŸå¸¦å…¥GetPropertyHeightä¸­ã€‚å¦‚æœæˆ‘ä»¬æ ¹æ®å†…å®¹ç¼–å†™ä¸åŒå¤§å°çš„å¯æŠ˜å å¯æ‰©å±•å­—æ®µï¼Œåˆ™å°†éœ€è¦æ­¤å­—æ®µã€‚ GetPropertyHeightï¼ˆï¼‰åœ¨OnGUIï¼ˆï¼‰ä¹‹å‰è¢«è°ƒç”¨ï¼Œå› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ­¤å¤„è·å–ä¸€ä¸ªå­—æ®µå¹¶å°†å…¶å†™å…¥PropertyDrawerçš„å­—æ®µä¸­ï¼Œåˆ™æ— éœ€å†æ¬¡å°†å…¶å¸¦åˆ°OnGUIã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯·æ³¨æ„ï¼Œå°†å•ç‹¬åˆ›å»ºè‡ªå®šä¹‰PropertyDrawerçš„å®ä¾‹ä»¥ç»˜åˆ¶æ‰€æœ‰å½“å‰å¯è§çš„åºåˆ—åŒ–å±æ€§ï¼Œç„¶åä»ä¸Šåˆ°ä¸‹ä¾æ¬¡å‘å…¶æŠ›å‡ºæ–°å±æ€§ã€‚åº”è¯¥è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥å…å½±å“ä¸‹ä¸€ä¸ªå±æ€§çš„é«˜åº¦çš„è®¡ç®—ï¼Œå¦åˆ™ï¼Œå½“æ‚¨å•å‡»æŠ˜å å¹¶æ‰©å±•æœŸæœ›çš„å­—æ®µæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸æ„‰å¿«çš„æƒ…å†µã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦å¤–ï¼Œæ‰€æœ‰è´Ÿè´£åœ¨ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºè¯¥å­—æ®µå¹¶è¦è¿›è¡Œåºåˆ—åŒ–çš„é‡‘å±ä¸ï¼Œéƒ½åº”è¯¥åœ¨å¯åºåˆ—åŒ–ç±»ï¼ˆè€Œä¸æ˜¯PropertyDrawerï¼‰çš„ä¸€ä¾§è¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶ä¸”å‡ºäºå‡†ç¡®æ€§çš„è€ƒè™‘ï¼Œè¯·é™„ä¸Šæ¡ä»¶ç¼–è¯‘æ‹¬å·ï¼Œä»¥å…æ‰€æœ‰æ­¤ç±»è¥¿ç­ç‰™è€»è¾±éƒ½ä¸ä¼šå°è¯•è¿›è¡Œæ„å»ºï¼š</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">Serializable</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SandboxField</span><font></font>
{<font></font>
â€¦<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> UNITY_EDITOR</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> editorFoldout;
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
â€¦<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œç­‰å¾…ç€æˆ‘ä»¬çš„å¦ä¸€ä¸ªé™·é˜±ï¼šé€šè¿‡ç¼–è¾‘å™¨åˆ›å»ºçš„æ‰€æœ‰å­—æ®µéƒ½æƒ³åç»™ç±»æ„é€ å‡½æ•°å’Œç±»ä¸­æŒ‡å®šçš„é»˜è®¤å€¼ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¿™æ ·åšï¼ˆä¾‹å¦‚ï¼Œåœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œå®ƒæ˜¯æ°´é¢èŠ‚ç‚¹çš„å€¼ï¼‰ï¼š</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">SerializeField</span>]<span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> m_nodesPerUnit = <span class="hljs-number">5</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°†æ–°é¡¹ç›®æ·»åŠ åˆ°åˆ—è¡¨åï¼Œè¯¥å€¼å°†è¢«å¿½ç•¥ã€‚</font><font style="vertical-align: inherit;">è°ƒç”¨æ„é€ å‡½æ•°æ¥å¯»æ±‚å¸®åŠ©ä¹Ÿæ— æµäºäº‹ï¼šæ‚¨åœ¨æ­¤å¤„ç¼–å†™çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«å¿½ç•¥ã€‚</font><font style="vertical-align: inherit;">æ–°å¯¹è±¡æ˜¯ä¸€ä¸ªåƒçŒé¹°ä¸€æ ·çš„ç›®æ ‡ï¼Œå®ƒçš„æ‰€æœ‰å€¼å®é™…ä¸Šéƒ½æ˜¯é»˜è®¤å€¼ï¼Œä¸æ˜¯æ‚¨æƒ³è¦åœ¨å…¶ä¸­çœ‹åˆ°çš„å€¼ï¼Œè€Œæ˜¯å„ç§å„æ ·çš„nullï¼Œfalseï¼Œ0ï¼ŒColor.clearå’Œå…¶ä»–æ·«ç§½çš„ä¸œè¥¿ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‚‰æ‹æ–</font></font></b>
                        <div class="spoiler_text">  .   NonUnitySerializableClass,       .      , DefaultEditorObject(),    . <br>
<br>
  - :<br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NonUnitySerializableClass</span><font></font>
{<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DefaultEditorObject</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            <span class="hljs-comment">// virtually do nothing</span><font></font>
        }<font></font>
<font></font>
        [<span class="hljs-meta">SerializeField</span>]<span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> validated = <span class="hljs-literal">false</span>;
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">EditorCreated</span>(<span class="hljs-params"><span class="hljs-keyword">bool</span> force = <span class="hljs-literal">false</span></span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (validated &amp;&amp; !force) <span class="hljs-keyword">return</span>;<font></font>
            DefaultEditorObject();<font></font>
            validated = <span class="hljs-literal">true</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">NonUnitySerializableClass</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            EditorCreated(<span class="hljs-literal">true</span>);<font></font>
        }<font></font>
}</code></pre><br>
        DefaultEditorObject(),    ,   EditorCreated     .<br>
<br>
 :       .<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fg/dh/dr/fgdhdrfczfhhcki7dw6plxzj7vi.png"></div><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬å›åˆ°ç»µç¾Šï¼Œæˆ–è€…è¯´æ•°ç»„ã€‚</font><font style="vertical-align: inherit;">åœ¨æ›´æ—©çš„é˜¶æ®µå¯èƒ½ä¼šå‡ºç°çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼š</font></font><br>
<br>
<pre><code class="cs hljs">FieldInfo objectFieldInfo = objectType.GetField(pathNode);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœå³ä¾§é‡åˆ°åºåˆ—åŒ–è·¯å¾„ä¸­çš„æ•°ç»„ï¼Œåˆ™å³ä¾§å¯ä»¥å°†æˆ‘ä»¬è¿”å›é›¶ï¼ˆå¹¶ä¸”ä»»ä½•â€œ IListâ€å¯¹è±¡éƒ½å°†æ˜¯â€œ Arrayâ€æ•°ç»„ï¼‰ã€‚</font><font style="vertical-align: inherit;">ä¸æ„‰å¿«ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥æ€ä¹ˆåŠï¼Ÿ</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼–å†™å¤„ç†ç¨‹åºï¼Œ</font><s><font style="vertical-align: inherit;">å°½é‡ä¸è¦é™·å…¥è¿™ç§æƒ…å†µ</font></s><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; pathNode.Length; i++)<font></font>
{<font></font>
        <span class="hljs-keyword">string</span> pathNode = path[i];<font></font>
        Type objectType = currentObject.GetType();<font></font>
        FieldInfo objectFieldInfo = objectType.GetField(pathNode);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (objectFieldInfo == <span class="hljs-literal">null</span>)<font></font>
        {<font></font>
                <span class="hljs-keyword">if</span> (pathNode == <span class="hljs-string">"Array"</span>)<font></font>
                {<font></font>
                        i++;<font></font>
                        <span class="hljs-keyword">string</span> nextNode = path[i];
                        <span class="hljs-keyword">string</span> idxstr = nextNode.Substring(nextNode.IndexOf(<span class="hljs-string">"["</span>) + <span class="hljs-number">1</span>);<font></font>
                        idxstr = idxstr.Replace(<span class="hljs-string">"]"</span>, <span class="hljs-string">""</span>);
                        <span class="hljs-keyword">int</span> arrayNumber = Convert.ToInt32(idxstr);<font></font>
                        IList collection = currentObject <span class="hljs-keyword">as</span> IList;
                        <span class="hljs-keyword">if</span> (collection.Count &lt;= arrayNumber) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
                        currentObject = collection[arrayNumber];<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span><font></font>
                {<font></font>
                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"   "</span>);<font></font>
                }<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-comment">//  ,     </span><font></font>
        {<font></font>
                <span class="hljs-keyword">object</span> nextObject = objectFieldInfo.GetValue(currentObject);
                <span class="hljs-keyword">if</span> (nextObject == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
                currentObject = nextObject;<font></font>
        }<font></font>
}<font></font>
<span class="hljs-keyword">return</span> currentObject;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¯çš„ï¼Œå½“ä¸²è¡ŒåŒ–è·¯å¾„å·²å…·æœ‰ä¾‹å¦‚data [0]æˆ–data [1]å…ƒç´ ï¼Œè€Œæ•°ç»„å°šæœªå®ç°å®ƒæ—¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥é™·å…¥ä¸€ç§ä¸æ„‰å¿«çš„å¢ƒåœ°ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬é—®ä»–Nä¸ªå…ƒç´ -æ²¡æœ‰è¿™ä¸ªæ¼‚äº®çš„çº¿æ¡ï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> (collection.Count &lt;= arrayNumber) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...æˆ‘ä»¬ä¼šæ”¶åˆ°å¾ˆå¤šå¼‚å¸¸çš„å£°éŸ³ã€‚</font><font style="vertical-align: inherit;">è€Œæ‰€æœ‰éœ€è¦åšçš„å°±æ˜¯è·³è¿‡æ¸²æŸ“æ­¥éª¤ï¼Œç›´åˆ°åˆ›å»ºäº†æˆ‘ä»¬æ„Ÿå…´è¶£çš„å­—æ®µã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘è¿˜æ²¡æœ‰é‡åˆ°objectFieldInfo == nullçš„å…¶ä»–æƒ…å†µï¼Œä½†æ˜¯æœªå°†åºåˆ—åŒ–èŠ‚ç‚¹æŒ‡å®šä¸ºArrayï¼Œå› æ­¤åœ¨è¿™ç§å‡è®¾çš„ç‰¹æ®Šæƒ…å†µä¸‹æŠ›å‡ºå¯æ€•çš„å¼‚å¸¸æ˜¯éšåå¯¹å…¶è¿›è¡Œç ´è§£ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šå¸¸ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæˆ–å¤šæˆ–å°‘çš„å·¥ä½œå‡½æ•°ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡å…¶åºåˆ—åŒ–å±æ€§æå–å­—æ®µã€‚</font><font style="vertical-align: inherit;">å°†æ¥ï¼Œå¯ä»¥é€šè¿‡å¼ºåˆ¶æå–åºåˆ—åŒ–è·¯å¾„ä¸­çš„æ‰€æœ‰å¯¹è±¡ä»¥åŠæœç´¢æœ€æ¥è¿‘çš„â€œçˆ¶å¯¹è±¡â€ï¼ˆåŒ…æ‹¬æˆ–æ’é™¤æ²¿è¯¥è·¯å¾„çš„æ•°ç»„ï¼‰æ¥ä¿®æ”¹æ­¤åŠŸèƒ½ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæ´»é»‘å®¢ç»˜åˆ¶åµŒå¥—å±æ€§</font></font></b>
                        <div class="spoiler_text">      -  ,   Rect position  Rect indentedPosition = EditorGUI.IndentedRect(position).     ,         EditorGUI,      position ,       GUI â€“    indentedPosition.   EditorGUILayout  OnGUI,       (   ,   ).<br>
<br>
    ,   MonoScript   (     -,   ),     static-,      AssetDatabase,        <i></i>         .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è°¢è°¢æ‚¨çš„å…³æ³¨ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN502818/index.html">Y Messengerï¼šåŒºå—é“¾ä¸Šçš„åˆ†æ•£Messenger *</a></li>
<li><a href="../zh-CN502826/index.html">3D Creaform MetraSCAN 3Dæ‰«æä»ªæ¦‚è¿°</a></li>
<li><a href="../zh-CN502830/index.html">åœ¨çº¿é»‘å®¢é©¬æ‹‰æ¾â€œ New Realityâ€ VirusHackã€‚å®ƒæ€ä¹ˆæ ·</a></li>
<li><a href="../zh-CN502832/index.html">åœ¨çº¿æä¾›ISTQBè®¤è¯ï¼šä¸ªäººç»éªŒ</a></li>
<li><a href="../zh-CN502834/index.html">å¦‚ä½•åœ¨å…­ä¸ªæœˆç”šè‡³æ›´å¿«çš„æ—¶é—´å†…æˆä¸ºä¸€åDevOpså·¥ç¨‹å¸ˆã€‚ç¬¬5éƒ¨åˆ†ã€‚éƒ¨ç½²</a></li>
<li><a href="../zh-CN502838/index.html">ITå’Œæ•°å­—èŒä¸šä¹‹é—´çš„åŒºåˆ«æ˜¯ï¼šæ•°å­—åŒ–è½¬å‹å’Œä¸“å®¶æ„è§</a></li>
<li><a href="../zh-CN502840/index.html">é—ªäº®çš„3D EinScan Pro 2X Plus 3Dæ‰«æä»ªè¯„è®º</a></li>
<li><a href="../zh-CN502842/index.html">å¦‚ä½•ä¿æŠ¤ç”¨æˆ·ç”Ÿç‰©ç‰¹å¾æ•°æ®å…å—çŠ¯ç½ªä½¿ç”¨</a></li>
<li><a href="../zh-CN502844/index.html">[ç¬¬2/2éƒ¨åˆ†] FFmpegå’ŒSDLæŒ‡å—æˆ–å¦‚ä½•ç¼–å†™å°‘äº1000è¡Œçš„è§†é¢‘æ’­æ”¾å™¨</a></li>
<li><a href="../zh-CN502846/index.html">æ‰å…‹ä¼¯æ ¼å¼€è®¾äº†å•†åº—ã€‚Instagramå’ŒFacebooké€æ¸æˆä¸ºå•†åº—ã€‚</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>