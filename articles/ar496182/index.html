<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ฅ ๐ ุฃุจุงุชุดู ูุงููุง ูุงูุฏูู ๐ฉโ๐งโ๐ง ๐ก ๐ช</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุณุชููู ูุฐู ุงูููุงูุฉ ูููุฏุฉ ูุฃููุฆู ุงูุฐูู ุจุฏุฃูุง ููุชู ูู ุงูุชุนุฑู ุนูู ููุฏุณุฉ ุงูุฎุฏูุงุช ุงูุตุบูุฑุฉ ูุฎุฏูุฉ Apache Kafka. ูุง ุชุฏุนู ุงููุงุฏุฉ ุฃููุง ุจุฑูุงูุฌ ุชุนูููู ููุตู ุ ููููู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุฃุจุงุชุดู ูุงููุง ูุงูุฏูู</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496182/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุชููู ูุฐู ุงูููุงูุฉ ูููุฏุฉ ูุฃููุฆู ุงูุฐูู ุจุฏุฃูุง ููุชู ูู ุงูุชุนุฑู ุนูู ููุฏุณุฉ ุงูุฎุฏูุงุช ุงูุตุบูุฑุฉ ูุฎุฏูุฉ Apache Kafka. </font><font style="vertical-align: inherit;">ูุง ุชุฏุนู ุงููุงุฏุฉ ุฃููุง ุจุฑูุงูุฌ ุชุนูููู ููุตู ุ ูููููุง ุณุชุณุงุนุฏู ุนูู ุงูุจุฏุก ุจุณุฑุนุฉ ุจุงุณุชุฎุฏุงู ูุฐู ุงูุชูููููุฌูุง. </font><font style="vertical-align: inherit;">ุณุฃุชุญุฏุซ ุนู ููููุฉ ุชุซุจูุช ูุชูููู Kafka ุนูู Windows 10. ูุณูููู ุฃูุถูุง ุจุฅูุดุงุก ูุดุฑูุน ุจุงุณุชุฎุฏุงู Intellij IDEA ู Spring Boot.</font></font><a name="habracut"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุงุ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุบุงูุจูุง ูุง ุชุฑุชุจุท ุงูุตุนูุจุงุช ูู ููู ุงูุฃุฏูุงุช ุงููุฎุชููุฉ ุจุญูููุฉ ุฃู ุงููุทูุฑ ูู ููุงุฌู ุฃุจุฏูุง ููุงูู ูุฏ ุชููู ูููุง ูุฐู ุงูุฃุฏูุงุช ูุทููุจุฉ. ูุน ูุงููุง ุ ูุฐุง ูู ููุณู ุชูุงููุง. ูุตู ุงููุถุน ุงูุฐู ุณุชููู ููู ูุฐู ุงูุชูููุฉ ูููุฏุฉ. ุฅุฐุง ูุงู ูุฏูู ุจููุฉ ุชุทุจูู ูุชุฌุงูุณุฉ ุ ูุฃูุช ุจุงูุทุจุน ูุง ุชุญุชุงุฌ ุฅูู ุฃู ูุงููุง. ูู ุดูุก ูุชุบูุฑ ูุน ุงูุงูุชูุงู ุฅูู ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ. ูู ุงููุงูุน ุ ูู ุฎุฏูุฉ ูุงููุฑูุณูุฑู ูู ุจุฑูุงูุฌ ูููุตู ูููู ุจูุธููุฉ ูุงุญุฏุฉ ุฃู ุฃุฎุฑู ุ ููููู ุฅุทูุงูู ุจุดูู ูุณุชูู ุนู ุงูุฎุฏูุงุช ุงูุตุบูุฑุฉ ุงูุฃุฎุฑู. ูููู ููุงุฑูุฉ ุงูุฎุฏูุงุช ุงูุตุบูุฑุฉ ูุน ุงูููุธููู ูู ุงูููุชุจ ุ ุงูุฐูู ูุฌูุณูู ูู ููุงุชุจ ูููุตูุฉ ููุญููู ูุดููุชูู ุจุดูู ูุณุชูู. ุนูู ูุฐุง ุงููุฑูู ุงูููุฒุน ูุง ูููู ุชุตูุฑู ุจุฏูู ุชูุณูู ูุฑูุฒู.ูุฌุจ ุฃู ูููู ุงูููุธููู ูุงุฏุฑูู ุนูู ุชุจุงุฏู ุงูุฑุณุงุฆู ููุชุงุฆุฌ ุนูููู ูุน ุจุนุถูู ุงูุจุนุถ. ุชู ุชุตููู Apache Kafka ููุฎุฏูุงุช ุงูุตุบูุฑุฉ ูุญู ูุฐู ุงููุดููุฉ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุจุงุชุดู ูุงููุง ูุณูุท ุฑุณุงุฆู. ูุน ุฐูู ุ ูููู ุฃู ุชุชูุงุนู ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ ูุน ุจุนุถูุง ุงูุจุนุถ ุ ูุฅุฑุณุงู ูุงุณุชูุจุงู ูุนูููุงุช ูููุฉ. ุงูุณุคุงู ุงูุฐู ูุทุฑุญ ููุณู ุ ููุงุฐุง ูุง ุชุณุชุฎุฏู POST ุงูุนุงุฏู - reqest ููุฐู ุงูุฃุบุฑุงุถ ุ ูู ุฌุณูู ููููู ููู ุงูุจูุงูุงุช ุงููุงุฒูุฉ ูุงูุญุตูู ุนูู ุงูุฅุฌุงุจุฉ ุจููุณ ุงูุทุฑููุฉุ ูุฐุง ุงูููุฌ ูู ุนุฏุฏ ูู ุงูุนููุจ ุงููุงุถุญุฉ. ุนูู ุณุจูู ุงููุซุงู ุ ูููู ููููุชุฌ (ุฎุฏูุฉ ุชุฑุณู ุฑุณุงูุฉ) ุฅุฑุณุงู ุงูุจูุงูุงุช ููุท ูู ุดูู ุงุณุชุฌุงุจุฉ ุงุณุชุฌุงุจุฉ ูุทูุจ ูู ุงููุณุชููู (ุฎุฏูุฉ ุชุณุชูุจู ุงูุจูุงูุงุช). ุงูุชุฑุถ ุฃู ุงููุณุชููู ูุฑุณู ุทูุจ POST ููุฌูุจ ุนููู ุงูููุชุฌ. ูู ูุฐุง ุงูููุช ุ ูุณุจุจ ูุง ุ ูุง ูููู ูููุณุชููู ูุจูู ุงูุฅุฌุงุจุฉ. ูุงุฐุง ุณูุญุฏุซ ููุจูุงูุงุชุ ุณูู ูุถูุนูู. ุณูุถุทุฑ ุงููุณุชููู ูุฑุฉ ุฃุฎุฑู ุฅูู ุฅุฑุณุงู ุทูุจ ููุฃูู ูู ุนุฏู ุชุบูุฑ ุงูุจูุงูุงุช ุงูุชู ูุฑูุฏ ุชููููุง ุฎูุงู ูุฐู ุงููุชุฑุฉ ุูุงูููุชุฌ ูุง ูุฒุงู ุนูู ุงุณุชุนุฏุงุฏ ููุจูู ุงูุทูุจ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุจุงุชุดู ูุงููุง ูุญู ูุฐุง ูุงูุนุฏูุฏ ูู ุงููุดุงูู ุงูุฃุฎุฑู ุงูุชู ุชูุดุฃ ุนูุฏ ุชุจุงุฏู ุงูุฑุณุงุฆู ุจูู ุงูุฎุฏูุงุช ุงูุตุบูุฑุฉ. </font><font style="vertical-align: inherit;">ูู ูููู ูู ุงูุฎุทุฃ ุงูุชุฐููุฑ ุจุฃู ุชุจุงุฏู ุงูุจูุงูุงุช ุจุดูู ูุชูุงุตู ููุฑูุญ ูู ุฃุญุฏ ุงููุดุงูู ุงูุฑุฆูุณูุฉ ุงูุชู ูุฌุจ ุญููุง ูุถูุงู ุงูุชุดุบูู ุงููุณุชูุฑ ููููู ุงูุฎุฏูุงุช ุงูุตุบูุฑุฉ.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชุซุจูุช ูุชูููู ZooKeeper ู Apache Kafka ุนูู Windows 10</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูู ุดูุก ุชุญุชุงุฌ ุฅูู ูุนุฑูุชู ููุจุฏุก ูู ุฃู Apache Kafka ูุนูู ุนูู ุฎุฏูุฉ ZooKeeper. ZooKeeper ูู ุฎุฏูุฉ ุชููุฆุฉ ููุฒุงููุฉ ููุฒุนุฉ ุ ููุฐุง ูู ูุง ูุญุชุงุฌ ุฅูู ูุนุฑูุชู ุนูู ูู ูุฐุง ุงูุณูุงู. ูุฌุจ ุนูููุง ุชูุฒููู ูุชููููู ูุชุดุบููู ูุจู ุฃู ูุจุฏุฃ ูุน Kafka. ูุจู ุงูุจุฏุก ูู ุงูุนูู ูุน ZooKeeper ุ ุชุฃูุฏ ูู ุชุซุจูุช JRE ูุชููููู. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุชูุฒูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู ZooKeeper ูู ุงููููุน ุงูุฑุณูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุงุณุชุฎุฑุงุฌ ุงููููุงุช ูู ุฃุฑุดูู ZooKeeper ุงูุฐู ุชู ุชูุฒููู ุฅูู ูุฌูุฏ ุนูู ุงููุฑุต. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฌูุฏ zookeeper ุจุฑูู ุงูุฅุตุฏุงุฑ ุ ูุฌุฏ ูุฌูุฏ conf ูููู ุงูููู "zoo_sample.cfg".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ho/ke/pz/hokepzidcuiupzigc3i3wtlxi6s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจูุณุฎู ูุชุบููุฑ ุงุณู ุงููุณุฎุฉ ุฅูู "zoo.cfg". ุงูุชุญ ููู ุงููุณุฎ ูุงุจุญุซ ุนู ุณุทุฑ dataDir = / tmp / zookeeper ููู. ูู ูุฐุง ุงูุณุทุฑ ููุชุจ ุงููุณุงุฑ ุงููุงูู ููุฌูุฏ zookeeper-x.x.x. ูุจุฏู ูู ูุฐุง: dataDir = C: \\ ZooKeeper \\ zookeeper-3.6.0 </font></font><br>
<img src="https://habrastorage.org/webt/ri/sk/2h/risk2h-3u771fpod5vvxodydrhy.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูุถูู ูุชุบูุฑ ุจูุฆุฉ ุงููุธุงู: ZOOKEEPER_HOME = C: \ ZooKeeper \ zookeeper-3.4.9 ููู ููุงูุฉ ูุชุบูุฑ ุงููุธุงู ุ ูู ุจุฅุถุงูุฉ ุงูุฅุฏุฎุงู: ุูช ZOOKEEPER_HOME ูช \ ุณูุฉ ููููุงุชุ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุดุบูู ุณุทุฑ ุงูุฃูุงูุฑ ูุงูุชุจ ุงูุฃูุฑ:</font></font><br>
<br>
<pre><code class="cs hljs">zkserver</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ุฅุฐุง ุชู ุชูููุฐ ูู ุดูุก ุจุดูู ุตุญูุญ ุ ูุณุชุฑู ุดูุฆูุง ูุซู ูุง ููู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/rs/i6/b-rsi6uqc40e77tchqnimmhsgo8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ูุนูู ุฃู ZooKeeper ุจุฏุฃ ุจุดูู ุทุจูุนู. ููุชูู ูุจุงุดุฑุฉ ุฅูู ุชุซุจูุช ูุชูููู ุฎุงุฏู Apache Kafka. ูู ุจุชูุฒูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู ุงููููุน ุงูุฑุณูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุณุชุฎุฑุฌ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญุชููุงุช ุงูุฃุฑุดูู: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">kafka.apache.org/downloads</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ูู ุงููุฌูุฏ ูุน Kafka ูุฌุฏ ูุฌูุฏ ุงูุชูููู ุ ุญูุซ ูุฌุฏ ููู server.properties ูููุชุญู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/px/o5/m0/pxo5m032s0lvvmjqbhmfaazfnog.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุฏ ุณุทุฑ log.dirs = / tmp / kafka-logs ููุดูุฑ ููู ุฅูู ุงููุณุงุฑ ุงูุฐู ุณูุญูุธ ููู Kafka ุงูุณุฌูุงุช: log.dirs = c: / kafka / kafka-logs. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gh/bi/mg/ghbimgkxct-2ox1a8s8klpackco.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ููุณ ุงููุฌูุฏ ุ ูู ุจุชุญุฑูุฑ ููู zookeeper.properties. ูููู ุจุชุบููุฑ ุงูุณุทุฑ dataDir = / tmp / zookeeper ุฅูู dataDir = c: / kafka / zookeeper-data ุ ุฏูู ูุณูุงู ุงูุฅุดุงุฑุฉ ุฅูู ุงููุณุงุฑ ุฅูู ูุฌูุฏ Kafka ุจุนุฏ ุงุณู ุงููุฑุต. ุฅุฐุง ูุนูุช ูู ุดูุก ุจุดูู ุตุญูุญ ุ ููููู ุชุดุบูู ZooKeeper ู Kafka.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yd/nd/mr/ydndmrfkovlk4z75mc99lbs3clk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงููุณุจุฉ ููุจุนุถ ุ ูุฏ ุชููู ููุงุฌุฃุฉ ุบูุฑ ุณุงุฑุฉ ุฃูู ูุง ููุฌุฏ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ ููุณูุทุฑุฉ ุนูู ูุงููุง. </font><font style="vertical-align: inherit;">ุฑุจูุง ูุฑุฌุน ุฐูู ุฅูู ุฃู ุงูุฎุฏูุฉ ูุตููุฉ ููููุชููู ุงูุฐูู ูุนูููู ุจุดูู ุญุตุฑู ูุน ูุญุฏุฉ ุงูุชุญูู. </font><font style="vertical-align: inherit;">ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุ ูุชุดุบูู ูุงููุง ูุญู ุจุญุงุฌุฉ ุฅูู ุณุทุฑ ุฃูุงูุฑ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญุชุงุฌ ุฃููุงู ุฅูู ุจุฏุก ZooKeeper. </font><font style="vertical-align: inherit;">ูู ุงููุฌูุฏ ูุน kafka ูุฌุฏ ูุฌูุฏ bin / windows ุ ุญูุซ ูุฌุฏ ุงูููู ูุจุฏุก ุฎุฏูุฉ zookeeper-server-start.bat ุ ุงููุฑ ูููู. </font><font style="vertical-align: inherit;">ูู ูุญุฏุซ ุดูุกุ </font><font style="vertical-align: inherit;">ูุฌุจ ุฃู ูููู ุงูุฃูุฑ ูุฐูู. </font><font style="vertical-align: inherit;">ุงูุชุญ ูุญุฏุฉ ุงูุชุญูู ูู ูุฐุง ุงููุฌูุฏ ูุงูุชุจ:</font></font><br>
<br>
<pre><code class="cs hljs"> start zookeeper-server-start.bat</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ูุง ูุนูู ูุฑุฉ ุฃุฎุฑูุ </font><font style="vertical-align: inherit;">ูุฐุง ูู ุงููุนูุงุฑ. </font><font style="vertical-align: inherit;">ุฐูู ูุฃู zookeeper-server-start.bat ูุชุทูุจ ุงููุนููุงุช ุงููุญุฏุฏุฉ ูู ููู zookeeper.properties ุ ูุงูุชู ุ ููุง ูุชุฐูุฑ ุ ุชููู ูู ูุฌูุฏ ุงูุชูููู ูุนููู. </font><font style="vertical-align: inherit;">ููุชุจ ุฅูู ูุญุฏุฉ ุงูุชุญูู:</font></font><br>
<br>
<pre><code class="cs hljs">start zookeeper-server-start.bat c:\kafka\config\zookeeper.properties </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูุฌุจ ุฃู ูุจุฏุฃ ูู ุดูุก ุจุดูู ุทุจูุนู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wn/q1/hr/wnq1hrvtfit6o_mgsqkdkrzcjiw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑุฉ ุฃุฎุฑู ุ ุงูุชุญ ูุญุฏุฉ ุงูุชุญูู ูู ูุฐุง ุงููุฌูุฏ (ูุง ุชุบูู ZooKeeper!) ููู ุจุชุดุบูู kafka:</font></font><br>
<br>
<pre><code class="cs hljs">start kafka-server-start.bat c:\kafka\config\server.properties</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ูุง ุชูุชุจ ุฃูุงูุฑ ูู ูู ูุฑุฉ ุนูู ุณุทุฑ ุงูุฃูุงูุฑ ุ ููููู ุงุณุชุฎุฏุงู ุงูุทุฑููุฉ ุงููุฏููุฉ ุงููุซุจุชุฉ ูุฅูุดุงุก ููู ุฏูุนู ุจุงููุญุชููุงุช ุงูุชุงููุฉ:</font></font><br>
<br>
<pre><code class="cs hljs">start C:\kafka\bin\windows\zookeeper-server-start.bat C:\kafka\config\zookeeper.properties<font></font>
timeout <span class="hljs-number">10</span>
start C:\kafka\bin\windows\kafka-server-start.bat C:\kafka\config\server.properties</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎุท ุงููููุฉ 10 ูุทููุจ ูุชุนููู ูููุฉ ุจูู ุจุฏุก zookeeper ู kafka. </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุจูู ุดูุก ุจุดูู ุตุญูุญ ุ ุนูุฏ ุงูููุฑ ููู ููู ุงูุฏููุนุงุช ุ ูุฌุจ ูุชุญ ูุญุฏุชู ุชุญูู ูุน ุชุดุบูู zookeeper ู kafka. ุงูุขู ูููููุง ุฅูุดุงุก ููุชุฌ ุฑุณุงูุฉ ููุณุชููู ุจุงููุนููุงุช ุงูุถุฑูุฑูุฉ ูุจุงุดุฑุฉ ูู ุณุทุฑ ุงูุฃูุงูุฑ. </font><font style="vertical-align: inherit;">ูููู ุ ูู ุงููุงุญูุฉ ุงูุนูููุฉ ุ ูุฏ ุชููู ููุงู ุญุงุฌุฉ ุฅูููุง ุฅูุง ูุงุฎุชุจุงุฑ ุงูุฎุฏูุฉ. </font><font style="vertical-align: inherit;">ุณูููู ุฃูุซุฑ ุงูุชูุงููุง ุจููููุฉ ุงูุนูู ูุน ูุงููุง ูู IDEA.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนูู ูุน ูุงููุง ูู IDEA</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณููุชุจ ุฃุจุณุท ุชุทุจูู ูููู ุ ูุงูุฐู ุณูููู ูู ููุณ ุงูููุช ููุชุฌ ุงูุฑุณุงูุฉ ููุณุชููููุง ุ ุซู ูุถูู ููุฒุงุช ูููุฏุฉ ุฅูููุง. </font><font style="vertical-align: inherit;">ุฅูุดุงุก ูุดุฑูุน ุฑุจูุนู ุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ูุชู ุฐูู ุจุดูู ุฃูุซุฑ ููุงุกูุฉ ุจุงุณุชุฎุฏุงู ููููุฆ ุงูุฑุจูุน. </font><font style="vertical-align: inherit;">ุฃุถู ุงูุชุจุนูุงุช org.springframework.kafka ู spring-boot-starter-web </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n8/tv/vd/n8tvvda_h1eedp1j7iodblqnv3u.png"><br>
<br>
<img src="https://habrastorage.org/webt/so/kb/pw/sokbpw-hvkzn8ihnzsokhqn0-yo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชูุฌุฉ ูุฐูู ุ ูุฌุจ ุฃู ูุจุฏู ููู pom.xml ููุง ููู: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/oc/ub/gwocubssaaqvggzlya-mgdwso24.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุฑุณุงู ุงูุฑุณุงุฆู ุ ูุญุชุงุฌ ุฅูู ูุงุฆู KafkaTemplate &lt;Kุ V&gt;. </font><font style="vertical-align: inherit;">ููุง ูุฑู ูุชู ูุชุงุจุฉ ุงููุงุฆู. </font><font style="vertical-align: inherit;">ุงููุนููุฉ ุงูุฃููู ูู ููุน ุงูููุชุงุญ ุ ูุงูุซุงููุฉ ูู ุงูุฑุณุงูุฉ ููุณูุง. </font><font style="vertical-align: inherit;">ูู ุงูููุช ุงูุญุงูู ุ ุณูุดูุฑ ุฅูู ููุง ุงููุนููุชูู ูุณูุณูุฉ. </font><font style="vertical-align: inherit;">ุณูููู ุจุฅูุดุงุก ุงููุงุฆู ูู ูุญุฏุฉ ุชุญูู ุงููุฆุฉ. </font><font style="vertical-align: inherit;">ูู ุจุชุนุฑูู ูุงูุจ Kafka ูุงุทูุจ ูู ุงูุฑุจูุน ุฃู ูููู ุจุชููุฆุชู ุนู ุทุฑูู ุงูุชุนููู</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autowired</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> KafkaTemplate&lt;String, String&gt; kafkaTemplate;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุญูุซ ุงููุจุฏุฃ ุ ููุชุฌูุง ุฌุงูุฒ. ูู ูุง ุนููู ูุนูู ูู ุงุณุชุฏุนุงุก ุทุฑููุฉ ุงูุฅุฑุณุงู () ุนููู. ููุงู ุงูุนุฏูุฏ ูู ุงูุฅุตุฏุงุฑุงุช ุงููุญููุฉ ุจูุฐู ุงูุทุฑููุฉ. ูุณุชุฎุฏู ูู ูุดุฑูุนูุง ุฎูุงุฑูุง ูุญุชูู ุนูู 3 ูุนููุงุช - ุฅุฑุณุงู (ููุถูุน ุงูุณูุณูุฉ ุ ููุชุงุญ K ุ ุจูุงูุงุช V). ูุธุฑูุง ููุชุงุจุฉ KafkaTemplate ุจูุงุณุทุฉ String ุ ูุณูููู ุงูููุชุงุญ ูุงูุจูุงูุงุช ูู ุทุฑููุฉ ุงูุฅุฑุณุงู ุนุจุงุฑุฉ ุนู ุณูุณูุฉ. ุชุญุฏุฏ ุงููุนููุฉ ุงูุฃููู ุงูููุถูุน ุ ุฃู ุงูููุถูุน ุงูุฐู ุณูุชู ุฅุฑุณุงู ุงูุฑุณุงุฆู ุฅููู ุ ูุงููุณุชููููู ุงูุฐูู ูููููู ุงูุงุดุชุฑุงู ููู ูุชููููุง. ุฅุฐุง ูุงู ุงูููุถูุน ุงููุญุฏุฏ ูู ุทุฑููุฉ ุงูุฅุฑุณุงู ุบูุฑ ููุฌูุฏ ุ ูุณูุชู ุฅูุดุงุคู ุชููุงุฆููุง. ูุจุฏู ุงููุต ุงููุงูู ููุตู ูุซู ูุฐุง.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("msg")</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MsgController</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> KafkaTemplate&lt;String, String&gt; kafkaTemplate;<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendOrder</span><span class="hljs-params">(String msgId, String msg)</span></span>{<font></font>
        kafkaTemplate.send(<span class="hljs-string">"msg"</span>, msgId, msg);<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญูู ูุญุฏุฉ ุงูุชุญูู ุฅูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8080 / msg ุ ูุชู ุฅุฑุณุงู ุงูููุชุงุญ ูุงูุฑุณุงูุฉ ููุณูุง ูู ูุต ุงูุทูุจ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑุณู ุงูุฑุณุงูุฉ ุฌุงูุฒ ุ ุงูุขู ูู ุจุฅูุดุงุก ูุณุชูุน. </font><font style="vertical-align: inherit;">ูุชูุญ ูู Spring ุฃูุถูุง ุงูููุงู ุจุฐูู ุฏูู ุจุฐู ุงููุซูุฑ ูู ุงูุฌูุฏ. </font><font style="vertical-align: inherit;">ูููู ุฅูุดุงุก ุทุฑููุฉ ููุถุน ุนูุงูุฉ ุนูููุง ูุน ุงูุชุนููู ุงูุชูุถูุญูKafkaListener ุ ูู ูุนููุงุช ููููู ุชุญุฏูุฏ ุงูููุถูุน ุงูุฐู ุณูุชู ุงูุงุณุชูุงุน ุฅููู ููุท. </font><font style="vertical-align: inherit;">ูู ุญุงูุชูุง ุ ูุจุฏู ูุฐุง.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@KafkaListener(topics="msg")</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ููุทุฑููุฉ ููุณูุง ุ ุงููููุฒุฉ ุจุนูุงูุฉ ุชูุถูุญูุฉ ุ ุฃู ุชุญุฏุฏ ูุนููุฉ ูุงุญุฏุฉ ููุจููุฉ ุ ููุง ููุน ุงูุฑุณุงูุฉ ุงูุชู ูุฑุณููุง ุงูููุชุฌ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ุชูููุฒ ุงููุตู ุงูุฏุฑุงุณู ุงูุฐู ุณูุชู ุฅูุดุงุก ุงููุณุชููู ููู ุจุชุนููู ุนููEnableKafka.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@EnableKafka</span>
<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleKafkaExampleApplication</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@KafkaListener(topics="msg")</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">msgListener</span><span class="hljs-params">(String msg)</span></span>{<font></font>
        System.out.println(msg);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{<font></font>
        SpringApplication.run(SimpleKafkaExampleApplication.class, args);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุถูุง ุ ูู ููู ุฅุนุฏุงุฏุงุช application.property ุ ูุฌุจ ุนููู ุชุญุฏูุฏ ูุนุฑู ูุฌููุนุฉ ูุนููุฉ ุงููููุณูุฑุฌ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูู ูุชู ุฐูู ุ ููู ูุจุฏุฃ ุงูุชุทุจูู. </font><font style="vertical-align: inherit;">ุงููุนููุฉ ูู ููุน String ููููู ุฃู ุชููู ุฃู ุดูุก.</font></font><br>
<br>
<pre><code class="cs hljs">spring.kafka.consumer.<span class="hljs-keyword">group</span>-id=app<span class="hljs-number">.1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุจุณุท ูุดุฑูุน ูุงููุง ุฌุงูุฒ. </font><font style="vertical-align: inherit;">ูุฏููุง ูุฑุณู ููุณุชูู ููุฑุณุงุฆู. </font><font style="vertical-align: inherit;">ูุจูู ููุท ูุชุดุบูู. </font><font style="vertical-align: inherit;">ุฃููุงู ุ ูู ุจุชุดุบูู ZooKeeper ู Kafka ุจุงุณุชุฎุฏุงู ููู ุฏูุนู ูุชุจูุงู ุณุงุจููุง ุ ุซู ูู ุจุชุดุบูู ุชุทุจูููุง. </font><font style="vertical-align: inherit;">ูู ุงูุฃูุณุจ ุฅุฑุณุงู ุทูุจ ุจุงุณุชุฎุฏุงู Postman. </font><font style="vertical-align: inherit;">ูู ูุต ุงูุทูุจ ุ ูุง ุชูุณ ุชุญุฏูุฏ ุงููุนููุงุช msgId ู msg. </font></font><br>
<img src="https://habrastorage.org/webt/_o/og/jt/_oogjtlzajgbbnpsf8sjg8k0num.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ุฑุฃููุง ูุซู ูุฐู ุงูุตูุฑุฉ ูู IDEA ุ ูุฅู ูู ุดูุก ูุนูู: ุฃุฑุณู ุงูููุชุฌ ุฑุณุงูุฉ ุ ูุงุณุชูููุง ุงููุณุชููู ูุนุฑุถูุง ุนูู ูุญุฏุฉ ุงูุชุญูู.</font></font><br>
<img src="https://habrastorage.org/webt/kg/zq/j3/kgzqj38qw5q67mmr0fa2ijucflw.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญู ูุนูุฏ ุงููุดุฑูุน</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุดุงุฑูุน ุงูุญููููุฉ ุงูุชู ุชุณุชุฎุฏู ูุงููุง ูู ุจุงูุชุฃููุฏ ุฃูุซุฑ ุชุนููุฏูุง ูู ุชูู ุงูุชู ุฃูุดุฃูุงูุง. ุงูุขู ุจุนุฏ ุฃู ุงูุชุดููุง ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ ููุฎุฏูุฉ ุ ููุฑ ูู ุงูููุฒุงุช ุงูุฅุถุงููุฉ ุงูุชู ุชููุฑูุง. ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุณูู ูููู ุจุชุญุณูู ุงูููุชุฌ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ูุชุญุช ุทุฑููุฉ send () ุ ููุฏ ุชูุงุญุธ ุฃู ุฌููุน ุงููุชุบูุฑุงุช ููุง ูููุฉ ุฅุฑุฌุงุน ูู ListenableFuture &lt;SendResult &lt;Kุ V &gt;&gt;. ุงูุขู ูู ูููุฑ ุจุงูุชูุตูู ูู ูุฏุฑุงุช ูุฐู ุงููุงุฌูุฉ. ููุง ุณูููู ูุงููุงู ุงูููู ุฃูู ูุทููุจ ูุนุฑุถ ูุชูุฌุฉ ุฅุฑุณุงู ุฑุณุงูุฉ.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@PostMapping</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendMsg</span><span class="hljs-params">(String msgId, String msg)</span></span>{<font></font>
    ListenableFuture&lt;SendResult&lt;String, String&gt;&gt; future = kafkaTemplate.send(<span class="hljs-string">"msg"</span>, msgId, msg);<font></font>
    future.addCallback(System.out::println, System.err::println);<font></font>
    kafkaTemplate.flush();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชูุจู ุทุฑููุฉ addCallback () ูุนููุชูู - SuccessCallback ู FailureCallback. </font><font style="vertical-align: inherit;">ููุงููุง ูุงุฌูุงุช ูุธูููุฉ. </font><font style="vertical-align: inherit;">ูู ุงูุงุณู ููููู ุฃู ุชููู ุฃู ุงูุทุฑููุฉ ุงูุฃููู ุณูุชู ุงุณุชุฏุนุงุคูุง ููุชูุฌุฉ ููุฅุฑุณุงู ุงููุงุฌุญ ููุฑุณุงูุฉ ุ ูุงูุซุงููุฉ - ูุชูุฌุฉ ูุฎุทุฃ. ุงูุขู ุ ุฅุฐุง ูููุง ุจุชุดุบูู ุงููุดุฑูุน ุ ูุณูู ูุฑู ุดูุฆูุง ูุซู ูุง ููู ุนูู ูุญุฏุฉ ุงูุชุญูู:</font></font><br>
<br>
<pre><code class="cs hljs">SendResult [producerRecord=ProducerRecord(topic=msg, partition=<span class="hljs-literal">null</span>, headers=RecordHeaders(headers = [], isReadOnly = <span class="hljs-literal">true</span>), key=<span class="hljs-number">1</span>, <span class="hljs-keyword">value</span>=Hello, world!, timestamp=<span class="hljs-literal">null</span>), recordMetadata=msg<span class="hljs-number">-0</span>@<span class="hljs-number">6</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ููุธุฑ ุจุนูุงูุฉ ุฅูู ููุชุฌูุง ูุฑุฉ ุฃุฎุฑู. </font><font style="vertical-align: inherit;">ููู ุงููุซูุฑ ููุงูุชูุงู ุ ูุง ุงูุฐู ูุญุฏุซ ุฅุฐุง ูู ููู ุงูููุชุงุญ ูู String ุ ูููู ุ ุนูู ุณุจูู ุงููุซุงู ุ Long ุ ูููู ูุฑุณุงูุฉ ูุฑุณูุฉ ุ ูุงูุฃุณูุฃ ูู ุฐูู - ููุน ูู DTO ุงููุนูุฏุ </font><font style="vertical-align: inherit;">ุฃููุงู ุ </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hl/3m/81/hl3m81wnp81kngs_abmdx9wemlm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง </font><font style="vertical-align: inherit;">ูุญุงูู ุชุบููุฑ ุงูููุชุงุญ ุฅูู ูููุฉ ุฑูููุฉ ... </font><font style="vertical-align: inherit;">ุฅุฐุง ุญุฏุฏูุง Long ุจุงุนุชุจุงุฑู ุงูููุชุงุญ ูู ุงูููุชุฌ ุ ูุณูุจุฏุฃ ุงูุชุทุจูู ุจุดูู ุทุจูุนู ุ ูููู ุนูุฏ ูุญุงููุฉ ุฅุฑุณุงู ุฑุณุงูุฉ ุ ุณูุชู ุทุฑุญ ClassCastException ูุณูุชู ุงูุฅุจูุงุบ ุนู ุฃูู ูุง ูููู ุฅุฑุณุงู ุงููุฆุฉ ุงูุทูููุฉ ุฅูู ูุฆุฉ String.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fe/ti/tz/fetitzsqvkjsetoigt8lwodxcbk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ุญุงูููุง ุฅูุดุงุก ูุงุฆู KafkaTemplate ูุฏูููุง ุ ูุณูุฑู ุฃู ูุงุฆู ูุงุฌูุฉ ProducerFactory &lt;Kุ V&gt; ุ ุนูู ุณุจูู ุงููุซุงู ุ DefaultKafkaProducerFactory &lt;&gt; ุ ูุชู ุชูุฑูุฑู ุฅูู ุงููููุดุฆ ููุนููุฉ. ูู ุฃุฌู ุฅูุดุงุก DefaultKafkaProducerFactory ุ ูุญุชุงุฌ ุฅูู ุชูุฑูุฑ ุฎุฑูุทุฉ ุชุญุชูู ุนูู ุฅุนุฏุงุฏุงุช ุงูููุชุฌ ุงูุฎุงุตุฉ ุจูุง ุฅูู ูููุดุฆูุง. ุณูุชู ูุถุน ุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุชูููู ูุฅูุดุงุก ุงูููุชุฌ ูู ูุฆุฉ ูููุตูุฉ. ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุญุฒูุฉ ุงูุชูููู ููููุง ูุฆุฉ KafkaProducerConfig.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KafkaProducerConfig</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> String kafkaServer=<span class="hljs-string">"localhost:9092"</span>;<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title">producerConfigs</span><span class="hljs-params">()</span> </span>{<font></font>
        Map&lt;String, Object&gt; props = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<font></font>
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,<font></font>
                kafkaServer);<font></font>
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG,<font></font>
                LongSerializer.class);<font></font>
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG,<font></font>
                StringSerializer.class);<font></font>
        <span class="hljs-keyword">return</span> props;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> ProducerFactory&lt;Long, String&gt; <span class="hljs-title">producerFactory</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultKafkaProducerFactory&lt;&gt;(producerConfigs());<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> KafkaTemplate&lt;Long, String&gt; <span class="hljs-title">kafkaTemplate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> KafkaTemplate&lt;&gt;(producerFactory());<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุทุฑููุฉ productionConfigs () ุ ูู ุจุฅูุดุงุก ุฎุฑูุทุฉ ูุน ุงูุชููููุงุช ูุญุฏุฏ LongSerializer.class ููุณูุณู ููููุชุงุญ. </font><font style="vertical-align: inherit;">ูุจุฏุฃ ุ ูุฑุณู ุทูุจูุง ูู Postman ููุฑู ุฃู ูู ุดูุก ูุนูู ุงูุขู ููุง ููุจุบู: ุงูููุชุฌ ูุฑุณู ุฑุณุงูุฉ ุ ููุณุชูููุง ุงููุณุชููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฏุนูุง ูุบูุฑ ููุน ุงููููุฉ ุงููุฑุณูุฉ. </font><font style="vertical-align: inherit;">ูุงุฐุง ูู ูู ููู ูุฏููุง ูุฆุฉ ููุงุณูุฉ ูู ููุชุจุฉ Java ุ ูููู ููุนูุง ูู DTO ูุฎุตุต. </font><font style="vertical-align: inherit;">ุฏุนูุง ูููู ูุฐุง.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDto</span> </span>{
    <span class="hljs-keyword">private</span> Long age;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Address address;<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span> </span>{
    <span class="hljs-keyword">private</span> String country;
    <span class="hljs-keyword">private</span> String city;
    <span class="hljs-keyword">private</span> String street;
    <span class="hljs-keyword">private</span> Long homeNumber;
    <span class="hljs-keyword">private</span> Long flatNumber;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุฑุณุงู DTO ูุฑุณุงูุฉ ุ ุชุญุชุงุฌ ุฅูู ุฅุฌุฑุงุก ุจุนุถ ุงูุชุบููุฑุงุช ุนูู ุชูููู ุงูููุชุฌ. </font><font style="vertical-align: inherit;">ุญุฏุฏ JsonSerializer.class ููุณูุณู ููููุฉ ุงูุฑุณุงูุฉ ููุง ุชูุณ ุชุบููุฑ ููุน ุงูุณูุณูุฉ ุฅูู UserDto ูู ูู ููุงู.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KafkaProducerConfig</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> String kafkaServer=<span class="hljs-string">"localhost:9092"</span>;<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title">producerConfigs</span><span class="hljs-params">()</span> </span>{<font></font>
        Map&lt;String, Object&gt; props = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<font></font>
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,<font></font>
                kafkaServer);<font></font>
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG,<font></font>
                LongSerializer.class);<font></font>
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG,<font></font>
                JsonSerializer.class);<font></font>
        <span class="hljs-keyword">return</span> props;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> ProducerFactory&lt;Long, UserDto&gt; <span class="hljs-title">producerFactory</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultKafkaProducerFactory&lt;&gt;(producerConfigs());<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> KafkaTemplate&lt;Long, UserDto&gt; <span class="hljs-title">kafkaTemplate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> KafkaTemplate&lt;&gt;(producerFactory());<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุฑุณู ุฑุณุงูุฉ. ุณูุชู ุนุฑุถ ุงูุณุทุฑ ุงูุชุงูู ูู ูุญุฏุฉ ุงูุชุญูู: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e8/2f/xu/e82fxufwzg_yai2rs5vx5athbts.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุณูููู ุจุชุนููุฏ ุงููุณุชููู. ูุจู ุฐูู ุ ูุงูุช ุทุฑููุชูุง ุงูุนุงูุฉ msgListener (String msg) ุ ูุงููุนููุฉ ุจุงูุชุนูููKafkaListener (ุงูููุงุถูุน = "msg") ุชุฃุฎุฐ String ููุนููุฉ ูุนุฑุถูุง ุนูู ูุญุฏุฉ ุงูุชุญูู. ูุงุฐุง ูู ุฃุฑุฏูุง ุงูุญุตูู ุนูู ูุนููุงุช ุฃุฎุฑู ููุฑุณุงูุฉ ุงููุฑุณูุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุชุงุญ ุฃู ูุณูุ ูู ูุฐู ุงูุญุงูุฉ ุ ูุฌุจ ุชุบููุฑ ููุน ุงููููุฉ ุงููุฑุณูุฉ.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@KafkaListener(topics="msg")</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">orderListener</span><span class="hljs-params">(ConsumerRecord&lt;Long, UserDto&gt; record)</span></span>{<font></font>
    System.out.println(record.partition());<font></font>
    System.out.println(record.key());<font></font>
    System.out.println(record.value());<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุงุฆู ConsumerRecord ุ ูููููุง ุงูุญุตูู ุนูู ุฌููุน ุงููุนููุงุช ุงูุชู ููุชู ุจูุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zq/ml/pw/zqmlpw7o5xzb0fxxzq7rez5qjpa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑู ุฃูู ุจุฏูุงู ูู ุงูููุชุงุญ ุงูููุฌูุฏ ุนูู ูุญุฏุฉ ุงูุชุญูู ุ ูุชู ุนุฑุถ ููุน ูู krakozyabry. ูุฐุง ูุฃูู ูุชู ุงุณุชุฎุฏุงู StringDeserializer ุจุดูู ุงูุชุฑุงุถู ูุฅูุบุงุก ุชุณูุณู ุงูููุชุงุญ ุ ูุฅุฐุง ุฃุฑุฏูุง ุฃู ูุชู ุนุฑุถ ุงูููุชุงุญ ุจุงูุชูุณูู ุงูุตุญูุญ ุจุดูู ุตุญูุญ ุ ููุฌุจ ุชุบููุฑู ุฅูู LongDeserializer. ูุชูููู ุงููุณุชููู ูู ุญุฒูุฉ ุงูุชูููู ุ ูู ุจุฅูุดุงุก ูุฆุฉ KafkaConsumerConfig.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KafkaConsumerConfig</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Value("${spring.kafka.bootstrap-servers}")</span>
    <span class="hljs-keyword">private</span> String kafkaServer;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${spring.kafka.consumer.group-id}")</span>
    <span class="hljs-keyword">private</span> String kafkaGroupId;<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title">consumerConfigs</span><span class="hljs-params">()</span> </span>{<font></font>
        Map&lt;String, Object&gt; props = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<font></font>
        props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, kafkaServer);<font></font>
        props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, LongDeserializer.class);<font></font>
        props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);<font></font>
        props.put(ConsumerConfig.GROUP_ID_CONFIG, kafkaGroupId);<font></font>
        <span class="hljs-keyword">return</span> props;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> KafkaListenerContainerFactory&lt;?&gt; kafkaListenerContainerFactory() {<font></font>
        ConcurrentKafkaListenerContainerFactory&lt;Long, UserDto&gt; factory =<font></font>
                <span class="hljs-keyword">new</span> ConcurrentKafkaListenerContainerFactory&lt;&gt;();<font></font>
        factory.setConsumerFactory(consumerFactory());<font></font>
        <span class="hljs-keyword">return</span> factory;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> ConsumerFactory&lt;Long, UserDto&gt; <span class="hljs-title">consumerFactory</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultKafkaConsumerFactory&lt;&gt;(consumerConfigs());<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุดุจู ูุฆุฉ KafkaConsumerConfig ุชูุงููุง ูุฆุฉ KafkaProducerConfig ุงูุชู ุฃูุดุฃูุงูุง ุณุงุจููุง. ููุงู ุฃูุถูุง ุฎุฑูุทุฉ ุชุญุชูู ุนูู ุงูุชููููุงุช ุงูุถุฑูุฑูุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุซู ุฃุฏุงุฉ ุฅูุบุงุก ุงูููุชุงุญ ููููุชุงุญ ูุงููููุฉ. ูุชู ุงุณุชุฎุฏุงู ุงูุฎุฑูุทุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ูุฅูุดุงุก ConsumerFactory &lt;&gt; ุ ูุงูุชู ุจุฏูุฑูุง ูุงุฒูุฉ ูุฅูุดุงุก KafkaListenerContainerFactory &lt;ุ&gt;. ุชูุงุตูู ูููุฉ: ุทุฑููุฉ ุฅุฑุฌุงุน KafkaListenerContainerFactory &lt;ุ&gt; ูุฌุจ ุฃู ุชุณูู kafkaListenerContainerFactory () ุ ูุฅูุง ูู ูุชููู ุงูุฑุจูุน ูู ุงูุนุซูุฑ ุนูู ุงูููู ุงููุทููุจ ููู ูุชู ุชุฌููุน ุงููุดุฑูุน. ูุญู ุจุฏุฃูุง.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6x/mb/t9/6xmbt9zj5i6uzdx95a7ck4hjjxk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑู ุงูุขู ุฃูู ูุชู ุนุฑุถ ุงูููุชุงุญ ููุง ููุจุบู ุ ููุง ูุนูู ุฃู ูู ุดูุก ูุนูู. </font><font style="vertical-align: inherit;">ุจุงูุทุจุน ุ ุชุชุฌุงูุฒ ูุฏุฑุงุช Apache Kafka ุจูุซูุฑ ุชูู ุงููุฐููุฑุฉ ูู ูุฐู ุงูููุงูุฉ ุ ููุน ุฐูู ุ ุขูู ุฃูู ุจุนุฏ ูุฑุงุกุชูุง ุณุชุญุตู ุนูู ููุฑุฉ ุนู ูุฐู ุงูุฎุฏูุฉ ุ ูุงูุฃูู ูู ุฐูู ุ ููููู ุงูุจุฏุก ูู ุงูุนูู ูุนูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุบุณู ูุฏูู ูุซูุฑูุง ุ ูุงุฑุชุฏู ุงูุฃููุนุฉ ุ ููุง ุชุฎุฑุฌ ูู ุงูุฎุงุฑุฌ ุฏูู ุงูุญุงุฌุฉ ุ ููู ุจุตุญุฉ ุฌูุฏุฉ.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar496170/index.html">ูุญููู ุนูููุง # 1 // Udalenka ูู ุฃุฒูุฉ ูููุช ุงูุฃุตุงูุฉ</a></li>
<li><a href="../ar496174/index.html">ุชุฒุงูุฏ ุงูุทูุจ ุนูู ุงูุชุญูููุงุช ููุฑู ุงูููุชุฌุงุช ูุฃูุงุฒูู ูุฅุณุฑุงุฆูู ูุณูุบุงููุฑุฉ ูุงูุนูู ุนู ุจุนุฏ ููุง ุฅูู ุฐูู - ูุงูุดูุง ูุซูุฑูุง.</a></li>
<li><a href="../ar496176/index.html">ูุคุชูุฑ ุงูุชุฑุงุถู ูุจูุฑ: ุชุฌุฑุจุฉ ูุงูุนูุฉ ูู ุญูุงูุฉ ุงูุจูุงูุงุช ูู ุงูุดุฑูุงุช ุงูุฑูููุฉ ุงูุญุฏูุซุฉ</a></li>
<li><a href="../ar496178/index.html">ุณูููุช 5.2. ูุธุฑุฉ ุนุงูุฉ ุนูู ุฌููุน ุงูุชุบููุฑุงุช</a></li>
<li><a href="../ar496180/index.html">ุฑุนุงูุฉ ุงูุธู ูู ุงูุดุจุงุจ</a></li>
<li><a href="../ar496184/index.html">ุชูููุฉ ุดุงุดุฉ LED: Micro-LED vs. LED ุตุบูุฑ</a></li>
<li><a href="../ar496188/index.html">ููููุฉ ุงูุชููู ุนู ูุดุงูุฏุฉ ุงูุทุนุงู ูู ุงูุจุฑุงูุฌ ุงูุชููุฒููููุฉ ูุงูุจุฏุก ูู ุงูุนูุด</a></li>
<li><a href="../ar496190/index.html">ุญูู ุฃูุนุงู ูุฑุงุณุงู -2</a></li>
<li><a href="../ar496192/index.html">ุงุณุชุฏุนุงุก ูุธุงุฆู ุงูุตุฏุฃ ูู Go</a></li>
<li><a href="../ar496194/index.html">ุญูู ุซูุงุฆูุงุช ุงูุตูุฑ ุงูููุทุนูุฉ ุฐุงุช ุงูุจููุฉ ุงูุฏูููุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>