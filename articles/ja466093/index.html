<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤‘ ğŸš¸ ğŸ‘¨ğŸ½â€ğŸš’ kubectl execã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ âœ–ï¸ ğŸš¡ ğŸ¤ŸğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ³¨æ„ãƒšãƒ¬ãƒ•ã€‚ï¼šè¨˜äº‹ã®è‘—è€…-SAPã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢Erkan ErolãŒã€kubectl execKubernetesã§ä½œæ¥­ã™ã‚‹ã™ã¹ã¦ã®äººã«ã‚ˆãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ãƒãƒ¼ãƒ ã®æ©Ÿèƒ½ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã«é–¢ã™ã‚‹å½¼ã®ç ”ç©¶ã‚’å…±æœ‰ã—ã¦ã„ã¾ã™ã€‚å½¼ã¯ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å…¨ä½“ã«Kubernetesã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼ˆãŠã‚ˆã³é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã®ãƒªã‚¹ãƒˆã‚’æ·»ä»˜...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>kubectl execã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/466093/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„ãƒšãƒ¬ãƒ•ã€‚</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šè¨˜äº‹ã®è‘—è€…-SAPã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢Erkan ErolãŒã€</font></font><code>kubectl exec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetesã§ä½œæ¥­ã™ã‚‹ã™ã¹ã¦ã®äººã«ã‚ˆãçŸ¥ã‚‰ã‚Œã¦</font><font style="vertical-align: inherit;">ã„ã‚‹ãƒãƒ¼ãƒ ã®æ©Ÿèƒ½ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã«é–¢ã™ã‚‹å½¼ã®ç ”ç©¶ã‚’å…±æœ‰</font><font style="vertical-align: inherit;">ã—ã¦ã„ã¾ã™ã€‚å½¼ã¯ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å…¨ä½“ã«Kubernetesã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼ˆãŠã‚ˆã³é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã®ãƒªã‚¹ãƒˆã‚’æ·»ä»˜ã—ã¦ãŠã‚Šã€å¿…è¦ã«å¿œã˜ã¦ãƒˆãƒ”ãƒƒã‚¯ã‚’æ·±ãç†è§£ã§ãã¾ã™ã€‚</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/z7/je/ja/z7jejaxnf5kisqkvemay56t6_pe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚ã‚‹é‡‘æ›œæ—¥ã€åŒåƒšãŒè¿‘ã¥ã„ã¦ãã¦ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> client-go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒãƒ‰ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã‚’å°‹ã­ã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚ç§ã¯å½¼ã«ç­”ãˆã‚‹ã“ã¨ãŒã§ããšã€çªç„¶ç§ã¯ä»•äº‹ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã«ã¤ã„ã¦ä½•ã‚‚çŸ¥ã‚‰ãªã„ã“ã¨ã«æ°—ä»˜ãã¾ã—ãŸ</font></font><code>kubectl exec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã¯ã„ã€ãã®ãƒ‡ãƒã‚¤ã‚¹ã«ã¤ã„ã¦ã¯ã‚ã‚‹ç¨‹åº¦ã®ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã‚ã‚Šã¾ã—ãŸãŒã€ãã®æ­£ç¢ºæ€§ã«ã¤ã„ã¦100ï¼…ç¢ºä¿¡ãŒæŒã¦ãªã‹ã£ãŸãŸã‚ã€ã“ã®å•é¡Œã«å–ã‚Šçµ„ã‚€ã“ã¨ã«ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãƒ–ãƒ­ã‚°ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å‹‰å¼·ã—ã¦ã€ç§ã¯å¤šãã®æ–°ã—ã„ã“ã¨ã‚’å­¦ã³ã¾ã—ãŸã€ãã—ã¦ã“ã®è¨˜äº‹ã§ç§ã¯ç§ã®ç™ºè¦‹ã¨ç†è§£ã‚’å…±æœ‰ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä½•ã‹å•é¡ŒãŒã‚ã‚Œã°ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Twitterã§</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ã«é€£çµ¡ã—ã¦ãã ã•ã„</font><font style="vertical-align: inherit;">ã€‚</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MacBookã§ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ecomm-integration-ballerina / kubernetes-clusterã®ã‚¯ãƒ­ãƒ¼ãƒ³</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ä½œæˆã—ã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ¬¡ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã®å®Ÿè¡ŒãŒè¨±å¯ã•ã‚Œã¦ã„ãªã‹ã£ãŸãŸã‚ã€kubeletæ§‹æˆã®ãƒãƒ¼ãƒ‰ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä¿®æ­£ã—ã¾ã—ãŸ</font></font><code>kubectl exec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã®ä¸»ãªç†ç”±ã«ã¤ã„ã¦ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ã™ã¹ã¦ã®è»Š=ç§ã®MacBook</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ãƒ›ã‚¹ãƒˆIP = 192.168.205.10</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ãƒ¯ãƒ¼ã‚«ãƒ¼IP = 192.168.205.11</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> APIã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆ= 6443</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éƒ¨å“</font></font></h2><br>
<img src="https://habrastorage.org/webt/of/q5/dv/ofq5dvsbuqvr8bp6gryhxsficfk.png"><br>
<br>
<ul>
<li> <b>kubectl exec process</b>:    Â«kubectl exec â€¦Â»,  .          API- K8s. <i>. .:        Â«any machineÂ», ,             Kubernetes.</i></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b>api server</b></a>:   -,    API Kubernetes.    control plane  Kubernetes.</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b>kubelet</b></a>: ,       .      pod'.</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b>container runtime</b></a> (  ):  ,    . : Docker, CRI-O, containerdâ€¦</li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kernel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šä½œæ¥­ãƒãƒ¼ãƒ‰ã®OSã‚«ãƒ¼ãƒãƒ«ã€‚</font><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ã‚’æ‹…å½“ã—ã¾ã™ã€‚</font></font></li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå®›å…ˆï¼‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ãƒ†ãƒŠãƒ¼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼špod'aã®ä¸€éƒ¨ã§ã‚ã‚Šã€ä½œæ¥­ãƒ¦ãƒ‹ãƒƒãƒˆã®1ã¤ã§æ©Ÿèƒ½ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã€‚</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ãŒç™ºè¦‹ã—ãŸã‚‚ã®</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åå‰ç©ºé–“ã«ãƒãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™</font></font><code>default</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">// any machine<font></font>
$ kubectl run <span class="hljs-built_in">exec</span>-test-nginx --image=nginx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€execã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ã•ã‚‰ã«è¦³å¯Ÿã•ã‚Œã‚‹ã¾ã§5000ç§’å¾…ã¡ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">// any machine<font></font>
$ kubectl <span class="hljs-built_in">exec</span> -it <span class="hljs-built_in">exec</span>-test-nginx-6558988d5-fgxgg -- sh
<span class="hljs-comment"># sleep 5000</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
kubectlãƒ—ãƒ­ã‚»ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆã“ã®ä¾‹ã§ã¯pid = 8507ã§ã™ï¼‰ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">// any machine<font></font>
$ ps -ef |grep kubectl<font></font>
501  8507  8409   0  7:19PM ttys000    0:00.13 kubectl <span class="hljs-built_in">exec</span> -it <span class="hljs-built_in">exec</span>-test-nginx-6558988d5-fgxgg -- sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ç¢ºèªã™ã‚‹ã¨ã€api-serverï¼ˆ192.168.205.10.6443ï¼‰ã¸ã®æ¥ç¶šãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">// any machine<font></font>
$ netstat -atnv |grep 8507<font></font>
tcp4       0      0  192.168.205.1.51673    192.168.205.10.6443    ESTABLISHED 131072 131768   8507      0 0x0102 0x00000020<font></font>
tcp4       0      0  192.168.205.1.51672    192.168.205.10.6443    ESTABLISHED 131072 131768   8507      0 0x0102 0x00000028</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">Kubectlã¯ã€execã‚µãƒ–ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã—ã€RESTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs">              req := restClient.Post().<font></font>
                        Resource(<span class="hljs-string">"pods"</span>).<font></font>
                        Name(pod.Name).<font></font>
                        Namespace(pod.Namespace).<font></font>
                        SubResource(<span class="hljs-string">"exec"</span>)<font></font>
                req.VersionedParams(&amp;corev1.PodExecOptions{<font></font>
                        Container: containerName,<font></font>
                        Command:   p.Command,<font></font>
                        Stdin:     p.Stdin,<font></font>
                        Stdout:    p.Out != <span class="hljs-literal">nil</span>,<font></font>
                        Stderr:    p.ErrOut != <span class="hljs-literal">nil</span>,<font></font>
                        TTY:       t.Raw,<font></font>
                }, scheme.ParameterCodec)<font></font>
<font></font>
                <span class="hljs-keyword">return</span> p.Executor.Execute(<span class="hljs-string">"POST"</span>, req.URL(), p.Config, p.In, p.Out, p.ErrOut, t.Raw, sizeQueue)</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kubectl / pkg / cmd / exec / exec.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/og/nn/cg/ognncgumyrwb7cr6l8wq5alo2je.png"><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰å´ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
api-serverå´ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">handler.go:143] kube-apiserver: POST <span class="hljs-string">"/api/v1/namespaces/default/pods/exec-test-nginx-6558988d5-fgxgg/exec"</span> satisfied by gorestful with webservice /api/v1<font></font>
upgradeaware.go:261] Connecting to backend proxy (intercepting redirects) https://192.168.205.11:10250/<span class="hljs-built_in">exec</span>/default/<span class="hljs-built_in">exec</span>-test-nginx-6558988d5-fgxgg/<span class="hljs-built_in">exec</span>-test-nginx?<span class="hljs-built_in">command</span>=sh&amp;input=1&amp;output=1&amp;tty=1<font></font>
Headers: map[Connection:[Upgrade] Content-Length:[0] Upgrade:[SPDY/3.1] User-Agent:[kubectl/v1.12.10 (darwin/amd64) kubernetes/e3c1340] X-Forwarded-For:[192.168.205.1] X-Stream-Protocol-Version:[v4.channel.k8s.io v3.channel.k8s.io v2.channel.k8s.io channel.k8s.io]]</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«å¤‰æ›´ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPDYã‚’</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ã™ã‚‹ã¨ã€å˜ä¸€ã®TCPæ¥ç¶šã‚’ä»‹ã—ã¦ã€å€‹ã€…ã®stdin / stdout / stderr / spdy-errorã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å¤šé‡åŒ–ã§ãã¾ã™ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIã‚µãƒ¼ãƒãƒ¼ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚’</font></font><code>PodExecOptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¬¡ã®</font><font style="vertical-align: inherit;">ã‚ˆã†ã«å¤‰æ›ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// PodExecOptions is the query options to a Pod's remote exec call</span>
<span class="hljs-keyword">type</span> PodExecOptions <span class="hljs-keyword">struct</span> {<font></font>
        metav1.TypeMeta<font></font>
<font></font>
        <span class="hljs-comment">// Stdin if true indicates that stdin is to be redirected for the exec call</span>
        Stdin <span class="hljs-keyword">bool</span><font></font>
<font></font>
        <span class="hljs-comment">// Stdout if true indicates that stdout is to be redirected for the exec call</span>
        Stdout <span class="hljs-keyword">bool</span><font></font>
<font></font>
        <span class="hljs-comment">// Stderr if true indicates that stderr is to be redirected for the exec call</span>
        Stderr <span class="hljs-keyword">bool</span><font></font>
<font></font>
        <span class="hljs-comment">// TTY if true indicates that a tty will be allocated for the exec call</span>
        TTY <span class="hljs-keyword">bool</span><font></font>
<font></font>
        <span class="hljs-comment">// Container in which to execute the command.</span>
        Container <span class="hljs-keyword">string</span><font></font>
<font></font>
        <span class="hljs-comment">// Command is the remote command to execute; argv array; not executed within a shell.</span>
        Command []<span class="hljs-keyword">string</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg / apis / core / types.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å¿…è¦ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€api-serverãŒæ¥ç¶šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãƒãƒƒãƒ‰ã‚’èªè­˜ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// ExecLocation returns the exec URL for a pod container. If opts.Container is blank</span>
<span class="hljs-comment">// and only one container is present in the pod, that container is used.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExecLocation</span><span class="hljs-params">(
        getter ResourceGetter,
        connInfo client.ConnectionInfoGetter,
        ctx context.Context,
        name <span class="hljs-keyword">string</span>,
        opts *api.PodExecOptions,
)</span> <span class="hljs-params">(*url.URL, http.RoundTripper, error)</span></span> {
        <span class="hljs-keyword">return</span> streamLocation(getter, connInfo, ctx, name, opts, opts.Container, <span class="hljs-string">"exec"</span>)<font></font>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg / registry / core / pod / strategy.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚‚ã¡ã‚ã‚“ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ãƒãƒ¼ãƒ‰ã«é–¢ã™ã‚‹æƒ…å ±ã‹ã‚‰å–å¾—ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs">        nodeName := types.NodeName(pod.Spec.NodeName)
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(nodeName) == <span class="hljs-number">0</span> {
                <span class="hljs-comment">// If pod has not been assigned a host, return an empty location</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">nil</span>, errors.NewBadRequest(fmt.Sprintf(<span class="hljs-string">"pod %s does not have a host assigned"</span>, name))<font></font>
        }<font></font>
        nodeInfo, err := connInfo.GetConnectionInfo(ctx, nodeName)</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg /ãƒ¬ã‚¸ã‚¹ãƒˆãƒª/ã‚³ã‚¢/ãƒãƒƒãƒ‰/æˆ¦ç•¥</font></font></a><font style="vertical-align: inherit;"></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.go </font><i><font style="vertical-align: inherit;">ï¼‰</font></i><font style="vertical-align: inherit;">ã‚„ã£ãŸãƒ¼ï¼</font><font style="vertical-align: inherit;">Kubeletã«ã¯</font></font><code>node.Status.DaemonEndpoints.KubeletEndpoint.Port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€APIã‚µãƒ¼ãƒãƒ¼ãŒæ¥ç¶šã§ãã‚‹</font><font style="vertical-align: inherit;">ãƒãƒ¼ãƒˆï¼ˆ</font><font style="vertical-align: inherit;">ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// GetConnectionInfo retrieves connection info from the status of a Node API object.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(k *NodeConnectionInfoGetter)</span> <span class="hljs-title">GetConnectionInfo</span><span class="hljs-params">(ctx context.Context, nodeName types.NodeName)</span> <span class="hljs-params">(*ConnectionInfo, error)</span></span> {<font></font>
        node, err := k.nodes.Get(ctx, <span class="hljs-keyword">string</span>(nodeName), metav1.GetOptions{})
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// Find a kubelet-reported address, using preferred address type</span><font></font>
        host, err := nodeutil.GetPreferredNodeAddress(node, k.preferredAddressTypes)<font></font>
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">// Use the kubelet-reported port, if present</span>
        port := <span class="hljs-keyword">int</span>(node.Status.DaemonEndpoints.KubeletEndpoint.Port)
        <span class="hljs-keyword">if</span> port &lt;= <span class="hljs-number">0</span> {<font></font>
                port = k.defaultPort<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> &amp;ConnectionInfo{<font></font>
                Scheme:    k.scheme,<font></font>
                Hostname:  host,<font></font>
                Port:      strconv.Itoa(port),<font></font>
                Transport: k.transport,<font></font>
        }, <span class="hljs-literal">nil</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg / kubelet / client / kubelet_client.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚¹ã‚¿ãƒ¼ãƒ»ãƒãƒ¼ãƒ‰é€šä¿¡&gt;ã‚¯ãƒ©ã‚¹ã‚¿&gt; kubeletã«apiserverã«ãƒã‚¹ã‚¿ãƒ¼</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®æ¥ç¶šã¯ã€HTTPSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆkubeletã®ä¸Šã§é–‰ã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€apiserverã¯kubeletã®è¨¼æ˜æ›¸ã‚’æ¤œè¨¼ã—ãªã„ãŸã‚ã€æ¥ç¶šãŒã€Œä¸­é–“æ”»æ’ƒã€ï¼ˆMITMï¼‰ã«å¯¾ã—ã¦è„†å¼±ã§ã‚ã‚Š</font><font style="vertical-align: inherit;">ã€ä¿¡é ¼ã§ããªã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã®ä½œæ¥­ã«å¯¾ã—ã¦</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®‰å…¨ã§</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font><font style="vertical-align: inherit;">ã‚ã‚Š</font><i><b><font style="vertical-align: inherit;">ã¾ã›ã‚“</font></b></i><font style="vertical-align: inherit;">ã€‚</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€APIã‚µãƒ¼ãƒãƒ¼ã¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’èªè­˜ã—ã€æ¥ç¶šã‚’ç¢ºç«‹ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// Connect returns a handler for the pod exec proxy</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(r *ExecREST)</span> <span class="hljs-title">Connect</span><span class="hljs-params">(ctx context.Context, name <span class="hljs-keyword">string</span>, opts runtime.Object, responder rest.Responder)</span> <span class="hljs-params">(http.Handler, error)</span></span> {<font></font>
        execOpts, ok := opts.(*api.PodExecOptions)<font></font>
        <span class="hljs-keyword">if</span> !ok {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"invalid options object: %#v"</span>, opts)<font></font>
        }<font></font>
        location, transport, err := pod.ExecLocation(r.Store, r.KubeletConn, ctx, name, execOpts)<font></font>
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> newThrottledUpgradeAwareProxyHandler(location, transport, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, responder), <span class="hljs-literal">nil</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg / registry / core / pod / rest / subresources.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ã§ä½•ãŒèµ·ã“ã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã«ã€ä½œæ¥­ãƒãƒ¼ãƒ‰ã®IPã‚’è¦‹ã¤ã‘ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ä¾‹ã§ã¯ã€192.168.205.11ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">// any machine<font></font>
$ kubectl get nodes k8s-node-1 -o wide<font></font>
NAME         STATUS   ROLES    AGE   VERSION   INTERNAL-IP      EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION      CONTAINER-RUNTIME<font></font>
k8s-node-1   Ready    &lt;none&gt;   9h    v1.15.3   192.168.205.11   &lt;none&gt;        Ubuntu 16.04.6 LTS   4.4.0-159-generic   docker://17.3.3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€kubeletãƒãƒ¼ãƒˆï¼ˆã“ã®å ´åˆã¯10250ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">// any machine<font></font>
$ kubectl get nodes k8s-node-1 -o jsonpath=<span class="hljs-string">'{.status.daemonEndpoints.kubeletEndpoint}'</span>
map[Port:10250]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä½œæ¥­ãƒãƒ¼ãƒ‰ï¼ˆ192.168.205.11ï¼‰ã¸ã®æ¥ç¶šã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ãã†ã§ã™ï¼</font><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚»ã‚¹ã‚’å¼·åˆ¶çµ‚äº†ã™ã‚‹ã¨ãƒ—ãƒ­ã‚»ã‚¹</font></font><code>exec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŒæ¶ˆãˆã‚‹ã®ã§ã€execã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸçµæœã€api-serverã«ã‚ˆã£ã¦æ¥ç¶šãŒç¢ºç«‹ã•ã‚ŒãŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">// master node<font></font>
$ netstat -atn |grep 192.168.205.11<font></font>
tcp        0      0 192.168.205.10:37870    192.168.205.11:10250    ESTABLISHED<font></font>
â€¦</code></pre><br>
<img src="https://habrastorage.org/webt/mp/-l/ql/mp-lqlocn8io490w9r9xenbawwg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
kubectlã¨api-serverã®é–“ã®æ¥ç¶šã¯ã¾ã é–‹ã„ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã•ã‚‰ã«ã€api-serverã¨kubeletã‚’æ¥ç¶šã™ã‚‹åˆ¥ã®æ¥ç¶šãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.ä½œæ¥­ãƒãƒ¼ãƒ‰ã§ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã«æ¥ç¶šã—ã¦ã€ä½•ãŒç™ºç”Ÿã™ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€ãã‚Œã¨ã®æ¥ç¶šã‚‚ç¢ºç«‹ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼ˆ2è¡Œç›®ï¼‰ã€‚</font><font style="vertical-align: inherit;">192.168.205.10ã¯ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ã®IPã§ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs"> // worker node<font></font>
  $ netstat -atn |grep 10250<font></font>
  tcp6       0      0 :::10250                :::*                    LISTEN<font></font>
  tcp6       0      0 192.168.205.11:10250    192.168.205.10:37870    ESTABLISHED</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã®ãƒãƒ¼ãƒ ã¯</font></font><code>sleep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã©ã†ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ã‚„ã£ãŸãƒ¼ã€å½¼å¥³ã‚‚ã„ã‚‹ã‚ˆï¼</font></font><br>
<br>
<pre><code class="bash hljs"> // worker node<font></font>
  $ ps -afx<font></font>
  ...<font></font>
  31463 ?        Sl     0:00      \_ docker-containerd-shim 7d974065bbb3107074ce31c51f5ef40aea8dcd535ae11a7b8f2dd180b8ed583a /var/run/docker/libcontainerd/7d974065bbb3107074ce31c51<font></font>
  31478 pts/0    Ss     0:00          \_ sh<font></font>
  31485 pts/0    S+     0:00              \_ sleep 5000<font></font>
  â€¦</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€å¾…ã£ã¦ãã ã•ã„ï¼škubeletã¯ã“ã‚Œã‚’ã©ã®ã‚ˆã†ã«ã‚¯ãƒ©ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸã‹ï¼Ÿ</font><font style="vertical-align: inherit;">kubeletã«ã¯ã€api-serverãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ã®ãƒãƒ¼ãƒˆã‚’ä»‹ã—ã¦APIã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ‡ãƒ¼ãƒ¢ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// Server is the library interface to serve the stream requests.</span>
<span class="hljs-keyword">type</span> Server <span class="hljs-keyword">interface</span> {<font></font>
        http.Handler<font></font>
<font></font>
        <span class="hljs-comment">// Get the serving URL for the requests.</span>
        <span class="hljs-comment">// Requests must not be nil. Responses may be nil iff an error is returned.</span><font></font>
        GetExec(*runtimeapi.ExecRequest) (*runtimeapi.ExecResponse, error)<font></font>
        GetAttach(req *runtimeapi.AttachRequest) (*runtimeapi.AttachResponse, error)<font></font>
        GetPortForward(*runtimeapi.PortForwardRequest) (*runtimeapi.PortForwardResponse, error)<font></font>
<font></font>
        <span class="hljs-comment">// Start the server.</span>
        <span class="hljs-comment">// addr is the address to serve on (address:port) stayUp indicates whether the server should</span>
        <span class="hljs-comment">// listen until Stop() is called, or automatically stop after all expected connections are</span>
        <span class="hljs-comment">// closed. Calling Get{Exec,Attach,PortForward} increments the expected connection count.</span>
        <span class="hljs-comment">// Function does not return until the server is stopped.</span>
        Start(stayUp <span class="hljs-keyword">bool</span>) error
        <span class="hljs-comment">// Stop the server, and terminate any open connections.</span><font></font>
        Stop() error<font></font>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg / kubelet / server / streaming / server.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kubeletã¯ã€execãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¿œç­”ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¨ˆç®—ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *server)</span> <span class="hljs-title">GetExec</span><span class="hljs-params">(req *runtimeapi.ExecRequest)</span> <span class="hljs-params">(*runtimeapi.ExecResponse, error)</span></span> {
        <span class="hljs-keyword">if</span> err := validateExecRequest(req); err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<font></font>
        }<font></font>
        token, err := s.cache.Insert(req)<font></font>
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> &amp;runtimeapi.ExecResponse{<font></font>
                Url: s.buildURL(<span class="hljs-string">"exec"</span>, token),<font></font>
        }, <span class="hljs-literal">nil</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg / kubelet / server / streaming / server.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æ··åŒã—ãªã„ã§ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒãƒ³ãƒ‰ã®çµæœã§ã¯ãªãã€é€šä¿¡ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿”ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> ExecResponse <span class="hljs-keyword">struct</span> {
        <span class="hljs-comment">// Fully qualified URL of the exec streaming server.</span>
        Url                  <span class="hljs-keyword">string</span>   <span class="hljs-string">`protobuf:"bytes,1,opt,name=url,proto3" json:"url,omitempty"`</span>
        XXX_NoUnkeyedLiteral <span class="hljs-keyword">struct</span>{} <span class="hljs-string">`json:"-"`</span>
        XXX_sizecache        <span class="hljs-keyword">int32</span>    <span class="hljs-string">`json:"-"`</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kubelet </font></font><code>RuntimeServiceClient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€Container Runtime Interfaceã®ä¸€éƒ¨ã§</font><font style="vertical-align: inherit;">ã‚ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">å®Ÿè£…ã—ã¾ã™</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆãŸã¨ãˆã°ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§è©³ç´°ã‚’</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨˜è¿°ã—</font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã™</font></a></i><i><font style="vertical-align: inherit;"> -ãŠã‚ˆãtranslã€‚ï¼‰</font></i><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-apiã‹ã‚‰kubernetes / kubernetesã¸ã®é•·ã„ãƒªã‚¹ãƒˆ</font></font></b><div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-comment">// For semantics around ctx use and closing/ending streaming RPCs, please refer to https://godoc.org/google.golang.org/grpc#ClientConn.NewStream.</span>
<span class="hljs-keyword">type</span> RuntimeServiceClient <span class="hljs-keyword">interface</span> {
        <span class="hljs-comment">// Version returns the runtime name, runtime version, and runtime API version.</span><font></font>
        Version(ctx context.Context, in *VersionRequest, opts ...grpc.CallOption) (*VersionResponse, error)<font></font>
        <span class="hljs-comment">// RunPodSandbox creates and starts a pod-level sandbox. Runtimes must ensure</span>
        <span class="hljs-comment">// the sandbox is in the ready state on success.</span><font></font>
        RunPodSandbox(ctx context.Context, in *RunPodSandboxRequest, opts ...grpc.CallOption) (*RunPodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// StopPodSandbox stops any running process that is part of the sandbox and</span>
        <span class="hljs-comment">// reclaims network resources (e.g., IP addresses) allocated to the sandbox.</span>
        <span class="hljs-comment">// If there are any running containers in the sandbox, they must be forcibly</span>
        <span class="hljs-comment">// terminated.</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if all relevant</span>
        <span class="hljs-comment">// resources have already been reclaimed. kubelet will call StopPodSandbox</span>
        <span class="hljs-comment">// at least once before calling RemovePodSandbox. It will also attempt to</span>
        <span class="hljs-comment">// reclaim resources eagerly, as soon as a sandbox is not needed. Hence,</span>
        <span class="hljs-comment">// multiple StopPodSandbox calls are expected.</span><font></font>
        StopPodSandbox(ctx context.Context, in *StopPodSandboxRequest, opts ...grpc.CallOption) (*StopPodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// RemovePodSandbox removes the sandbox. If there are any running containers</span>
        <span class="hljs-comment">// in the sandbox, they must be forcibly terminated and removed.</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if the sandbox has</span>
        <span class="hljs-comment">// already been removed.</span><font></font>
        RemovePodSandbox(ctx context.Context, in *RemovePodSandboxRequest, opts ...grpc.CallOption) (*RemovePodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// PodSandboxStatus returns the status of the PodSandbox. If the PodSandbox is not</span>
        <span class="hljs-comment">// present, returns an error.</span><font></font>
        PodSandboxStatus(ctx context.Context, in *PodSandboxStatusRequest, opts ...grpc.CallOption) (*PodSandboxStatusResponse, error)<font></font>
        <span class="hljs-comment">// ListPodSandbox returns a list of PodSandboxes.</span><font></font>
        ListPodSandbox(ctx context.Context, in *ListPodSandboxRequest, opts ...grpc.CallOption) (*ListPodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// CreateContainer creates a new container in specified PodSandbox</span><font></font>
        CreateContainer(ctx context.Context, in *CreateContainerRequest, opts ...grpc.CallOption) (*CreateContainerResponse, error)<font></font>
        <span class="hljs-comment">// StartContainer starts the container.</span><font></font>
        StartContainer(ctx context.Context, in *StartContainerRequest, opts ...grpc.CallOption) (*StartContainerResponse, error)<font></font>
        <span class="hljs-comment">// StopContainer stops a running container with a grace period (i.e., timeout).</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if the container has</span>
        <span class="hljs-comment">// already been stopped.</span>
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> what must the runtime do after the grace period is reached?</span><font></font>
        StopContainer(ctx context.Context, in *StopContainerRequest, opts ...grpc.CallOption) (*StopContainerResponse, error)<font></font>
        <span class="hljs-comment">// RemoveContainer removes the container. If the container is running, the</span>
        <span class="hljs-comment">// container must be forcibly removed.</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if the container has</span>
        <span class="hljs-comment">// already been removed.</span><font></font>
        RemoveContainer(ctx context.Context, in *RemoveContainerRequest, opts ...grpc.CallOption) (*RemoveContainerResponse, error)<font></font>
        <span class="hljs-comment">// ListContainers lists all containers by filters.</span><font></font>
        ListContainers(ctx context.Context, in *ListContainersRequest, opts ...grpc.CallOption) (*ListContainersResponse, error)<font></font>
        <span class="hljs-comment">// ContainerStatus returns status of the container. If the container is not</span>
        <span class="hljs-comment">// present, returns an error.</span><font></font>
        ContainerStatus(ctx context.Context, in *ContainerStatusRequest, opts ...grpc.CallOption) (*ContainerStatusResponse, error)<font></font>
        <span class="hljs-comment">// UpdateContainerResources updates ContainerConfig of the container.</span><font></font>
        UpdateContainerResources(ctx context.Context, in *UpdateContainerResourcesRequest, opts ...grpc.CallOption) (*UpdateContainerResourcesResponse, error)<font></font>
        <span class="hljs-comment">// ReopenContainerLog asks runtime to reopen the stdout/stderr log file</span>
        <span class="hljs-comment">// for the container. This is often called after the log file has been</span>
        <span class="hljs-comment">// rotated. If the container is not running, container runtime can choose</span>
        <span class="hljs-comment">// to either create a new log file and return nil, or return an error.</span>
        <span class="hljs-comment">// Once it returns error, new container log file MUST NOT be created.</span><font></font>
        ReopenContainerLog(ctx context.Context, in *ReopenContainerLogRequest, opts ...grpc.CallOption) (*ReopenContainerLogResponse, error)<font></font>
        <span class="hljs-comment">// ExecSync runs a command in a container synchronously.</span><font></font>
        ExecSync(ctx context.Context, in *ExecSyncRequest, opts ...grpc.CallOption) (*ExecSyncResponse, error)<font></font>
        <span class="hljs-comment">// Exec prepares a streaming endpoint to execute a command in the container.</span><font></font>
        Exec(ctx context.Context, in *ExecRequest, opts ...grpc.CallOption) (*ExecResponse, error)<font></font>
        <span class="hljs-comment">// Attach prepares a streaming endpoint to attach to a running container.</span><font></font>
        Attach(ctx context.Context, in *AttachRequest, opts ...grpc.CallOption) (*AttachResponse, error)<font></font>
        <span class="hljs-comment">// PortForward prepares a streaming endpoint to forward ports from a PodSandbox.</span><font></font>
        PortForward(ctx context.Context, in *PortForwardRequest, opts ...grpc.CallOption) (*PortForwardResponse, error)<font></font>
        <span class="hljs-comment">// ContainerStats returns stats of the container. If the container does not</span>
        <span class="hljs-comment">// exist, the call returns an error.</span><font></font>
        ContainerStats(ctx context.Context, in *ContainerStatsRequest, opts ...grpc.CallOption) (*ContainerStatsResponse, error)<font></font>
        <span class="hljs-comment">// ListContainerStats returns stats of all running containers.</span><font></font>
        ListContainerStats(ctx context.Context, in *ListContainerStatsRequest, opts ...grpc.CallOption) (*ListContainerStatsResponse, error)<font></font>
        <span class="hljs-comment">// UpdateRuntimeConfig updates the runtime configuration based on the given request.</span><font></font>
        UpdateRuntimeConfig(ctx context.Context, in *UpdateRuntimeConfigRequest, opts ...grpc.CallOption) (*UpdateRuntimeConfigResponse, error)<font></font>
        <span class="hljs-comment">// Status returns the status of the runtime.</span><font></font>
        Status(ctx context.Context, in *StatusRequest, opts ...grpc.CallOption) (*StatusResponse, error)<font></font>
}</code></pre><br>
<i>(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">cri-api/pkg/apis/runtime/v1alpha2/api.pb.go</a>)</i></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å˜ã«gRPCã‚’ä½¿ç”¨ã—ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä»‹ã—ã¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> runtimeServiceClient <span class="hljs-keyword">struct</span> {<font></font>
        cc *grpc.ClientConn<font></font>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br>
<pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *runtimeServiceClient)</span> <span class="hljs-title">Exec</span><span class="hljs-params">(ctx context.Context, in *ExecRequest, opts ...grpc.CallOption)</span> <span class="hljs-params">(*ExecResponse, error)</span></span> {<font></font>
        out := <span class="hljs-built_in">new</span>(ExecResponse)<font></font>
        err := c.cc.Invoke(ctx, <span class="hljs-string">"/runtime.v1alpha2.RuntimeService/Exec"</span>, in, out, opts...)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> out, <span class="hljs-literal">nil</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Container RuntimeãŒå®Ÿè£…ã‚’æ‹…å½“ã—ã¾ã™</font></font><code>RuntimeServiceServer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-apiã‹ã‚‰kubernetes / kubernetesã¸ã®é•·ã„ãƒªã‚¹ãƒˆ</font></font></b><div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-comment">// RuntimeServiceServer is the server API for RuntimeService service.</span>
<span class="hljs-keyword">type</span> RuntimeServiceServer <span class="hljs-keyword">interface</span> {
        <span class="hljs-comment">// Version returns the runtime name, runtime version, and runtime API version.</span><font></font>
        Version(context.Context, *VersionRequest) (*VersionResponse, error)<font></font>
        <span class="hljs-comment">// RunPodSandbox creates and starts a pod-level sandbox. Runtimes must ensure</span>
        <span class="hljs-comment">// the sandbox is in the ready state on success.</span><font></font>
        RunPodSandbox(context.Context, *RunPodSandboxRequest) (*RunPodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// StopPodSandbox stops any running process that is part of the sandbox and</span>
        <span class="hljs-comment">// reclaims network resources (e.g., IP addresses) allocated to the sandbox.</span>
        <span class="hljs-comment">// If there are any running containers in the sandbox, they must be forcibly</span>
        <span class="hljs-comment">// terminated.</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if all relevant</span>
        <span class="hljs-comment">// resources have already been reclaimed. kubelet will call StopPodSandbox</span>
        <span class="hljs-comment">// at least once before calling RemovePodSandbox. It will also attempt to</span>
        <span class="hljs-comment">// reclaim resources eagerly, as soon as a sandbox is not needed. Hence,</span>
        <span class="hljs-comment">// multiple StopPodSandbox calls are expected.</span><font></font>
        StopPodSandbox(context.Context, *StopPodSandboxRequest) (*StopPodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// RemovePodSandbox removes the sandbox. If there are any running containers</span>
        <span class="hljs-comment">// in the sandbox, they must be forcibly terminated and removed.</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if the sandbox has</span>
        <span class="hljs-comment">// already been removed.</span><font></font>
        RemovePodSandbox(context.Context, *RemovePodSandboxRequest) (*RemovePodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// PodSandboxStatus returns the status of the PodSandbox. If the PodSandbox is not</span>
        <span class="hljs-comment">// present, returns an error.</span><font></font>
        PodSandboxStatus(context.Context, *PodSandboxStatusRequest) (*PodSandboxStatusResponse, error)<font></font>
        <span class="hljs-comment">// ListPodSandbox returns a list of PodSandboxes.</span><font></font>
        ListPodSandbox(context.Context, *ListPodSandboxRequest) (*ListPodSandboxResponse, error)<font></font>
        <span class="hljs-comment">// CreateContainer creates a new container in specified PodSandbox</span><font></font>
        CreateContainer(context.Context, *CreateContainerRequest) (*CreateContainerResponse, error)<font></font>
        <span class="hljs-comment">// StartContainer starts the container.</span><font></font>
        StartContainer(context.Context, *StartContainerRequest) (*StartContainerResponse, error)<font></font>
        <span class="hljs-comment">// StopContainer stops a running container with a grace period (i.e., timeout).</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if the container has</span>
        <span class="hljs-comment">// already been stopped.</span>
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> what must the runtime do after the grace period is reached?</span><font></font>
        StopContainer(context.Context, *StopContainerRequest) (*StopContainerResponse, error)<font></font>
        <span class="hljs-comment">// RemoveContainer removes the container. If the container is running, the</span>
        <span class="hljs-comment">// container must be forcibly removed.</span>
        <span class="hljs-comment">// This call is idempotent, and must not return an error if the container has</span>
        <span class="hljs-comment">// already been removed.</span><font></font>
        RemoveContainer(context.Context, *RemoveContainerRequest) (*RemoveContainerResponse, error)<font></font>
        <span class="hljs-comment">// ListContainers lists all containers by filters.</span><font></font>
        ListContainers(context.Context, *ListContainersRequest) (*ListContainersResponse, error)<font></font>
        <span class="hljs-comment">// ContainerStatus returns status of the container. If the container is not</span>
        <span class="hljs-comment">// present, returns an error.</span><font></font>
        ContainerStatus(context.Context, *ContainerStatusRequest) (*ContainerStatusResponse, error)<font></font>
        <span class="hljs-comment">// UpdateContainerResources updates ContainerConfig of the container.</span><font></font>
        UpdateContainerResources(context.Context, *UpdateContainerResourcesRequest) (*UpdateContainerResourcesResponse, error)<font></font>
        <span class="hljs-comment">// ReopenContainerLog asks runtime to reopen the stdout/stderr log file</span>
        <span class="hljs-comment">// for the container. This is often called after the log file has been</span>
        <span class="hljs-comment">// rotated. If the container is not running, container runtime can choose</span>
        <span class="hljs-comment">// to either create a new log file and return nil, or return an error.</span>
        <span class="hljs-comment">// Once it returns error, new container log file MUST NOT be created.</span><font></font>
        ReopenContainerLog(context.Context, *ReopenContainerLogRequest) (*ReopenContainerLogResponse, error)<font></font>
        <span class="hljs-comment">// ExecSync runs a command in a container synchronously.</span><font></font>
        ExecSync(context.Context, *ExecSyncRequest) (*ExecSyncResponse, error)<font></font>
        <span class="hljs-comment">// Exec prepares a streaming endpoint to execute a command in the container.</span><font></font>
        Exec(context.Context, *ExecRequest) (*ExecResponse, error)<font></font>
        <span class="hljs-comment">// Attach prepares a streaming endpoint to attach to a running container.</span><font></font>
        Attach(context.Context, *AttachRequest) (*AttachResponse, error)<font></font>
        <span class="hljs-comment">// PortForward prepares a streaming endpoint to forward ports from a PodSandbox.</span><font></font>
        PortForward(context.Context, *PortForwardRequest) (*PortForwardResponse, error)<font></font>
        <span class="hljs-comment">// ContainerStats returns stats of the container. If the container does not</span>
        <span class="hljs-comment">// exist, the call returns an error.</span><font></font>
        ContainerStats(context.Context, *ContainerStatsRequest) (*ContainerStatsResponse, error)<font></font>
        <span class="hljs-comment">// ListContainerStats returns stats of all running containers.</span><font></font>
        ListContainerStats(context.Context, *ListContainerStatsRequest) (*ListContainerStatsResponse, error)<font></font>
        <span class="hljs-comment">// UpdateRuntimeConfig updates the runtime configuration based on the given request.</span><font></font>
        UpdateRuntimeConfig(context.Context, *UpdateRuntimeConfigRequest) (*UpdateRuntimeConfigResponse, error)<font></font>
        <span class="hljs-comment">// Status returns the status of the runtime.</span><font></font>
        Status(context.Context, *StatusRequest) (*StatusResponse, error)<font></font>
}</code></pre><br>
<i>(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">cri-api/pkg/apis/runtime/v1alpha2/api.pb.go</a>)</i></div></div><br>
<img src="https://habrastorage.org/webt/ud/wx/mb/udwxmbczx1kgrhy_etiwnmkhlha.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚‚ã—ãã†ãªã‚‰ã€kubeletã¨ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®é–“ã®æ¥ç¶šãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã‚ˆã­ï¼Ÿ</font><font style="vertical-align: inherit;">ç¢ºèªã—ã‚ˆã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
execã‚³ãƒãƒ³ãƒ‰ã®å‰å¾Œã«ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€é•ã„ã‚’ç¢ºèªã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç§ã®å ´åˆã€é•ã„ã¯ã“ã‚Œã§ã™ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">// worker node<font></font>
$ ss -a -p |grep kubelet<font></font>
...<font></font>
u_str  ESTAB      0      0       * 157937                * 157387                users:((<span class="hljs-string">"kubelet"</span>,pid=5714,fd=33))<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã†ãƒ¼ã‚“... kubeletï¼ˆpid = 5714ï¼‰ã¨æœªçŸ¥ã®ã‚‚ã®ã¨ã®é–“ã®UNIXã‚½ã‚±ãƒƒãƒˆã‚’ä»‹ã—ãŸæ–°ã—ã„æ¥ç¶šã€‚</font><font style="vertical-align: inherit;">ã©ã†ãªã‚Šå¾—ã‚‹ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ãã†ã§ã™ã€ã“ã‚Œã¯Dockerï¼ˆpid = 1186ï¼‰ã§ã™ï¼</font></font><br>
<br>
<pre><code class="bash hljs">// worker node<font></font>
$ ss -a -p |grep 157387<font></font>
...<font></font>
u_str  ESTAB      0      0       * 157937                * 157387                users:((<span class="hljs-string">"kubelet"</span>,pid=5714,fd=33))<font></font>
u_str  ESTAB      0      0      /var/run/docker.sock 157387                * 157937                users:((<span class="hljs-string">"dockerd"</span>,pid=1186,fd=14))<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã”å­˜ã˜ã®ã¨ãŠã‚Šã€ã“ã‚Œã¯ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆpid = 1186ï¼‰ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">// worker node<font></font>
$ ps -afx<font></font>
...<font></font>
 1186 ?        Ssl    0:55 /usr/bin/dockerd -H fd://<font></font>
17784 ?        Sl     0:00      \_ docker-containerd-shim 53a0a08547b2f95986402d7f3b3e78702516244df049ba6c5aa012e81264aa3c /var/run/docker/libcontainerd/53a0a08547b2f95986402d7f3<font></font>
17801 pts/2    Ss     0:00          \_ sh<font></font>
17827 pts/2    S+     0:00              \_ sleep 5000<font></font>
...</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CRI-Oã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’èª¿ã¹ã¦ã€ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã®ã‹ã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">Dockerã§ã‚‚ã€ãƒ­ã‚¸ãƒƒã‚¯ã¯ä¼¼ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿè£…ã‚’æ‹…å½“ã™ã‚‹ã‚µãƒ¼ãƒãƒ¼ãŒã‚ã‚Šã¾ã™</font></font><code>RuntimeServiceServer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// Server implements the RuntimeService and ImageService</span>
<span class="hljs-keyword">type</span> Server <span class="hljs-keyword">struct</span> {<font></font>
        config          libconfig.Config<font></font>
        seccompProfile  *seccomp.Seccomp<font></font>
        stream          StreamService<font></font>
        netPlugin       ocicni.CNIPlugin<font></font>
        hostportManager hostport.HostPortManager<font></font>
<font></font>
        appArmorProfile <span class="hljs-keyword">string</span>
        hostIP          <span class="hljs-keyword">string</span>
        bindAddress     <span class="hljs-keyword">string</span><font></font>
<font></font>
        *lib.ContainerServer<font></font>
        monitorsChan      <span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>{}<font></font>
        defaultIDMappings *idtools.IDMappings<font></font>
        systemContext     *types.SystemContext <span class="hljs-comment">// Never nil</span><font></font>
<font></font>
        updateLock sync.RWMutex<font></font>
<font></font>
        seccompEnabled  <span class="hljs-keyword">bool</span>
        appArmorEnabled <span class="hljs-keyword">bool</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-o / server / server.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// Exec prepares a streaming endpoint to execute a command in the container.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Server)</span> <span class="hljs-title">Exec</span><span class="hljs-params">(ctx context.Context, req *pb.ExecRequest)</span> <span class="hljs-params">(resp *pb.ExecResponse, err error)</span></span> {
        <span class="hljs-keyword">const</span> operation = <span class="hljs-string">"exec"</span>
        <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {<font></font>
                recordOperation(operation, time.Now())<font></font>
                recordError(operation, err)<font></font>
        }()<font></font>
<font></font>
        resp, err = s.getExec(req)<font></font>
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"unable to prepare exec endpoint: %v"</span>, err)<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> resp, <span class="hljs-literal">nil</span>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-o / erver / container_exec.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒã‚§ãƒ¼ãƒ³ã®æœ€å¾Œã§ã€ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¯æœ¬ç•ªãƒãƒ¼ãƒ‰ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// ExecContainer prepares a streaming endpoint to execute a command in the container.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(r *runtimeOCI)</span> <span class="hljs-title">ExecContainer</span><span class="hljs-params">(c *Container, cmd []<span class="hljs-keyword">string</span>, stdin io.Reader, stdout, stderr io.WriteCloser, tty <span class="hljs-keyword">bool</span>, resize &lt;-<span class="hljs-keyword">chan</span> remotecommand.TerminalSize)</span> <span class="hljs-title">error</span></span> {<font></font>
        processFile, err := prepareProcessExec(c, cmd, tty)<font></font>
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> err<font></font>
        }<font></font>
        <span class="hljs-keyword">defer</span> os.RemoveAll(processFile.Name())<font></font>
<font></font>
        args := []<span class="hljs-keyword">string</span>{rootFlag, r.root, <span class="hljs-string">"exec"</span>}<font></font>
        args = <span class="hljs-built_in">append</span>(args, <span class="hljs-string">"--process"</span>, processFile.Name(), c.ID())<font></font>
        execCmd := exec.Command(r.path, args...)<font></font>
        <span class="hljs-keyword">if</span> v, found := os.LookupEnv(<span class="hljs-string">"XDG_RUNTIME_DIR"</span>); found {<font></font>
                execCmd.Env = <span class="hljs-built_in">append</span>(execCmd.Env, fmt.Sprintf(<span class="hljs-string">"XDG_RUNTIME_DIR=%s"</span>, v))<font></font>
        }<font></font>
        <span class="hljs-keyword">var</span> cmdErr, copyError error
        <span class="hljs-keyword">if</span> tty {<font></font>
                cmdErr = ttyCmd(execCmd, stdin, stdout, resize)<font></font>
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> stdin != <span class="hljs-literal">nil</span> {
                        <span class="hljs-comment">// Use an os.Pipe here as it returns true *os.File objects.</span>
                        <span class="hljs-comment">// This way, if you run 'kubectl exec &lt;pod&gt; -i bash' (no tty) and type 'exit',</span>
                        <span class="hljs-comment">// the call below to execCmd.Run() can unblock because its Stdin is the read half</span>
                        <span class="hljs-comment">// of the pipe.</span><font></font>
                        r, w, err := os.Pipe()<font></font>
                        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                                <span class="hljs-keyword">return</span> err<font></font>
                        }<font></font>
                        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> { _, copyError = pools.Copy(w, stdin) }()<font></font>
<font></font>
                        execCmd.Stdin = r<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> stdout != <span class="hljs-literal">nil</span> {<font></font>
                        execCmd.Stdout = stdout<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> stderr != <span class="hljs-literal">nil</span> {<font></font>
                        execCmd.Stderr = stderr<font></font>
                }<font></font>
<font></font>
                cmdErr = execCmd.Run()<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> copyError != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> copyError<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> exitErr, ok := cmdErr.(*exec.ExitError); ok {
                <span class="hljs-keyword">return</span> &amp;utilexec.ExitErrorWrapper{ExitError: exitErr}<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> cmdErr<font></font>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cri-o / internal / oci / runtime_oci.go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/hm/dt/jk/hmdtjkw28fyrng0zsjghbw7tq5g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æœ€å¾Œã«ã€ã‚«ãƒ¼ãƒãƒ«ã¯ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f2/7n/jk/f27njkgk1lqwo0ik-9vkj-kocic.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> APIã‚µãƒ¼ãƒãƒ¼ã¯kubeletã¸ã®æ¥ç¶šã‚’é–‹å§‹ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä»¥ä¸‹ã®æ¥ç¶šã¯ã€å¯¾è©±å¼execã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒçµ‚äº†ã™ã‚‹ã¾ã§ç¶­æŒã•ã‚Œã¾ã™ã€‚</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kubectlã¨api-serverã®é–“ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> api-serverã¨kubectlã®é–“ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kubeletã¨ã‚³ãƒ³ãƒ†ãƒŠãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®é–“ã€‚</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubectlã¾ãŸã¯api-serverã¯ã€æœ¬ç•ªãƒãƒ¼ãƒ‰ã§ã¯ä½•ã‚‚å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">Kubeletã¯é–‹å§‹ã§ãã¾ã™ãŒã€ã“ã‚Œã‚‰ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å ´åˆã€ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¨ã‚‚å¯¾è©±ã—ã¾ã™ã€‚</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è³‡æº</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kubernetes-devã§ã®</font><font style="vertical-align: inherit;">ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How dosã€kubectl execã€Œwork</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ã®èª¬æ˜ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨˜äº‹ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vagrant Machinesã§ã®kubeadmã®ä½¿ç”¨ã€ãƒ‘ãƒ¼ãƒˆ2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unixã‚½ã‚±ãƒƒãƒˆæ¥ç¶šã®ã‚‚ã†ä¸€æ–¹ã®ç«¯ã‚’è¦‹ã¤ã‘ã‚‹æ–¹æ³•ã¯ï¼Ÿ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œã‚µãƒ¼ãƒãƒ¼éšœå®³ã€‚</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¿»è¨³è€…ã‹ã‚‰ã®PS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã®ãƒ–ãƒ­ã‚°ã‚‚èª­ã‚“ã§ãã ã•ã„ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œkubectl runãŒé–‹å§‹ã•ã‚Œã‚‹ã¨ã€Kubernetesã§ä½•ãŒèµ·ã“ã‚Šã¾ã™ã‹ï¼Ÿã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒˆ1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒˆ2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã¯ã€Kubernetesã®ãƒãƒƒãƒ‰ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetesã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã¯å®Ÿéš›ã«ã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿã€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">";</font></font></li>
<li> Â«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">     Kubernetes</a>Â».</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja466071/index.html">ãƒãƒƒã‚·ãƒ¥ã‚ãŸã‚Š10.3ç§’ï¼šã‚¢ãƒãƒ­å®‡å®™èˆ¹æ­è¼‰åˆ¶å¾¡ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§ã®ãƒã‚¤ãƒ‹ãƒ³ã‚°</a></li>
<li><a href="../ja466075/index.html">ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã§åŸºç¤ç§‘å­¦ã‚’ã©ã®ã‚ˆã†ã«æ®‹ã—ãŸã‹</a></li>
<li><a href="../ja466077/index.html">ã‚µãƒ³ã‚¯ãƒˆãƒšãƒ†ãƒ«ãƒ–ãƒ«ã‚¯ã§ã®Techdir Dayã®æ”¾é€</a></li>
<li><a href="../ja466081/index.html">9æœˆ3æ—¥</a></li>
<li><a href="../ja466089/index.html">æ€è€ƒã¨æ„è­˜ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€ãƒ‘ãƒ¼ãƒˆ2</a></li>
<li><a href="../ja466097/index.html">.NETã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç›£è¦–</a></li>
<li><a href="../ja466099/index.html">ãƒ“ãƒ‡ã‚ªã‚µãƒ¼ãƒ“ã‚¹ç”¨ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆã®æ©Ÿèƒ½</a></li>
<li><a href="../ja466103/index.html">ã‚¯ãƒ©ã‚¦ãƒ‰ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ç›£è¦–</a></li>
<li><a href="../ja466105/index.html">RoadRunnerã«ã‚ˆã‚‹Magento Rest APIã®ã‚ªãƒ¼ãƒãƒ¼ã‚¯ãƒ­ãƒƒã‚¯</a></li>
<li><a href="../ja466107/index.html">æ—¥æ›œå¤§å·¥ã®ã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ </a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>