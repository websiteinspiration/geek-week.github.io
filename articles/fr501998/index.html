<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÆ üë©‚Äçüî¨ ‚õ≥Ô∏è Prix ‚Äã‚Äãcher des styles. Rapport Yandex üèûÔ∏è ü§® üë®‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le chargement de CSS sur une page est une op√©ration de blocage. Si le chargement asynchrone de JavaScript peut ne pas √™tre visible pour l'utilisateur,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Prix ‚Äã‚Äãcher des styles. Rapport Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/501998/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le chargement de CSS sur une page est une op√©ration de blocage. </font><font style="vertical-align: inherit;">Si le chargement asynchrone de JavaScript peut ne pas √™tre visible pour l'utilisateur, alors la lenteur de l'apparition des styles peut pousser un invit√© impatient √† quitter le site. </font><font style="vertical-align: inherit;">Comment charger CSS de mani√®re aussi efficace et transparente que possible pour les utilisateurs? </font><font style="vertical-align: inherit;">Nikita Dubko essaie de comprendre</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DarkMeFoDy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du groupe d'interface de recherche Yandex √† Minsk.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kATRlMrtaaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Bonjour √† tous. </font><font style="vertical-align: inherit;">Je vais vous parler des styles. </font><font style="vertical-align: inherit;">Tout le monde parle de TypeScript et TypeScript aujourd'hui. </font><font style="vertical-align: inherit;">Et je vais parler du script de style Cascade.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peu de temps sur moi. </font><font style="vertical-align: inherit;">Je suis un d√©veloppeur bi√©lorusse - apr√®s le film Dudya, je le dirai partout. </font><font style="vertical-align: inherit;">Vous avez peut-√™tre entendu ma voix dans le podcast Web Standards, et si vous voyez des fautes de frappe dans le fil d'actualit√©s Web Standards, c'est probablement moi aussi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Petit avertissement. </font><font style="vertical-align: inherit;">Il y aura plusieurs folies dans le rapport - traitez tout ce que je dis avec beaucoup de critiques. </font><font style="vertical-align: inherit;">R√©fl√©chissez √† la raison pour laquelle vous pouvez utiliser ces techniques et pourquoi vous n'en avez pas besoin. </font><font style="vertical-align: inherit;">Certaines choses seront vraiment folles. </font><font style="vertical-align: inherit;">Aller.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer - pourquoi parler d'optimisation CSS? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous commencez √† chercher dans les moteurs de recherche des t√©l√©chargements JS rapides, il y a beaucoup de r√©sultats. Si vous recherchez un chargement CSS rapide, le haut n'affiche m√™me pas le CSS dont vous avez besoin. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/fy/mh/fdfymhsjiglvpavgqbzxrczyqo8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous regardez Google, il y a 111 millions de r√©sultats sur JS et environ CSS sur 26 millions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors peut-√™tre que cela n'a pas d'importance? Pourquoi en parler? Si vous recherchez des rapports de performance JS, vous en trouverez beaucoup. Il y a √† propos de React, de toutes sortes d'autres frameworks, de Vanilla, etc. Mais √† propos de CSS, je n'ai trouv√© qu'un seul rapport. Harry Roberts en 2018 a lu un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapport</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sympa </font><font style="vertical-align: inherit;">sur les performances CSS. Je pensais avoir trouv√© un deuxi√®me </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapport</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par Roma Dvornova, ¬´Parsim CSS: conseils et astuces de performance¬ª. Mais il s'est av√©r√© √™tre un rapport JS qui analyse CSS. Pas exactement ce dont nous avons besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'av√®re qu'ils ne pensent pas beaucoup au CSS. C'est dommage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais quand je vais sur le Web, je vois g√©n√©ralement du HTML. Et je vois aussi du CSS qui stylise la page. Mais je ne vois pas JS. JS est une chose qui d√©place CSS et HTML sur une page pour que tout soit beau. Ceci est un script. Et si JS ne se charge pas, ce n'est pas aussi mauvais que si CSS ne se charge pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les erreurs dans JS tombent silencieusement dans la console. Et il est peu probable que l'utilisateur moyen entre dans DevTools pour regarder: "Oh, vous l'avez l√†, une erreur dans la console." Mais si CSS ne se charge pas, vous ne verrez peut-√™tre pas du tout tout ce dont vous avez besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, il existe des √©tudes sur le fait que l'essentiel est de faire une premi√®re impression.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38% des</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateurs peuvent aller sur le site, et s'ils voient que c'est directement d√©go√ªtant, ils partiront imm√©diatement. Et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">88%</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tol√©reront, l'utiliseront une fois, puis ils ne reviendront jamais et sont peu susceptibles de conseiller votre site. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous sommes tous assis √† la maison, le trafic Internet a particuli√®rement augment√©. Et nous devons r√©fl√©chir √† la mani√®re de fournir efficacement des ressources aux utilisateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons de compter du point de vue de Yandex. Si nous pouvons optimiser chaque livraison Yandex pendant 100 ms et donner, disons, 200 millions de pages par jour (je ne connais pas le nombre exact), alors ce jour nous √©conomiserons 0,1 s * 200 millions = 232 personnes-jours. Juste en optimisant la sortie pour 100 millisecondes. Et CSS le fait aussi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jouons un peu aux d√©tectives et d√©couvrons comment tirer le meilleur parti des styles de chargement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesure!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le tout premier conseil est de toujours tout mesurer. Il est inutile de faire des optimisations th√©oriquement. Vous pouvez supposer que l'optimisation fonctionne dans votre cas, mais des mesures r√©elles ne montreront rien de tel. Il s'agit de la r√®gle la plus importante de toute optimisation. </font><font style="vertical-align: inherit;">Andrei Prokopyuk de l'√©quipe SERP Velocity sur HolyJS </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tr√®s bien </font><font style="vertical-align: inherit;">expliqu√© </font><font style="vertical-align: inherit;">comment nous proc√©dons </font><font style="vertical-align: inherit;">, je ne vais pas me r√©p√©ter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quels outils de mesure existe-t-il? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Si vous voulez mesurer sur des appareils plus ou moins r√©els, lents, pas aussi cool que les v√¥tres, utilisez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebPageTest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . J'y prends habituellement des mesures. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Vous avez Lighthouse si vous utilisez des navigateurs bas√©s sur Chromium. Lui, comme les mesures locales, montre de tr√®s bonnes choses.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Si vous √™tes s√ªr de pouvoir tout faire vous-m√™me, acc√©dez √† DevTools, dans l'onglet Performances. Il a beaucoup de d√©tails, vous pouvez d√©marrer vos propres m√©triques et les analyser. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vx/xl/jl/vxxljlbogdfjvd0v2kyqedewfxy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, dans Performance, il est n√©cessaire de d√©finir des conditions r√©elles. Vous √™tes assis sur votre ordinateur portable cool avec Internet cool dans le bureau, tout est incroyable ici, mais ils viennent √† vous et disent: "Je suis lent." Et vous dites: "Tout fonctionne pour moi." Ne fais pas √ßa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayez toujours de v√©rifier comment l'utilisateur dans les conditions du m√©tro ou ailleurs utilisera votre site. Pour ce faire, vous devez configurer un Internet tr√®s lent. Il est √©galement conseill√© de ralentir le CPU, car quelqu'un peut venir chez vous depuis un Nokia 3110. Il a √©galement besoin de montrer le site.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus important: mesurer sur de vrais utilisateurs. Il existe une telle m√©trique, plus pr√©cis√©ment, tout un ensemble de m√©triques - RUM, Real User Monitoring. C'est lorsque vous mesurez non pas ce qui se passe synth√©tiquement dans votre code, mais des mesures sur de vrais utilisateurs en production. Par exemple, du chargement d'une page √† une action. Une action est, par exemple, quelque chose qui fonctionne dans le navigateur ou m√™me un clic sur un √©l√©ment important. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N'oubliez pas que vous ne d√©veloppez pas pour les robots. Sotka in Lighthouse - c'est super, c'est vraiment bon. Ainsi, vous remplissez au moins les exigences fix√©es par le phare. Mais il y a de vrais utilisateurs, et si l'utilisateur n'est pas en mesure de voir la page lorsqu'il se soul√®ve dans Lighthouse, alors vous faites quelque chose de mal.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z-/fy/cn/z-fycndvddxfylx_s_ahdxjolpc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a des param√®tres sur lesquels il est important de se concentrer. </font><font style="vertical-align: inherit;">Il s'agit de First Contentful Paint, lorsque le premier contenu appara√Æt sur votre page avec lequel vous pouvez faire quelque chose, lisez. </font><font style="vertical-align: inherit;">Cette m√©trique est envoy√©e dans les navigateurs Chromium, vous pouvez l'obtenir. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mt/xi/mi/mtximitp8tflgksudiaaporikko.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©cemment, vous pouvez toujours consulter la plus grande peinture riche en contenu. </font><font style="vertical-align: inherit;">Il arrive souvent que vous ayez une page m√©dia, et il est important, par exemple, de regarder une photo dessus. </font><font style="vertical-align: inherit;">Ensuite, vous avez besoin de cette m√©trique particuli√®re.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chargement CSS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons enfin au CSS, comment le CSS est charg√©. </font><font style="vertical-align: inherit;">Les r√©ceptions sont connues depuis longtemps. </font><font style="vertical-align: inherit;">Il existe un chemin de rendu critique, un chemin de rendu critique. </font><font style="vertical-align: inherit;">Il s'agit de ce que fait le navigateur depuis le moment de l'envoi de la demande de ressource jusqu'au moment o√π les pixels sont affich√©s sur l'√©cran de l'utilisateur. </font><font style="vertical-align: inherit;">√Ä ce sujet aussi, il y a un tas d'articles et de rapports. </font><font style="vertical-align: inherit;">Mais jetons un coup d'≈ìil √† la fa√ßon dont ce navigateur le fait.</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ru"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CSS ‚Äî  <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/main.ac74gsac.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il commence √† t√©l√©charger du HTML, voit des balises. </font><font style="vertical-align: inherit;">Il les analyse progressivement, comprend ce qu'il faut en faire. </font><font style="vertical-align: inherit;">Charges. </font><font style="vertical-align: inherit;">Entr√© √† travers le lien. </font><font style="vertical-align: inherit;">Il doit √™tre utilis√©. </font><font style="vertical-align: inherit;">Mais comment? </font><font style="vertical-align: inherit;">Vous devez d'abord le t√©l√©charger. </font><font style="vertical-align: inherit;">Le t√©l√©chargement est lent. </font><font style="vertical-align: inherit;">Lorsqu'il se charge, il commence √† analyser la page davantage.</font></font><br>
<br>
<pre><code class="html hljs xml"> <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ru"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CSS ‚Äî  <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/main.ac74gsac.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>-!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S'il tombe sur un autre lien, il est √† nouveau bloqu√© et ne permet pas son ex√©cution. </font><font style="vertical-align: inherit;">Bloque JS, bloque l'analyse. </font><font style="vertical-align: inherit;">Et jusqu'√† ce qu'il d√©marre, il ne fait rien. </font><font style="vertical-align: inherit;">Mais ensuite, cela commence √† fonctionner davantage.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;link&gt;</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allons plus loin - que se passe-t-il lorsque vous acc√©dez au lien? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3w/eb/cs/3webcs2yte1_pqw5nzwvmj_epy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'enregistrement o√π nous allons est standard. </font><font style="vertical-align: inherit;">Il y a un style CSS qui se trouve quelque part. </font><font style="vertical-align: inherit;">Maintenant, il est √† la mode de mettre toutes les statistiques sur le CDN.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O√π aller?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, le navigateur doit comprendre o√π aller. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u8/me/ix/u8meixyugzfctlaocm2xzo862po.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il voit l'URL et il doit comprendre cette URL - de quoi s'agit-il? Nous sommes habitu√©s au fait que l'URL est un identifiant de site. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/26/2m/6b/262m6bmfjupam-ega9z7tmpibzk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais physiquement, nous devons obtenir l'adresse IP de cette URL et acc√©der √† la v√©ritable machine physique √† l'adresse IP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ys/nq/ah/ysnqah21cz075zefg6khjupdm-w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour votre CDN, il recevra un enregistrement DNS et ira directement √† l'adresse IP. Comment acc√©l√©rer dans ce cas? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lz/cl/sn/lzclsnosywf5yaqi0fihvdefism.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une id√©e folle est de r√©duire la distance entre l'utilisateur et le serveur DNS. Prenez et transplantez l'utilisateur. Par exemple, pour afficher le message: ¬´Asseyez-vous plus pr√®s¬ª ou ¬´Rapprochez-vous¬ª. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez imm√©diatement sp√©cifier l'adresse IP dans le lien. Pourquoi devons-nous rechercher le DNS, r√©soudre les domaines, si vous pouvez donner imm√©diatement le r√©sultat par adresse IP? C'est une fa√ßon folle, mais dans le cas des serveurs DNS mondiaux DDoS, cela peut m√™me vous sauver.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous pouvons nous d√©barrasser de l'obtention d'une adresse IP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s4/i0/1v/s4i01v9rasbbahddidnteghzu8a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En vous tournant vers votre index.html ou vers un autre fichier, vous connaissez d√©j√† l'adresse de domaine o√π vous allez. Voici juste le cas o√π, au lieu de stocker des statistiques sur un domaine ou sous-domaine s√©par√©, vous pouvez rapprocher les statistiques de votre domaine, √† savoir ce domaine lui-m√™me. Le DNS n'a alors pas besoin d'√™tre r√©solu, il l'est d√©j√†. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zn/l1/gg/znl1ggztpsl37dgk1cmfo0ob8c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons trouv√© o√π aller. Mais nous pouvons faire de telles choses √† l'avance pour le navigateur. Si, par exemple, votre feuille de style est charg√©e beaucoup plus tard via l'arborescence DOM, vous pouvez dire au navigateur en utilisant &lt;link rel = "dns-prefetch"&gt; que "je n'y vais pas encore, mais vous r√©chaufferez les ressources, j'en aurai certainement besoin plus tard ".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette entr√©e, vous dites au navigateur de descendre et d'obtenir ce DNS. </font><font style="vertical-align: inherit;">Lorsque le lien appara√Æt dans le code, le navigateur conna√Æt d√©j√† l'adresse IP de ce domaine. </font><font style="vertical-align: inherit;">Vous pouvez faire de telles choses pr√©liminaires. </font><font style="vertical-align: inherit;">La m√™me chose, par exemple, avant d'entrer dans la page suivante, o√π vous irez certainement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, le navigateur sait o√π aller. </font><font style="vertical-align: inherit;">Il doit comprendre comment s'y prendre.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment y aller</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous observons le protocole. Maintenant, bien s√ªr, https est une exigence directe. L'inclusion de moteurs de recherche marquera vos sites ne figurant pas sur https avec des formulaires comme n'√©tant pas enti√®rement s√ªrs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai trouv√© une incroyable </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://howhttps.works/why-do-we-need-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√©rie de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bandes dessin√©es sur le fonctionnement de la carte https. Mais nous sommes des informaticiens, nous adorons les diagrammes complexes et les bandes dessin√©es amusantes sont trop faciles. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/hh/p1/jqhhp1dzstopvkbbsf70gnkxwpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, j'ai formul√© dans mes propres mots comment fonctionne https. Vous obtenez d'abord un certificat SSL de votre serveur. Ensuite, vous devez v√©rifier le certificat aupr√®s d'une autorit√© de certification. Ce sont des serveurs sp√©ciaux qui savent ce qui est valide et ce qui ne l'est pas, et peuvent inviter les navigateurs: ¬´oui, tout va bien ici, utilisez ce certificat¬ª.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vient ensuite la g√©n√©ration de cl√©s de communication entre le serveur et le client, le chiffrement, le d√©chiffrement √† l'aide de cl√©s diff√©rentes. Le processus est int√©ressant si vous le regardez en termes de cryptographie. Mais nous voulons acc√©l√©rer. Comment? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/g1/ue/pqg1ueqmruwadkjjb7ff5sstwu0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons √† nouveau transf√©rer l'utilisateur plus pr√®s des serveurs. Nous avons d√©j√† un DNS, maintenant nous pouvons le rapprocher de l'autorit√© de certification. Et mettre entre ces serveurs sera parfait. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez d√©sactiver https, pourquoi en avons-nous besoin? Nous passons du temps √† obtenir un certificat, √† chiffrer, √† d√©chiffrer. Pas vraiment. C'est le conseil le plus nuisible du rapport, ne le faites pas. https est la protection des donn√©es utilisateur, et http / 2 ne fonctionnera pas sans https, et http / 2 est un autre moyen d'acc√©l√©rer.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/hh/p1/jqhhp1dzstopvkbbsf70gnkxwpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe √©galement la technologie d'agrafage OCSP. Vous pouvez v√©rifier un certificat sans autorit√© de certification. C'est probablement plus proche de DevOps. Vous devez configurer votre serveur d'une certaine mani√®re afin qu'il puisse mettre en cache la r√©ponse de l'autorit√© de certification et √©mettre √† l'utilisateur: "Croyez-moi, mon certificat est vraiment r√©el." Ainsi, nous pouvons enregistrer au moins l'√©tape √† laquelle nous nous adressons √† l'autorit√© de certification. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais il y a une nuance - dans Chrome, cela ne fonctionne pas, et pendant longtemps. Mais pour l'utilisateur d'autres navigateurs, vous pouvez acc√©l√©rer ce processus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai d√©j√† dit deux fois qu'il √©tait n√©cessaire de transplanter l'utilisateur, et l'id√©e monte en fl√®che - pour rapprocher le serveur de l'utilisateur. Je n'ai rien d√©couvert de nouveau pour toi. Il s'agit d'un CDN, un r√©seau de distribution de contenu distribu√©. L'id√©e est que vous pouvez utiliser sidienki pr√™t √† l'emploi, cr√©er ind√©pendamment votre propre infrastructure et mettre un tas de serveurs √† travers le monde, dans la mesure o√π l'argent et les opportunit√©s vous le permettent. Mais vous devez organiser le serveur afin qu'un utilisateur australien acc√®de aux serveurs australiens. Ici, la vitesse de la lumi√®re joue sur vous, plus la distance est petite, plus les √©lectrons la traversent rapidement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creusons plus profond√©ment. Que se passe-t-il d'autre dans la demande? En fait, https n'est qu'un wrapper sur http. Pas seulement un emballage sympa. Et encore plus profond, http est une telle demande de la famille TCP / IP.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wl/be/sf/wlbesfr8mnsmulrqrlgazdwxa_4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment les paquets et les octets sont-ils envoy√©s sur le r√©seau afin que tous les navigateurs, clients et serveurs communiquent entre eux? </font><font style="vertical-align: inherit;">La premi√®re chose qu'un client / serveur fait sur une connexion TCP / IP est une poign√©e de main. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais en 2020, l'OMS recommande d'√©viter les poign√©es de main. </font><font style="vertical-align: inherit;">Il existe une telle technologie TCP Fast Open. </font><font style="vertical-align: inherit;">Vous pouvez, au moment de la poign√©e de main, √©viter toute la cha√Æne ¬´Bonjour, je suis un client¬ª - ¬´Bonjour, je suis un serveur¬ª - ¬´Je vous crois¬ª - ¬´Et je vous crois. </font><font style="vertical-align: inherit;">Aller". </font><font style="vertical-align: inherit;">Vous pouvez d√©j√† envoyer des donn√©es utiles en ce moment. </font><font style="vertical-align: inherit;">Et si la poign√©e de main a r√©ussi, une partie des donn√©es utiles est pass√©e. </font><font style="vertical-align: inherit;">Il s'agit de TCP Fast Open.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que ramasser?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons ce que le client doit retirer du serveur. </font><font style="vertical-align: inherit;">L'essentiel n'est pas que le client prenne quelque chose du serveur, mais le serveur donne les donn√©es au client. </font><font style="vertical-align: inherit;">Alors vous pourriez penser: User-Agent. </font><font style="vertical-align: inherit;">Je peux obtenir l'agent utilisateur du client, savoir √† quel navigateur l'utilisateur s'est connect√©. </font><font style="vertical-align: inherit;">D√©couvrez approximativement s'il ne me trompe pas, ce navigateur.</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.example</span> {
    <span class="hljs-attribute">display</span>: -ms-grid;
    <span class="hljs-attribute">display</span>: grid;
    <span class="hljs-attribute">-webkit-transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">-o-transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">-webkit-user-select</span>: none;
       <span class="hljs-attribute">-moz-user-select</span>: none;
        <span class="hljs-attribute">-ms-user-select</span>: none;
            <span class="hljs-attribute">user-select</span>: none;
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">-webkit-gradient</span>(linear, left top, left bottom, from(white), <span class="hljs-built_in">to</span>(black));
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">-o-linear-gradient</span>(top, white, black);
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, white, black);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Disons qu'il s'est connect√© depuis Firefox. </font><font style="vertical-align: inherit;">Comme d'habitude, j'ai un assemblage dans lequel l'autoprefixeur est ringard, il a g√©n√©r√© un tas de code pour moi. </font><font style="vertical-align: inherit;">Oui, c'est une approche cool que tout fonctionnera partout. </font><font style="vertical-align: inherit;">Mais je sais d√©j√† que l'utilisateur s'est connect√© depuis Firefox. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi ne pas d√©sactiver tous les exc√®s? </font><font style="vertical-align: inherit;">D'accord, il y a beaucoup moins de lignes, nous envoyons moins d'octets, c'est cool. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons une version all√©g√©e de SERP, Granny. </font><font style="vertical-align: inherit;">Vitaly Kharisov a parl√© d'elle</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vithar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapport de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font><font style="vertical-align: inherit;">sur les Web Standards Days. Il utilise exactement cette approche. Nous pouvons g√©n√©rer plusieurs bundles et les donner √† diff√©rents clients de diff√©rentes mani√®res. Ils p√®sent beaucoup moins, car Firefox obtient le sien, WebKit obtient le sien, et cela fonctionne, c'est v√©rifi√©. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/av/3l/rj/av3lrjwxk0h7r1uvu2soqygili8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus loin. Nous traitons tr√®s probablement les demandes des utilisateurs, nous savons que la personne est autoris√©e et utilisons certaines informations personnelles pour elle. Il est logique que nous obtenions quelque chose de la base de donn√©es. Mais pas tout! Il y a des choses statiques qui ne diff√®rent pour aucun des utilisateurs, elles sont exactement les m√™mes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
James Akvuh a lu un </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">rapport</font></a><font style="vertical-align: inherit;"> sympa √† ce sujet</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´Rendu c√¥t√© serveur. </font><font style="vertical-align: inherit;">Fais le toi-m√™me". </font><font style="vertical-align: inherit;">Dans quel but? </font><font style="vertical-align: inherit;">Vous savez d√©j√† que vous avez du HTML et une sorte de CSS identique pour tous les utilisateurs. </font><font style="vertical-align: inherit;">Avant d'aller chercher des donn√©es, vous pouvez g√©n√©rer la sortie de ces donn√©es statiques, envoyer imm√©diatement les plus utiles dans un flux depuis le serveur. </font><font style="vertical-align: inherit;">Et apr√®s cela - optez pour les donn√©es, recevez-les rapidement, convertissez-les en mod√®les et donnez-les au client. </font><font style="vertical-align: inherit;">Et l'utilisateur verra d√©j√† quelque chose d'utile.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Votre navigateur ne prend pas en charge la vid√©o HTML5.</font></font><source src="https://mefody.dev/talks/css-cost/images/screencast-yandex-prerender.mp4" type="video/mp4"></video></div></div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous l'avons mis en ≈ìuvre il y a longtemps. Nous avons sur SERP, sur la page de recherche principale, deux phases - pr√©-recherche et post-recherche. La recherche pr√©alable consiste √† envoyer toutes les pi√®ces qui n'ont pas besoin de savoir quel utilisateur s'est connect√©. On peut d√©j√† lui donner, par exemple, un chapeau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, nous avons une barre de recherche que l'utilisateur peut commencer √† utiliser avant que tout le reste ne se charge. Ceci est utile sur une connexion lente. Nous le faisons, cela fonctionne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et j'ai aussi parl√© de http / 2. Ceci est enti√®rement pris en charge par les navigateurs modernes, donc si vous ne l'avez pas encore configur√© sur votre serveur, essayez au moins de savoir comment le configurer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Server Push est une technologie g√©niale qui dit: ¬´Navigateur, je ne vous ai pas encore donn√© la connaissance que vous avez besoin d'une sorte de CSS. Mais je sais exactement ce qui est n√©cessaire. Alors tenez-le, pr√©chargez-le. " </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6b/hr/do/6bhrdomeghpruxrhggwss8lpe4a.png"><br>
<br>
<img src="https://habrastorage.org/webt/0_/h-/eo/0_h-eognhuhs4pp55sj0rzltkly.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est pas difficile. Vous devez configurer quelques en-t√™tes sur le serveur et tout commencera √† fonctionner. Si le navigateur ne conna√Æt pas ce titre, rien ne se cassera, c'est le plus beau. Creusons encore plus loin. TCP Nous en avons d√©j√† parl√©: une poign√©e de main, des octets sont envoy√©s. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ht/f4/gy/htf4gytrvdio_te6zyz5wsevhn8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lavez-vous les mains apr√®s une poign√©e de main. Mais en termes de TCP, nous commen√ßons √† transmettre des octets, et les algorithmes sont suffisamment optimis√©s pour que le serveur client ne reste pas inactif.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, un certain segment de donn√©es est envoy√© en premier. Par d√©faut, (cela vous pouvez changer dans les param√®tres), il est de 1460 octets. Le serveur n'envoie pas d'informations sur un segment. Il envoie des fen√™tres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re fen√™tre est de 14 600 octets, dix segments. Ensuite, si la connexion est bonne, il commence √† agrandir les fen√™tres. Si la connexion est mauvaise, cela peut r√©duire la fen√™tre. Qu'est-ce qu'il est important de comprendre? Il y a la premi√®re fen√™tre de dix segments, dans laquelle vous devez adapter l'int√©gralit√© du site, si vous le souhaitez. Et puis il y aura une vitesse maximale d'apparition du contenu. </font><font style="vertical-align: inherit;">Vitaliy Kharisov a </font><font style="vertical-align: inherit;">√©galement lu un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapport</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† ce sujet </font><font style="vertical-align: inherit;">. Et oui, il est possible de regrouper un site avec tout ce dont vous avez besoin dans une seule fen√™tre si vous d√©sactivez, par exemple, JS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une nuance importante. </font><font style="vertical-align: inherit;">Lorsque vous remplissez un segment entier, il s'agit d'un seul segment. </font><font style="vertical-align: inherit;">Mais si vous n'envoyez qu'un octet suppl√©mentaire, le serveur enverra tout de m√™me un segment suppl√©mentaire. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h4/8v/ut/h48vut1nv1yldqqdo2ubbe3miai.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez faire une optimisation int√©ressante, r√©duire la sortie d'un kilo-octet entier, mais vous ne verrez rien sur vos mesures - peut-√™tre √† cause de cela. </font><font style="vertical-align: inherit;">Essayez de faire l'optimisation normalement sur plusieurs segments. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtrange: je suis typographe, et je raconte des choses de serveur si complexes. </font><font style="vertical-align: inherit;">Rapprochez-vous encore du vrai CSS.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exp√©dier moins</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, nous envoyons moins √† l'utilisateur, moins de segments, vient plus vite, l'utilisateur est content. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/76/hb/6l/76hb6lkb_giyi6iwvnfvaui4yuk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Minification. Elle √©tait toute install√©e sur ses projets. Il y a un tas d'outils sympas, de plugins webpack, de param√®tres gulp - en g√©n√©ral, vous le d√©couvrirez par vous-m√™me. Vous pouvez le personnaliser √† la main, mais il ne semble que lorsque vous √™tes s√ªr de pouvoir compresser votre refroidisseur CSS que n'importe quel CSSO. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N'oubliez pas d'activer la compression. Si au moins gzip n'est pas activ√© en 2020, vous faites certainement quelque chose de mal, car il s'agit d'une ancienne technique de compression. En g√©n√©ral, en 2020, il est temps d'utiliser brotli. C'est un bon moyen de r√©duire l√©g√®rement la sortie dans les navigateurs Chromium. Ou, si vous ne souhaitez pas prendre en charge brotli, vous pouvez au moins essayer zopfli.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un algorithme de compression assez lent pour gzip, qui donne simplement les meilleurs r√©sultats de compression et d√©compresse aussi rapidement que gzip normal. Par cons√©quent, zopfli doit √™tre configur√© judicieusement et utilis√© uniquement lorsque vous n'avez pas besoin de sortir des donn√©es √† la vol√©e. Vous pouvez configurer les archiveurs gzip pour qu'ils soient collect√©s lors de l'assemblage √† l'aide de l'algorithme zopfli, et envoy√©s de mani√®re statique d√©j√†, en fait, ne vont pas √† la vol√©e. Cela peut vous aider. Mais mesurez √©galement les r√©sultats.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pu/f6/sm/puf6smovgfumpzw6cdrj4nxvjzo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous ces algorithmes utilisent une sorte de dictionnaires: un dictionnaire est construit sur la base de fragments de code r√©p√©titifs. Mais parfois ils disent: il faut inline, si on inline, alors on se d√©barrasse de la demande. Lier tous les CSS en HTML sera tr√®s rapide. L'astuce est que gzip fonctionne un peu plus efficacement lorsque vous d√©composez les styles et le HTML, car les dictionnaires sont diff√©rents, plus efficaces. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans mon cas, je viens de prendre la page de bootstrap, d'y relier le bootstrap et de comparer les deux versions. Gzip sur les ressources individuelles est de 150 octets de moins. Oui, le gain est tr√®s faible. Ici aussi, vous devez tout mesurer. Mais dans votre cas, cela peut, par exemple, r√©duire le nombre de segments d'un.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment optimiser le code? Je ne parle pas de minification. Retirez ce que vous n'utilisez pas dans le projet. Vous avez probablement du code qui ne s'ex√©cutera jamais sur le client. Pourquoi? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oc/qy/i3/ocqyi32nsmaifhfwjtobuhbfyt0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que vous puissiez automatiser cela, des onglets sp√©ciaux sont int√©gr√©s dans le navigateur, par exemple, dans Chrome DevTools, c'est Coverage, qui vous dit: "Je n'ai pas utilis√© ce CSS ou ce JS, vous pouvez le couper." </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais vous pouvez avoir un survol, une concentration, une activit√©, quelque chose install√© √† l'aide de JS. Vous devez simuler toutes les actions possibles sur le site, alors seulement vous serez s√ªr que ce CSS peut √™tre coup√©. Chris Coyer a un bon </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de synth√®se sur les outils automatiques qui essaient de tout faire avec le survol et la concentration. Mais il est arriv√© √† la conclusion qu'il √©tait impossible d'automatiser cela. Cela ne fonctionne pas encore.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a un bon </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapport d'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anton Kholkin de Booking.com, o√π ils ont √©galement essay√© de supprimer des tas de code h√©rit√©. </font><font style="vertical-align: inherit;">Mais ils avaient une particularit√©: un code h√©rit√© qui provenait de projets externes. </font><font style="vertical-align: inherit;">Il fallait le retirer. </font><font style="vertical-align: inherit;">D√©couvrez les solutions int√©ressantes rencontr√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez vous-m√™me essayer de jouer avec le m√™me Puppeteer, qui est comme Chrome. </font><font style="vertical-align: inherit;">Vous pouvez faire des tests qui passent automatiquement par tout, essayez de faire du survol, de vous concentrer. </font><font style="vertical-align: inherit;">Et utilisez cette m√™me couverture. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon coll√®gue Vitya Khomyakov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">victor-homyakov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fait mon propre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , comme trouver des doublons et des styles sur une page. Prenez, copiez et collez. Il vous √©crira dans la console: "ce s√©lecteur, semble-t-il, vous n'en avez pas besoin." Jusqu'au point qui vient d'entrer dans DevTools. C‚Äôest g√©nial. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5q/4i/4g/5q4i4gjomb59s7ry5xcukiqi0zc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fonctionnalit√© que j'aime beaucoup dans les outils des d√©veloppeurs Firefox: une opportunit√© de voir les styles qui semblent √™tre utilis√©s, mais en fait le navigateur ne les applique pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, vous pouvez d√©finir display: inline, et il semble que cet affichage: inline n'a pas de sens pour d√©finir des tailles. Ou l'alignement vertical, cela ne fonctionne que pour les cellules en ligne ou de tableau. Jusqu'√† pr√©sent, je n'ai vu que dans Firefox qu'il peut mettre en √©vidence: "vous n'avez pas besoin de cette ligne."</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici aussi, vous devez √™tre prudent: vous utiliserez peut-√™tre ce style pour coller plus tard la classe. Mais √† mon avis, une fonctionnalit√© int√©ressante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Posez-vous la question d√®s maintenant: avez-vous besoin de l'ensemble du Bootstrap sur le projet? Placez n'importe quel framework CSS que vous utilisez au lieu de Bootstrap. Tr√®s probablement, vous utilisez Bootstrap pour les grilles et les √©l√©ments plus ou moins courants, et la moiti√© de Bootstrap dont vous n'avez pas besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayez d'utiliser correctement l'assemblage. Presque tous les frameworks CSS modernes vous permettent d'utiliser le code source pour l'assemblage et de s√©lectionner uniquement ce dont vous avez besoin. Cela peut r√©duire consid√©rablement la taille du bundle CSS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ne donnez pas inutilis√©. Au lieu de chercher mon h√©ritage, vous pouvez utiliser la compr√©hension de niveau de construction que cette page n'utilisera pas ce CSS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, une pile BEM compl√®te vous permet de cr√©er l'assemblage de sorte que vous, d√©j√† en donnant la page, puissiez construire une arborescence de tous les composants des blocs BEM qui seront sur la page. BEM vous permet de d√©terminer que si ce bloc n'est pas sur la page, il n'est pas n√©cessaire de charger ce CSS. Exp√©diez uniquement le n√©cessaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√™me les gars de Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : utilisez BEM, cela peut vraiment vous aider pour l'optimisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne pense pas que je le dis √† voix haute, mais dans ce cas, CSS-in-JS semble √™tre une bonne approche. Lorsque vous √©crivez des composants ind√©pendants ind√©pendants et configurez soigneusement l'assembly ou d√©terminez en cours d'ex√©cution quels blocs sont utilis√©s et lesquels ne le sont pas, vous pouvez vous d√©barrasser du probl√®me de trouver un code h√©rit√© en n'envoyant simplement pas ce code au client. Cela semble facile, mais la discipline est n√©cessaire. Pensez-y √† l'avance au d√©but du projet.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/he/na/zrhenay2u6hrppvi4jx-ams_njo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelle autre option existe-t-il? Un peu fou. Dans ce code, il semble que le style ne soit pas n√©cessaire, car nous utilisons un div - la valeur par d√©faut est d√©j√† display: block. Et supprimons tous les param√®tres par d√©faut? Si dans votre projet, vous savez avec certitude que le balisage HTML ne changera plus jamais - parcourez les valeurs par d√©faut que le navigateur fournit d√©j√† et supprimez-les. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moins de styles - super! Mais c'est encore une id√©e folle. CSS n'a pas besoin de conna√Ætre HTML, car c'est un style. Il est assez ind√©pendant, vous devez le connecter √† un autre projet, il devrait y fonctionner. Et oui, c'est difficile √† maintenir. Changez le tag - tout se casse. Id√©e folle comme promis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilisez des variables. CSS a de tr√®s anciennes variables comme currentColor.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vh/eg/om/vhegomyxszcuft3mc8rloetjmio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a souvent un motif: vous voulez, par exemple, cr√©er un bouton dont le texte et la bordure sont de la m√™me couleur. Et en survolant nous les changeons tous les deux. Pourquoi? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/-5/jl/-v-5jle8hdyn94asbckxmh0ev_i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe une variable currentColor qui prend une valeur de couleur, et vous la placez, par exemple, √† la fronti√®re, proxy cette propri√©t√© et modifiez une seule ligne par survol, par focus, par active, tout ce que vous voulez. Cela semble √™tre pratique et le code est devenu une ligne de moins. Vous pouvez optimiser. Par ailleurs, dans cet exemple, vous ne pouvez pas du tout utiliser la t√¢che border-color, car par d√©faut, elle prend d√©j√† une valeur dans la propri√©t√© color. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est parfois tr√®s triste de voir comment la base64 est utilis√©e. En CSS, il √©tait activement recommand√© avant: utiliser base64 pour injecter de petites ic√¥nes. S'il tient dans un segment sur TCP, c'est bon pour vous. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/95/uu/rb/95uurb_rsvp6_xjhnolso-ftl-o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais Harry Roberts aussi</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©alisation d'une</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©tude approfondie sur la fa√ßon dont base64 affecte le chargement des pages. Oui, il y a moins de demandes, mais ces styles sont analys√©s parfois plus lentement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, l'analyse est une op√©ration tr√®s rapide, l'utilisateur ne le remarquera probablement pas. Mais nous avons une m√©trique importante - le premier rendu, afin que l'utilisateur voit quelque chose sur la page. Sur les t√©l√©phones portables, le premier rendu, selon une √©tude de Harry Roberts, se produit dix fois plus tard. R√©fl√©chissez si vous avez besoin de base64? Oui, il y a moins de demandes, mais cela a-t-il eu un effet? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et veuillez ne pas utiliser base64 pour SVG. Parce que SVG est id√©al pour utiliser l'encodeur URL. Julia Bukhvalova a un </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">outil</font></a><font style="vertical-align: inherit;"> sympa</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Entrez, collez votre SVG et il distribuera CSS sous une forme pr√™te √† coller. Vous remarquerez peut-√™tre qu'il n'y a pas de base64, mais certaines choses sont √©chapp√©es qui en CSS peuvent ne pas √™tre per√ßues correctement. C'est beaucoup plus efficace. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En moyenne, base64 donne un avantage de 30% √† la taille de ce que vous compressez. Pourquoi? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilisez une technologie moderne. Nous devrons peut-√™tre prendre en charge Internet Explorer - les arguments habituels lorsque nous parlons de grilles. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pe/mg/xu/pemgxutjaqos0iq67ch7qdzudnc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais pensez-y: si vous ne disposez pas de la prise en charge d'IE et que vous composez toujours sur des flottants ou des tableaux, vous pouvez utiliser des grilles pour cr√©er une disposition en trois colonnes avec un espace de 20 pixels - c'est la distance entre les colonnes. Trois lignes. Eh bien, cinq, compte tenu de l'annonce elle-m√™me.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayez ceci sur un flotteur. Et je veux dire que nous changeons trois lignes, y compris le nom des classes, si vous touchez HTML. Je n'ai pas trouv√© le moyen de faire le m√™me cool sur un flotteur. Jetez vos d√©cisions. Mais utilisez la technologie moderne. Ils vous permettent d'indiquer de mani√®re plus compacte le balisage. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ji/vb/ze/jivbzezcoj7ou78zj5ylexaxd8i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez essayer Atomic CSS. Qu'Est-ce que c'est? Vous √©crivez ces noms de classe un peu fous. Et apr√®s un certain temps, vous commencez √† comprendre que c'est vous qui d√©finissez la couleur de fond ou simplement la couleur. Ce sont les ¬´fonctionnalit√©s¬ª pour CSS. Mais vous avez un ensemble CSS fixe que vous utilisez ensuite en HTML comme indication de style. Et CSS devient soudainement plus petit. Pour les grands projets, il deviendra vraiment plus petit, car il y a moins de styles uniques. Mais vous d√©veloppez du HTML.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/77/fl/gy77flr72xq4fuxlgz0jq3etfcu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez regarder dans la direction de Tailwind CSS, qui gagne maintenant en popularit√©. Ce n'est pas Atomic CSS, il s'agit de classes utilitaires, similaires √† Bootstrap, mais plus utilitaires. Vous pouvez utiliser un ensemble sp√©cifique. Assez vous semble suffisant. Un ensemble de classes qui remplissent leurs fonctions. Vous pouvez √©galement essayer, mais n'en faites pas trop. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kn/ir/8j/knir8jsxsmezohd8gouoba98pk4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre id√©e folle - pourquoi avons-nous besoin de noms de classe entiers sur le client? Oui, c'est pratique pour le d√©veloppement et le d√©bogage, mais prenons tous les noms de classe et faisons-les en une seule lettre. Ce sera moins. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur la fa√ßon de proc√©der. Vous pouvez configurer le webpack ou un autre plugin lors de la construction. Mais cela ne nous a pas d√©coll√©. Nous avons essay√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est av√©r√© que gzip est si cool que tout √©tait assez bien optimis√© pour nous, et BEM et gzip sont incroyablement sympathiques. </font><font style="vertical-align: inherit;">Parce que les constructions de texte sont r√©p√©t√©es pour d√©crire les blocs et les √©l√©ments dans le code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, cela ne nous a apport√© pratiquement aucun profit. </font><font style="vertical-align: inherit;">Mais si, par exemple, vous n'avez pas de BEM et un tas de classes diff√©rentes, vous pouvez essayer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Important: mesure. </font><font style="vertical-align: inherit;">Mesurer toutes ces pi√®ces exp√©rimentales. </font><font style="vertical-align: inherit;">Peut-√™tre que maintenant √ßa marche pour vous, et puis vous avez l√©g√®rement chang√© l'architecture du projet, √ßa a commenc√© √† se monter diff√©remment et tout a ralenti.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©charge le!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'√† pr√©sent, je n'ai parl√© que de la fa√ßon de t√©l√©charger un fichier. Nous l'avons t√©l√©charg√©. Qu'est-ce que l'utilisateur a vu pendant tout ce temps? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/0l/8e/hv0l8e1uk89lmfqategu9yux-je.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a vu un √©cran tellement incroyable. Pendant le t√©l√©chargement, l'√©cran √©tait vide. Nous avons t√©l√©charg√© et le navigateur commence six autres √©tapes. Soyez patient un peu, je vais en parler un peu plus vite que du t√©l√©chargement. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4c/zj/yy/4czjyy-8-jl4c4qdm9dzgczmfes.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par l'analyse. L'analyse est lorsqu'un navigateur a t√©l√©charg√© un flux d'octets et commence √† le diviser en entit√©s qu'il comprend.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/709/df0/50d/709df050daf8e241e96c31e73c720fad.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, il est tomb√© sur l'importation. Celui-ci doit √† nouveau √™tre t√©l√©charg√©. Relisez la premi√®re partie du rapport? l'importation est une op√©ration de blocage. Mais les navigateurs sont intelligents. Ils ont un scanner de pr√©charge. J'ai dit que tout y est bloqu√©, ce n'est pas vrai. Les navigateurs savent que, par exemple, s'il y a trois balises de lien dans une rang√©e qui suivent le style, alors lorsque je t√©l√©charge la premi√®re, vous pouvez commencer √† t√©l√©charger les deuxi√®me et troisi√®me. Il ne peut pas analyser, car toute la structure de l'analyse se brise. Mais t√©l√©chargez √† l'avance - c'est possible. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/yw/qw/abywqwqotl2uyae8y67kpx_-6ky.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'importation est donc une mauvaise chose. Si les styles sont coh√©rents en HTML, le navigateur verra que nous irons plus loin pour un autre fichier.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/zb/-k/xfzb-kzu_zycogs1kilkjp73rsy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et si vous l'ins√©rez directement dans l'importation, il doit d'abord t√©l√©charger votre style.css, puis voir l'importer dedans. Il commence √† analyser ce CSS ... Ouais, on bloque tout d'une nouvelle fa√ßon et c'est parti pour le fichier! Vous pouvez donc faire une cascade fra√Æche avec d√©soptimisation sur le site. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oubliez l'importation ou configurez de sorte qu'il n'y ait pas d'importation apr√®s la g√©n√©ration. Pour l'environnement de d√©veloppement, ok, mais pas pour l'utilisateur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/le/2g/lx/le2glxus3towgrovquopecvq1nu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous passons par les √©tapes de la construction d'arbres, en utilisant Cascade. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qo/g-/q8/qog-q84eqwq9dszmfw3zlo7f__0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout cela est √©galement d√©crit depuis longtemps. Le mod√®le d'objet CSS est construit - un arbre sp√©cial de la fa√ßon dont le navigateur mappe les balises, les classes aux styles. Il relie tout cela au DOM et √©tablit ces connexions tr√®s rapidement. Lorsque vous changez quelque chose, il lui suffit de le changer √† l'int√©rieur de l'arbre.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cp/kv/b1/cpkvb1obn0v0kwyr1ijpgmc3vmc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus le s√©lecteur est grand, plus il est difficile pour le navigateur de dessiner un arbre. Il doit analyser le s√©lecteur, le convertir en arborescences. Et si vous avez ins√©r√©! Important l√†-bas, alors il devrait en tenir compte. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/z_/ld/abz_ldlw6yhtfzvfiak5pjnnjem.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semble qu'il est temps de reparler de BEM. Mais BEM n'est pas n√©cessaire si vous savez utiliser des classes utilitaires, si une classe est responsable d'une fonctionnalit√© et qu'elles n'interf√®rent pas entre elles. Construire un arbre est alors tr√®s simple. Vous avez une structure assez plate et le navigateur doit alors le lier correctement au DOM.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w3/tt/fd/w3ttfdtaor_cd7m8e4gikrch4po.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous faites cela, ils disent que ces s√©lecteurs ralentissent l'analyse CSS. Mais ce sont des l√©gendes il y a longtemps, la diff√©rence est si petite pour le navigateur que dans le projet moyen, vous ne le remarquerez pas si vous optimisez les s√©lecteurs avec des ast√©risques. Mais aimeriez-vous d√©velopper et maintenir un tel code? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/83/1d/po831d3idqqnykaw8ieprtg5eoo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'entendais des conseils: essayez de tout mettre dans un raccourci. l'arri√®re-plan est un raccourci pour de nombreuses autres propri√©t√©s. Nous mettons tout dans une seule propri√©t√©, et cela devient optimal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par octets, oui, il diminue. Mais si vous souhaitez optimiser la composition de CSS OM, le navigateur fera toujours toutes ces propri√©t√©s en arri√®re-plan. Les navigateurs pour chaque √©l√©ment DOM cr√©ent une table de toutes les propri√©t√©s qu'il peut avoir. Lorsque vous regardez les valeurs calcul√©es par DevTools, elles ne sont pas l√† car le navigateur les a calcul√©es en fonction de vos besoins. Il le stocke en m√©moire, car il est beaucoup plus facile de r√©√©crire une propri√©t√© et tout fonctionne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est √©galement un conseil tr√®s √©trange, mais si vous voulez rendre CSS OM plus rapide, vous pouvez imm√©diatement d√©finir toutes les propri√©t√©s une par une. √áa pourrait marcher. Mais la taille du paquet augmentera consid√©rablement. Vous devez mesurer. Je doute que √ßa rapporte, mais tout d'un coup!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque CSS OM est cr√©√©, JS est √©galement verrouill√© √† ce stade. Si la cr√©ation de OM CSS prend deux secondes, JS √©choue. Bien que je ne puisse pas imaginer comment vous avez r√©ussi √† √©crire autant en CSS que l‚Äôarbre est construit pendant deux secondes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/25/0e/un/250eunwpu4yepgffhza-6g1u2dg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, le navigateur fait la mise en page. C'est l'emplacement de tous les √©l√©ments DOM, l'utilisation des positions. Il comprend o√π l'√©l√©ment doit √™tre situ√© et avec quelles dimensions. Il semble qu'√† ce stade, l'utilisateur devrait d√©j√† voir une sorte d'image. Mais il voit tout dans la fen√™tre, peut regarder √† travers une fen√™tre limit√©e. Si quelque chose ne va pas d'en bas, il ne le verra tout simplement pas.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hg/af/_r/hgaf_racfuoqjcan8wci-i94miu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'id√©e s'appelle Critical CSS, et elle est √©galement assez ancienne. Vous ins√©rez des √©l√©ments importants pour le premier √©cran au tout d√©but du t√©l√©chargement. Par exemple, en ligne dans votre code HTML, supprimez toutes les demandes suppl√©mentaires. L'utilisateur voit d'abord cet √©cran, puis le t√©l√©charge comme vous le souhaitez. Tr√®s probablement, il commencera √† d√©filer lorsque vous aurez le temps de le charger. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hb/nk/0u/hbnk0uuz7vgkbubstjoqnfwgsus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela se fait simplement. Il existe des outils qui automatisent tout cela, y compris des plugins pour webpack et React. Recherchez et configurez correctement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/addyosmani/critical</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/pocketjoso/penthouse</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/anthonygore/html-critical-webpack-plugin</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/GoogleChromeLabs/critters</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/1p/pi/qp/1ppiqpkakke_gsbhxo1cybumlgo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ayez une bonne </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">approche</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de Filament Group - comment charger de mani√®re asynchrone sans bloquer CSS. Tout est assez simple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous mettez &lt;link rel = preload&gt;, dites au navigateur: ¬´J'aurai besoin de ce style, mais maintenant nous ne bloquons rien. Vous le t√©l√©chargez maintenant, le cachez et quand je me tourne vers lui, commencez √† construire CSS OM. ¬ª Et vous avez juste besoin de mettre onload et de traiter cela "ok, depuis que je l'ai t√©l√©charg√©, faites-le rel = feuille de style, activez l'analyse." </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une approche assez simple, mais utilisez-la judicieusement aussi. Si vous avez trop de pr√©charge, vous pouvez faire pire. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j1/ny/ri/j1nyrizteczgvkx5dwd78_fy1yy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement jouer avec des expressions multim√©dias. Collez-les et dites au navigateur: "ce style n'est plus n√©cessaire maintenant, mais lorsque cette expression multim√©dia fonctionnera, il sera n√©cessaire." Le navigateur t√©l√©chargera √©galement de mani√®re proactive, mais avec une priorit√© inf√©rieure et sans blocage.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ie/m3/go/iem3golzhy8qq3fulda1iwn8d0u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre approche folle, mais pas si folle - quand vous avez une pouss√©e http / 2. Vous pouvez int√©grer CSS juste devant le bloc. Sans CSS, votre bloc ne sera pas tr√®s beau. Alors pourquoi ne pas int√©grer le CSS dont vous avez besoin pour le bloc suivant avant ce bloc? C'est logique, et http / 2 push vous permettra de l'optimiser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une approche simple. Si vous le d√©veloppez, utilisez le chargement paresseux. Pourquoi un utilisateur devrait-il t√©l√©charger quelque chose qu'il n'utilisera pas? Vous pouvez configurer les composants React de sorte que s'il n'a jamais atteint la zone de visibilit√© de la page, pourquoi devrait-il t√©l√©charger des styles pour lui-m√™me? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Explorez l'API Intersection Observer et vous pourrez peut-√™tre acc√©l√©rer consid√©rablement votre page. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/ag/dz/-vagdzf0qqu3mmpabixf1rw9_ss.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La derni√®re √©tape consiste √† dessiner et √† appliquer des couches composites, √† les coller, etc.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/1v/bc/be1vbcsui3hmenm-0ryzhadzrjs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le navigateur cr√©e des couches composites dans un grand nombre de cas. </font><font style="vertical-align: inherit;">√Ä mon avis, seul un quart du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code source de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chrome </font><font style="vertical-align: inherit;">convient ici </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous pouvez voir par vous-m√™me quand il cr√©e des couches composites dans le code du navigateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©moire vid√©o est limit√©e, en particulier sur les t√©l√©phones portables. </font><font style="vertical-align: inherit;">Si vous apportez tout √† de nouveaux calques pour optimiser les animations en utilisant Will-Change: Transformer ou autre chose, alors vous pourriez faire pire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cr√©ez moins de couches - exactement autant que n√©cessaire pour l'optimisation actuelle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
G√©nial, nous avons tous analys√©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et si je reviens?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et si je reviens √† la page? Ce n'est que la premi√®re fois que j'y vais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En revenant √† la page, il me semble que je peux tout t√©l√©charger instantan√©ment. J'ai d√©j√† t√©l√©charg√© toutes les ressources, pourquoi ne pas les utiliser une deuxi√®me fois? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/di/1l/8vdi1lapv3i9ka0lb-swsysnhms.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le serveur ne donne pas l'en-t√™te Cache-Control, le navigateur tentera de mettre en cache votre fichier afin de le r√©utiliser. Vous pouvez configurer votre serveur par d√©faut, par exemple: "mettre ce fichier en cache pendant une ann√©e enti√®re". Ne changera pas. Mais si c'est le cas, vous devez traiter le probl√®me d'invalidation du cache global. Mais c'est le sujet d'un rapport s√©par√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilisez des travailleurs de service! 2020, c'est le moment, Progressive Web Applications! Kirill Chugainov avait un bon </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapport</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur la fa√ßon dont les travailleurs des services peuvent √™tre utilis√©s pour diff√©rentes occasions. Dans ce cas, vous interceptez la demande CSS, l'enregistrez et si le navigateur suit ce style pour la deuxi√®me fois, donnez-la loin du cache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le navigateur ne vous promet rien. Vous pouvez toujours faire face au fait que le navigateur est √† court de m√©moire. Il va essayer de mettre en cache, mais il n'y a pas de m√©moire. La mise en cache n'est pas √† cent pour cent. G√©rez toujours de telles situations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez essayer d'utiliser le stockage local. Mais il est extr√™mement lent. Le t√©l√©chargement d'un fichier est parfois plus rapide que l'acc√®s √† l'API de stockage local. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez essayer la base de donn√©es du navigateur int√©gr√©e. Mais mesurez-le. Peut-√™tre qu'un voyage vers JS vous prendra plus de temps en raison d'un processeur faible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement informer le navigateur √† l'avance que vous allez t√©l√©charger quelque chose.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7a/_f/oq/7a_foqb9hzh_ycjaddhrkarqhia.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;link rel&gt; - d√©couvrez comment fonctionne cet attribut. Il y a preconnect, prefetch, prerender - je veux en parler s√©par√©ment. Il dit: ¬´Je suis sur cette page maintenant, puis je passerai √† la suivante. T√©l√©chargez tout pour cette page dans l'onglet arri√®re-plan et dessinez. ¬ª Truc cool. Ne fonctionne nulle part. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iy/ca/ql/iycaqlaidexf0urgnjv05zpjskg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un sens, il est pris en charge dans IE et Edge. Dans Chrome, il ne fait pas vraiment √ßa, il ne rend pas. Cela fonctionne comme la pr√©lecture: t√©l√©charge ces fichiers et caches. Malheureusement, un pr√©rendeur √† part enti√®re ne fonctionne nulle part. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais vous pouvez d√©velopper cette id√©e. Par exemple, dans l'application Yandex - naturellement, sans utiliser CSS - une pr√©-rendu est faite. Lorsque vous cherchez quelque chose, il est probable que vous puissiez obtenir vos r√©sultats instantan√©ment. Nous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pouvons</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pr√©dire o√π vous irez, et √† l'avance par nos propres m√©thodes aller chercher toutes les ressources n√©cessaires.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et apr√®s? </font><font style="vertical-align: inherit;">Il y avait beaucoup de liens. </font><font style="vertical-align: inherit;">Je vous conseille √©galement de regarder une incroyable </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection d'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> optimisation de tout de Vanya Akulov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iamakulov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">D√©couvrez comment optimiser HTML, JS et l'assemblage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et n'oubliez pas de ranger. </font><font style="vertical-align: inherit;">Maintenant, mes conseils fonctionnent vraiment, sugg√©rant comment le faire rapidement, mais tr√®s probablement, apr√®s cinq ans, ils seront m√™me nocifs. </font><font style="vertical-align: inherit;">Il y aura une sorte de technologie qui leur sera incompatible. </font><font style="vertical-align: inherit;">Gardez une trace de cela et essayez de garder votre code optimal, y compris apr√®s un certain temps. </font><font style="vertical-align: inherit;">Merci pour l'attention.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501988/index.html">Comment s'affiche l'√©cran de message VK?</a></li>
<li><a href="../fr501990/index.html">Poste utile: 4 √©v√©nements pour r√©soudre les probl√®mes de la deuxi√®me journ√©e dans OpenShift et cr√©er des op√©rateurs</a></li>
<li><a href="../fr501992/index.html">Comment organiser les tests afin d'acc√©l√©rer et de stabiliser les versions des produits. Partie 1</a></li>
<li><a href="../fr501994/index.html">Orchestrator pour MySQL: pourquoi un projet √† s√©curit√© int√©gr√©e ne peut pas √™tre construit sans lui</a></li>
<li><a href="../fr501996/index.html">Zen Go (Pocket Version)</a></li>
<li><a href="../fr502000/index.html">12 cours en ligne d'ing√©nierie des donn√©es</a></li>
<li><a href="../fr502004/index.html">M√©thode Kanban: comprendre votre processus en tant que processus de renforcement des connaissances collectives - Partie 1 (recettes)</a></li>
<li><a href="../fr502008/index.html">Programmation aux masses</a></li>
<li><a href="../fr502028/index.html">Vanya va √† grand-m√®re ou adaptative JavaScript dynamique</a></li>
<li><a href="../fr502030/index.html">Services Web dans Oracle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>