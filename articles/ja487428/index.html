<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏼 💌 🙁 Yandex.Musicボットクライアントの内部 🔡 🐑 📨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前書き
 こんにちは、ハブル！繰り返しますが、私はYandex.Music APIに影響を与える2番目の記事を書いています。ケースは計画され、最初の記事で言及されています。
 
 手を伸ばして完了。今日、私は自分の音楽の本格的なクライアントとしての地位を占めるテレグラムボットのコードベースに存在する...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Yandex.Musicボットクライアントの内部</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487428/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
こんにちは、ハブル！</font><font style="vertical-align: inherit;">繰り返しますが、私はYandex.Music APIに影響を与える2番目の記事を書いています。</font><font style="vertical-align: inherit;">ケースは計画され、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の記事で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">言及されてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手を伸ばして完了。</font><font style="vertical-align: inherit;">今日、私は自分の音楽の本格的なクライアントとしての地位を占めるテレグラムボットのコードベースに存在する興味深い瞬間について話します。</font><font style="vertical-align: inherit;">Yandex音楽認識APIについても触れます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特定のものの実装のポイントバイポイントの話に進む前に、ボット自体とその機能的な機能についてのアイデアを持つことは価値があります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントビデオデモ</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/YOw9hs8tFg0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本編では、以下について説明します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubページ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のサイトからアカウントにサインインします</font><font style="vertical-align: inherit;">（理由と理由）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ形式、そのパッケージ化、およびボタンデータでの使用。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルーティング、データのバージョン管理、ハンドラーへのコンテキストのスローを更新します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービス：</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegramのサービスリロードトラック。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロードのステータスを送信してトラックを受け取る「サブスクリプション」のサービス。</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最もシンプルで最もエレガントなクエリキャッシング実装。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボイスメッセージによるトラックの認識と、ボットでのトラックの一般的な表示方法。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小さなメモ。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたが少なくとも1つの点に興味があるなら-猫へようこそ。</font></font><br>
<img src="https://habrastorage.org/webt/uv/4s/a3/uv4sa3pslohuzlmuzrjzteju2dk.png"><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボットは自分のアカウントにログインしたユーザーと連携しますが、ログインしていません。</font><font style="vertical-align: inherit;">すべては、アルバム、アーティスト、プレイリスト、トラックという4つの主要なサービスクラスを中心に展開されます。</font><font style="vertical-align: inherit;">すべてのエンティティデータがサポートされており、ページ選択でページ分割が行われます。</font><font style="vertical-align: inherit;">それらと対話するために、承認されたユーザーは、スマートプレイリスト、「好き」プレイリスト、および自分のプレイリストを含む個人メニューを使用できます。</font><font style="vertical-align: inherit;">権限のないユーザーは検索を利用できます-通常のメッセージとして検索クエリを送信します。</font><font style="vertical-align: inherit;">これで、他に何があるかについてのドライリストがあります。直接リンクを介してトラックやその他のオブジェクトを受信する、歌詞を受信する、トラックとアーティストを高く評価/低く評価する機能、同様のトラックを表示する、音声メッセージでトラックを認識するなどです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主要部分</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.アカウントにログイン</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当初、ボットは認証なしで動作するようには計画されていなかったため、設計中であっても</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Webサイト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を通じて認証を行う方法を決定し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ました</font></a><font style="vertical-align: inherit;">。主な議論は安全性と透明性でした。明確なメッセージでユーザーのログインとパスワードを受け入れたくないケースはありません。また、ユーザーのコンピュータからの認証は初歩的なものです。したがって、サイトは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">での承認のために作成されました</font><font style="vertical-align: inherit;">。これは、ボットにリダイレクトする承認の形式です。 captchaの承認と処理に関する部分は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のライブラリから取得され、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で書き直されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
承認には、受信したOAuthトークンが使用され、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ディープリンクを</font></a><font style="vertical-align: inherit;">介してボットに転送されます</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リダイレクトの最終リンクは次のよう</font><font style="vertical-align: inherit;">
になり</font><font style="vertical-align: inherit;">ます</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。t.me</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font><i><font style="vertical-align: inherit;">music_yandex_bot?start={oauth_token}</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最高のものが欲しかったのですが、ユーザーは信頼していませんでした。 10人ごとのユーザーのみが承認されました（必須であったとき）。したがって、以下の更新で、なぜ信頼すべきなのかを説明する必要がありました。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関するすべての項目</font><font style="vertical-align: inherit;">、クライアント側からのリクエストと</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オープンソースコード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のみに関するものは、承認のためにサイトに公開され、ボットのウェルカムメッセージに複製されました。よくなった。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、権限が低い要因の1つとして、ロシアのt.meのミラーにアクセスできないのは、サブスクリプションを持つユーザーのみに対するサポートであることがわかりました（これについては、ノートの7項で詳しく説明します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の項目は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URI</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tg：//</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を使用して解決さ</font><font style="vertical-align: inherit;">れ、ピンチではすでにミラーへのリンクがあり（自動リダイレクトが機能せず、ボタンが役に立たなかった場合）、2番目の項目も項目7にあります。</font></font><br>
<img src="https://habrastorage.org/webt/ez/2_/0j/ez2_0japfosbu9k4bjelikl8x-i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.データ形式</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このボットでは、初めて</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NoSQL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DB- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDB</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用することにしました</font><font style="vertical-align: inherit;">。理解：</font><font style="vertical-align: inherit;">ドキュメントを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">埋め込む</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とき、</font><i><font style="vertical-align: inherit;">埋め込ま</font></i><font style="vertical-align: inherit;">ないとき。 mongoengineでの作業が好きです。しかし、実際にはすべてのボタンデータを自宅に保存する必要はなく、クライアント</font><font style="vertical-align: inherit;">はデータベースにレコード</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しか持っていません</font><font style="vertical-align: inherit;">。私はデータ量に恐怖を感じましたが、データストレージ用に512 MBの制限がある無料のMongoサーバーを使いたかったのです。複数のボタンでデータが一致する場合にレコードを美しく再利用し、古いものをクリーンアップすることは、ボタン自体にすべてを保存するよりもはるかに困難です。保存するデータのサイズを分析したところ、簡単に収まると結論付けました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初は、</font><i><font style="vertical-align: inherit;">JSONを</font></i><font style="vertical-align: inherit;">使用しました</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が、限界に達したとき、彼はすぐにそれを拒否しました。 Telegramでは、ボタンデータの内容は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UTF-8では</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 64バイト以下にする必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、友人のプロンプトで、私</font><font style="vertical-align: inherit;">は</font><i><font style="vertical-align: inherit;">struct</font></i><font style="vertical-align: inherit;"> moduleから</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pack</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">調べ始めました</font><font style="vertical-align: inherit;">。したがって、クエリのタイプ、つまりプリミティブフォーマット、パッケージ化、およびアンパックが生まれました。今では、ボットで絶対にどこでも使用されています。</font><font style="vertical-align: inherit;">
形式は非常に簡単です。最初のバイトはタイプ、2番目のバイトはバージョンです。その他はすべて、特定のタイプのデータです。タイプはEnumとして保存され</font><font style="vertical-align: inherit;">、最初のバイトで</font><font style="vertical-align: inherit;">ある</font><i><font style="vertical-align: inherit;">IDを</font></i><font style="vertical-align: inherit;">持ち</font><font style="vertical-align: inherit;">ます。</font><i><font style="vertical-align: inherit;">ID</font></i><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">加えて</font><font style="vertical-align: inherit;">、各タイプにはデータをパックおよびアンパックするためのフォーマットがあります。例：</font><i><font style="vertical-align: inherit;">SHOW_TRACK_MENUと</font></i><font style="vertical-align: inherit;">入力し</font><i><font style="vertical-align: inherit;">ます</font></i></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その形式の値は「s？」で、「s」はトラックの一意の識別子、「？」 -トラックにテキストがありますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
文字列型用いるトラックであるため：最初に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トラックのは、連結することができる</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アルバム</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結腸を通るトラックの、及び第二に、それがあってもよい</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付きのトラック</font><font style="vertical-align: inherit;">-自己ロードされたトラック。それらをダウンロードしたユーザーのみが利用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、データは必ずしもフォーマットに対応しているとは限らないため、同じ</font><font style="vertical-align: inherit;">トラック</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を数値で単純に表すことができるため、パッキングする前に、フォーマットのタイプにキャストする必要があります。この場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">したがって、クラスには、コンストラクターに渡すときに自分で行わないように、転送されたデータをパッケージ化のために正規化するメソッドがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
文字列は自己完結型であり、パッケージ化するときに文字列の長さを示し、アンパックするときにこの長さを考慮に入れることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古いバージョンのサポートは計画されていなかったため、バージョンが一致しない場合は例外がスローされます。</font><font style="vertical-align: inherit;">次の段落で説明する更新を処理するときに、必要なロジックが呼び出されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Telegramは専ら</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UTF-8を使用する</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため、パックされたデータは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base85</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でエンコードされ</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">はい、私はここで速度を失い、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base64</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用せずに最小サイズを保存してい</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">が、小さいデータを考えると、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base85の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用を</font><font style="vertical-align: inherit;">適切</font><font style="vertical-align: inherit;">に検討し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース。</font><font style="vertical-align: inherit;">ファイルcallback_data.py</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> struct
<span class="hljs-keyword">import</span> base64<font></font>
<font></font>
<span class="hljs-keyword">from</span> ext.query_types <span class="hljs-keyword">import</span> QueryType<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BadDataVersion</span>(<span class="hljs-params">Exception</span>):</span>
    <span class="hljs-keyword">pass</span><font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CallbackData</span>:</span>
    ACTUAL_VERSION = <span class="hljs-number">7</span>
    BASE_FORMAT = <span class="hljs-string">'&lt;BB'</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, type_: QueryType, data=None, version=None</span>):</span><font></font>
        self.type = type_<font></font>
        self.version = version <span class="hljs-keyword">or</span> CallbackData.ACTUAL_VERSION<font></font>
        self.data = data<font></font>
<font></font>
        <span class="hljs-keyword">if</span> self.data <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> isinstance(self.data, list):<font></font>
            self.data = [self.data]<font></font>
<font></font>
        <span class="hljs-keyword">if</span> self.data <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            self.data = self._normalize_data_to_format(self.data)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f'&lt;CallbackData&gt; Type: <span class="hljs-subst">{self.type}</span> Version: <span class="hljs-subst">{self.version}</span> Data: <span class="hljs-subst">{self.data}</span>'</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_normalize_data_to_format</span>(<span class="hljs-params">self, data, bytes_object=False</span>):</span><font></font>
        normalized_data = data.copy()<font></font>
        <span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> enumerate(self.type.format):<font></font>
            cast = str<font></font>
            <span class="hljs-keyword">if</span> c.lower() <span class="hljs-keyword">in</span> <span class="hljs-string">'bhilqn'</span>:<font></font>
                cast = int<font></font>
            <span class="hljs-keyword">elif</span> c <span class="hljs-keyword">in</span> <span class="hljs-string">'efd'</span>:<font></font>
                cast = float<font></font>
            <span class="hljs-keyword">elif</span> c == <span class="hljs-string">'?'</span>:<font></font>
                cast = bool<font></font>
<font></font>
            casted = cast(data[i])<font></font>
            <span class="hljs-keyword">if</span> bytes_object <span class="hljs-keyword">and</span> cast == str:<font></font>
                casted = casted.encode(<span class="hljs-string">'utf-8'</span>)<font></font>
            normalized_data[i] = casted<font></font>
<font></font>
        <span class="hljs-keyword">return</span> normalized_data<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode_type</span>(<span class="hljs-params">callback_data</span>):</span>
        decoded = base64.b85decode(callback_data.encode(<span class="hljs-string">'utf-8'</span>))<font></font>
        type_, version = struct.unpack(CallbackData.BASE_FORMAT, decoded[:<span class="hljs-number">2</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> CallbackData.ACTUAL_VERSION != version:
            <span class="hljs-keyword">raise</span> BadDataVersion()<font></font>
<font></font>
        <span class="hljs-keyword">return</span> QueryType(type_), version, decoded<font></font>
<font></font>
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode</span>(<span class="hljs-params">cls, type_, version, decoded</span>):</span>
        start, data = <span class="hljs-number">2</span>, []<font></font>
<font></font>
        <span class="hljs-keyword">if</span> start &lt; len(decoded):<font></font>
            format_iter = iter(type_.format)<font></font>
<font></font>
            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
                <span class="hljs-keyword">if</span> start &gt;= len(decoded):
                    <span class="hljs-keyword">break</span><font></font>
<font></font>
                format_ = next(format_iter, type_.format[<span class="hljs-number">-1</span>])<font></font>
<font></font>
                decode_str = format_ <span class="hljs-keyword">in</span> <span class="hljs-string">'ps'</span>
                <span class="hljs-keyword">if</span> decode_str:
                    <span class="hljs-comment"># struct.calcsize('b') = 1</span>
                    length = list(struct.unpack(<span class="hljs-string">'b'</span>, decoded[start: start + <span class="hljs-number">1</span>]))[<span class="hljs-number">0</span>]<font></font>
                    start += <span class="hljs-number">1</span><font></font>
<font></font>
                    format_ = <span class="hljs-string">f'<span class="hljs-subst">{length}</span><span class="hljs-subst">{format_}</span>'</span><font></font>
<font></font>
                step = struct.calcsize(format_)<font></font>
<font></font>
                unpacked = list(struct.unpack(<span class="hljs-string">f'<span class="hljs-subst">{format_}</span>'</span>, decoded[start: start + step]))
                <span class="hljs-keyword">if</span> decode_str:<font></font>
                    unpacked[<span class="hljs-number">0</span>] = unpacked[<span class="hljs-number">0</span>].decode(<span class="hljs-string">'UTF-8'</span>)<font></font>
<font></font>
                data += unpacked<font></font>
                start += step<font></font>
<font></font>
        <span class="hljs-keyword">return</span> cls(type_, data <span class="hljs-keyword">if</span> data <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>, version)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encode</span>(<span class="hljs-params">self</span>):</span><font></font>
        encode = struct.pack(self.BASE_FORMAT, self.type.value, self.version)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> self.data <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            format_iter = iter(self.type.format)<font></font>
            normalized_data = self._normalize_data_to_format(self.data, bytes_object=<span class="hljs-literal">True</span>)<font></font>
<font></font>
            <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> normalized_data:<font></font>
                format_ = next(format_iter, self.type.format[<span class="hljs-number">-1</span>])<font></font>
<font></font>
                <span class="hljs-keyword">if</span> format_ <span class="hljs-keyword">in</span> <span class="hljs-string">'ps'</span>:
                    <span class="hljs-comment">#        .  'b'  </span>
                    <span class="hljs-comment"># -      ,    &gt; 36 </span>
                    encode += struct.pack(<span class="hljs-string">'b'</span>, len(data))<font></font>
                    encode += struct.pack(<span class="hljs-string">f'<span class="hljs-subst">{len(data)}</span><span class="hljs-subst">{format_}</span>'</span>, data)
                <span class="hljs-keyword">else</span>:<font></font>
                    encode += struct.pack(<span class="hljs-string">f'<span class="hljs-subst">{format_}</span>'</span>, data)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> base64.b85encode(encode).decode(<span class="hljs-string">'utf-8'</span>)<font></font>
<font></font>
</code></pre><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.ルーティングの更新とコンテキスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトでは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">python-telegram-bot</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリ</font><font style="vertical-align: inherit;">を使用して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram Bot APIを操作します</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">到着した特定のタイプの更新のハンドラー、正規表現のフィルター、コマンドなどを登録するためのシステムがすでにあります。</font><font style="vertical-align: inherit;">しかし、自分のデータ形式と型を考えると、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TelegramHandler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を継承し</font><font style="vertical-align: inherit;">て</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実装</font><font style="vertical-align: inherit;">する必要がありました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更新とコンテキストは、引数を介して各ハンドラーに渡されます。</font><font style="vertical-align: inherit;">この場合、私には自分のコンテキストがあり、それは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler'eにあります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">承認ステータスとサブスクリプションの可用性に応じて、ユーザーの受信とデータベースへの追加、またはトークンへの関連性の確認による音楽へのアクセスの確認、Yandex.Musicクライアントの初期化です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler'a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からさらに離れた</font><i><font style="vertical-align: inherit;">ところに</font></i><font style="vertical-align: inherit;">、たとえば</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CallbackQueryHandler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などのより具体的なハンドラー</font><i><font style="vertical-align: inherit;">があり</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。これを使用すると、ハンドラーは特定のタイプの更新（私のタイプ、データ形式）に対して登録されます。この更新が現在のハンドラに適しているかどうかを確認するには、すべてのデータが解凍されるのではなく、最初の2バイトのみが解凍されます。この段階で、コールバックを起動する必要性が確認されます。コールバックの起動が必要な場合のみ-データは完全に解凍され、</font><i><font style="vertical-align: inherit;">kwargs</font></i><font style="vertical-align: inherit;">として転送され</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終ハンドラに。</font><font style="vertical-align: inherit;">すぐに、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ChatBase</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に分析データが送信され</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
登録は順番に行われ、（実際には</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルーティングや他のプロジェクトのように）</font><font style="vertical-align: inherit;">誰が先に登録されるかが優先され</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">したがって、廃止バージョンのハンドラーの登録は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CallBackQuery</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハンドラーの中で最初のもの</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古いバージョンを処理するロジックは単純です-可能であれば、これについてユーザーに通知し、更新されたデータを送信します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.サービス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットが1つのコントロールクラスで起動されると、すべてのサービスが初期化されます。これは、ボット（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DJ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">内のどこでも普遍的に使用されます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各サービスには、</font><font style="vertical-align: inherit;">タスクの送信先となる特定の数のワーカーを持つ</font><font style="vertical-align: inherit;">独自の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadPoolExecutor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegramでトラックをリロードする</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現時点では、このサービスは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーBot</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">書き直されておらず</font><font style="vertical-align: inherit;">、Telegramでダウンロードしたファイルのサイズの制限を回避</font><font style="vertical-align: inherit;">していません</font><font style="vertical-align: inherit;">。結局のところ、Yandex.Musicには50 mbより大きいファイルがあります-ポッドキャスト。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サービスはファイルサイズをチェックし、超過した場合はユーザーにアラートをスローします。パラグラフ5で説明したキャッシングシステムのおかげで、これは歌詞の可用性と受信をチェックします。トラックもキャッシュされます。ファイルのハッシュはデータベースに保存されます。存在する場合、既知のキャッシュを持つオーディオが送信されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースにファイルがない場合、Yandex.Musicから直接リンクを受け取ります。現時点では、ユーザーは品質設定を変更することはできませんが、すべて標準値に設定されています。ファイルは、ユーザー設定からビットレートとコーデックによって検索されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルとそのカバーは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tempfile.TemporaryFile（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">としてダウンロードされ</font><font style="vertical-align: inherit;">、その後Telegramにアップロードされます。</font><font style="vertical-align: inherit;">TGが常にトラックの長さを正しく認識するとは限らないことは注目に値しますが、私は一般的にアーティストとタイトルについては黙っています。</font><font style="vertical-align: inherit;">したがって、これらのデータはYandexから取得されます。幸い、カートに送信することができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサービスによってオーディオファイルが送信されると</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">finished_callback（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が呼び出され</font><font style="vertical-align: inherit;">、ダウンロードの終了についてサブスクリプションによってサービスに通知されます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トラックを受信して​​ダウンロードステータスを送信するためのサブスクリプションサービス</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トラックはすぐには読み込まれません。複数のユーザーが同じトラックをリクエストした可能性があります。この場合、最初にトラックを要求したユーザーがトラックの開始者と所有者になります。 1秒以上リロードすると、「ユーザーがボイスメッセージを送信します」というダウンロードステータスが始まります。同じトラックをリクエストした他のユーザーは定期購読者です。所有者と同様に、メッセージが中断されないように（ステータスは5秒間ハングします）、所有者と同様に、ダウンロードステータスが4秒ごとに送信されます。所有者のトラックのダウンロードが完了するとすぐに、</font><font style="vertical-align: inherit;">上のサービスから</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">finished_callback（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が呼び出さ</font><font style="vertical-align: inherit;">れます。その後、すべてのサブスクライバーがステータスリストから削除され、ダウンロードされたトラックを受け取ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
建築ソリューションでは、トラックの所有者もサブスクライバーですが、トラックの送信方法が異なるため、特定のマークが付いています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.クエリのキャッシュ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前回の記事で思い出したように、Yandex.Music APIへのリクエストは非常に重いです。トラックのリストは3または5 mbです。しかもリクエストが多いだけです。各更新処理で、クライアントの初期化と特定のアクションのために、少なくとも2つのリクエストがYandexに送信されます。一部の場所では、十分な情報（たとえば、プレイリスト）を収集するために、プレイリスト、そのトラックの受信、ランディングページからの情報（これがスマートプレイリストの場合）のリクエストを行う必要があり、クライアントの初期化を忘れないでください。一般的に、要求の数の面で静かな恐怖。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は非常に普遍的な何かを望んでおり、特定のオブジェクト、同じクライアントのためのストレージの種類を作りませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリを使用すると、</font><i><font style="vertical-align: inherit;">リクエストに加えて</font></i><font style="vertical-align: inherit;">、クエリを実行するための独自のインスタンスを指定できます</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それから私はこれを利用しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポイントは簡単です。キャッシュクラス自体はシングルトンです。キャッシュの存続期間、サイズの2つのパラメーターしかありません。リクエストが実行されると、ラッパーが呼び出されます。彼は上書きされます。キャッシュのチェックは、フリーズされた引数とクォートのハッシュによって行われます。キャッシュに追加する時間があります。データの更新の必要性を確認するとき</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">LimitedSizeDict</font></i><font style="vertical-align: inherit;">からデータを</font><i><font style="vertical-align: inherit;">取得する</font></i><font style="vertical-align: inherit;">か、実際のリクエストを行ってキャッシュに追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
好き/嫌いの設定など、一部のリクエストはキャッシュできません。ユーザーが「いいね」、「嫌い」、「いいね」というシーケンスを押すと、最終的には「いいね」は配信されません。このような場合、リクエストを送信するときは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use_cache</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引数</font><font style="vertical-align: inherit;">を</font><i><font style="vertical-align: inherit;">Falseに</font></i><font style="vertical-align: inherit;">等しい値で</font><font style="vertical-align: inherit;">渡す必要があります</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">実際には、キャッシュが使用されない唯一の場所です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このおかげで、私は最も大胆なリクエストを作成して、それらがキャッシュされるようにします。</font><font style="vertical-align: inherit;">私はそれを小さなものに分解しようとしているのではなく、現在のページにのみ必要です。</font><font style="vertical-align: inherit;">私はすべてを一度に取り、ページを切り替えるとき、（以前のアプローチと比較して）切り替え速度が非常に速くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私については、キャッシュされたリクエストクラスは美しく、単純に統合されました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> copy
<span class="hljs-keyword">import</span> time<font></font>
<font></font>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Union
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> OrderedDict<font></font>
<font></font>
<span class="hljs-keyword">import</span> requests<font></font>
<font></font>
<span class="hljs-keyword">from</span> yandex_music.utils.request <span class="hljs-keyword">import</span> Request <span class="hljs-keyword">as</span> YandexMusicRequest<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LimitedSizeDict</span>(<span class="hljs-params">OrderedDict</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span>
        self.size_limit = kwargs.pop(<span class="hljs-string">"size_limit"</span>, <span class="hljs-literal">None</span>)<font></font>
        OrderedDict.__init__(self, *args, **kwargs)<font></font>
        self._check_size_limit()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__setitem__</span>(<span class="hljs-params">self, key, value</span>):</span><font></font>
        OrderedDict.__setitem__(self, key, value)<font></font>
        self._check_size_limit()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_check_size_limit</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">if</span> self.size_limit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">while</span> len(self) &gt; self.size_limit:<font></font>
                self.popitem(last=<span class="hljs-literal">False</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CachedItem</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, response: requests.Response</span>):</span><font></font>
        self.timestamp = time.time()<font></font>
        self.response = response<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cache</span>:</span>
    __singleton: <span class="hljs-string">'Cache'</span> = <span class="hljs-literal">None</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, lifetime: Union[str, int], size: Union[str, int]</span>):</span><font></font>
        Cache.__singleton = self<font></font>
<font></font>
        self.lifetime = int(lifetime) * <span class="hljs-number">60</span><font></font>
        self.size = int(size)<font></font>
<font></font>
        self.storage: LimitedSizeDict = LimitedSizeDict(size_limit=int(size))<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span><font></font>
        hash_ = Cache.get_hash(*args, **kwargs)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> self.storage[hash_].response<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, response: requests.Response, *args, **kwargs</span>):</span><font></font>
        hash_ = Cache.get_hash(*args, **kwargs)<font></font>
        self.storage.update({hash_: CachedItem(response)})<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">need_to_fetch</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span><font></font>
        hash_ = Cache.get_hash(*args, **kwargs)<font></font>
        cached_item = self.storage.get(hash_)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cached_item:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
        <span class="hljs-keyword">if</span> time.time() - cached_item.timestamp &gt; self.lifetime:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_instance</span>(<span class="hljs-params">cls</span>) -&gt; 'Cache':</span>
        <span class="hljs-keyword">if</span> cls.__singleton <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">return</span> cls.__singleton
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">f'<span class="hljs-subst">{cls.__name__}</span> not initialized'</span>)<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">freeze_dict</span>(<span class="hljs-params">d: dict</span>) -&gt; Union[frozenset, tuple, dict]:</span>
        <span class="hljs-keyword">if</span> isinstance(d, dict):
            <span class="hljs-keyword">return</span> frozenset((key, Cache.freeze_dict(value)) <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> d.items())
        <span class="hljs-keyword">elif</span> isinstance(d, list):
            <span class="hljs-keyword">return</span> tuple(Cache.freeze_dict(value) <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> d)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> d<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params">*args, **kwargs</span>):</span>
        <span class="hljs-keyword">return</span> hash((args, Cache.freeze_dict(kwargs)))<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Request</span>(<span class="hljs-params">YandexMusicRequest</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_request_wrapper</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span>
        use_cache = kwargs.get(<span class="hljs-string">'use_cache'</span>, <span class="hljs-literal">True</span>)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> <span class="hljs-string">'use_cache'</span> <span class="hljs-keyword">in</span> kwargs:<font></font>
            kwargs.pop(<span class="hljs-string">'use_cache'</span>)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> use_cache:<font></font>
            response = super()._request_wrapper(*args, **copy.deepcopy(kwargs))<font></font>
        <span class="hljs-keyword">elif</span> use_cache <span class="hljs-keyword">and</span> Cache.get_instance().need_to_fetch(*args, **kwargs):<font></font>
            response = super()._request_wrapper(*args, **copy.deepcopy(kwargs))<font></font>
            Cache.get_instance().update(response, *args, **kwargs)<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            response = Cache.get_instance().get(*args, **kwargs)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> response<font></font>
<font></font>
</code></pre><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.音声メッセージによる認識の追跡</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当初、これをボットに追加することは考えられていませんでしたが、興味深い状況が発生しました。ボットにはチャットがあります（ボットの説明に示されています）。しばらくして、私は人々がそれに入り、音楽付きのボイスメッセージを送信することに気づきました。最初は、誰かがボットして冗談を言っているような新しい種類のスパムだと思っていました。しかし、そのような人がすでに10人いて、誰もが同じことをしているとき、私の友人（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">struct</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって提案されたものと同じもの</font><font style="vertical-align: inherit;">）は、ユーザーがYandexの公式の音楽認識ボットを見越して検索にYandex.Musicを運転することを提案しました、彼らはそこでチャットルームを見て、それに真剣にボイスメッセージを送ります！それは単に華麗で真の仮定でした。それから私は冗談めかして、認識をしてチャットにボットを追加する時が来たと言いました。楽しみのために...しばらくして、これは行われました！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について説明し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。最近、YandexはWebソケットの使用を増やしています。 i.moduleとi.stationの管理におけるそれらの使用法に出会いました。音楽認識サービスも動作します。ボットに最小限の実用的なソリューションを投入しましたが、ライブラリに実装を追加しませんでした。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は次のアドレスにあります：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wss：//voiceservices.yandex.net/uni.ws</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
必要なメッセージは、承認と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">認識の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求の2つだけ</font><font style="vertical-align: inherit;">です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex自体は、その公式アプリケーションでは、短いファイルを1〜3秒で送信します。それに応じて、より多くのデータまたは結果を送信する必要性-見つかったかどうかを取得できます。結果が見つかった場合、トラックIDが返されます。</font><i><font style="vertical-align: inherit;">.OGG</font></i><font style="vertical-align: inherit;">ファイルがされて</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
送信され</font><font style="vertical-align: inherit;">て</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ENCODER = SpeechKit Mobile SDK v3.28.0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">他のエンコーダーでどのように機能するかは確認しませんでした。テレグラムで記録されたファイルで変更するだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webソケットを使用してリバースすると、マジックが発生する場合がありました。</font><font style="vertical-align: inherit;">トラックが見つからないこともありますが、認識リクエストでメッセージの言語を変更したところ、わかりました。</font><font style="vertical-align: inherit;">または、最初はそれが見つかり、それから停止しましたが、ファイルは同じです。</font><font style="vertical-align: inherit;">トラックの言語は</font><font style="vertical-align: inherit;">クライアントの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SpeechKit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって設定されると</font><i><font style="vertical-align: inherit;">思い</font></i><font style="vertical-align: inherit;">ました。</font><font style="vertical-align: inherit;">自分でやる機会がなかったので、力ずくで捜索。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テレグラムからの音声メッセージによる音声認識のひざまずいた実装</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> uuid<font></font>
<font></font>
<span class="hljs-keyword">import</span> lomond<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_auth_data</span>():</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"event"</span>: {
            <span class="hljs-string">"header"</span>: {
                <span class="hljs-string">"messageId"</span>: str(uuid.uuid4()),
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"SynchronizeState"</span>,
                <span class="hljs-string">"namespace"</span>: <span class="hljs-string">"System"</span><font></font>
            },<font></font>
            <span class="hljs-string">"payload"</span>: {
                <span class="hljs-string">"accept_invalid_auth"</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">"auth_token"</span>: <span class="hljs-string">"5983ba91-339e-443c-8452-390fe7d9d308"</span>,
                <span class="hljs-string">"uuid"</span>: str(uuid.uuid4()).replace(<span class="hljs-string">'-'</span>, <span class="hljs-string">''</span>),<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_asr_data</span>():</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"event"</span>: {
            <span class="hljs-string">"header"</span>: {
                <span class="hljs-string">"messageId"</span>: str(uuid.uuid4()),
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"Recognize"</span>,
                <span class="hljs-string">"namespace"</span>: <span class="hljs-string">"ASR"</span>,
                <span class="hljs-string">"streamId"</span>: <span class="hljs-number">1</span><font></font>
            },<font></font>
            <span class="hljs-string">"payload"</span>: {
                <span class="hljs-string">"advancedASROptions"</span>: {
                    <span class="hljs-string">"manual_punctuation"</span>: <span class="hljs-literal">False</span>,
                    <span class="hljs-string">"partial_results"</span>: <span class="hljs-literal">False</span><font></font>
                },<font></font>
                <span class="hljs-string">"disableAntimatNormalizer"</span>: <span class="hljs-literal">False</span>,
                <span class="hljs-string">"format"</span>: <span class="hljs-string">"audio/opus"</span>,
                <span class="hljs-string">"music_request2"</span>: {
                    <span class="hljs-string">"headers"</span>: {
                        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"audio/opus"</span><font></font>
                    }<font></font>
                },<font></font>
                <span class="hljs-string">"punctuation"</span>: <span class="hljs-literal">False</span>,
                <span class="hljs-string">"tags"</span>: <span class="hljs-string">"PASS_AUDIO;"</span>,
                <span class="hljs-string">"topic"</span>: <span class="hljs-string">"queries"</span><font></font>
            }<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Recognition</span>:</span>
    URI = <span class="hljs-string">'wss://voiceservices.yandex.net/uni.ws'</span>
    LANGS = [<span class="hljs-string">''</span>, <span class="hljs-string">'ru-RU'</span>, <span class="hljs-string">'en-US'</span>]<font></font>
    POLL_DELAY = <span class="hljs-number">0.3</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, binary_data, status_msg</span>):</span><font></font>
        self.status_msg = status_msg<font></font>
        self.websocket = lomond.WebSocket(self.URI)<font></font>
        self.chunks = self.get_chunks_and_replace_encoder(binary_data)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_track_id</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">for</span> lang <span class="hljs-keyword">in</span> Recognition.LANGS:<font></font>
            asr_data = get_asr_data()<font></font>
            <span class="hljs-keyword">if</span> lang:<font></font>
                asr_data[<span class="hljs-string">'event'</span>][<span class="hljs-string">'payload'</span>].update({<span class="hljs-string">'lang'</span>: lang})<font></font>
                self.status_msg.edit_text(<span class="hljs-string">f'     <span class="hljs-subst">{lang}</span>...'</span>)
            <span class="hljs-keyword">else</span>:<font></font>
                self.status_msg.edit_text(<span class="hljs-string">f'      ...'</span>)<font></font>
<font></font>
            <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> self.websocket.connect(poll=self.POLL_DELAY):
                <span class="hljs-keyword">if</span> msg.name == <span class="hljs-string">'ready'</span>:<font></font>
                    self.websocket.send_json(get_auth_data())<font></font>
                    self.websocket.send_json(asr_data)<font></font>
<font></font>
                    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> self.chunks:<font></font>
                        self.websocket.send_binary(chunk)<font></font>
<font></font>
                <span class="hljs-keyword">if</span> msg.name == <span class="hljs-string">'text'</span>:<font></font>
                    response = msg.json.get(<span class="hljs-string">'directive'</span>)<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> self.is_valid_response(response):<font></font>
                        self.websocket.close()<font></font>
<font></font>
                        <span class="hljs-keyword">return</span> self.parse_track_id(response)
                    <span class="hljs-keyword">elif</span> self.is_fatal_error(response):<font></font>
                        self.websocket.close()<font></font>
<font></font>
                        <span class="hljs-keyword">break</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_valid_response</span>(<span class="hljs-params">self, response</span>):</span>
        <span class="hljs-keyword">if</span> response.get(<span class="hljs-string">'header'</span>, {}).get(<span class="hljs-string">'name'</span>) == <span class="hljs-string">'MusicResult'</span> <span class="hljs-keyword">and</span> \<font></font>
                response.get(<span class="hljs-string">'payload'</span>, {}).get(<span class="hljs-string">'result'</span>) == <span class="hljs-string">'success'</span>:<font></font>
            self.status_msg.edit_text(<span class="hljs-string">f' ,  !'</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_fatal_error</span>(<span class="hljs-params">response</span>):</span>
        <span class="hljs-keyword">if</span> response.get(<span class="hljs-string">'header'</span>, {}).get(<span class="hljs-string">'name'</span>) == <span class="hljs-string">'MusicResult'</span> <span class="hljs-keyword">and</span> \<font></font>
                response.get(<span class="hljs-string">'payload'</span>, {}).get(<span class="hljs-string">'result'</span>) == <span class="hljs-string">'music'</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_track_id</span>(<span class="hljs-params">response</span>):</span>
        <span class="hljs-keyword">return</span> response[<span class="hljs-string">'payload'</span>][<span class="hljs-string">'data'</span>][<span class="hljs-string">'match'</span>][<span class="hljs-string">'id'</span>]<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chunks_and_replace_encoder</span>(<span class="hljs-params">binary_data</span>):</span><font></font>
        chunks = []<font></font>
<font></font>
        <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> binary_data.split(<span class="hljs-string">b'OggS'</span>)[<span class="hljs-number">1</span>:]:
            <span class="hljs-keyword">if</span> <span class="hljs-string">b'OpusTags'</span> <span class="hljs-keyword">in</span> chunk:<font></font>
                pos = chunk.index(<span class="hljs-string">b'OpusTags'</span>) + <span class="hljs-number">12</span><font></font>
                size = len(chunk)<font></font>
                chunk = chunk[:pos] + <span class="hljs-string">b'#\x00\x00\x00\x00ENCODER=SpeechKit Mobile SDK v3.28.0'</span>
                chunk += <span class="hljs-string">b"\x00"</span> * (size - len(chunk))<font></font>
<font></font>
            chunks.append(<span class="hljs-string">b'\x00\x00\x00\x01OggS'</span> + chunk)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> chunks<font></font>
<font></font>
</code></pre><br>
     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>.<br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.小さなメモ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサービスは限られた数の国で（サブスクリプションなしで）使用でき、ボットを搭載したサーバーはヨーロッパにあるため、当初は、サブスクリプションを使用するユーザーのみがボットを使用できました。この問題は、プロキシを使用して、サブスクリプションなしでユーザーからのリクエストを実行することで解決されます。プロキシサーバーはモスクワにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページの選択はありますが、100に制限されています（これ以上ボタンを追加することはできません。電報の制限）。一部の一般的なページリクエストには、さらに多くのページがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex検索では、ページ上の要素の数はハードコードされています。トラック数、プレイリスト数。これは、前面に表示されるデータの量に対応していない場合もあります。ページの変更があり、要素の数が変動しています。したがって、ボット内でもジャンプするため、あまり美しくありません。そして、彼らのページネーターを彼自身のものと組み合わせる-そのようなもの。ページごとに特定の数の要素を要求できる他の場所では、すべてが完璧です。ボットに検索を実装した後の音声メッセージは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t.me/MarshalC/416</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Telegramで音声を転送すると、作成者は失われ、転送を行った人に割り当てられます。したがって、すべてのトラックはボットのユーザー名の署名とともに送信されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリにラジオを実装した後に出会ったすべてのメッセージ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-t.me/MarshalC/422</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（トラックのチェーンについて、フィードバックのヒープ、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batch_id</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を送信してそれを通過します</font><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはTelegramボットに関する別の記事であるという事実にもかかわらず、ここまで読んでいます。おそらく、カットの項目の1つに興味を持っていて、これはすばらしい</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><b><font style="vertical-align: inherit;">どうもありがとうございました</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、ボットのソースコードを完全には開きませんでした（場所によってはリファクタリングが必要になるため）。</font><font style="vertical-align: inherit;">この記事では多くのことを説明しましたが、たとえば、仮想キーボードやその生成などのいくつかの側面は影響を受けません。</font><font style="vertical-align: inherit;">ほとんどの場合、この記事に含まれていないのは私のライブラリを操作するだけで、興味深いことは何もありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが中心となる授業を、今ある形で見せてもらいました。バグがあることは認めますが、すべてが長期間動作します。自分のコードが好きな場所とそうでない場所がありますが、それで問題ありません。認識のためにWSを使用することは、ひざの解決策であることを忘れないでください。コメントで合理的な批判を読む準備ができました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私がライブラリを書き始めたときでもボットは計画されていましたが、私はこの考えを否定しましたが、どうやら私は戻りました（退屈でした）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex.Music Bot- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリを使用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">してプロジェクトで</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">API</font></a><font style="vertical-align: inherit;">を操作することの適切性を証明する</font><font style="vertical-align: inherit;">プロジェクト。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ママ、ヤナ、サナア、グローリーに感謝します。</font><font style="vertical-align: inherit;">間違いを校正する人、ヒントを書く人、この記事がないとこの記事のいくつかのポイントは存在しなかったかもしれません。</font><font style="vertical-align: inherit;">アーサーはpicci、記事はLyod、ロゴは。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今私は研究後の分布に関して深刻な問題を抱えています。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたが私に電話をかける準備ができている場合-履歴書を送る場所を教えてください、インタビューしてください。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">連絡先はすべてプロファイルに含まれています。</font><font style="vertical-align: inherit;">タイミングが燃えています。</font><font style="vertical-align: inherit;">法律によると、私はベラルーシ共和国でしか運動できません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PPS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは3つの2番目の記事でしたが、少しでもアイデアがなければ、このトピックで別のプロジェクトを行う時間と、それが必要かどうかを判断できます。</font><font style="vertical-align: inherit;">私は彼のトピックを公開します-クロスプラットフォームクライアントYandex.Music。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja487418/index.html">SAPとは？</a></li>
<li><a href="../ja487420/index.html">Sound War Z. MusicDealerスピーカーとヘッドフォンのテスト</a></li>
<li><a href="../ja487422/index.html">Salesforce管理者の責任：何をいつ行うべきか</a></li>
<li><a href="../ja487424/index.html">1から100,000ユーザーにスケーリングする方法</a></li>
<li><a href="../ja487426/index.html">柔軟性が成功を決定します。</a></li>
<li><a href="../ja487430/index.html">iOSアプリケーションを作成するにはどのようなスキルが必要ですか？Yandexレポート</a></li>
<li><a href="../ja487432/index.html">DevConfとCfgMgmtCampの足跡をたどって、または2週間に2回の国際会議で講演者に行くことで学べること</a></li>
<li><a href="../ja487438/index.html">この分野での経験とプログラミングスキルなしに、IT会社を一から作成する方法は？</a></li>
<li><a href="../ja487444/index.html">「コーヒーを飲みながら、請求され、支払いのプッシュを受けました」-24時間365日ビジネスを行うことを可能にするイノベーション</a></li>
<li><a href="../ja487446/index.html">会社は「自分の」色を塗ることができますか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>