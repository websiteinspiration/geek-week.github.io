<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎡 🛡️ ⛹🏾 عربة الروبوت 2.0. الجزء 1. التنقل المستقل للروبوت المنزلي على أساس ROS 🦁 🌒 😧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تم بناء المشروع على أساس مشروع آخر معروف جيدًا في دوائره - linorobot (linorobot.org) ، باستخدام المكونات المتاحة للشخص العادي البسيط. الأهداف التي تم ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>عربة الروبوت 2.0. الجزء 1. التنقل المستقل للروبوت المنزلي على أساس ROS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502076/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تم بناء المشروع على أساس مشروع آخر معروف جيدًا في دوائره - linorobot (linorobot.org) ، باستخدام المكونات المتاحة للشخص العادي البسيط. </font><font style="vertical-align: inherit;">الأهداف التي تم تحديدها: لتحقيق حركة مستقلة للروبوت في المنزل باستخدام مكونات منخفضة التكلفة ، وتقييم أداء أجهزة الكمبيوتر المصغرة للأغراض المذكورة ، لتكوين حزمة التنقل للتحرك في المساحات الضيقة من خروتشوف.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OGxB34-heds" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حديد</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
قائمة المكونات في المواد الصلبة هي كما يلي:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التوت بي 3B - 2800 ص.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lidar rplidar a1 - 7500 ص ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">جسور الطاقة l298n -2pcs - 400 rub.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العجلات مع التشفير من النوع A و B - 2000 ص. </font><font style="vertical-align: inherit;">(210 دورة في الدقيقة - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رابط</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teenzy 3.2 - 2100 ص ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imu 9250 (إما 9150 أو 6050) - 240 ص ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بنك الطاقة في 10000mH - 1500 ص.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">عدد 3 بطاريات 18650 وحامل -600 ص.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تنحى محول DC-DC ج 5V إلى 3.3V - 20P.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قطعة من الخشب الرقائقي ، الباركيه -؟ </font><font style="vertical-align: inherit;">فرك.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
المجموع: ١٧١٦٠ ص. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* يمكن تخفيض التكلفة عن طريق استبدال teenzy بـ arduino mega 2560 (600 ص.) ، والليدار عن طريق استبدال kinect v.1 (1000 ص): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ec/vb/v4/ecvbv42ipnldzd5vhureodavsqi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ومع ذلك ، تجدر الإشارة إلى أن kinect الأول لديه الحد الأدنى من الرؤية (المنطقة العمياء) 0.5 م ، والتي يمكن أن تؤثر سلبًا على الملاحة في ظروف ضيقة وهي كبيرة الحجم إلى حد ما. </font><font style="vertical-align: inherit;">يحتوي الليدار على منطقة عمياء أقل من 0.2 م.لن يتناسب Kinect v.2 مع التوت 3 ب (لا يحتوي على USB 3.0). </font><font style="vertical-align: inherit;">Arduino mega أدنى من المراهق في الحجم (وبعض الخصائص) ، بالإضافة إلى ذلك ، سيكون عليك إعادة صياغة الرمز قليلاً. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بشكل عام ، يبدو "التصميم" كالتالي: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ou/ru/x9/ourux9icibrxsh4ruai61e3wkx4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yg/bh/0h/ygbh0hlvz8juq6qi4e9tarrhznq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ليس هناك جمال هنا ، بالطبع ، لكن هذا ليس حوله. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالإضافة إلى الروبوت نفسه ، من المستحسن للغاية أن يكون لديك جهاز كمبيوتر خارجي يتم فيه إطلاق قذائف رسومية لتصور إجراءات الروبوت (rviz ، gazebo).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تجميع الروبوت</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تم رسمه بالتفصيل على موقع المشروع - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رابط</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، لذلك دعونا نتحدث عن النقاط التي تسبب صعوبات. </font><font style="vertical-align: inherit;">أولاً ، يجب أن تضع في اعتبارك أن الترميز الموجود على العجلات يتم تشغيله بجهد 3.3 فولت ، وعندما يتم تطبيق 5V ، يفشل تمامًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تم تثبيت البرنامج النصي لتثبيت linorobot بنجاح على أوبونتو 16.04 ، أوبونتو 18.04. </font><font style="vertical-align: inherit;">إصدارات ROS: ROS الحركية أو ROS لحني. </font><font style="vertical-align: inherit;">في raspberry 3b ، يجب عليك أولاً إنشاء ملف مبادلة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
رمز المراهق الرئيسي هو على طول الطريق:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware/lib/config<font></font>
nano lino_base_config.h<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وسكب عليها الأمر:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware<font></font>
platformio run --target upload<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
سيتم استخدام حزم الأوامر المذكورة أعلاه في كثير من الأحيان ، لذلك من المنطقي إضافتها إلى الأسماء المستعارة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بسبب الصعوبات في تجميع الروبوت ، يمكن أن يكون الارتباط الصحيح لجهات الاتصال المتصلة التي تنتقل من l298n إلى teenzy مزعجًا. </font><font style="vertical-align: inherit;">على الرغم من مخطط الاتصال الواضح للغاية ، يمكن أن تتصرف العجلات بشكل مختلف ويجب أن تجرب ، باختيار تعيين الدبوس الصحيح في الرمز. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في حالتي ، اتضح مثل هذا:</font></font><br>
<br>
<pre><code class="bash hljs">/// ENCODER PINS
<span class="hljs-comment">#define MOTOR1_ENCODER_A 14</span>
<span class="hljs-comment">#define MOTOR1_ENCODER_B 15 </span><font></font>
<font></font>
<span class="hljs-comment">#define MOTOR2_ENCODER_A 11</span>
<span class="hljs-comment">#define MOTOR2_ENCODER_B 12 </span><font></font>
//MOTOR PINS<font></font>
<span class="hljs-comment">#ifdef USE_L298_DRIVER</span>
  <span class="hljs-comment">#define MOTOR_DRIVER L298</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR1_PWM 21</span>
  <span class="hljs-comment">#define MOTOR1_IN_A 1</span>
  <span class="hljs-comment">#define MOTOR1_IN_B 20</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR2_PWM 5</span>
  <span class="hljs-comment">#define MOTOR2_IN_A 8</span>
  <span class="hljs-comment">#define MOTOR2_IN_B 6</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
النقطة الثانية هي وصف مواصفات عجلات الروبوت:</font></font><br>
<br>
<pre><code class="bash hljs">//define your robot<span class="hljs-string">' specs here
#define MAX_RPM 210               // motor'</span>s maximum RPM
<span class="hljs-comment">#define COUNTS_PER_REV 1365       // wheel encoder's no of ticks per rev</span>
<span class="hljs-comment">#define WHEEL_DIAMETER 0.065       // wheel's diameter in meters</span>
<span class="hljs-comment">#define PWM_BITS 8                // PWM Resolution of the microcontroller</span>
<span class="hljs-comment">#define LR_WHEELS_DISTANCE 0.235  // distance between left and right wheels</span>
<span class="hljs-comment">#define FR_WHEELS_DISTANCE 0.30   // distance between front and rear wheels. Ignore this if you're on 2WD/ACKERMANN</span>
<span class="hljs-comment">#define MAX_STEERING_ANGLE 0.415  // max steering angle. This only applies to Ackermann st</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن العثور على العائد لكل ألف ظهور في مواصفات العجلة ، ولكن CPR (COUNTS_PER_REV) هي القيمة المحسوبة. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CPR = PPR × 4. طاعون المجترات الصغيرة من عجلاتنا 341. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* يمكن عرض PPR في المواصفات أو تشغيل الكود على </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roslaunch linorobot Mineal_runch robot</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> وتدور العجلة 360 درجة. سيكون PPR مساويًا للقيمة العددية التي سيتم عرضها على الشاشة بعد تدوير العجلة: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/7z/ks/be7zksecqhlyuyv-e_dkxqdyrwe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PPR = القيمة المطلقة (RECENT_COUNT - INITIAL_COUNT). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا CPR = 1364. تحتاج أيضًا إلى تعيين WHEEL_DIAMETER و LR_WHEELS_DISTANCE بالأمتار. علاوة على ذلك ، LR_WHEELS_DISTANCE هي المسافة بين المحاور المركزية للعجلات ، وليس من حافة إلى أخرى. يمكن تجاهل المؤشرات الأخرى إذا كان الروبوت ذو عجلتين وتفاضلي (وليس كليًا). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
النقطة الثالثة التي يمكن أن تسبب صعوبات - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">معايرة imu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. للقيام بذلك ، باتباع التعليمات ، من الضروري إصلاح الروبوت في مواقف معينة. ستكون التلميحات في التعليمات البرمجية عند تنفيذ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">البرنامج النصي rosrun imu_calib do_calib</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/fj/9e/ggfj9eg71ilp0baj7rvshjl-fmw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد الانتهاء من إنشاء imu_calib.yaml مع الإعدادات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من الأفضل إجراء المعايرة ، على الرغم من وجود ملف افتراضي بإعدادات imu. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* بالإضافة إلى ذلك ، تبين أن المعايرة imu يمكن أن تؤثر على اتجاه حركة الروبوت من خلال teleop (اليسار بدلاً من اليمين والعكس صحيح ، بينما كانت الحركة ذهابًا وإيابًا صحيحة). لم يتم حل الموقف بإعادة ترتيب المسامير في الكود. تم إصلاح ومعايرة Imu نفسها بأقواس مقلوبة ، مثل ثابتة على الجزء الخلفي من قاعدة الروبوت. له (imu) المزيد من الوجه دون إعادة المعايرة حل المشكلة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
النقطة الرابعة - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">معايرة pid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
على موقع المشروع ، يتم وصف إجراء تنفيذ التعديل بالتفصيل - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رابط</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ومع ذلك ، سيكون من الصعب على المبتدئ معرفة ما هو وكيفية العمل معه. </font><font style="vertical-align: inherit;">بشكل عام ، هناك حاجة إلى تنظيم pid لضمان تحرك الروبوت بشكل موحد ، دون الرجيج / الكبح المفاجئ. </font><font style="vertical-align: inherit;">المعلمات الثلاث هي المسؤولة عن هذا: ص ، ط ، د. </font><font style="vertical-align: inherit;">يتم تضمين قيمهم في الرمز الرئيسي الذي تم تحميله إلى teenzy:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define K_P 2.0 // P constant angle</span>
<span class="hljs-comment">#define K_I 0.3 // I constant</span>
<span class="hljs-comment">#define K_D 0.1 // D constant</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكنك تجربتها عن طريق التشغيل على الروبوت:</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot minimal.launch
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
علاوة على الكمبيوتر الخارجي في ثلاث محطات مختلفة:</font></font><br>
<br>
<pre><code class="bash hljs">rosrun lino_pid pid_configure<font></font>
rosrun teleop_twist_keyboard teleop_twist_keyboard.py<font></font>
rqt<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من خلال تحريك منزلقات p ، d ، i في محطة rqt ، ومن ثم التحكم في الروبوت في محطة teleop_twist_keyboard ، يمكنك تحقيق النتائج الضرورية دون الحاجة إلى تنزيل الكود بمعلمات pid الجديدة في كل مرة في سن المراهقة: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qr/9m/ef/qr9mefipf7mqz9vwqqyqkktkeug.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أي أن كل شيء يحدث على الطاير وفي ذلك الوقت في البرامج الثابتة قد يكون للمراهق معاني مختلفة تمامًا. </font><font style="vertical-align: inherit;">* لا يمكنك التركيز على المخططات لأنه </font><font style="vertical-align: inherit;">بصريًا ، وبالتالي سيتم فهم كيف يسير الروبوت. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوصون بالبدء بتحديد القيم p = 1.0 ، d = 0.1 ، i = 0.1. </font><font style="vertical-align: inherit;">في حالتنا ، تكون القيم على النحو التالي (تم الحصول عليها تجريبيًا) p = 2.0 ، i = 0.3 ، d = 0.1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد ذلك ، يجب تعيين هذه القيم في التعليمات البرمجية وملؤها في سن المراهقة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أيضًا ، لا تنس تعيين الرمز (DEBUG 0 بدلاً من DEBUG 1):</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define DEBUG 0</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قياس المسافات</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لتوجيه الروبوت والملاحة اللاحقة ، يتم استخدام بيانات lidar وبيانات imu و encoder. إذا تم إجراء معايرة imu بشكل صحيح ، يتم تثبيت الليدار بشكل صحيح ، وتكون قيم التشفير صحيحة ، فيجب ألا تكون هناك مشاكل في قياس المسافات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
للتحقق من صحة odometry ، تحتاج إلى الركوب قليلاً على الروبوت عبر teleop ورؤية القيم في موضوع odom ، وهذا مكتوب على صفحة المشروع - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رابط</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وانظر أيضًا في الغلاف البصري لـ rviz: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rr/td/si/rrtdsilkdlggf3ifjhk1uhl8bz0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
خلية واحدة في rviz هي 1 متر ، لذا فمن المستحسن أن يقوم الروبوت بتمرير هذا العداد في المحرر المرئي والعيني أيضًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالإضافة إلى ذلك ، يتم عرض المسافة المقطوعة في المؤشر ث: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i1/oj/l6/i1ojl6vg5jyugymjwgk-5cfsrlm.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يجب أن تميل أيضًا إلى 1 م. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وينطبق الشيء نفسه على زوايا دوران الروبوت:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l0/uf/bv/l0ufbvhsko99na50frablnrvsc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* في rviz والعيش ، يجب أن يدور الروبوت في نفس الزوايا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتم تحديد قياس المسافات من ليدار بطريقة مماثلة - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ارتباط.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يجب أن تتطابق المسافة من ليدار إلى أقرب جدار مباشر وفي رفيز.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في ROS ، يتم إيلاء اهتمام خاص للتحولات - tf. </font><font style="vertical-align: inherit;">بشكل عام ، يصف هذا المفهوم ارتباط الأشياء بالنسبة لبعضها البعض في الفضاء. </font><font style="vertical-align: inherit;">حتى لا تتدلى الأشياء في الهواء ، ويفهم البرنامج كيف يتم تقديمها بالنسبة لبعضها البعض ، فمن الضروري الانتباه إلى إعداد tf. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في المشروع ، تم تكوين جميع اتصالات tf بالفعل بالنسبة لبعضها البعض وتحتاج فقط إلى ضبط المؤشرات ، على سبيل المثال ، الإشارة إلى كيفية وجود lidar. </font><font style="vertical-align: inherit;">يعد ذلك ضروريًا لفهم الروبوت أن العائق لم يبرز مباشرة أمامه ، ولكن أمام الليدار ، الذي يتم فصله عن مركز الروبوت على مسافة معينة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعنا نذهب إلى الدليل المناسب:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch<font></font>
nano bringup.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تقع القاعدة نفسها على مسافة 0.065 م من الأرضية:</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_footprint_to_base_link"</span> args=<span class="hljs-string">"0 0 0.065 0 0 0  /base_footprint /base_link "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في laser_runch ، تحتاج إلى تعيين موقع الليدار بالنسبة لمركز قاعدة الروبوت:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch/include<font></font>
nano laser.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في حالتي ، يتم تحريك الليدار على طول المحور x: -0.08 ، y: 0.04 و "الارتفاعات" فوق القاعدة (المحور z): 0.08 م:</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf2_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_link_to_laser"</span>
args=<span class="hljs-string">"-0.08 0.04 0.08 0 0 0  /base_link /laser "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في rviz ، يمكن ملاحظة هذا الموقع بصريًا: في </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1v/rz/gj/1vrzgjmhx-gf-jar7jxfbhcovte.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حين أنه ليس بعيدًا عن الليدار ، قم بتعديل تردده بحيث يعطي المزيد من النقاط (بشكل افتراضي يعطي 4k) ، سيساعد ذلك في بناء الخريطة:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> linorobot/launch/include/lidar<font></font>
nano rplidar.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إضافة معلمة:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"scan_mode"</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Boost"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
والتغيير </font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"angle_compensate"</span>    <span class="hljs-attr">type</span>=<span class="hljs-string">"bool"</span>   <span class="hljs-attr">value</span>=<span class="hljs-string">"false"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن 8k تحت تصرفنا: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/u0/fq/zfu0fqd4d7nwmuv50am1qhwqxbm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الموقع المادي لليدار على الروبوت مهم أيضًا:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/46/mw/vq/46mwvqq3kj7nxpskvoadm7xe738.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بناء خريطة غرفة ثنائية الأبعاد</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يقترح على موقع المشروع إنشاء خريطة غرفة من خلال الإطلاق في محطتين:</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot bringup.launch<font></font>
roslaunch linorobot slam.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ومع ذلك ، فقد أظهرت الممارسة أن slam ، الذي يأتي مع المشروع بشكل افتراضي ، يرفض العمل عندما يكون وضع lidar هو 8k: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/xa/a5/zexaa5f_1byvgcvvvkvcr7cowbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بينما في وضع 4K ، لا تكون البطاقات ناجحة للغاية ، فهي صاخبة للغاية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذلك ، من الأفضل استخدام ضربة سلام أخرى - hector-slam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يشار إلى كيفية تثبيته </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هنا</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد التثبيت ، سيكون إجراء بناء الخريطة هو نفسه ، ولكن بدلاً من roslaunch linorobot slam.co.unch ، قم بتشغيل roslaunch my_hector_mapping my_launch_runch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الخرائط أكثر نظافة ، ولكن من الأفضل </font><font style="vertical-align: inherit;">تنقيحها </font><font style="vertical-align: inherit;">في محرر رسومي ، وإزالة الخرائط غير الضرورية ، خاصة إذا واجه ليدار المرايا عند بناء الخريطة : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cn/zo/jv/cnzojvfwpkwgldoo3mylfwwh-yg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لا تنسى حفظ خريطة الغرفة:</font></font><br>
<br>
<pre><code class="bash hljs">rosrun map_server map_saver -f my-map
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* يتم الحصول على الخرائط بشكل أفضل في الشفق اللطيف ، وهذا سيضغط إلى أقصى حد من ميزانية الميزانية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتبع.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar502056/index.html">كيفية بناء منزل ذكي وليس بالجنون</a></li>
<li><a href="../ar502066/index.html">أوامر وحدة تحكم بسيطة يجب أن يعرفها الجميع</a></li>
<li><a href="../ar502068/index.html">110 فولت على جهاز الكمبيوتر الخاص بك</a></li>
<li><a href="../ar502070/index.html">تاريخ بنتاكس (مقالة بالفيديو)</a></li>
<li><a href="../ar502072/index.html">إرساء ISS باستخدام JavaScript والبوصلة</a></li>
<li><a href="../ar502080/index.html">طريقة كانبان: مثال PNZ رقم 1 ، عملية دراسة القياس في الشركات الناشئة</a></li>
<li><a href="../ar502084/index.html">التحقق من بوابة الخدمات العامة الإقليمية تحت التحميل من خلال دمية</a></li>
<li><a href="../ar502086/index.html">إعداد Minio بحيث يمكن للمستخدم العمل فقط مع دلو له</a></li>
<li><a href="../ar502088/index.html">حكاية من الوقت الزائد والضياع. وفقًا لـ py3</a></li>
<li><a href="../ar502092/index.html">الدعم التكنولوجي والتنظيمي لخدمات الثقة الرقمية في الاتحاد الروسي</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>