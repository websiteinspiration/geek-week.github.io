<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎼 🎍 ⏹️ InSys JSCによって製造された装置を備えたアプリケーションMATLAB / Simulink 🏂🏿 🗯️ 🙅🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="重要な実用的なタスクは、Matlab / Simulinkを実際の機器で使用して、現実世界から信号を受信できるようにすることです。これは、アルゴリズムのデバッグに非常に役立ちます。このペーパーでは、InSys JSCによって製造されたADCデバイスをSimulinkに接続するための技術を紹介します。...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>InSys JSCによって製造された装置を備えたアプリケーションMATLAB / Simulink</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470327/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要な実用的なタスクは、Matlab / Simulinkを実際の機器で使用して、現実世界から信号を受信できるようにすることです。これは、アルゴリズムのデバッグに非常に役立ちます。このペーパーでは、InSys JSCによって製造されたADCデバイスをSimulinkに接続するための技術を紹介します。 DLLは接続に使用され、Simulinkではsm_adcコンポーネントとして表示されます。別のコンソールプログラムを使用して、機器を操作します。 DLLとの通信は、共有メモリを介して行われます。このテクノロジーによれば、InSys JSCのサポートモジュール上のADCを接続できます。このペーパーでは、A7_DACジェネレーターとFMC128E / FM412x500Mアクイジションモジュールのシステムを紹介しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この作業は、2018年3月27〜28日のカンファレンス「複雑な技術システムの開発とデバッグのためのテクノロジー」で実証されました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2q/2y/7a/2q2y7ajg2jcoezpe6x1ptohzjia.png"><br>
<br>
<a name="habracut"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">陳述</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
信号発生器と指定されたパラメータの信号を生成し、それをデジタル化しますADCからシステムを開発することが必要であるという問題。</font><font style="vertical-align: inherit;">受信したデータはSimulinkに転送して処理する必要があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機器</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
作業</font><b><font style="vertical-align: inherit;">用に</font></b><font style="vertical-align: inherit;">、ADCモジュールと発電機からスタンドが組み立てられました。</font><font style="vertical-align: inherit;">ADCとして、FM412x500Mサブモジュールが使用され、サンプリング周波数が500 MHzのADCチャネルが4つあります。</font><font style="vertical-align: inherit;">サブモジュールは、Artix 7 FPGAとUSB 3.0インターフェイスがあるFMC128Eキャリアモジュールにインストールされます。</font><font style="vertical-align: inherit;">両方のデバイスは、Simulinkを実行しているラップトップに接続されています。</font><font style="vertical-align: inherit;">もちろん、パフォーマンスを監視するためにオシロスコープが使用されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタンドの外観：スタンドの</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/i_/tg/pt/i_tgptlp8qd0txtxts7qlwlnjls.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構造図：</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/bf/_x/n4/bf_xn4xf3dirqyym-6pugnunsqo.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成された信号：</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/r7/ww/rr/r7wwrrzr0ce7s6ba9iavxqzarlu.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタンドのアルゴリズム：</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimulinkはADCとジェネレーターを起動する準備をしています</font></font></li>
<li>Simulink     </li>
<li>   ( )    ()</li>
<li>      </li>
<li>       Simulink</li>
<li>Simulink     </li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、古典的な1回限りの収集モードです。その特異性はただの単一性です。信号フロントに沿った機器は、特定のデータ配列を収集します。データ収集のフェーズは「ハードリアルタイム」モードで発生しますが、処理はそれを取得する方法です。収集レートは、選択したチャネルの数とサンプリングレートによって決まります。 4つのADCチャネルと500 MHzのサンプリング周波数の場合、データレートは4 GB /秒です。この速度で、FMC128EモジュールのSODIMMにデータを書き込むことができます。つまり、4 GBのサンプルを保存できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、データをコンピューターに転送する必要があります。 FMC128Eモジュールは、USB 3.0インターフェイスを介してコンピューターに接続されます。データ転送速度は300 MB /秒です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Simulinkはデータの配列を受け取り、それをさらに処理するために渡します。この処理の時間は、モデルの複雑さによってすでに決定されています。この例では、アレイは単にオシロスコープパネルに表示されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ある時点で、Simulinkは次のサイクルを実行する必要があると判断し、すべてが繰り返されます。再びUSBコマンドが送信されて、ADCの準備、ジェネレータの起動、データの収集が行われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモードは、ハードウェアとアルゴリズムのデバッグに非常に便利です。あなたはどこにでも突入することはできません。データの配列を収集します。静かにそれを見て、ディスクに焼き、コーヒーを飲むことができます。しかし、すべてがうまくいくと、連続収集モードに切り替えることがすでに可能です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL接続</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Matlabでは、外部DLLに実装された関数を接続できます。</font><font style="vertical-align: inherit;">Simulinkには、外部DLLを接続する機能もありますが、いくつかの要件が追加されています。</font><font style="vertical-align: inherit;">Simulink内では、外部DLLはS-Functionブロックのように見えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/ln/ov/vilnovzdl8eg7r3kqxbwgwcgh5a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MATLABは、外部DLLの作成を含む多数の例を提供します。</font><font style="vertical-align: inherit;">ただし、MATLABが提供する方法はあまり便利ではありません。</font><font style="vertical-align: inherit;">オープンソースの</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">easyLink</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトがあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">このプロジェクトは、Simulinkに接続するためのクラスライブラリを開発しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントを作成するには、BaseBlockから派生したクラスを作成し、ポートを宣言する必要があり</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_m/p-/rb/_mp-rbn7ntlkvgxwf3xnoibmhlm.png"><br>
<br>
<img src="https://habrastorage.org/webt/qn/94/th/qn94tho2jxf3nlnhaarxwosshxq.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。DLL接続の問題</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
外部DLLは多くのことを許しますが、それらを扱う際には多くの問題があります。</font><font style="vertical-align: inherit;">私にとって個人的に最も重要なのは次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLLのデバッグが難しい</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">printf（）の出力を見るのは不便</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLLを再コンパイルするには、MATLABを終了する必要があります</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムをデバッグするときは、段階的なデバッグが必要です。</font><font style="vertical-align: inherit;">DLLの場合、すでにメモリにロードされているDLLに接続し、そこにブレークポイントを割り当て、デバッグセッションを実行することができます。</font><font style="vertical-align: inherit;">しかし、Simulinkを介してDLLをロードする瞬間をキャッチし、どういうわけか作業の開始を遅らせる必要があります。</font><font style="vertical-align: inherit;">これはすべて実行できますが、不便です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その過程で、標準のstdoutストリームとして形成されるデバッグ出力を実際に確認したいと思います。</font><font style="vertical-align: inherit;">DLLの場合、このスレッドは何らかの方法で傍受される可能性がありますが、成功しませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、最も重要な不便な点は、DLLを再コンパイルするときにMATLABを終了する必要があることです。</font><font style="vertical-align: inherit;">そうしないと、新しいファイルを書き込むことができません。</font><font style="vertical-align: inherit;">また、MATLABの終了とその後の起動には時間がかかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの問題を解決するために、複雑なソフトウェアシステムを構築する古典的な方法があります。これは共有メモリを介したプログラム間の相互作用です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">共有メモリ接続</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WindowsとLinuxの両方の最新のオペレーティングシステムでは、メモリの共通領域を整理できます。これにより、信頼性の高いプログラムを作成できます。たとえば、1つのプログラムはグラフィカルインターフェイスを含み、オペレーターと対話することができ、別のプログラムは機器と対話することができます。この場合、機器と相互作用するプログラムの凍結は、オペレーターとの相互作用プログラムの凍結にはつながりません。 Simulinkの場合、このアプローチにはいくつかの利点もあります。機器を操作するためのプログラムが一度起動され、機器を準備し、共有メモリを介してコマンドを待ちます。 DLLは、シミュレーションでSimulinkを実行するたびに読み込まれます。 DLLはハードウェアで直接動作しないため、この起動は迅速です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスタンド用に2つのプログラムと2つのDLLが開発されました。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simulink_a7dac-発電機制御プログラム</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simulink_adc-ADC制御プログラム</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sm_ctrl-ジェネレーター制御DLL</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sm_adc-ADC制御DLL</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下の図に</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1u/vq/ec/1uvqecetd2an7yzazp2z2p2idma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブロック</font><font style="vertical-align: inherit;">図を示します</font><font style="vertical-align: inherit;">。simulink_adcプログラムは、Bardyライブラリに基づいています。このプログラムを使用すると、InSys JSCが製造した任意のADCを操作できます。特定のADCおよびキャリアモジュールへのチューニングは、初期化ファイルを通じて行われます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulinkでの回路の表示</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最後に、</font><b><font style="vertical-align: inherit;">Simulink内での回路の</font></b><font style="vertical-align: inherit;">見え方：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mb/w8/aq/mbw8aq0g8ddsb2wnkbk9p6dhr8c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが</font><font style="vertical-align: inherit;">Simulinkのように見え</font><font style="vertical-align: inherit;">ます。 ADC制御用の1つのユニット。ジェネレーターを制御する2番目のブロック。ジェネレーターを制御するために、いくつかのパラメーターを使用できます。 ADCの場合、すべて初期化ファイルを使用します。必要に応じて、いくつかのADCパラメータをブロックレベルで表示することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのマスターオシレーターに注意してください。モデル時間に関しては、データ収集の開始時間と瞬間を指定します。これらの点は非常に重要です。彼らは実際にモデルと現実世界の間の接続を設定しました。開始信号はADCブロックに入り、DLLで処理されます。共有メモリを通じて、彼はADCプログラムに入ります。次に、レジスタへの一連の書き込みコマンドに変換され、USB経由でFPGAに入ります。そして、FPGA内では、開始信号の検索フロントエッジが制御されます。そして、マシンが反対方向にコッキングされた後にのみ、確認は同じチェーンを通過します。確認がSimulinkに到達すると、start_out信号がsm_adcブロックの出力に現れ、sm_ctrlブロックに渡されます。そして、それはすべてモデルタイムの同じ瞬間になります。sm_ctrlブロックでは、同じチェーンに沿って、信号がジェネレーターのFPGAに送信され、信号を形成します。 ADCはこの信号をメモリに取り込みます。データ取得信号は、2番目のマスターオシレーターから生成されます。同様に、データはSimulinkに入り、sm_adcブロックのデータ出力に行きます。現時点では、16384カウントのブロックが返されています。受信したブロックはオシロスコープに表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ov/u3/uk/ovu3uklgq_xzvvjpkfcpoopqzec.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
共有メモリによる作業が効果的であることが示されています。 ADC管理プログラムを使用すると、ADCを操作できます。この場合、構成ファイルを使用してパラメーターを構成する便利な方法が残っています。プログラムはコンソールアプリケーションとして設計されていますが、デバッグ出力はすべて表示されます。操作性の目安があります。 SM_CTRLコンポーネントを使用すると、機器を制御するためのさまざまな外部アプリケーションを接続できます。 ADC制御プログラムをデバッグしても問題は発生しません。これは、ブレークポイントを設定してデバッグできる一般的なプログラムです。同じテクノロジーを使用して、Matlab / Simulinkと外界との相互作用のための他のプログラムを開発できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作品は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hub.exponenta.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトで公開されています</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
参照：</font></font><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> SIMULINK_SM —   : https://github.com/dsmv/simulink_sm</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> easyLink: https://sourcesup.renater.fr/frs/?group_id=1500</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  FMC128E http://insys.ru/fmc/fmc128e</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> FM412x500M http://insys.ru/mezzanine/fm412x500m</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Telegram  InSys Research</a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja470311/index.html">木製おもちゃ、パート7-1993</a></li>
<li><a href="../ja470313/index.html">木製おもちゃ、パート8-1994</a></li>
<li><a href="../ja470317/index.html">C ++の省略に関するチートシートなど。パート2：「そしてそれだけではない」</a></li>
<li><a href="../ja470321/index.html">木製おもちゃ、パート9-1995</a></li>
<li><a href="../ja470323/index.html">DIY DeepFake [パート1]</a></li>
<li><a href="../ja470331/index.html">インデックス付けされたISI、Scopus、またはScimagoのログを識別する方法は？</a></li>
<li><a href="../ja470333/index.html">プログラマー、マネージャー、MVC、受け入れ基準</a></li>
<li><a href="../ja470337/index.html">Y. Marketで3か月間働いた方法</a></li>
<li><a href="../ja470347/index.html">ここのAPIを短時間で学ぶ方法</a></li>
<li><a href="../ja470353/index.html">ホリバー。ルネットの歴史。パート4. Mail.ru：ゲーム、ソーシャルネットワーク、Durov</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>