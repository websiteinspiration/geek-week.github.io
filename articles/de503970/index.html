<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💚 ☢️ 👺 PuppetConf 2016. Kubernetes für Systemadministratoren. Teil 1 🔗 🎃 👩🏾‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich bin ein Systemadministrator, der sich mit Computern befasst, und heute werden wir über Kubernetes sprechen. Ich werde versuchen, mich eingehender ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PuppetConf 2016. Kubernetes für Systemadministratoren. Teil 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/503970/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich bin ein Systemadministrator, der sich mit Computern befasst, und heute werden wir über Kubernetes sprechen. Ich werde versuchen, mich eingehender mit dem Thema zu befassen, wobei ich überlege, welche Probleme der Systemadministrator mit dieser Anwendung lösen kann, und auch einige Aspekte der Puppet-Operation ansprechen, die mithilfe einer Reihe neuer Abstraktionen für die Anwendung in diese Welt zu passen schienen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor fünf oder sechs Jahren schlugen Luis Andre Barroso und Urs Hoesl im Artikel „Rechenzentrum als Computer“ vor, das Rechenzentrum als einen massiven Computer wahrzunehmen. Es ist notwendig, von der Tatsache zu abstrahieren, dass das Rechenzentrum aus separaten Maschinen besteht, und es als eine logische Einheit zu betrachten. Sobald Sie versuchen, diese Idee in die Praxis umzusetzen, können Sie die Prinzipien des Aufbaus verteilter Systeme und des verteilten Rechnens auf Rechenzentren anwenden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w9/q7/sg/w9q7sgxchzl3fuuhlrymsv4xcsa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das Rechenzentrum als Computer zu behandeln, benötigen Sie ein Betriebssystem. Es sieht dem auf einem separaten Computer sehr ähnlich, muss jedoch über eine andere Schnittstelle verfügen, da Sie keinen Zugriff auf einen separaten Computer und keinen Zugriff auf den Kernel benötigen. Stellen wir uns das Rechenzentrum also als einen großen Computer vor. Heute werde ich Ihnen sagen, was zu tun ist, wenn Sie anscheinend nicht in der Lage sind, einen Computer mit SSH zu steuern. Sie können sich nicht anmelden, und obwohl einige Leute glauben, dass es ohne dies unmöglich ist, das System zu steuern, werde ich Ihnen sagen, wie viel mit Kubernetes getan werden kann. Zunächst sollten Sie sich Kubernetes als Framework zum Erstellen verteilter Plattformen vorstellen.</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/webt/wf/d2/5c/wfd25cjupilzhtu1ndkpci11cfs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies bedeutet nicht, dass Sie nach dem Herunterladen von Kubernetes eine Benutzeroberfläche erhalten, die Ihnen alles bietet, was Sie mit dem System tun möchten. Nein, dies ist nur die Grundlage für die Erstellung der Tools, die Sie zum Ausführen Ihrer Infrastruktur benötigen. Ich zeige Ihnen, wie Sie mithilfe der Let's Encrypt Certificate Authority eine Integration erstellen, um den Zertifikatsprozess für meine Anwendung mithilfe von Kubernetes als Framework zu automatisieren.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ol/ty/g3/oltyg3s-gtbgticzc-omgefrq04.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viele Leute fragen genau, wofür Kubernetes gut ist. Ich habe viele Jahre mit Puppet Labs zusammengearbeitet und festgestellt, dass dieses Ding auf Computern installiert wurde, um dem System eine API zur Verfügung zu stellen, die es bisher noch nicht gab. Anstelle von Bash, YAML-Skripten und ähnlichen Dingen stellte Puppet einen DSL-Benutzer zur Verfügung, der es ihm ermöglichte, programmgesteuert ohne Shell-Skripte mit den Maschinen zu interagieren. Der Unterschied zwischen Kubernetes besteht darin, dass es sich über dem Niveau von "Eisen" befindet. Konzentrieren wir uns weniger auf die Automatisierung und Abstraktion dieses Systems als vielmehr auf die Beziehungen oder den Vertrag zwischen unserer Infrastruktur und den Anwendungen, die wir von jedem Knoten aus abrufen werden. In Kubernetes weisen wir Maschinen keine Anwendungen zu. Es gibt kein "Knotenmanifest". Der Scheduler betrachtet einzelne Knoten einfach als Rechenzentrumsressourcen.einen großen Computer darstellen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fragen: "Läuft Kubernetes auf OpenStack, auf VMware, auf Bare Metal, in der Cloud?" mach keinen Sinn Die richtige Frage lautet: "Kann ich den Kubernetes-Agenten ausführen, um diese Ressourcen abzurufen?" Die Antwort lautet "Ja". Weil der Betrieb dieser Anwendung völlig unabhängig von der von Ihnen gewählten Plattform ist. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/an/km/hl/ankmhlzzmnaitmix8t0hppm8idi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetes ist plattformunabhängig. Kubernetes ist genauso deklarativ wie Puppet. Daher geben Sie an, für welche Anwendung Sie sie verwenden möchten - in diesem Beispiel handelt es sich um Nginx. Dies ist ein Vertrag zwischen Ihnen, dem Entwickler, und Kubernetes, um Container-Images zu erstellen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich verwende gerne die Analogie mit der FedEx-Kurierfirma - Sie können ihnen nicht einen ganzen Wagen ziehen und warten, bis sie alles sortieren und dorthin schicken, wo es sein sollte. Sie haben eine Regel: Pack deine Sachen in eine Kiste. Sobald Sie dies tun, senden sie Ihre Box und können erkennen, wann sie am Ziel ankommt. "Wenn Sie keine Box haben, können Sie nicht mit unserem System arbeiten."</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie mit Containern arbeiten, ist es daher sinnlos zu diskutieren, was Sie haben - Python, Java und oder etwas anderes, es spielt keine Rolle - nehmen Sie einfach alle Ihre Abhängigkeiten und legen Sie sie in den Container. Viele Leute sagen über Container, dass sie die Probleme der gesamten Infrastruktur zu lösen scheinen. Das Problem ist jedoch, dass Menschen Container nicht als zwei verschiedene Dinge wahrnehmen, die sie wirklich sind. Das erste ist die Idee eines Verpackungsformats, das zweite ist die Idee einer Container-Laufzeit. Dies sind zwei verschiedene Dinge, die nicht unbedingt dieselben Werkzeuge erfordern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Welcher der Anwesenden hat die Container erstellt? Und wer baut mit Puppet Container? Das stimmt, dem stimme ich auch nicht zu! Sie können sagen: „Wie so? Du bist auf der Puppenkonferenz, da musst du zustimmen! “ Der Grund, warum ich mit der Idee, Container in Puppet zu bauen, nicht einverstanden bin, ist folgender: Ich weiß nicht, ob wir sie überhaupt brauchen, da die Dinge, die wir zum Erstellen eines Bildes benötigen, sich von den Dingen unterscheiden, die wir zum Starten des Produktprozesses benötigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen wir uns vor, Sie erstellen eine Software-Pipeline und sehen sich diese Docker-Datei an. Schließen Sie Ihre Augen vor denen, die diese Dateien noch nie gesehen haben, denn für Sie können sie einschüchternd aussehen. Diese Datei zeigt, wie Sie eine Ruby on Rails-Anwendung erstellen - eine Ruby-Anwendung mit einem Rails-Framework.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f3/ra/3r/f3ra3rkhngjp08t7beuyoeihc7i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es heißt "FROM ruby ​​2.3.1", was wahrscheinlich das gesamte Betriebssystem in den Container einfügen wird, in diesem Fall das grundlegende Ruby-Image von alpine-linux. Weiß jemand, warum wir Ubuntu- oder Red Hat-Images in diese Container einbetten? Die meisten Menschen wissen nicht, was Abhängigkeiten sind, und verwenden einen zufälligen Ansatz, indem sie einfach das gesamte Betriebssystem in einen Container stopfen, um sicherzustellen, dass sie ihre Abhängigkeiten irgendwo im Inneren haben. Nachdem Sie dieses Ding erstellt haben, müssen Sie es nur einmal ausführen. Hier kommt das Missverständnis her: Wenn dieses Ding nicht funktioniert, ändern Sie die Codezeile, bis es funktioniert. Einfach nachschauen! Sie müssen mit diesen Dateien nicht zu schlau sein. Ihr Ziel ist es, eine Offline-Darstellung Ihrer Anwendung mit allen Abhängigkeiten zu erstellen. Dies ist nur eine Krücke, die wir von Ubuntu als Ausgangspunkt verwenden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie die Anwendung gerade erstellt und gestartet hätten, würden Sie so etwas wie einen statischen Link verwenden. Keine Abhängigkeiten vom Host, in Ihrem Container hätten Sie nur eine Binärdatei einer einzeiligen Docker-Datei und keine grundlegenden Images. Tatsächlich ist es nur eine Übertragung von Dingen, die uns vertraut sind. Sehen Sie, wie diese Baugruppe aussehen wird. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jf/pr/uq/jfpruqpgtrrrwwchkadl34kxn_y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe diese Datei zuvor erstellt, aber normalerweise sieht es nach einem Versuch aus, das gesamte Internet aufzubauen. Ich habe ein wenig Angst vor dieser Versammlung, weil ich nicht sicher bin, ob das lokale Internet mit Ruby umgehen kann. Sehen Sie, was passiert ist.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jo/1i/a6/jo1ia6qqo37wr63tazkn-yco38e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie gefällt dir dieses Volumen von 1 Gig? Darüber hinaus kann die Quelldatei, dh Ihre Anwendung selbst, beispielsweise nur 100 kB belegen. Wie haben wir ein ganzes Gigabyte bekommen? Dies liegt daran, dass wir ineffiziente Tools zum Erstellen eigenständiger Anwendungen verwenden. Alle von ihnen sind für die Ausführung auf Computern ausgelegt und verwenden dynamische Bibliotheken, die aus der externen Umgebung geladen wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt werden wir versuchen, das zu tun, was wir auf einem Mobiltelefon tun - tragbare Versionen von Anwendungen, für deren Nutzung ein Vertrag zwischen Ihnen und der Infrastruktur besteht. Sobald wir einen solchen Vertrag haben, können wir dem System genau sagen, was es tun soll, und es ist ihm egal, was zu tun ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie haben keine spezielle, speziell erstellte Anwendung. Ich bin auf Unternehmen gestoßen, die sagen: „Wir haben eine spezielle Anwendung!“. Ich sage: "Ratet mal, was es tut: Es startet, bindet an den Port, empfängt Datenverkehr, macht etwas mit den Daten" und sie sind: "Wow, woher weißt du das?" Ich weiß, weil es hier nichts Besonderes gibt!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also nehmen wir das Beispiel, das wir in den Container gelegt haben, und senden es an den API-Server. Als nächstes müssen wir daraus etwas machen, das auf unserer Maschine funktioniert. Um jedoch Ressourcen vom Computer zu sammeln, müssen wir verschiedene Dinge installieren: eine Container-Laufzeit für die Docker-Datei, einen Agenten, der versteht, wie er mit dem Assistenten kommuniziert, um alles Notwendige auszuführen, und wie die Systemantwort lauten soll, damit die Anwendung funktioniert . Dieser Agent beobachtet einfach - es gibt keine 30-Sekunden-Intervalle, wiederholte Überprüfungen, nichts dergleichen. Er beobachtet einfach und sagt: „Wenn es Arbeit für mich gibt, lassen Sie es mich wissen, und ich werde beginnen und Sie ständig über den Status des Prozesses informieren“, damit Sie wissen, dass es funktioniert.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2q/s1/dq/2qs1dq2ks5exprh4iljfwyiyydu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobald wir dies mit dem Auto tun, brauchen wir einen Planer. Wie viele Personen verwenden den Scheduler? Sie müssen alle Ihre Hände heben! Dies entspricht der Antwort auf die Frage: "Wer von Ihnen hat einen Laptop mit mehr als einem Single-Core-Prozessor?" Wenn ich eine Frage zum Planer stelle, heben die meisten ihre Hände nicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Ihren Prozess auf einem Computer starten, sollte etwas auswählen, welcher Prozessor verwendet werden soll. Wer macht das? Das stimmt, der Kern. Jetzt werde ich euch erklären, was ein Planer ist. Der schnellste Weg, dies zu tun, ist Tetris zu spielen. Das erste, was wir diskutieren werden, ist die automatische Bereitstellung.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/on/qu/bb/onqubbexwsv2hscesmqhfvanli4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie viele von Ihnen haben die vollautomatische Bereitstellung verwendet? Ich denke, deshalb sind wir alle hier. Also drücke ich den Knopf, die Blöcke fallen von oben herunter und jetzt kannst du ein Bier trinken gehen. Beachten Sie jedoch, was links und rechts passiert: Ihr Prozessor und Ihr Speicher werden zum Papierkorb. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9c/gc/nd/9cgcndnl9ybdbg7t5fdhjei0930.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies liegt daran, dass die meisten Benutzer nicht mehr als 5% der Computerressourcen verwenden. Sie automatisieren Prozesse, verlieren aber eine Menge Geld. Ich arbeite als Cloud-Anbieter, ich habe riesige Ressourcenreserven, aber es ist einfach schrecklich, wenn Leute auf ähnliche Weise Geld ausgeben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie den Scheduler verwenden, steuern Sie in Analogie zu Tetris das Spielfeld und jeden Block, indem Sie ihn an die richtige Stelle leiten, dh die Ressourcen der Maschine optimal nutzen. Kubernetes verwendet hierfür einige Algorithmen. Der Hauptalgorithmus heißt Bin Packing - der gleiche „Tetris“ hilft, ihn zu verstehen. Kubernetes erhält eine Arbeitslast in verschiedenen Formen und Größen, und unsere Aufgabe ist es, sie optimal in Maschinen zu verpacken.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser Ziel ist es, alle Ressourcen, die im Verlauf der Arbeit verfügbar werden, wiederzuverwenden. Nicht alle Workloads sind gleich, daher ist es schwierig, sie in dieselbe Box zu packen. In Kubernetes gibt es jedoch immer den richtigen Cluster, in dem Sie ihn platzieren und ausführen können, wenn ein „Teil“ der Arbeitslast angezeigt wird (oder der Tetris-Block, wenn wir unsere Analogie fortsetzen). Und wie bei jeder Stapelverarbeitung erhalten wir nach Abschluss der Aufgabe alle zuvor belegten Ressourcen zurück, damit wir sie für zukünftige Aufgaben verwenden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir nicht im Spiel, sondern in der realen Welt leben, haben Sie Lösungen entwickelt, die vor vielen Jahren entwickelt wurden. Dann werden Sie Systemadministrator, Arbeitgeber zeigen Ihnen ihre Produktion und Sie stellen fest, dass ihre Bereitstellung nicht gut genug ist.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2u/h_/hs/2uh_hsyrdmkfnkg5pnes9jlopr4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können Cluster-Manager auf Teilen Ihrer Computer installieren und bestimmte Ressourcen verwalten lassen. In diesem speziellen Fall können Sie Kubernetes verwenden, die die leeren Bereiche Ihres Tetris ausfüllen, wenn Sie vorwärts gehen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie diejenigen, die in der Branche arbeiten, ihre Hände heben. Ja, das ist ein Klassiker namens Gehalt. Angenommen, Sie haben mehrere Probleme in Ihrem Unternehmen. Das erste ist, dass alles in Java oder sogar in COBOL geschrieben ist - normalerweise ist niemand dazu bereit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das zweite Problem, das in Unternehmen häufig auftritt, ist das Oracle DBMS. Dies ist so etwas, das sich auf der Rückseite der Software befindet und sagt: "Versuchen Sie nicht, etwas zu automatisieren!". Wenn Sie die Software automatisieren, steigen Ihre Kosten. Daher keine Automatisierung - wir fördern unser Beratungs-Ökosystem! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Regel wird unter solchen Umständen gefragt, ob Kubernetes einfach zur Lösung dieser Probleme verwendet werden kann. Ich antworte: "Nein", denn in einer Situation, die der Niederlage in Tetris ähnelt, hilft Ihnen nichts. Sie müssen etwas anderes tun, nämlich den Scheduler verwenden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt, da wir einen Scheduler haben, der Workloads erfolgreich versteht, können Sie einfach alles in Kästchen packen, und der Scheduler beginnt mit seiner Arbeit.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rg/yz/ei/rgyzeivhzivkgknoock70b7rcym.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns über die Schlüsselentitäten von Kubernetes sprechen. Erstens sind dies Pods Pods, bei denen es sich um eine Sammlung von Behältern handelt. In den meisten Fällen besteht eine Anwendung aus mehr als einer Komponente. Sie können sich eine Anwendung anhängen, die ohne Java-Skripte geschrieben wurde. Möglicherweise möchten Sie jedoch nginx verwenden, um TLS und nur einen Proxy im Hintergrund der Anwendung zu vervollständigen. Anschließend sollten diese Elemente miteinander verbunden werden, da es sich um fest codierte Abhängigkeiten handelt. Eine lose gekoppelte Abhängigkeit ist eine Datenbank, die Sie unabhängig voneinander skalieren. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e4/ca/zh/e4cazhfmbeim5egpejksnv42ce8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das zweite wichtige Element ist der Replication Controller, der die Prozesse im Kubernetes-Cluster verwaltet. Sie können mehrere Instanzen von Herden erstellen und deren Zustand überwachen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie sagen, dass Sie einen Prozess starten möchten, bedeutet dies, dass er die ganze Zeit irgendwo im Cluster funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das dritte wichtige Element ist der Service, eine Reihe von kollaborativen Herden. Ihre Bereitstellung basiert auf der dynamischen Bestimmung des gewünschten Status - wo die Anwendungen funktionieren sollen, mit welcher IP-Adresse usw. Sie benötigen also eine Art Service.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das vierte Element sind die Volumes-Repositorys, die als Verzeichnisse angesehen werden können, die für Container im Herd verfügbar sind. Kubernetes verfügt über verschiedene Arten von Volumes, die bestimmen, wie dieser Speicher erstellt wird und was er enthält. Das Konzept der Lautstärke war auch in Docker vorhanden, aber das Problem war, dass der Speicher dort auf einen bestimmten Herd beschränkt war. Sobald Under aufhörte zu existieren, verschwand Volume damit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der von Kubernetes erstellte Speicher ist nicht auf einen Container beschränkt. Es unterstützt einen oder alle im Herd bereitgestellten Container. Ein wesentlicher Vorteil von Kubernetes Volume ist die Unterstützung verschiedener Speichertypen, die Pod gleichzeitig verwenden kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns an, was ein Container ist. Dies ist das Bildformat, in dem unsere Anwendung mit allen Abhängigkeiten gepackt ist, und die Hauptkonfiguration der Laufzeitumgebung, die zeigt, wie diese Anwendung funktionieren sollte. Dies sind zwei verschiedene Elemente, obwohl Sie alles in diese Sache packen können, insbesondere das Root-Dateisystem als komprimierte Tarball-Tar-Datei, die viele Konfigurationsdateien für ein bestimmtes System enthält. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ed/lg/9w/edlg9wz2ttlinfb3udleerb0id0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann können wir die Verteilung durchführen, ein Prozess, der Ihnen allen vertraut ist - RPM oder ein anderes Repository-System wird hier verwendet. Sie nehmen all diese Dinge und legen sie in das Repository. Dieser Prozess ist dem bei Betriebssystempaketen sehr ähnlich, nur für Container, die aus Images erstellt werden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pe/4p/dg/pe4pdggvudbe3l5ufp5l6gei6pc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit Pod können Sie alles zusammenstellen, was unsere logische Anwendung benötigt. Eine logische Anwendung ist ein Tool zum Verwalten mehrerer Anwendungen innerhalb desselben Systemprofils. Ein Sub ist ein Ressourcenpaket, das einen oder mehrere Container und Speicher, einen gemeinsamen Namespace und eine IP-Adresse pro Sub enthält. Tresore können zwischen Containern verteilt werden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ht/rw/cf/htrwcfvuetyk6vhgqjh6zgsjeoe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen ähnelt das Herddesign einer virtuellen Maschine. Es stellt sicher, dass die Anwendung als atomare Einheit gestartet und gestoppt wird. Die nächste Folie zeigt, wie der Replikationscontroller aussieht. Wenn ich diese Deklaration an den Server sende und sage: "Hey, ich möchte, dass eine Replik der Foo-Anwendung funktioniert!", Erstellt der Controller sie aus der Vorlage und sendet sie an den Scheduler, der die Anwendung auf Knoten 1 platziert. Wir geben nicht an auf welcher Maschine es laufen soll, obwohl wir es schaffen können. Erhöhen Sie nun die Anzahl der Replikate auf 3. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ta/qe/ld/taqeldbd6scvq7oyst2ff3dooyu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Welche Aktionen erwarten Sie vom System, wenn einer der Computer ausfällt? In diesem Fall bringt der Replikationscontroller den aktuellen Status des Systems in den gewünschten Status und verschiebt ihn unter dem Container von der dritten, nicht arbeitenden Maschine zur zweiten.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oy/d7/_i/oyd7_i1a1dvfpllkj_s7hek_37e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen sich nicht mit diesem Prozess befassen und ihn steuern. Wenn Sie die Arbeit dem Controller anvertrauen, können Sie sicher sein, dass die Anwendung ordnungsgemäß sichergestellt wird, indem Sie ständig Änderungen des aktuellen Zustands der Infrastruktur überwachen und Entscheidungen treffen, die sicherstellen, dass das System funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Dinge sind ihrer Zeit voraus - Sie sagen dem System einfach: „Ich möchte, dass diese drei Maschinen funktionieren!“ Und hier endet Ihre Kontrolle. Dieser Ansatz unterscheidet sich stark von Skripten und reiner Automatisierung, wenn Sie wirklich verwalten müssen, was gerade passiert, um die zukünftige Entscheidung zu beeinflussen. Sie können dies alles nicht kodifizieren, ohne eingehende Informationen empfangen zu können, um richtig auf die Situation zu reagieren. Der oben beschriebene Ansatz bietet Ihnen diese Möglichkeit.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie stellen Sie sich die Konfiguration vor - das Konzept der Konfigurationsdateien für Dienste? Viele Leute schweigen über dieses Problem, wenn es um Container geht, aber wir brauchen noch eine Konfiguration, es verschwindet nirgendwo! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetes verwendet auch das Secrets-Konzept, mit dem verschlüsselte Daten zwischen Managern und Nods-Knoten gespeichert und übertragen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir lassen Puppet niemals in einem Container laufen, weil es keinen Grund dafür gibt. Sie können Puppet verwenden, um eine Konfigurationsdatei zu generieren, möchten diese jedoch weiterhin in Kubernetis speichern, da Sie sie zur Laufzeit verteilen können. Mal sehen, wie es aussieht.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/i3/f3/vvi3f3c-8dhftpdedfe23me1xbg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beispiel erstellen wir ein Geheimnis aus einer Datei und speichern es auf dem Kubernetes-API-Server. Sie können sich vorstellen, dass Sie diesen Teil durch etwas wie Puppet ersetzt haben, das die eRB-Vorlage und versteckte Daten verwendet, um den Inhalt des Geheimnisses auszufüllen - es spielt keine Rolle, wer es tut, aber Sie können es trotzdem tun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobald das Geheimnis vorhanden ist, kann es als Link zum Erstellen einer Bereitstellung dienen, in der steht: "Ich möchte dieses Geheimnis verwenden!" In diesem Fall führt Kubernetes Folgendes aus.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cm/um/nu/cmumnufkw4ffxmhcggn2ppulcva.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es erstellt einen Pod, entnimmt Daten aus dem Geheimen, legt sie in einem temporären Dateisystem ab und präsentiert sie als Container, genau wie Puppet eine Kopie auf einem Computer erstellt. Dies folgt dem Lebenszyklus der Anwendung, und wenn die Anwendung stirbt, verschwindet die Konfiguration mit ihr. Wenn Sie 10.000 Anwendungsinstanzen benötigen, müssen Sie weniger als 10.000 temporäre Dateisysteme erstellen und in diese einfügen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit Services können Sie alle diese Elemente in einem Cluster ausführen und mit einem anderen Endpunkt synchronisieren. Tatsächlich ist ein Dienst eine Gruppe von Herden, die als ein einziger Herd fungieren. Es enthält eine permanente IP-Adresse und einen Port, bietet eine Integration in DNS, verwendet den Lastenausgleich und wird aktualisiert, wenn sich die Firmware ändert.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8t/cr/co/8tcrcolf5hrgnqfcrdf3nzkdr2a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten wir nun die Zusammenarbeit der konzeptionellen Komponenten von Kubernetes. Wir haben Legosteine ​​und Konfigurationen, die miteinander interagieren müssen. Wenn Sie beabsichtigen, eine Datenbank in einem Cluster auszuführen, können Sie dies wirklich auf Kubernetes tun. Viele sagen, dass Sie keine Stateful-Anwendungen in Containern ausführen können, aber das ist völlig falsch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie darüber nachdenken, wie Hypervisoren funktionieren, können Sie verstehen, dass sie fast dasselbe tun wie Sie: Erstellen Sie eine virtuelle Maschine, der Scheduler verschiebt sie auf den Hypervisor und hängt den Speicher an. Manchmal arbeiten Sie mit lokalem Speicher, der vom Hypervisor stammt, und es gibt keine Gründe, warum Container nicht dasselbe tun könnten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Problem bei Containern besteht jedoch darin, dass die meisten Benutzer nicht daran gewöhnt sind, eine explizite Liste von Dateipfaden zu haben, die sie für die Anwendung bereitstellen müssen. Die meisten Benutzer können Ihnen nicht genau sagen, welche Geräte und Dateien das Data Warehouse benötigt. Sie verpacken alles in Behältern, und als Ergebnis kommt nichts Gutes dabei heraus. Glauben Sie daher nicht, dass Container keine zustandssparenden Anwendungen ausführen können - Sie können dies sehr gut tun. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bj/hm/ve/bjhmvetwbvkbjbqirup-xb_ya-0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Folie sehen Sie ein Beispiel für Ruby-on-Rails. Bevor wir unsere Anwendung verwenden können, müssen wir die Datenbank migrieren. Kommen wir zur Live-Demo des Programms. Um die Bereitstellung durchzuführen, verwende ich MY_SQL, und Sie sehen viele Daten auf dem Bildschirm.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dp/ai/or/dpaioryaowiq9c4yevmvd9uqkqg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich zeige Ihnen das alles, weil Sie als Systemadministrator viele Dinge verstehen müssen. In dieser Bereitstellung verfeinere ich einige Metadaten meiner Anwendung, aber die Hauptsache, die ich grau hervorheben werde: Ich möchte 1 Kopie der MySQL-Anwendung starten und die MySQL-Container-Version 5.6.32 verwenden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qv/kr/ev/qvkrev67_otmvqqvdhtiha07mec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass ich hier ein Geheimnis von Kubernetes als Links auswähle, das ich in diesem Fall als Umgebungsvariablen einfügen werde. Später werde ich Ihnen einen anderen Fall zeigen, wenn wir sie in das Dateisystem einfügen. Daher muss ich in meiner Konfiguration keine Geheimnisse „backen“. Die nächste wichtige Zeile ist der Ressourcenblock.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hm/b4/jt/hmb4jtgyd1dupdt4dfoapzcppli.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können Tetris erst spielen, wenn Sie die Größe der Blöcke kennen. </font><font style="vertical-align: inherit;">Viele Benutzer beginnen mit der Bereitstellung, ohne Ressourcenbeschränkungen für diesen Prozess zu verwenden. </font><font style="vertical-align: inherit;">Infolgedessen ist der Arbeitsspeicher vollständig verstopft, und Sie "stapeln" den gesamten Server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
22:09 min Wird </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sehr bald fortgesetzt ...</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/HlAXp0-M6SY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen Werbung :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank für Ihren Aufenthalt bei uns. Gefällt dir unser Artikel? Möchten Sie weitere interessante Materialien sehen? Unterstützen Sie uns, indem Sie eine Bestellung </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">aufgeben</font></a><font style="vertical-align: inherit;"> oder Ihren Freunden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud-basiertes VPS für Entwickler ab 4,99 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> empfehlen </font><font style="vertical-align: inherit;">, ein </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einzigartiges Analogon von Einstiegsservern, das von uns für Sie erfunden wurde: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ganze Wahrheit über VPS (KVM) E5-2697 v3 (6 Kerne) 10 GB DDR4 480 GB SSD 1 Gbit / s ab 19 $ oder wie teilt man den Server?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2-mal günstiger im Equinix Tier IV-Rechenzentrum in Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nur wir haben </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2,6 GHz 14C 64 GB DDR4 4 x 960 GB SSD 1 Gbit / s 100 TV von 199 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Niederlanden!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2,2 GHz 6C 128 GB DDR3 2x960 GB SSD 1 Gbit / s 100 TB - ab 99 US-Dollar! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lesen Sie mehr über</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Aufbau eines Infrastrukturgebäudes. </font><font style="vertical-align: inherit;">Klasse C mit Dell R730xd E5-2650 v4-Servern für 9.000 Euro für einen Cent?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503960/index.html">Wie Linux Zeichenfolgen sortiert</a></li>
<li><a href="../de503962/index.html">Autonomes Fahren - Hype in Autos, aber die Notwendigkeit von Netzwerkdiensten für Rechenzentren</a></li>
<li><a href="../de503964/index.html">DataStore - CRUD (Create Read Update Delete)</a></li>
<li><a href="../de503966/index.html">Die Social Monitoring App wurde aus einem Müllwagen-Tracker erstellt</a></li>
<li><a href="../de503968/index.html">Wie kann man den Roboter genau bewegen? Übersicht und Funktionen der Studuino Platform Robotics</a></li>
<li><a href="../de503972/index.html">Streaming-Test in 4 sozialen Netzwerken und Auswahl der besten Option</a></li>
<li><a href="../de503980/index.html">Überwachung der Temperatur an einem entfernten Ort durch „improvisierte“ Mittel</a></li>
<li><a href="../de503982/index.html">Über Orks und Frameworks</a></li>
<li><a href="../de503988/index.html">Wie "wirbelndes Licht" in optische Netzwerke gelangte</a></li>
<li><a href="../de503990/index.html">Ich bin es leid, dass gewöhnliche Programmierer sich als Entwickler ausgeben und die Branche entehren. Sie machen die Welt schlimmer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>