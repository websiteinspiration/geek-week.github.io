<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤽🏻 🕺🏼 👸🏾 Moderner Code zum Erstellen von HTTP-Anforderungen in Swift 5 mithilfe von Combine und deren Verwendung in SwiftUI. Teil 1 ✍🏾 🤵🏿 🤑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Abfragen HTTPist eine der wichtigsten Fähigkeiten, die Sie bei der Entwicklung von iOSAnwendungen erwerben müssen . In früheren Versionen Swift(vo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Moderner Code zum Erstellen von HTTP-Anforderungen in Swift 5 mithilfe von Combine und deren Verwendung in SwiftUI. Teil 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488442/"><img src="https://habrastorage.org/webt/uk/tq/y4/uktqy4xvl1cqefjbmvzdzydqj-g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Abfragen </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist eine der wichtigsten Fähigkeiten, die Sie bei der Entwicklung von </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anwendungen </font><font style="vertical-align: inherit;">erwerben </font><font style="vertical-align: inherit;">müssen </font><font style="vertical-align: inherit;">. In früheren Versionen </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(vor Version 5) haben Sie, unabhängig davon, ob Sie diese Anforderungen von Grund auf neu generiert oder das bekannte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alamofire-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Framework verwendet haben </font><font style="vertical-align: inherit;">, komplexen und verwirrenden Code vom </font></font><code>callback </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typ erhalten&nbsp; </font></font><code>completionHandler: @escaping(Result&lt;T, APIError&gt;) -&gt; Void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Erscheinen im </font></font><code>Swift 5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neuen Rahmen der funktionalen reaktiven Programmierung </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Verbindung mit der bestehenden </font></font><code>URLSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bietet Ihnen alle Werkzeuge, die zum unabhängigen Schreiben von sehr kompaktem Code zum Abrufen von Daten aus dem Internet erforderlich sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel werden </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">gemäß dem Konzept </font><font style="vertical-align: inherit;">„Verlage“ erstellen.</font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daten aus dem Internet auszuwählen, die wir in Zukunft problemlos „abonnieren“ und beim Entwerfen </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit&nbsp; </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und mit Hilfe verwenden können&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es prägnanter und effektiver aussieht, weil die Aktion von "Publishern"&nbsp; </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht nur auf Beispieldaten beschränkt ist, sondern sich bis zur Steuerung der Benutzeroberfläche erstreckt ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Tatsache ist, dass </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Datentrennung&nbsp; </font></font><code>View </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unter Verwendung von </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassen mit </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften durchgeführt wird, deren Änderungen&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AUTOMATISCH überwacht und vollständig neu gezeichnet werden </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesen&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassen können Sie ganz einfach eine bestimmte Geschäftslogik der Anwendung einfügen, wenn einige davon</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Eigenschaften sind das Ergebnis von synchronen und / oder asynchronen Transformation andere </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Eigenschaften auf, </font><font style="vertical-align: inherit;">die direkt an eine </font><font style="vertical-align: inherit;">solche „aktive“ Elemente der Benutzerschnittstelle (geändert werden kann </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) als Textkästen </font></font><code>TextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Stepper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Toggle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usw.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um zu verdeutlichen, worum es geht, werde ich konkrete Beispiele nennen. Jetzt </font><font style="vertical-align: inherit;">bieten </font><font style="vertical-align: inherit;">viele Dienste wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregatoren an&nbsp; </font><font style="vertical-align: inherit;">, mit denen Benutzer je nach Interesse unterschiedliche Artikelsätze auswählen können. Im Fall des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregators&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">kann</font></a><font style="vertical-align: inherit;"> es sich um die neuesten Nachrichten oder Nachrichten in einer bestimmten Kategorie handeln - "Sport", "Gesundheit", "Wissenschaft", "Technologie", "Unternehmen" oder Nachrichten aus einer bestimmten Informationsquelle "CNN". , ABC-Nachrichten, Bloomberg usw. Der Benutzer "drückt" normalerweise seine Wünsche nach Dienstleistungen in der Form aus </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die die für ihn notwendige bildet </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Framework&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">können Sie also</font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassen, die einmal einen sehr kompakten Code (in den meisten Fällen nicht mehr als 10-12 Zeilen) verwenden, um eine synchrone und / oder asynchrone Abhängigkeit der Artikelliste&nbsp; </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Form eines "Abonnements" von "passiven" </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften zu "aktiven" </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften zu bilden. Dieses "Abonnement" gilt während des gesamten "Lebenszyklus" der&nbsp; </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klasseninstanz. Und dann </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;geben Sie dem Benutzer die Möglichkeit, nur die "aktiven" </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften in dem Formular </font><font style="vertical-align: inherit;">zu verwalten </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dh WAS er sehen möchte: ob es sich um Artikel mit den neuesten Nachrichten oder Artikel im Abschnitt "Gesundheit" handelt. Das Erscheinungsbild der Artikel selbst mit den neuesten Nachrichten oder Artikeln im Abschnitt "Gesundheit" </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;wird von diesen </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassen und ihren "passiven" @ veröffentlichten Eigenschaften </font><font style="vertical-align: inherit;">AUTOMATISCH bereitgestellt&nbsp; </font><font style="vertical-align: inherit;">. In Code</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Sie müssen niemals explizit eine Auswahl von Artikeln anfordern, da </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassen, die eine Rolle spielen </font><font style="vertical-align: inherit;">, für ihre korrekte und synchrone Anzeige auf dem Bildschirm verantwortlich sind&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In einer Reihe von Artikeln </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
werde ich Ihnen zeigen, wie dies mit&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sowie der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMDb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Filmdatenbank funktioniert</font></a><font style="vertical-align: inherit;"> . In allen drei Fällen funktioniert ungefähr das gleiche Verwendungsmuster&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, da Sie bei Anwendungen dieser Art immer LISTEN von Filmen oder Artikeln erstellen müssen, die dazugehörigen „BILDER“ (Bilder) auswählen und die Datenbanken nach den benötigten Filmen oder Artikeln über die Suchleiste suchen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Zugriff auf solche Dienste können Fehler auftreten, z. B. weil Sie den falschen Schlüssel angegeben </font></font><code>API-key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder die zulässige Anzahl von Anforderungen oder etwas anderem überschritten haben. Sie müssen diese Art von Fehler behandeln, da sonst die Gefahr besteht, dass der Benutzer mit einem leeren Bildschirm völlig ratlos bleibt. Daher müssen Sie in der Lage sein, nicht nur </font></font><code>&nbsp;Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Daten aus dem Internet </font><font style="vertical-align: inherit;">mithilfe </font><font style="vertical-align: inherit;">von </font><font style="vertical-align: inherit;">auszuwählen </font><font style="vertical-align: inherit;">, sondern auch Fehler zu melden, die während der Probenahme auftreten können, und deren Erscheinungsbild auf dem Bildschirm zu verwalten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir beginnen mit der Entwicklung unserer Strategie, indem wir eine Anwendung entwickeln, die mit dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregator interagiert&nbsp; </font><font style="vertical-align: inherit;">. Ich muss sagen, dass es in dieser Anwendung </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in einem minimalen Umfang ohne Schnickschnack verwendet wird und nur, um zu zeigen, wie es </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit seinen "Verlegern" geht.</font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und "Abonnement" sind </font></font><code>Subscription</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">betroffen </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird empfohlen, dass Sie sich auf der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Website registrieren </font><font style="vertical-align: inherit;">und den Schlüssel erhalten, der </font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zum </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ausfüllen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aller Anfragen an den </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NewsAPI.org-</font></a><font style="vertical-align: inherit;"> Dienst erforderlich ist </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sie müssen es in der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Struktur platzieren </font></font><code>APIConstants</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Anwendungscode für diesen Artikel befindet sich auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NewsAPI.org</font></a><font style="vertical-align: inherit;"> Service Data Model und API</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienst&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NewsAPI.org</font></a><font style="vertical-align: inherit;"> können </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Sie</font></a><font style="vertical-align: inherit;"> Informationen zu aktuellen Nachrichtenartikeln </font></font><code> [Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und deren Quellen&nbsp; </font><font style="vertical-align: inherit;">auswählen </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Unser Datenmodell wird sehr einfach sein, es befindet sich in der Datei&nbsp; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Articles.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">import</span> Foundation<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">NewsResponse</span>: <span class="hljs-title">Codable</span> </span>{
    <span class="hljs-keyword">let</span> status: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> totalResults: <span class="hljs-type">Int?</span>
    <span class="hljs-keyword">let</span> articles: [<span class="hljs-type">Article</span>]<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Article</span>: <span class="hljs-title">Codable</span>, <span class="hljs-title">Identifiable</span> </span>{
    <span class="hljs-keyword">let</span> id = <span class="hljs-type">UUID</span>()
    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span>
    <span class="hljs-keyword">let</span> description: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> urlToImage: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> publishedAt: <span class="hljs-type">Date?</span>
    <span class="hljs-keyword">let</span> source: <span class="hljs-type">Source</span><font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SourcesResponse</span>: <span class="hljs-title">Codable</span> </span>{
    <span class="hljs-keyword">let</span> status: <span class="hljs-type">String</span>
    <span class="hljs-keyword">let</span> sources: [<span class="hljs-type">Source</span>]<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Source</span>: <span class="hljs-title">Codable</span>,<span class="hljs-title">Identifiable</span> </span>{
    <span class="hljs-keyword">let</span> id: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> description: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> country: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> category: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> url: <span class="hljs-type">String?</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Artikel </font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthält die Kennung </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, den Titel </font></font><code> title</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die Beschreibung </font></font><code>&nbsp;description</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, den Autor </font></font><code>author</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die URL des „Bildes“ </font></font><code>urlToImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, das Veröffentlichungsdatum </font></font><code>publishedAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die Veröffentlichungsquelle </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Über den Artikeln </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">befindet sich ein Add- </font></font><code>NewsResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In, an dem wir nur an der Eigenschaft interessiert sind </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, bei der es sich um eine Reihe von Artikeln handelt. Die Stammstruktur </font></font><code>NewsResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Struktur </font></font><code>&nbsp;Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sind </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die es uns ermöglichen, buchstäblich zwei Codezeilen zu verwenden, die die </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daten in das Modell </font><font style="vertical-align: inherit;">decodieren </font><font style="vertical-align: inherit;">. Die Struktur&nbsp; </font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;sollte auch sein </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wenn wir es uns leichter machen wollen, eine Reihe von Artikeln </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">als Liste&nbsp; </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;in </font><font style="vertical-align: inherit;">anzuzeigen </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Das Protokoll </font></font><code>Identifiable </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erfordert das Vorhandensein einer Eigenschaft</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die wir mit einer künstlichen eindeutigen Kennung versehen </font></font><code>UUID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Informationsquelle&nbsp; </font></font><code>Source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthält eine Kennung </font></font><code> id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, einen Namen </font></font><code> name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, eine Beschreibung&nbsp; </font></font><code>description</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ein Land </font></font><code> country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, eine Veröffentlichungsquellenkategorie </font></font><code>category</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und eine Site-URL </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Über den Informationsquellen&nbsp; </font></font><code>[Source] </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">befindet sich ein Add-&nbsp; </font></font><code>SourcesResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In, an dem wir nur an einer Eigenschaft interessiert sind </font></font><code>sources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, bei der es sich um eine Reihe von Informationsquellen handelt. Die Wurzelstruktur </font></font><code>SourcesResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Struktur&nbsp; </font></font><code>Source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die es </font><font style="vertical-align: inherit;">uns sehr leicht ermöglicht , </font><font style="vertical-align: inherit;">um die zu dekodieren </font></font><code> JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daten in ein Modell. Die Struktur&nbsp; </font></font><code>Source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;sollte auch sein </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wenn wir die Anzeige eines Arrays von Informationsquellen </font></font><code>&nbsp;[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Form einer Liste </font></font><code>&nbsp;List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;in </font><font style="vertical-align: inherit;">erleichtern möchten</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Das Protokoll </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erfordert das Vorhandensein der Eigenschaft </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die wir bereits haben, so dass kein zusätzlicher Aufwand von uns erforderlich ist. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Überlegen Sie</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
nun, was wir&nbsp; </font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienst </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">benötigen</font></a><font style="vertical-align: inherit;"> ,&nbsp; </font><font style="vertical-align: inherit;">und platzieren Sie es in der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.swift-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei&nbsp; </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der zentrale Teil von uns </font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ist eine Klasse </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die zwei Methoden zur Auswahl von Daten aus dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregator&nbsp;&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">vorstellt</font></a><font style="vertical-align: inherit;"> - Artikel&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Informationsquellen </font></font><code>&nbsp;[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><code>fetchArticles (from endpoint: Endpoint) -&gt; AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp; - Auswahl der Artikel&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anhand des Parameters </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><code>fetchSources (for country: String)&nbsp;-&gt; AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Eine Auswahl von Informationsquellen </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für ein bestimmtes Land </font></font><code> country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Methoden geben nicht nur eine Reihe von Artikeln&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;oder eine Reihe von Informationsquellen zurück </font></font><code>&nbsp;[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sondern auch die entsprechenden "Herausgeber" des&nbsp; </font></font><code>Publisher </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neuen Frameworks </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Beide Herausgeber geben keinen Fehler zurück. </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn dennoch ein Stichproben- oder Codierungsfehler aufgetreten ist, wird ein leeres Array von Artikeln </font></font><code>[Article]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;oder Informationsquellen&nbsp; </font><font style="vertical-align: inherit;">zurückgegeben,&nbsp; </font></font><code>[Source]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ohne dass eine Meldung angezeigt wird, warum diese Arrays leer waren.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Welche Artikel oder Informationsquellen wir vom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Server auswählen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">möchten</font></a><font style="vertical-align: inherit;"> , geben wir anhand der Aufzählung an</font></font><code>enum Endpoint:</code><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Endpoint</span> </span>{
    <span class="hljs-keyword">case</span> topHeadLines
    <span class="hljs-keyword">case</span> articlesFromCategory(<span class="hljs-number">_</span> category: <span class="hljs-type">String</span>)
    <span class="hljs-keyword">case</span> articlesFromSource(<span class="hljs-number">_</span> source: <span class="hljs-type">String</span>)
    <span class="hljs-keyword">case</span> search (searchFilter: <span class="hljs-type">String</span>)
    <span class="hljs-keyword">case</span> sources (country: <span class="hljs-type">String</span>)<font></font>
    <font></font>
    <span class="hljs-keyword">var</span> baseURL:<span class="hljs-type">URL</span> {<span class="hljs-type">URL</span>(string: <span class="hljs-string">"https://newsapi.org/v2/"</span>)!}<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">path</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {
        <span class="hljs-keyword">case</span> .topHeadLines, .articlesFromCategory:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"top-headlines"</span>
        <span class="hljs-keyword">case</span> .search,.articlesFromSource:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"everything"</span>
        <span class="hljs-keyword">case</span> .sources:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"sources"</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die neuesten Nachrichten&nbsp; </font></font><code>.topHeadLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachrichten einer bestimmten Kategorie (Sport, Gesundheit, Wissenschaft, Wirtschaft, Technologie)&nbsp; </font></font><code>.articlesFromCategory(_ category: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachrichten aus einer bestimmten Informationsquelle (CNN, ABC News, Fox News usw.) </font></font><code>&nbsp;.articlesFromSource(_ source: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachrichten&nbsp; </font></font><code>.search (searchFilter: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die eine bestimmte Bedingung erfüllen </font></font><code>searchFilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationsquellen </font></font><code>.sources (country:String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für ein bestimmtes Land </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Initialisierung der von uns benötigten Option zu erleichtern, fügen wir </font><font style="vertical-align: inherit;">der </font><font style="vertical-align: inherit;">Aufzählung </font><font style="vertical-align: inherit;">für verschiedene Listen von Artikeln und Informationsquellen je nach Index </font><font style="vertical-align: inherit;">und Zeichenfolge </font><font style="vertical-align: inherit;">einen </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialisierer hinzu </font></font><code>init?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der für verschiedene Aufzählungsoptionen </font><font style="vertical-align: inherit;">unterschiedliche Bedeutungen hat:</font></font><code>index&nbsp;</code><font style="vertical-align: inherit;"></font><code> text</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">init</span>? (index: <span class="hljs-type">Int</span>, text: <span class="hljs-type">String</span> = <span class="hljs-string">"sports"</span>) {
        <span class="hljs-keyword">switch</span> index {
        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-keyword">self</span> = .topHeadLines
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-keyword">self</span> = .search(searchFilter: text)
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-keyword">self</span> = .articlesFromCategory(text)
        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: <span class="hljs-keyword">self</span> = .articlesFromSource(text)
        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: <span class="hljs-keyword">self</span> = .sources (country: text)
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><font></font>
        }<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kehren wir zur Klasse zurück </font></font><code> NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und betrachten </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">die erste Methode genauer&nbsp; </font></font><code>fetchArticles (from endpoint: Endpoint)-&gt; AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, bei der Artikel </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anhand des Parameters ausgewählt werden </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und kein Fehler zurückgegeben wird - </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchArticles</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Article</span>], <span class="hljs-type">Never</span>&gt; {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = endpoint.absoluteURL <span class="hljs-keyword">else</span> {              <span class="hljs-comment">// 0</span>
                    <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Article</span>]()).eraseToAnyPublisher()<font></font>
        }<font></font>
           <span class="hljs-keyword">return</span>
            <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>:url)        <span class="hljs-comment">// 1</span>
            .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.data}                                       <span class="hljs-comment">// 2</span>
            .decode(type: <span class="hljs-type">NewsResponse</span>.<span class="hljs-keyword">self</span>,                    <span class="hljs-comment">// 3</span>
                    decoder: <span class="hljs-type">APIConstants</span> .jsonDecoder)<font></font>
            .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.articles}                                   <span class="hljs-comment">// 4</span>
            .replaceError(with: [])                             <span class="hljs-comment">// 5</span>
            .receive(on: <span class="hljs-type">RunLoop</span>.main)                          <span class="hljs-comment">// 6</span>
            .eraseToAnyPublisher()                              <span class="hljs-comment">// 7</span>
    }</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn dies </font><font style="vertical-align: inherit;">auf der Grundlage des </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Formulars </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für die Anforderung der gewünschten Artikelliste </font></font><code>endpoint.absoluteURL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht möglich ist, geben Sie ein leeres Array von Artikeln zurück</font></font><code>[Article]()</code></li>
<li> «» <code>dataTaskPublisher(for:)</code>,     <code>Output </code>  <code>(data: Data, response: URLResponse)</code>, &nbsp; <code>Failure</code>&nbsp;-&nbsp;<code>URLError</code>,</li>
<li>  <code>map { }</code>       <code>(data: Data, response: URLResponse)</code>  &nbsp;<code>data</code>,&nbsp;</li>
<li> <code>JSON </code>&nbsp;<code>data</code>   ,   &nbsp;<code>NewsResponse</code>,    <code>articles:&nbsp;[Atricle]</code></li>
<li>  <code>map { }&nbsp;</code>        -&nbsp;<code>articles</code>,&nbsp;</li>
<li>  -        <code>[ ]</code>,</li>
<li>   <code>main </code>,          <code>UI</code>,</li>
<li>«»  «»   <code>eraseToAnyPublisher()</code>    <code>AnyPublisher</code>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Auswahl der Informationsquellen wird der zweiten Methode zugewiesen - </font></font><code>fetchSources (for country: String)&nbsp;-&gt; AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dies ist eine exakte semantische Kopie der ersten Methode, außer dass </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">diesmal anstelle von Artikeln </font><font style="vertical-align: inherit;">Informationsquellen auswählen </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchSources</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Source</span>], <span class="hljs-type">Never</span>&gt; {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = <span class="hljs-type">Endpoint</span>.sources.absoluteURL <span class="hljs-keyword">else</span> {      <span class="hljs-comment">// 0</span>
                       <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Source</span>]()).eraseToAnyPublisher()<font></font>
           }<font></font>
              <span class="hljs-keyword">return</span>
               <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>:url)      <span class="hljs-comment">// 1</span>
               .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.data}                                     <span class="hljs-comment">// 2</span>
               .decode(type: <span class="hljs-type">SourcesResponse</span>.<span class="hljs-keyword">self</span>,               <span class="hljs-comment">// 3</span>
                       decoder: <span class="hljs-type">APIConstants</span> .jsonDecoder)<font></font>
               .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.sources}                                  <span class="hljs-comment">// 4</span>
               .replaceError(with: [])                           <span class="hljs-comment">// 5</span>
               .receive(on: <span class="hljs-type">RunLoop</span>.main)                        <span class="hljs-comment">// 6</span>
               .eraseToAnyPublisher()                            <span class="hljs-comment">// 7</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt uns den "Herausgeber" </font></font><code>AnyPublisher &lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einem Wert in Form eines Arrays von Informationsquellen </font></font><code>[Source] </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und dem Fehlen eines Fehlers zurück </font></font><code>&nbsp;Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;(im </font><font style="vertical-align: inherit;">Fehlerfall </font><font style="vertical-align: inherit;">wird ein leeres Array von Quellen zurückgegeben&nbsp; </font></font><code>[ ]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden den gemeinsamen Teil dieser beiden Methoden herausgreifen und ihn als eine </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktion </font><font style="vertical-align: inherit;">anordnen </font></font><code>fetch(_ url: URL) -&gt; AnyPublisher&lt;T, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die den </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Herausgeber" </font><font style="vertical-align: inherit;">zurückgibt,&nbsp; </font></font><code>AnyPublisher&lt;T, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basierend auf </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-comment">//     URL</span>
     <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetch</span>&lt;T: Decodable&gt;<span class="hljs-params">(<span class="hljs-number">_</span> url: URL)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">T</span>, <span class="hljs-type">Error</span>&gt; {
                   <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>: url)             <span class="hljs-comment">// 1</span>
                    .<span class="hljs-built_in">map</span> { $<span class="hljs-number">0</span>.data}                                          <span class="hljs-comment">// 2</span>
                    .decode(type: <span class="hljs-type">T</span>.<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">APIConstants</span>.jsonDecoder) <span class="hljs-comment">// 3</span>
                    .receive(on: <span class="hljs-type">RunLoop</span>.main)                               <span class="hljs-comment">// 4</span>
                    .eraseToAnyPublisher()                                   <span class="hljs-comment">// 5</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies vereinfacht die beiden vorherigen Methoden:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-comment">//   </span>
     <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchArticles</span><span class="hljs-params">(from endpoint: Endpoint)</span></span>
                                     -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Article</span>], <span class="hljs-type">Never</span>&gt; {
         <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = endpoint.absoluteURL <span class="hljs-keyword">else</span> {
                     <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Article</span>]()).eraseToAnyPublisher() <span class="hljs-comment">// 0</span><font></font>
         }<font></font>
         <span class="hljs-keyword">return</span> fetch(url)                                          <span class="hljs-comment">// 1</span>
             .<span class="hljs-built_in">map</span> { (response: <span class="hljs-type">NewsResponse</span>) -&gt; [<span class="hljs-type">Article</span>] <span class="hljs-keyword">in</span>        <span class="hljs-comment">// 2</span>
                             <span class="hljs-keyword">return</span> response.articles }<font></font>
                .replaceError(with: [<span class="hljs-type">Article</span>]())                    <span class="hljs-comment">// 3</span>
                .eraseToAnyPublisher()                              <span class="hljs-comment">// 4</span><font></font>
     }<font></font>
    <font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchSources</span><span class="hljs-params">(<span class="hljs-keyword">for</span> country: String)</span></span>
                                       -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Source</span>], <span class="hljs-type">Never</span>&gt; {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = <span class="hljs-type">Endpoint</span>.sources(country: country).absoluteURL
            <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Source</span>]()).eraseToAnyPublisher() <span class="hljs-comment">// 0</span><font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> fetch(url)                                         <span class="hljs-comment">// 1</span>
            .<span class="hljs-built_in">map</span> { (response: <span class="hljs-type">SourcesResponse</span>) -&gt; [<span class="hljs-type">Source</span>] <span class="hljs-keyword">in</span>     <span class="hljs-comment">// 2</span><font></font>
                            response.sources }<font></font>
               .replaceError(with: [<span class="hljs-type">Source</span>]())                    <span class="hljs-comment">// 3</span>
               .eraseToAnyPublisher()                             <span class="hljs-comment">// 4</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die so erhaltenen "Verlage" liefern nichts, bis jemand sie "abonniert". </font><font style="vertical-align: inherit;">Wir können dies beim Entwerfen tun </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Verlage" </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wie </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code> SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Liste der Artikel.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun ein wenig über die Logik des Funktionierens </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;einzige Abstraktion der „externen Änderungen“, auf die sie reagieren, </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sind die „Herausgeber“ </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Unter „externen Änderungen“ können Sie einen Timer </font></font><code> Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, eine Benachrichtigung mit </font></font><code>NotificationCenter </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder Ihr Modellobjekt </font><font style="vertical-align: inherit;">verstehen </font><font style="vertical-align: inherit;">, das mithilfe des Protokolls </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in eine externe einzelne „Quelle der Wahrheit“ umgewandelt werden kann.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu gewöhnlichen "Verlegern" geben </font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>NotificationCenter</code> <code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reagieren mit der Methode </font></font><code>onReceive (_: perform:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ein Beispiel für die Verwendung des "Herausgebers" werden </font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir später im dritten Artikel über die Erstellung einer Anwendung für </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vorstellen </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel konzentrieren wir uns darauf, wie wir unser Modell für erstellen&nbsp;</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">externe "Quelle der Wahrheit" (Quelle der Wahrheit). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns zunächst an, wie die </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resultierenden „Herausgeber“ in einem bestimmten Beispiel für die Anzeige verschiedener Arten von Artikeln funktionieren sollten: </font></font><br>
<br>
<code>.topHeadLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- die neuesten Nachrichten,&nbsp; </font></font><code>.articlesFromCategory(_ category: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- Nachrichten für eine bestimmte Kategorie, </font></font><code>&nbsp;.articlesFromSource(_ source: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- Nachrichten für eine bestimmte Informationsquelle, </font></font><code>.search (searchFilter: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- Nachrichten, die von einer bestimmten Bedingung ausgewählt wurden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/ua/uv/zruauv9msu2nulm2ksuflhtxusi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je nachdem, welchen </font></font><code> Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzer Sie </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auswählen </font><font style="vertical-align: inherit;">, müssen wir die Liste der </font><font style="vertical-align: inherit;">von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausgewählten </font><font style="vertical-align: inherit;">Artikel </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">aktualisieren</font></a><font style="vertical-align: inherit;"> . Zu diesem Zweck erstellen wir eine sehr einfache Klasse </font></font><code>&nbsp;ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die ein Protokoll </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;mit drei&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften </font><font style="vertical-align: inherit;">implementiert </font><font style="vertical-align: inherit;">:</font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/webt/ty/xj/cs/tyxjcsfctbxerl9oiyr6ljvda8c.png"><br>
<br>
<ul>
<li><code>@Published var indexEndpoint: Int</code> —   <code>Endpoint</code> (    «»,        <code>View</code>),&nbsp;&nbsp;</li>
<li><code>@Published var searchString: String</code> —  ,             &nbsp;&nbsp;(     «»,        <code>View</code>&nbsp;    <code>TextField</code>),</li>
<li><code>@Published var articles: [Article]</code>&nbsp;-    ( «»,          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NewsAPI.org</a>,  «»).</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobald wir </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Eigenschaften </font></font><code>indexEndpoint&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font><font style="vertical-align: inherit;">festlegen&nbsp; </font></font><code> searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, können wir sie sowohl als einfache Eigenschaften&nbsp; </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;als&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auch als "Herausgeber"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und verwenden&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einer Klasse&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">können Sie nicht nur die für uns interessanten Eigenschaften deklarieren, sondern auch die Geschäftslogik ihrer Interaktion vorschreiben. Zu diesem Zweck </font><font style="vertical-align: inherit;">können wir </font><font style="vertical-align: inherit;">beim Initialisieren einer Instanz einer Klasse&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;in </font></font><code>init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein "Abonnement" erstellen, das über den gesamten "Lebenszyklus" der Instanz der Klasse wirkt&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die Abhängigkeit der Artikelliste vom </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Index </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und </font><font style="vertical-align: inherit;">der Suchzeichenfolge&nbsp; </font><font style="vertical-align: inherit;">reproduziert </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dazu </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erweitern wir die Kette der "Publisher" </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geben "Publisher" aus.</font></font><code>AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deren Wert ist eine Liste von Artikeln&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dann "abonnieren" wir es mit dem Operator </font></font><code>assign&nbsp;(to: \.articles, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und erhalten die Liste der Artikel, die wir </font></font><code>articles </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">als "Ausgabe"&nbsp; </font><font style="vertical-align: inherit;">-Eigenschaft benötigen </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;, die definiert </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir müssen die Kette NICHT einfach aus den Eigenschaften&nbsp; </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nämlich aus den "Publishern" ziehen </font></font><code> $indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die an der Erstellung </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit teilnehmen, </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und wir werden sie dort mit den Elementen der Benutzeroberfläche </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">ändern&nbsp; </font></font><code>TextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie machen wir das? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben bereits eine Funktion in unserem Arsenal </font></font><code>fetchArticles (from: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die sich in der Klasse befindet&nbsp; </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">je nach Wert </font><font style="vertical-align: inherit;">einen "Herausgeber" zurückgibt</font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und wir können die Werte der "Herausgeber" nur irgendwie nutzen&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sie in ein Argument für </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diese Funktion </font><font style="vertical-align: inherit;">verwandeln </font><font style="vertical-align: inherit;">.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kombinieren Sie zunächst die "Verlage"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dazu </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">existiert </font><font style="vertical-align: inherit;">der </font><font style="vertical-align: inherit;">Operator </font></font><code>Publishers.CombineLatest </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ci/pg/wd/cipgwdfx2fxmlevrmkf8nnkc6u4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um einen neuen "Publisher" basierend auf den vom vorherigen "Publisher" empfangenen Daten zu erstellen </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;, wird der Operator verwendet&nbsp; </font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ln/s7/ur/lns7urzc9l64o8mswhliuggsyp4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes "abonnieren" wir diesen neu empfangenen "Publisher" mit einem sehr einfachen "Abonnenten"&nbsp; </font></font><code>assign (to: \.articles, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und weisen den empfangenen von " Publisher "-Wert für das&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Array&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/su/io/xi/suioxibgc3t31oewzgkbfaljina.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben gerade einen </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASYNCHRONOUS" Publisher "erstellt und ihn als Ergebnis von" abonniert "</font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Abonnement" und dies ist leicht zu überprüfen, wenn wir unser "Abonnement" konstant halten </font></font><code>let subscription</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/ig/ml/gwigml-zqpprclh76lzfnjhvzda.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Haupteigenschaft eines </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Abonnements" ist, dass der von ihm belegte Speicher automatisch freigegeben wird, sobald es seinen Gültigkeitsbereich verlässt. Daher wird </font></font><code>init( ) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieses "Abonnement" gelöscht </font></font><code>ARC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">sobald es </font><font style="vertical-align: inherit;">abgeschlossen ist </font><font style="vertical-align: inherit;">, ohne Zeit zu haben, die empfangenen asynchronen Informationen mit einer Zeitverzögerung dem Array zuzuweisen </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Asynchrone Informationen können im wörtlichen Sinne einfach nirgendwo "landen", "die Erde ist unter ihren Füßen hervorgegangen". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um ein solches "Abonnement" zu speichern, muss eine </font></font><code> init() </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variable </font><font style="vertical-align: inherit;">jenseits des Initialisierers erstellt werden </font></font><code>var&nbsp;cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die unser </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Abonnement" während des gesamten "Lebenszyklus" der Klasseninstanz in dieser Variablen&nbsp;  </font><font style="vertical-align: inherit;">behält&nbsp; </font></font><code>ArticlesViewMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher entfernen wir die Konstante </font></font><code>let subscription</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und merken uns unser </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Abonnement" in der Variablen&nbsp; </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mithilfe des Operators </font></font><code>.store ( in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/gt/xw/mygtxwz7uhcurfyfnblva9irfku.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Abonnement" für den ASYNCHRONOUS "Publisher", in dem wir erstellt </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haben, bleibt während des gesamten "Lebenszyklus" der Klasseninstanz erhalten&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir können die Bedeutung von "Herausgeber" </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und / oder&nbsp; </font><font style="vertical-align: inherit;">willkürlich ändern&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und dank des erstellten "Abonnements" immer eine Reihe von Artikeln haben, die den Werten dieser beiden Herausgeber&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ohne zusätzlichen Aufwand entsprechen. Diese&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klasse wird normalerweise aufgerufen&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Anzahl der Aufrufe des Servers beim Eingeben einer Suchzeichenfolge zu verringern </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sollten wir nicht den "Herausgeber" der Suchzeichenfolge selbst verwenden&nbsp;</font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und seine modifizierte Version </font></font><code>validString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/ir/2z/khir2z1rrmou-hks2rtfuq31bnm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir nun </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unsere Artikel haben, beginnen </font><font style="vertical-align: inherit;">wir mit der </font><font style="vertical-align: inherit;">Erstellung der Benutzeroberfläche ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Bei </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Synchronisierung </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Modell wird eine </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variable </font><font style="vertical-align: inherit;">verwendet </font><font style="vertical-align: inherit;">, die auf eine Instanz der Klasse dieses Modells verweist. Dieses Paar - die&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Klasse und die&nbsp; </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variable, die auf die Instanz dieser Klasse verweisen - steuert die Änderung in der Benutzeroberfläche ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) in&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir fügen der Struktur eine </font></font><code>ContentView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Instanz der Klasse </font></font><code>ArticleViewModel </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Form einer Variablen hinzu </font></font><code>var articleViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und ersetzen sie </font></font><code>Text ("Hello, World!")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durch eine Liste von Artikeln, </font></font><code>ArticlesList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in die wir die Artikel&nbsp; </font></font><code>articlesViewModel.articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aus unserer </font><font style="vertical-align: inherit;">Liste </font><font style="vertical-align: inherit;">einfügen&nbsp;</font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Als Ergebnis erhalten wir eine Liste von Artikeln für einen festen und einen Standardindex, dh&nbsp; </font></font><code>indexEndpoint = 0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für die </font></font><code>.topHeadLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;neuesten Nachrichten: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/je/_f/j-/je_fj-0m2xews-ih7vptprkdpoy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie unserem Bildschirm ein </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Element hinzu, </font><font style="vertical-align: inherit;">um&nbsp; </font><font style="vertical-align: inherit;">zu steuern, welche Artikelgruppe angezeigt werden soll. Wir werden die&nbsp; </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indexänderung verwenden </font></font><code>$articlesViewModel.indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Das Vorhandensein eines Symbols ist&nbsp; </font></font><code>$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligatorisch, da dies eine Änderung des vom </font></font><code>@Published&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Herausgeber" angegebenen </font><font style="vertical-align: inherit;">Werts bedeutet&nbsp; </font><font style="vertical-align: inherit;">. Das "Abonnement" für diesen "Herausgeber" wird sofort ausgelöst, worauf wir uns eingelassen </font></font><code>init ()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haben. Die "Ausgabe"&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Herausgeber" </font></font><code>&nbsp;articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ändert sich und es wird eine andere Liste von Artikeln auf dem Bildschirm angezeigt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zx/sd/pp/zxsdppfkp5y0nuk-j99uhovvmu8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diese Weise können wir Arrays von Artikeln für alle drei Optionen empfangen - "topHeadLines", "Suche" "Und" aus der Kategorie ":</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jm/yc/a_/jmyca_mvm0n2___cswvcamuuqqm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... aber für eine feste und standardmäßige Suchzeichenfolge </font></font><code>searchString = "sports"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(wo erforderlich): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zq/pi/tw/zqpitwdhh3fsnciz9p2scvn1sas.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Option müssen&nbsp; </font></font><code>"search"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Sie dem Benutzer jedoch ein Textfeld </font></font><code>SearchView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zur Eingabe der Suchzeichenfolge zur Verfügung stellen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xk/d1/uu/xkd1uu0tmepthmsjlkzu--wlwse.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen kann der Benutzer anhand der eingegebenen Suchzeichenfolge nach Nachrichten suchen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x4/ch/5a/x4ch5apliuwesqxjzeds58ab1t8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Option&nbsp; </font></font><code>"from category"&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss der Benutzer angegeben werden die Möglichkeit , </font><font style="vertical-align: inherit;">eine Kategorie zu wählen , </font><font style="vertical-align: inherit;">und wir beginnen mit der </font><font style="vertical-align: inherit;">Kategorie </font></font><code>science</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2i/8e/3v/2i8e3vvly1r_ipfuflxwbtepglq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
als Ergebnis kann der Benutzer für jede Nachricht von der gewählten Kategorie der Nachrichten suchen - </font></font><code>science</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code> health</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,&nbsp; </font></font><code>business</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>technology</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p_/pn/li/p_pnli0chxenoalmms3ltch-iwo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
wir können sehen , </font><font style="vertical-align: inherit;">wie ein sehr einfaches&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Modell , </font><font style="vertical-align: inherit;">das zwei benutzergesteuerte hat </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionen - </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und</font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Ermöglicht die Auswahl einer Vielzahl von Informationen auf der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Website&nbsp; </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste der Informationsquellen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns an, wie der </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;„Herausgeber“ der in der NewsAPI-Klasse empfangenen Informationsquellen funktioniert </font></font><code>fetchSources (for country: String)&nbsp;-&gt; AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir erhalten eine Liste mit Informationsquellen für verschiedene Länder: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hr/oh/le/hrohle3hq8pkyhnjf6frali7yao.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... und die Möglichkeit, nach Namen zu suchen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kg/ea/ll/kgeallzwaxnkvekct18th7knkyo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... sowie detaillierte Informationen über die ausgewählte Quelle: Name, Kategorie, Land, Kurzbeschreibung und Link zur Website:&nbsp; </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k_/b7/9w/k_b79wirynz07feigtlhgdeyik4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie auf den Link klicken, gelangen Sie zu deren Website Informationsquelle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit dies alles funktioniert, benötigen Sie ein extrem einfaches&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modell mit nur zwei benutzergesteuerten </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften - </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und&nbsp; </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/id/4b/rsid4bb5xmkjdkwuptkmwvhi-yc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wieder verwenden wir dasselbe Schema: beim Initialisieren einer Instanz einer </font></font><code>SourcesViewModel </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassenklasse in</font></font><code> init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir erstellen ein "Abonnement", das während des gesamten "Lebenszyklus" der Klasseninstanz funktioniert, </font></font><code>&nbsp;SourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und stellen sicher, dass die Liste der Informationsquellen vom </font></font><code>sources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Land&nbsp; </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und der Suchzeichenfolge </font><font style="vertical-align: inherit;">abhängt&nbsp; </font></font><code>&nbsp;searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit der Hilfe&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ziehen wir die Kette von den "Herausgebern" </font></font><code>$searchString </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>$country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geben "Herausgeber" aus </font></font><code>AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dessen Wert eine Liste von Informationsquellen ist. Wir "abonnieren" es mit dem Operator </font></font><code>assign&nbsp;(to: \.sources, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wir erhalten die Liste der Informationsquellen, die wir benötigen&nbsp; </font></font><code>sources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. und merken Sie sich das empfangene&nbsp; </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Abonnement" in einer Variablen&nbsp; </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem Operator </font></font><code>.store ( in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir nun </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unsere Informationsquellen zur Verfügung haben, können </font><font style="vertical-align: inherit;">wir mit der </font><font style="vertical-align: inherit;">Erstellung beginnen </font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. B </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zu synchronisieren </font></font><code> View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Das Modell verwendet eine </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variable, die auf eine Instanz der Klasse dieses Modells verweist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie der Struktur die&nbsp; </font></font><code>ContentViewSources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Klasseninstanz </font></font><code>SourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Form einer Variablen hinzu </font></font><code>var sourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, entfernen Sie sie&nbsp; </font></font><code>Text ("Hello, World!")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und platzieren Sie Ihre eigene </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für jede der drei&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften </font></font><code>&nbsp;sourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;:</font></font><br>
<br>
&nbsp;<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Textfeld&nbsp; </font></font><code>SearchView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für die Suchleiste&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li>&nbsp;<code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;für das Land </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste&nbsp; </font></font><code>SourcesList&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Informationsquellen</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/td/tk/kn/tdtkknev57l3b5avb8y0uheu7fa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis erhalten wir, was wir brauchen </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jw/gg/ly/jwgglycniqr2e-jhpifypfzx4m8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diesem Bildschirm verwalten wir die Suchzeichenfolge nur über das Textfeld </font></font><code>SearchView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und das "Land" mit&nbsp; </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und der Rest geschieht AUTOMATISCH. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Liste der Informationsquellen </font></font><code>SourcesList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthält nur minimale Informationen zu jeder Quelle - den Namen </font></font><code>source.name </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und eine kurze Beschreibung </font></font><code>source.description</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sj/zi/1z/sjzi1zh-7leadeujwarkuka_ii8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... Sie können jedoch über den Link, </font></font><code>NavigationLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in dem </font></font><code>destination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir angeben,&nbsp; </font></font><code>DetailSourceView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">welche Quelldaten die Informationsquelle&nbsp; </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die gewünschte Instanz der Klasse sind </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">detailliertere Informationen über die ausgewählte Quelle erhalten </font><font style="vertical-align: inherit;">Holen Sie sich eine Liste seiner Artikel </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/j_/uh/ixj_uheqhclwopwidsihztunn5e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sehen Sie, wie elegant wir die Liste der Artikel für die ausgewählte Informationsquelle in der Liste der Quellen erhalten&nbsp; </font></font><code>SourcesList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Unser alter Freund hilft uns - eine Klasse,&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für die wir beide "Eingabe" </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Eigenschaften </font><font style="vertical-align: inherit;">festlegen müssen&nbsp; </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Index&nbsp; </font></font><code>indexEndpoint = 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dh eine Option&nbsp; </font></font><code>.articlesFromSource (_source:String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die der Auswahl von Artikeln für eine feste Quelle entspricht </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeichenfolge&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;als Quelle selbst (oder vielmehr als Kennung) </font></font><code>source.id&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/ia/xi/lr/iaxilr4rlcyippxuvkbd46kequ4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie sich die gesamte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsApp-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anwendung </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">ansehen</font></a><font style="vertical-align: inherit;"> , werden Sie </font><font style="vertical-align: inherit;">im Allgemeinen </font><font style="vertical-align: inherit;">nirgendwo </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">feststellen</font></a><font style="vertical-align: inherit;"> , dass wir ausdrücklich eine Auswahl von Artikeln oder Informationsquellen von der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Website&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">anfordern</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir verwalten nur </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Daten, erledigen </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aber unsere Aufgabe: </font><font style="vertical-align: inherit;">Wir&nbsp; </font><font style="vertical-align: inherit;">wählen die Artikel und Informationsquellen aus, die wir benötigen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bild </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für Artikel </font><font style="vertical-align: inherit;">herunterladen </font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Modell des Artikels&nbsp; </font></font><code>Article&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthält ein </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dazugehöriges Bild&nbsp; </font></font><code>urlToImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/ny/fv/omnyfvhlcegrhltunqvjvyaq6l4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf dieser Grundlage&nbsp; </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">müssen wir in Zukunft die Bilder selbst </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;von der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Website&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">beziehen</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sind mit dieser Aufgabe bereits vertraut. </font><font style="vertical-align: inherit;">Erstellen Sie </font><font style="vertical-align: inherit;">in der Klasse </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mithilfe der Funktion </font></font><code>fetchImage(for url: URL?) -&gt; AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen „Herausgeber“&nbsp;  </font></font><code>AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem Bildwert&nbsp; </font></font><code>UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und ohne Fehler&nbsp; </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(wenn tatsächlich Fehler auftreten, wird das Bild zurückgegeben </font></font><code> nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Sie können diesen "Herausgeber" "abonnieren", um Bilder&nbsp; </font></font><code>UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;beim Entwerfen der Benutzeroberfläche ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) zu erhalten. </font><font style="vertical-align: inherit;">Die Quelldaten für die Funktion </font></font><code>fetchImage(for url: URL?)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sind&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die wir haben:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/do/a-/hg/doa-hg5idk0ukdghj0snu0-nubm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns im Detail überlegen, wie die Gründung mit Hilfe des </font></font><code> Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Herausgebers" </font><font style="vertical-align: inherit;">abläuft </font></font><code>AnyPublisher &lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wenn wir wissen </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wenn </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gleich </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kehre zurück </font></font><code>Just(nil)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basierend auf der </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Form des "Herausgebers" </font></font><code>dataTaskPublisher(for:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dessen Ausgabewert </font></font><code>Output</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein Tupel </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und ein Fehler ist </font></font><code>&nbsp;Failure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-&nbsp; </font></font><code>URLError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir nehmen </font><font style="vertical-align: inherit;">nur Daten </font></font><code>map {}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aus dem Tupel </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zur weiteren Verarbeitung&nbsp; </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Form </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn bei den vorherigen Schritten ein Rückgabefehler auftritt </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir liefern das Ergebnis an den </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stream, da wir davon ausgehen, dass es im Design weiter verwendet </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Löschen" Sie den TYP des "Herausgebers" und geben Sie die Kopie zurück </font></font><code>AnyPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie sehen, dass der Code ziemlich kompakt und gut lesbar ist, es gibt keine </font></font><code>callbacks</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit der Erstellung&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;für das Bild </font></font><code>UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies ist eine Klasse </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die das Protokoll </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit zwei&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften </font><font style="vertical-align: inherit;">implementiert </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><code>@Published url: URL?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;sind </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bilder</font></font></li>
<li><code>@Published var image: UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ist das Bild selbst von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/li/o6/kr/lio6krhn0v1eyeiwg_cgpwcigia.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wieder </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;müssen wir </font><font style="vertical-align: inherit;">beim Initialisieren einer Instanz der Klasse&nbsp; </font><font style="vertical-align: inherit;">die Kette von der Eingabe "Herausgeber" </font></font><code>$url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;zur Ausgabe "Herausgeber" </font><font style="vertical-align: inherit;">strecken&nbsp; </font></font><code>AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die wir später </font><font style="vertical-align: inherit;">&nbsp;"abonnieren" </font><font style="vertical-align: inherit;">und das Bild erhalten, das wir benötigen </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/gi/2s/bagi2swivajzz0pkgqzzsswudww.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir verwenden den Operator </font></font><code>&nbsp;flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und einen sehr einfachen "Abonnenten"&nbsp; </font></font><code>assign (to: \image, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um sie dem vom "Herausgeber" empfangenen zuzuweisen. "Werte für die Eigenschaft </font></font><code>@Published image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eq/3k/4-/eq3k4-0pbruhk4qbcu8hmyinfmg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wieder in der Variablen&nbsp; </font><font style="vertical-align: inherit;">" Abonnement "wird mit dem Operator&nbsp; </font></font><code>cancellableSet </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gespeichert </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Die Logik dieses „Bild-Downloaders“ besteht darin, dass Sie ein Bild von etwas anderem als dem herunterladen, </font><font style="vertical-align: inherit;">sofern es nicht vorgeladen wurde</font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"></font><code>store(in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code> nil URL</code><font style="vertical-align: inherit;"></font><code>image == nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn während des Downloadvorgangs ein Fehler festgestellt wird, fehlt das Bild, dh es </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bleibt gleich </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zeigen wir das Bild mit Hilfe </font></font><code>ArticleImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die eine Instanz der </font></font><code>imageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Klasse dafür </font><font style="vertical-align: inherit;">verwendet </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn sein Bild nicht gleich ist </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wird es mit angezeigt </font></font><code> Image (...)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber wenn es gleich ist </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wird je nachdem, was gleich ist </font></font><code>url </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, entweder nichts angezeigt </font></font><code>EmptyView()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder ein Rechteck </font></font><code>Rectangle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit rotierendem Text T wird </font><font style="vertical-align: inherit;">angezeigt </font></font><code>ext("Loading...")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mh/nq/yi/mhnqyirurke0w6yibfxm86gap1i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Logik funktioniert für den Fall einwandfrei wenn Sie sicher wissen, dass für&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, außer&nbsp; </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie erhalten ein Bild </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wie es bei der Filmdatenbank der Fall ist&nbsp;</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMDb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org ist der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregator&nbsp; </font><font style="vertical-align: inherit;">&nbsp; anders. Die Artikel einiger Informationsquellen unterscheiden sich vom&nbsp; </font></font><code>nil&nbsp;URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bild, aber der Zugriff darauf ist geschlossen, und wir erhalten ein Rechteck </font></font><code>Rectangle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit rotierendem Text </font></font><code>Text("Loading...")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, das niemals ersetzt wird: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sh/tq/lp/shtqlpz4wx-iobt19-wv9j2pb7w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn sich das </font></font><code>&nbsp;URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bild </font><font style="vertical-align: inherit;">in dieser Situation von dem </font><font style="vertical-align: inherit;">Bild unterscheidet&nbsp; </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kann die Gleichheit des&nbsp; </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bildes&nbsp; </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bedeuten, dass das Bild geladen wird und die Tatsache, dass beim Laden ein Fehler aufgetreten ist und wir nie ein Bild erhalten </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Um zwischen diesen beiden Situationen zu unterscheiden, fügen wir </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;den beiden vorhandenen </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften </font><font style="vertical-align: inherit;">in der Klasse&nbsp; </font><font style="vertical-align: inherit;">eine weitere hinzu:&nbsp;</font></font><br>
<br>
<code>&nbsp;@Published var noData = false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- Dies ist ein boolescher Wert, mit dem wir das Fehlen von Bilddaten aufgrund eines Fehlers bei der Auswahl anzeigen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kp/jc/sq/kpjcsqugrsfzyghmefnge0unscy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Erstellen eines „Abonnements“ </font><font style="vertical-align: inherit;">erfassen </font><font style="vertical-align: inherit;">wir </font></font><code> init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alle Fehler </font></font><code> Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die beim Laden des Bildes auftreten, und akkumulieren deren Vorhandensein in der&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaft </font></font><code>self.noData = true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn der Download erfolgreich war, erhalten wir das Bild </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Wir erstellen den </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Publisher"&nbsp; </font></font><code>AnyPublisher&lt;UIImage?, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;auf der Grundlage der&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Funktion </font></font><code>fetchImageErr (for url: URL?)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7f/ek/jf/7fekjfrbihaieypuxaovub1-op8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir beginnen die Erstellung der Methode </font></font><code>fetchImageErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit der Initialisierung des "Publishers"&nbsp; </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mit dem ein einzelner TYPE-Wert </font></font><code>Result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mithilfe eines Abschlusses </font><font style="vertical-align: inherit;">asynchron abgerufen werden kann </font><font style="vertical-align: inherit;">. Der Abschluss hat einen Parameter - </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der eine Funktion von TYPE ist&nbsp; </font></font><code>(Result&lt;Output, Failure&gt;) → Void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Wir werden das </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/ch/_u/iuch_uvhdkz42-mfyuiuq3jiosg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ergebnis </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in verwandeln</font></font><code>AnyPublisher &lt;UIImage?, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit Hilfe des Operators "TYP löschen" </font></font><code>eraseToAnyPublisher()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes führen wir die folgenden Schritte aus, wobei wir alle möglichen Fehler berücksichtigen (wir werden keine Fehler identifizieren, es ist einfach wichtig zu wissen, dass ein Fehler vorliegt): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0. Prüfen Sie </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und&nbsp; </font></font><code>noData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weiter </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wenn ja, geben Sie den Fehler zurück, wenn nicht, übertragen Sie ihn </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weiter durch Kette, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Erstellen Sie einen "Herausgeber", </font></font><code>dataTaskPublisher(for:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dessen Eingabe - ist </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und der Ausgabewert </font></font><code>Output</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist ein Tupel </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und ein Fehler&nbsp; </font></font><code>URLError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Analysieren Sie mit dem </font></font><code> tryMap { }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;resultierenden Tupel </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wenn es </font></font><code>response.statusCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im Bereich liegt </font></font><code>200...299</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nehmen wir zur weiteren Verarbeitung nur die Daten&nbsp; </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Andernfalls "werfen" wir einen Fehler aus (egal was passiert),</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. werden wir </font></font><code>map { }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Daten konvertieren </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zu </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. liefern das Ergebnis an den </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strom, da wir davon ausgehen , </font><font style="vertical-align: inherit;">dass wir es später im Design verwenden </font></font><code>UI</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - wir „subscribe“ auf den empfangene „Verleger“ mit </font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seinen Schließungen </font></font><code>receiveCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - 5. , </font><font style="vertical-align: inherit;">wenn wir </font></font><code>receiveCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;einen Fehler finden </font><font style="vertical-align: inherit;">in der Schließung&nbsp; </font></font><code>error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wir berichten Verwenden Sie es </font></font><code>promise (.failure(error)))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - 6. im Abschluss&nbsp; </font></font><code>receiveValue </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informieren wir Sie über den erfolgreichen Empfang einer Reihe von Artikeln mit </font></font><code> promise (.success($0))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. wir erinnern uns an das empfangene "Abonnement" in der Variablen&nbsp; </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um deren Lebensfähigkeit innerhalb der "Lebensdauer" der Klasseninstanz sicherzustellen </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8. wir "löschen" den "Herausgeber" -TYP und geben Sie die Instanz zurück </font></font><code>AnyPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir kehren dorthin zurück, </font></font><code>ArticleImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wo wir die neue&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variable verwenden werden </font></font><code>noData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn keine Bilddaten vorhanden sind, werden wir nichts anzeigen, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">dh</font></a></font><code>EmptyView ()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3k/wr/v_/3kwrv_cecjy2f8jea3rgnnpkzri.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende packen wir alle unsere Möglichkeiten zur Anzeige von Daten aus dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregator </font><font style="vertical-align: inherit;">in </font></font><code>TabView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yq/xb/ra/yqxbraupq1d0tgeygy2lb05o4xo.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeigen Sie Fehler beim Abrufen und Dekodieren von JSON-Daten vom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Server an&nbsp; </font><font style="vertical-align: inherit;">.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Zugriff auf den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Server können&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Fehler</font></a><font style="vertical-align: inherit;"> auftreten, z. B. weil Sie den falschen Schlüssel angegeben haben </font></font><code>API-key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder wenn ein Entwicklertarif, der nichts kostet, die zulässige Anzahl von Anforderungen oder etwas anderem überschritten hat. Gleichzeitig </font><font style="vertical-align: inherit;">&nbsp;liefert Ihnen </font><font style="vertical-align: inherit;">der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Server&nbsp; </font><font style="vertical-align: inherit;">den </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code und die entsprechende Meldung: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_f/2n/zv/_f2nzv5bndlu8auo9cygjyk9fta.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Art von </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Serverfehler</font></a><font style="vertical-align: inherit;"> muss behandelt werden. Andernfalls </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerät</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Benutzer Ihrer Anwendung in eine Situation, in der der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NewsAPI.org-</font></a><font style="vertical-align: inherit;"> Server plötzlich ohne Grund die&nbsp; </font><font style="vertical-align: inherit;">&nbsp;Verarbeitung von Anforderungen beendet und der Benutzer mit einem leeren Bildschirm völlig </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">ratlos bleibt</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisher bei der Auswahl von Artikeln&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Informationsquellen&nbsp; </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vom </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NewsAPI.org-</font></a><font style="vertical-align: inherit;"> Server&nbsp;</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;wir ignoriert alle Fehler, und im Falle ihres Auftretens zurück leere Arrays </font></font><code>[Article]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und&nbsp; </font><font style="vertical-align: inherit;">als Folge&nbsp; </font></font><code>[Source]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns zunächst </font></font><code>fetchArticles (from endpoint: Endpoint) -&gt; AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;eine </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;andere Methode </font><font style="vertical-align: inherit;">in der Klasse erstellen </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">die </font><font style="vertical-align: inherit;">auf der vorhandenen </font><font style="vertical-align: inherit;">Artikelauswahlmethode&nbsp; </font><font style="vertical-align: inherit;">basiert und </font></font><code>fetchArticlesErr (from endpoint: Endpoint) -&gt; AnyPublisher&lt;[Article], NewsError&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht nur ein Array von Artikeln </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sondern auch einen möglichen Fehler zurückgibt&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchArticlesErr</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt;
                            <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Article</span>], <span class="hljs-type">NewsError</span>&gt; {<font></font>
<font></font>
. . . . . . . .<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Verfahren sowie die Verfahren </font></font><code>fetchArticles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, akzeptiert </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und gibt den „Verlag“ </font><font style="vertical-align: inherit;">am Eingang </font><font style="vertical-align: inherit;">mit einem Wert in der Form einer Reihe von Artikeln </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sondern das Fehlen eines Fehlers </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">können wir einen Fehler durch die Aufzählung definiert haben </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x9/es/ey/x9eseyq8jbapjkmgdoj7aggc6f0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir eine neue Methode , </font><font style="vertical-align: inherit;">mit der </font><font style="vertical-align: inherit;">Initialisierung des „Publisher“ zu </font><font style="vertical-align: inherit;">schaffen&nbsp; </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, das kann sein Verwenden Sie diese Option, um </font></font><code>Result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mithilfe eines Abschlusses </font><font style="vertical-align: inherit;">asynchron einen einzelnen TYPE-Wert </font><font style="vertical-align: inherit;">abzurufen. </font><font style="vertical-align: inherit;">Der Abschluss hat einen Parameter - </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Funktion von TYPE&nbsp; </font></font><code>(Result&lt;Output, Failure&gt;) -&gt; Void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Wir werden den </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3w/bw/ct/3wbwctuso0qweiz3a8qk_h1aiom.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Empfang </font><font style="vertical-align: inherit;">mit dem Operator "TYPE Erase" </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in den "Publisher" verwandeln, den wir benötigen&nbsp; </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Weiter in der neuen Methode werden </font><font style="vertical-align: inherit;">wir alle Schritte wiederholen, die wir in der Methode unternommen haben&nbsp;</font></font><code>AnyPublisher &lt;[Article], NewsError&gt;</code><font style="vertical-align: inherit;"></font><code>eraseToAnyPublisher()</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>fetchArticlesErr</code><font style="vertical-align: inherit;"></font><code>fetchArticles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber wir werden alle möglichen Fehler berücksichtigen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/xz/i0/pbxzi0rn5-cuandt3rtu74ofj8s.png"><br>
<br>
<ul>
<li>0.   endpoint&nbsp; <code>URL endpoint.absoluteURL </code>    , <code> url </code> <code>nil</code>:  <code>nil</code>,    <code>.urlError</code>,   —  <code>url</code>   ,</li>
<li>1.  «» <code>dataTaskPublisher(for:)</code>,     — <code>url</code>,    <code>Output</code>   <code>(data: Data, response: URLResponse)</code>  &nbsp;<code>URLError</code>,</li>
<li>2.    <code>tryMap { }</code>&nbsp;  <code>(data: Data, response: URLResponse)</code>:  <code>response.statusCode</code>    <code>200...299</code>,       &nbsp;<code>data</code>.    «»  <code>.responseError</code>,  &nbsp;&nbsp;<code>data</code>,    <code>String</code>,    ,</li>
<li>3. <code> JSON</code>    ,   &nbsp;<code>NewsResponse</code>,</li>
<li>4.    <code>main</code> ,         <code>UI</code></li>
<li>«»   «»   <code>sink</code>    <code>receiveCompletion</code>  <code>receiveValue</code>,<br>
 <ul>
<li>5.&nbsp; &nbsp;&nbsp;<code>receiveCompletion</code>&nbsp;  <code>error</code>,       <code>promise (.failure(...)))</code>,</li>
<li> 6.&nbsp;&nbsp;&nbsp;<code>receiveValue</code>         <code>promise (.success($0.articles))</code>,</li>
</ul>&nbsp;</li>
<li>7.&nbsp;  «»  &nbsp;<code>var subscriptions</code>,       « »   <code>NewsAPI</code>,</li>
<li>8. «»  «»    <code>AnyPublisher</code>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu beachten, dass sich der "Herausgeber"&nbsp; </font><font style="vertical-align: inherit;">von seinem Prototyp dadurch </font></font><code>dataTaskPublisher(for:)</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unterscheidet,</font></font></a><font style="vertical-align: inherit;"></font><code>dataTask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass er im Falle eines Serverfehlers, wenn er </font></font><code>response.statusCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;NICHT im Bereich liegt </font></font><code>200...299</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, weiterhin den erfolgreichen Wert in Form eines Tupels </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und keinen Fehler in der Form </font><font style="vertical-align: inherit;">liefert </font></font><code>(Error, URLResponse?)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In diesem Fall sind die tatsächlichen Serverfehlerinformationen in enthalten </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Der "Herausgeber" </font></font><code>dataTaskPublisher(for:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;liefert einen Fehler,&nbsp; </font></font><code>URLError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wenn auf der Clientseite ein Fehler auftritt (Unfähigkeit, den Server zu kontaktieren, Verbot des Sicherheitssystems </font></font><code>ATS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usw.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir Fehler in anzeigen möchten, </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benötigen wir den entsprechenden </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, den wir aufrufen werden&nbsp; </font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/em/1o/qy/em1oqy5ob60o8xzmz_-kpdvzs4a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Klasse </font></font><code>&nbsp;ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die das Protokoll implementiert </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, haben wir diesmal VIER&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaften:</font></font><br>
<br>
<ol>
<li><code>@Published var indexEndpoint: Int</code> —   <code>Endpoint</code> (    «»,     <code> View</code>),&nbsp;</li>
<li><code>@Published var searchString: String</code> —   ,    &nbsp;<code>Endpoint</code>:    «» ,       (      «»,        <code>View</code>),&nbsp;</li>
<li>&nbsp;<code>@Published var articles: [Article]</code>&nbsp;-    ( «»,        &nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NewsAPI.org&nbsp;</a>)</li>
<li>&nbsp;&nbsp;<code>@Published var articlesError: NewsError?</code>&nbsp;-  ,      &nbsp;    &nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NewsAPI.org&nbsp;</a>.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie eine Instanz einer Klasse zu </font><font style="vertical-align: inherit;">initialisieren </font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, müssen wir wieder eine Kette von Eingang „Verlage“ erweitern </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Ausgabe „Verlag“&nbsp; </font></font><code>AnyPublisher&lt;[Article],NewsError&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, auf die wir mit dem „Abonnent“ „unterzeichnet“ </font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und wir haben eine Menge von Artikeln erhalten </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder Fehler&nbsp; </font></font><code>articlesError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserer Klasse haben </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir bereits eine Funktion erstellt&nbsp; </font><font style="vertical-align: inherit;">, die je nach Wert </font></font><code>fetchArticlesErr (from endpoint: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen „Herausgeber“ zurückgibt&nbsp; </font><font style="vertical-align: inherit;">, und wir müssen nur irgendwie die Werte der „Herausgeber“ verwenden&nbsp; </font><font style="vertical-align: inherit;">und&nbsp; </font><font style="vertical-align: inherit;">sie in ein Argument für diese Funktion umwandeln </font><font style="vertical-align: inherit;">.&nbsp; </font><font style="vertical-align: inherit;">
Zunächst werden wir die "Verlage"&nbsp; </font><font style="vertical-align: inherit;">&nbsp;und&nbsp; </font><font style="vertical-align: inherit;">. Dazu </font><font style="vertical-align: inherit;">gibt es einen Operator </font><font style="vertical-align: inherit;">:</font></font><code>AnyPublisher&lt;[Article], NewsError&gt;</code><font style="vertical-align: inherit;"></font><code>endpoint</code><font style="vertical-align: inherit;"></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"></font><code>$searchString</code><font style="vertical-align: inherit;"></font><code>endpoint</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"></font><code>$searchString</code><font style="vertical-align: inherit;"></font><code>Combine</code><font style="vertical-align: inherit;"></font><code>Publishers.CombineLatest</code><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/5i/lz/zh/5ilzzh6h5_aity8uvzd6eladg7q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann müssen wir den Fehlertyp TYPE "publisher" gleich dem erforderlichen setzen&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oe/85/tt/oe85tthmperdfzf6yqiy5fmy2b4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes wollen wir die Funktion&nbsp; </font></font><code>fetchArticlesErr (from endpoint: Endpoint) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aus unserer Klasse verwenden </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wie üblich werden wir dies mit Hilfe eines Betreibers tun&nbsp; </font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der einen neuen "Herausgeber" auf der Grundlage der vom vorherigen "Herausgeber" empfangenen Daten erstellt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bh/bu/kx/bhbukxfbhg2q9otl4rp-ksponec.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann "abonnieren" wir diesen neu empfangenen "Herausgeber" mit Hilfe eines "Abonnenten" </font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und verwenden seine Schließungen </font></font><code>receiveCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um vom „Verlag“ entweder den Wert einer Reihe von Artikeln&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder Fehler zu erhalten </font></font><code>articlesError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cq/x8/iy/cqx8iyvnwanwmv1vselki10ytv4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich muss das resultierende „Abonnement“ in einer externen </font></font><code>init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variablen </font><font style="vertical-align: inherit;">gespeichert </font><font style="vertical-align: inherit;">werden </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Andernfalls können wir den Wert nicht asynchron abrufen</font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder ein Fehler </font></font><code>articlesError </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nach dem </font><font style="vertical-align: inherit;">Abschluss </font></font><code>init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/wh/_a/khwh_ao98y7zy9cdpenc0nzvntq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Anzahl der Anrufe an den Server zu reduzieren , </font><font style="vertical-align: inherit;">wenn eine Suchzeichenfolge eingeben </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sollten wir nicht den „Verlag“ der Suchleiste selbst&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber seine modifizierte Version </font></font><code>validString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fl/op/ss/flopssp-pjixvbtesqabmpp1h2s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
„Abonnieren“ den ASYNCHRONEN „Verlag“ , </font><font style="vertical-align: inherit;">dass wir in der </font><font style="vertical-align: inherit;">geschaffenen </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Willen bestehen während des gesamten „Lebenszyklus“ der Klasseninstanz fort&nbsp; </font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nt/iw/k4/ntiwk4eju6aneam-1wlymjqyu9a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir fahren mit der Korrektur unserer fort </font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um mögliche </font><font style="vertical-align: inherit;">Datenabtastfehler </font><font style="vertical-align: inherit;">darauf anzuzeigen. In </font></font><code>SwiftU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I verwenden wir in der vorhandenen Struktur&nbsp; </font></font><code>ContentVieArticles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;eine andere, die gerade erhalten wurde&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und fügen dem Namen nur die Buchstaben „Err“ hinzu. Dies ist eine Instanz der Klasse.&nbsp;&nbsp;</font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der den Fehler beim Auswählen und / oder Dekodieren von Artikeldaten vom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Server „ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">abfängt“</font></a><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kw/vy/uv/kwvyuvbthb08tcalkcdpnucqfbq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Außerdem fügen wir </font><font style="vertical-align: inherit;">im&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Fehlerfall</font></a><font style="vertical-align: inherit;"> die Anzeige einer Notfallnachricht hinzu&nbsp; </font></font><code>Alert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Beispiel, wenn der falsche API-Schlüssel lautet:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">APIConstants</span> </span>{
    <span class="hljs-comment">// News  API key url: https://newsapi.org</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> apiKey: <span class="hljs-type">String</span> = <span class="hljs-string">"API_KEY"</span> <font></font>
    <font></font>
   .  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... dann erhalten wir folgende Meldung: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nb/ws/si/nbwssihj8ldlqqtcbti4tjwcv7o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Anforderungslimit erschöpft ist, erhalten wir </font><font style="vertical-align: inherit;">folgende Meldung: </font><font style="vertical-align: inherit;">Wenn wir </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cz/de/ux/czdeuxquiscc-6qklciy5a0w3jm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
zur Methode der Artikelauswahl&nbsp; </font></font><code>[Article] </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einem möglichen Fehler zurückkehren&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, können wir den Code vereinfachen, wenn wir den&nbsp; </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;"Herausgeber" verwenden </font></font><code>AnyPublisher&lt;T,NewsError&gt;,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen </font><font style="vertical-align: inherit;">basierend auf dem Satz&nbsp; </font><font style="vertical-align: inherit;">asynchron empfängt </font><font style="vertical-align: inherit;">und direkt platziert im </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modell </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;und meldet einen Fehler&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lc/v7/m9/lcv7m9fmdbq20ih5phivj7hl1go.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie wir wissen, ist dieser Code sehr einfach zu verwenden, um einen bestimmten „Herausgeber“ zu erhalten, wenn die Quelldaten für </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NewsAPI.org-</font></a></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregator </font><font style="vertical-align: inherit;">&nbsp;oder&nbsp; </font><font style="vertical-align: inherit;">ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenland sind&nbsp;</font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Informationsquelle, und die Ausgabe erfordert verschiedene Modelle - zum Beispiel eine Liste von Artikeln oder Informationsquellen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ig/ff/4q/igff4qjqmxcxloixsshjbc36uxy.png"><br>
<br>
<img src="https://habrastorage.org/webt/bh/o_/7n/bho_7nbyxpl5yxth1ihweasjbec.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben gelernt , </font><font style="vertical-align: inherit;">wie einfach es zu erfüllen ist </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anforderungen mit Hilfe </font></font><code> Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seiner </font></font><code>URLSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„Herausgeber“ </font></font><code>dataTaskPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn Sie keine Fehler nachverfolgen müssen, erhalten Sie einen sehr einfachen </font></font><code> Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5-zeiligen Code für den "Herausgeber" </font></font><code>AnyPublisher&lt;T, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der </font></font><code>JSON </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen </font><font style="vertical-align: inherit;">asynchron empfängt </font><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">&nbsp;basierend auf den folgenden </font><font style="vertical-align: inherit;">Angaben direkt in das </font></font><code>Codable </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modell </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einfügt&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2i/r_/6w/2ir_6wkuga1u9jcxsmqijle480e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Code ist sehr einfach zu verwenden, um einen bestimmten Herausgeber abzurufen, wenn die Quelldaten Folgendes </font></font><code>url </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sind: Zum Beispiel </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erfordert die Ausgabe verschiedene Modelle - zum Beispiel eine Reihe von Artikeln oder eine Liste von Informationsquellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Fehler berücksichtigen müssen, ist der Code für den&nbsp; </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Herausgeber" etwas komplizierter, aber dennoch ein sehr einfacher Code ohne Rückrufe:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fi/4d/ep/fi4depxf-hbngki4p5y3ktunbny.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Können </font><font style="vertical-align: inherit;">Sie </font><font style="vertical-align: inherit;">
mithilfe der Technologie der </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abfrageausführung mithilfe </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen "Herausgeber" erstellen </font></font><code>AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der asynchron Daten auswählt und ein UIImage-Image empfängt? basierend auf </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Bild- </font></font><code>ImageLoade</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Downloader r werden im Speicher zwischengespeichert, um ein wiederholtes asynchrones Abrufen von Daten zu vermeiden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle Arten von "Publishern", die Sie erhalten, können sehr einfach in ObservableObject-Klassen "zum Arbeiten gebracht" werden, die ihre @ Publishing-Eigenschaften verwenden, um Ihre mit SwiftUI entworfene Benutzeroberfläche zu steuern. Diese Klassen spielen normalerweise die Rolle des Ansichtsmodells, da sie die sogenannten @ input @ -Published-Eigenschaften haben, die den aktiven UI-Elementen (TextField, Stepper, Picker-Textfelder, Optionsfelder zum Umschalten usw.) und den @Published-Ausgabeeigenschaften entsprechen </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Idee durchdringt die gesamte </font><font style="vertical-align: inherit;">in diesem Artikel vorgestellte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregator- </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Anwendung</font></a><font style="vertical-align: inherit;"> . Es stellte sich heraus, dass dies </font><font style="vertical-align: inherit;">aus passiven UI-Elementen ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Texttexten, Bildbildern,</font></a><font style="vertical-align: inherit;"> geometrischen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Kreisformen</font></a><font style="vertical-align: inherit;"> (), Rechteck () usw.) besteht </font><font style="vertical-align: inherit;">ziemlich universell und wurde verwendet, wenn</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklung einer Anwendung für die </font></font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMDb </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">- </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Filmdatenbank</font></a><font style="vertical-align: inherit;"> und den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachrichtenaggregator&nbsp; </font><font style="vertical-align: inherit;">, die in zukünftigen Artikeln behandelt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Anwendungscode für diesen Artikel befindet sich auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Ich möchte Ihre Aufmerksamkeit auf die Tatsache lenken, dass Sie wissen, dass </font></font><code>NavigationLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Simulator mit einem Fehler arbeitet </font><font style="vertical-align: inherit;">, wenn Sie den Simulator für die in diesem Artikel vorgestellte Anwendung verwenden </font><font style="vertical-align: inherit;">. Sie können verwenden</font></font><code>NavigationLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf dem Simulator nur 1 Mal. </font><font style="vertical-align: inherit;">Jene. </font><font style="vertical-align: inherit;">Sie haben den Link verwendet, sind zurückgegangen, haben auf denselben Link geklickt - und nichts passiert. </font><font style="vertical-align: inherit;">Bis Sie einen anderen Link verwenden, funktioniert der erste nicht, der zweite ist jedoch nicht mehr zugänglich. </font><font style="vertical-align: inherit;">Dies wird aber nur am Simulator beobachtet, auf einem realen Gerät funktioniert alles einwandfrei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Einige Informationsquellen verwenden </font></font><code>http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stattdessen </font></font><code>https</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noch "Bilder" ihrer Artikel. </font><font style="vertical-align: inherit;">Wenn Sie diese „Bilder“ definitiv sehen möchten, aber die Quelle ihres Erscheinungsbilds nicht steuern können, müssen Sie das Sicherheitssystem so konfigurieren </font></font><code>ATS ( App Transport Security)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dass diese </font></font><code>http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„Bilder“ </font><font style="vertical-align: inherit;">empfangen werden. Dies </font><font style="vertical-align: inherit;">ist jedoch natürlich keine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gute Idee</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sie können </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sicherere Optionen verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verweise:</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">    HTTP   Swift 5   Combine     SwiftUI.  1 .</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Modern Networking in Swift 5 with URLSession, Combine and Codable.</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">URLSession.DataTaskPublisher’s failure type</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Combine: Asynchronous Programming with Swift</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">«SwiftUI &amp; Combine:  »</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Introducing Combine — WWDC 2019 — Videos — Apple Developer. session 722</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(  722 «  Combine»   )</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Combine in Practice — WWDC 2019 — Videos — Apple Developer. session 721</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(  721 «  Combine»   )</a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488428/index.html">Wie prognostizieren wir die Zukunft bei der Yandex-Suche: von Fehlerkorrekturen bis zu Erkennungsabfragen</a></li>
<li><a href="../de488432/index.html">Snoop Project ist ein unglaubliches Tool für Internet Intelligence, auf das RuNet-Benutzer so lange gewartet haben</a></li>
<li><a href="../de488436/index.html">Erstellen Sie schnell Open-Source-Chiptune-Musik</a></li>
<li><a href="../de488438/index.html">Die Geschichte der Film-Audioformate: Die deutsche Antwort auf Kompaktkassetten - wie war das Schicksal der Entwicklung?</a></li>
<li><a href="../de488440/index.html">Lords of DOOM: Wie zwei Jungs einen Kult-Shooter kreierten und die Videospielbranche rockten</a></li>
<li><a href="../de488446/index.html">Russische Instrumentierung: Wir haben Ihr Design an den Fingern gedreht</a></li>
<li><a href="../de488448/index.html">Machen Sie eine Fahrt an der ITMO University: unsere Meisterkurse, Workshops, Vorträge und Studentenwettbewerbe</a></li>
<li><a href="../de488450/index.html">Wie eine neue Generation von Online-Banking funktioniert</a></li>
<li><a href="../de488458/index.html">FunCode Backend Java / Kotlin Challenge: Gewinner bekannt gegeben</a></li>
<li><a href="../de488460/index.html">Wie die CIA jahrzehntelang die verschlüsselte Korrespondenz von Verbündeten und Gegnern las</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>