<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçá üç≥ üë∞üèª Como escrever seu √≠ndice no Tarantool üçµ üç• üåπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tarantool √© um servidor de aplicativos e banco de dados. A parte do servidor √© escrita em C e o usu√°rio √© fornecido com uma interface Lua para trabalh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Como escrever seu √≠ndice no Tarantool</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/505880/"><img src="https://habrastorage.org/webt/_w/oc/me/_wocmecfrb1lnc7gdoodtf3j3y4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tarantool √© um servidor de aplicativos e banco de dados. </font><font style="vertical-align: inherit;">A parte do servidor √© escrita em C e o usu√°rio √© fornecido com uma interface Lua para trabalhar com ele. </font><font style="vertical-align: inherit;">Al√©m disso, o Tarantool √© um produto de c√≥digo aberto, o que significa que o c√≥digo-fonte √© de dom√≠nio p√∫blico e voc√™ pode desenvolver e distribuir livremente software baseado em Tarantool. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas hoje a hist√≥ria ser√° um pouco diferente: sobre o experimento, sobre tentar escrever sua pr√≥pria estrutura de dados para a pesquisa (curva de ordem Z) e integr√°-la ao ecossistema Tarantool existente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sou desenvolvedor da equipe de solu√ß√µes Tarantool, n√£o estou diretamente envolvido no desenvolvimento do Tarantool, mas sou um usu√°rio ativo. </font><font style="vertical-align: inherit;">Portanto, para mim, esse experimento √© uma tentativa de entender como o Tarantool funciona em um n√≠vel baixo.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que √© o Tarantool e onde ele armazena dados?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que √© Tarantool? No mundo dos bancos de dados, ele est√° posicionado como uma tecnologia na mem√≥ria. O mecanismo memtx permite armazenar todos os seus dados na RAM, atendendo a todos os princ√≠pios do ACID. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um an√°logo de tabelas relacionais no Tarantool √© o espa√ßo, projetado para armazenar tuplas (tuplas). Diferentemente das tabelas relacionais, as tuplas em um espa√ßo geralmente podem ter comprimento arbitr√°rio. Para armazen√°-los, uma estrutura de dados de pesquisa deve ser criada e a chave de pesquisa √© a chave prim√°ria, sempre √∫nica.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode criar estruturas adicionais - √≠ndices secund√°rios que armazenam apenas um ponteiro para uma tupla. </font><font style="vertical-align: inherit;">O √≠ndice secund√°rio pode n√£o ser exclusivo; no entanto, esse √© apenas o comportamento externo vis√≠vel ao usu√°rio. </font><font style="vertical-align: inherit;">Os campos de √≠ndice prim√°rio s√£o adicionados implicitamente a qualquer √≠ndice n√£o exclusivo. </font><font style="vertical-align: inherit;">Isso garante a estabilidade da classifica√ß√£o de tuplas no √≠ndice. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Tarantool suporta diferentes tipos de √≠ndices:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro de tudo, na </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Årvore B</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (e se for absolutamente preciso, ent√£o √Årvore B + *). </font><font style="vertical-align: inherit;">Muito [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B-Tree</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] foi </font><font style="vertical-align: inherit;">escrito sobre a estrutura das B-trees </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Observo apenas que os dados s√£o armazenados na forma classificada, al√©m disso, voc√™ pode pesquisar pelo prefixo da chave indexada.</font></font></li>
<li>   <strong>hash-</strong>. ,      .    .    B-,      ,  .    .</li>
<li><strong>R-Tree</strong>.      .    ¬´¬ª , ,  .       ‚Äî .     ,       .        .   ,      ,    .</li>
<li><strong>Bitset</strong>. ,     .   ,            ,   .</li>
</ul><br>
<h3> Z-,   </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De onde surgiu a id√©ia de escrever seu √≠ndice e bem ex√≥tica? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma vez me deparei com artigos da Amazon [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1, 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ], que falavam sobre uma estrutura como a curva da ordem Z, ou a curva de Morton. Esta √© uma receita para a localiza√ß√£o de dados "multidimensionais" dentro de uma estrutura plana (curva de ordem Z), que ent√£o se encaixa em uma √°rvore B. Essa abordagem deve ajudar a evitar a varredura cont√≠nua de dados. Em geral, informa√ß√µes sobre qualquer objeto com um determinado conjunto de caracter√≠sticas podem ser consideradas dados multidimensionais. Por exemplo, altura, peso, tamanho do p√©, etc. pessoa. A maioria dos bancos de dados usa o R-Tree para esse fim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pouco sobre como a curva da ordem Z √© estruturada.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/363/a10/2c9/363a102c99adb088e19052945e6298fb.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma curva de ordem Z, tamb√©m conhecida como curva de Morton, √© obtida pela intercala√ß√£o de bits das coordenadas de um ponto no espa√ßo. </font><font style="vertical-align: inherit;">Os endere√ßos Z assim obtidos t√™m a propriedade de localidade. </font><font style="vertical-align: inherit;">Os pontos localizados nas proximidades no espa√ßo multidimensional ainda estar√£o localizados nas proximidades quando exibidos em uma linha plana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misturas esquematicamente semelhantes s√£o assim:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6eb/04c/f2b/6eb04cf2b6ac3f0b26613a774c8f479d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como funciona? </font><font style="vertical-align: inherit;">Limitamos uma determinada regi√£o no espa√ßo - um hipercubo (haver√° um ret√¢ngulo no espa√ßo bidimensional) - com a ajuda de dois pontos na diagonal, que s√£o exibidos em dois pontos na linha. </font><font style="vertical-align: inherit;">E temos um efeito colateral desagrad√°vel: alguns dos pontos v√£o al√©m da caixa delimitadora:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/991/fd9/889/991fd9889fa6f3b4b30fd7adecfcd436.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou seja, n√£o podemos apenas iterar ao longo dessa curva. Mas, armados com um algoritmo especial, podemos dar um salto ao viajar para o exterior, retornando √† √°rea de pesquisa. Assim que vamos al√©m do ponto extremo da curva (vamos cham√°-lo upper_bound), a pesquisa termina. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao trabalhar com a B-Tree, ter√≠amos um conjunto de intervalos, e essa consulta levaria a uma varredura seq√ºencial da B-tree, o que levaria muito tempo com um grande conjunto de dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meu interesse foi alimentado por outras publica√ß√µes sobre essa curva. Por exemplo, como foi integrado ao TransBase [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ], um banco de dados propriet√°rio. E, infelizmente para mim, n√£o encontrei nenhuma implementa√ß√£o de c√≥digo aberto dessa estrutura.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A curva B-Tree subjacente tem v√°rias vantagens sobre a R-Tree. </font><font style="vertical-align: inherit;">Por exemplo, melhor ocupa√ß√£o e compacidade. </font><font style="vertical-align: inherit;">Desvantagens: a maioria dos algoritmos usados ‚Äã‚Äã√© limitada pelo processador. </font><font style="vertical-align: inherit;">Para compara√ß√£o, decidi usar o Tarantool: estava interessado em ler / inserir velocidades, bem como no consumo de mem√≥ria. </font><font style="vertical-align: inherit;">√â imposs√≠vel n√£o mencionar que um t√≥pico semelhante j√° foi levantado no Habr√©, mas em pequenas dimens√µes (2-3) e em rela√ß√£o ao banco de dados em disco do PostgreSQL [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZcurvePostgres</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ].</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que era necess√°rio para incorporar no Tarantool?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrei implementa√ß√µes simples dessa estrutura para as dimens√µes 2-3, mas eu queria comparar o desempenho com o √≠ndice R-Tree existente, portanto, n√£o queria me limitar a pequenas dimens√µes. Eu escolhi a mesma dimens√£o que o R-Tree - 20. Para isso, eu precisava de um bitmap com suporte para algumas opera√ß√µes primitivas: extra√ß√£o / modifica√ß√£o de um pouco, deslocamento, opera√ß√µes l√≥gicas OR / AND. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o prot√≥tipo, peguei a implementa√ß√£o de c√≥digo aberto encontrada, mas rapidamente cheguei √† conclus√£o de que n√£o precisava de um bitmap de uso geral: o comprimento da chave √© sempre um m√∫ltiplo de 64, portanto, algumas opera√ß√µes s√£o bastante simplificadas. Eu escrevi minha pr√≥pria implementa√ß√£o com base no que eu tinha. Al√©m disso, em vez de usar as fun√ß√µes do sistema para alocar mem√≥ria, comecei a usar alocadores especiais implementados no Tarantool [</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Talvez o cora√ß√£o do √≠ndice seja um conjunto de algoritmos para trabalhar com a curva Z. </font><font style="vertical-align: inherit;">Ou seja, calculando o endere√ßo Z (usando tabelas de pesquisa especiais), verificando se o endere√ßo Z pertence √† √°rea de pesquisa e detectando a primeira ocorr√™ncia na √°rea de pesquisa, come√ßando no ponto especificado. </font><font style="vertical-align: inherit;">Se voc√™ pesquisar bem na Web, poder√° encontrar publica√ß√µes cient√≠ficas descrevendo esses algoritmos, ent√£o tudo que eu precisava fazer era implement√°-los, depur√°-los e, se poss√≠vel, otimiz√°-los. </font><font style="vertical-align: inherit;">Deveria armazenar endere√ßos Z dentro da √°rvore B j√° implementada usada para o √≠ndice TREE.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como √© organizado o tratamento de dados?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No caso mais geral, a tupla chega at√© n√≥s. Essa √© uma matriz de dados no formato do pacote de mensagens. E no caso ideal, ter√≠amos que isolar os campos indexados, misturar seus bits e inserir o endere√ßo com o ponteiro na tupla dentro da √°rvore B.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, tudo seria t√£o simples se trabalhassemos apenas com o tipo n√£o assinado, quando as representa√ß√µes de bits classificadas dos n√∫meros corresponderiam aos n√∫meros classificados na representa√ß√£o natural. Inteiros assinados t√™m suas pr√≥prias regras de apresenta√ß√£o, n√∫meros de ponto flutuante t√™m suas pr√≥prias. E isso teve que levar a um denominador comum. Devido ao fato de armazenarmos o endere√ßo Z separadamente dos pr√≥prios dados, podemos realizar quaisquer transforma√ß√µes em nossas chaves, o principal √© manter a ordem de classifica√ß√£o. Isso pode ser feito usando manipula√ß√µes bit a bit simples. Por exemplo, para n√∫meros inteiros assinados, voc√™ pode simplesmente inverter o byte alto. Para outros tipos, h√° transforma√ß√µes semelhantes, embora um pouco mais complexas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os tipos num√©ricos cabem em 8 bytes, portanto, a chave resultante ter√° N * 8 bytes de tamanho, onde N √© a dimens√£o do nosso espa√ßo. O que fazer com as cordas? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma situa√ß√£o bastante comum ao trabalhar com strings √© a pesquisa de prefixos. E √© bem poss√≠vel apoiar. Os primeiros 8 bytes da cadeia de caracteres podem muito bem ser usados ‚Äã‚Äãcomo uma chave. Se a string for mais curta, poder√° ser preenchida com zeros. O suporte a strings imp√µe uma limita√ß√£o fundamental em nosso √≠ndice: perdemos a exclusividade. Mesmo se as linhas diferirem no nono byte, do ponto de vista do sistema elas ainda ser√£o as mesmas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos dar uma olhada no c√≥digo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A API de √≠ndice consiste em um conjunto espec√≠fico de m√©todos. N√£o consideraremos cada um individualmente, passaremos apenas pelos mais b√°sicos, a saber, opera√ß√µes de pesquisa e inser√ß√£o.</font></font><br>
<br>
<code>get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- procure um item pela tecla completa. Funciona apenas para √≠ndices exclusivos. Nosso √≠ndice n√£o pode ser exclusivo, portanto, a fun√ß√£o √© substitu√≠da por uma vers√£o gen√©rica especial que retorna o erro "Recurso de √≠ndice n√£o suportado". </font></font><br>
<br>
<code>replace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- insira um item. Vamos considerar em mais detalhes.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span>
<span class="hljs-title">memtx_zcurve_index_replace</span><span class="hljs-params">(struct index *base, struct tuple *old_tuple,
        struct tuple *new_tuple, <span class="hljs-keyword">enum</span> dup_replace_mode mode,
        struct tuple **result)</span>
</span>{<font></font>
    (<span class="hljs-keyword">void</span>)mode;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">memtx_zcurve_index</span> *<span class="hljs-title">index</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">memtx_zcurve_index</span> *)<span class="hljs-title">base</span>;</span>
    <span class="hljs-keyword">if</span> (new_tuple) {
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">memtx_zcurve_data</span> <span class="hljs-title">new_data</span>;</span><font></font>
        new_data.tuple = new_tuple;<font></font>
        new_data.z_address = extract_zaddress(new_tuple,<font></font>
                &amp;index-&gt;bit_array_pool, index);<font></font>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">memtx_zcurve_data</span> <span class="hljs-title">dup_data</span>;</span>
        dup_data.tuple = <span class="hljs-literal">NULL</span>;<font></font>
        dup_data.z_address = <span class="hljs-literal">NULL</span>;<font></font>
<font></font>
        <span class="hljs-keyword">int</span> tree_res = memtx_zcurve_insert(&amp;index-&gt;tree, new_data,<font></font>
                &amp;dup_data);<font></font>
        <span class="hljs-keyword">if</span> (tree_res) {<font></font>
            diag_set(OutOfMemory, MEMTX_EXTENT_SIZE,<font></font>
                     <span class="hljs-string">"memtx_zcurve_index"</span>, <span class="hljs-string">"replace"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (dup_data.tuple != <span class="hljs-literal">NULL</span>) {<font></font>
            *result = dup_data.tuple;<font></font>
            z_value_free(&amp;index-&gt;bit_array_pool, dup_data.z_address);<font></font>
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (old_tuple) {
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">memtx_zcurve_data</span> <span class="hljs-title">old_data</span>, <span class="hljs-title">deleted_value</span>;</span><font></font>
        old_data.tuple = old_tuple;<font></font>
        old_data.z_address = extract_zaddress(old_tuple,<font></font>
                &amp;index-&gt;bit_array_pool, index);<font></font>
        memtx_zcurve_delete_value(&amp;index-&gt;tree, old_data, &amp;deleted_value);<font></font>
        z_value_free(&amp;index-&gt;bit_array_pool, old_data.z_address);<font></font>
        z_value_free(&amp;index-&gt;bit_array_pool, deleted_value.z_address);<font></font>
    }<font></font>
    *result = old_tuple;<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No que voc√™ deve prestar aten√ß√£o? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em termos de √≠ndice, n√£o foram realizadas opera√ß√µes </font></font><code>update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>insert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>replace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Toda a l√≥gica deles √© executada nesse m√©todo, que recebe as tuplas antiga e nova, al√©m de </font></font><code>mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informa√ß√µes sobre se o √≠ndice √© √∫nico ou n√£o. </font><font style="vertical-align: inherit;">Nosso √≠ndice n√£o pode ser exclusivo; portanto, nenhuma verifica√ß√£o adicional √© necess√°ria e voc√™ pode inserir imediatamente uma tupla. </font></font><br>
<br>
<code>memtx_zcurve_insert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>memtx_zcurve_delete_value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- m√©todos B-tree, que j√° foram implementados no Tarantool e s√£o utilizados no √≠ndice TREE regular. </font><font style="vertical-align: inherit;">N√£o vamos nos deter neles separadamente. </font><font style="vertical-align: inherit;">Diferentemente da TREE comum, armazenamos n√£o apenas uma tupla, mas tamb√©m um endere√ßo z - os bits misturados das partes indexadas. </font><font style="vertical-align: inherit;">A fun√ß√£o √© respons√°vel por isso </font></font><code>extract_zadress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<code>create_iterator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- de Lua, nos referimos a esse m√©todo no caso de </font></font><code>select</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'a e</font></font><code>pairs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'e.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> struct iterator *
<span class="hljs-title">memtx_zcurve_index_create_iterator</span><span class="hljs-params">(struct index *base, <span class="hljs-keyword">enum</span> iterator_type type,
                                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *key, <span class="hljs-keyword">uint32_t</span> part_count)</span>
</span>{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">memtx_zcurve_index</span> *<span class="hljs-title">index</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">memtx_zcurve_index</span> *)<span class="hljs-title">base</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">memtx_engine</span> *<span class="hljs-title">memtx</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">memtx_engine</span> *)<span class="hljs-title">base</span>-&gt;<span class="hljs-title">engine</span>;</span><font></font>
<font></font>
    assert(part_count == <span class="hljs-number">0</span> || key != <span class="hljs-literal">NULL</span>);
    <span class="hljs-keyword">if</span> (type != ITER_EQ &amp;&amp; type != ITER_ALL &amp;&amp; type != ITER_GE) {<font></font>
        diag_set(UnsupportedIndexFeature, base-&gt;def,<font></font>
                 <span class="hljs-string">"requested iterator type"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">uint8_t</span> index_dim = base-&gt;def-&gt;key_def-&gt;part_count;
    <span class="hljs-keyword">if</span> (part_count == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">/*
         * If no key is specified, downgrade equality
         * iterators to a full range.
         */</span><font></font>
        type = ITER_GE;<font></font>
        key = <span class="hljs-literal">NULL</span>;<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (index_dim * <span class="hljs-number">2</span> == part_count<font></font>
               &amp;&amp; type != ITER_ALL) {<font></font>
        <span class="hljs-comment">/*
         * If part_count is twice greater than key_def.part_count
         * set iterator to range query
         */</span><font></font>
        type = ITER_GE;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tree_iterator</span> *<span class="hljs-title">it</span> = <span class="hljs-title">mempool_alloc</span>(&amp;<span class="hljs-title">memtx</span>-&gt;<span class="hljs-title">zcurve_iterator_pool</span>);</span>
    <span class="hljs-keyword">if</span> (it == <span class="hljs-literal">NULL</span>) {<font></font>
        diag_set(OutOfMemory, <span class="hljs-keyword">sizeof</span>(struct tree_iterator),
                 <span class="hljs-string">"memtx_zcurve_index"</span>, <span class="hljs-string">"iterator"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
    }<font></font>
<font></font>
    iterator_create(&amp;it-&gt;base, base);<font></font>
    it-&gt;pool = &amp;memtx-&gt;zcurve_iterator_pool;<font></font>
    it-&gt;base.next = tree_iterator_start;<font></font>
    it-&gt;base.<span class="hljs-built_in">free</span> = tree_iterator_free;<font></font>
    it-&gt;type = type;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (part_count == <span class="hljs-number">0</span> || type == ITER_ALL) {<font></font>
        it-&gt;lower_bound = zeros(&amp;index-&gt;bit_array_pool, index_dim);<font></font>
        it-&gt;upper_bound = ones(&amp;index-&gt;bit_array_pool, index_dim);<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == ITER_EQ) {<font></font>
        it-&gt;lower_bound = mp_decode_key(&amp;index-&gt;bit_array_pool,<font></font>
                key, index_dim, index);<font></font>
        it-&gt;upper_bound = <span class="hljs-literal">NULL</span>;<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (base-&gt;def-&gt;key_def-&gt;part_count == part_count) {<font></font>
        it-&gt;lower_bound = mp_decode_key(&amp;index-&gt;bit_array_pool,<font></font>
                key, index_dim, index);<font></font>
        it-&gt;upper_bound = ones(&amp;index-&gt;bit_array_pool, index_dim);<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (base-&gt;def-&gt;key_def-&gt;part_count * <span class="hljs-number">2</span> == part_count) {<font></font>
        it-&gt;lower_bound  = z_value_create(&amp;index-&gt;bit_array_pool, index_dim);<font></font>
        it-&gt;upper_bound  = z_value_create(&amp;index-&gt;bit_array_pool, index_dim);<font></font>
        mp_decode_part(key, part_count, index, it-&gt;lower_bound, it-&gt;upper_bound);<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        unreachable();<font></font>
    }<font></font>
    it-&gt;tree_iterator = memtx_zcurve_invalid_iterator();<font></font>
    it-&gt;current.tuple = <span class="hljs-literal">NULL</span>;<font></font>
    it-&gt;current.z_address = <span class="hljs-literal">NULL</span>;
    <span class="hljs-keyword">return</span> (struct iterator *)it;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dependendo da chave transmitida, calculamos os limites inferior e superior da solicita√ß√£o. </font><font style="vertical-align: inherit;">No entanto, at√© agora, esse iterador n√£o aponta para nada. </font><font style="vertical-align: inherit;">Existem v√°rios tipos de iteradores no total. </font><font style="vertical-align: inherit;">No nosso caso, isso √© tudo - obtendo todos os elementos; </font><font style="vertical-align: inherit;">EQ - receber elementos cujo endere√ßo z corresponde ao transmitido; </font><font style="vertical-align: inherit;">e GE √© a sele√ß√£o de elementos no hipercubo. </font></font><br>
<br>
<code>destroy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- remo√ß√£o do √≠ndice. </font><font style="vertical-align: inherit;">No caso do √≠ndice secund√°rio, ele simplesmente libera a mem√≥ria que foi alocada para a estrutura de pesquisa. </font><font style="vertical-align: inherit;">E se o √≠ndice for prim√°rio, exclua fisicamente as tuplas armazenadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo o c√≥digo est√° dispon√≠vel em: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/olegrok/tarantool/tree/z-order-curve-index</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vamos ver o que aconteceu e resumir.</font></font><br>
<br>
<pre><code class="lua hljs">space = box.schema.space.<span class="hljs-built_in">create</span>(<span class="hljs-string">'myspace'</span>, { engine = <span class="hljs-string">'memtx'</span> })<font></font>
pk = space:create_index(<span class="hljs-string">'primary'</span>, { <span class="hljs-built_in">type</span> = <span class="hljs-string">'tree'</span>, parts = {{<span class="hljs-number">1</span>, <span class="hljs-string">'unsigned'</span>}}, unique = <span class="hljs-literal">true</span>})<font></font>
sk = space:create_index(<span class="hljs-string">'secondary'</span>, { <span class="hljs-built_in">type</span> = <span class="hljs-string">'zcurve'</span>, parts = {{<span class="hljs-number">2</span>, <span class="hljs-string">'unsigned'</span>}, {<span class="hljs-number">3</span>, <span class="hljs-string">'unsigned'</span>}}})
<span class="hljs-keyword">for</span> i=<span class="hljs-number">0</span>,<span class="hljs-number">5</span> <span class="hljs-keyword">do</span> <span class="hljs-keyword">for</span> j=<span class="hljs-number">0</span>,<span class="hljs-number">5</span> <span class="hljs-keyword">do</span> space:<span class="hljs-built_in">insert</span>{i * <span class="hljs-number">6</span> + j, i, j} <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>
<span class="hljs-comment">-- returns all tuples</span>
pk:<span class="hljs-built_in">select</span>{}
<span class="hljs-comment">-- (2 &lt;= x &lt;= 3) and (3 &lt;= y &lt;= 5)</span>
sk:<span class="hljs-built_in">select</span>{<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>}
<span class="hljs-comment">---</span>
- ‚Äî [<span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">21</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">16</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">22</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">17</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>]<font></font>
  - [<span class="hljs-number">23</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]<font></font>
‚Ä¶<font></font>
<span class="hljs-comment">-- (x == 2) and (y == 3)</span>
sk:<span class="hljs-built_in">select</span>{<span class="hljs-number">2</span>, <span class="hljs-number">3</span>}
<span class="hljs-comment">---</span>
- ‚Äî [<span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
<span class="hljs-comment">-- (2 &lt;= x &lt;= 3)</span>
sk:<span class="hljs-built_in">select</span>({<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, box.NULL, box.NULL})
<span class="hljs-comment">---</span>
- ‚Äî [<span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>]<font></font>
  - [<span class="hljs-number">18</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>]<font></font>
  - [<span class="hljs-number">13</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]<font></font>
  - [<span class="hljs-number">19</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>]<font></font>
  - [<span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>]<font></font>
  - [<span class="hljs-number">20</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]<font></font>
  - [<span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">21</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">16</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">22</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">17</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>]<font></font>
  - [<span class="hljs-number">23</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]<font></font>
...<font></font>
<span class="hljs-comment">-- (x &gt;= 2) and (y &gt;= 3)</span>
sk:<span class="hljs-built_in">select</span>({<span class="hljs-number">2</span>, box.NULL, <span class="hljs-number">3</span>, box.NULL})
<span class="hljs-comment">---</span>
- ‚Äî [<span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">21</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">27</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">33</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>]<font></font>
  - [<span class="hljs-number">16</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">22</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">17</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>]<font></font>
  - [<span class="hljs-number">23</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]<font></font>
  - [<span class="hljs-number">28</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">34</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>]<font></font>
  - [<span class="hljs-number">29</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<font></font>
  - [<span class="hljs-number">35</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>]<font></font>
...</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E o desempenho?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acabou que nem tudo √© t√£o r√≥seo como eu descrevi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßando em algum momento, a curva da ordem Z come√ßa a cair significativamente em termos de velocidade de acesso aos dados. O perf top mostrou que a maior parte do tempo √© gasta na verifica√ß√£o de que o ponto pertence √† √°rea de pesquisa e no c√°lculo do pr√≥ximo ponto para o qual voc√™ precisa pular. Ambas as opera√ß√µes t√™m complexidade linear, dependendo do comprimento da chave - √† medida que a dimens√£o aumenta, o comprimento tamb√©m aumenta.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/70e/338/fd1/70e338fd15af8701c3a5696ebfb3ea2a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do agrad√°vel - o consumo de mem√≥ria √© 2-3 vezes menor e a inser√ß√£o √© um pouco mais r√°pida que a R-Tree. </font><font style="vertical-align: inherit;">O que n√£o √© particularmente relevante, porque as medi√ß√µes foram feitas com o WAL desativado. </font><font style="vertical-align: inherit;">Primeiramente, em um ambiente de produ√ß√£o, no caso de uma falha, um WAL desabilitado pode levar √† perda de dados. </font><font style="vertical-align: inherit;">Em segundo lugar, apesar de gravar no WAL usar a abordagem batche, ele ainda est√° gravando no disco, milhares de vezes mais lento que o trabalho com RAM.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ee/e73/e29/9eee73e29d809963c069a9f7414f524a.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2c0/8b9/159/2c08b91598dbefe2855ede4d05a593ca.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m √© interessante comparar com a √°rvore B. </font><font style="vertical-align: inherit;">Aqui, como esperado, a curva ser√° mais r√°pida que uma varredura completa e verificar√° cada ponto quanto a pertencer a uma determinada √°rea. </font><font style="vertical-align: inherit;">Mesmo que a verifica√ß√£o seja mais leve do que no caso da curva da ordem Z, onde tudo se resume a uma compara√ß√£o pouco a pouco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os n√∫meros no gr√°fico diferem em ordem do R-Tree - o teste foi ligeiramente modificado.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/140/ae5/44d/140ae544d6ba527bffe6bc4d814f609d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o teste, gerei um conjunto de pontos e comparei a dura√ß√£o da consulta usando a curva Z e a varredura convencional.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resumir</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No mundo da mem√≥ria, essa estrutura provou n√£o ser a melhor maneira, no entanto, ainda possui vantagens:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ocupa menos espa√ßo.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digitado, diferentemente do R-Tree (relevante apenas para Tarantool).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vale a pena olhar mais de perto se houver apenas uma √°rvore B e voc√™ precisar fazer consultas multidimensionais (n√£o relevantes para o Tarantool).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Foi um experimento interessante. </font><font style="vertical-align: inherit;">√â improv√°vel que a solu√ß√£o que propus se torne parte do Tarantool. </font><font style="vertical-align: inherit;">No entanto, n√£o tenha medo de experimentar. </font><font style="vertical-align: inherit;">E se voc√™ tiver sugest√µes e solu√ß√µes, n√£o tenha medo de compartilh√°-las.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fontes</font></font></h2><br>
<a name="B-Tree"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[B-Tree]: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√≠ndices no PostgreSQL - 4 / Blog do Postgres Professional / Habr </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B-tree / Estrutura </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">de dados da </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">Habr </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B-tree / OTUS Blog. </font><font style="vertical-align: inherit;">Revista online de educa√ß√£o / geek</font></font></a><br>
<br>
<a name="ZcurvePostgres"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ZcurvePostgres]: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre a ordem Z e a revista R-tree / geek </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ordem Z vs a √°rvore R, continua√ß√£o / revista geek</font></font></a><br>
<br>
<a name="1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1] </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indexa√ß√£o por ordem Z para consultas multifacetadas no Amazon DynamoDB: parte 1 | </font><font style="vertical-align: inherit;">Blog do banco de dados da AWS</font></font></a><br>
<br>
<a name="1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2] </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indexa√ß√£o de ordem Z para consultas multifacetadas no Amazon DynamoDB: parte 2 | </font><font style="vertical-align: inherit;">Blog do banco de dados da AWS</font></font></a><br>
<br>
<a name="3"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3] </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integrando a UB-Tree em um kernel do sistema de banco de dados</font></font></a><br>
<br>
<a name="4"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[4] </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/tarantool/small</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt505850/index.html">Polimorfismo baseado em conceito do C ++ no c√≥digo do produto: PassManager no LLVM</a></li>
<li><a href="../pt505856/index.html">Da Brute-Force √† tentativa de privacidade - o que os provedores de SaaS enfrentam</a></li>
<li><a href="../pt505860/index.html">Spring Boot, Hibernate e Kotlin para iniciantes passo a passo</a></li>
<li><a href="../pt505870/index.html">Como promover jogos e aplicativos para celular no Jap√£o, Cor√©ia e China</a></li>
<li><a href="../pt505872/index.html">Hist√≥ria de ve√≠culos n√£o tripulados</a></li>
<li><a href="../pt505884/index.html">Spear phishing: experi√™ncia na cria√ß√£o de arquivos execut√°veis ‚Äã‚Äãcondicionalmente maliciosos para e-mails de phishing</a></li>
<li><a href="../pt505888/index.html">Analisando o YouTube, incluindo dados enviados, sem a API do YouTube</a></li>
<li><a href="../pt505896/index.html">Semana 24 de seguran√ßa: Zoom e privacidade do navegador</a></li>
<li><a href="../pt505898/index.html">Claude Shannon: Jack of All Trades, Coringa e pai da teoria da informa√ß√£o</a></li>
<li><a href="../pt505900/index.html">Depend√™ncias pessoais: tamanho 40 mm, sem fio, por 72 horas por 8.000 rublos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>