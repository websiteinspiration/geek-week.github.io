<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚰 ☝🏼 👨🏾‍🤝‍👨🏽 Réseaux de neurones et trading. Mise en œuvre pratique 🛵 📅 🏉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La mode commerciale connaît des hauts et des bas avec le taux de change Bitcoin. Maintenant, ce sujet est à un point bas après une croissance incroyab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Réseaux de neurones et trading. Mise en œuvre pratique</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494964/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mode commerciale connaît des hauts et des bas avec le taux de change Bitcoin. Maintenant, ce sujet est à un point bas après une croissance incroyable en 2018. Beaucoup pendant cette période ont réussi à se familiariser avec les crypto-échanges - ils se sont plongés dans le sujet, ont étudié, échangé, perdu de l'argent et parfois même gagné. En conséquence, la mode est passée, mais l'expérience est restée, bien que négative. Les mots «long», «short», «spread», «diver» peuvent être entendus par ceux dont vous ne vous attendez certainement pas à cela. Mais non seulement le commerce des «mains» a attiré l'attention, mais il existe également des robots commerciaux. Qu'avons-nous dans ce domaine, quelle est l'expérience des 2-3 dernières années?</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, il n'y a rien de bon dans ce domaine non plus. Il existe de nombreux outils pour écrire des robots commerciaux, mais il n'y a pas de stratégies stables et rentables. Dans le meilleur des cas, une solution de travail doit être constamment entretenue par une paire de trader-programmeur changeant les paramètres du marché actuel. Le résultat standard après avoir connecté un bot entièrement autonome au dépôt est de vider le dépôt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le dernier espoir demeure - les réseaux de neurones. Cela devrait certainement se produire, car le réseau neuronal apprend en tant que personne et s'adapte au marché. Comment allez-vous dans ce domaine? Eh bien ... vous l'avez deviné. Tout est mauvais, il y a beaucoup de discussions, mais il n'y a pas de solutions de travail. Tout va très mal! Un exemple frappant de cela est le magasin d'applications de la communauté MQL5. Derrière la marque MQL5 se trouve une plateforme de trading professionnelle - MetaTrader5 plus une énorme communauté de traders et de programmeurs. Donc, dans ce magasin, il y a une section pour des solutions basées sur des réseaux de neurones, il y a beaucoup de bots, mais pas un seul réel. L'ajout d'un bot à l'aide d'un réseau de neurones est interdit par les règles. C'est difficile à croire, mais ça l'est. L'interdiction de connecter une API externe exclut la possibilité d'utiliser des réseaux de neurones, et les outils intégrés dans MQL5 ne fonctionnent pas dans la pratique. J'ai discuté de ce problème avec le support technique MQL5,Je n'ai pas reçu de réponse claire. Par conséquent, rien ne fonctionne vraiment sur le marché, les solutions de la série «enseignez-vous» présentées sur le github ne sont pas prises en compte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, je termine avec l'introduction, je passe aux choses sérieuses. J'ai réussi à former un réseau de neurones, il y a des résultats dignes sur le marché réel. Plus loin sans entrer dans les détails, je vais décrire comment cela a été fait.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première et principale erreur de tous ceux qui essaient d'enseigner au réseau de neurones le commerce est la pensée commerciale sur le marché. Habituellement, un commerçant essaie de mettre en œuvre une solution basée sur des réseaux de neurones avec un programmeur qui a précédemment écrit des bots. L'algorithme de trading bot résout le problème de trouver le bon point d'entrée à la position et de déterminer le «take» et le «stop». Si vous avez cette tâche à l'esprit lors de la conception d'un réseau de neurones, alors rien ne fonctionnera. Vous pouvez sans cesse trier les options ingénieuses pour les données d'entrée, appliquer ou ne pas donner d'indicateurs, essayer différents types de réseaux de neurones, remplacer les béquilles comme entraînement uniquement dans certaines zones, ou vous entraîner en affichant uniquement des modèles connus. Ne fonctionnera pas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec un réseau de neurones, vous devez ressembler à un enfant, regarder le monde à travers ses yeux et commencer par des tâches simples. La question la plus simple qui peut être posée est «où le prix passera-t-il par X bougies, vers le haut ou vers le bas?». Peu importe à quel point le prix change et peu importe que la réponse ne puisse pas être transformée en stratégie de trading. Nous oublions le trading, maintenant la tâche principale est d'éduquer le réseau au moins quelque chose, juste obtenir la bonne réponse.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai eu cette tâche initiale résolue après 100 500 sélections d'entrée. </font><font style="vertical-align: inherit;">Utilisé TensoFlow plus Keras, un réseau de Sequental Dense. </font><font style="vertical-align: inherit;">Ensemble de données d'entrée pour 200-300 milliers d'exemples, vecteur d'entrée 250-350. </font><font style="vertical-align: inherit;">La forme de la réponse découle du réseau posé de la question - la classification binaire «up» ou «down». </font><font style="vertical-align: inherit;">L'entrée a été préparée par le bot dans MQL5. </font><font style="vertical-align: inherit;">Un bot parcourant une histoire forme un fichier csv normal, chaque ligne est un vecteur. </font><font style="vertical-align: inherit;">À la fin de chaque vecteur, la bonne réponse est 1: 0 si haut, 0: 1 si bas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici quelques suggestions pour ceux qui essaient:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il étudie bien dans les prévisions de 15 minutes à 60 minutes. </font><font style="vertical-align: inherit;">À une période plus courte, le chaos du mouvement des prix croît, à une période plus longue, l'influence externe augmente - nouvelles et ainsi de suite, 15-60 minutes la zone la plus «technique».</font></font></li>
<li>     BTCUSD,    EURUSD.   —  .</li>
<li>     «     ?     ?».          ,   .</li>
<li>               ,   50%  .   ,      .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez comprendre de quel matériel nous traitons. Le marché est à 95% chaos. Lorsque nous soumettons des données de formation au réseau et indiquons la bonne réponse, nous alimentons en fait le chaos. C’est comme essayer de former un réseau de neurones pour distinguer un chat d’un chien et s’entraîner à lui montrer des papillons, des étoiles et des signes du zodiaque, il n’y aura aucun résultat. Il est donc là, mais, heureusement, le marché donne environ 5% des modèles réellement opérationnels que le réseau peut détecter et cela se reflétera dans ses réponses. Par conséquent, faites attention à l'analyse des résultats des tests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant cette approche, j'ai obtenu le résultat suivant:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dans environ 2% des réponses, le réseau devine le mouvement supplémentaire dans le rapport de 2 bonnes réponses à 1 incorrecte. Lors de tests sur le marché réel, c'est exactement ce qui se passe, mais un autre problème se pose. Après tout, nous n'avons répondu qu'à 2% des questions, ignorez le reste. Ceux. nous lançons un neuro sur le marché réel dans un délai de 5 minutes et attendons ... à 2% - ce ne sera que toutes les 50 bougies qui seront répondues, une réponse en 4 heures! Et qu'en faire? Eh bien, si la réponse était «acheter / vendre», alors 6 transactions par jour sont normales, et ici le résumé «haut / bas» puis inexact, déception complète.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, j'ai résolu ce problème relativement facilement - juste toutes les 5 minutes, vous devez interroger non pas un modèle, mais 20 à 30 modèles, à la suite des réponses, il y aura assez. Les modèles sont formés sur différentes données d'entrée et, par conséquent, sont formés sur différents modèles. En pratique, il s'avère que les modèles klaxonnent sur des bougies différentes, ne s'activant ensemble que dans des endroits évidents et prévisibles et ne se chevauchent pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour résumer, il y a maintenant quelque chose qui peut être lancé sur le marché réel et avoir des signaux haut / bas avec une exploitation minière moyenne. Déjà plus amusant, mais le sens pratique est toujours nul.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelques mots sur la mise en œuvre. Cela a fonctionné pour moi sur un tas de MQL5 plus Keras. Un bot lancé dans MetaTrader5 sur chaque chandelier a préparé des données pour un réseau de neurones et est passé par une socket à un script python, qui à son tour a interrogé tous les modèles et, lorsqu'il a dépassé un seuil acceptable, a envoyé un signal au canal Telegram.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le circuit fonctionne, mais ne peut pas être appliqué. Il n'a pas été possible d'ajouter des signaux à une stratégie. Le principal inconvénient est la discrétion des réponses. La réponse est un événement auquel vous devez réagir d'une manière ou d'une autre - regardez la situation du marché, pensez si le réseau est bon ou non, etc. Sur une bougie, un modèle pourrait signaler et un autre vers le bas, et lequel croire? En conséquence, l'idée est née d'abandonner le seuil de réussite de la réponse et de commencer à respecter chaque réponse du réseau, mais avec un faible degré de confiance. Si vous commencez à faire la moyenne de toutes les réponses en une seule opinion commune et que vous la considérez comme la réponse du réseau, alors la réponse devient une qualité complètement différente. Dans ce cas, la connaissance de tous les modèles commence à prendre forme, et c'est une énorme quantité de formation conjointe.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Combien de temps, brièvement, mais après toutes les modifications, j'ai commencé à recevoir des réponses uniques du réseau neuronal pour chaque bougie, exprimées en pourcentage du temps de travail prévu de -100% à + 100%. Le signe reflète la direction ascendante / descendante attendue. Il est devenu clair que chaque réponse a un sens. Ça marche! J'ai moi-même une expérience de trading et j'ai vu comment le comportement du réseau devant mes yeux est devenu significatif. Parfois sa logique était compréhensible, parfois elle ne l’était pas, mais ses réponses ont toujours ressenti sa propre vision, souvent paradoxale, du marché. En plus de cela, il s'est avéré que plus la confiance du réseau est élevée, plus le développement attendu est proche du bon moment et vice versa. Une faible confiance semblait dire "ce qui se passera dans 15 minutes, je ne sais pas, mais la tendance générale est à la hausse".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De cet endroit, j'ai réalisé qu'essayer de formaliser tout cela en signaux d'achat / vente, c'est comme marteler des ongles avec un microscope. Ce qu'il fallait, c'était une sorte d'outil pour visualiser les signaux du réseau neuronal - un affichage graphique du niveau de «confiance» sur chaque bougie. Une large gamme d'outils MQL5 a permis de mettre tout cela dans Expert pour MetaTrader5. "Expert" via l'API reçoit les réponses du réseau de neurones et n'est engagé que dans le rendu. Voici un exemple de son travail sur BTCUSD M1: La </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8c5/976/ce2/8c5976ce22fbaa03814683028e479a8f.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
zone colorée en haut est la prévision «vers le bas», la zone en dessous est la prévision «vers le haut», l'épaisseur est le degré de confiance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À ce stade, la qualité de la prévision n'a pas d'importance, il est important que le réseau neuronal démontre une opinion assez adéquate sur la situation du marché. Vous pouvez toujours améliorer le réseau encore plus, l'essentiel est qu'il fonctionne!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, il existe aujourd'hui Expert pour MetaTrader5 avec deux types de prévisions - à court terme et à long terme. </font><font style="vertical-align: inherit;">Les statistiques s'accumulent progressivement, il y a des retours des commerçants. </font><font style="vertical-align: inherit;">Le résultat obtenu inspire de nouveaux travaux, nous devons maintenant nous tourner vers les équipes chères "acheter / vendre". </font><font style="vertical-align: inherit;">Cela peut être fait en augmentant considérablement la qualité des prévisions. </font><font style="vertical-align: inherit;">Ensuite, je vois ce chemin de développement:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il faut préparer une douzaine de prévisions dans l'intervalle entre 15 et 60 minutes. </font><font style="vertical-align: inherit;">Ceux. </font><font style="vertical-align: inherit;">commencer à prédire «haut / bas» pour 20, 25, 30, 35 minutes et ainsi de suite jusqu'à 60. Chaque prévision, je me souviens, est construite à partir des réponses d'environ 20 modèles.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ayant un tel volume d'informations sur chaque bougie minute, il est possible et nécessaire de l'analyser avec un autre réseau de neurones. </font><font style="vertical-align: inherit;">La connexion entre les prévisions à différents intervalles de temps peut être complètement non triviale, par conséquent, un réseau de neurones sera ici approprié.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'ensemble de données pour ce réseau de neurones ne sera pas aussi bruyant que celui de ses camarades plus jeunes, par conséquent, il doit être formé non pas à un banal «haut / bas», mais à prédire la force du mouvement d'un actif, et c'est une sortie directe pour «acheter / vendre».</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout ce que je voulais vous dire aujourd'hui. </font><font style="vertical-align: inherit;">Le travail continue, je pense qu'il y aura plus d'articles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au fait, cet expert pour MetaTrader5 est distribué gratuitement, si vous voulez voir le travail d'un réseau de neurones sur le marché réel, veuillez contacter.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr494938/index.html">Bonne journée de sauvegarde! Ne l'oublie pas</a></li>
<li><a href="../fr494940/index.html">DevOps - qu'est-ce que c'est, pourquoi et combien est-il demandé?</a></li>
<li><a href="../fr494942/index.html">CGI à la maison avec Unreal Engine et iPhone</a></li>
<li><a href="../fr494950/index.html">Quelques tendances de stockage à surveiller</a></li>
<li><a href="../fr494956/index.html">Durée de vie des octets de données</a></li>
<li><a href="../fr494966/index.html">SCRUM: un poème sur l'amour et la douleur</a></li>
<li><a href="../fr494968/index.html">Câbles Internet sous-marins: qui les achemine</a></li>
<li><a href="../fr494970/index.html">Introversion: caractère aléatoire dans la marge d'erreur ou mécanisme évolutif de conservation des espèces?</a></li>
<li><a href="../fr494972/index.html">SEMrush vs SimilarWeb - qui est le plus précis?</a></li>
<li><a href="../fr494978/index.html">Qu'est-ce que Windows PowerShell et que mange-t-il? Partie 4: Travailler avec des objets, des classes personnalisées</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>