<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📕 🖕🏿 💢 Android insets: berurusan dengan ketakutan dan bersiap-siap untuk Android Q 🍯 🎰 👱🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Android Q adalah versi Android kesepuluh dengan API level 29. Salah satu ide utama dari versi baru ini adalah konsep edge-to-edge, ketika aplikasi men...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Android insets: berurusan dengan ketakutan dan bersiap-siap untuk Android Q</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/488196/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android Q adalah versi Android kesepuluh dengan API level 29. </font><font style="vertical-align: inherit;">Salah satu ide utama dari versi baru ini adalah konsep edge-to-edge, ketika aplikasi menempati seluruh layar, dari bawah ke atas. </font><font style="vertical-align: inherit;">Ini berarti bahwa Bilah Status dan Bilah Navigasi harus transparan. </font><font style="vertical-align: inherit;">Tetapi, jika mereka transparan, maka tidak ada UI sistem - itu tumpang tindih komponen interaktif aplikasi. </font><font style="vertical-align: inherit;">Masalah ini diselesaikan dengan insets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengembang seluler menghindari inset, mereka menyebabkan rasa takut di dalamnya. </font><font style="vertical-align: inherit;">Tetapi di Android Q itu tidak akan mungkin untuk berkeliling insets - Anda harus belajar dan menerapkannya. </font><font style="vertical-align: inherit;">Bahkan, tidak ada yang rumit tentang insets: mereka menunjukkan elemen layar yang bersinggungan dengan antarmuka sistem dan menyarankan cara memindahkan elemen sehingga tidak bertentangan dengan sistem UI. </font><strong><font style="vertical-align: inherit;">Konstantin Tskhovrebov</font></strong><font style="vertical-align: inherit;"> akan memberi tahu tentang cara kerja insets dan bagaimana mereka berguna</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6Djql74drwk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konstantin Tskhovrebov</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terrakok</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) bekerja di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redmadrobot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Telah terlibat dalam Android selama 10 tahun dan telah mengumpulkan banyak pengalaman di berbagai proyek di mana tidak ada tempat untuk insets, mereka selalu berhasil berkeliling entah bagaimana. </font><font style="vertical-align: inherit;">Konstantin akan menceritakan tentang sejarah panjang menghindari masalah inset, tentang belajar dan melawan Android. </font><font style="vertical-align: inherit;">Dia akan mempertimbangkan tugas-tugas khas dari pengalamannya di mana insets dapat diterapkan, dan menunjukkan bagaimana berhenti takut pada keyboard, mengenali ukurannya dan merespons penampilan. </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan. </font><font style="vertical-align: inherit;">Artikel ini ditulis berdasarkan laporan oleh Konstantin di </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saint AppsConf 2019</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Laporan tersebut menggunakan bahan dari beberapa artikel tentang insets. </font><font style="vertical-align: inherit;">Tautkan ke bahan-bahan ini di akhir.</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas khas</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bilah Status Warna. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam banyak proyek, perancang menggambar Bilah Status warna. </font><font style="vertical-align: inherit;">Menjadi modis ketika Android 5 datang bersama dengan Desain Material baru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9l/ii/76/9lii76jdfrbb5i0vq8-ecv2ikby.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagaimana cara melukis Status Bar? </font><font style="vertical-align: inherit;">Dasar - tambahkan </font></font><code>colorPrimaryDark</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan warnanya diganti.</font></font><br>
<br>
<pre><code class="kotlin hljs"> &lt;style name=<span class="hljs-string">"AppTheme"</span> parent=<span class="hljs-string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;<font></font>
    ...<font></font>
    &lt;item name=<span class="hljs-string">"colorPrimaryDark"</span>&gt;<span class="hljs-meta">@color</span>/colorAccent&lt;/item&gt;<font></font>
    ...<font></font>
&lt;/style&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk Android di atas versi kelima (API dari 21 ke atas), Anda dapat mengatur parameter khusus dalam topik:</font></font><br>
<br>
<pre><code class="kotlin hljs">&lt;style name=<span class="hljs-string">"AppTheme"</span> parent=<span class="hljs-string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;<font></font>
    ...<font></font>
    &lt;item name=<span class="hljs-string">"android:statusBarColor"</span>&gt;<span class="hljs-meta">@color</span>/colorAccent&lt;/item&gt;<font></font>
    ...<font></font>
&lt;/style&gt;</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bilah Status Berwarna-warni</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Terkadang desainer di layar yang berbeda menggambar Bilah Status dalam warna yang berbeda. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uo/ev/nl/uoevnldknz2rtfq5lcqpn1mpj4g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak apa-apa, cara termudah untuk bekerja adalah dengan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berbagai topik dalam berbagai aktivitas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cara yang lebih menarik adalah dengan mengubah warna </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara langsung di runtime</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateView</span><span class="hljs-params">(...)</span></span>: View {<font></font>
    requireActivity().window.statusBarColor = requireContext().getColor(R.color.colorPrimary)<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter diubah melalui bendera khusus. </font><font style="vertical-align: inherit;">Namun hal utama adalah jangan lupa untuk mengubah warna kembali ketika pengguna keluar dari layar kembali. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bilah Status Transparan. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini lebih sulit. </font><font style="vertical-align: inherit;">Paling sering, transparansi dikaitkan dengan peta, karena pada peta itulah transparansi paling baik dilihat. </font><font style="vertical-align: inherit;">Dalam hal ini, seperti sebelumnya, kami menetapkan parameter khusus:</font></font><br>
<br>
<pre><code class="kotlin hljs">&lt;style name=<span class="hljs-string">"AppTheme"</span> parent=<span class="hljs-string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;    <font></font>
    ...<font></font>
    &lt;item name=<span class="hljs-string">"android:windowTranslucentStatus"</span>&gt;<span class="hljs-literal">true</span>&lt;/item&gt;<font></font>
    ...<font></font>
&lt;/style&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini, tentu saja, ada trik terkenal - untuk membuat indentasi lebih tinggi, jika tidak, Status Bar akan ditumpangkan pada ikon dan itu akan jelek.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/49/8f/c8/498fc8wuip6i-o4eutfnviumuio.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi di layar lain semuanya rusak. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/if/-0/0q/if-00qq6b7zidoz-_nfyehlev7s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagaimana cara mengatasi masalah tersebut? Metode pertama yang muncul dalam pikiran adalah kegiatan yang berbeda: kami memiliki topik yang berbeda, parameter berbeda, mereka bekerja secara berbeda. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan keyboard.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami menghindari insets tidak hanya dengan Bilah Status, tetapi juga ketika bekerja dengan keyboard. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s-/jk/mz/s-jkmzxzi-5xqr1ei0ku6pfubpy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada yang suka opsi di sebelah kiri, tetapi untuk mengubahnya menjadi opsi di sebelah kanan, ada solusi sederhana.</font></font><br>
<br>
<pre><code class="kotlin hljs">&lt;activity<font></font>
    ...<font></font>
    android:windowSoftInputMode=<span class="hljs-string">"adjustResize"</span>&gt;<font></font>
    ...<font></font>
&lt;/activity&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aktivitas sekarang dapat mengubah ukuran saat keyboard muncul. Ia bekerja dengan sederhana dan berat. Tapi jangan lupa trik lain - bungkus semuanya </font></font><code>ScrollView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tiba-tiba keyboard akan menempati seluruh layar dan akan ada strip kecil di atas? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada saat-saat yang lebih sulit ketika kita ingin mengubah tata letak ketika keyboard muncul. Misalnya, jika tidak mengatur tombol atau menyembunyikan logo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q3/ia/zl/q3iazltlnajt-cpvdzc0u2i8zcs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melatih banyak kruk dengan keyboard dan Status Bar yang transparan, sekarang sulit untuk menghentikan kami. Pergi ke StackOverflow dan salin kode yang indah.</font></font><br>
<br>
<pre><code class="kotlin hljs">boolean isOpened = <span class="hljs-literal">false</span>;<font></font>
<font></font>
<span class="hljs-keyword">public</span> void setListenerToRootView() {
    <span class="hljs-keyword">final</span> View activityRootView = getWindow().getDecorView().findViewById(android.R.id.content);<font></font>
    activityRootView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> void onGlobalLayout() {<font></font>
    <font></font>
            int heightDiff = activityRootView.getRootView().getHeight() - activityRootView.getHeight();      <font></font>
            <span class="hljs-keyword">if</span> (heightDiff &gt; <span class="hljs-number">100</span>) { <span class="hljs-comment">// 99% of the time the height diff will be due to a keyboard.       </span>
                Toast.makeText(getApplicationContext(), <span class="hljs-string">"Gotcha!!! softKeyboardup"</span>, <span class="hljs-number">0</span>).show();<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (isOpened == <span class="hljs-literal">false</span>) {
                   <span class="hljs-comment">//Do two things, make the view top visible and the editText smaller</span><font></font>
                }<font></font>
                isOpened = <span class="hljs-literal">true</span>;<font></font>
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isOpened == <span class="hljs-literal">true</span>) {<font></font>
                Toast.makeText(getApplicationContext(), <span class="hljs-string">"softkeyborad Down!!!"</span>, <span class="hljs-number">0</span>).show();<font></font>
                isOpened = <span class="hljs-literal">false</span>;<font></font>
            }    <font></font>
        }<font></font>
    });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan menghitung probabilitas munculnya keyboard. </font><font style="vertical-align: inherit;">Kode berfungsi, di salah satu proyek kami bahkan menggunakannya, tetapi untuk waktu yang lama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Banyak kruk dalam contoh terkait dengan penggunaan berbagai aktivitas. </font><font style="vertical-align: inherit;">Tetapi mereka buruk tidak hanya karena mereka adalah kruk, tetapi juga karena alasan lain: masalah "mulai dingin", asinkron. </font><font style="vertical-align: inherit;">Saya menggambarkan masalah secara lebih rinci dalam artikel " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lisensi untuk mengendarai mobil, atau mengapa aplikasi harus Single-Activity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">Selain itu, dokumentasi Google menunjukkan bahwa pendekatan yang disarankan adalah aplikasi Aktivitas Tunggal.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang kami lakukan sebelum Android 10</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami (di Redmadrobot) sedang mengembangkan aplikasi yang cukup berkualitas, tetapi telah lama menghindari insets. Bagaimana kami berhasil menghindarinya tanpa kruk besar dan dalam satu aktivitas? </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan. Tangkapan layar dan kode diambil dari proyek kesayangan saya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitFox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bayangkan layar aplikasi. Ketika kami mengembangkan aplikasi kami, kami tidak pernah berpikir bahwa mungkin ada Bilah Navigasi transparan di bawah ini. Apakah ada bilah hitam di bawah ini? Jadi apa, pengguna sudah terbiasa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ce/ab/6v/ceab6v6m5dqnbl9zpotdi1vqmre.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian atas, kami awalnya menetapkan parameter bahwa Bilah Status hitam dengan transparansi. Bagaimana tampilannya dalam hal tata letak dan kode?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0g/tu/of/0gtuoffisoeudtgxlnmqd-jicnk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abstraksi pada gambar: blok merah adalah aktivitas aplikasi, biru adalah fragmen dengan bot navigasi (dengan Tab), dan di dalamnya fragmen hijau dengan konten diaktifkan. Dapat dilihat bahwa Bilah Alat tidak berada di bawah Bilah Status. Bagaimana kita mencapai ini? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Android memiliki bendera yang rumit </font></font><code>fitSystemWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Jika Anda menyetelnya ke true, wadah akan menambahkan padding ke dirinya sendiri sehingga tidak ada di dalamnya yang berada di bawah Status Bar. Saya percaya bendera ini adalah penopang resmi dari Google untuk mereka yang takut akan inset. Gunakan semuanya akan bekerja relatif baik tanpa insets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bendera </font></font><code>FitSystemWindow=”true”</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menambahkan padding ke wadah yang Anda tentukan. Tetapi hierarki itu penting: jika salah satu dari orang tua menetapkan bendera ini menjadi "benar", maka distribusinya tidak akan diperhitungkan, karena wadah sudah menerapkan lekukan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bendera berfungsi, tetapi masalah lain muncul. </font><font style="vertical-align: inherit;">Bayangkan layar dengan dua tab. </font><font style="vertical-align: inherit;">Saat beralih, transaksi diluncurkan, yang menyebabkan </font></font><code>replace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fragmen satu sama lain, dan semuanya rusak. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lv/02/_u/lv02_ui9sepxlvi7djz_xpem2sy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fragmen kedua juga memiliki set bendera </font></font><code>FitSystemWindow=”true”</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan ini seharusnya tidak terjadi. </font><font style="vertical-align: inherit;">Tetapi apa yang terjadi, mengapa? </font><font style="vertical-align: inherit;">Jawabannya adalah ini adalah penopang, dan terkadang tidak berfungsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi kami menemukan solusi pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stack Overflow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : gunakan root untuk bukan fragmen </font></font><code>FrameLayout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi </font></font><code>CoordinatorLayout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Itu dibuat untuk tujuan lain, tetapi bekerja di sini.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa ini berhasil?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat di sumber apa yang terjadi </font></font><code>CoordinatorLayout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> void onAttachedToWindow() {   
    <span class="hljs-keyword">super</span>.onAttachedToWindow();<font></font>
    ...    <font></font>
    <span class="hljs-keyword">if</span> (mLastInsets == <span class="hljs-literal">null</span> &amp;&amp; ViewCompat.getFitsSystemWindows(<span class="hljs-keyword">this</span>)) {         
        <span class="hljs-comment">// We're set to fitSystemWindows but we haven't had any insets yet...</span>
        <span class="hljs-comment">// We should request a new dispatch of window insets</span>
        ViewCompat.requestApplyInsets(<span class="hljs-keyword">this</span>);<font></font>
    }     <font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melihat komentar indah bahwa insets diperlukan di sini, tetapi tidak. </font><font style="vertical-align: inherit;">Kita perlu bertanya kembali ketika kita meminta jendela. </font><font style="vertical-align: inherit;">Kami menemukan bahwa insets entah bagaimana bekerja di dalam, tetapi kami tidak ingin bekerja dengan mereka dan pergi </font></font><code>Coordinator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada musim semi 2019, kami mengembangkan aplikasi, di mana Google I / O baru saja lewat. </font><font style="vertical-align: inherit;">Kami belum memikirkan semuanya, jadi kami terus berpegang pada prasangka. </font><font style="vertical-align: inherit;">Tapi kami perhatikan bahwa beralih Tab di bagian bawah entah bagaimana lambat, karena kami memiliki tata letak yang kompleks, dimuat dengan UI. </font><font style="vertical-align: inherit;">Kami menemukan cara sederhana untuk mengatasi ini - perubahan </font></font><code>replace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke </font></font><code>show/hide</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehingga setiap kali Anda tidak membuat ulang tata letak.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hx/7l/vz/hx7lvzsl8-kfv3qqac2pbvllt8q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami berubah, dan sekali lagi tidak ada yang berhasil - semuanya telah rusak! </font><font style="vertical-align: inherit;">Tampaknya tidak mungkin untuk menyebarkan kruk, Anda harus mengerti mengapa mereka berhasil. </font><font style="vertical-align: inherit;">Kami mempelajari kode dan ternyata setiap ViewGroup juga dapat bekerja dengan insets.</font></font><br>
<br>
<pre><code class="kotlin hljs">
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> WindowInsets dispatchApplyWindowInsets(WindowInsets insets) {    <font></font>
    insets = <span class="hljs-keyword">super</span>.dispatchApplyWindowInsets(insets);     
    <span class="hljs-keyword">if</span> (!insets.isConsumed()) {         
        <span class="hljs-keyword">final</span> int count = getChildCount();        
        <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; count; i++) {<font></font>
            insets = getChildAt(i).dispatchApplyWindowInsets(insets);             <font></font>
            <span class="hljs-keyword">if</span> (insets.isConsumed()) {          
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> insets;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada logika di dalamnya: jika setidaknya seseorang telah memproses inset, maka semua Tampilan selanjutnya di dalam ViewGroup tidak akan menerimanya. </font><font style="vertical-align: inherit;">Apa artinya ini untuk kita? </font><font style="vertical-align: inherit;">Mari saya tunjukkan contoh FrameLayout kami, yang mengganti Tab. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h1/fo/nn/h1fonnc4qrqpmj_x-fc8m47ptci.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di dalamnya ada fragmen pertama yang memiliki set bendera </font></font><code>fitSystemWindow=”true”</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini berarti bahwa fragmen pertama memproses insets. </font><font style="vertical-align: inherit;">Setelah itu, kita sebut </font></font><code>HIDE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fragmen pertama dan yang </font></font><code>SHOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kedua. </font><font style="vertical-align: inherit;">Tapi yang pertama tetap dalam tata letak - View-nya dibiarkan, hanya disembunyikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wadah melewati View-nya: mengambil fragmen pertama, memberinya inset, dan darinya </font></font><code>fitSystemWindow=”true”</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ia mengambilnya dan memprosesnya. </font><font style="vertical-align: inherit;">Sempurna, FrameLayout melihat bahwa insets diproses, dan tidak memberikannya pada fragmen kedua. </font><font style="vertical-align: inherit;">Semuanya berfungsi sebagaimana mestinya. </font><font style="vertical-align: inherit;">Tapi ini tidak cocok untuk kita, apa yang harus kita lakukan?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menulis ViewGroup kami sendiri</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami datang dari Jawa, dan ada OOP dengan segala kemuliaan, jadi kami memutuskan untuk mewarisi. </font><font style="vertical-align: inherit;">Kami menulis ViewGroup kami sendiri, dari mana kami mendefinisikan ulang metode </font></font><code>dispatchApplyWindowInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini bekerja seperti yang kita butuhkan: selalu memberikan kembali kepada anak-anak inset yang datang, terlepas dari apakah kita memprosesnya atau tidak.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WindowInsetFrameLayout</span> <span class="hljs-meta">@JvmOverloads</span> <span class="hljs-keyword">constructor</span></span>(<font></font>
    context: Context,      <font></font>
    attrs: AttributeSet? = <span class="hljs-literal">null</span>,     <font></font>
    defStyleRes: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span><font></font>
) : FrameLayout(context, attrs, defStyleRes) {<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dispatchApplyWindowInsets</span><span class="hljs-params">(insets: <span class="hljs-type">WindowInsets</span>)</span></span>: WindowInsets { 
        <span class="hljs-keyword">for</span> (child <span class="hljs-keyword">in</span> (<span class="hljs-number">0</span> until childCount)) {<font></font>
            getChildAt(child).dispatchApplyWindowInsets(insets)<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> insets.consumeSystemWindowInsets()<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ViewGroup kustom berfungsi, proyek juga adalah semua yang kita butuhkan. </font><font style="vertical-align: inherit;">Namun dia masih belum mencapai solusi umum. </font><font style="vertical-align: inherit;">Ketika kami mengetahui apa yang mereka katakan di Google IO, kami menyadari bahwa kami tidak akan dapat bertindak seperti itu lagi.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android 10</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Android 10 menunjukkan kepada kita dua konsep UI penting yang sangat dianjurkan untuk dipatuhi: edge-to-edge dan Gestural Navigation. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ujung ke ujung. </font></font></strong><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konsep</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini </font><font style="vertical-align: inherit;">menunjukkan bahwa konten aplikasi harus menempati </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semua ruang yang mungkin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di layar. Bagi kami, sebagai pengembang, ini berarti bahwa aplikasi harus ditempatkan di </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bawah panel sistem Status Bar dan Navigation Bar.</font></font></strong><br>
<br>
<img src="https://habrastorage.org/webt/cr/gl/nh/crglnh9iw__fu4lct0gavaibqey.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sebelumnya, kami dapat mengabaikan hal ini atau hanya ditempatkan di bawah Bilah Status. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adapun daftar, mereka harus gulir tidak hanya ke elemen terakhir, tetapi juga lebih jauh </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agar tidak tetap di bawah Bilah Navigasi.</font></font></strong><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tl/pl/it/tlplit1o65rn55edkixuuojxtha.png" width="350"></div><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Navigasi Gerakan. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konsep penting kedua ini adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">navigasi gerakan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini memungkinkan Anda untuk mengontrol aplikasi dengan jari-jari Anda dari tepi layar. </font><font style="vertical-align: inherit;">Mode gerakan tidak standar, semuanya terlihat berbeda, tetapi sekarang Anda tidak dapat beralih di antara dua Bilah Navigasi yang berbeda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada saat ini, kami menyadari bahwa semuanya tidak begitu sederhana. </font><font style="vertical-align: inherit;">Tidak mungkin menghindari inset lebih lanjut jika kita ingin mengembangkan aplikasi yang berkualitas. </font><font style="vertical-align: inherit;">Saatnya mempelajari dokumentasi dan memahami apa itu insets.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insets </font><font style="vertical-align: inherit;">Apa yang perlu Anda ketahui tentang mereka?</font></font></h2><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insets dibuat untuk menakuti pengembang.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mereka telah melakukan ini dengan sempurna sejak saat itu muncul di Android 5. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, semuanya tidak begitu menakutkan. Konsep insets sederhana - </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mereka melaporkan overlay sistem UI pada layar aplikasi.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini bisa menjadi Bar Navigasi, Bar Status atau keyboard. Keyboard juga merupakan sistem UI biasa, yang ditumpangkan di atas aplikasi. Tidak perlu mencoba memprosesnya dengan kruk, hanya insets. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tujuan insets adalah untuk menyelesaikan konflik</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Misalnya, jika ada elemen lain di atas tombol kami, kami dapat memindahkan tombol sehingga pengguna dapat terus menggunakan aplikasi. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk menangani inset,</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gunakan </font></font><code>Windowlnsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk Android 10 dan </font></font><code>WindowInsetsCompat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk versi lainnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada </font><strong><font style="vertical-align: inherit;">5 jenis insets</font></strong><font style="vertical-align: inherit;"> di Android 10</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan satu "bonus", yang disebut bukan inset, tetapi sebaliknya. </font><font style="vertical-align: inherit;">Kami akan berurusan dengan semua jenis, karena kebanyakan hanya tahu satu hal - System Window Insets.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insets jendela sistem</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diperkenalkan di Android 5.0 (API 21). </font><font style="vertical-align: inherit;">Diperoleh dengan metode </font></font><code>getSystemWindowInsets()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah jenis utama dari insets yang perlu Anda pelajari cara bekerja, karena sisanya bekerja dengan cara yang sama. </font><font style="vertical-align: inherit;">Mereka diperlukan untuk memproses Bilah Status, pertama-tama, dan kemudian Bilah Navigasi dan keyboard. </font><font style="vertical-align: inherit;">Misalnya, mereka memecahkan masalah ketika Bilah Navigasi berada di atas aplikasi. </font><font style="vertical-align: inherit;">Seperti pada gambar: tombol tetap di bawah Bilah Navigasi, pengguna tidak dapat mengkliknya dan sangat tidak senang.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nx/yj/tt/nxyjttdppbkrnrnqkspovzp4hko.png" width="350"></div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insets elemen yang dapat disentuh</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya muncul di Android 10. Diperoleh dengan metode </font></font><code>getTappableElementInsets()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inset ini </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berguna </font><strong><font style="vertical-align: inherit;">untuk menangani berbagai mode Bar Navigasi</font></strong><font style="vertical-align: inherit;"> . Seperti yang dikatakan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chris Bane</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sendiri </font><font style="vertical-align: inherit;">, Anda bisa melupakan jenis inset ini dan hanya berkeliling di System Window Insets. Tetapi jika Anda ingin aplikasi menjadi 100% keren, bukan 99,9% keren, Anda harus menggunakannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lihat gambarnya. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rl/yd/fk/rlydfkwy39pfrc7jfhizhqdkg0q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di atas, warna merah menunjukkan Insets Window Sistem, yang akan datang dalam mode yang berbeda dari Bilah Navigasi. Dapat dilihat bahwa di sebelah kanan dan di sebelah kiri mereka sama dengan Bilah Navigasi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ingat cara kerja navigasi gerakan: dalam mode yang tepat, kami tidak pernah mengklik panel baru, tetapi selalu menyeret jari kami dari bawah ke atas. </font><font style="vertical-align: inherit;">Ini berarti bahwa tombol tidak dapat dihapus. </font><font style="vertical-align: inherit;">Kita dapat terus menekan tombol FAB (Floating Action Button) kami, tidak ada yang akan mengganggu. </font><font style="vertical-align: inherit;">Oleh karena itu, </font></font><code>TappableElementInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan kosong karena FAB tidak perlu bergerak. </font><font style="vertical-align: inherit;">Tetapi jika kita bergerak sedikit lebih tinggi, tidak apa-apa. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perbedaannya hanya muncul dengan navigasi gerakan dan Navigasi Bar transparan</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (adaptasi warna). </font><font style="vertical-align: inherit;">Ini bukan situasi yang sangat menyenangkan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zv/ei/qz/zveiqz33n9dc290ib9yhrrjl09u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya akan berfungsi, tetapi terlihat tidak menyenangkan. </font><font style="vertical-align: inherit;">Pengguna mungkin bingung oleh kedekatan elemen. </font><font style="vertical-align: inherit;">Dapat dijelaskan bahwa satu untuk gerakan dan yang lainnya untuk menekan, tetapi masih tidak cantik. </font><font style="vertical-align: inherit;">Karena itu, naikkan FAB lebih tinggi atau tinggalkan di sebelah kanan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insets gerakan sistem</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya muncul di Android 10. Diperoleh dengan metode </font></font><code>getSystemGestureInsets()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insets ini terkait dengan navigasi gerakan. Awalnya, diasumsikan bahwa sistem UI ditarik di atas aplikasi, tetapi System Gesture Insets mengatakan bahwa itu bukan UI yang ditarik, tetapi sistem itu sendiri yang menangani gerakan. Mereka menggambarkan di mana sistem akan menangani gerakan secara default. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Area-area inset ini kira-kira ditandai dengan warna kuning pada diagram. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/8d/jl/vv8djlgxe4cnjchozbllrysagd0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi saya ingin memperingatkan Anda - mereka tidak akan selalu seperti itu. Kita tidak akan pernah tahu apa layar baru Samsung dan produsen lain akan muncul. Sudah ada perangkat di mana layar ada di semua sisi. Mungkin insets tidak akan berada di tempat yang kita harapkan sama sekali. Oleh karena itu, Anda perlu bekerja dengan mereka seperti dengan beberapa abstraksi: ada insets seperti itu di System Gesture Insets di mana sistem itu sendiri memproses gerakan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insets ini dapat diganti. </font><font style="vertical-align: inherit;">Misalnya, Anda sedang mengembangkan editor foto. </font><font style="vertical-align: inherit;">Di beberapa tempat, Anda sendiri ingin menangani gerakan, meskipun mereka berada di dekat tepi layar. </font><font style="vertical-align: inherit;">Tunjukkan ke sistem bahwa Anda akan memproses titik pada layar di sudut foto sendiri. </font><font style="vertical-align: inherit;">Itu dapat didefinisikan ulang dengan memberi tahu sistem: "Saya akan selalu memproses alun-alun sendiri."</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insets gesture sistem wajib</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muncul hanya di Android 10. Ini adalah subtipe dari System Gesture Insets, tetapi tidak dapat ditimpa oleh aplikasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menggunakan metode </font></font><code>getMandatorySystemGestureInsets()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk menentukan area di mana mereka tidak akan bekerja. </font><font style="vertical-align: inherit;">Ini dilakukan dengan sengaja sehingga tidak mungkin untuk mengembangkan aplikasi "putus asa": mendefinisikan kembali gerakan navigasi dari bawah ke atas, yang memungkinkan Anda untuk keluar dari aplikasi ke layar utama. </font><font style="vertical-align: inherit;">Di sini, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sistem selalu memproses gerakan itu sendiri</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/89/gl/df/89gldfknoq8z9dje_naytwp0pti.png" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak harus itu akan di bagian bawah perangkat dan belum tentu sebesar ini. </font><font style="vertical-align: inherit;">Bekerja dengannya sebagai abstraksi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah jenis insets yang relatif baru. </font><font style="vertical-align: inherit;">Tetapi ada yang muncul bahkan sebelum Android 5 dan dipanggil secara berbeda.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inset yang stabil</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diperkenalkan dengan Android 5.0 (API 21). Diperoleh dengan metode </font></font><code>getStableInsets()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan pengembang yang berpengalaman tidak selalu dapat mengatakan mengapa mereka dibutuhkan. Saya akan memberi tahu Anda rahasia: insets ini hanya berguna untuk aplikasi layar penuh: pemutar video, game. Misalnya, dalam mode pemutaran, semua UI sistem disembunyikan, termasuk Bilah Status, yang bergerak di luar tepi layar. Tapi ada baiknya menyentuh layar, karena Bilah Status akan muncul di atas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda meletakkan tombol KEMBALI di bagian atas layar, saat ia memproses System Window Insets dengan benar, maka dengan setiap Tab, sebuah UI muncul di layar dari atas, dan tombol itu melompat ke bawah. Jika Anda tidak menyentuh layar untuk sementara waktu, Bilah Status menghilang, tombol memantul karena Insets Jendela Sistem telah menghilang.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk kasus seperti itu, Stable Insets tepat. </font><font style="vertical-align: inherit;">Mereka mengatakan bahwa sekarang tidak ada elemen yang ditarik pada aplikasi Anda, tetapi dapat melakukannya. </font><font style="vertical-align: inherit;">Dengan insets ini, Anda dapat mengetahui terlebih dahulu nilai dari Bilah Status dalam mode ini, misalnya, dan posisikan tombol di mana Anda inginkan. </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan. </font><font style="vertical-align: inherit;">Metode ini </font></font></em><code><em>getStableInsets()</em></code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya muncul dengan API 21. Sebelumnya, ada beberapa metode untuk setiap sisi layar.&nbsp;</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memeriksa 5 jenis inset, tetapi ada satu lagi yang tidak berlaku untuk inset secara langsung. </font><font style="vertical-align: inherit;">Ini membantu menangani poni dan guntingan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poni dan garis leher</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Layar tidak lagi persegi. </font><font style="vertical-align: inherit;">Mereka lonjong, dengan satu atau lebih guntingan untuk kamera dan poni di semua sisi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ls/kv/sc/lskvscp_j-hy2gesyynicb346cq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hingga 28 API kami tidak dapat memprosesnya. </font><font style="vertical-align: inherit;">Saya harus menebak melalui insets apa yang terjadi di sana. </font><font style="vertical-align: inherit;">Tetapi dengan 28 API dan seterusnya (dari Android sebelumnya), kelas secara resmi muncul </font></font><code>DisplayCutout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ada dalam insets yang sama dari mana Anda bisa mendapatkan semua jenis lainnya. </font><font style="vertical-align: inherit;">Kelas ini memungkinkan Anda untuk mengetahui lokasi dan ukuran artefak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain informasi lokasi, satu set bendera y disediakan untuk pengembang </font></font><code>WindowManager.LayoutParams</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mereka memungkinkan Anda untuk memasukkan berbagai perilaku di sekitar guntingan. </font><font style="vertical-align: inherit;">Konten Anda dapat ditampilkan di sekitarnya, atau mungkin tidak ditampilkan: dalam mode lansekap dan potret dengan berbagai cara. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bendera</font></font><code>window.attributes.layoutInDisplayCutoutMode =</code><br>
<br>
<ul>
<li><code>LAYOUT_IN_DISPLAY_CUTOUT_MODE_DEFAULT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dalam potret - ada, dan dalam lanskap - bilah hitam secara default.</font></font></li>
<li><code>LAYOUT_IN_DISPLAY_CUTOUT_MODE_NEVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tidak sama sekali - garis hitam.</font></font></li>
<li><code>LAYOUT_IN_DISPLAY_CUTOUT_MODE_SHORT_EDGES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - selalu begitu.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Layar dapat dikontrol, tetapi kami bekerja dengan mereka dengan cara yang sama dengan Insets lainnya.</font></font><br>
<br>
<pre><code class="kotlin hljs">insets.displayCutout<font></font>
    .boundingRects<font></font>
    .forEach { rect -&gt; ... }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Panggilan balik dengan insets dengan array datang kepada kami </font></font><code>displayCutout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Lalu kita bisa menjalankannya, memproses semua potongan dan poni yang ada di aplikasi. </font><font style="vertical-align: inherit;">Anda dapat mempelajari lebih lanjut tentang cara bekerja dengan mereka </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dipahami dengan 6 jenis insets. </font><font style="vertical-align: inherit;">Sekarang mari kita bicara tentang cara kerjanya.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana itu bekerja</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insets diperlukan, pertama-tama, ketika sesuatu digambar di atas aplikasi, misalnya, Bilah Navigasi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ft/ct/_w/ftct_wh_dc64t9rw6ir_7zpqg8m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tanpa insets, aplikasi tidak akan memiliki Bilah Navigasi dan Bilah Status yang transparan. </font><font style="vertical-align: inherit;">Jangan kaget bahwa Anda tidak datang </font></font><code>SystemWindowInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ini terjadi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebarkan insets</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seluruh hierarki UI terlihat seperti pohon dengan Tampilan di ujungnya. </font><font style="vertical-align: inherit;">Node biasanya merupakan ViewGroup. </font><font style="vertical-align: inherit;">Mereka juga mewarisi dari View, jadi insets datang kepada mereka dengan cara khusus </font></font><code>dispatchApplyWindowInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mulai dari tampilan root, sistem mengirim insets ke seluruh pohon. </font><font style="vertical-align: inherit;">Mari kita lihat bagaimana View bekerja dalam hal ini.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jy/rw/hk/jyrwhkavrimytpqs4je0ltfn7-w.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sistem menyebutnya metode </font></font><code>dispatchApplyWindowInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang digunakan insets. </font><font style="vertical-align: inherit;">Kembali tampilan ini harus mengembalikan sesuatu. </font><font style="vertical-align: inherit;">Apa yang harus dilakukan untuk menangani perilaku ini? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk kesederhanaan, kami hanya mempertimbangkan WindowInsets.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menangani insets</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, redefinisi metode </font></font><code>dispatchApplyWindowInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan implementasi di dalam logikanya sendiri </font><font style="vertical-align: inherit;">tampak logis </font><font style="vertical-align: inherit;">: insets datang, kami mengimplementasikan semua yang ada di dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda membuka kelas Lihat dan melihat Javadoc yang ditulis di atas metode ini, Anda dapat melihat: "Jangan menimpa metode ini!"</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menangani Insets melalui pendelegasian atau pewarisan.</font></font></blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gunakan delegasi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Google memberikan kesempatan untuk mengekspos delegasinya sendiri, yang bertanggung jawab untuk menangani inset. </font><font style="vertical-align: inherit;">Anda dapat menginstalnya melalui metode ini </font></font><code>setOnApplyWindowInsetsListener(listener)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kami menetapkan callback yang menangani inset ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika karena alasan tertentu ini tidak sesuai dengan kami, Anda dapat </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mewarisi dari Lihat dan mengganti metode lain</font></font></strong> <code>onApplyWindowInsets(WindowInsets insets)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kami mengganti insets kita sendiri ke dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google tidak memilih antara delegasi dan warisan, tetapi diizinkan untuk melakukan semuanya bersama. </font><font style="vertical-align: inherit;">Ini hebat karena kami tidak perlu mendefinisikan ulang semua Toolbar atau ListView untuk menangani insets. </font><font style="vertical-align: inherit;">Kita dapat mengambil View yang sudah jadi, bahkan yang sudah ada di perpustakaan, dan mengatur delegasi di sana, yang akan menangani insets tanpa redefinisi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa yang akan kami kembalikan?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kenapa mengembalikan sesuatu?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melakukan ini, Anda perlu memahami cara distribusi insets, mis., ViewGroup, berfungsi. </font><font style="vertical-align: inherit;">Apa yang dia lakukan di dalam dirinya. </font><font style="vertical-align: inherit;">Mari kita lihat lebih dekat perilaku default menggunakan contoh yang saya tunjukkan sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insets sistem datang di bagian atas dan bawah, misalnya, masing-masing 100 piksel. </font><font style="vertical-align: inherit;">ViewGroup mengirimkannya ke Tampilan pertama yang dimilikinya. </font><font style="vertical-align: inherit;">Tampilan ini menanganinya dan mengembalikan insets: di atasnya berkurang menjadi 0, tetapi di bagian bawah ia meninggalkan. </font><font style="vertical-align: inherit;">Di bagian atas, dia menambahkan padding atau margin, tetapi di bagian bawah dia tidak menyentuh dan melaporkan ini. </font><font style="vertical-align: inherit;">Selanjutnya, ViewGroup meneruskan insets ke View kedua. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tj/-a/rw/tj-arwxjkus-n6xnvl099lqbqqg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lihat selanjutnya memproses dan merender insets. </font><font style="vertical-align: inherit;">Sekarang ViewGroup melihat bahwa insets diproses di atas dan di bawah - tidak ada yang tersisa, semua parameternya nol. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandangan ketiga bahkan tidak tahu bahwa ada beberapa inset dan sesuatu sedang terjadi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ViewGroup akan mengembalikan insets kembali kepada orang yang mengekspos mereka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika kami mulai berurusan dengan topik ini, kami menuliskan ide untuk kami sendiri - selalu mengembalikan insets yang sama yang datang. </font><font style="vertical-align: inherit;">Kami ingin menghindari situasi seperti itu ketika beberapa View bahkan tidak mengenali bahwa ada insets. </font><font style="vertical-align: inherit;">Idenya terlihat logis. </font><font style="vertical-align: inherit;">Tapi ternyata tidak. </font><font style="vertical-align: inherit;">Google belum menambahkan perilaku sia-sia untuk insets, seperti dalam contoh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini diperlukan agar insets selalu mencapai seluruh hierarki Tampilan dan Anda selalu dapat bekerja dengannya. </font><font style="vertical-align: inherit;">Dalam hal ini, tidak akan ada situasi ketika kami mengganti dua fragmen, satu telah diproses, dan yang kedua belum diterima. </font><font style="vertical-align: inherit;">Di bagian latihan, kami akan kembali ke titik ini.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Praktek</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teori sudah selesai. </font><font style="vertical-align: inherit;">Mari kita lihat tampilannya dalam kode, karena secara teori semuanya selalu mulus. </font><font style="vertical-align: inherit;">Kami akan menggunakan AndroidX. </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan. </font><font style="vertical-align: inherit;">Di </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitFox,</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semuanya sudah diimplementasikan dalam kode, dukungan penuh untuk semua barang dari Android baru. </font><font style="vertical-align: inherit;">Agar tidak memeriksa versi Android dan tidak mencari tipe Insets yang diperlukan, selalu gunakan </font></font></em><code><em>view.setOnApplyWindowInsetsListener { v, insets -&gt; ... }</em></code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi dari AndroidX - </font></font></em><font style="vertical-align: inherit;"><em><font style="vertical-align: inherit;">sebagai gantinya </font></em></font><code><em>ViewCompat.setOnApplyWindowInsetsListener(view) { v, insets -&gt; ... }</em></code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada layar dengan Bar Navigasi gelap. </font><font style="vertical-align: inherit;">Itu tidak tumpang tindih elemen apa pun di atas. </font><font style="vertical-align: inherit;">Semuanya adalah cara kita terbiasa.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3r/wq/sp/3rwqspgcdlgie2m00lmedkwzgi8.png" width="350"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi ternyata sekarang kita perlu membuatnya transparan. </font><font style="vertical-align: inherit;">Bagaimana?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nyalakan transparansi</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal yang paling sederhana adalah menunjukkan dalam subjek bahwa Status Bar dan Navigation Bar transparan.</font></font><br>
<br>
<pre><code class="kotlin hljs">&lt;style name=<span class="hljs-string">"AppTheme"</span> parent=<span class="hljs-string">"Theme.MaterialComponents.Light"</span>&gt;<font></font>
    &lt;item name=<span class="hljs-string">"android:windowTranslucentStatus"</span>&gt;<span class="hljs-literal">true</span>&lt;/item&gt;<font></font>
    &lt;item name=<span class="hljs-string">"android:windowTranslucentNavigation"</span>&gt;<span class="hljs-literal">true</span>&lt;/item&gt;<font></font>
&lt;/style&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada saat ini, semuanya mulai saling tumpang tindih baik dari atas maupun dari bawah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menariknya, ada dua bendera, dan selalu ada tiga opsi. Jika Anda menentukan transparansi untuk Bilah Navigasi, Bilah Status akan menjadi transparan dengan sendirinya - pembatasan seperti itu. </font><font style="vertical-align: inherit;">Anda tidak dapat menulis baris pertama, tetapi saya selalu suka kejelasan, jadi saya menulis 2 baris sehingga pengikut dapat memahami apa yang terjadi, dan tidak menggali di dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda memilih metode ini, Bilah Navigasi dan Bilah Status akan berubah menjadi hitam dengan transparansi. </font><font style="vertical-align: inherit;">Jika aplikasi berwarna putih, maka Anda dapat menambahkan warna hanya dari kode. </font><font style="vertical-align: inherit;">Bagaimana cara melakukannya?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nyalakan transparansi dengan warna</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada baiknya kami memiliki aplikasi Aktivitas Tunggal, jadi kami menempatkan dua bendera dalam satu aktivitas.</font></font><br>
<br>
<pre><code class="kotlin hljs">rootView.systemUiVisibility = View.SYSTEM_UI_FLAG_LAYOUT_STABLE or  <font></font>
    View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION<font></font>
<font></font>
&lt;style name=<span class="hljs-string">"AppTheme"</span> parent=<span class="hljs-string">"Theme.MaterialComponents.Light"</span>&gt;<font></font>
    &lt;!-- Set the navigation bar to <span class="hljs-number">50</span>% translucent white --&gt;<font></font>
    &lt;item name=<span class="hljs-string">"android:navigationBarColor"</span>&gt;#<span class="hljs-number">80F</span>FFFFF&lt;/item&gt; <font></font>
&lt;/style&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada banyak bendera di sana, tetapi keduanya inilah yang akan membantu membuat transparansi di Bilah Navigasi dan Bilah Status. </font><font style="vertical-align: inherit;">Warna dapat ditentukan melalui tema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah perilaku aneh Android: sesuatu melalui tema, dan sesuatu melalui bendera. </font><font style="vertical-align: inherit;">Tapi kita bisa menentukan parameter dalam kode dan subjek. </font><font style="vertical-align: inherit;">Ini bukan Android begitu buruk, hanya pada Android versi lama bendera yang ditentukan dalam topik akan diabaikan. </font></font><code>navigationBarColor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini akan menyoroti bahwa di Android 5 ini tidak, tetapi semuanya akan datang bersama. </font><font style="vertical-align: inherit;">Di GitFox, dari kode itulah saya mengatur warna Bilah Navigasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melakukan penipuan - menunjukkan bahwa Bilah Navigasi berwarna putih dengan transparansi. </font><font style="vertical-align: inherit;">Sekarang aplikasi terlihat seperti ini.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/eo/vs/mz/eovsmz1tczlc9vl_kg2yihxs0u0.png" width="350"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang bisa lebih mudah daripada menangani insets?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memang dasar.</font></font><br>
<br>
<pre><code class="kotlin hljs">ViewCompat<font></font>
    .setOnApplyWindowInsetsListener(bottomNav) { view, insets -&gt;  <font></font>
        view.updatePadding(bottom = insets.systemWindowInsetBottom) <font></font>
        insets<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengambil metode </font></font><code>setOnApplyWindowInsetsListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan meneruskannya ke dalamnya </font></font><code>bottomNav</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kami mengatakan bahwa ketika insets datang, instal padding bawah yang masuk </font></font><code>systemWindowInsetBottom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kami menginginkannya di bawah, tetapi semua elemen yang dapat diklik berada di atas. </font><font style="vertical-align: inherit;">Kami mengembalikan sepenuhnya insets sehingga semua View lain dalam hierarki kami juga menerimanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya tampak hebat.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zl/8e/ku/zl8ekuc_pvpc2wrmeop-khxmomg.png" width="350"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi ada yang menangkap. </font><font style="vertical-align: inherit;">Jika dalam tata letak kami menunjukkan semacam padding di Bilah Navigasi di bawah ini, maka di sini dihapus - setel </font></font><code>updatePadding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inset yang sama. </font><font style="vertical-align: inherit;">Tata letak kami tidak seperti yang kami inginkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menyimpan nilai dari tata letak, Anda harus terlebih dahulu menyimpan apa yang ada di padding bawah. </font><font style="vertical-align: inherit;">Kemudian, ketika insets tiba, tambahkan dan atur nilai yang dihasilkan.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> bottomNavBottomPadding = bottomNav.paddingBottom<font></font>
ViewCompat<font></font>
    .setOnApplyWindowInsetsListener(bottomNav) { view, insets -&gt;                 <font></font>
        view.updatePadding(<font></font>
        bottom = bottomNavBottomPadding + insets.systemWindowInsetBottom<font></font>
    )<font></font>
    Insets<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak nyaman untuk menulis dengan cara ini: di mana pun dalam kode tempat Anda menggunakan inset, Anda perlu menyimpan nilai dari tata letak, lalu menambahkannya ke UI. </font><font style="vertical-align: inherit;">Tapi ada Kotlin, dan ini luar biasa - Anda dapat menulis ekstensi Anda sendiri, yang akan melakukan semua ini untuk kami.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan Kotlin!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami ingat </font></font><code>initialPadding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan memberikannya kepada pawang ketika insets baru datang (bersama mereka). </font><font style="vertical-align: inherit;">Ini akan membantu mereka entah bagaimana menambahkan bersama atau membangun semacam logika dari atas.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword">fun</span> View.<span class="hljs-title">doOnApplyWindowInsets</span><span class="hljs-params">(block: (<span class="hljs-type">View</span>, <span class="hljs-type">WindowInsetsCompat</span>, <span class="hljs-type">Rect</span>) -&gt; <span class="hljs-type">WindowInsetsCompat</span>)</span></span> {    <font></font>
<font></font>
    <span class="hljs-keyword">val</span> initialPadding = recordInitialPaddingForView(<span class="hljs-keyword">this</span>)<font></font>
<font></font>
    ViewCompat.setOnApplyWindowInsetsListener(<span class="hljs-keyword">this</span>) { v, insets -&gt;        <font></font>
        block(v, insets, initialPadding)<font></font>
    }<font></font>
    <font></font>
    requestApplyInsetsWhenAttached()<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">recordInitialPaddingForView</span><span class="hljs-params">(view: <span class="hljs-type">View</span>)</span></span> =<font></font>
   Rect(view.paddingLeft, view.paddingTop, view.paddingRight, view.paddingBottom)<font></font>
<font></font>
  .<font></font>
<font></font>
bottomNav.doOnApplyWindowInsets { view, insets, padding -&gt;   <font></font>
    view.updatePadding(<font></font>
        bottom = padding.bottom + insets.systemWindowInsetBottom<font></font>
    ) <font></font>
    insets<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita harus mendefinisikan kembali lambda. </font><font style="vertical-align: inherit;">Tidak hanya memiliki insets, tetapi juga paddings. </font><font style="vertical-align: inherit;">Kami dapat menambahkan mereka tidak hanya dari bawah, tetapi juga dari atas, jika itu adalah Bilah Alat yang memproses Bilah Status.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sesuatu dilupakan!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada panggilan ke metode yang tidak bisa dipahami.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword">fun</span> View.<span class="hljs-title">doOnApplyWindowInsets</span><span class="hljs-params">(block: (<span class="hljs-type">View</span>, <span class="hljs-type">WindowInsetsCompat</span>, <span class="hljs-type">Rect</span>) -&gt; <span class="hljs-type">WindowInsetsCompat</span>)</span></span> {<font></font>
<font></font>
    <span class="hljs-keyword">val</span> initialPadding = recordInitialPaddingForView(<span class="hljs-keyword">this</span>)<font></font>
     <font></font>
    ViewCompat.setOnApplyWindowInsetsListener(<span class="hljs-keyword">this</span>) { v, insets -&gt;        <font></font>
        block(v, insets, initialPadding)<font></font>
    }<font></font>
      <font></font>
    requestApplyInsetsWhenAttached() <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">recordInitialPaddingForView</span><span class="hljs-params">(view: <span class="hljs-type">View</span>)</span></span> =<font></font>
      Rect(view.paddingLeft, view.paddingTop, view.paddingRight, view.paddingBottom)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini disebabkan oleh fakta bahwa Anda tidak bisa hanya berharap bahwa sistem akan mengirimi Anda inset. </font><font style="vertical-align: inherit;">Jika kita membuat tampilan dari kode atau menginstal </font></font><code>InsetsListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sedikit lebih lama, sistem itu sendiri mungkin tidak melewati nilai terakhir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami harus memeriksa bahwa ketika Lihat di layar, kami memberi tahu sistem: "Insets telah tiba, kami ingin memprosesnya." </font><font style="vertical-align: inherit;">Kami mengatur Pendengar dan harus membuat permintaan </font></font><code>requestsApplyInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. "</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword">fun</span> View.<span class="hljs-title">requestApplyInsetsWhenAttached</span><span class="hljs-params">()</span></span> {    
    <span class="hljs-keyword">if</span> (isAttachedToWindow) {        <font></font>
        requestApplyInsets()<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        addOnAttachStateChangeListener(<span class="hljs-keyword">object</span> : View.OnAttachStateChangeListener {            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewAttachedToWindow</span><span class="hljs-params">(v: <span class="hljs-type">View</span>)</span></span> {<font></font>
                v.removeOnAttachStateChangeListener(<span class="hljs-keyword">this</span>)<font></font>
                v.requestApplyInsets()           <font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewDetachedFromWindow</span><span class="hljs-params">(v: <span class="hljs-type">View</span>)</span></span> = <span class="hljs-built_in">Unit</span><font></font>
        })<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika kami membuat kode Tampilan dan belum melampirkannya ke tata letak kami, maka kami harus berlangganan waktu kapan kami melakukannya. </font><font style="vertical-align: inherit;">Hanya kemudian kami meminta insets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi sekali lagi, ada Kotlin: mereka menulis ekstensi sederhana dan kita tidak perlu memikirkannya lagi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memperbaiki RecyclerView</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita bicara tentang menyelesaikan RecyclerView. Elemen terakhir jatuh di bawah Bilah Navigasi dan tetap di bawah - jelek. Juga tidak nyaman untuk mengkliknya. Jika ini bukan panel baru, tapi yang lama, yang besar, maka secara umum seluruh elemen mungkin hilang di bawahnya. Apa yang harus dilakukan? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jc/qa/f7/jcqaf7okahkrhrrnols54exqhdu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gagasan pertama adalah menambahkan elemen di bawah ini, dan mengatur ketinggian agar sesuai dengan insets. Tetapi jika kita memiliki aplikasi dengan ratusan daftar, maka entah bagaimana kita harus berlangganan setiap daftar ke insets, tambahkan elemen baru di sana dan atur tingginya. Selain itu, RecyclerView asynchronous, tidak diketahui kapan akan bekerja. Ada banyak masalah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi ada peretasan resmi lainnya. Anehnya, ini bekerja secara efisien.</font></font><br>
<br>
<pre><code class="kotlin hljs">&lt;androidx.recyclerview.widget.RecyclerView <font></font>
        android:id=<span class="hljs-string">"@+id/recyclerView"</span>        
    android:layout_width=<span class="hljs-string">"match_parent"</span>    
    android:layout_height=<span class="hljs-string">"match_parent"</span>             
    android:clipToPadding=<span class="hljs-string">"false"</span> /&gt;<font></font>
<font></font>
recyclerView.doOnApplyWindowInsets { view, insets, padding -&gt;    <font></font>
    view.updatePadding(<font></font>
        bottom = padding.bottom + insets.systemWindowInsetBottom<font></font>
    )<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada bendera seperti itu di tata letak </font></font><code>clipToPadding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Secara default, selalu benar. Ini menunjukkan bahwa Anda tidak perlu menggambar elemen yang muncul di mana bantalan diekspos. Tetapi jika diatur </font></font><code>clipToPadding="false"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, maka Anda bisa menggambar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, jika Anda mengatur padding ke bawah, di RecyclerView itu akan berfungsi seperti ini: padding diatur ke bawah, dan elemen digambar di atasnya sampai kita gulir. Setelah mencapai akhir, RecyclerView akan menggulir elemen ke posisi yang kita butuhkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan mengatur satu flag seperti itu, kita dapat bekerja dengan RecyclerView seperti dengan Tampilan normal. Jangan berpikir bahwa ada elemen yang menggulir - cukup setel bantalan di bawah ini, seperti, misalnya, di Bilah Navigasi Bawah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kami selalu mengembalikan insets seolah-olah tidak diproses. </font><font style="vertical-align: inherit;">Seluruh inset datang kepada kami, kami melakukan sesuatu dengan mereka, mengatur bantalan dan mengembalikan semua inset lagi. </font><font style="vertical-align: inherit;">Ini diperlukan agar setiap ViewGroup selalu meneruskan inset ini ke semua View. </font><font style="vertical-align: inherit;">Berhasil.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bug aplikasi</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di banyak aplikasi di Google Play yang sudah memproses insets, saya perhatikan ada bug kecil. Sekarang saya akan menceritakan tentang dia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada layar dengan navigasi di ruang bawah tanah. Di sebelah kanan adalah layar yang sama yang menunjukkan hierarki. Fragmen hijau menampilkan konten di layar, di dalamnya ada RecyclerView. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hl/e6/jo/hle6jod0ws19fydq734lqnuaixu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Siapa yang menangani inset di sini? Bilah Alat: ia menerapkan lapisan di atas sehingga kontennya bergerak di bawah Bilah Status. Dengan demikian, Bilah Navigasi Bawah menerapkan insets dari bawah dan naik di atas Bilah Navigasi. Tetapi RecyclerView tidak menangani insets dengan cara apa pun, tidak termasuk di dalamnya, tidak perlu memproses insets - semuanya dilakukan dengan benar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/xc/qi/r3xcqipovgqu-zbbxruxsy-wqvk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi di sini ternyata kita ingin menggunakan fragmen RecyclerView hijau di tempat lain di mana Bilah Navigasi Bawah tidak lagi ada. Pada titik ini, RecyclerView sudah mulai menangani insets dari bawah. Kita perlu menerapkan pelapis untuk menggulir dengan benar dari bawah Bilah Navigasi. Oleh karena itu, dalam RecyclerView, kami juga menambahkan pemrosesan inset. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ve/ws/m-/vewsm-_o80cw7mbn9tyk0bu_mfs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami kembali ke layar kami, tempat semua orang memproses insets. Ingat, tidak ada yang melaporkan bahwa dia memprosesnya? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/um/vd/x8/umvdx8faxxk48r-inx-cxhkjqdm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita melihat situasi ini: RecyclerView memproses insets dari bawah, meskipun ia tidak mencapai Bilah Navigasi - ruang muncul di bagian bawah. Saya perhatikan ini dalam aplikasi, dan cukup besar dan populer.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i9/3_/ar/i93_arxauyvbitayfpyonkxnudy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika ini masalahnya, kami ingat bahwa kami mengembalikan semua inset untuk diproses. Jadi (ternyata!) Penting untuk melaporkan bahwa insets diproses: Bar Navigasi harus melaporkan bahwa insets diproses. Mereka seharusnya tidak sampai ke RecyclerView. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jf/r2/vi/jfr2vi8jpsas_ptxjjqh_qhg1vk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melakukan ini, instal Bilah Navigasi Bawah </font></font><code>InsetsListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Kurangi di dalam </font></font><code>bottom + insets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bahwa mereka tidak diproses, kembalikan 0.</font></font><br>
<br>
<pre><code class="kotlin hljs">doOnApplyWindowInsets { view, insets, initialPadding -&gt;    <font></font>
    view.updatePadding(<font></font>
        bottom = initialPadding.bottom + insets.systemWindowInsetBottom<font></font>
    )<font></font>
    insets.replaceSystemWindowInsets(<font></font>
        Rect(<font></font>
            insets.systemWindowInsetLeft,            <font></font>
            insets.systemWindowInsetTop,            <font></font>
            insets.systemWindowInsetRight,<font></font>
            <span class="hljs-number">0</span><font></font>
        )<font></font>
    )<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengembalikan insets baru, di mana semua parameter lama sama, tetapi </font></font><code>bottom + insets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sama dengan 0. Tampaknya semuanya baik-baik saja. </font><font style="vertical-align: inherit;">Kami mulai dan lagi omong kosong - RecyclerView masih menangani inset karena beberapa alasan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lp/yw/ut/lpywut3fvlk5w-nwbd3-wnrceaw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak segera mengerti bahwa masalahnya adalah wadah untuk ketiga Tampilan ini adalah LinearLayout. </font><font style="vertical-align: inherit;">Di dalamnya ada Bilah Alat, cuplikan dengan RecyclerView dan di bagian bawah Bilah Navigasi Bawah. </font><font style="vertical-align: inherit;">LinearLayout mengambil anak-anaknya secara berurutan dan menerapkan insets kepada mereka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata Bilah Navigasi Bawah akan menjadi yang terakhir. </font><font style="vertical-align: inherit;">Dia mengatakan kepada seseorang bahwa dia memproses semua inset, tetapi sudah terlambat. </font><font style="vertical-align: inherit;">Semua inset diproses dari atas ke bawah, RecyclerView telah menerimanya, dan ini tidak menyelamatkan kita. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uj/mm/jd/ujmmjdgumv0bl6e0ewydx7ueq5g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa yang harus dilakukan? </font><font style="vertical-align: inherit;">LinearLayout tidak berfungsi seperti yang saya inginkan, itu mentransfer mereka dari atas ke bawah, dan saya harus mendapatkan yang bawah terlebih dahulu.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapkan Semua</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengembang Java bermain dalam diri saya - </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semuanya</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perlu </font><strong><font style="vertical-align: inherit;">didefinisikan ulang</font></strong><font style="vertical-align: inherit;"> ! </font><font style="vertical-align: inherit;">Nah, sekarang </font></font><code>dispatchApplyWindowInsets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definisikan ulang, atur </font></font><code>yLinearLayout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang akan selalu pergi dari bawah ke atas. </font><font style="vertical-align: inherit;">Dia pertama-tama akan mengirim insets Bottom Navigation Bar, dan kemudian ke orang lain.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> WindowInsets dispatchApplyWindowInsets(WindowInsets insets) {     <font></font>
    insets = <span class="hljs-keyword">super</span>.dispatchApplyWindowInsets(insets);     
    <span class="hljs-keyword">if</span> (!insets.isConsumed()) {        
        <span class="hljs-keyword">final</span> int count = getChildCount();
        <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; count; i++) {<font></font>
            insets = getChildAt(i).dispatchApplyWindowInsets(insets);<font></font>
            <span class="hljs-keyword">if</span> (insets.isConsumed()) {
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> insets;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi saya berhenti tepat waktu, mengingat komentar bahwa tidak perlu mendefinisikan kembali metode ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini, sedikit lebih tinggi adalah keselamatan: ViewGroup memeriksa delegasi yang memproses insets, kemudian memanggil metode super pada View dan memungkinkan pemrosesan sendiri. </font><font style="vertical-align: inherit;">Dalam kode ini, kita mendapatkan insets, dan jika belum diproses, kita mulai logika standar untuk anak-anak kita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menulis ekstensi sederhana. </font><font style="vertical-align: inherit;">Hal ini memungkinkan, berlaku </font></font><code>InsetsListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk satu Tampilan, untuk mengatakan kepada siapa insets ini lulus.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword">fun</span> View.<span class="hljs-title">addSystemBottomPadding</span><span class="hljs-params">(    
    targetView: <span class="hljs-type">View</span> = this
)</span></span> {<font></font>
    doOnApplyWindowInsets { _, insets, initialPadding -&gt;           <font></font>
        targetView.updatePadding(<font></font>
            bottom = initialPadding.bottom + insets.systemWindowInsetBottom<font></font>
        )<font></font>
        insets.replaceSystemWindowInsets(<font></font>
            Rect(<font></font>
                insets.systemWindowInsetLeft,<font></font>
                insets.systemWindowInsetTop,     <font></font>
                insets.systemWindowInsetRight,<font></font>
                <span class="hljs-number">0</span><font></font>
            )<font></font>
        )<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini </font></font><code>targetView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sama dengan default untuk tampilan yang sama di atas yang kami terapkan </font></font><code>addSystemBottomPadding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kita bisa mendefinisikannya kembali. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di LinearLayout saya, saya menggantung handler, melewati </font></font><code>targetView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini adalah Bottom Navigation Bar saya.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama dia akan memberikan insets Bottom Navigation Bar.&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Itu akan memproses insets, akan mengembalikan nol bawah.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selanjutnya, secara default, mereka akan pergi dari atas ke bawah: Toolbar, fragmen dengan RecyclerView.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lalu, mungkin, dia akan kembali mengirim insets Bottom Navigation Bar. </font><font style="vertical-align: inherit;">Tapi ini tidak lagi penting, semuanya akan bekerja dengan baik.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mencapai apa yang saya inginkan: semua inset diproses sesuai urutan yang dibutuhkan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s3/b0/nc/s3b0nc07bayude3nvrvevkxnwyc.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penting</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa hal penting yang perlu diingat. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keyboard adalah UI sistem di atas aplikasi Anda.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak perlu memperlakukannya dengan cara khusus. Jika Anda melihat keyboard Google, itu bukan Layout dengan tombol yang bisa Anda klik. Ada ratusan mode untuk keyboard ini: mencari gif dan meme, input suara, mengubah ukuran dari 10 piksel hingga ukuran layar. Jangan berpikir tentang keyboard, tetapi berlangganan insets. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laci Navigasi masih tidak mendukung navigasi gerakan</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Di Google IO, mereka berjanji bahwa semuanya akan berjalan baik. </font><font style="vertical-align: inherit;">Tetapi di Android 10, Navigasi Drawer masih tidak mendukung ini. </font><font style="vertical-align: inherit;">Jika Anda meningkatkan ke Android 10 dan mengaktifkan navigasi dengan gerakan, Drawer Navigasi akan jatuh. </font><font style="vertical-align: inherit;">Sekarang Anda perlu mengklik menu hamburger untuk membuatnya muncul, atau kombinasi keadaan acak memungkinkan Anda untuk merentangkannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di Android versi pra-alfa, Navigasi Drawer berfungsi, tetapi saya tidak berani memperbarui - ini adalah pra-alfa. </font><font style="vertical-align: inherit;">Oleh karena itu, bahkan jika Anda menginstal versi terbaru GitFox dari repositori, ada Drawer Navigasi di sana, tetapi tidak dapat ditarik. </font><font style="vertical-align: inherit;">Segera setelah dukungan resmi keluar, saya akan memperbarui dan semuanya akan berfungsi dengan baik.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daftar Periksa Persiapan Android 10</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapkan transparansi dari Bilah Navigasi dan Bilah Status dari awal proyek</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Google sangat menyarankan mempertahankan Bilah Navigasi transparan. Bagi kami, ini adalah bagian praktis yang penting. Jika proyek berhasil, tetapi Anda tidak menyalakannya, pilih waktu untuk mendukung Android 10. Aktifkan terlebih dahulu dalam subjek, seperti tembus cahaya, dan perbaiki tata letak di mana proyek itu rusak. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan ekstensi ke Kotlin</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - lebih mudah dengan mereka. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan ke semua Bilah Alat di atas padding.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bilah alat selalu ada di atas, dan itulah yang perlu Anda lakukan. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk semua RecyclerViews, tambahkan padding dari bawah</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan kemampuan untuk menggulir </font></font><code>clipToPadding="false"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pikirkan semua tombol di tepi layar </font></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(FAB)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . FAB kemungkinan besar tidak berada di tempat yang Anda harapkan.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jangan mengganti atau membuat implementasi Anda sendiri untuk semua LinearLayout</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan kasus serupa lainnya. Lakukan triknya, seperti di GitFox, atau ambil ekstensi yang sudah jadi untuk membantu. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Periksa gerakan di tepi layar untuk Lihat kustom</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Laci Navigasi tidak mendukung ini. Tetapi tidak begitu sulit untuk mendukungnya dengan tangan Anda, untuk mendefinisikan kembali inset untuk gerakan di layar dengan Navigasi Drawer. Mungkin Anda memiliki editor gambar tempat gestur bekerja. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menggulir di ViewPager tidak bekerja dari tepi, tetapi hanya dari tengah ke kanan dan kiri</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Google mengatakan ini normal. Jika Anda menarik ViewPager dari tepi, maka itu dianggap sebagai menekan tombol "Kembali". </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam proyek baru, segera sertakan semua transparansi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Anda dapat memberi tahu desainer bahwa Anda tidak memiliki Bilah Navigasi dan Bilah Status. </font><font style="vertical-align: inherit;">Seluruh kotak adalah konten aplikasi Anda. </font><font style="vertical-align: inherit;">Dan pengembang sudah akan mencari tahu di mana dan apa yang harus dibesarkan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tautan yang bermanfaat:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@rmr_spb dalam telegram - catatan mitaps internal Redmadrobot SPb.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua kode sumber dalam artikel ini dan bahkan lebih banyak lagi di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitFox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ada cabang Android 10 yang terpisah, di mana Anda dapat melihat dengan mengkomit bagaimana saya mendapatkan semua ini dan bagaimana saya mendukung Android baru.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perpustakaan Insetter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chris Bane. </font><font style="vertical-align: inherit;">Ini berisi 5-6 ekstensi yang saya tunjukkan. </font><font style="vertical-align: inherit;">Untuk digunakan dalam proyek Anda, hubungi perpustakaan, kemungkinan besar itu akan pindah ke Android Jetpack. </font><font style="vertical-align: inherit;">Saya mengembangkan mereka dalam proyek saya dan, menurut saya, mereka menjadi lebih baik.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chris Bane.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>   FunCorn,    ,      .</li>
<li> «<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Why would I want to fitsSystemWindows?</a>»  .</li>
</ul><br>
<blockquote>    AppConf,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">youtube-</a>      .            ,     - .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AppsConf</a>     ,            .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>, stay tuned!</blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id488160/index.html">Windows Server 2019 vs. VMware Snapshots with quiescing: solusi elegan untuk masalah ini</a></li>
<li><a href="../id488162/index.html">Semakin tinggi peringkat, semakin banyak uang dan sebaliknya</a></li>
<li><a href="../id488164/index.html">Pertempuran SEC melawan Telegram</a></li>
<li><a href="../id488190/index.html">Sekali lagi tentang kelelahan emosional</a></li>
<li><a href="../id488194/index.html">Mengapa kita menulis program dengan kualitas buruk?</a></li>
<li><a href="../id488198/index.html">Apa yang ditakutkan oleh Timlids dan mengapa mereka harus berhenti melakukan ini</a></li>
<li><a href="../id488200/index.html">Perdebatan tentang bahasa pemrograman pertama: keputusan akhir</a></li>
<li><a href="../id488202/index.html">PVS-Studio sekarang di Chocolatey: memeriksa Chocolatey dari Azure DevOps</a></li>
<li><a href="../id488208/index.html">Hari Peringatan DUMP2020 - 4 hari yang tidak akan Anda lupakan</a></li>
<li><a href="../id488210/index.html">Mengenali objek di android menggunakan TensorFlow: dari persiapan data hingga peluncuran di perangkat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>