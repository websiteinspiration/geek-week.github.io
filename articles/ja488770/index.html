<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌱 💛 🥔 KOMPAS-3D APIの操作→レッスン17→テキストドキュメント ♿️ 💪🏽 🤾🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="サイクルの前のレッスンでは、テキストを操作するさまざまな方法を詳しく調べました。KOMPASを使用すると、テキストドキュメントを作成できます。これらは、さまざまなタイプのメインラベルの外観が標準のWindowsメモ帳で作成されたファイルとは異なります。
 
 このレッスンでは、既存の文書を開く方法、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>KOMPAS-3D APIの操作→レッスン17→テキストドキュメント</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/488770/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイクルの前のレッスンでは、テキストを操作するさまざまな方法を詳しく調べました。</font><font style="vertical-align: inherit;">KOMPASを使用すると、テキストドキュメントを作成できます。</font><font style="vertical-align: inherit;">これらは、さまざまなタイプのメインラベルの外観が標準のWindowsメモ帳で作成されたファイルとは異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレッスンでは、既存の文書を開く方法、新しい文書を作成する方法、テキストドキュメントを閉じてさまざまな形式で保存する方法について説明します。</font><font style="vertical-align: inherit;">残念ながら、バージョン5のインターフェイスのAPIでは、テキストドキュメントのコンテンツを操作できません。タイトルブロックのコンテンツのみを操作できます。</font><font style="vertical-align: inherit;">したがって、テキストドキュメントの検討はこのレッスンにのみ限定されます。</font><font style="vertical-align: inherit;">そして次は、グラフィックドキュメントに戻ります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gf/ov/jn/gfovjnt_bko_re3ujpbc5fkidxy.png"><br>
<a name="habracut"></a><br>
<blockquote><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レッスンシリーズ「COMPASS-3D APIの操作」の内容</font></font></h4><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基礎</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図面デザイン</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COMPASSへの正しい接続</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主な碑文</font></font></a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラフィックプリミティブ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">      </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">,  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><b> </b></li>
</ol></blockquote><h2><font color="#00B2FF">  <b>ksDocumentTxt</b></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テキストドキュメントは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイスによって記述されます</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DocumentTxt（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェースの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KompasObject</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドと、同じインターフェースのActiveDocumentTxt（）メソッドの</font><font style="vertical-align: inherit;">2つのメソッドで作成でき</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これらのメソッドにはどちらも入力パラメーターがなく、成功</font><font style="vertical-align: inherit;">した場合は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェースを返し</font><font style="vertical-align: inherit;">、エラーの場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULLを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらの唯一の違いは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ActiveDocumentTxt（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">が現在アクティブなテキストドキュメントのインターフェイスを返し、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DocumentTxt（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドが</font><font style="vertical-align: inherit;">まだドキュメントにバインドされていないインターフェイスであることです。</font><font style="vertical-align: inherit;">インターフェイスを受け取ったら、既存のドキュメントを開いたり、新しいドキュメントを作成したりできます。</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既存のドキュメントを開く</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法使用して、既存のテキストドキュメントを開くには</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksOpenDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インタフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxtを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。以下はそのプロトタイプです</font></font><br>
<br>
<pre><code class="plaintext hljs">BOOL ksOpenDocument (<font></font>
BSTR nameDoc,	//    <font></font>
BOOL regim	//<font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regim</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
パラメータ</font><font style="vertical-align: inherit;">は、ドキュメント編集モードを設定します。その許容値は以下のとおりです：</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示モード（ドキュメントは画面に表示されます）; </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非表示モード（ドキュメントは画面に表示されません）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非表示モードは、ドキュメントを変更してユーザーにアクションが表示されないようにする場合に使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成功した場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksOpenDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trueを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><font style="vertical-align: inherit;">、エラーの場合</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：開こうとしているドキュメントがKOMPASですでに開いている場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksOpenDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。この場合、以前に開いたドキュメントで作業します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、既存のテキストドキュメントを開く方法を示すサンプルプログラムです。</font></font><br>
<br>
<pre><code class="plaintext hljs">//     <font></font>
WideString wideStr = WideString(ExtractFileDir(Application-&gt;ExeName));<font></font>
wideStr += L"\\TextDocument.kdw";<font></font>
BSTR filePath = SysAllocString(wideStr.c_bstr());<font></font>
<font></font>
// <font></font>
DocumentTxtPtr documentTxt;<font></font>
documentTxt = static_cast&lt;DocumentTxtPtr&gt;(kompas-&gt;DocumentTxt());<font></font>
documentTxt-&gt;ksOpenDocument(filePath, 0);<font></font>
<font></font>
// <font></font>
documentTxt.Unbind();<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例</font><font style="vertical-align: inherit;">では、アプリケーションディレクトリにある</font><font style="vertical-align: inherit;">ドキュメント</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「TextDocument.kdw」を</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開き</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テキストドキュメントオプション（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テキストドキュメントのオプションは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイスによって記述されます</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、メソッド</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetParamStruct</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KompasObject</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して取得できます</font><font style="vertical-align: inherit;">。これを行うには、定数</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ko_TextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をこのメソッドの唯一のパラメーターとして渡す必要があります</font><font style="vertical-align: inherit;">。このインタフェースの性質を考えてみましょう：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -文書の作成者の名前を持つ文字列。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comment-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントに関するコメントを含む文字列。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル名</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ラスターイメージを含むファイルへのフルパス。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメント編集モード。有効な値は以下のとおりです</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。0-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示モード（ドキュメントは画面に表示され、ユーザーに表示されます）。</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ブラインド」モード（ドキュメントはユーザーには表示されません）。このモードは通常、複数のドキュメントを使用する秘密の作業に使用されます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ドキュメントの整数型。その有効な値を以下の表に示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/au/01/imau01sxpaxf07wlrucbht6eu9i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェースのメソッドについて考えます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Init（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -インターフェースのプロパティを初期化します。入力パラメーターはありません。成功の場合は、返品</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">真</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、およびエラーの場合は- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">偽</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetSheetParam（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -シートパラメータインターフェースを返します。</font><font style="vertical-align: inherit;">入力パラメーターはありません。</font><font style="vertical-align: inherit;">テキストドキュメントに標準サイズのシート（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type == lt_DocTxtStandart</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）がある場合、このメソッドは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksStandartSheet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイスを返します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ドキュメントに非標準サイズ（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type == ls_DocTxtUser</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">シートがある場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSheetSize</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェースが</font><b><font style="vertical-align: inherit;">返され</font></b><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これらのインターフェースは両方とも</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイクルの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">レッスン2で説明されてい</font></a><font style="vertical-align: inherit;">ます。</font><b><font style="vertical-align: inherit;">ksTextDocumentParam</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
インターフェースの他のメソッド</font><font style="vertical-align: inherit;">は、ドキュメントのデザインに関連しています。</font><font style="vertical-align: inherit;">それらはあなたがドキュメントのデザインを変更することを許可しないので（それを読むだけ）、私たちはそれらを考慮しません。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメント作成</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法を使用して新しいテキストドキュメントを作成するには</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksCreateDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インタフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxtを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下はそのプロトタイプです。</font></font><br>
<br>
<pre><code class="plaintext hljs">BOOL ksCreateDocument (<font></font>
LPDISPATCH par<font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドの唯一</font><font style="vertical-align: inherit;">のパラメーターは、作成されたドキュメントのパラメーターを設定する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェース</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">成功した場合、メソッドは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trueを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><font style="vertical-align: inherit;">、エラーの場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、新しいテキストドキュメントの作成を示すプログラムのソースコードです。</font></font><br>
<br>
<pre><code class="plaintext hljs">//  <font></font>
TextDocumentParamPtr textDocumentParam;<font></font>
textDocumentParam=static_cast&lt;TextDocumentParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextDocumentParam));<font></font>
textDocumentParam-&gt;Init();<font></font>
textDocumentParam-&gt;set_type(lt_DocTxtStandart);<font></font>
<font></font>
//  <font></font>
StandartSheetPtr standartSheet;<font></font>
standartSheet = static_cast&lt;StandartSheetPtr&gt;(textDocumentParam-&gt;GetSheetParam());<font></font>
standartSheet-&gt;set_format(ksFormatA4);<font></font>
<font></font>
// <font></font>
DocumentTxtPtr documentTxt;<font></font>
documentTxt = static_cast&lt;DocumentTxtPtr&gt;(kompas-&gt;DocumentTxt());<font></font>
documentTxt-&gt;ksCreateDocument(textDocumentParam);<font></font>
<font></font>
// <font></font>
standartSheet.Unbind();<font></font>
textDocumentParam.Unbind();<font></font>
documentTxt.Unbind();<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/dx/ku/op/dxkuopwqevlznzcxuq8ajbcdk4o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプログラムの作業の結果として、新しいテキストドキュメントがKOMPASに作成されます。</font><font style="vertical-align: inherit;">KOMPASがそのためのデザインを作成しなかったように見えるかもしれませんが、これはそうではありません。</font><font style="vertical-align: inherit;">メインテキストが表示されるので、COMPASSツールバーの「Display Design」ボタンをクリックする必要があります。</font><font style="vertical-align: inherit;">次の図は、「外観の表示」ボタンと作成されたテキストドキュメントを含むKOMPASウィンドウの一部を示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r0/ew/3s/r0ew3sy4irvaq5rtnqzbb0kwtxs.png"><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚数と表題欄</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メソッド</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksGetDocumentPagesCount（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ドキュメントのページ数を返します。入力パラメーターはありません。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイスに</font><font style="vertical-align: inherit;">関連付けられ</font><font style="vertical-align: inherit;">ている</font><font style="vertical-align: inherit;">ドキュメント（開いているか作成されている）がない</font><font style="vertical-align: inherit;">場合</font><font style="vertical-align: inherit;">、メソッドは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0を</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetStamp（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxtは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイス返し</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksStampを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（で考慮タイトルブロック記述、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">及び</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レッスン）。メソッドには入力パラメーターがありません。結果の</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksStamp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイス</font><font style="vertical-align: inherit;">は、ドキュメントの最初のシートの</font><b><font style="vertical-align: inherit;">タイトルブロックを</font></b><font style="vertical-align: inherit;">記述します。</font><b><font style="vertical-align: inherit;">GetStampEx</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントの任意のシートのタイトルブロックを取得できます。</font><font style="vertical-align: inherit;">唯一のパラメーターとして、</font><font style="vertical-align: inherit;">取得したい</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイトルブロック</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイス（</font><b><font style="vertical-align: inherit;">ksStamp</font></b><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">シート番号</font><font style="vertical-align: inherit;">を取ります。</font><font style="vertical-align: inherit;">枚数は1枚から（1枚あたり）。</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントを閉じる</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メソッドの使用してテキスト文書閉じます</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksCloseDocument（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インタフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxtを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">入力パラメータはなく、成功した場合はtrueを返し、エラーの場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返します</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksCloseDocument（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">はドキュメントを保存しない</font><font style="vertical-align: inherit;">ことに注意してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントを保存する</font></font></font></h2><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
インターフェースでドキュメントを保存するための</font><font style="vertical-align: inherit;">いくつかのメソッドが提供さ</font><font style="vertical-align: inherit;">れて</font><b><font style="vertical-align: inherit;">い</font></b><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">ksSaveDocument</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド</font><font style="vertical-align: inherit;">は、指定されたパスにドキュメントを保存します。唯一のパラメーターとして、ドキュメントを保存するファイルへのフルパスを含む文字列を取得します。成功した場合は</font><i><font style="vertical-align: inherit;">trueを</font></i><font style="vertical-align: inherit;">返し</font><font style="vertical-align: inherit;">、エラーの場合は</font><i><font style="vertical-align: inherit;">falseを</font></i><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。ファイルは、使用されているKOMPASのバージョンで保存されます。</font><b><font style="vertical-align: inherit;">ksSaveDocumentExEx</font></b><font style="vertical-align: inherit;"> 
メソッドを</font><font style="vertical-align: inherit;">使用</font><b><font style="vertical-align: inherit;">する</font></b><font style="vertical-align: inherit;">と、ドキュメントを保存するバージョンを選択でき</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。以下は、このメソッドのプロトタイプです。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">BOOL ksSaveDocumentEx (<font></font>
BSTR fileName,	//   <font></font>
long saveMode	//  <font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メソッド</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSaveDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とは対照的に、</font><font style="vertical-align: inherit;">ここではパラメーター</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saveMode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を追加します</font><font style="vertical-align: inherit;">。その有効な値を以下の表に示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pr/d0/pd/prd0pdijfbdvjaf6detb1rbg5f0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成功した場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSaveDocumentExEx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trueを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><font style="vertical-align: inherit;">、エラーの場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">SaveAsToRasterFormat</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド</font><font style="vertical-align: inherit;">は、ドキュメントをラスター形式で保存します。以下はそのプロトタイプです。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">BOOL SaveAsToRasterFormat (<font></font>
BSTR fileName,		//   <font></font>
LPDISPATCH rasterPar	//    <font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラスター形式でのパラメーターの保存は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksRasterFormatParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェースを使用して設定</font><font style="vertical-align: inherit;">され</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">サイクルの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レッスン6で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font><font style="vertical-align: inherit;">）。成功した場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAsToRasterFormat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trueを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><font style="vertical-align: inherit;">、エラーの場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksRasterFormatParamの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合、メソッド</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RasterFormatParam（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェース</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用する必要があり</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。このメソッドには入力パラメーターがなく、保存パラメーターのインターフェイスをラスター形式で返します。エラーの場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULLを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">SaveAsToUncompressedRasterFormat</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントを圧縮せずにラスター形式で保存します。</font><font style="vertical-align: inherit;">これには、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAsToRasterFormat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドと同じプロトタイプがあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">成功した場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAsToUncompressedRasterFormat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trueを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><font style="vertical-align: inherit;">、エラーの場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文書の記入</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、一連の記事で取り上げたバージョン5のインターフェースAPIには、テキストドキュメントを生成する手段が含まれていません。</font><font style="vertical-align: inherit;">これを行うには、バージョン7インターフェースのAPIを使用する必要があります</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このレッスンでは、テキストドキュメントに慣れました。</font><font style="vertical-align: inherit;">APIバージョン5では、テキストドキュメントを開いたり、作成したり、保存したりできますが、内容を編集することはできません。</font><font style="vertical-align: inherit;">シリーズの以降のチュートリアルでは、テキストドキュメントに戻りません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">継続するには、ブログのニュースに従ってください。</font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sergey Norseev博士、著書「DelphiのCOMPASのアプリケーション開発」の著者。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja488756/index.html">新しいgooglesheets4パッケージを使用してRでGoogle Sheets API（Google Sheets API v4）を操作する方法</a></li>
<li><a href="../ja488758/index.html">DEFCON会議27.インターネット詐欺の認識</a></li>
<li><a href="../ja488762/index.html">約束のあるエレガントな非同期プログラミング</a></li>
<li><a href="../ja488766/index.html">アートとテクノロジー：マサチューセッツ大学ローウェル校</a></li>
<li><a href="../ja488768/index.html">血まみれの地獄、または英語で培養された人と間違われると誓う方法</a></li>
<li><a href="../ja488776/index.html">Visual Studio 2019 for Macのアクセシビリティの強化</a></li>
<li><a href="../ja488778/index.html">データ構造：すべてを実行できるリスト*</a></li>
<li><a href="../ja488780/index.html">Mozillaはブラウザ戦争で敗北しましたが、それでもインターネットを救えると信じています</a></li>
<li><a href="../ja488782/index.html">Pythonのこの依存関係管理オプションはどうですか？</a></li>
<li><a href="../ja488784/index.html">コピーレフトライセンスに基づく無料ソフトウェアの改良の商用化</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>