<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂üèº üå§Ô∏è üöÅ M√≥dulos ES6 no navegador: eles est√£o prontos ou n√£o? üë®üèΩ‚ÄçüöÄ üë©üèΩ‚Äçü§ù‚Äçüë©üèª ü§≤üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voc√™ j√° ouviu falar sobre o uso dos m√≥dulos ES6 em um navegador? Na verdade, esses s√£o m√≥dulos ES6 comuns. Eles se aplicam apenas ao c√≥digo destinado ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>M√≥dulos ES6 no navegador: eles est√£o prontos ou n√£o?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/492510/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ j√° ouviu falar sobre o uso dos m√≥dulos ES6 em um navegador? </font><font style="vertical-align: inherit;">Na verdade, esses s√£o m√≥dulos ES6 comuns. </font><font style="vertical-align: inherit;">Eles se aplicam apenas ao c√≥digo destinado aos navegadores.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/yl/q1/wl/ylq1wlx8jeaaomnc9kwintirrma.jpeg"></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se algu√©m n√£o sabe - √© assim que parece. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° uma p√°gina </font></font><code>index.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><font></font>
&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"index.mjs"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">&lt;!--     "module" --&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° um arquivo </font></font><code>index.mjs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">representando um m√≥dulo conectado √† p√°gina:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { doSomething } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils.mjs'</span>;<font></font>
<font></font>
doSomething(<span class="hljs-string">'Make me a sandwich'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este m√≥dulo, por sua vez, importa a fun√ß√£o </font></font><code>doSomething</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do m√≥dulo </font></font><code>utils.mjs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> doSomething = <span class="hljs-function"><span class="hljs-params">message</span> =&gt;</span> {
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'No.'</span>);<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os m√≥dulos ES6 existem h√° muitos anos. </font><font style="vertical-align: inherit;">E talvez voc√™ esteja pensando em experiment√°-los. </font><font style="vertical-align: inherit;">Eu os usei por cerca de um m√™s em meu pr√≥prio projeto. </font><font style="vertical-align: inherit;">Ao mesmo tempo, cheguei √† conclus√£o de que ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suspeita!</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre o suporte do navegador para m√≥dulos</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de falar sobre o que entendi, sugiro dar uma olhada no suporte ao navegador para m√≥dulos. </font><font style="vertical-align: inherit;">Como estou escrevendo este material no in√≠cio de 2020, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√≠vel de suporte dos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√≥dulos √© impressionante em 90%.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/484/cfd/9e6/484cfd9e669b731f483cfdd99a638777.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suporte para m√≥dulos com navegadores de acordo com caniuse.com,</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
estou muito satisfeito com esses 90% (n√£o levo em considera√ß√£o as necessidades de 10% dos usu√°rios), embora voc√™ possa querer ser mais respons√°vel. </font><font style="vertical-align: inherit;">Mas, mesmo considerando isso, se o seu projeto n√£o foi projetado para o IE, UC ou Opera Mini, esse n√≠vel de suporte significa que quase 100% do seu p√∫blico-alvo poder√° trabalhar com o seu projeto sem problemas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â verdade que o suporte ao navegador para m√≥dulos √© apenas o come√ßo. </font><font style="vertical-align: inherit;">Aqui, quero encontrar a resposta para tr√™s perguntas que surgiram no in√≠cio de minha jornada em dire√ß√£o aos m√≥dulos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O uso de m√≥dulos nos navegadores tem vantagens?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E os contras?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenho certeza de que tive uma terceira pergunta, mas agora n√£o consigo me lembrar.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos descobrir ...</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quais s√£o as vantagens do uso de m√≥dulos nos navegadores?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© puro JavaScript! </font><font style="vertical-align: inherit;">Sem pipeline de projeto de montagem, sem arquivo de configura√ß√£o do Webpack de 400 linhas, sem Babel, sem plugins e presets e sem m√≥dulos adicionais de 45 npm. </font><font style="vertical-align: inherit;">Somente voc√™ e seu c√≥digo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° algo refrescante na escrita de c√≥digo que ser√° executado no navegador exatamente na forma em que foi criado. </font><font style="vertical-align: inherit;">Isso pode exigir um pouco mais de esfor√ßo, mas o resultado √© muito agrad√°vel. </font><font style="vertical-align: inherit;">Isto √© como dirigir um carro com uma transmiss√£o manual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim. </font><font style="vertical-align: inherit;">As vantagens dos m√≥dulos ES6 s√£o JavaScript puro, essa √© a falta de montagem, configura√ß√£o do projeto e a rejei√ß√£o de depend√™ncias que se tornaram desnecess√°rias. </font><font style="vertical-align: inherit;">O qu√™ mais? </font><font style="vertical-align: inherit;">Mais alguma coisa? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o, nada mais.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quais s√£o as desvantagens do uso de m√≥dulos nos navegadores?</font></font></font></h2><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ParCompara√ß√£o de m√≥dulos e empacotadores</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao pensar em usar os m√≥dulos ES6 em um navegador, √© necess√°rio escolher entre usar m√≥dulos e bundlers como Webpack, Parcel ou Rollup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â poss√≠vel (provavelmente) usar os dois, mas, na realidade, se voc√™ planeja executar o c√≥digo por meio do empacotador, n√£o h√° raz√£o para usar o design </font></font><code>&lt;script type="module"&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para carregar os arquivos do pacote. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, com base no pressuposto de que algu√©m est√° considerando a possibilidade de usar m√≥dulos ES6 em vez de um empacotador, eis o que ele ter√° que desistir:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minifica√ß√£o do c√≥digo finalizado.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recursos avan√ßados de JavaScript.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sintaxe diferente da sintaxe JavaScript (React, TypeScript, etc.).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√≥dulos Npm.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armazenamento em cache</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere os tr√™s primeiros par√°grafos desta lista com mais detalhes.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Size Tamanho do arquivo</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tamanho do meu projeto, que usa m√≥dulos, √© 34 Kb. Como eu n√£o uso a etapa de constru√ß√£o do projeto, o c√≥digo transmitido pela rede cont√©m nomes de vari√°veis ‚Äã‚Äãmuito longos; h√° muitos coment√°rios nele. Al√©m disso, representa um monte de arquivos pequenos, o que n√£o √© muito bom em termos de compacta√ß√£o de dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se eu colocasse tudo isso em um pacote usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parcel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o tamanho do que sairia seria 18 Kb. Minha calculadora Casual Casio relata que essa √© "cerca da metade" do c√≥digo do projeto no qual o empacotador n√£o √© usado. Isso se deve em parte ao fato de o Parcel compactar arquivos, mas tamb√©m porque os materiais com essa abordagem s√£o melhor compactados usando o gzip.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A compacta√ß√£o de dados chama nossa aten√ß√£o para outro problema: a maneira como os arquivos s√£o organizados (no sentido de conveni√™ncia do desenvolvimento) √© diretamente transferida para a maneira como os arquivos s√£o transferidos pela rede. E a maneira como os arquivos s√£o organizados durante o desenvolvimento n√£o corresponde necessariamente √† forma como voc√™ deseja v√™-los no site. Por exemplo, 150 m√≥dulos (arquivos) podem fazer sentido enquanto estiver trabalhando em um projeto. E os mesmos materiais transferidos para o navegador podem ser justificados para organizar em 12 pacotes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vou explicar essa ideia. N√£o estou falando do fato de que usar m√≥dulos significa que os arquivos n√£o podem ser agrupados e compactados (que isso n√£o pode ser feito √© uma ilus√£o). S√≥ quero dizer que n√£o faz sentido fazer as duas coisas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sim, aqui est√° uma observa√ß√£o engra√ßada. </font><font style="vertical-align: inherit;">No meu aplicativo, at√© escrever esta se√ß√£o, foram utilizados m√≥dulos (enfatizo!). </font><font style="vertical-align: inherit;">Eu instalei o Parcel para calcular o tamanho correto da montagem. </font><font style="vertical-align: inherit;">E agora n√£o vejo raz√£o para voltar aos m√≥dulos normais. </font><font style="vertical-align: inherit;">Bem, isso n√£o √© interessante!</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IfeVida sem transpila√ß√£o</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao longo dos anos, estou acostumado a usar as mais recentes constru√ß√µes de sintaxe JavaScript e a maravilhosa ferramenta Babel, que as transforma em c√≥digo que todos os navegadores entendem. Eu me acostumei tanto que raramente pensava no suporte ao navegador (√© claro, com exce√ß√£o do DOM e CSS). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando eu tentei </font></font><code>type=¬´module¬ª</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, eu ia fazer tudo sozinho. Meu objetivo era navegadores novos, ent√£o achei que poderia usar o JavaScript moderno, ao qual estou acostumado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas a realidade n√£o era t√£o r√≥sea. Tente responder √†s seguintes perguntas rapidamente e sem procurar em nenhum lugar. O Edge suporta</font></font><code>flatMap()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? O Safari suporta atribui√ß√£o destrutiva (objetos e matrizes)? O Chrome suporta v√≠rgulas ap√≥s os argumentos da √∫ltima fun√ß√£o? O Firefox suporta exponencia√ß√£o? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, eu tive que procurar respostas para essas perguntas, realizar testes entre navegadores. Mas eu usei tudo isso por s√©culos. Em qualquer aplicativo grande o suficiente, isso provavelmente levaria a erros de produ√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso tamb√©m significa que n√£o poderei usar a inova√ß√£o JavaScript mais not√°vel desde o advento do m√©todo array </font></font><code>slice()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- o chamado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operador de sequ√™ncia opcional</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Eu usei desenhos m√°gicos como</font></font><code>prop?.value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aproximadamente um m√™s (a partir do momento em que a ferramenta Create React App come√ßou a suport√°-los sem nenhuma configura√ß√£o adicional). </font><font style="vertical-align: inherit;">Mas j√° √© inconveniente para mim trabalhar sem eles.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Cargas de armazenamento em cache</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O armazenamento em cache foi para mim o maior obst√°culo. De fato, o fato de que a solu√ß√£o para o problema de armazenamento em cache se mostrou bastante interessante acabou sendo a principal raz√£o pela qual decidi escrever este material. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ tem certeza, quando os materiais s√£o processados ‚Äã‚Äãusando um empacotador, cada um dos arquivos resultantes recebe um nome exclusivo - mais ou menos </font></font><code>index.38fd9e.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. O conte√∫do de um arquivo com esse nome nunca (nunca) muda. Portanto, ele pode ser armazenado em cache pelo navegador por um per√≠odo ilimitado. Se esse arquivo for baixado uma vez, voc√™ n√£o precisar√° baix√°-lo novamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© um sistema incr√≠vel - a menos que voc√™ tente encontrar a resposta para a pergunta de como limpar o cache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os m√≥dulos s√£o carregados usando um design como</font></font><code>&lt;script type="module" src="index.mjs"&gt;&lt;/script&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">O hash no nome do arquivo n√£o √© usado. </font><font style="vertical-align: inherit;">Como, nessa situa√ß√£o, ele deve informar o navegador sobre onde baix√°-lo </font></font><code>index.mjs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- do cache ou da rede? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deve-se notar que √© quase poss√≠vel fazer o cache funcionar aceit√°vel, mas ser√° necess√°rio algum esfor√ßo. </font><font style="vertical-align: inherit;">Aqui est√° o que voc√™ precisa para isso:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ deve definir o t√≠tulo de todas as respostas </font></font><code>cache-control</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para um valor </font></font><code>no-cache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Incrivelmente, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem cache</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o significa "n√£o armazenar em cache". </font><font style="vertical-align: inherit;">Isso significa que o arquivo deve ser armazenado em cache, mas o arquivo n√£o deve ser "usado para satisfazer uma solicita√ß√£o subsequente sem verifica√ß√£o bem-sucedida no servidor de origem".</font></font></li>
<li>    ETag.    ‚Äî  ()   , ,   ,    .  , <code>38fd9e</code>      .</li>
<li>   CDN-  ,   .     ETag       .     .   CDN-   .       (     ETag)      . (, ,     Firebase).</li>
<li>  -,    ,  ¬´  ¬ª  .        ,     ,  ,  ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, quando um visitante visita novamente o site, o navegador diz: ‚ÄúPreciso fazer o download do arquivo </font></font><code>index.mjs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Vejo que esse arquivo j√° existe no meu cache, √© ETag </font></font><code>38fd9e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Solicitarei esse arquivo do servidor, mas direi a ele para envi√°-lo apenas se o ETag dele n√£o for </font></font><code>38fd9e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. " O respons√°vel pelo servi√ßo interceptar√° essa solicita√ß√£o, ignorar√° a ETag e a retornar√° </font></font><code>index.mjs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do cache (esse arquivo entrou no cache quando a p√°gina foi carregada pela √∫ltima vez). Em seguida, o respons√°vel pelo servi√ßo redirecionar√° a solicita√ß√£o para o servidor. O servidor retornar√° uma mensagem informando que o arquivo n√£o foi alterado ou um arquivo que ser√° armazenado no cache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na minha opini√£o, tudo isso √© muito problem√°tico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, se voc√™ estiver interessado, o c√≥digo do trabalhador do servi√ßo:</font></font><br>
<br>
<pre><code class="javascript hljs">self.addEventListener(<span class="hljs-string">'fetch'</span>, e =&gt; {<font></font>
&nbsp;&nbsp;e.respondWith(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">async</span> (</span>) =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//       </span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> cacheResponse = <span class="hljs-keyword">await</span> caches.match(e.request);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//   (),   </span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">// (ETag-    )</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fetch(e.request).then(<span class="hljs-function"><span class="hljs-params">fetchResponse</span> =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;caches<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.open(CACHE_NAME)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(<span class="hljs-function"><span class="hljs-params">cache</span> =&gt;</span> cache.put(e.request, fetchResponse));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (cacheResponse) <span class="hljs-keyword">return</span> cacheResponse;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> fetch(e.request);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;})()<font></font>
&nbsp;&nbsp;);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu estava com pregui√ßa, ent√£o n√£o estudei e n√£o usei a propriedade </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FetchEvent.navigationPreload</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mais </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">recente</font></a><font style="vertical-align: inherit;"> . O fato √© que naquela √©poca eu gastei mais tempo armazenando em cache do que escrevendo um aplicativo (para sua informa√ß√£o, gastei 10 e 11 horas nesses assuntos, respectivamente). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sim, quero observar que a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proposta do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "cart√£o de importa√ß√£o" visa solucionar alguns dos problemas descritos acima. Ele permite que voc√™ organize algo como mapeamento </font></font><code>index.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em </font></font><code>index.38fd9e.mj</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s. Por√©m, para gerar um hash, voc√™ precisa de algum tipo de pipeline de montagem, os cart√µes de importa√ß√£o precisar√£o ser incorporados no arquivo HTML. Isso significa que um bundler √© necess√°rio aqui ... Na verdade, nessa situa√ß√£o, os m√≥dulos n√£o s√£o mais necess√°rios no navegador.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, embora tenha sido interessante entender tudo isso, ele pode ser comparado com a maneira como eu dirigi em todos os lugares em um monociclo por um ano inteiro. </font><font style="vertical-align: inherit;">Eu n√£o vou mais fazer isso.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas provavelmente nem todo mundo usa empacotadores?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu escrevi este material na suposi√ß√£o de que todo mundo escreve c√≥digo em m√≥dulos, usando constru√ß√µes </font></font><code>import/export</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>require</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, em seguida, coleciona o c√≥digo em pacotes de produ√ß√£o usando Webpack, Grunt, Gulp ou algo assim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem desenvolvedores que n√£o usam empacotadores? </font><font style="vertical-align: inherit;">Existe algu√©m que coloca seu c√≥digo JavaScript em v√°rios arquivos e os envia para produ√ß√£o sem agrupar? </font><font style="vertical-align: inherit;">Talvez uma dessas pessoas seja voc√™? </font><font style="vertical-align: inherit;">Se assim for, eu gostaria de saber tudo sobre sua vida.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esfor√ßo-me para tomar todas as decis√µes s√©rias, como a escolha entre m√≥dulos e empacotadores, com base nos principais princ√≠pios do desenvolvimento efetivo. Isso √© produtividade e qualidade. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, o uso de m√≥dulos nos navegadores n√£o contribui para um ou outro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se amanh√£ eu come√ßar a trabalhar em um novo projeto, ent√£o, na minha cabe√ßa, n√£o tenho d√∫vidas sobre a execu√ß√£o do bom e velho aplicativo create-react-app. Todas as configura√ß√µes iniciais levar√£o cerca de trinta segundos e, embora o tamanho inicial do projeto de 40 Kb seja um pouco grande, para a maioria dos sites, isso n√£o ter√° nenhum papel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E aqui est√° uma situa√ß√£o diferente. Suponha que eu precise reunir um pouco de HTML / CSS e JavaScript para algum tipo de experimento, e esse experimento seria um projeto que inclu√≠sse um pouco mais de arquivos do que alguns. Se, enquanto trabalhava nesse projeto, n√£o planejava gastar tempo configurando o sistema para constru√≠-lo, provavelmente usaria os m√≥dulos no navegador. E ent√£o - se eu n√£o me importava com o desempenho deste projeto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gostaria de saber como o Webpack e suas ferramentas relacionadas funcionam com os m√≥dulos ES6 em um navegador. Acredito que no futuro, quando a proposta de "cart√µes de importa√ß√£o" receber suporte suficiente, os empacotadores provavelmente os usar√£o como um mecanismo para abstrair hashes desagrad√°veis ‚Äã‚Äãque s√£o usados ‚Äã‚Äãhoje.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Queridos leitores! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ j√° usou os m√≥dulos ES6 no seu navegador?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492500/index.html">Science Garage em russo. Experi√™ncia na tradu√ß√£o de um programa americano</a></li>
<li><a href="../pt492502/index.html">MIP * = RE: evid√™ncias de √©poca do campo da ci√™ncia da computa√ß√£o que causaram o efeito domin√≥ na f√≠sica e na matem√°tica</a></li>
<li><a href="../pt492504/index.html">O que acontece quando um m√≥dulo JS √© importado duas vezes?</a></li>
<li><a href="../pt492506/index.html">3 maneiras de renderizar grandes listas em Angular</a></li>
<li><a href="../pt492508/index.html">Livro Kubernetes para DevOps</a></li>
<li><a href="../pt492512/index.html">CSS: aventuras na terra da translucidez</a></li>
<li><a href="../pt492514/index.html">Como estabelecer um fluxo de documentos eletr√¥nicos juridicamente significativo de contrapartes na R√∫ssia e no Cazaquist√£o?</a></li>
<li><a href="../pt492518/index.html">O surto de v√≠rus requer trabalho remoto, o que significa assinatura digital de documentos</a></li>
<li><a href="../pt492520/index.html">Modelagem 3D parametrizada do copo do rolamento no nanoCAD Plus 20</a></li>
<li><a href="../pt492522/index.html">Comunica√ß√£o de equipe remota</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>