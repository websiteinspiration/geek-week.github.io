<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻 👨🏿 🤼 SIPを使用してC / C ++ライブラリのPythonバインディングを作成します。パート1 🐢 👨🏿‍🏫 🔫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pythonでプロジェクトに取り組んでいるときに、Pythonではなく、たとえばCまたはC ++で作成されたライブラリを使用したい場合があります。まず、Pythonは素晴らしい言語ですが、状況によっては十分に速くない場合もあります。そして、パフォーマンスがPython言語の機能によって制限されている...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>SIPを使用してC / C ++ライブラリのPythonバインディングを作成します。パート1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495480/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonでプロジェクトに取り組んでいるときに、Pythonではなく、たとえばCまたはC ++で作成されたライブラリを使用したい場合があります。まず、Pythonは素晴らしい言語ですが、状況によっては十分に速くない場合もあります。そして、パフォーマンスがPython言語の機能によって制限されていることがわかった場合は、プログラムの一部を別の言語で記述し（この記事ではCおよびC ++について説明します）、プログラムのこの部分をライブラリーとして配置し、Pythonバインディング（Pythonバインディング）を作成します。その上に、通常のPythonライブラリとして取得したモジュールを使用します。第二に、必要な問題を解決するライブラリがあることを知っていると、多くの場合状況が発生しますが、残念ながら、このライブラリはPythonではなく同じCまたはC ++で記述されています。この場合、ライブラリをPythonバインディングで作成し、ライブラリがもともとPythonで作成されていないという事実を意識せずに使用することもできます。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonバインディングを作成するためのさまざまなツールがあり、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python / C API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの低レベルのものから</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SWIG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">や</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの高レベルのものまでさまざまです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonバインディングを作成するさまざまな方法を比較するという目標はありませんでしたが、1つのツール、つまり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIPの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用の基本についてお話ししたいと思い</font><font style="vertical-align: inherit;">ます。当初、SIPはQtライブラリ（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyQt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">周囲にバインディングを作成するように設計されており、</font><font style="vertical-align: inherit;">他の大きなPythonライブラリ（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wxPython</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など）の開発にも使用されていました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、gccをCのコンパイラーとして使用し、g ++をC ++コンパイラーとして使用します。</font><font style="vertical-align: inherit;">すべての例はArch LinuxとPython 3.8でテストされました。</font><font style="vertical-align: inherit;">例を複雑にしないために、さまざまなオペレーティングシステムでのコンパイルおよびさまざまなコンパイラ（Visual Studioなど）の使用については、この記事の範囲には含まれていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事のすべての例は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">リポジトリ</font></a><font style="vertical-align: inherit;">からダウンロードできます</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIPソースのリポジトリは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.riverbankcomputing.com/hg/sip/にあります</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">MercurialはSIPのバージョン管理システムとして使用されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cでライブラリをバインドする</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cでのライブラリの作成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例は</font><font style="vertical-align: inherit;">ソースの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダー</font><font style="vertical-align: inherit;">にあり</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">が、この記事では、すべてを最初から行うことを前提としています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単な例から始めましょう。</font><font style="vertical-align: inherit;">最初に、単純なCライブラリを作成し、それをPythonスクリプトから実行します。</font><font style="vertical-align: inherit;">ライブラリを唯一の関数としましょう</font></font><br>
<br>
<pre><code class="plaintext hljs">int foo(char*);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは文字列を受け取り、その長さを2倍した値を返し</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ヘッダーファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、たとえば次のようになります。</font></font><br>
<br>
<pre><code class="plaintext hljs">#ifndef FOO_LIB<font></font>
#define FOO_LIB<font></font>
<font></font>
int foo(char* str);<font></font>
<font></font>
#endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の実装を</font><i><font style="vertical-align: inherit;">含む</font></i><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;string.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int foo(char* str) {<font></font>
	return strlen(str) * 2;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリの機能をテストするために、簡単な</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムを作成し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;stdio.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int main(int argc, char* argv[]) {<font></font>
	char* str = "0123456789";<font></font>
	printf("%d\n", foo(str));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
精度については、作成</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefileを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=gcc<font></font>
CFLAGS=-c<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
	$(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.c<font></font>
	$(CC) $(CFLAGS) main.c -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.c<font></font>
	$(CC) $(CFLAGS) foo.c -o $(DIR_OUT)/foo.o<font></font>
	ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
	mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
	rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fooの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのソースが、ソース</font><font style="vertical-align: inherit;">フォルダーの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fooの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブフォルダー</font><font style="vertical-align: inherit;">にあるとします。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└──foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├──foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├──foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├──main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    └──Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
フォルダーに移動し</font><font style="vertical-align: inherit;">、コマンドを使用してソースをコンパイルします</font></font><br>
<br>
<pre><code class="bash hljs">make
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイル中、テキストが表示されます。</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイル結果は</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">フォルダー内の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに配置され</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└──foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├──ビン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │├──foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │├──libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │├──メイン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │└──main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├──foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├──foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├──main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    └──Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静的リンク用のライブラリと、それを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">という名前で使用するプログラムをコンパイルしました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">コンパイル後、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラム</font><font style="vertical-align: inherit;">が起動</font><font style="vertical-align: inherit;">することを確認でき</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fooライブラリーにPythonバインディングを作成しましょう。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SIPの基本</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初にSIPをインストールする必要があります。</font><font style="vertical-align: inherit;">これは、pipを使用する他のすべてのライブラリと同様に、標準的に行われます。</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user sip
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、仮想環境で作業している場合は、システムにグローバルにではなく、ユーザーフォルダーにSIPライブラリをインストールする必要があることを示す--userパラメーターを指定しないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fooライブラリをPythonコードから呼び出せるようにするには、何をする必要がありますか？少なくとも、2つのファイルを作成する必要があります。1つはTOML形式で、pyproject.tomlという名前を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付け</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、2つ目は拡張子.sipのファイルです。それらのそれぞれを順番に扱いましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソースの構造について合意する必要があります。内部</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダです</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fooという</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダ</font><font style="vertical-align: inherit;">ライブラリのソースが含まれています。コンパイル後、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダ</font><font style="vertical-align: inherit;">内に</font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;">フォルダが作成されます</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すべてのコンパイル済みファイルが含まれます。</font><font style="vertical-align: inherit;">後で、ユーザーがコマンドラインを介してライブラリのヘッダーファイルとオブジェクトファイルへのパスを指定する機能を追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIPに必要なファイルは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーと同じフォルダーにあります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyproject.toml</font></font></h4><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font><font style="vertical-align: inherit;">はSIP開発者による発明ではありませんが、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 517「ソースツリーのビルドシステムに依存しない形式」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518「Pythonプロジェクトの最小ビルドシステム要件の指定</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">」に</font></a><font style="vertical-align: inherit;">記載されているPythonプロジェクト記述形式です</font><font style="vertical-align: inherit;">。これは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TOMLファイル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であり、ini形式のより高度なバージョンと見なすことができ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。この場合、パラメーターは「key = value」の形式で格納され、パラメーターは[foo]のようなセクションにあるだけでなく、TOML用語ではテーブルと呼ばれますが、 [foo.bar.spam]形式のサブセクション。パラメータには、文字列だけでなく、リスト、数値、ブール値も含めることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このファイルは、Pythonパッケージの構築に必要なすべての情報を記述している必要があり、必ずしもSIPを使用しているわけではありません。</font><font style="vertical-align: inherit;">ただし、後で説明するように、このファイルでは不十分な場合があり、さらに小さなPythonスクリプトを作成する必要があります。</font><font style="vertical-align: inherit;">しかし、順番にすべてについて話しましょう。</font><font style="vertical-align: inherit;">SIPに関連する</font><i><font style="vertical-align: inherit;">pyproject.toml</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイルのすべての可能なパラメーターの完全な説明は</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">、SIPドキュメントページにあります</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
この例</font><font style="vertical-align: inherit;">では、</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">フォルダと同じレベルに</font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">を</font><i><font style="vertical-align: inherit;">作成し</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├──foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──ビン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──メイン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││└──main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│└──Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└──pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の内容は</font><font style="vertical-align: inherit;">次のようになります。</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[build-system]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
セクション</font><font style="vertical-align: inherit;">（TOML用語の「テーブル」）は標準であり、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明されてい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">2つのパラメーターが含まれています。</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">require-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージのビルドに必要なパッケージのリスト。</font><font style="vertical-align: inherit;">パッケージの依存関係の記述形式は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、PythonソフトウェアパッケージのPEP 508 Dependency仕様で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明されてい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この場合、必要なのはsipパッケージバージョン5.xだけです。</font></font></li>
<li><i>build-backend</i> ,        .  ,          Python-,    .        ,   ,    SIP,     «sipbuild.api».</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その他のパラメータについては、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip。*]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションで説明しています</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">[tool.sip.metadata]</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
セクションに</font><font style="vertical-align: inherit;">は、パッケージに関する一般的な情報が含まれます。アセンブルされるパッケージの名前（このパッケージは</font><i><font style="vertical-align: inherit;">pyfoo</font></i><font style="vertical-align: inherit;">と呼ばれますが</font><font style="vertical-align: inherit;">、この名前をモジュールの名前と混同しないでください。後でPythonにインポートします）、パッケージのバージョン番号（この場合）バージョン番号「0.1」）とライセンス（「</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">MIT</font></a><font style="vertical-align: inherit;">」など）。</font><font style="vertical-align: inherit;">
アセンブリの観点から最も重要なものは、[tool.sip.bindings。</font><b><font style="vertical-align: inherit;">pyfoo</font></b><font style="vertical-align: inherit;"> ]。</font><font style="vertical-align: inherit;">
セクションヘッダーのパッケージ名に注意してください。</font><font style="vertical-align: inherit;">このセクションに2つのパラメーターを追加しました。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">headers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -fooライブラリを使用するために必要なヘッダーファイルのリスト。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libraries-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静的リンク用にコンパイルされたオブジェクトファイルのリスト。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、Cコンパイラに添付されているヘッダーファイル以外の追加のヘッダーファイルを探すパスです。この場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを探す</font><i><font style="vertical-align: inherit;">場所</font></i><font style="vertical-align: inherit;">です</font><font style="vertical-align: inherit;">。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、Cコンパイラーに接続されているオブジェクトファイル以外の追加のオブジェクトファイルを検索するパスです。この場合、これは、コンパイル済みライブラリファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fooが作成</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">されるフォルダー</font><i><font style="vertical-align: inherit;">です</font></i><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そこで、SIPに必要な最初のファイルを作成しました。</font><font style="vertical-align: inherit;">次に、将来のPythonモジュールの内容を記述する次のファイルの作成に進みます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyfoo.sip</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sipの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">と同じフォルダ内を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├──foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──ビン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──メイン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││└──main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│└──Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├──pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└──pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拡張子が.sipのファイルは、Pythonでモジュールに変換されるソースライブラリのインターフェースを記述します。</font><font style="vertical-align: inherit;">このファイルには独自のフォーマットがあり、これについては後で説明します。C/ C ++ヘッダーファイルに似ていますが、追加のマークアップがあり、SIPがPythonモジュールを作成するのに役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、このファイルは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">という</font><i><font style="vertical-align: inherit;">名前</font></i><font style="vertical-align: inherit;">にする</font><font style="vertical-align: inherit;">必要があります。これは</font><font style="vertical-align: inherit;">、その前に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><i><font style="vertical-align: inherit;">で</font></i><font style="vertical-align: inherit;"> [tool.sip.bindings。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]。一般的なケースでは、そのようなパーティションが複数存在する可能性があるため、複数の* .sipファイルが必要です。しかし、複数のsipファイルがある場合、これはSIPの観点からの特別なケースであり、この記事ではそれを考慮しません。一般的なケースでは、.sipファイルの名前（したがってセクションの名前）は</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">[tool.sip.metadata]</font></i><font style="vertical-align: inherit;">セクションの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">指定されているパッケージの名前と一致しない場合があることに注意してください</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この例の</font><i><font style="vertical-align: inherit;">pyfoo.sip</font></i><font style="vertical-align: inherit;"> 
ファイル</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">考えます</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo, language=<span class="hljs-string">"C"</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
文字「％」で始まる行はディレクティブと呼ばれます。彼らは、SIPにPythonモジュールを適切にアセンブルおよびスタイルする方法を伝える必要があります。ディレクティブの完全なリストは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このドキュメントページで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ています</font></a><font style="vertical-align: inherit;">。一部のディレクティブには追加のパラメーターがあります。パラメータは必要ないかもしれません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、2つのディレクティブを使用します。次の例では、他のいくつかのディレクティブについて説明します。</font><i><font style="vertical-align: inherit;">pyfoo.sip</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font><font style="vertical-align: inherit;">は、</font><i><font style="vertical-align: inherit;">％Module</font></i><font style="vertical-align: inherit;">ディレクティブ</font><i><font style="vertical-align: inherit;">（name = foo、language =“ C”）で</font></i><font style="vertical-align: inherit;">始まり</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。最初のパラメーター（</font><i><font style="vertical-align: inherit;">name</font></i><font style="vertical-align: inherit;">）の値を引用符なしで指定し、2番目のパラメーター（</font><i><font style="vertical-align: inherit;">language</font></i><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">値</font><font style="vertical-align: inherit;">を指定した</font><font style="vertical-align: inherit;">こと</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">注意し</font><font style="vertical-align: inherit;">て</font><font style="vertical-align: inherit;">ください。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）C / C ++の文字列のように引用符で囲みます。</font><font style="vertical-align: inherit;">これは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブのドキュメントで説明されているように、このディレクティブの要件です</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">％Module</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ディレクティブで</font><font style="vertical-align: inherit;">は、</font><i><font style="vertical-align: inherit;">name</font></i><font style="vertical-align: inherit;">パラメーターのみが必須</font><font style="vertical-align: inherit;">で、ライブラリ関数のインポート元となるPythonモジュールの名前を設定します。</font><font style="vertical-align: inherit;">この場合、モジュールは</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">、それには関数</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">が含まれる</font><font style="vertical-align: inherit;">ため、アセンブリとインストールの後に、コードを使用してそれをインポートします。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、この行を次のように置き換えることにより、このモジュールを別のモジュールにネストさせることができます。</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo.bar, language=<span class="hljs-string">"C"</span>)<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、関数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を次のように</font><font style="vertical-align: inherit;">インポート</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">必要</font><i><font style="vertical-align: inherit;">が</font></i><font style="vertical-align: inherit;">あります。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo.bar <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">％Module</font></i><font style="vertical-align: inherit;">ディレクティブ</font><font style="vertical-align: inherit;">
の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">言語</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、ソースライブラリが記述されている言語を示します。</font><font style="vertical-align: inherit;">このパラメーターの値は、「C」または「C ++」のいずれかです。</font><font style="vertical-align: inherit;">このパラメーターが指定されていない場合、SIPはライブラリがC ++で記述されていると想定します。</font><i><font style="vertical-align: inherit;">pyfoo.sip</font></i><font style="vertical-align: inherit;"> 
ファイルの最後の行を見てください</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、Pythonモジュールに配置するライブラリからの関数のインターフェースの説明です。</font><font style="vertical-align: inherit;">この宣言に基づいて、sipはPython関数を作成します。</font><font style="vertical-align: inherit;">ここではすべてが明確になっていると思います。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 収集・確認</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、Cライブラリのバインディングを含むPythonパッケージを構築する準備がすべて整いました。まず、ライブラリ自体を構築する必要があります。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01 / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに移動し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">makeコマンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してビルドを開始し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="bash hljs">$ make<font></font>
<font></font>
mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが順調に進んだ場合、</font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;">フォルダーは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダー</font><font style="vertical-align: inherit;">内</font><font style="vertical-align: inherit;">に作成されます</font><font style="vertical-align: inherit;">。その中には、他のファイルの中で、コンパイルされた</font><i><font style="vertical-align: inherit;">libfoo.a</font></i><font style="vertical-align: inherit;">ライブラリーがあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ここでは、メイントピックの邪魔にならないように、gccを使用したLinuxでのビルドについてのみ説明していることを思い出してください。</font><i><font style="vertical-align: inherit;">pyfoo_c_01</font></i><font style="vertical-align: inherit;"> 
フォルダに</font><i><font style="vertical-align: inherit;">戻り</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ここで、SIPチームについて理解します。</font><font style="vertical-align: inherit;">SIPをインストールすると、次のコマンドラインコマンドが利用できるようになります（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ドキュメントページ</font></a><font style="vertical-align: inherit;">）。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Python拡張オブジェクトファイルを作成します。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Python拡張オブジェクトファイルを作成してインストールします。</font></font></li>
<li><i>sip-sdist</i>.      .tar.gz,      pip.</li>
<li><i>sip-wheel</i>.     wheel (   .whl).</li>
<li><i>sip-module</i>.  ,      ,   SIP.  ,    ,    .         ,       standalone project,      ,     ,     ,    .</li>
<li><i>sip-distinfo</i>.     <i>.dist-info</i>,       wheel.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのコマンドは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルが</font><i><font style="vertical-align: inherit;">置か</font></i><font style="vertical-align: inherit;">れているフォルダーから実行する必要が</font><i><font style="vertical-align: inherit;">あり</font></i><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開始するには、SIPの動作をよりよく理解するために、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-- </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verbose</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプション</font><font style="vertical-align: inherit;">を</font><i><font style="vertical-align: inherit;">指定</font></i><font style="vertical-align: inherit;">して</font><i><font style="vertical-align: inherit;">sip-buildコマンドを</font></i><font style="vertical-align: inherit;">実行</font><font style="vertical-align: inherit;">し、コンソールへのより詳細な出力</font><font style="vertical-align: inherit;">を取得して、</font><font style="vertical-align: inherit;">ビルドプロセス中に何が起こるかを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build --verbose</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これらのバインディングが構築されます：pyfoo。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pyfooバインディングの生成... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
'foo'モジュールのコンパイル... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
'foo'拡張の</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成ビルドの</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成ビルド/ temp.linux-x86_64-3.8</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c sipfoocmodule.c -o build / temp.linux-x86_64-3.8 / sipfoocmodule.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c：func_foo関数内：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule .c：29：22：警告：暗黙の関数宣言“ foo” [-Wimplicit-function-declaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo（a0）; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c array.c -o build / temp.linux-x86_64-3.8 / array.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune =汎用-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c bool.cpp -o build / temp.linux-x86_64-3.8 / bool.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c objmap.c -o build / temp.linux-x86_64-3.8 / objmap.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune =汎用-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c qtlib.c -o build / temp.linux-x86_64-3.8 / qtlib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c int_convertors.c -o build / temp.linux-x86_64-3.8 / int_convertors.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune =汎用-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c voidptr.c -o build / temp.linux-x86_64-3.8 / voidptr.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c apiversions.c -o build / temp.linux-x86_64-3.8 / apiversions.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune =汎用-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c descriptors.c -o build / temp.linux-x86_64-3.8 / descriptors.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -march = x86-64 -mtune =ジェネリック-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c threads.c -o build / temp.linux-x86_64-3.8 /threads.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune =汎用-O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I。 -I ../../ foo -I / usr / include / python3.8 -c siplib.c -o build / temp.linux-x86_64-3.8 / siplib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c：関数 "slot_richcompare"内：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c </font><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">9536：16：警告：この関数では初期化なしで "st"を使用できます[-Wmaybe-uninitialized] 9536 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 |スロット= findSlotInClass（ctd、st）; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c：10671：19：注：「st」がここで宣言されました</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
〜siplib.c：関数「parsePass2」内：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c：5625：32：警告：この関数では初期化なしで「所有者」を使用できます[-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | *所有者=引数; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^〜</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
g ++ -pthread -shared -Wl、-O1、-sort-common、-as-needed、-z、relro、-z、now -fno-semantic-interposition -Wl、-O1、-sort-common、 --as-needed、-z、relro、-z、now build / temp.linux-x86_64-3.8 / sipfoocmodule.o build / temp.linux-x86_64-3.8 / array.o build / temp.linux-x86_64-3.8 /bool.oビルド/ temp.linux-x86_64-3.8 / objmap.oビルド/ temp.linux-x86_64-3.8 / qtlib.oビルド/ temp.linux-x86_64-3.8 / int_convertors.oビルド/ temp.linux-x86_64 -3.8 / voidptr.oビルド/ temp.linux-x86_64-3.8 / apiversions.oビルド/ temp.linux-x86_64-3.8 / descriptors.oビルド/ temp.linux-x86_64-3.8 / threads.oビルド/ temp.linux -x86_64-3.8 / siplib.o -L ../../ foo / bin -L / usr / lib -lfoo -o / home / jenyay / projects / soft / sip-examples / pyfoo_c_01 / build / foo / foo。 cpython-38-x86_64-linux-gnu.so </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトがビルドされました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIPの作業については詳しく説明しませんが、一部のソースがコンパイルしていることが出力からわかります。</font><font style="vertical-align: inherit;">これらのソースは、このコマンドで作成された</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに表示されます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├──ビルド</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│└───foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──apiversions.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──array.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──array.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──bool.cpp</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──ビルド</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││└──temp.linux-x86_64-3.8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──apiversions.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──array.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──bool.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──descriptors.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──int_convertors.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──objmap.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──qtlib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──sipfoocmodule.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──siplib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──threads.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││└──voidptr.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──descriptors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──foo.cpython-38-x86_64-linux-gnu.so</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──int_convertors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──objmap.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──qtlib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──sipAPIfoo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──sipfoocmodule.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├───sip.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──sipint.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──siplib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──threads.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│└──voidptr.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├──foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──ビン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││├──メイン</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
││└──main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│├──main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│└──Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├──pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└──pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">補助的なソース</font><font style="vertical-align: inherit;">
は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダに</font><font style="vertical-align: inherit;">現れ</font><font style="vertical-align: inherit;">ました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">好奇心</font><font style="vertical-align: inherit;">から、</font><font style="vertical-align: inherit;">作成される</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">モジュールに直接関連して</font><font style="vertical-align: inherit;">いる</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipfoocmodule.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを見てみましょう</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">/*<font></font>
 * Module code.<font></font>
 *<font></font>
 * Generated by SIP 5.1.1<font></font>
 */<font></font>
<font></font>
#include "sipAPIfoo.h"<font></font>
<font></font>
/* Define the strings used by this module. */<font></font>
const char sipStrings_foo[] = {<font></font>
    'f', 'o', 'o', 0,<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_foo, "foo(str) -&gt; int");<font></font>
<font></font>
static PyObject *func_foo(PyObject *sipSelf,PyObject *sipArgs)<font></font>
{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        char* a0;<font></font>
<font></font>
        if (sipParseArgs(&amp;sipParseErr, sipArgs, "s", &amp;a0))<font></font>
        {<font></font>
            int sipRes;<font></font>
<font></font>
            sipRes = foo(a0);<font></font>
<font></font>
            return PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    /* Raise an exception if the arguments couldn't be parsed. */<font></font>
    sipNoFunction(sipParseErr, sipName_foo, doc_foo);<font></font>
<font></font>
    return SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
/* This defines this module. */<font></font>
sipExportedModuleDef sipModuleAPI_foo = {<font></font>
    0,<font></font>
    SIP_ABI_MINOR_VERSION,<font></font>
    sipNameNr_foo,<font></font>
    0,<font></font>
    sipStrings_foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
            SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
<font></font>
/* The SIP API and the APIs of any imported modules. */<font></font>
const sipAPIDef *sipAPI_foo;<font></font>
<font></font>
/* The Python module initialisation function. */<font></font>
#if defined(SIP_STATIC_MODULE)<font></font>
PyObject *PyInit_foo(void)<font></font>
#else<font></font>
PyMODINIT_FUNC PyInit_foo(void)<font></font>
#endif<font></font>
{<font></font>
    static PyMethodDef sip_methods[] = {<font></font>
        {sipName_foo, func_foo, METH_VARARGS, doc_foo},<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, 0, SIP_NULLPTR}<font></font>
    };<font></font>
<font></font>
    static PyModuleDef sip_module_def = {<font></font>
        PyModuleDef_HEAD_INIT,<font></font>
        "foo",<font></font>
        SIP_NULLPTR,<font></font>
        -1,<font></font>
        sip_methods,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    };<font></font>
<font></font>
    PyObject *sipModule, *sipModuleDict;<font></font>
    /* Initialise the module and get it's dictionary. */<font></font>
    if ((sipModule = PyModule_Create(&amp;sip_module_def)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    sipModuleDict = PyModule_GetDict(sipModule);<font></font>
<font></font>
    if ((sipAPI_foo = sip_init_library(sipModuleDict)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    /* Export the module and publish it's API. */<font></font>
    if (sipExportModule(&amp;sipModuleAPI_foo, SIP_ABI_MAJOR_VERSION, SIP_ABI_MINOR_VERSION, 0) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
    /* Initialise the module now all its dependencies have been set up. */<font></font>
    if (sipInitModule(&amp;sipModuleAPI_foo,sipModuleDict) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
<font></font>
    return sipModule;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Python / C APIを使用している場合、おなじみの関数が表示されます。</font><font style="vertical-align: inherit;">18行目から始まる</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">func_foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数に特に注意して</font><i><font style="vertical-align: inherit;">ください</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのソースをコンパイルした結果、ファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo / foo.cpython-38-x86_64-linux-gnu.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が作成さ</font><font style="vertical-align: inherit;">れ、Python拡張機能が含まれているため、正しくインストールする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拡張機能をコンパイルしてすぐにインストールするために、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを使用できますが、</font><font style="vertical-align: inherit;">デフォルトでは、作成されたPython拡張機能をシステムにグローバルにインストールしようとするため、使用しません。このコマンドにはパラメーター</font><i><font style="vertical-align: inherit;">--target-dir</font></i><font style="vertical-align: inherit;">があります</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して、拡張機能をインストールするパスを指定できますが、pipを使用してインストールできるパッケージを作成する他のツールを使用することをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdistコマンドを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">使い方はとても簡単です：</font></font><br>
<br>
<pre><code class="bash hljs">$ sip-sdist<font></font>
<font></font>
The sdist has been built.<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1.tar.gz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルが作成されます</font><font style="vertical-align: inherit;">。これは、次のコマンドを使用してインストールできます。</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user pyfoo-0.1.tar.gz
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、次の情報が表示され、パッケージがインストールされます。</font></font><br>
<br>
<pre><code class="plaintext hljs">Processing ./pyfoo-0.1.tar.gz<font></font>
  Installing build dependencies ... done<font></font>
  Getting requirements to build wheel ... done<font></font>
    Preparing wheel metadata ... done<font></font>
Building wheels for collected packages: pyfoo<font></font>
  Building wheel for pyfoo (PEP 517) ... done<font></font>
  Created wheel for pyfoo: filename=pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl size=337289 sha256=762fc578...<font></font>
  Stored in directory: /home/jenyay/.cache/pip/wheels/54/dc/d8/cc534fff...<font></font>
Successfully built pyfoo<font></font>
Installing collected packages: pyfoo<font></font>
  Attempting uninstall: pyfoo<font></font>
    Found existing installation: pyfoo 0.1<font></font>
    Uninstalling pyfoo-0.1:<font></font>
      Successfully uninstalled pyfoo-0.1<font></font>
Successfully installed pyfoo-0.1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonバインディングを作成できたことを確認しましょう。</font><font style="vertical-align: inherit;">Pythonを起動し、関数を呼び出そうとします。</font><font style="vertical-align: inherit;">私たちの設定によると、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージ</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">は</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">関数を</font><font style="vertical-align: inherit;">含む</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールが含まれ</font><font style="vertical-align: inherit;">ています</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'123456'</span>)
<span class="hljs-number">12</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数のパラメーターとして、文字列だけでなくバイト文字列b'123456 'を渡すことに注意してください。char </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cへの</font><font style="vertical-align: inherit;">直接の類似物です</font><font style="vertical-align: inherit;">。少し後に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">への変換、</font><font style="vertical-align: inherit;">およびその逆</font><font style="vertical-align: inherit;">を追加</font><font style="vertical-align: inherit;">し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。結果は予想通りでした。関数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型の配列の倍のサイズを返し、</font><font style="vertical-align: inherit;">パラメーターとして渡されることを</font><font style="vertical-align: inherit;">思い出し</font><font style="vertical-align: inherit;">てください。</font><font style="vertical-align: inherit;">バイトのリストではなく</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、</font><font style="vertical-align: inherit;">通常のPython文字列</font><font style="vertical-align: inherit;">を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">渡してみましょう</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'123456'</span>)<font></font>
<font></font>
Traceback (most recent call last):<font></font>
  File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
TypeError: foo(str): argument <span class="hljs-number">1</span> has unexpected type <span class="hljs-string">'str'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成されたバインディングは文字列を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に変換できませんでした</font><font style="vertical-align: inherit;">。次のセクションで、これを行う方法を教える方法について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おめでとうございます。Cで書かれたライブラリに最初のバインディングを作成しまし</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
た。Pythonインタープリターを終了し、ホイール形式でアセンブリをアセンブルします。ご存知のように、wheelは比較的新しいパッケージ形式で、最近一般的に使用されています。フォーマットは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 427、「The Wheel Binary Package Format 1.0」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で説明されていますが、wheelフォーマットの機能の説明は、別の大きな記事に値するトピックです。ユーザーがpipを使用してホイール形式でパッケージを簡単にインストールできることが重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
wheel形式のパッケージは、sdist形式のパッケージほど複雑ではありません。これを行うには、ファイルのあるフォルダで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はコマンドを実行する必要があります</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコマンドを実行すると、ビルドプロセスが表示され、コンパイラからの警告が表示される場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ sip-wheel </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのバインディングがビルドされます：pyfoo。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pyfooバインディングの生成... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
'foo'モジュールのコンパイル... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c：func_foo関数内：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c：29：22：警告：foo関数の暗黙の宣言[-Wimplicit-function-declaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo（a0）; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c：関数「slot_richcompare」内：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c </font><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">9536：16：警告：この関数では初期化なしで「st」を使用できます[-Wmaybe-uninitialized] 9536 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 |スロット= findSlotInClass（ctd、st）; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c：10671：19：備考：「st」がここで宣言されました</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
〜siplib.c：関数「parsePass2」内：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c：5625：32：警告：この関数では初期化なしで「所有者」を使用できます[-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | *所有者=引数; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^〜〜</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホイールが作成されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アセンブリが完了すると（小さなプロジェクトはすぐにコンパイルされます）、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など</font><font style="vertical-align: inherit;">の名前のファイルがプロジェクトフォルダーに表示されます</font><font style="vertical-align: inherit;">。生成されるファイルの名前は、オペレーティングシステムとPythonのバージョンによって異なる場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、pipを使用してこのパッケージをインストールできます。</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--upgrade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプションを使用</font><i><font style="vertical-align: inherit;">し</font></i><font style="vertical-align: inherit;">て、pipが以前にインストールしたpyfooモジュールを置き換えるようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、上記のように、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュール</font><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージ</font><font style="vertical-align: inherit;">を使用できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> char *に変換ルールを追加します</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のセクションで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">はバイトのセットしか受け入れられず、文字列は受け入れられない</font><font style="vertical-align: inherit;">という問題が発生しました</font><font style="vertical-align: inherit;">。次に、この欠点を修正します。これを行うには、別のSIPツールである</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用します</font><font style="vertical-align: inherit;">。注釈は.sipファイル内で使用され、一部のコード要素（関数、クラス、関数の引数、例外、変数など）に適用されます。注釈は、スラッシュの間に記述されます：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ annotation /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注釈はフラグとして機能することができます。フラグは状態セットまたは未設定にすることができます（例：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ReleaseGIL /）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、または一部の注釈には値を割り当てる必要があります（例：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Encoding = "UTF-8" /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。いくつかの注釈をオブジェクトに適用する必要がある場合、それらはスラッシュ内のコンマで区切られます：/ annotation_1、annotation_2 /。</font><i><font style="vertical-align: inherit;">pyfoo_c_02</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
フォルダにある次の例では</font><font style="vertical-align: inherit;">、ファイル</font><i><font style="vertical-align: inherit;">pyfoo.sip</font></i><font style="vertical-align: inherit;">アノテーションパラメータ関数</font><i><font style="vertical-align: inherit;">fooを</font></i><font style="vertical-align: inherit;">追加します</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
<font></font>
int foo(char* /Encoding="UTF-8"/);<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アノテーション</font><font style="vertical-align: inherit;">は、関数に渡される文字列をどのエンコーディングでエンコードするかを示します。このアノテーションの値は、ASCII、Latin-1、UTF-8、Noneのいずれかです。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーションが</font><font style="vertical-align: inherit;">指定されていないか</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noneの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合、そのような関数のパラメーターはエンコードされず、そのまま関数に渡されますが、この場合、Pythonコードのパラメーターは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型である必要があり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。前の例で見たように、バイトの配列。エンコーディングが指定されている場合、このパラメーターは文字列（</font><font style="vertical-align: inherit;">Pythonでは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型</font><font style="vertical-align: inherit;">）に</font><font style="vertical-align: inherit;">することができます</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注釈は</font><font style="vertical-align: inherit;">唯一型のパラメータに適用することができる</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONSTチャー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">モジュールの</font><i><font style="vertical-align: inherit;">foo</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数がどのように機能するかを確認してみましょう</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これを行うには、以前と同様に、最初に</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">フォルダー内で</font><i><font style="vertical-align: inherit;">make</font></i><font style="vertical-align: inherit;">コマンドを</font><font style="vertical-align: inherit;">呼び出し</font><font style="vertical-align: inherit;">て</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">ライブラリーをコンパイルし、</font><font style="vertical-align: inherit;">次に</font><i><font style="vertical-align: inherit;">pyfoo_c_02</font></i><font style="vertical-align: inherit;">サンプルフォルダーから</font><font style="vertical-align: inherit;">コマンド、たとえば</font><i><font style="vertical-align: inherit;">sip-wheelを</font></i><i><font style="vertical-align: inherit;">呼び出す必要があり</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl</font></i><font style="vertical-align: inherit;">または同様の名前</font><font style="vertical-align: inherit;">のファイルが作成され</font><font style="vertical-align: inherit;">、次のコマンドを使用して設定できます。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてがうまくいけば、Pythonインタープリターを開始</font><font style="vertical-align: inherit;">して、ストリング引数を指定し</font><font style="vertical-align: inherit;">て</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数を呼び出そうとし</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">''</span>)
<span class="hljs-number">24</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用できることを確認し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。その後、</font><font style="vertical-align: inherit;">文字列引数</font><font style="vertical-align: inherit;">を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">にも</font><font style="vertical-align: inherit;">渡すことができることを確認し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ロシア文字を含む文字列引数の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">は、ラテン文字のみを含む文字列の2倍の値を返した</font><font style="vertical-align: inherit;">ことに注意してください</font><font style="vertical-align: inherit;">。これは、関数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が文字列の長さを文字で数えない（そしてそれを2倍にする）ために発生しましたが、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列の長さであり</font><font style="vertical-align: inherit;">、UTF-8エンコーディングではロシア語の文字が2バイトを占めるため、</font><font style="vertical-align: inherit;">変換後の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列のサイズ</font><font style="vertical-align: inherit;">Pythonの文字列は2倍の長さになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いいね！関数の引数で問題を解決しました</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ですが、ライブラリにそのような関数が数十または数百ある場合、それぞれにパラメータエンコーディングを指定する必要がありますか？多くの場合、プログラムで使用されるエンコーディングは同じであり、異なる関数が異なるエンコーディングを示す目的はありません。この場合、SIPでデフォルトのエンコーディングを指定できます。ある機能で他のエンコーディングが必要な場合は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンコーディング</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーションを使用して再定義できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数パラメーターのエンコーディングをデフォルトで設定するには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブを</font><i><font style="vertical-align: inherit;">使用し</font></i><font style="vertical-align: inherit;">ます。その使用法は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーにある例に示されています</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ディレクティブ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を利用するには</font><font style="vertical-align: inherit;">、ファイル</font><i><font style="vertical-align: inherit;">pyfoo.sipを</font></i><font style="vertical-align: inherit;">変更します</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、その内容は次のとおりです。</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
%DefaultEncoding "UTF-8"<font></font>
<font></font>
int foo(char*);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、引数が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型</font><font style="vertical-align: inherit;">などの</font><font style="vertical-align: inherit;">関数である</font><font style="vertical-align: inherit;">場合。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーションがない</font><font style="vertical-align: inherit;">場合</font><font style="vertical-align: inherit;">、エンコーディングは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブから取得され、</font><font style="vertical-align: inherit;">ない場合、変換は実行されません。また、すべてのパラメーターに対して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などが</font><font style="vertical-align: inherit;">使用されます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">行ではなく</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を転送する必要があり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例えば</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダが</font><i><font style="vertical-align: inherit;">されている</font></i><font style="vertical-align: inherit;">から例と同様に収集、検証</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダー</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.pyについて簡単に説明します。</font><font style="vertical-align: inherit;">組み立ての自動化</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これまでに、Pythonバインディングを作成するために2つのユーティリティファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sipを使用しました</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ここで、別のそのようなファイル（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれる必要があります）に慣れます</font><font style="vertical-align: inherit;">。このスクリプトを使用すると、パッケージのビルドプロセスに影響を与えることができます。ビルドの自動化をしましょう。</font><font style="vertical-align: inherit;">前のセクション</font><font style="vertical-align: inherit;">の例</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を収集するには、</font><font style="vertical-align: inherit;">最初に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> folder </font><font style="vertical-align: inherit;">に移動し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">makeコマンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用し</font><i><font style="vertical-align: inherit;">て</font></i><font style="vertical-align: inherit;">そこでコンパイルし</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルが</font><i><font style="vertical-align: inherit;">配置さ</font></i><font style="vertical-align: inherit;">れているフォルダーに戻り、</font><i><font style="vertical-align: inherit;">次の</font></i><font style="vertical-align: inherit;">いずれかを使用してパッケージのビルドを開始する必要があります</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでの目標は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">コマンドを実行する</font></i><font style="vertical-align: inherit;">ときに、まず</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C-libraryのアセンブリが開始され</font><font style="vertical-align: inherit;">、その後、コマンド自体がすでに起動さ</font><font style="vertical-align: inherit;">れていることを確認することです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このセクションで作成した例は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font><font style="vertical-align: inherit;">フォルダーにあります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドプロセスを変更</font><font style="vertical-align: inherit;">するには、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">sipbuild.Project</font></a><font style="vertical-align: inherit;">クラスから派生</font><font style="vertical-align: inherit;">した</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルで</font><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">宣言</font><font style="vertical-align: inherit;">できます</font><font style="vertical-align: inherit;">（ファイル名はそれだけにする必要があります）</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このクラスには、独自にオーバーライドできるメソッドがあります。</font><font style="vertical-align: inherit;">現在、私たちは以下の方法に興味があります：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルドし</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-buildコマンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の呼び出し中に呼び出され</font><font style="vertical-align: inherit;">ます。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdistコマンドが</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出されたときに呼び出さ</font><i><font style="vertical-align: inherit;">れ</font></i><font style="vertical-align: inherit;">ます。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドが呼び出されたときに呼び出され</font><font style="vertical-align: inherit;">ます。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インストールし</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドが呼び出されたときに呼び出されます</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、これらのコマンドの動作を再定義できます。</font><font style="vertical-align: inherit;">厳密に言えば、リストされたメソッドは、抽象クラス</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.AbstractProject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">宣言され</font><font style="vertical-align: inherit;">、そこから派生クラス</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が作成され</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">次の内容の</font><i><font style="vertical-align: inherit;">project.py</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">作成します</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
クラス</font><font style="vertical-align: inherit;">から派生した</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">を宣言し、</font><i><font style="vertical-align: inherit;">その中に</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを</font><i><font style="vertical-align: inherit;">定義し</font></i><font style="vertical-align: inherit;">ました</font><font style="vertical-align: inherit;">。これらすべてのメソッドで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_build_foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを呼び出す前に、基本クラスから同じ名前のメソッドを呼び出し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。これ</font><font style="vertical-align: inherit;">により、</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">フォルダーで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">makeコマンドの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行が開始さ</font><font style="vertical-align: inherit;">れます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
ことに注意してください</font><i><font style="vertical-align: inherit;">build_sdist</font></i><font style="vertical-align: inherit;">と</font><i><font style="vertical-align: inherit;">build_wheel方法は</font></i><font style="vertical-align: inherit;">、彼らが作成したファイルの名前を返す必要があります。これはドキュメントには書かれていませんが、SIPソースに示されています。</font><font style="vertical-align: inherit;">
ここで、</font><i><font style="vertical-align: inherit;">makeコマンド</font></i><font style="vertical-align: inherit;">を実行する必要はありません。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリを手動で構築</font><font style="vertical-align: inherit;">する場合、これは自動的に行われます。</font><i><font style="vertical-align: inherit;">pyfoo_c_04</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
フォルダーで</font><i><font style="vertical-align: inherit;">sip-wheel</font></i><font style="vertical-align: inherit;">コマンドを実行する</font><font style="vertical-align: inherit;">と、オペレーティングシステムとPythonのバージョンに応じて、pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whlなどの名前でファイルが作成されます。</font><font style="vertical-align: inherit;">
このパッケージは、次のコマンドを使用してインストールできます。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">モジュールの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">引き続き</font><font style="vertical-align: inherit;">機能することを確認できます</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ビルドするコマンドラインオプションを追加する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の例は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダー</font><font style="vertical-align: inherit;">にあり、パッケージのバージョン番号は0.5です（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルの設定を参照</font><font style="vertical-align: inherit;">）。この例は</font><font style="vertical-align: inherit;">、いくつかの修正を加え</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たドキュメントの例に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基づい</font><font style="vertical-align: inherit;">ています。この例では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルをやり直し</font><font style="vertical-align: inherit;">、ビルド用の新しいコマンドラインオプションを追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの例では、非常に単純なライブラリ</font><i><font style="vertical-align: inherit;">fooを</font></i><font style="vertical-align: inherit;">構築しています</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そして実際のプロジェクトでは、ライブラリは非常に大きくなる可能性があり、Pythonバインディングプロジェクトのソースコードに含めることは意味がありません。 SIPはもともとQtのような巨大なライブラリのバインディングを作成するために作成されたことを思い出してください。もちろん、gitのサブモジュールがソースの整理に役立つと主張することはできますが、それは重要ではありません。ライブラリがバインディングソースのあるフォルダーにない可能性があるとします。この場合、SIPコレクターがライブラリヘッダーとオブジェクトファイルをどこで探すべきかという疑問が生じます。この場合、さまざまなユーザーが独自の方法でライブラリを配置できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するために、ビルドシステムに2つの新しいコマンドラインオプションを追加します。このオプションを使用して、ファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">へのパスを指定できます</font><font style="vertical-align: inherit;">（パラメーター</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-include-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）およびライブラリオブジェクトファイル（パラメーター</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-library-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）さらに、これらのパラメーターが指定されていない場合</font><font style="vertical-align: inherit;">でも</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリー</font><font style="vertical-align: inherit;">はバインディングソースとともに配置されている</font><font style="vertical-align: inherit;">と想定し</font><font style="vertical-align: inherit;">ます。</font><i><font style="vertical-align: inherit;">project.py</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイルを再度作成する必要があり</font><font style="vertical-align: inherit;">、その中で</font><i><font style="vertical-align: inherit;">sipbuild.Project</font></i><font style="vertical-align: inherit;">から派生したクラスを宣言し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。まず</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">project.py</font></i><font style="vertical-align: inherit;">ファイルの新しいバージョンを見て</font><font style="vertical-align: inherit;">から、それがどのように機能するかを</font><font style="vertical-align: inherit;">見てみましょう</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Option, Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-string">"""        
       foo.
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">"""     . """</span><font></font>
<font></font>
        tools = [<span class="hljs-string">'build'</span>, <span class="hljs-string">'install'</span>, <span class="hljs-string">'sdist'</span>, <span class="hljs-string">'wheel'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   .</span><font></font>
        options = super().get_options()<font></font>
<font></font>
        <span class="hljs-comment">#   </span>
        inc_dir_option = Option(<span class="hljs-string">'foo_include_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing foo.h"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo'</span>),<font></font>
                                tools=tools)<font></font>
        options.append(inc_dir_option)<font></font>
<font></font>
        lib_dir_option = Option(<span class="hljs-string">'foo_library_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing the foo library"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo/bin'</span>),<font></font>
                                tools=tools)<font></font>
<font></font>
        options.append(lib_dir_option)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""    . """</span><font></font>
<font></font>
        <span class="hljs-comment">#     </span><font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
        <span class="hljs-comment">#  ,         </span><font></font>
        self.foo_include_dir = os.path.abspath(self.foo_include_dir)<font></font>
        self.foo_library_dir = os.path.abspath(self.foo_library_dir)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""   . """</span><font></font>
<font></font>
        <span class="hljs-comment">#   pyfoo</span>
        <span class="hljs-comment"># (  pyproject.toml  [tool.sip.bindings.pyfoo])</span>
        foo_bindings = self.bindings[<span class="hljs-string">'pyfoo'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   include_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_include_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.include_dirs = [self.foo_include_dir]<font></font>
<font></font>
        <span class="hljs-comment">#   library_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_library_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.library_dirs = [self.foo_library_dir]<font></font>
<font></font>
        super().update(tool)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは再び作成さ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProjectの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">から派生し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Projectを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この例では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリの自動アセンブリは無効</font><font style="vertical-align: inherit;">になっています。これは、他の場所にあると想定されているため、バインディングが作成されるまでに、ヘッダーファイルとオブジェクトファイルが準備されているはずです。</font><font style="vertical-align: inherit;">3つの方法が再定義されている</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProjectの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。それらをより注意深く検討してください。</font><i><font style="vertical-align: inherit;">get_options</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッドから始めましょう</font><font style="vertical-align: inherit;">。このメソッドは、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">sipbuild.Option</font></a><font style="vertical-align: inherit;">クラスのインスタンスのリストを返す必要があります</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。各リスト項目はコマンドラインオプションです。オーバーライドされたメソッド内</font><font style="vertical-align: inherit;">で、同じ名前の基本クラスメソッドを呼び出して</font><font style="vertical-align: inherit;">デフォルト</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプション</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のリスト（</font><i><font style="vertical-align: inherit;">オプション</font></i><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を取得し、</font><font style="vertical-align: inherit;">2つの新しいオプション（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を作成してリストに追加し、関数からこのリストを返します。</font><i><font style="vertical-align: inherit;">Option</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
クラスのコンストラクターは、</font><font style="vertical-align: inherit;">1つの必須パラメーター（オプション名）と、このパラメーターの値のタイプ、デフォルト値、パラメーターの説明などを記述する十分に多数のオプションのパラメーターを受け入れます。この例では、</font><i><font style="vertical-align: inherit;">Option</font></i><font style="vertical-align: inherit;">コンストラクターに次のオプションを使用しています</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i>help</i>   ,   ,     <i>sip-wheel -h</i></li>
<li><i>metavar</i> —  ,    ,       .     <i>metavar</i>  «DIR»,   ,     — .</li>
<li><i>default</i> —     .    ,          ,   <i>foo</i>   ,      (    ).</li>
<li><i>tools</i> —  ,        .        <i>sip-build</i>, <i>sip-install</i>, <i>sip-sdist</i>  <i>sip-wheel</i>,  tools = ['build', 'install', 'sdist', 'wheel'].</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のオーバーロードされた</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">、ユーザーがコマンドラインから渡すことができるパラメーター値を設定するように設計されています。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaultsの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">の基本クラスからは、作成</font><font style="vertical-align: inherit;">変数（クラスメンバー）</font><font style="vertical-align: inherit;">で作成された各コマンドラインパラメータのための</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_optionsの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法を</font><font style="vertical-align: inherit;">、コマンドラインパラメータを使用して作成されたすべての変数が作成され、デフォルト値で初期化されるように作成した変数を使用する前に、同じ名前の基底クラスのメソッドを呼び出すことが重要ですので、 。その後、この例では、変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">self.foo_library_dir</font></i><font style="vertical-align: inherit;">が作成されます</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ユーザーが対応するコマンドラインパラメーターを指定していない場合、ユーザーは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスのコンストラクターの</font><font style="vertical-align: inherit;">パラメーター（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">に従ってデフォルト値を取ります</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータが</font><font style="vertical-align: inherit;">設定されていない</font><font style="vertical-align: inherit;">場合、</font><font style="vertical-align: inherit;">予期されるパラメータ値のタイプに応じて、None、空のリスト、または0のいずれかに初期化され</font><font style="vertical-align: inherit;">ます</font><i><font style="vertical-align: inherit;">。apply_user_defaults</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド内</font><font style="vertical-align: inherit;">で、変数</font><i><font style="vertical-align: inherit;">self.foo_include_dir</font></i><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">self.foo_library_dirのパスが</font></i><font style="vertical-align: inherit;">常に絶対</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">である</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことを確認して</font><font style="vertical-align: inherit;">ください。これは、アセンブリの開始時に作業フォルダがどうなるかに依存しないようにするために必要です。</font><font style="vertical-align: inherit;">
このクラスの最後のオーバーロードメソッドは</font><i><font style="vertical-align: inherit;">updateです。</font></i></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このメソッドは、これまでに行われた変更をプロジェクトに適用する必要がある場合に呼び出されます。たとえば、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルで指定されたパラメータを変更または追加します</font><font style="vertical-align: inherit;">。前の例では、我々が使用してヘッダーとオブジェクトファイルへのパスを設定</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含む-DIRS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">及び</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリDIRSの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ、</font><font style="vertical-align: inherit;">それぞれ、内部</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.bindings.pyfoo]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクション</font><font style="vertical-align: inherit;">。ここで、これらのパラメーターを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトから設定する</font><font style="vertical-align: inherit;">ため、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">これらのパラメーター</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">削除します。</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.3"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メソッド内で、</font><font style="vertical-align: inherit;">ディクショナリ</font><i><font style="vertical-align: inherit;">self.bindingsを</font></i><font style="vertical-align: inherit;">キーとする</font><i><font style="vertical-align: inherit;">pyfoo</font></i><font style="vertical-align: inherit;"> gatインスタンス</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">sipbuild.Bindings</font></a><font style="vertical-align: inherit;">から</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新し</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。キー名は[tool.sip.bindings。</font><b><font style="vertical-align: inherit;">pyfoo</font></b><font style="vertical-align: inherit;">から】</font><i><font style="vertical-align: inherit;">pyproject.tomlの</font></i><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">、およびこのようにして得られたクラスのインスタンスは、このセクションで説明する設定を記述しています。次に、このクラス</font><i><font style="vertical-align: inherit;">include_dirs</font></i><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">library_dirs</font></i><font style="vertical-align: inherit;">のメンバー（メンバーの名前は、パラメーター</font><i><font style="vertical-align: inherit;">include-dirs</font></i><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">library-dirsに対応</font></i><font style="vertical-align: inherit;">し、ハイフンがアンダースコアに置き換えられます）には、メンバー</font><i><font style="vertical-align: inherit;">self.foo_include_dir</font></i><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">self.foo_library_dirに</font></i><font style="vertical-align: inherit;">格納されているパスを含むリストが割り当てられます</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この例では、正確さのために、値</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dirが</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">None</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">等しくない</font><font style="vertical-align: inherit;">ことを確認しています</font><font style="vertical-align: inherit;">が、この例では、作成したコマンドラインパラメーターにデフォルト値があるため、この条件は常に満たされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このように、アセンブリ中にヘッダーファイルとオブジェクトファイルへのパスを示すことができるように、構成ファイルを準備しました。何が起こったのか確認してみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、デフォルト値が機能することを確認します。これを行うには、に行く</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05 / fooという</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダ</font><font style="vertical-align: inherit;">と使用してライブラリをビルド</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">makeコマンドを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは、この例では、自動ライブラリのビルドを無効にしているので、。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、フォルダに移動します</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実行し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを実行し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">このコマンドの結果として、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.5-cp38-cp38-manylinux1_x86_64.whlファイル</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または同様の名前の</font><i><font style="vertical-align: inherit;">ファイル</font></i><font style="vertical-align: inherit;">が作成され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーの外のどこかに</font><font style="vertical-align: inherit;">移動し</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを再度実行し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その結果、オブジェクトライブラリファイルがないことを通知する予期されるエラーが発生します。</font></font><br>
<br>
<pre><code class="plaintext hljs">usr/bin/ld:   -lfoo<font></font>
collect2: :  ld     1<font></font>
sip-wheel: Unable to compile the 'foo' module: command 'g++' failed with exit status 1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後</font><font style="vertical-align: inherit;">、新しいコマンドラインオプションを使用して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">実行し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel --foo-include-dir <span class="hljs-string">".../foo"</span> --foo-library-dir <span class="hljs-string">".../foo/bin"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
省略記号の代わりに、</font><font style="vertical-align: inherit;">アセンブルされたライブラリーを使用して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダー</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">移動したフォルダーへのパスを指定する必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その結果、アセンブリは.whlファイルの作成に成功するはずです。</font><font style="vertical-align: inherit;">作成したモジュールは、前のセクションと同じ方法でインストールおよびテストできます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project.pyからメソッドを呼び出す順序を確認する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これから検討する次の例は非常に単純です。</font><font style="vertical-align: inherit;">前のセクションでオーバーロードした</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスのメソッドを呼び出す順序を示し</font><font style="vertical-align: inherit;">ます。これは、変数をいつ初期化できるかを理解するのに役立ちます。この例は</font><font style="vertical-align: inherit;">、ソースリポジトリの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダー</font><font style="vertical-align: inherit;">にあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例の本質は</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">project.py</font></i><font style="vertical-align: inherit;">ファイルにある</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">以前</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">使用したすべてのメソッド</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">オーバーロードし、それら</font><font style="vertical-align: inherit;">に</font><i><font style="vertical-align: inherit;">print</font></i><font style="vertical-align: inherit;">関数への呼び出しを追加することです</font><font style="vertical-align: inherit;">。これにより、それが配置されているメソッドの名前が表示されます。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'get_options()'</span>)<font></font>
        options = super().get_options()<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_user_defaults()'</span>)<font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_nonuser_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_nonuser_defaults()'</span>)<font></font>
        super().apply_nonuser_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'update()'</span>)<font></font>
        super().update(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'build()'</span>)<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span>
        print(<span class="hljs-string">'build_sdist()'</span>)
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span>
        print(<span class="hljs-string">'build_wheel()'</span>)
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'install()'</span>)<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意深い読者は、以前に使用されたメソッドに加えて、前に説明し</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なかっ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た</font><i><font style="vertical-align: inherit;">apply_nonuser_defaults（）</font></i><font style="vertical-align: inherit;">メソッドがこの例ではオーバーロードされていることに注意する必要</font><font style="vertical-align: inherit;">があります。この方法では、コマンドラインパラメーターで変更できないすべての変数にデフォルト値を設定することをお勧めします。</font><i><font style="vertical-align: inherit;">pyproject.toml</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ライブラリへの明示的なパスを返します。</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.4"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクト</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">正常</font><font style="vertical-align: inherit;">にビルドする</font><font style="vertical-align: inherit;">には、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに移動し</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">makeコマンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してライブラリをビルドする</font><font style="vertical-align: inherit;">必要があります</font><font style="vertical-align: inherit;">。その後、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに戻り</font><font style="vertical-align: inherit;">、たとえば</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを実行し</font><font style="vertical-align: inherit;">ます。その結果、あなたはコンパイラの警告を破棄した場合、次のテキストが表示されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options（）</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults（）</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options（）</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options（）</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults（）</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options（）</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新（）</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これらのバインディングが構築されます：pyfooを。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel（）</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
pyfooバインディングの生成... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
'foo'モジュールのコンパイル... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホイールが構築されました。</font></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイルから出力された太線が表示されます</font><font style="vertical-align: inherit;">。したがって、我々は見ること</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_optionsの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法が</font><i><font style="vertical-align: inherit;">されて</font></i><font style="vertical-align: inherit;">数回呼ばれ、あなたがから派生したクラスでは、いくつかのメンバ変数を初期化しようとしている場合は、これを考慮に入れなければならない</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">は、これに最適な場所ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ことを覚えておくことも有用である</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドが</font><i><font style="vertical-align: inherit;">されて</font></i><font style="vertical-align: inherit;">前に呼び出さ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">、すなわち、中</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">その値に設定されている変数を使用することはすでに可能</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法を</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、</font><i><font style="vertical-align: inherit;">更新</font></i><font style="vertical-align: inherit;">メソッドが呼び出されます</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そして最後に、アセンブリを直接担当するメソッド、この場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 前半のまとめ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、CまたはC ++で記述されたライブラリーのPythonバインディングを作成するために設計されたSIPツールの研究を始めました。この記事の最初の部分では、Cで記述された非常に単純なライブラリーのPythonバインディングを作成する例を使用して、SIPの使用の基本を検討しました。SIPを</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
操作するために作成する必要があるファイルを理解しました。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルに</font><font style="vertical-align: inherit;">は、パッケージに関する情報（名前、バージョン番号、ライセンス、およびヘッダーファイルとオブジェクトファイルへのパス）が含まれています。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを使用する</font><font style="vertical-align: inherit;">と、Pythonパッケージのビルドプロセスに影響を与えることができ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">たとえば、Cライブラリのビルドを開始したり、ライブラリのヘッダーファイルやオブジェクトファイルの場所をユーザーに指定させたりできます。</font><i><font style="vertical-align: inherit;">* .sip</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールに含まれる関数とクラスをリストするPythonモジュールのインターフェースについて説明します。</font><font style="vertical-align: inherit;">ディレクティブとアノテーションは</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">sip</font></i><font style="vertical-align: inherit;">ファイルでインターフェースを記述する</font><font style="vertical-align: inherit;">ために使用さ</font><font style="vertical-align: inherit;">れます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事の第2部では、C ++で記述されたオブジェクト指向ライブラリーのバインディングを作成し、その例では、C ++クラスのインターフェースを記述するのに役立つテクニックを研究すると同時に、新しいディレクティブとアノテーションを扱います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つづく。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 参考文献</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事の例</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIPホームページ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIPのドキュメント</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495468/index.html">データ収集端末でも機能する値札認識アルゴリズム</a></li>
<li><a href="../ja495472/index.html">菜食主義に切り替えてもCOVID-19のような病気に感染するのを防ぐことはできません</a></li>
<li><a href="../ja495474/index.html">DataGrip 2020.1：構成の起動、Excelへのエクスポート、エディターでの結果など</a></li>
<li><a href="../ja495476/index.html">Atari DeepMind AIの成功が残念な理由</a></li>
<li><a href="../ja495478/index.html">大小のデータテスター：トレンド、理論、私のストーリー</a></li>
<li><a href="../ja495484/index.html">Unixパイプラインの実装方法</a></li>
<li><a href="../ja495486/index.html">機密データへの新しい脅威：アクロニスグローバル調査結果</a></li>
<li><a href="../ja495490/index.html">DUMP 2020カンファレンスのテストとQAセクション。今年の予定は？スポイラー：鎮痛剤とチェリーのペア</a></li>
<li><a href="../ja495492/index.html">アンリアルエンジン4 iOSゲームのリリース機能</a></li>
<li><a href="../ja495494/index.html">計画ルールのカスタムセットを使用して追加のkubeスケジューラを作成する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>