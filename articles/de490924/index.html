<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔫 💓 🙇🏾 Was ist Windows PowerShell und was isst es? Teil 2: Einführung in die Programmiersprache 🗽 👣 🔖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Vergangenheit sind Befehlszeilenprogramme auf Unix-Systemen besser entwickelt als unter Windows. Mit dem Aufkommen einer neuen Lösung hat sich ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Was ist Windows PowerShell und was isst es? Teil 2: Einführung in die Programmiersprache</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490924/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der Vergangenheit sind Befehlszeilenprogramme auf Unix-Systemen besser entwickelt als unter Windows. Mit dem Aufkommen einer neuen Lösung hat sich die Situation jedoch geändert.</font></font></i></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für PowerShell können Sie Skripte in einer interpretierten Multi-Paradigmen-Sprache schreiben, die Elemente der klassischen prozeduralen, objektorientierten und sogar funktionalen Programmierung enthält: bedingte Verzweigung, Schleifen, Variablen, Arrays, Hash-Tabellen, Klassen, Fehlerbehandlung sowie Funktionen, Cmdlets und Pipelines . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der vorherige Artikel</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> war den Grundlagen des Arbeitens in einer Umgebung gewidmet, und jetzt bieten wir unseren Lesern einen kleinen Leitfaden für Programmierer.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhaltsverzeichnis:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kommentare </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variablen und deren Typen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Systemvariablen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scopes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umgebungsvariablen ( </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arithmetik </font></font></a> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">) </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Rechen- und </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleichsoperatoren </font><font style="vertical-align: inherit;">Zuweisungsoperatoren</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Logische Operatoren </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conditional Übergang </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Loops </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arrays </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hash - </font><font style="vertical-align: inherit;">Tabellen - </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlerbehandlung Sie</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Code in einem beliebigen Texteditor schreiben oder die integrierte Entwicklungsumgebung - der einfachste Weg zu nehmen Windows PowerShell ISE ist in Microsoft Server-Betriebssystemen enthalten. </font><font style="vertical-align: inherit;">Dies ist nur für recht komplexe Skripte erforderlich: Kurze Befehlssätze lassen sich leichter interaktiv ausführen.</font></font><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bemerkungen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Verwendung von Kommentaren wird zusammen mit den richtigen Einrückungen und Leerzeichen als Teil eines guten Programmierstils angesehen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-comment">#       —     .</span><font></font>
<font></font>
<span class="hljs-comment">&lt;# 

             . 
            .

#&gt;</span></code></pre><br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variablen und ihre Typen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variablen in PowerShell sind benannte Objekte. </font><font style="vertical-align: inherit;">Ihre Namen können einen Unterstrich sowie Buchstaben und Zahlen enthalten. </font><font style="vertical-align: inherit;">Das $ -Symbol wird immer vor dem Namen verwendet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jw/f_/bo/jwf_bojczpfg_r16puek7uuo4r0.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um </font><font style="vertical-align: inherit;">eine Variable zu deklarieren, reicht es aus, dem Interpreter einen gültigen Namen anzuzeigen: </font><font style="vertical-align: inherit;">Um die Variable zu initialisieren (ihr einen Wert zuzuweisen), wird der Zuweisungsoperator (symbol =) verwendet:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span> = <span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können eine Variable deklarieren, indem Sie ihren Typ in eckigen Klammern (Typkonvertierungsoperator) vor dem Namen oder Wert angeben:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span><font></font>
<font></font>
<span class="hljs-variable">$test</span> = [<span class="hljs-built_in">int</span>]<span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist wichtig zu verstehen, dass Variablen in PowerShell vollwertige Objekte (Klassen) mit Eigenschaften und Methoden sind, deren Typen auf den in .NET Core verfügbaren basieren. </font><font style="vertical-align: inherit;">Wir listen die wichtigsten auf:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typ (.NET-Klasse)</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codebeispiel</font></font><br>
</th>
</tr>
<tr>
<td>[string]<br>
System.String<br>
</td>
<td> Unicode&nbsp;<br>
</td>
<td>$test = «»<br>
$test = ''<br>
</td>
</tr>
<tr>
<td>[char]<br>
System.Char<br>
</td>
<td> Unicode (16 )<br>
</td>
<td>[char]$test = 'c'<br>
</td>
</tr>
<tr>
<td>[bool]<br>
System.Boolean<br>
</td>
<td>  (  True  False)<br>
</td>
<td>[bool]$test = $true<br>
</td>
</tr>
<tr>
<td>[int]<br>
System.Int32<br>
</td>
<td>   (32 )<br>
</td>
<td>[int]$test = 123456789<br>
</td>
</tr>
<tr>
<td>[long]<br>
System.Int64<br>
</td>
<td>   (64 )<br>
</td>
<td>[long]$test = 12345678910<br>
</td>
</tr>
<tr>
<td>[single]<br>
System.Single<br>
</td>
<td>      32 <br>
</td>
<td>[single]$test = 12345.6789<br>
</td>
</tr>
<tr>
<td>[double]<br>
System.Double<br>
</td>
<td>      64  (8 )<br>
</td>
<td>[double]$test = 123456789.101112<br>
</td>
</tr>
<tr>
<td>[decimal]<br>
System.Decimal<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128-Bit-Gleitkommazahl (am Ende unbedingt d einfügen)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[dezimal] $ test = 12345.6789d</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[DateTime] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.DateTime</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datum (und Uhrzeit&nbsp;</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = Get-Date</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Array] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Object []</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Array, dessen Elementindex bei 0 beginnt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_array = 1, 2, "test", 3, 4</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[hashtable] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Collections.Hashtable</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hash-Tabellen - assoziative Arrays mit benannten Schlüsseln, basierend auf dem Prinzip: @ {key = "value"}</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_hashtable = @ {one = "one"; </font><font style="vertical-align: inherit;">zwei = "zwei"; </font><font style="vertical-align: inherit;">drei = "drei"}</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell unterstützt die implizite Typkonvertierung. Außerdem kann sich der Typ der Variablen im laufenden Betrieb ändern (z. B. mithilfe des Zuweisungsoperators), wenn er nicht zwangsweise angegeben wird. In diesem Fall gibt der Interpreter einen Fehler aus. </font><font style="vertical-align: inherit;">Sie können den Typ einer Variablen aus dem vorherigen Beispiel ermitteln, indem Sie die GetType () -Methode aufrufen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span>.GetType().FullName</code></pre><br>
<img src="https://habrastorage.org/webt/j5/qf/vp/j5qfvplzg-n84l33ie1ogez8gp4.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt eine Reihe von Cmdlets zum Verwalten von Variablen. </font><font style="vertical-align: inherit;">Ihre Liste in praktischer Form wird mit dem folgenden Befehl angezeigt:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Noun</span> Variable | <span class="hljs-built_in">ft</span> <span class="hljs-literal">-Property</span> Name, Definition <span class="hljs-literal">-AutoSize</span> <span class="hljs-literal">-Wrap</span></code></pre><br>
<img src="https://habrastorage.org/webt/za/qc/1t/zaqc1t0hf3-onpravup8_h0euou.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die deklarierten Variablen und ihre Werte anzuzeigen, können Sie das spezielle Cmdlet verwenden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Methode scheint zu umständlich zu sein. Es ist viel bequemer, mit Variablen über Operatoren oder durch direkten Zugriff auf deren Eigenschaften und Methoden zu arbeiten. </font><font style="vertical-align: inherit;">Cmdlets haben jedoch ein Existenzrecht, da Sie damit einige zusätzliche Parameter angeben können. </font><font style="vertical-align: inherit;">Es ist wichtig zu verstehen, dass Benutzervariablen nur innerhalb der aktuellen Sitzung definiert werden. </font><font style="vertical-align: inherit;">Nach dem Schließen der Konsole oder dem Ausfüllen des Skripts werden sie gelöscht.</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Systemvariablen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusätzlich zu den vom Benutzer deklarierten gibt es integrierte (System-) Variablen, die nach dem Ende der aktuellen Sitzung nicht gelöscht werden. </font><font style="vertical-align: inherit;">Sie werden in zwei Typen unterteilt, während PowerShell-Statusdaten in automatischen Variablen gespeichert werden, denen keine eigenen Werte zugewiesen werden können. </font><font style="vertical-align: inherit;">Dazu gehören beispielsweise $ PWD:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PWD</span>.Path</code></pre><br>
<img src="https://habrastorage.org/webt/8u/-5/p1/8u-5p10pygkqcoql1kymnbl3q-g.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Speichern von Benutzereinstellungen benötigen Sie Voreinstellungsvariablen, deren Werte geändert werden können. </font><font style="vertical-align: inherit;">Mit Hilfe von $ ErrorActionPreference wird beispielsweise die Antwort des Befehlsinterpreters auf das Auftreten unkritischer Fehler festgelegt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusätzlich zu Operatoren und Cmdlets gibt es den Pseudoakkumulator Variable: für den Zugriff auf deklarierte Variablen. </font><font style="vertical-align: inherit;">Sie können analog zu anderen Laufwerken damit arbeiten, und die Variablen ähneln in diesem Fall Dateisystemobjekten:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Variable: | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">ls</span> Variable: | more</code></pre><br>
<img src="https://habrastorage.org/webt/h4/03/9e/h4039eawh2tpbuqpyqsidabwkyk.png" alt="Bild"><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geltungsbereich</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für Variablen in PowerShell gibt es den Begriff Scope. </font><font style="vertical-align: inherit;">Die Aktion des globalen Bereichs (Global) erstreckt sich auf die gesamte aktuelle Sitzung - sie umfasst beispielsweise Systemvariablen. </font><font style="vertical-align: inherit;">Lokale Variablen sind nur in dem Bereich verfügbar, in dem sie definiert wurden: Sagen wir innerhalb der Funktion. </font><font style="vertical-align: inherit;">Es gibt auch das Konzept eines Skriptbereichs, aber für Skriptbefehle ist es im Wesentlichen lokal. </font><font style="vertical-align: inherit;">Wenn Sie Variablen deklarieren, erhalten sie standardmäßig einen lokalen Bereich. Um dies zu ändern, ist eine spezielle Konstruktion des Formulars erforderlich: $ Global: variable = value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Beispiel so:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$Global:test</span> = <span class="hljs-number">100</span></code></pre><br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umgebungsvariablen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiteres Env-Pseudo-Laufwerk ist von PowerShell erhältlich, mit dem auf Umgebungsvariablen zugegriffen werden kann. </font><font style="vertical-align: inherit;">Wenn die Shell gestartet wird, werden sie vom übergeordneten Prozess (d. H. Von dem Programm, das die aktuelle Sitzung initiiert hat) kopiert, und normalerweise stimmen ihre Anfangswerte mit den Werten im Bedienfeld überein. </font><font style="vertical-align: inherit;">Verwenden Sie zum Anzeigen von Umgebungsvariablen das Cmdlet Get-ChildItem oder seine Aliase (liases): ls und dir.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">dir</span> Env:</code></pre><br>
<img src="https://habrastorage.org/webt/rf/3d/19/rf3d19syyr5ouu4jnrnnf68gul4.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Variablen sind Folgen von Bytes (oder Zeichen, wenn Sie möchten), deren Interpretation nur von dem Programm abhängt, das sie verwendet. </font><font style="vertical-align: inherit;">* -Variable Cmdlets funktionieren nicht mit Umgebungsvariablen. </font><font style="vertical-align: inherit;">Um darauf zuzugreifen, müssen Sie das Festplattenpräfix verwenden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$env:TEST</span> = <span class="hljs-string">"Hello, World!"</span></code></pre><br>
<img src="https://habrastorage.org/webt/iq/fk/zv/iqfkzvl82gwr-uxadfpudoladtg.png" alt="Bild"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arithmetik- und Vergleichsoperatoren</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell verfügt über die folgenden arithmetischen Operatoren: + (Addition), - (Subtraktion), * (Multiplikation), / (Division) und% (Modul oder Rest der Division). </font><font style="vertical-align: inherit;">Das Ergebnis eines arithmetischen Ausdrucks wird von links nach rechts gemäß der allgemein akzeptierten Reihenfolge der Operationen berechnet, und Klammern werden verwendet, um Teile des Ausdrucks zu gruppieren. </font><font style="vertical-align: inherit;">Leerzeichen zwischen Operatoren werden ignoriert und nur zur Erleichterung der Wahrnehmung verwendet. </font><font style="vertical-align: inherit;">Der Operator + verkettet ebenfalls und der Operator * wiederholt die Zeilen. </font><font style="vertical-align: inherit;">Wenn Sie versuchen, einer Zeichenfolge eine Zahl hinzuzufügen, wird diese in eine Zeichenfolge konvertiert. </font><font style="vertical-align: inherit;">Darüber hinaus verfügt PowerShell über viele Vergleichsoperatoren, die die Entsprechung zwischen zwei Werten überprüfen und den booleschen Wert True oder False zurückgeben:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operator</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codebeispiel</font></font><br>
</th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-eq</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gleich (analog = oder == in anderen Sprachen)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -eq 123&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ne</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht gleich (analog &lt;&gt; oder! =)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ne 123&nbsp;&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-gt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Größer als / Mehr (analog&gt;)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -gt 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ge</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Größer als oder gleich / Größer als oder gleich (analog&gt; =)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ge 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-lt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weniger als (analog &lt;)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -lt 123&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-le</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weniger als oder gleich / Weniger als oder gleich (analog &lt;=)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -le 123</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt andere ähnliche Operatoren, mit denen beispielsweise Zeichenfolgen mit einem Platzhalterzeichen verglichen oder reguläre Ausdrücke zum Abgleichen von Mustern verwendet werden können. </font><font style="vertical-align: inherit;">Wir werden sie in den folgenden Artikeln ausführlich betrachten. </font><font style="vertical-align: inherit;">Die Symbole &lt;,&gt; und = werden nicht zum Vergleich verwendet, da sie für andere Zwecke verwendet werden.</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zuweisungsoperatoren</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neben dem häufigsten Operator = gibt es weitere Zuweisungsoperatoren: + =, - =, * =, / = und% =. </font><font style="vertical-align: inherit;">Sie ändern den Wert vor der Zuordnung. </font><font style="vertical-align: inherit;">Die unären Operatoren ++ und - verhalten sich ähnlich, die den Wert einer Variablen erhöhen oder verringern - beziehen sich auch auf Zuweisungsoperatoren.</font></font><br>
<br>
<a name="section8"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logische Operatoren</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Vergleich reicht nicht aus, um schwierige Bedingungen zu beschreiben. </font><font style="vertical-align: inherit;">Sie können alle logischen Ausdrücke mit den folgenden Operatoren aufschreiben: -and, -or, -xor, -not und! .. Sie funktionieren wie in anderen Programmiersprachen, während Sie die Berechnungsreihenfolge in Klammern angeben können:</font></font><br>
<br>
<pre><code class="powershell hljs">(<span class="hljs-string">""</span> <span class="hljs-operator">-eq</span> <span class="hljs-string">""</span>) <span class="hljs-operator">-and</span> (<span class="hljs-number">100</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>)<font></font>
<font></font>
<span class="hljs-operator">-not</span> (<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>) <font></font>
<font></font>
!(<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>)</code></pre><br>
<a name="section9"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bedingter Sprung</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Verzweigungsoperatoren in PowerShell sind Standard: IF (IF ... ELSE, IF ... ELSEIF ... ELSE) und SWITCH. </font><font style="vertical-align: inherit;">Betrachten Sie ihre Verwendung anhand von Beispielen:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">50</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt;&gt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">10</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">5</span>
<span class="hljs-keyword">switch</span> (<span class="hljs-variable">$test</span>) {
     <span class="hljs-number">0</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 0"</span>}
     <span class="hljs-number">1</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 1"</span>}
     <span class="hljs-number">2</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 2"</span>}
     <span class="hljs-number">3</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 3"</span>}
     <span class="hljs-number">4</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 4"</span>}
     <span class="hljs-number">5</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 5"</span>}<font></font>
     default {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 5    "</span>}<font></font>
}<font></font>
</code></pre><br>
<a name="section10"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fahrräder</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PowerShell gibt es verschiedene Arten von Schleifen: WHILE, DO WHILE, DO UNTIL, FOR und FOREACH. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Vorbedingungsschleife funktioniert, wenn / während sie ausgeführt wird:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schleifen mit einer Nachbedingung funktionieren mindestens einmal, da die Bedingung nach der Iteration überprüft wird. </font><font style="vertical-align: inherit;">In diesem Fall funktioniert DO WHILE, solange die Bedingung erfüllt ist, und DO UNTIL - solange es falsch ist:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>)<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">until</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">9</span>)
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Anzahl der Iterationen der FOR-Schleife ist im Voraus bekannt:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>; <span class="hljs-variable">$test</span>++) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span><font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einer FOREACH-Schleife werden Elemente eines Arrays oder einer Sammlung (Hash-Tabelle) durchlaufen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_collection</span> = <span class="hljs-string">"item1"</span>, <span class="hljs-string">"item2"</span>, <span class="hljs-string">"item3"</span>
<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$item</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$test_collection</span>)<font></font>
{<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$item</span><font></font>
}<font></font>
</code></pre><br>
<a name="section11"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arrays</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell-Variablen speichern nicht nur einzelne Objekte (Nummer, Zeichenfolge usw.), sondern auch mehrere. </font><font style="vertical-align: inherit;">Die einfachste Variante solcher Variablen sind Arrays. </font><font style="vertical-align: inherit;">Ein Array kann aus mehreren Elementen bestehen, einem Element oder leer sein, d.h. </font><font style="vertical-align: inherit;">keine Elemente enthalten. </font><font style="vertical-align: inherit;">Verwenden Sie zum Deklarieren den Operator @ (), den wir im nächsten Artikel benötigen. Dies ist sehr wichtig, um dem Array andere Arrays hinzuzufügen (mehrdimensionale Arrays zu erstellen), Arrays an Funktionen als Argumente zu übergeben und ähnliche Aufgaben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>() <span class="hljs-comment">#  </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Array initialisiert wird, werden seine Werte mit einem Komma (Spezialoperator) aufgelistet: </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>) <span class="hljs-comment">#      </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den meisten Fällen kann der Operator @ () weggelassen werden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall wird ein Array eines Elements wie folgt initialisiert</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = , <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für den Zugriff auf Array-Elemente werden ein ganzzahliger Index ab Null und ein Indexoperator (eckige Klammern) verwendet:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können mehrere durch Kommas getrennte Indizes angeben, einschließlich </font><font style="vertical-align: inherit;">Duplikat:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/vw/5t/qb/vw5tqbcl5agy4603ummtyg984es.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Operator </font></font><code>..</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(zwei Punkte - der Bereichsoperator) gibt ein Array von Ganzzahlen in einem Segment zurück, das durch die Ober- und Untergrenze definiert ist. </font><font style="vertical-align: inherit;">Beispielsweise zeigt Ausdruck 1..4 ein Array von vier Elementen @ (1, 2, 3, 4) an, und Ausdruck 8..5 zeigt ein Array @ (8, 7, 6, 5) an. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/sk/1h/r-sk1h628lw2hraptfbcukhekgs.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Bereichsoperator können Sie ein Array initialisieren ($ test_array = 1..4) oder ein Slice abrufen, d. H. </font><font style="vertical-align: inherit;">eine Folge von Elementen in einem Array mit Indizes von einem anderen. </font><font style="vertical-align: inherit;">In diesem Fall gibt eine negative Zahl -1 das letzte Element des Arrays an, -2 - das vorletzte usw.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..2</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">2</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">1</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">2</span><span class="hljs-type">..1</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass die Werte des Integer-Arrays möglicherweise größer sind als der Maximalwert des Index des Datenarrays. </font><font style="vertical-align: inherit;">In diesem Fall werden alle Werte bis zum letzten zurückgegeben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..100</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie versuchen, auf ein einzelnes nicht vorhandenes Array-Element zuzugreifen, wird $ null zurückgegeben. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/oq/7v/qtoq7vdu_7qt710eszjme9s54rq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PowerShell können Arrays Elemente unterschiedlichen Typs enthalten oder stark typisiert sein:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">""</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>
<span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$test_array</span>.count; <span class="hljs-variable">$i</span>++)<font></font>
{<font></font>
          <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test_array</span>[<span class="hljs-variable">$i</span>]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dabei ist die Eigenschaft $ test_array.count die Anzahl der Elemente im Array. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel für die Erstellung eines stark typisierten Arrays:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>[]]<span class="hljs-variable">$test_array</span> = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span></code></pre><br>
<a name="section12"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hash-Tabellen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer grundlegender Variablentyp in PowerShell sind Hash-Tabellen, die auch als assoziative Arrays bezeichnet werden. </font><font style="vertical-align: inherit;">Hashtable ähnelt dem JSON-Objekt und basiert auf Schlüsselwerten. </font><font style="vertical-align: inherit;">Im Gegensatz zu normalen Arrays erfolgt der Zugriff auf ihre Elemente mit benannten Schlüsseln, bei denen es sich um Objekteigenschaften handelt (Sie können auch den Indexoperator verwenden - eckige Klammern). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine leere Hash-Tabelle wird mit dem Service-Symbol @ und den Operator-Klammern deklariert:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Deklaration können Sie sofort Schlüssel erstellen und diesen Werte zuweisen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{one=<span class="hljs-string">""</span>; two=<span class="hljs-string">""</span>; three=<span class="hljs-string">""</span>; <span class="hljs-string">"some key"</span>=<span class="hljs-string">"some value"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um ein Element zur Hash-Tabelle hinzuzufügen, müssen Sie ihm einen Schlüssel zuweisen, der noch nicht vorhanden ist, oder die Add () -Methode verwenden. </font><font style="vertical-align: inherit;">Wenn die Zuweisung mit einem vorhandenen Schlüssel erfolgt, ändert sich dessen Wert. </font><font style="vertical-align: inherit;">Verwenden Sie die Methode Remove (), um ein Element aus einer Hash-Tabelle zu entfernen.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span>.<span class="hljs-string">"some key"</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">"some key"</span>]
<span class="hljs-variable">$test_hashtable</span>.Add(<span class="hljs-string">"four"</span>, <span class="hljs-string">""</span>)
<span class="hljs-variable">$test_hashtable</span>.five = <span class="hljs-string">""</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">'five'</span>] = <span class="hljs-string">" "</span>
<span class="hljs-variable">$test_hashtable</span>.Remove(<span class="hljs-string">"one"</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/tm/lu/rr/tmlurrhp6hctdugfaqilt06j3le.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variablen dieses Typs können als Argumente an Funktionen und Cmdlets übergeben werden. Im nächsten Artikel erfahren Sie, wie dies funktioniert, und betrachten auch einen anderen ähnlichen Typ - PSCustomObject. </font></font><br>
<br>
<a name="section13"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell verfügt über alle erforderlichen Elemente für die prozedurale Programmierung, einschließlich Funktionen. </font><font style="vertical-align: inherit;">Das Funktionswort Funktion wird verwendet, um sie zu beschreiben. Danach muss der Name der Funktion und der in Operator-Klammern eingeschlossene Körper angegeben werden. </font><font style="vertical-align: inherit;">Übergeben Sie gegebenenfalls Argumente an die Funktion. Sie können sie unmittelbar nach dem Namen in Klammern angeben.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> - <span class="hljs-params">(1, ..., N)</span></span> <font></font>
{ <font></font>
        - <font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Funktion gibt immer ein Ergebnis zurück - dies ist ein Array der Ergebnisse aller ihrer Anweisungen, wenn es mehr als eine gibt. </font><font style="vertical-align: inherit;">Wenn es eine Anweisung gibt, wird ein einzelner Wert des entsprechenden Typs zurückgegeben. </font><font style="vertical-align: inherit;">Das Konstrukt return $ value fügt dem Ergebnisarray ein Element mit dem Wert $ value hinzu und bricht die Anweisungsliste ab. Eine leere Funktion gibt $ null zurück. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie beispielsweise eine Funktion zum Quadrieren einer Zahl:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sqr</span> <span class="hljs-params">(<span class="hljs-variable">$number</span>)</span></span><font></font>
{<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-variable">$number</span> * <span class="hljs-variable">$number</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass Sie im Funktionskörper alle vor dem Aufruf deklarierten Variablen verwenden können und das Aufrufen von Funktionen in PowerShell ungewöhnlich erscheinen kann: Argumente (falls vorhanden) sind nicht in Klammern eingeschlossen und durch Leerzeichen getrennt. </font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder so:</font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-literal">-number</span> <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aufgrund der Art und Weise, wie Argumente übergeben werden, muss die Funktion selbst manchmal in Klammern gesetzt werden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_func</span> <span class="hljs-params">(<span class="hljs-variable">$n</span>)</span></span> {}<font></font>
test_func <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>     <span class="hljs-comment">#   </span>
(test_func) <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>   <span class="hljs-comment">#   — $true</span></code></pre><br>
<img src="https://habrastorage.org/webt/df/kv/mx/dfkvmx4lst2rmo68c0disf_ovl0.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Beschreibung einer Funktion können Sie den Argumenten Standardwerte zuweisen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func</span> <span class="hljs-params">(<span class="hljs-variable">$arg</span> = value)</span></span> {
         <span class="hljs-comment"># </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt eine andere Syntax zur Beschreibung von Funktionsargumenten. Außerdem können Parameter aus der Pipeline gelesen werden. All dies wird im nächsten Artikel nützlich sein, wenn wir exportierte Module betrachten und eigene Cmdlets erstellen.</font></font><br>
<br>
<a name="section14"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlerverarbeitung</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell verfügt über einen Try ... Catch ... Endlich-Mechanismus zur Behandlung von Ausnahmen. </font><font style="vertical-align: inherit;">Der Try-Block enthält Code, in dem ein Fehler auftreten kann, und der Catch-Block enthält seinen Handler. </font><font style="vertical-align: inherit;">Wenn kein Fehler aufgetreten ist, wird er nicht ausgeführt. </font><font style="vertical-align: inherit;">Der Block "finally" wird unabhängig vom Auftreten eines Fehlers nach dem Block "Try" ausgeführt, und es können mehrere Catch-Blöcke für Ausnahmen verschiedener Typen vorhanden sein. </font><font style="vertical-align: inherit;">Die Ausnahme selbst wird in die Standardvariable ohne Deklaration ($ _) geschrieben und kann problemlos abgerufen werden. </font><font style="vertical-align: inherit;">Im folgenden Beispiel implementieren wir einen Schutz gegen die Eingabe eines falschen Werts:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">try</span> {<font></font>
<font></font>
        [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-string">" "</span>
        <span class="hljs-number">100</span> / <span class="hljs-variable">$test</span><font></font>
<font></font>
} <span class="hljs-keyword">catch</span> {<font></font>
<font></font>
         <span class="hljs-built_in">Write-Warning</span> <span class="hljs-string">" "</span>
         <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$_</span><font></font>
<font></font>
}<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/tc/3s/e0/tc3se0iqqbes07g8jm0_zitavgw.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier geht es um die Grundlagen der PowerShell-Programmierung. </font><font style="vertical-align: inherit;">In den folgenden Artikeln werden wir die Arbeit mit Variablen verschiedener Typen, Sammlungen, regulären Ausdrücken, die Erstellung von Funktionen, Modulen und benutzerdefinierten Cmdlets sowie die objektorientierte Programmierung genauer untersuchen. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1: Die Hauptfunktionen von Windows PowerShell </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 3: Übergeben von Parametern an Skripts und Funktionen, Erstellen von Cmdlets </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 4: Arbeiten mit Objekten, benutzerdefinierten Klassen</font></font><br>
</a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490908/index.html">Zonendatenspeicherung</a></li>
<li><a href="../de490912/index.html">Wie wir bei Sportmaster ein Caching-System gewählt haben. Teil 1</a></li>
<li><a href="../de490916/index.html">Probleme der Interaktion mit externen Teams bei großen Projekten</a></li>
<li><a href="../de490918/index.html">Andrei Zaretsky, Alexander Trukhanov (Fortsetzung): „Wir hatten keinen Namen, aber es gab Arroganz“</a></li>
<li><a href="../de490920/index.html">Beschleunigen Sie Ihre Suche in Wurde ich auf 49 Mikrosekunden (C ++) pwned</a></li>
<li><a href="../de490926/index.html">Unity Ball Trajektorie 2d für Anfänger</a></li>
<li><a href="../de490932/index.html">[Prognose] Motornet - ein Datenaustauschnetzwerk für Roboterfahrzeuge</a></li>
<li><a href="../de490936/index.html">Erstellen Sie ML unter iOS</a></li>
<li><a href="../de490938/index.html">Wir schreiben Tausende von Protokolldateien gleichzeitig</a></li>
<li><a href="../de490940/index.html">Erstellen eines Quadrocopters mit einem 3D-Drucker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>