<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéµ üßñ ‚úãüèø Bate-papo geogr√°fico, bots nocivos e esteganografia: enriquecendo o conhecimento sobre o telegrama üåì üë©‚Äçüè≠ üôèüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O que voc√™ sabe sobre telegramas no telegrama? E voc√™ pode distinguir a esteganografia no VideoNote (popularmente - round-robin)? Analisamos a mesma t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bate-papo geogr√°fico, bots nocivos e esteganografia: enriquecendo o conhecimento sobre o telegrama</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/499366/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ls/r-/kn/lsr-knoirt_c2eklbngtrv43ys4.png"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que voc√™ sabe sobre telegramas no telegrama? </font><font style="vertical-align: inherit;">E voc√™ pode distinguir a esteganografia no VideoNote (popularmente - round-robin)? </font><font style="vertical-align: inherit;">Analisamos a mesma tarefa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que causou mais perguntas e exclama√ß√µes ao nosso apoio! </font><font style="vertical-align: inherit;">Spoiler: sim, e tamb√©m haver√° um pouco de criptografia aqui :)</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lenda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">NeoQUEST-2020</font></a><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">encontramos um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para o perfil de um rob√¥ viajante no Instagram. </font><font style="vertical-align: inherit;">Nada fora do comum, certo? </font><font style="vertical-align: inherit;">Por isso, decidimos tamb√©m, mas ainda precisamos resolver o problema, por isso consideramos cuidadosamente todas as fotos no perfil e procuramos pelo menos algumas pistas. </font><font style="vertical-align: inherit;">Um pouco de medita√ß√£o sobre uma bela foto do Lago Baikal, e chegamos √† conclus√£o de que a pista est√° no √∫ltimo post:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/f3/yp/wgf3ypumnzx-gms9aj5ixn7qllw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gra√ßas √† imagem, entendemos que precisamos conectar de alguma forma Baikal (Shaman Rock) e Telegram ("Voc√™ pode se juntar ao meu ..." - isso n√£o lembra nada?). </font><font style="vertical-align: inherit;">Inicialmente, decidimos n√£o dar aos participantes uma dica direta do geo-chat (que √© exatamente isso!). E muitos deles lidaram com √™xito com a tarefa usando um emulador ou um dispositivo m√≥vel com a capacidade de alterar a localiza√ß√£o geogr√°fica. </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shamanim Definimos as</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coordenadas (53.20074, 107.349426) (voc√™ pode ver) na √°rea da rocha Shamanka e preparamos a coisa mais dif√≠cil - a espera. </font><font style="vertical-align: inherit;">O telegrama trabalha estranhamente com o posicionamento geogr√°fico e puxa contatos e bate-papos relevantes por uma hora. </font><font style="vertical-align: inherit;">Por nossa dilig√™ncia e paci√™ncia, somos totalmente recompensados ‚Äã‚Äã- o bate-papo desejado aparece na se√ß√£o Contatos -&gt; Encontrar pessoas pr√≥ximas -&gt; Grupos pr√≥ximos.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cb/z_/ti/cbz_tiwdqa0j0cqdikmwjob704y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voila, estamos no neg√≥cio! </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_c/or/zt/_corztflxylgeewrehp61prvssu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O bot nos encontra com uma tarefa na forma de um arquivo some.bytes com conte√∫do n√£o identificado, no qual podemos ler as linhas "Decrypt me" e "Apocalypse Spares Nobody Ningu√©m". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entendemos a primeira linha sem problemas, mas o que a segunda significa? ... Aqui, os participantes se dividiram em dois campos: alguns nos escreveram por correio, porque chegaram a um beco sem sa√≠da, enquanto outros analisaram cuidadosamente a frase "Apocalypse Spares Nobody Ningu√©m" e discerniram que ? Direita! Bom e velho formato </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASN.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j√° escrevemos sobre como analis√°-lo).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/vr/k4/bbvrk4nu0xsdayswyptuv2z1gpw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos acertar. No interior s√£o 2 estruturas. Em um deles, encontramos um conjunto de bytes marcados como "Decifrar-me", do qual assumimos que este √© um texto cifrado. Na segunda estrutura, vemos dois n√∫meros. √â improv√°vel que essa seja uma chave apresentada generosamente pelo participante, juntamente com o texto cifrado, o que significa mais prov√°vel. Estamos lidando com uma chave p√∫blica. Todas as informa√ß√µes coletadas nos levam √† conclus√£o √≥bvia - por que n√£o tentar a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, n√≥s temos um m√≥dulo e um indicador aberto, que, a prop√≥sito, √© bastante grande. Ap√≥s um </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estudo convulsivo da RSA para</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> refletirmos, conclu√≠mos que o indicador fechado √© pequeno, o que significa o qu√™? Bingo! Definitivamente, podemos interpretar bandidos e usar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o ataque de Wiener</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s pensamos nisso at√© para quem n√£o gosta de criptografia - voc√™ pode usar uma vers√£o pronta do ataque, por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isso</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, obter o valor de uma figura fechada </font></font><code>d=40553818206320299896275948250950248823966726834704013657854904761789429403771</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e descriptografar texto cifrado: </font></font><code>key=nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u;pass=passCxws3jzYhp0HD5Fy84</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obtemos a chave "nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u" na primeira parte do trabalho e a senha "passCxws3jzYhp0HD5Fy84", que voc√™ precisa alimentar o representante do bot. </font><font style="vertical-align: inherit;">Pode ser encontrado entre os participantes do bate-papo sob o nome @neoquestbot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estando na onda de positivo ao receber a primeira chave, n√£o percebemos imediatamente que o bot √© exigente na comunica√ß√£o e o tempo todo diz que n√£o v√™ o interlocutor:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/ky/t_/exkyt__66acqprkte1kk_hljuge.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas o bot recebe felizmente as mensagens redondas do VideoNote e at√© as responde ... da mesma forma redonda:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/tk/k4/gvtkk4hr8u_a8gsidkkqijtcuzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que o v√≠deo e o som s√£o os mesmos, mas isso √© apenas √† primeira vista. </font><font style="vertical-align: inherit;">E se o nosso bot nos der alguns sinais secretos? </font><font style="vertical-align: inherit;">Para descobrir, salvaremos e compararemos o v√≠deo original com a resposta do bot. </font><font style="vertical-align: inherit;">Para isso e para os pr√≥ximos passos, o pacote </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FFmpeg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© √≥timo para n√≥s </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ent√£o, vamos ver o que h√° l√°:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/re/jy/z0/rejyz0tnqx0lgvvcggpctdv2elq.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ri/e3/_v/rie3_vg77u1j1txjch9te5a8y1w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formato aac -&gt; flac, frequ√™ncia 44100 Hz -&gt; 98000 Hz. </font><font style="vertical-align: inherit;">Eles descobriram que continuamos a trabalhar mais com o √°udio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com um movimento h√°bil das m√£os, retiramos do v√≠deo:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/er/ql/jh/erqljhyvzkhdq34zoxmfvl7ezty.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mesmo pode ser feito com a nossa mensagem original, para que possamos compar√°-las mais tarde. </font><font style="vertical-align: inherit;">Para maior clareza, abra as duas faixas no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audacity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gd/ga/gq/gdgagqn_qtefqtnbyphj2ud0b00.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O salto em amplitude na resposta de √°udio do bot chama sua aten√ß√£o imediatamente (especialmente estranho se estiv√©ssemos em sil√™ncio). </font><font style="vertical-align: inherit;">Em uma inspe√ß√£o mais detalhada, notamos os limites claros dos intervalos durante a altern√¢ncia do "sil√™ncio das ondas":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mu/7f/zp/mu7fzposl6z9ozjrxanvjfnh2hw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sugerimos colocar todas as coisas de lado e contar um pouco. </font><font style="vertical-align: inherit;">Analisamos por fragmentos: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 - 0,005 - sil√™ncio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,005 - 0,01 - onda </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0, 01 - 0,0225 - sil√™ncio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,025 - 0,04 - onda </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,04 - 0,045 - sil√™ncio </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O menor intervalo √© 0,005 e todos os outros intervalos s√£o m√∫ltiplos de 0,005. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tomamos a presen√ßa de uma onda de 0,005 para 1 e o sil√™ncio para 0. N√£o obtemos nada al√©m de um c√≥digo bin√°rio! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lembramos que a frequ√™ncia mudou e tentamos observar o gr√°fico de espectro (Analysis -&gt; Spectrum graph):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7p/us/g0/7pusg01eyco5oawp9fyw92rbpzi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que o sinal mais poderoso est√° na frequ√™ncia de ~ 44100 Hz, que √© o ultrassom. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, voc√™ deve trabalhar apenas com altas frequ√™ncias. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, o bot sobrep√µe seu sinal ao √°udio original no espectro aud√≠vel. E os participantes que tinham som no v√≠deo original perceberam isso no Audacity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cortamos as altas frequ√™ncias com um filtro passa-alto no Audacity ou no mesmo ffmpeg:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3c/tk/tc/3ctktc0fgdc9zevjijzypncxb9o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, temos um arquivo wav mono de 16 bits. Consiste em um cabe√ßalho, fluxo de √°udio n√£o compactado e metadados. O fluxo de √°udio em si √© dividido em quadros (e os quadros podem armazenar v√°rias amostras, mas essa √© uma hist√≥ria completamente diferente), no nosso caso, 16 bits cada (isso √© indicado pelas letras pcm_s16 nas capturas de tela). Quadros s√£o sequ√™ncias de bits que descrevem a amplitude da onda de cada vez para um ou mais canais (no nosso caso, para um). A frequ√™ncia de amostragem do fluxo de √°udio √© de 98000 quadros (ou seja, 98000 quadros por um segundo), 490 quadros por 0,005 segundo de intervalo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, ainda trabalhamos de acordo com um algoritmo simples: lemos 490 quadros, determinamos se √© uma onda ou sil√™ncio e, dependendo disso, definimos o bit como 0 ou 1. Usaremos </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
python e um pacote</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wave</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para analisar arquivos wav. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o erro "wave.Error: unknown format: 65534" ocorrer ao abrir o arquivo, substitua "wFormatTag" no cabe√ßalho de 'FE FF' para '01 00 ':</font></font><br>
<br>
<pre><code class="python hljs">fh = open(input_file, <span class="hljs-string">"r+b"</span>)<font></font>
fh.seek(<span class="hljs-number">20</span>)<font></font>
fh.write(<span class="hljs-string">b'\x01\x00'</span>)<font></font>
fh.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, abra o arquivo, processe 490 quadros e calcule o valor m√©dio:</font></font><br>
<br>
<pre><code class="python hljs">file = wave.open(input_file,<span class="hljs-string">"r"</span>)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(file.getnframes()/<span class="hljs-number">490</span>)+<span class="hljs-number">1</span>):<font></font>
        frames = file.readframes(<span class="hljs-number">490</span>)<font></font>
        bit = <span class="hljs-number">0</span>
        sum = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">246</span>):<font></font>
            frame_bytes = frames[k*<span class="hljs-number">2</span>:k*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>]<font></font>
            sum += int.from_bytes(frame_bytes, <span class="hljs-string">"big"</span>)
        <span class="hljs-keyword">if</span> sum/<span class="hljs-number">490</span> &gt; <span class="hljs-number">16000</span>:<font></font>
            bit = <span class="hljs-number">1</span><font></font>
        bits.append(bit)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â poss√≠vel que, onde houver sil√™ncio (compare com a imagem no Audacity), o ru√≠do permane√ßa. </font><font style="vertical-align: inherit;">Portanto, definimos o limite (que seja 16000), excedendo o que consideramos o sinal como 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, agrupamos os bits em bytes:</font></font><br>
<br>
<pre><code class="python hljs">bytes = []    
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(len(bits)/<span class="hljs-number">8</span>)+<span class="hljs-number">1</span>):<font></font>
        b1 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-8</span>]<font></font>
        b2 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-7</span>]<font></font>
        b3 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-6</span>]<font></font>
        b4 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-5</span>]<font></font>
        b5 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-4</span>]<font></font>
        b6 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-3</span>]<font></font>
        b7 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-2</span>]<font></font>
        b8 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-1</span>]<font></font>
        byte = (b1 &lt;&lt; <span class="hljs-number">7</span>) | (b2 &lt;&lt; <span class="hljs-number">6</span>) | (b3 &lt;&lt; <span class="hljs-number">5</span>) | (b4 &lt;&lt; <span class="hljs-number">4</span>) | (b5 &lt;&lt; <span class="hljs-number">3</span>) | (b6 &lt;&lt; <span class="hljs-number">2</span>) | (b7 &lt;&lt; <span class="hljs-number">1</span>) | b8<font></font>
        bytes.append(byte.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">'big'</span>)) 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se tudo for feito corretamente, o resultado ser√° a sequ√™ncia "Fornecer a senha". </font><font style="vertical-align: inherit;">Como o bot se comunica em c√≠rculos usando a esteganografia, ser√° l√≥gico inserir uma senha (e a recebemos juntamente com a chave como resultado da descriptografia) no mesmo formato. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, componha uma faixa de √°udio com uma senha. </font><font style="vertical-align: inherit;">Para isso, usamos os dados obtidos durante a an√°lise da mensagem do bot: frequ√™ncia de amostragem 98000 Hz; </font><font style="vertical-align: inherit;">a dura√ß√£o do sinal que descreve cada bit √© de 5 ms; </font><font style="vertical-align: inherit;">a frequ√™ncia do sinal correspondente ao valor do bit "1" - como vimos nos gr√°ficos, 44100 Hz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora precisamos "gerar" sil√™ncio. </font><font style="vertical-align: inherit;">Fazemos isso neutralizando:</font></font><br>
<br>
<pre><code class="python hljs">sample_rate = <span class="hljs-number">98000.0</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_silence</span>(<span class="hljs-params">duration_milliseconds=<span class="hljs-number">5</span></span>):</span><font></font>
    fragment = []<font></font>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)): <font></font>
        fragment.append(<span class="hljs-number">0.0</span>)
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para gerar som, usaremos uma onda senoidal (as informa√ß√µes podem ser lidas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_sinewave</span>(<span class="hljs-params">
        freq=<span class="hljs-number">41000.0</span>, 
        duration_milliseconds=<span class="hljs-number">5</span>, 
        volume=<span class="hljs-number">0.5</span></span>):</span><font></font>
    fragment = []<font></font>
    amplitude = volume * <span class="hljs-number">32767.0</span>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)):<font></font>
        fragment.append(amplitude * math.sin(<span class="hljs-number">2</span> * math.pi * freq * ( x / sample_rate )))
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora a coisa √© pequena: resta converter a senha em bits e depois em som. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota: O bot usa a faixa de v√≠deo de entrada original para sobrepor sua mensagem, como mencionado anteriormente. </font><font style="vertical-align: inherit;">Portanto, voc√™ precisa adicionar alguns bytes zero ap√≥s a senha para retirar toda a chave do bot, e n√£o apenas seu in√≠cio (o comprimento da chave era 36 bytes).</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gera√ß√£o de som</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs">    audio = []<font></font>
    f = open(input_file, <span class="hljs-string">'rb'</span>)
    <span class="hljs-keyword">for</span> character <span class="hljs-keyword">in</span> f.read():<font></font>
        a = character<font></font>
        b8 = a &amp; <span class="hljs-number">0b00000001</span> 
        b7 = (a &amp; <span class="hljs-number">0b00000010</span>) &gt;&gt; <span class="hljs-number">1</span> 
        b6 = (a &amp; <span class="hljs-number">0b00000100</span>) &gt;&gt; <span class="hljs-number">2</span>
        b5 = (a &amp; <span class="hljs-number">0b00001000</span>) &gt;&gt; <span class="hljs-number">3</span>
        b4 = (a &amp; <span class="hljs-number">0b00010000</span>) &gt;&gt; <span class="hljs-number">4</span>
        b3 = (a &amp; <span class="hljs-number">0b00100000</span>) &gt;&gt; <span class="hljs-number">5</span>
        b2 = (a &amp; <span class="hljs-number">0b01000000</span>) &gt;&gt; <span class="hljs-number">6</span>
        b1 = (a &amp; <span class="hljs-number">0b10000000</span>) &gt;&gt; <span class="hljs-number">7</span>
        <span class="hljs-keyword">if</span> b1 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b2 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b3 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b4 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b5 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b6 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b7 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b8 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos criar o arquivo wave finalizado:</font></font><br>
<br>
<pre><code class="python hljs">wav_file=wave.open(file_name,<span class="hljs-string">"w"</span>)<font></font>
    nchannels = <span class="hljs-number">1</span>
    sampwidth = <span class="hljs-number">2</span><font></font>
    nframes = len(audio)<font></font>
    comptype = <span class="hljs-string">"NONE"</span>
    compname = <span class="hljs-string">"not compressed"</span><font></font>
    wav_file.setparams((nchannels, sampwidth, sample_rate, nframes, comptype, compname))<font></font>
    <span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> audio:<font></font>
        wav_file.writeframes(struct.pack(<span class="hljs-string">'h'</span>, int(sample)))<font></font>
    wav_file.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salvamos nossa trilha, por exemplo, em pass.wav. </font><font style="vertical-align: inherit;">Ao longo do caminho, verificamos com nosso decodificador stego se a senha √© reconhecida. </font><font style="vertical-align: inherit;">Se tudo estiver bem, obteremos um novo v√≠deo com uma senha do v√≠deo original my_video.mp4, substituindo a faixa de √°udio:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7y/vg/_u/7yvg_ulbp5wmx8jmz5vmxucgogu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora precisamos fazer do VideoNote isso. </font><font style="vertical-align: inherit;">Voc√™ pode tentar procurar os que est√£o funcionando (alguns dos participantes, por exemplo, encontraram @TelescopyBot), ou pode escrever seu bot usando o TelegramAPI.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rk/_4/np/rk_4nphgkerx68klet43x0npzrg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Enfim, encaminhe para o nosso bot:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3x/li/0g/3xli0gyrmnawsnl6fyqa90slv6e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recebemos uma nova rodada e parab√©ns (ter√≠amos feito um trabalho assim!), Decodificamos o √°udio de acordo com o cen√°rio j√° elaborado e obtivemos a chave: ‚Äúnq2020SyOMK7SnnJP1sNlvbTs8zt35vUrrsD‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, n√£o √© √† toa que a esteganografia √© considerada uma das √°reas mais dif√≠ceis da seguran√ßa cibern√©tica - tente adivinhar essas coisas! </font><font style="vertical-align: inherit;">Mas os participantes do NeoQUEST mostraram excelente destreza e senso de humor durante esta tarefa, por isso estamos abordando nossa sincera (dos parab√©ns pelo bot) sincera admira√ß√£o!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt499356/index.html">Hackintosh no Powermac G5 ou como montar uma esta√ß√£o de trabalho. Parte 2</a></li>
<li><a href="../pt499358/index.html">PEP 257 em russo. (Docstrings Agreement)</a></li>
<li><a href="../pt499360/index.html">Criando e configurando a rede Mesh de acordo com sua pr√≥pria experi√™ncia, bem como algumas figuras e an√°lises</a></li>
<li><a href="../pt499362/index.html">Semana 2 da maratona remota: fluxos de trabalho</a></li>
<li><a href="../pt499364/index.html">Alexey Kapterev: Pensamento Cr√≠tico 101 (Parte 1)</a></li>
<li><a href="../pt499368/index.html">Sobre Phrasal Verbs-4 (in / out)</a></li>
<li><a href="../pt499370/index.html">Minhas perguntas CSS favoritas com respostas detalhadas</a></li>
<li><a href="../pt499374/index.html">Exame dos dados de prolifera√ß√£o de COVID-19 usando diferen√ßas de primeira ordem. E o que veio disso</a></li>
<li><a href="../pt499376/index.html">Um pouco sobre o dispositivo do r√°dio moderno no exemplo do HackRF One</a></li>
<li><a href="../pt499378/index.html">Crie seu primeiro teste de Cypress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>