<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§õüèº üö∂üèæ ‚úäüèª Autentica√ß√£o em equipamentos de rede por SSH usando chaves p√∫blicas üåä üë∑ üßï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Por padr√£o, os engenheiros se conectam ao equipamento de rede usando um nome de usu√°rio e senha. Usando o Telnet, as credenciais do usu√°rio s√£o transm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Autentica√ß√£o em equipamentos de rede por SSH usando chaves p√∫blicas</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/490726/"><img src="https://habrastorage.org/webt/ss/yc/-o/ssyc-oz7kbnxgw-o4rmrcit6gsg.jpeg" alt="Molho de chaves"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, os engenheiros se conectam ao equipamento de rede usando um nome de usu√°rio e senha. </font><font style="vertical-align: inherit;">Usando o Telnet, as credenciais do usu√°rio s√£o transmitidas em texto n√£o criptografado e por SSH, criptografadas. </font><font style="vertical-align: inherit;">Para n√£o transmitir a parte secreta pela rede, √© usada a autentica√ß√£o de chave p√∫blica. </font><font style="vertical-align: inherit;">Com essa autentica√ß√£o, a chave p√∫blica do usu√°rio √© pr√©-atribu√≠da ao usu√°rio no equipamento. </font><font style="vertical-align: inherit;">A chave privada n√£o √© transmitida pela rede. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este guia o ajudar√° a come√ßar a usar rapidamente chaves p√∫blicas para autentica√ß√£o ao conectar-se a equipamentos de rede usando o protocolo SSH. </font><font style="vertical-align: inherit;">O guia √© aplic√°vel para Windows e Mac OS X. Tentei torn√°-lo o mais simples e informativo poss√≠vel. </font><font style="vertical-align: inherit;">N√£o est√° sobrecarregado, mas responde √†s perguntas b√°sicas:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onde obter a chave p√∫blica e como us√°-la?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">         ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">           ?</a></li>
</ul><br>
<a name="habracut"></a><br>
<h2></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  RSA-</a><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> RSA-  SecureCRT</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> RSA-  PuTTYgen</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> RSA-   Putty Private Key (PuTTY)   OpenSSH (SecureCRT)</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> RSA-   VanDyke Private Key (SecureCRT)   Putty Private Key (PuTTY)</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    MAC OS X   </a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cisco IOS XE, Catalyst (  15.1  ), IOS</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cisco ASA</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   Huawei</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Huawei USG (6000)</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cisco Nexus 9.3</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">      SSH</a><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SecureCRT</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PuTTY</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MAC OS X</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    SSH  MAC OS X:</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m examinei os t√≥picos "doloridos":</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convers√£o de chave entre OpenSSH &lt;==&gt; SecureCRT &lt;==&gt; PuTTY.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando diferentes pares de chaves p√∫blicas para diferentes equipamentos. </font><font style="vertical-align: inherit;">Uma chave √© boa, mas n√£o aplic√°vel na realidade. </font><font style="vertical-align: inherit;">Diferentes clientes ou equipamentos requerem diferentes pares de chaves p√∫blicas (algumas com senha e outras sem).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando o MAC OS X nativo (nativo) para trabalhar com chaves p√∫blicas.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O guia tamb√©m deve ajudar a usar o Ansible com equipamentos de rede, pois o Ansible usa o OpenSSH com autentica√ß√£o de chave p√∫blica por padr√£o.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
90% do material apresentado √© testado em equipamentos reais.</font></font><br>
<br>
<a name="Introduction"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introdu√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m da autentica√ß√£o de senha padr√£o (senha / teclado) no protocolo SSH, tamb√©m h√° autentica√ß√£o de chave p√∫blica (RSA).</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para refer√™ncia</font></font></b><div class="spoiler_text">RSA (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://ru.wikipedia.org/wiki/RSA</a>) ‚Äî     .     (public key)     (private key).        :            .         .         ,       ,        .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A autentica√ß√£o usando chaves RSA consiste em v√°rias etapas: </font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando um par de chaves RSA.</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalando uma chave p√∫blica no equipamento.</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conex√£o ao equipamento e autentica√ß√£o usando uma chave RSA.</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que apenas RSA? </font><font style="vertical-align: inherit;">Por que n√£o um DSA? </font><font style="vertical-align: inherit;">Infelizmente, n√£o encontrei a resposta para esta pergunta (e realmente n√£o a procurei). </font><font style="vertical-align: inherit;">Mas oficialmente, apenas o RSA √© suportado em equipamentos da Cisco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Guia de configura√ß√£o do Secure Shell, Cisco IOS Release 15E:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guia de configura√ß√£o do Secure Shell, Cisco IOS Release 15E </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Restri√ß√µes para o Secure Shell Vers√£o 2 Suporte A </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gera√ß√£o de chaves Rivest, Shamir e Adleman (RSA) √© um requisito do servidor SSH. </font><font style="vertical-align: inherit;">Os dispositivos que atuam como clientes SSH n√£o precisam gerar chaves RSA.</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentativa de inserir dados chave do DSA:</font></font><br>
<br>
<pre><code class="plaintext hljs">CSR-1(conf-ssh-pubkey-data)#exit<font></font>
%SSH: Only ssh-rsa type is supported<font></font>
CSR-1(conf-ssh-pubkey-user)#<font></font>
</code></pre><br>
<a name="CreatePublicKey"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando uma chave p√∫blica RSA</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um par de chaves RSA pode ser criado usando v√°rios utilit√°rios: SecureCRT, PuTTYgen ou qualquer outro software. </font><font style="vertical-align: inherit;">Ao criar uma chave, voc√™ pode definir a senha (prote√ß√£o por senha com uma chave).</font></font><br>
<br>
<a name="CreatePublicKeySecureCRT"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gera√ß√£o de pares RSA no SecureCRT</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SecureCRT -&gt; Ferramentas -&gt; Criar Chave P√∫blica ...:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2m/xb/eb/2mxbeb3d8sc8thocdojacrzizn4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pouco de teoria ‚Üí o bot√£o "Next&gt;":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wv/ii/ze/wviize2n_5dkko4v4kpyxkkwzty.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tipo de certificado RSA / DSA ‚Üí Selecione RSA ‚Üí bot√£o "Pr√≥ximo&gt;":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rs/le/ni/rslenitclgxtobzvsz_ulj39q_c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Senha de criptografia da chave secreta (opcional, voc√™ pode deix√°-la em branco e n√£o criptografar) + Comentar ‚Üí bot√£o "Avan√ßar&gt;":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/q7/_q/5v/q7_q5vwtmmpbeszmxkizeuznul4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Escolha o comprimento da chave (no SecureCRT vers√£o 6.1.0, o comprimento m√°ximo da chave √© 2048 bits, na vers√£o 8.5.4 - 16 384 bits):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/q5/qm/zg/q5qmzgg_hzzlyg_q0qvobcddkd4.png"></div><br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gera√ß√£o de </font><font style="vertical-align: inherit;">
teclas ‚Üí Bot√£o "Pr√≥ximo&gt;": </font><font style="vertical-align: inherit;">Para gerar n√∫meros aleat√≥rios, voc√™ precisa mover o mouse dentro da janela.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wf/w8/dh/wfw8dhn0tsfuj8nkdfprxdsjpxk.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/aw/yj/cs/awyjcsqvlbd_6tapahm4twq8kj4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salvando um par de chaves ‚Üí Selecionando um local de armazenamento ‚Üí Selecionando um formato para uma chave salva (formato VanDuke Private, OpenSSH legado, OpenSSH novo) ‚Üí bot√£o "Concluir": </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9n/ts/3s/9nts3s5p5bnfiz14nwmlo59eva4.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kq/pw/dv/kqpwdvana4ytrh1wjrzbdtjegzu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O SecureCRT pergunta se essa chave √© a chave padr√£o do SecureCRT:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zl/pa/iv/zlpaiv_a3gr6noc5hppfx-1vpoq.png"></div><br>
<a name="CreatePublicKeyPuttygen"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gera√ß√£o de pares RSA no PuTTYgen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode fazer o download do PuTTYgen aqui: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inicie o PuTTYgen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_l/wi/fo/_lwifoh8tblsbyjqqft_7ooyofu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecione os par√¢metros (tipo de par: RSA; dimens√£o do bit de chave: 2048; opcionalmente defina Senha (prote√ß√£o de senha com uma senha)) ‚Üí Gerar:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/b3/dw/d0/b3dwd0xoppidkvcjqwzont-kxj0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para garantir n√∫meros aleat√≥rios, ele pede para mover o mouse dentro da janela. </font><font style="vertical-align: inherit;">Esta √© uma prote√ß√£o contra n√∫meros pseudo-aleat√≥rios.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ee/0a/vq/ee0avqbadgo1s4r8ir21kchtuoa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salvar chaves RSA ‚Üí bot√£o "Salvar chave privada":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fp/l-/qa/fpl-qavfk_rncnkpey7leotfaqe.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Observa√ß√£o: as chaves RSA armazenadas em formato privado em um software n√£o podem ser usadas em software de outro fabricante. </font><font style="vertical-align: inherit;">Ou seja, um par de chaves RSA criadas no PuTTYgen e salvas no formato Putty Private Key n√£o √© adequado para uso no SecureCRT e vice-versa. </font><font style="vertical-align: inherit;">O PuTTY suporta apenas o formato Putty Private Key. </font><font style="vertical-align: inherit;">Uma solu√ß√£o universal para distribui√ß√£o de chaves √© converter chaves para o formato OpenSSH (consulte o link 2: ‚ÄúConvers√£o de Putty para SecureCRT com chaves de autentica√ß√£o‚Äù). </font><font style="vertical-align: inherit;">Desde SecureCRT trabalha livremente com o formato OpenSSH. </font><font style="vertical-align: inherit;">E o software PuTTYgen converte o formato OpenSSH no formato Putty Private Key.</font></font><br>
<br>
<a name="ConvertPPKtoOpenSSH"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertendo uma chave RSA do formato Putty Private Key (PuTTY) para o formato OpenSSH (SecureCRT)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para usar chaves RSA no SecureCRT que s√£o geradas no PuTTYgen e salvas no formato Putty Private Key (* .ppk), exportamos-as usando PuTTYgen no formato OpenSSH:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inicie o PuTTYgen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregamos a chave RSA existente no formato Putty Private Key (* .ppk) ‚Üí O bot√£o "Carregar".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salve o arquivo de chave p√∫blica ‚Üí ‚ÄúSalvar chave p√∫blica‚Äù.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exportamos a chave secreta para o formato OpenSSH: menu PuTTYgen ‚Üí ‚ÄúConvers√µes‚Äù ‚Üí ‚ÄúExportar chave OpenSSH‚Äù.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usamos arquivos OpenSSH no SecureCRT. </font><font style="vertical-align: inherit;">O arquivo com a chave p√∫blica possui a extens√£o .pub, o arquivo com a chave privada n√£o possui extens√£o.</font></font></li>
</ol><br>
<a name="ConvertVanDykePrivateKeyToPPK"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertendo uma chave RSA do formato VanDyke Private Key (SecureCRT) para Putty Private Key (PuTTY)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para usar chaves RSA no PuTTY que s√£o geradas no SecureCRT e salvas no formato de chave privada VanDyke (arquivo de chave p√∫blica * .pub, arquivo de chave secreta *. (Sem extens√£o)), exporte-as usando o SecureCRT no formato OpenSSH e, em seguida, usando PuTTYgen, exportamos para o formato Putty Private Key (* .ppk):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inicie o SecureCRT.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menu ‚ÄúFerramentas‚Äù ‚Üí ‚ÄúConverter chave privada para o formato OpenSSH ...‚Äù</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selecione o arquivo de origem com as chaves da VanDyke Private Key.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salvamos as chaves do OpenSSH com um novo nome.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inicie o PuTTYgen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregamos a chave RSA existente no formato OpenSSH (*.): Menu PuTTYgen ‚Üí ‚ÄúConvers√µes‚Äù ‚Üí ‚ÄúImport key‚Äù.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salve o arquivo no formato Putty: ‚ÄúSalvar chave privada‚Äù.</font></font></li>
</ol><br>
<a name="CreatePublicKeyMacOSX"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerando chaves p√∫blicas no MAC OS X usando o sistema operacional</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usaremos o utilit√°rio ssh-keygen embutido (man ssh-keygen). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geramos uma chave RSA com um comprimento de 2048 bits com o nome da chave, o caminho para a pasta com o local de armazenamento da chave:</font></font><br>
<br>
<pre><code class="plaintext hljs">ssh-keygen -b 2048 -t rsa -c "Lab router R4" -f /Users/ArtemiySP/Documents/python/r4</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No tempo de execu√ß√£o, o programa solicitar√° uma senha para proteger a chave RSA:</font></font><br>
<br>
<pre><code class="plaintext hljs">artemiy-2:Downloads ArtemiySP$ ssh-keygen -b 2048 -t rsa -C "Lab router R4" -f /Users/ArtemiySP/Documents/python/r4<font></font>
Generating public/private rsa key pair.<font></font>
Enter passphrase (empty for no passphrase): <font></font>
Enter same passphrase again: <font></font>
Your identification has been saved in /Users/ArtemiySP/Documents/python/r4.<font></font>
Your public key has been saved in /Users/ArtemiySP/Documents/python/r4.pub.<font></font>
The key fingerprint is:<font></font>
SHA256:WdT47SFvgGI7danxX94p8/cO3uyU12SB3ipkc7nHxzA Lab router R4<font></font>
The key's randomart image is:<font></font>
+---[RSA 2048]----+<font></font>
|          .o     |<font></font>
|         .. . .  |<font></font>
|          .o + . |<font></font>
|        oo+ B = .|<font></font>
|       .S+ O OEoo|<font></font>
|        o + + B*+|<font></font>
|         . . =.*O|<font></font>
|            .+o**|<font></font>
|              =+O|<font></font>
+----[SHA256]-----+<font></font>
artemiy-2:Downloads ArtemiySP$<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geramos uma chave RSA com um comprimento de 4096 bits para indicar o nome da chave, o caminho para a pasta com o local de armazenamento da chave, definimos a senha explicitamente nos par√¢metros de gera√ß√£o de chave (-N "cisco"):</font></font><br>
<br>
<pre><code class="plaintext hljs">artemiy-2:Downloads ArtemiySP$ ssh-keygen -b 4096 -t rsa -C "Lab router R5" -N "cisco" -f /Users/ArtemiySP/Documents/python/r5<font></font>
Generating public/private rsa key pair.<font></font>
Your identification has been saved in /Users/ArtemiySP/Documents/python/r5.<font></font>
Your public key has been saved in /Users/ArtemiySP/Documents/python/r5.pub.<font></font>
The key fingerprint is:<font></font>
SHA256:NraLRMqB4qmA8qNjKdpBBt1JBw8Osf/3GfuB2k1R+zY Lab router R5<font></font>
The key's randomart image is:<font></font>
+---[RSA 4096]----+<font></font>
|  o.+..          |<font></font>
| . * =           |<font></font>
|. o + .       .  |<font></font>
| . o         . . |<font></font>
|. + o . S   . .  |<font></font>
|o+.. = o o . . . |<font></font>
|+oo o o o o o  Eo|<font></font>
|*=.. . o = * . ..|<font></font>
|Boo.  . o =.o    |<font></font>
+----[SHA256]-----+<font></font>
artemiy-2:Downloads ArtemiySP$<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par√¢metros de gera√ß√£o de chave que n√£o s√£o recomendados: uma chave n√£o confi√°vel com um comprimento de 1024 bits, indicando o nome da chave, o caminho para a pasta com o local de armazenamento da chave, definimos a senha explicitamente nos par√¢metros de gera√ß√£o de chave (-N "" - sem senha):</font></font><br>
<br>
<pre><code class="plaintext hljs">artemiy-2:Downloads ArtemiySP$ ssh-keygen -b 1024 -t rsa -C "Lab router R6" -N "" -f /Users/ArtemiySP/Documents/python/r6<font></font>
Generating public/private rsa key pair.<font></font>
Your identification has been saved in /Users/ArtemiySP/Documents/python/r6.<font></font>
Your public key has been saved in /Users/ArtemiySP/Documents/python/r6.pub.<font></font>
The key fingerprint is:<font></font>
SHA256:LEcfgN+58TYMDv4MpBA2FGCWc2aFiY+SxWBf7pRViWs Lab router R6<font></font>
The key's randomart image is:<font></font>
+---[RSA 1024]----+<font></font>
|.++=o*.o+..      |<font></font>
|.oB % +. o       |<font></font>
| o X * .o...     |<font></font>
|o . =  E+.=.     |<font></font>
| .   oo+So.*     |<font></font>
|      .oo o =    |<font></font>
|         + . .   |<font></font>
|          o      |<font></font>
|                 |<font></font>
+----[SHA256]-----+<font></font>
artemiy-2:Downloads ArtemiySP$<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, criamos tr√™s chaves com os nomes das chaves e a localiza√ß√£o das chaves (por padr√£o, todas as chaves s√£o armazenadas em / Users / [Username 028 / .ssh). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, ao conectar via SSH com autentica√ß√£o por chave p√∫blica, todas as chaves p√∫blicas s√£o armazenadas em sequ√™ncia, armazenadas na pasta /Users/[Username‚Ä†/.ssh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chave R6: renomeie a chave para ‚Äúid_rsa‚Äù (por padr√£o, o nome do arquivo de chave gerado √© ‚Äúid_rsa‚Äù) e transfira-o para a pasta com as chaves SSH (~ / .ssh /) (ou seja, executaremos todas as etapas para que a chave R6 seja usada como principal) chave de conex√£o SSH padr√£o): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Converta a chave p√∫blica OpenSSH para o formato RFC4716 (exporte para o Cisco IOS):</font></font><br>
<br>
<pre><code class="plaintext hljs">https://serverfault.com/questions/706336/how-to-get-a-pem-file-from-ssh-key-pair<font></font>
ssh-keygen -f ~/Documents/python/r4.pub -e -m RFC4716<font></font>
ssh-keygen -f ~/Documents/python/r5.pub -e -m RFC4716<font></font>
ssh-keygen -f ~/.ssh/id_rsa.pub -e -m RFC4716<font></font>
</code></pre><br>
<a name="ConfigureKeyAtHardware"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando uma chave p√∫blica no equipamento</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como em v√°rios equipamentos para vincular uma chave p√∫blica a um usu√°rio? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O processo de vincular uma chave p√∫blica a um usu√°rio n√£o √© padr√£o e varia de equipamento para equipamento; portanto, s√£o dados exemplos para cada tipo de equipamento mais frequentemente usado na rede.</font></font><br>
<br>
<a name="ConfigureKeyAtHardwareCiscoIOS"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco IOS XE, Catalyst (da vers√£o 15.1 e superior), IOS </font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J√° existe um usu√°rio no dispositivo.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nas configura√ß√µes de SSH (ip ssh pubkey-chain) do usu√°rio (nome de usu√°rio cisco), especifique a chave p√∫blica (string de chave):</font></font><br>
<pre><code class="plaintext hljs">CSR-1#conf t<font></font>
Enter configuration commands, one per line.  End with CNTL/Z.<font></font>
CSR-1(config)#ip ssh pubkey-chain <font></font>
CSR-1(conf-ssh-pubkey)#username ssh-putty<font></font>
CSR-1(conf-ssh-pubkey-user)#key-string <font></font>
CSR-1(conf-ssh-pubkey-data)#$QAAAQEAnPbynT1+2rjlyqP4viSPdTVDFLSHzWjJnAwy     <font></font>
CSR-1(conf-ssh-pubkey-data)#$NCfaqvMTPruCgG5096q8lO0ntURmNgmfMEQPOgb8weF     <font></font>
CSR-1(conf-ssh-pubkey-data)#$AtMQYk7WFM+5iBnOQ32UAHNavCUA7YFEpAdOQO4W/qB     <font></font>
CSR-1(conf-ssh-pubkey-data)#$SlOLy+PQ47jDUINBnuUeHd8ZXyzXxWglzSvqtwMEXBW     <font></font>
CSR-1(conf-ssh-pubkey-data)#$VoUTBYbJ45DmFa93P50qf494ujaAsTbYyJ/GBzJUTK/     <font></font>
CSR-1(conf-ssh-pubkey-data)#$UADAkNGxQARfOfHZWiIYb3rif6h6hfwwVUZS/Tw==       <font></font>
CSR-1(conf-ssh-pubkey-data)#exit<font></font>
CSR-1(conf-ssh-pubkey-user)#exit<font></font>
CSR-1(conf-ssh-pubkey)#exit<font></font>
CSR-1(config)#exit<font></font>
CSR-1#exit<font></font>
<font></font>
CSR-1#show running-config | inc ssh<font></font>
username ssh-public-key secret 5 $1$ebjc$EYgwMFQXPPiywFVn6rl7t.<font></font>
username ssh-putty privilege 15 secret 5 $1$vIhh$nM8iCeBKmLyVK4hA6./h4.<font></font>
ip ssh pubkey-chain<font></font>
   key-hash ssh-rsa D4E9AD62F7F6265EAAB3FB8778477612<font></font>
  username ssh-public-key<font></font>
   key-hash ssh-rsa C331DEE821A84681A4A7B1862C100D16<font></font>
  username ssh-putty<font></font>
   key-hash ssh-rsa F32BEB60290EA75D151447C0D42D2A99<font></font>
   key-hash ssh-rsa 5432C275B363B646E02D3BA7E8D865B7<font></font>
CSR-1#<font></font>
</code></pre></li>
</ol><br>
<a name="ConfigureKeyAtHardwareCiscoASA"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco ASA</font></font></h3><br>
<pre><code class="plaintext hljs">LAB-ASA5516-X-01/pri/act# conf t<font></font>
LAB-ASA5516-X-01/pri/act(config)# username artemiy password artemiy privilege $<font></font>
LAB-ASA5516-X-01/pri/act(config)# username artemiy attributes <font></font>
LAB-ASA5516-X-01/pri/act(config-username)# ssh authentication publickey ?<font></font>
<font></font>
username mode commands/options:<font></font>
  WORD  Raw SSH-RSA public key<font></font>
LAB-ASA5516-X-01/pri/act(config-username)# ssh authentication publickey AAAAB3$<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s inserimos a chave inteira em uma linha (formato OpenSSH).</font></font><br>
<br>
<a name="ConfigureKeyAtHardwareHuaweiRouter"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roteadores e switches Huawei</font></font></h3><br>
<pre><code class="plaintext hljs">[R1]rsa peer-public-key test-key1 encoding-type pem <font></font>
Enter "RSA public key" view, return system view with "peer-public-key end".<font></font>
NOTE: The number of the bits of public key must be between 769 and 2048.<font></font>
[R1-rsa-public-key]public-key-code begin <font></font>
Enter "RSA key code" view, return last view with "public-key-code end".<font></font>
[R1-rsa-key-code]---- BEGIN SSH2 PUBLIC KEY ----<font></font>
[R1-rsa-key-code]Subject: Subject<font></font>
[R1-rsa-key-code]Comment: " Subject@Subject.local"<font></font>
[R1-rsa-key-code]ModBitSize: 2048<font></font>
[R1-rsa-key-code]AAAAB3NzaC1yc2EAAAADAQABAAABAQC4YLFhPqfsz4a6PUpZOtvm6zGn5TWOVMnx<font></font>
[R1-rsa-key-code]lTH5hr/u+aYnoM2XnDTu4Ul1iB8MMPLVKXzV4LgYhaFcU1rz2/yYhTKIwbiQTHof<font></font>
[R1-rsa-key-code]63fJjyWwkvyBuVZTSKh4b2pfoF2mXgdJzzRmUaiRrZZUVJWsX+CbgtKQuktG7sTK<font></font>
[R1-rsa-key-code]2eguHwdfhilbOAsUaL0/q39Y0aTAMnLMtn0m5r6MD/UopQPI3Fxm1L9azJ7zYIZa<font></font>
[R1-rsa-key-code]yI43Solg0AOupPl8FHFI9Cxq81/uZRACx5lAyuObaQ4/t1Rdh3CAJj1qwfZjZFTP<font></font>
[R1-rsa-key-code]VdJxwTDxwfkpOzMD193M0ThOSrgfWe336Q9F3jbSWrEYUQDX8ew7<font></font>
[R1-rsa-key-code]---- END SSH2 PUBLIC KEY ----<font></font>
[R1-rsa-key-code]public-key-code end<font></font>
[R1-rsa-public-key]peer-public-key end <font></font>
[R1]display rsa peer-public-key <font></font>
<font></font>
=====================================<font></font>
    Key name: test-key1<font></font>
=====================================<font></font>
Key Code:<font></font>
---- BEGIN SSH2 PUBLIC KEY ----<font></font>
AAAAB3NzaC1yc2EAAAADAQABAAABAQC4YLFhPqfsz4a6PUpZOtvm6zGn5TWOVMnx<font></font>
lTH5hr/u+aYnoM2XnDTu4Ul1iB8MMPLVKXzV4LgYhaFcU1rz2/yYhTKIwbiQTHof<font></font>
63fJjyWwkvyBuVZTSKh4b2pfoF2mXgdJzzRmUaiRrZZUVJWsX+CbgtKQuktG7sTK<font></font>
2eguHwdfhilbOAsUaL0/q39Y0aTAMnLMtn0m5r6MD/UopQPI3Fxm1L9azJ7zYIZa<font></font>
yI43Solg0AOupPl8FHFI9Cxq81/uZRACx5lAyuObaQ4/t1Rdh3CAJj1qwfZjZFTP<font></font>
VdJxwTDxwfkpOzMD193M0ThOSrgfWe336Q9F3jbSWrEYUQDX8ew7<font></font>
---- END SSH2 PUBLIC KEY ----<font></font>
aaa<font></font>
local-user jet privilege level 15<font></font>
 local-user jet service-type telnet terminal ssh http<font></font>
ssh user jet assign rsa-key test-key1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tipos de formatos de chave importados para a Huawei: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúO SecureCRT e PuTTY geram chaves RSA no formato PEM.‚Äù</font></font><br>
<br>
<pre><code class="plaintext hljs">rsa peer-public-key test-key1 encoding-type pem</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"O OpenSSH gera chaves RSA no formato OpenSSH."</font></font><br>
<br>
<pre><code class="plaintext hljs">rsa peer-public-key test-key1 encoding-type openssh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"O OpenSSL gera chaves RSA no formato DER."</font></font><br>
<br>
<pre><code class="plaintext hljs">rsa peer-public-key test-key1 encoding-type der</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O padr√£o √© hexadecimal:</font></font><br>
<br>
<pre><code class="plaintext hljs">rsa peer-public-key test-key1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota: O equipamento Huawei n√£o apenas suporta chaves no formato RSA, mas tamb√©m outros formatos:</font></font><br>
<br>
<pre><code class="plaintext hljs">ssh user user-name assign { rsa-key | dsa-key | ecc-key } key-name</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode definir rigidamente o tipo de autentica√ß√£o para o usu√°rio via SSH:</font></font><br>
<br>
<pre><code class="plaintext hljs">[R1]ssh user jet authentication-type ?<font></font>
  all           All authentication, password,RSA or ECC<font></font>
  ecc           ECC authentication<font></font>
  password      Password authentication<font></font>
  password-ecc  Both password and ECC<font></font>
  password-rsa  Both password and RSA<font></font>
  rsa           RSA authentication<font></font>
[R1]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou seja, permitimos o acesso usando uma senha, chaves p√∫blicas e privadas ou ambas.</font></font><br>
<br>
<a name="ConfigureKeyAtHardwareHuaweiUSG"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Huawei USG (6000)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A configura√ß√£o √© completamente semelhante √†s configura√ß√µes do roteador, mas possui alguns recursos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, o n√≠vel de privil√©gio ap√≥s o log usando certificados √© 0 e n√£o pode ser elevado. </font><font style="vertical-align: inherit;">Portanto, o n√≠vel de prioridade √© definido usando</font></font><br>
<br>
<pre><code class="plaintext hljs">user-interface vty 0 4 <font></font>
user privilege level 15<font></font>
user-interface vty 16 20:<font></font>
user privilege level 15<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemplo:</font></font><br>
<br>
<pre><code class="plaintext hljs">[USG-a]rsa peer-public-key test-key1 encoding-type pem <font></font>
Enter "RSA public key" view, return system view with "peer-public-key end".<font></font>
[USG-a-rsa-public-key]public-key-code begin<font></font>
Enter "RSA key code" view, return last view with "public-key-code end".<font></font>
[USG-a-rsa-key-code]---- BEGIN SSH2 PUBLIC KEY ----<font></font>
[USG-a-rsa-key-code]Subject: subject<font></font>
[USG-a-rsa-key-code]Comment: " subject@subject.local"<font></font>
[USG-a-rsa-key-code]ModBitSize: 2048<font></font>
[USG-a-rsa-key-code]AAAAB3NzaC1yc2EAAAADAQABAAABAQC4YLFhPqfsz4a6PUpZOtvm6zGn5TWOVMnx<font></font>
[USG-a-rsa-key-code]lTH5hr/u+aYnoM2XnDTu4Ul1iB8MMPLVKXzV4LgYhaFcU1rz2/yYhTKIwbiQTHof<font></font>
[USG-a-rsa-key-code]63fJjyWwkvyBuVZTSKh4b2pfoF2mXgdJzzRmUaiRrZZUVJWsX+CbgtKQuktG7sTK<font></font>
[USG-a-rsa-key-code]2eguHwdfhilbOAsUaL0/q39Y0aTAMnLMtn0m5r6MD/UopQPI3Fxm1L9azJ7zYIZa<font></font>
[USG-a-rsa-key-code]yI43Solg0AOupPl8FHFI9Cxq81/uZRACx5lAyuObaQ4/t1Rdh3CAJj1qwfZjZFTP<font></font>
[USG-a-rsa-key-code]VdJxwTDxwfkpOzMD193M0ThOSrgfWe336Q9F3jbSWrEYUQDX8ew7<font></font>
[USG-a-rsa-key-code]---- END SSH2 PUBLIC KEY ----<font></font>
[USG-a-rsa-key-code]public-key-code end<font></font>
[USG-a-rsa-public-key]peer-public-key end<font></font>
[USG-a]<font></font>
[USG-a]ssh user admin assign rsa-key test-key1<font></font>
! Out-of-band management interface:<font></font>
[USG-a-GigabitEthernet0/0/0]service-manage ssh permit<font></font>
! Grant user level 15 privillege:<font></font>
[USG-a]user-interface vty 0 4<font></font>
[USG-a-ui-vty0-4]user privilege level 15<font></font>
</code></pre><br>
<a name="ConfigureKeyAtHardwareCiscoNexus"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Nexus 9.3</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Op√ß√£o 1: pr√©-instale o arquivo de chave p√∫blica no dispositivo e anexe o arquivo de chave p√∫blica ao usu√°rio.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copie o arquivo de chave p√∫blica para o dispositivo.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instru√≠mos o usu√°rio a usar o arquivo de chave p√∫blica.</font></font></li>
</ul><br>
<pre><code class="plaintext hljs">switch# copy tftp://10.10.1.1/secsh_file.pub bootflash:secsh_file.pub<font></font>
username User1 sshkey file bootflash:secsh_file.pub<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Op√ß√£o 2: copie a chave p√∫blica para o usu√°rio:</font></font><br>
<br>
<pre><code class="plaintext hljs">username User1 sshkey<font></font>
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC4YLFhPqfsz4a6PUpZOtvm6zGn5TWOVMnxlTH5hr/u+aYnoM2XnDTu4Ul1iB8MMPLVKXzV4LgYhaFcU1rz2/yYhTKIwbiQTHof63fJjyWwkvyBuVZTSKh4b2pfoF2mXgdJzzRmUaiRrZZUVJWsX+CbgtKQuktG7sTK2eguHwdfhilbOAsUaL0/q39Y0aTAMnLMtn0m5r6MD/UopQPI3Fxm1L9azJ7zYIZayI43Solg0AOupPl8FHFI9Cxq81/uZRACx5lAyuObaQ4/t1Rdh3CAJj1qwfZjZFTPVdJxwTDxwfkpOzMD193M0ThOSrgfWe336Q9F3jbSWrEYUQDX8ew7<font></font>
</code></pre><br>
<a name="ConfigureSoftwareToUsePublicKey"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando uma chave secreta para conex√£o SSH</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta se√ß√£o √© dedicada √† configura√ß√£o de clientes SSH para autentica√ß√£o usando chaves RSA em equipamentos de rede (ou outro equipamento, desde que o hardware e o software ofere√ßam suporte √† autentica√ß√£o de chave p√∫blica). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consideraremos configurar o uso da chave p√∫blica nos programas mais populares: SecureCRT e PuTTY.</font></font><br>
<br>
<a name="ConfigureSoftwareToUsePublicKeySecureCRT"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SecureCRT</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° uma lista de autentica√ß√£o na janela de configura√ß√µes do SSH. </font><font style="vertical-align: inherit;">Nele, voc√™ precisa aumentar a prioridade do PublicKey para o mais alto - torn√°-lo o primeiro na lista.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ke/z4/l-kez4rg6qpuyslsuv3nmt_dti4.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xi/jh/ah/xijhahjlx-hq9m52ugqyih0qrwi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, v√° para as op√ß√µes PublicKey e selecione o arquivo de chave privada. </font><font style="vertical-align: inherit;">A op√ß√£o superior permite que voc√™ use as configura√ß√µes globais da chave secreta ou das configura√ß√µes da sess√£o - outra chave secreta (chave n√£o padr√£o) - apenas para esta conex√£o.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ub/js/xd/ubjsxdlmflzod5cfguosfwuqiqi.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/og/pv/ys/ogpvysr3cvrk7aliad5qxeg3jp0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure a chave p√∫blica global: no menu Op√ß√µes ‚Üí Op√ß√µes globais ‚Üí Categoria SSH2.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0m/yd/dg/0myddgh9flvk10qrh8pixuphke8.png"></div><br>
<a name="ConfigureSoftwareToUsePublicKeyPutty"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PuTTY</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas configura√ß√µes de SSH (Conex√£o ‚Üí SSH ‚Üí Autentica√ß√£o) no campo "Arquivo de chave privada para autentica√ß√£o", especifique o arquivo Putty Private Key (* .ppk):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xm/wu/tp/xmwutpoyrfibggfiqssajegtyq0.png"></div><br>
<a name="ConfigureSoftwareToUsePublicKeyMacOSX"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAC OS X</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurando um cliente padr√£o para usar chaves p√∫blicas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conex√£o com uma chave n√£o padr√£o especificada manualmente:</font></font><br>
<br>
<pre><code class="plaintext hljs">artemiy-2:~ ArtemiySP$ ssh r4@10.31.73.29 -i ~/Documents/python/r4<font></font>
The authenticity of host '10.31.73.29 (10.31.73.29)' can't be established.<font></font>
RSA key fingerprint is SHA256:fxOLFKU6YGyIqisrIh2P0O52Rr6Wx/wsSAcHsTz8fo0.<font></font>
Are you sure you want to continue connecting (yes/no)? yes<font></font>
Warning: Permanently added '10.31.73.29' (RSA) to the list of known hosts.<font></font>
CSR-4#<font></font>
</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conex√£o com uma chave n√£o padr√£o especificada manualmente:</font></font><br>
<br>
<pre><code class="plaintext hljs">artemiy-2:~ ArtemiySP$ ssh r5@10.31.73.30 -i ~/Documents/python/r5<font></font>
The authenticity of host '10.31.73.30 (10.31.73.30)' can't be established.<font></font>
RSA key fingerprint is SHA256:4l67C4Il4pTaqYT4vrtWr0aY7rPmNWKsjRv2zlYtQIU.<font></font>
Are you sure you want to continue connecting (yes/no)? yes<font></font>
Warning: Permanently added '10.31.73.30' (RSA) to the list of known hosts.<font></font>
MGTU#exit<font></font>
Connection to 10.31.73.30 closed.<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo de erro</font></font></b><div class="spoiler_text">        ‚Äî      .     MAC OS X ‚Äî     .<br>
</div></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conex√£o com a chave padr√£o (chave padr√£o - o pr√≥prio sistema encontrar√° e usar√° a chave p√∫blica padr√£o):</font></font><br>
<br>
<pre><code class="plaintext hljs">artemiy-2:~ ArtemiySP$ ssh r6@10.31.73.31<font></font>
The authenticity of host '10.31.73.31 (10.31.73.31)' can't be established.<font></font>
RSA key fingerprint is SHA256:2/ysACJQw48Q8S45ody4wna+6nJspcsEU558HiUN43Q.<font></font>
Are you sure you want to continue connecting (yes/no)? yes<font></font>
Warning: Permanently added '10.31.73.31' (RSA) to the list of known hosts.<font></font>
PR#exit<font></font>
Connection to 10.31.73.31 closed.<font></font>
artemiy-2:~ ArtemiySP$ <font></font>
</code></pre></li>
</ul><br>
<a name="MacOSXUseSSH"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como simplificar o trabalho com SSH no MAC OS X:</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crie aliases SSH.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nos aliases de SSH, definimos os usu√°rios imediatamente.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Registre imediatamente a localiza√ß√£o das chaves.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O local dos Aliases e a configura√ß√£o SSH pr√©-configurada s√£o especificados no arquivo ~ / .ssh / config (/Users/[Username‚Ä†/.ssh/config). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Preenchido desta maneira:</font></font><br>
<br>
<pre><code class="plaintext hljs">host r4<font></font>
   Hostname 10.31.73.29<font></font>
   Port 22<font></font>
   User r4<font></font>
   IdentityFile ~/Documents/python/r4<font></font>
<font></font>
host r5<font></font>
   Hostname 10.31.73.30<font></font>
   Port 22<font></font>
   User r5<font></font>
   IdentityFile ~/Documents/python/r5<font></font>
<font></font>
host r6<font></font>
   Hostname 10.31.73.31<font></font>
   Port 22<font></font>
   User r6<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota: minha conex√£o padr√£o est√° configurada incorretamente (n√£o sei como), porque a conex√£o com o host R6 (10.31.73.31) leva muito tempo. </font><font style="vertical-align: inherit;">√â recomend√°vel especificar imediatamente o caminho para a chave padr√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um exemplo de uma conex√£o ssh usando chaves p√∫blicas e um arquivo de configura√ß√£o:</font></font><br>
<br>
<pre><code class="plaintext hljs">artemiy-2:Documents ArtemiySP$ ssh r5<font></font>
MGTU#exit<font></font>
Connection to 10.31.73.30 closed by remote host.<font></font>
Connection to 10.31.73.30 closed.<font></font>
artemiy-2:Documents ArtemiySP$ ssh r4<font></font>
CSR-4#exit<font></font>
Connection to 10.31.73.29 closed by remote host.<font></font>
Connection to 10.31.73.29 closed.<font></font>
artemiy-2:Documents ArtemiySP$ ssh r6<font></font>
PR#exit<font></font>
Connection to 10.31.73.31 closed.<font></font>
artemiy-2:Documents ArtemiySP$ ssh r6<font></font>
PR#<font></font>
</code></pre><br>
<a name="finale"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As chaves RSA podem ser usadas para substituir a autentica√ß√£o de senha, mas n√£o em todos os casos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A autentica√ß√£o de chave p√∫blica n√£o √© poss√≠vel se a autentica√ß√£o de dom√≠nio estiver configurada (porque as solicita√ß√µes LDAP (kerberos) para o servidor est√£o em proxy para autentica√ß√£o).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A autentica√ß√£o de chave p√∫blica em equipamentos de rede antigos n√£o √© poss√≠vel (exemplo: falha ao configurar no Cisco Catalyst 2960 com firmware 12.2).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaves p√∫blicas protegidas por senha s√£o convenientemente usadas em equipamentos de bancada. Desvantagem: √© necess√°rio enviar um monte de chaves p√∫blicas e privadas para colegas e parceiros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em alguns equipamentos, v√°rios pares de chaves p√∫blicas podem corresponder a um usu√°rio; em outros equipamentos, apenas uma chave p√∫blica corresponde a um usu√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m existem diferentes formatos nos quais um par de chaves p√∫blicas e privadas √© armazenado. Mas este guia o ajudar√° a exportar chaves em diferentes formatos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hoje, √© ideal usar chaves com um comprimento de 2048 bits, mas para alguns equipamentos esse √© o tamanho m√°ximo poss√≠vel (talvez isso seja corrigido no novo firmware). Por exemplo:</font></font><br>
<br>
<pre><code class="plaintext hljs">[R1]rsa peer-public-key test-key2 encoding-type pem<font></font>
Enter "RSA public key" view, return system view with "peer-public-key end".<font></font>
NOTE: The number of the bits of public key must be between 769 and 2048.<font></font>
[R1-rsa-public-key]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â recomend√°vel usar chaves p√∫blicas para substituir senhas se as senhas forem inseridas usando scripts (exemplo: logon autom√°tico no SecureCRT). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â recomend√°vel usar chaves p√∫blicas para proteger contra a transmiss√£o de senha pela rede. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alguns softwares usam chaves p√∫blicas por padr√£o para autentica√ß√£o SSH em vez de uma senha (exemplo: Ansible).</font></font><br>
<br>
<a name="ListOfSources"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lista de fontes:</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia RSA</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convers√£o Putty para SecureCRT com autentica√ß√£o. </font><font style="vertical-align: inherit;">chaves, F√≥rum SecureCRT</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guia de configura√ß√£o do Secure Shell, Cisco IOS Release 15E</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baixar PuTTYgen</font></font></a></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documenta√ß√£o oficial da</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Huawei </font><font style="vertical-align: inherit;">- uma descri√ß√£o dos v√°rios formatos principais de importa√ß√£o para um roteador Huawei</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Huawei USG 6000, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurando a autentica√ß√£o de chave p√∫blica</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (CLI: exemplo para efetuar login na CLI usando STelnet (autentica√ß√£o RSA))</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nexus 9000 Configuration guide SSH public key</a></li>
<li>man ssh-keygen ‚Äî      mac os x.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SSH config file  MAC OS X</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">       SSH</a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">       SSH config</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  openssh public key   RFC4716</a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt490714/index.html">Como obter 100 mil por c√≥digo. Guia Completo para Iniciantes</a></li>
<li><a href="../pt490716/index.html">Como garantir a opera√ß√£o de alta qualidade da rede local de uma pequena empresa?</a></li>
<li><a href="../pt490718/index.html">O que √© o "c√≥digo limpo" em 2020?</a></li>
<li><a href="../pt490720/index.html">Motor! ou O que √© f√≠sica de jogo</a></li>
<li><a href="../pt490722/index.html">F√©rias de g√™nero em TI. Como observar</a></li>
<li><a href="../pt490728/index.html">Semana 10 de seguran√ßa: Confer√™ncia RSA e conscientiza√ß√£o sobre seguran√ßa cibern√©tica</a></li>
<li><a href="../pt490730/index.html">Raiz de confian√ßa Intel x86: perda de confian√ßa</a></li>
<li><a href="../pt490732/index.html">Reconhecimento de Fala: Um Curso Introdut√≥rio Muito Curto</a></li>
<li><a href="../pt490734/index.html">Ovos de P√°scoa nos mapas topogr√°ficos da Su√≠√ßa</a></li>
<li><a href="../pt490736/index.html">9 ferramentas claras para aprender e aprimorar o vocabul√°rio em ingl√™s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>