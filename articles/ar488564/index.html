<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐จ๐ผโโ๏ธ ๐ฉ ุดุจูุชู ุงูุนุตุจูุฉ ุงูุฃููู ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU). ุฏููู ุงููุจุชุฏุฆูู ๐ ๐คฏ ๐ง๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ูุฐู ุงูููุงูุฉ ุ ุณุฃุฎุจุฑู ุจููููุฉ ุฅุนุฏุงุฏ ุจูุฆุฉ ุชุนููู ุงูุขูุฉ ูู 30 ุฏูููุฉ ุ ูุฅูุดุงุก ุดุจูุฉ ุนุตุจูุฉ ููุชุนุฑู ุนูู ุงูุตูุฑ ุ ุซู ุชุดุบูู ููุณ ุงูุดุจูุฉ ุนูู ูุนุงูุฌ ุฑุณููุงุช (GPU). 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุดุจูุชู ุงูุนุตุจูุฉ ุงูุฃููู ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU). ุฏููู ุงููุจุชุฏุฆูู</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488564/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/sv/g2/wgsvg24lytktztdczee_4rteb28.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูููุงูุฉ ุ ุณุฃุฎุจุฑู ุจููููุฉ ุฅุนุฏุงุฏ ุจูุฆุฉ ุชุนููู ุงูุขูุฉ ูู 30 ุฏูููุฉ ุ ูุฅูุดุงุก ุดุจูุฉ ุนุตุจูุฉ ููุชุนุฑู ุนูู ุงูุตูุฑ ุ ุซู ุชุดุบูู ููุณ ุงูุดุจูุฉ ุนูู ูุนุงูุฌ ุฑุณููุงุช (GPU). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ุฏุนูุง ูุญุฏุฏ ูุง ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุญุงูุชูุง ุ ูุฐุง ูููุฐุฌ ุฑูุงุถู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชุทุจููู ููุจุฑูุฌูุงุช ุฃู ุงูุฃุฌูุฒุฉ ุ ูุจูู ุนูู ูุจุฏุฃ ุชูุธูู ูุนูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุจููููุฌูุฉ - ุดุจูุงุช ุงูุฎูุงูุง ุงูุนุตุจูุฉ ูููุงุฆู ุงูุญู. ูุดุฃ ูุฐุง ุงูููููู ูู ุฏุฑุงุณุฉ ุงูุนูููุงุช ุงูุชู ุชุญุฏุซ ูู ุงูุฏูุงุบ ุ ููู ูุญุงููุฉ ููุญุงูุงุฉ ูุฐู ุงูุนูููุงุช.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุดุจูุงุช ุงูุนุตุจูุฉ ููุณุช ูุจุฑูุฌุฉ ุจุงููุนูู ุงููุนุชุงุฏ ูููููุฉ ุ ููู ูุฏุฑุจุฉ. </font><font style="vertical-align: inherit;">ุงููุฏุฑุฉ ุนูู ุงูุชุนูู ูู ูุงุญุฏุฉ ูู ุงููุฒุงูุง ุงูุฑุฆูุณูุฉ ููุดุจูุงุช ุงูุนุตุจูุฉ ุนูู ุงูุฎูุงุฑุฒููุงุช ุงูุชูููุฏูุฉ. </font><font style="vertical-align: inherit;">ูู ุงููุงุญูุฉ ุงููููุฉ ุ ูุชููู ุงูุชุฏุฑูุจ ูู ุฅูุฌุงุฏ ูุนุงููุงุช ุงูุฑูุงุจุท ุจูู ุงูุฎูุงูุง ุงูุนุตุจูุฉ. </font><font style="vertical-align: inherit;">ูู ุนูููุฉ ุงูุชุนูู ุ ุชููู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุงุฏุฑุฉ ุนูู ุชุญุฏูุฏ ุงูุนูุงูุงุช ุงููุนูุฏุฉ ุจูู ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ุ ููุฐูู ุฅุฌุฑุงุก ุงูุชุนููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฌูุฉ ูุธุฑ ุงูุชุนูู ุงูุขูู ุ ุชุนุฏ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุญุงูุฉ ุฎุงุตุฉ ูุทุฑู ุงูุชุนุฑู ุนูู ุงูุฃููุงุท ุ ูุงูุชุญููู ุงูุชูููุฒู ุ ูุทุฑู ุงูุชุฌููุน ุ ูุทุฑู ุฃุฎุฑู.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุฏุงุช</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ุฏุนูุง ูุชุนุงูู ูุน ุงููุนุฏุงุช. ูุญู ุจุญุงุฌุฉ ุฅูู ุฎุงุฏู ูุซุจุช ุนููู ูุธุงู ุงูุชุดุบูู Linux. ุชุชุทูุจ ูุนุฏุงุช ุชุดุบูู ุฃูุธูุฉ ุชุนูููู ุงูุขูุฉ ููุฉ ูุงููุฉ ุจูุง ููู ุงูููุงูุฉ ุ ูุจุงูุชุงูู ุจุงูุธุฉ ุงูุซูู. ุจุงููุณุจุฉ ูุฃููุฆู ุงูุฐูู ููุณ ูุฏููู ุณูุงุฑุฉ ุฌูุฏุฉ ูู ูุชูุงูู ุงููุฏ ุ ุฃูุตู ุจุงูุงูุชูุงู ุจุนุฑุถ ููุฏูู ุงูุฎุฏูุงุช ุงูุณุญุงุจูุฉ. ูููู ุงุณุชุฆุฌุงุฑ ุงูุฎุงุฏู ุงูุถุฑูุฑู ุจุณุฑุนุฉ ูุฏูุน ููุงุจู ููุช ุงูุงุณุชุฎุฏุงู ููุท.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุดุงุฑูุน ุญูุซ ูููู ูู ุงูุถุฑูุฑู ุฅูุดุงุก ุดุจูุงุช ุนุตุจูุฉ ุ ุฃุณุชุฎุฏู ุฎูุงุฏู ุฃุญุฏ ูุฒูุฏู ุงูุณุญุงุจุฉ ุงูุฑูุณูุฉ. </font><font style="vertical-align: inherit;">ุชูุฏู ุงูุดุฑูุฉ ุฎูุงุฏู ุณุญุงุจูุฉ ูุณุชุฃุฌุฑุฉ ุฎุตูุตูุง ููุชุนูู ุงูุขูู ูุน ูุญุฏุงุช ูุนุงูุฌุฉ ุฑุณููุงุช Tesla V100 ุงููููุฉ (GPUs) ูู NVIDIA. </font><font style="vertical-align: inherit;">ุจุงุฎุชุตุงุฑ: ูููู ุฃู ูููู ุงุณุชุฎุฏุงู ุฎุงุฏู ูุน ูุญุฏุฉ ูุนุงูุฌุฉ ุฑุณููุงุช ุฃูุซุฑ ููุงุกุฉ (ุจุณุฑุนุฉ) ุนุดุฑุงุช ุงููุฑุงุช ููุงุฑูุฉ ุจุฎุงุฏู ูุดุงุจู ูู ุงูุชูููุฉ ุญูุซ ูุชู ุงุณุชุฎุฏุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ููุญุณุงุจุงุช (ูุนุงูุฌ ูุฑูุฒู ูุนุฑูู). </font><font style="vertical-align: inherit;">ูุชู ุชุญููู ุฐูู ุจุณุจุจ ุชูุงุตูู ููุฏุณุฉ GPU ุ ุงูุชู ุชุชุนุงูู ูุน ุงูุญุณุงุจุงุช ุจุดูู ุฃุณุฑุน. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชูููุฐ ุงูุฃูุซูุฉ ุงูููุถุญุฉ ุฃุฏูุงู ุ ูููุง ุจุดุฑุงุก ุงูุฎุงุฏู ุงูุชุงูู ูุนุฏุฉ ุฃูุงู:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">150 ุฌูุฌุงุจุงูุช SSD</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุงู 32 ุฌูุฌุง</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุงูุฌ Tesla V100 16 Gb ูุน 4 ููู</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ุชุซุจูุช Ubuntu 18.04 ุนูู ุงูุฌูุงุฒ.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุถุจุท ุงูุจูุฆุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุชุซุจูุช ุนูู ุงูุฎุงุฏู ูู ูุง ุชุญุชุงุฌู ููุนูู. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ููุงููุง ูุจุฏุฆููุง ูููุจุชุฏุฆูู ุ ุณุฃุชุญุฏุซ ููู ุนู ุจุนุถ ุงูููุงุท ุงูุชู ุณุชููู ูููุฏุฉ ููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุชูููุฐ ุงููุซูุฑ ูู ุงูุนูู ุนูุฏ ุฅุนุฏุงุฏ ุงูุจูุฆุฉ ูู ุฎูุงู ุณุทุฑ ุงูุฃูุงูุฑ. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ูุนุธู ุงููุณุชุฎุฏููู Windows ููุธุงู ุชุดุบูู. </font><font style="vertical-align: inherit;">ูุญุฏุฉ ุงูุชุญูู ุงูููุงุณูุฉ ูู ูุธุงู ุงูุชุดุบูู ูุฐุง ุชุชุฑู ุงููุซูุฑ ููุง ูู ูุฑุบูุจ ููู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุณูู ูุณุชุฎุฏู ุฃุฏุงุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmder /</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฃุฏุงุฉ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ุงูููุงุณุจุฉ</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูู ุจุชูุฒูู ุงูุฅุตุฏุงุฑ ุงููุตุบุฑ ูุชุดุบูู Cmder.exe. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู ุนุจุฑ SSH:</font></font><br>
<br>
<pre><code class="bash hljs">ssh root@server-ip-or-hostname</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏูุงู ูู server-ip-or-hostname ุ ุญุฏุฏ ุนููุงู IP ุฃู ุงุณู DNS ูุฎุงุฏูู. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ูุนูุฏ ุงูุงุชุตุงู ุงููุงุฌุญ ุ ูุฌุจ ุฃู ูุญุตู ุนูู ุดูุก ูุซู ูุฐุง.</font></font><br>
<br>
<pre><code class="bash hljs">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-74-generic x86_64)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุบุฉ ุงูุฑุฆูุณูุฉ ูุชุทููุฑ ููุงุฐุฌ ML ูู Python. </font><font style="vertical-align: inherit;">ูุงูููุตุฉ ุงูุฃูุซุฑ ุดููุนูุง ูุงุณุชุฎุฏุงูู ุนูู Linux ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anaconda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุซุจูุชู ุนูู ุงูุฎุงุฏู ุงูุฎุงุต ุจูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏุฃ ุจุชุญุฏูุซ ูุฏูุฑ ุงูุญุฒู ุงููุญูู:</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุซุจูุช curl (ุฃุฏุงุฉ ุณุทุฑ ุงูุฃูุงูุฑ):</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get install curl</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุชูุฒูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู Anaconda Distribution:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /tmp<font></font>
curl โO https://repo.anaconda.com/archive/Anaconda3-2019.10-Linux-x86_64.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏุฃ ุงูุชุซุจูุช:</font></font><br>
<br>
<pre><code class="bash hljs">bash Anaconda3-2019.10-Linux-x86_64.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุซูุงุก ุนูููุฉ ุงูุชุซุจูุช ุ ุณุชุญุชุงุฌ ุฅูู ุชุฃููุฏ ุงุชูุงููุฉ ุงูุชุฑุฎูุต. </font><font style="vertical-align: inherit;">ุนูุฏ ุงูุชุซุจูุช ุจูุฌุงุญ ุ ูุฌุจ ุฃู ุชุฑู ูุฐุง:</font></font><br>
<br>
<pre><code class="bash hljs">Thank you <span class="hljs-keyword">for</span> installing Anaconda3!</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุทููุฑ ููุงุฐุฌ ML ุ ูุชู ุฅูุดุงุก ุงูุนุฏูุฏ ูู ุงูุฃุทุฑ ุงูุขู ุ ููุญู ูุนูู ูุน ุงูุฃูุซุฑ ุดููุนูุง: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyTorch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensorflow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุณูุญ ูู ุงุณุชุฎุฏุงู ุงูุฅุทุงุฑ ุจุฒูุงุฏุฉ ุณุฑุนุฉ ุงูุชุทููุฑ ูุงุณุชุฎุฏุงู ุงูุฃุฏูุงุช ุงูุฌุงูุฒุฉ ููููุงู ุงูููุงุณูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐุง ุงููุซุงู ุ ุณูุนูู ูุน PyTorch. </font><font style="vertical-align: inherit;">ุชุซุจูุชู:</font></font><br>
<br>
<pre><code class="bash hljs">conda install pytorch torchvision cudatoolkit=10.1 -c pytorch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูุญู ุจุญุงุฌุฉ ุฅูู ุฅุทูุงู Jupyter Notebook - ุฃุฏุงุฉ ุชุทููุฑ ุดุนุจูุฉ ุจูู ูุชุฎุตุตู ML. </font><font style="vertical-align: inherit;">ูุณูุญ ูู ุจูุชุงุจุฉ ุงูููุฏ ูุฑุคูุฉ ูุชุงุฆุฌ ุชูููุฐู ุนูู ุงูููุฑ. </font><font style="vertical-align: inherit;">Jupyter Notebook ูู ุฌุฒุก ูู Anaconda ููู ูุซุจุช ุจุงููุนู ุนูู ุฎุงุฏููุง. </font><font style="vertical-align: inherit;">ุชุญุชุงุฌ ุฅูู ุงูุงุชุตุงู ุจู ูู ูุธุงู ุณุทุญ ุงูููุชุจ ูุฏููุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุงู ุจุฐูู ุ ูููุง ุฃููุงู ุจุชุดุบูู Jupyter ุนูู ุงูุฎุงุฏู ุนู ุทุฑูู ุชุญุฏูุฏ ุงููููุฐ 8080:</font></font><br>
<br>
<pre><code class="bash hljs">jupyter notebook --no-browser --port=8080 --allow-root</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ูุชุญ ุนูุงูุฉ ุชุจููุจ ุฃุฎุฑู ูู ูุญุฏุฉ ุชุญูู Cmder (ุงููุงุฆูุฉ ุงูุนูููุฉ ูู ูุฑุจุน ุญูุงุฑ ูุญุฏุฉ ุงูุชุญูู ุงูุฌุฏูุฏุฉ) ุ ูุงูุงุชุตุงู ุนูู ุงููููุฐ 8080 ุจุงูุฎุงุฏู ุนุจุฑ SSH:</font></font><br>
<br>
<pre><code class="plaintext hljs">ssh -L 8080:localhost:8080 root@server-ip-or-hostname</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูุฏ ุฅุฏุฎุงู ุงูุฃูุฑ ุงูุฃูู ุ ุณููุนุฑุถ ุนูููุง ุฑูุงุจุท ููุชุญ Jupyter ูู ูุชุตูุญูุง:</font></font><br>
<br>
<pre><code class="bash hljs">To access the notebook, open this file <span class="hljs-keyword">in</span> a browser:<font></font>
        file:///root/.<span class="hljs-built_in">local</span>/share/jupyter/runtime/nbserver-18788-open.html<font></font>
    Or copy and paste one of these URLs:<font></font>
        http://localhost:8080/?token=cca0bd0b30857821194b9018a5394a4ed2322236f116d311<font></font>
     or http://127.0.0.1:8080/?token=cca0bd0b30857821194b9018a5394a4ed2322236f116d311<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุณุชุฎุฏู ุงูุฑุงุจุท ูููุถูู ุงููุญูู: 8080. </font><font style="vertical-align: inherit;">ุงูุณุฎ ุงููุณุงุฑ ุงููุงูู ูุงูุตูู ูู ุดุฑูุท ุงูุนููุงู ูู ุงููุชุตูุญ ุงููุญูู ูุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู. </font><font style="vertical-align: inherit;">ููุชุญ ุฏูุชุฑ ููุงุญุธุงุช ุฌูุจูุชุฑ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุฅูุดุงุก ููุจููุชุฑ ูุญููู ุฌุฏูุฏ: ุฌุฏูุฏ - Notebook - Python 3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญูู ูู ุงูุชุดุบูู ุงูุตุญูุญ ูุฌููุน ุงูููููุงุช ุงูุชู ูููุง ุจุชุซุจูุชูุง. </font><font style="vertical-align: inherit;">ููุฏู ูุซุงู ููุฏ PyTorch ูู Jupyter ููุจุฏุฃ ุงูุชูููุฐ (ุฒุฑ ุงูุชุดุบูู):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function
<span class="hljs-keyword">import</span> torch<font></font>
x = torch.rand(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)<font></font>
print(x)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ุฃู ุชููู ุงููุชูุฌุฉ ุดูุฆูุง ูุซู ูุฐุง: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ps/o8/su/pso8sugii4txi_beqrbx13nsry8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ูุงู ูุฏูู ูุชูุฌุฉ ููุงุซูุฉ ุ ููููุง ูููุง ุจุฅุนุฏุงุฏูุง ุจุดูู ุตุญูุญ ููููููุง ุงูุจุฏุก ูู ุชุทููุฑ ุดุจูุฉ ุนุตุจูุฉ!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุดุจูุฉ ุนุตุจูุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณููุดุฆ ุดุจูุฉ ุนุตุจูุฉ ููุชุนุฑู ุนูู ุงูุตูุฑ. </font><font style="vertical-align: inherit;">ูุญู ูุฃุฎุฐ ูุฐุง </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฏููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฃุณุงุณ </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุฏุฑูุจ ุงูุดุจูุฉ ุ ุณูุณุชุฎุฏู ูุฌููุนุฉ ุจูุงูุงุช CIFAR10 ุงููุชุงุญุฉ ููุฌูููุฑ. </font><font style="vertical-align: inherit;">ูุฏูู ูุฆุงุช: "ุทุงุฆุฑุฉ" ุ "ุณูุงุฑุฉ" ุ "ุทุงุฆุฑ" ุ "ูุทุฉ" ุ "ุฃูู" ุ "ููุจ" ุ "ุถูุฏุน" ุ "ุญุตุงู" ุ "ุณูููุฉ" ุ "ุดุงุญูุฉ". </font><font style="vertical-align: inherit;">ูุจูุบ ุญุฌู ุงูุตูุฑ ูู CIFAR10 3 ร 32 ร 32 ุ ุฃู ุตูุฑ ููููุฉ ุจุซูุงุซ ูููุงุช ุจุญุฌู 32 ร 32 ุจูุณู.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/sv/g2/wgsvg24lytktztdczee_4rteb28.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุนูู ุ ุณูุณุชุฎุฏู ุญุฒูุฉ PyTorch ุงูุชู ุชู ุฅูุดุงุคูุง ููุนูู ูุน ุงูุตูุฑ - torchvision. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุชุฎุฐ ุงูุฎุทูุงุช ุงูุชุงููุฉ ุจุงูุชุฑุชูุจ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฒูู ูุชุทุจูุน ูุฌููุนุงุช ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนุฑูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฏุฑูุจ ุงูุดุจูุฉ ุนูู ุจูุงูุงุช ุงูุชุฏุฑูุจ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฎุชุจุงุฑ ุงูุดุจูุฉ ุจุจูุงูุงุช ุงูุงุฎุชุจุงุฑ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุฑ ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ GPU</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูููู ุจุชูููุฐ ุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฃุฏูุงู ูู Jupyter Notebook.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฒูู ูุชุทุจูุน CIFAR10</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุณุฎ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ูููุฐูุง ูู Jupyter:</font></font><br>
<br>
<pre><code class="python hljs">
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torchvision
<span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms<font></font>
<font></font>
transform = transforms.Compose(<font></font>
    [transforms.ToTensor(),<font></font>
     transforms.Normalize((<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>))])<font></font>
<font></font>
trainset = torchvision.datasets.CIFAR10(root=<span class="hljs-string">'./data'</span>, train=<span class="hljs-literal">True</span>,<font></font>
                                        download=<span class="hljs-literal">True</span>, transform=transform)<font></font>
trainloader = torch.utils.data.DataLoader(trainset, batch_size=<span class="hljs-number">4</span>,<font></font>
                                          shuffle=<span class="hljs-literal">True</span>, num_workers=<span class="hljs-number">2</span>)<font></font>
<font></font>
testset = torchvision.datasets.CIFAR10(root=<span class="hljs-string">'./data'</span>, train=<span class="hljs-literal">False</span>,<font></font>
                                       download=<span class="hljs-literal">True</span>, transform=transform)<font></font>
testloader = torch.utils.data.DataLoader(testset, batch_size=<span class="hljs-number">4</span>,<font></font>
                                         shuffle=<span class="hljs-literal">False</span>, num_workers=<span class="hljs-number">2</span>)<font></font>
<font></font>
classes = (<span class="hljs-string">'plane'</span>, <span class="hljs-string">'car'</span>, <span class="hljs-string">'bird'</span>, <span class="hljs-string">'cat'</span>,
           <span class="hljs-string">'deer'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'frog'</span>, <span class="hljs-string">'horse'</span>, <span class="hljs-string">'ship'</span>, <span class="hljs-string">'truck'</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ุฃู ูููู ุงูุฌูุงุจ ุนูู ูุฐุง ุงููุญู:</font></font><br>
<br>
<pre><code class="python hljs">Downloading https://www.cs.toronto.edu/~kriz/cifar<span class="hljs-number">-10</span>-python.tar.gz to ./data/cifar<span class="hljs-number">-10</span>-python.tar.gz<font></font>
Extracting ./data/cifar<span class="hljs-number">-10</span>-python.tar.gz to ./data<font></font>
Files already downloaded <span class="hljs-keyword">and</span> verified</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุณุชุฎุฑุฌ ุงูุนุฏูุฏ ูู ุงูุตูุฑ ุงูุชุฏุฑูุจูุฉ ููุชุญูู:</font></font><br>
<br>
<pre><code class="python hljs">
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<font></font>
<font></font>
<span class="hljs-comment"># functions to show an image</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">imshow</span>(<span class="hljs-params">img</span>):</span>
    img = img / <span class="hljs-number">2</span> + <span class="hljs-number">0.5</span>     <span class="hljs-comment"># unnormalize</span><font></font>
    npimg = img.numpy()<font></font>
    plt.imshow(np.transpose(npimg, (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>)))<font></font>
    plt.show()<font></font>
<font></font>
<span class="hljs-comment"># get some random training images</span><font></font>
dataiter = iter(trainloader)<font></font>
images, labels = dataiter.next()<font></font>
<font></font>
<span class="hljs-comment"># show images</span><font></font>
imshow(torchvision.utils.make_grid(images))<font></font>
<span class="hljs-comment"># print labels</span>
print(<span class="hljs-string">' '</span>.join(<span class="hljs-string">'%5s'</span> % classes[labels[j]] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">4</span>)))
</code></pre><br>
<img src="https://habrastorage.org/webt/yy/w4/xw/yyw4xwjhaa6kfy41fvnylvz6qdy.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนุฑูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ููุญุต ุฃููุงู ููู ุชุนูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ููุชุนุฑู ุนูู ุงูุตูุฑ. </font><font style="vertical-align: inherit;">ูุฐู ุดุจูุฉ ุงุชุตุงู ูุจุงุดุฑุฉ ุจุณูุทุฉ. </font><font style="vertical-align: inherit;">ูุฃุฎุฐ ุงููุฏุฎูุงุช ุ ูููุฑุฑูุง ูู ุฎูุงู ุนุฏุฉ ุทุจูุงุช ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุ ุซู ูุนุทู ุงููุงุชุฌ ูู ุงูููุงูุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t8/4m/yg/t84mygi1sjuzssoezguistupmeo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุฅูุดุงุก ุดุจูุฉ ููุงุซูุฉ ูู ุจูุฆุชูุง:</font></font><br>
<br>
<pre><code class="python hljs">
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Net</span>(<span class="hljs-params">nn.Module</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><font></font>
        super(Net, self).__init__()<font></font>
        self.conv1 = nn.Conv2d(<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>)<font></font>
        self.pool = nn.MaxPool2d(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<font></font>
        self.conv2 = nn.Conv2d(<span class="hljs-number">6</span>, <span class="hljs-number">16</span>, <span class="hljs-number">5</span>)<font></font>
        self.fc1 = nn.Linear(<span class="hljs-number">16</span> * <span class="hljs-number">5</span> * <span class="hljs-number">5</span>, <span class="hljs-number">120</span>)<font></font>
        self.fc2 = nn.Linear(<span class="hljs-number">120</span>, <span class="hljs-number">84</span>)<font></font>
        self.fc3 = nn.Linear(<span class="hljs-number">84</span>, <span class="hljs-number">10</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span>(<span class="hljs-params">self, x</span>):</span><font></font>
        x = self.pool(F.relu(self.conv1(x)))<font></font>
        x = self.pool(F.relu(self.conv2(x)))<font></font>
        x = x.view(<span class="hljs-number">-1</span>, <span class="hljs-number">16</span> * <span class="hljs-number">5</span> * <span class="hljs-number">5</span>)<font></font>
        x = F.relu(self.fc1(x))<font></font>
        x = F.relu(self.fc2(x))<font></font>
        x = self.fc3(x)<font></font>
        <span class="hljs-keyword">return</span> x<font></font>
<font></font>
net = Net()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุฏุฏ ุฃูุถูุง ูุธููุฉ ุงูุฎุณุงุฑุฉ ูุงููุญุณู </font></font><br>
<br>
<pre><code class="python hljs">
<span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim<font></font>
<font></font>
criterion = nn.CrossEntropyLoss()<font></font>
optimizer = optim.SGD(net.parameters(), lr=<span class="hljs-number">0.001</span>, momentum=<span class="hljs-number">0.9</span>)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฏุฑูุจ ุงูุดุจูุฉ ุนูู ุจูุงูุงุช ุงูุชุฏุฑูุจ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏุฃ ุชุฏุฑูุจ ุดุจูุชูุง ุงูุนุตุจูุฉ. </font><font style="vertical-align: inherit;">ุฃูุฌู ุงูุชุจุงูู ุฅูู ุญูููุฉ ุฃูู ุจุนุฏ ุฐูู ุ ุฃุซูุงุก ุชุดุบูู ูุฐุง ุงูุฑูุฒ ุ ุณุชุญุชุงุฌ ุฅูู ุงูุงูุชุธุงุฑ ุจุนุถ ุงูููุช ุญุชู ุงูุชูุงู ุงูุนูู. </font><font style="vertical-align: inherit;">ุงุณุชุบุฑู ููู 5 ุฏูุงุฆู. </font><font style="vertical-align: inherit;">ูุณุชุบุฑู ุงูุชูุงุตู ููุชูุง.</font></font><br>
<br>
<pre><code class="python hljs"> <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> range(<span class="hljs-number">2</span>):  <span class="hljs-comment"># loop over the dataset multiple times</span><font></font>
<font></font>
    running_loss = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> i, data <span class="hljs-keyword">in</span> enumerate(trainloader, <span class="hljs-number">0</span>):
        <span class="hljs-comment"># get the inputs; data is a list of [inputs, labels]</span><font></font>
        inputs, labels = data<font></font>
<font></font>
        <span class="hljs-comment"># zero the parameter gradients</span><font></font>
        optimizer.zero_grad()<font></font>
<font></font>
        <span class="hljs-comment"># forward + backward + optimize</span><font></font>
        outputs = net(inputs)<font></font>
        loss = criterion(outputs, labels)<font></font>
        loss.backward()<font></font>
        optimizer.step()<font></font>
<font></font>
        <span class="hljs-comment"># print statistics</span><font></font>
        running_loss += loss.item()<font></font>
        <span class="hljs-keyword">if</span> i % <span class="hljs-number">2000</span> == <span class="hljs-number">1999</span>:    <span class="hljs-comment"># print every 2000 mini-batches</span>
            print(<span class="hljs-string">'[%d, %5d] loss: %.3f'</span> %<font></font>
                  (epoch + <span class="hljs-number">1</span>, i + <span class="hljs-number">1</span>, running_loss / <span class="hljs-number">2000</span>))<font></font>
            running_loss = <span class="hljs-number">0.0</span><font></font>
<font></font>
print(<span class="hljs-string">'Finished Training'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุตู ุนูู ุงููุชูุฌุฉ ุงูุชุงููุฉ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sw/05/k2/sw05k2ewk-gu9fiyrv3xncxjaki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญูุธ ูููุฐุฌูุง ุงููุฏุฑุจ:</font></font><br>
<br>
<pre><code class="python hljs">PATH = <span class="hljs-string">'./cifar_net.pth'</span>
torch.save(net.state_dict(), PATH)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฎุชุจุงุฑ ุงูุดุจูุฉ ุจุจูุงูุงุช ุงูุงุฎุชุจุงุฑ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุง ุจุชุฏุฑูุจ ุงูุดุจูุฉ ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ. </font><font style="vertical-align: inherit;">ููููุง ุจุญุงุฌุฉ ุฅูู ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุดุจูุฉ ูุฏ ุชุนููุช ุฃู ุดูุก ุนูู ุงูุฅุทูุงู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูู ูุชุญูู ูู ุฐูู ูู ุฎูุงู ุชููุน ุชุณููุฉ ุงููุฆุฉ ุงูุชู ุชูุชุฌูุง ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุ ูุงูุชุญูู ูู ุงูุญูููุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ุงูุชููุนุงุช ุตุญูุญุฉ ุ ูุฅููุง ูุถูู ุงูุนููุฉ ุฅูู ูุงุฆูุฉ ุงูุชููุนุงุช ุงูุตุญูุญุฉ. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุธูุฑ ุงูุตูุฑุฉ ูู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ:</font></font><br>
<br>
<pre><code class="python hljs">dataiter = iter(testloader)<font></font>
images, labels = dataiter.next()<font></font>
<font></font>
<span class="hljs-comment"># print images</span><font></font>
imshow(torchvision.utils.make_grid(images))<font></font>
print(<span class="hljs-string">'GroundTruth: '</span>, <span class="hljs-string">' '</span>.join(<span class="hljs-string">'%5s'</span> % classes[labels[j]] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">4</span>)))</code></pre><br>
<img src="https://habrastorage.org/webt/hp/ph/zm/hpphzma6rus04gw-edxsowf1ifu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุทูุจ ุงูุขู ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุฃู ุชุฎุจุฑูุง ุจูุง ููุฌุฏ ูู ูุฐู ุงูุตูุฑ:</font></font><br>
<br>
<pre><code class="python hljs"><font></font>
net = Net()<font></font>
net.load_state_dict(torch.load(PATH))<font></font>
<font></font>
outputs = net(images)<font></font>
<font></font>
_, predicted = torch.max(outputs, <span class="hljs-number">1</span>)<font></font>
<font></font>
print(<span class="hljs-string">'Predicted: '</span>, <span class="hljs-string">' '</span>.join(<span class="hljs-string">'%5s'</span> % classes[predicted[j]]
                              <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">4</span>)))
</code></pre><br>
<img src="https://habrastorage.org/webt/j2/vp/uc/j2vpucdaps0fuci2yg38ip2fbdo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุจุฏู ุงููุชุงุฆุฌ ุฌูุฏุฉ ุฌุฏูุง: ุญุฏุฏุช ุงูุดุจูุฉ ุจุดูู ุตุญูุญ ุซูุงุซูุง ูู ุงูุตูุฑ ุงูุฃุฑุจุน. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ููู ุชุนูู ุงูุดุจูุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุฃููููุง.</font></font><br>
<br>
<pre><code class="python hljs">
correct = <span class="hljs-number">0</span>
total = <span class="hljs-number">0</span>
<span class="hljs-keyword">with</span> torch.no_grad():
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> testloader:<font></font>
        images, labels = data<font></font>
        outputs = net(images)<font></font>
        _, predicted = torch.max(outputs.data, <span class="hljs-number">1</span>)<font></font>
        total += labels.size(<span class="hljs-number">0</span>)<font></font>
        correct += (predicted == labels).sum().item()<font></font>
<font></font>
print(<span class="hljs-string">'Accuracy of the network on the 10000 test images: %d %%'</span> % (
    <span class="hljs-number">100</span> * correct / total))</code></pre><br>
<img src="https://habrastorage.org/webt/fy/i4/cn/fyi4cnkjgimshkhhbsva4udixhw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุฃู ุงูุดุจูุฉ ุชุนุฑู ูุชุนูู. </font><font style="vertical-align: inherit;">ุฅุฐุง ุญุฏุฏ ุงููุฆุงุช ุจุดูู ุนุดูุงุฆู ุ ูุฅู ุงูุฏูุฉ ุณุชููู 10ูช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฏุนูุง ูุฑู ุงููุฆุงุช ุงูุชู ุชุญุฏุฏูุง ุงูุดุจูุฉ ุจุดูู ุฃูุถู:</font></font><br>
<br>
<pre><code class="python hljs">class_correct = list(<span class="hljs-number">0.</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>))<font></font>
class_total = list(<span class="hljs-number">0.</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>))
<span class="hljs-keyword">with</span> torch.no_grad():
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> testloader:<font></font>
        images, labels = data<font></font>
        outputs = net(images)<font></font>
        _, predicted = torch.max(outputs, <span class="hljs-number">1</span>)<font></font>
        c = (predicted == labels).squeeze()<font></font>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">4</span>):<font></font>
            label = labels[i]<font></font>
            class_correct[label] += c[i].item()<font></font>
            class_total[label] += <span class="hljs-number">1</span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):<font></font>
    print(<span class="hljs-string">'Accuracy of %5s : %2d %%'</span> % (<font></font>
        classes[i], <span class="hljs-number">100</span> * class_correct[i] / class_total[i]))</code></pre><br>
<img src="https://habrastorage.org/webt/l9/s9/qu/l9s9quxd-lzx2kh7wphxe9-2qzs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุฃู ุงูุดุจูุฉ ุชุญุฏุฏ ุงูุณูุงุฑุงุช ูุงูุณูู ุจุดูู ุฃูุถู: ุฏูุฉ 71ูช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐูู ุชุนูู ุงูุดุจูุฉ. </font><font style="vertical-align: inherit;">ุงูุขู ุฏุนูุง ูุญุงูู ููู ุนููู ุฅูู ูุนุงูุฌ ุงูุฑุณูููุงุช (GPU) ููุนุฑูุฉ ุงูุชุบููุฑุงุช.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฏุฑูุจ ุงูุดุจูุฉ ุงูุนุตุจูุฉ GPU</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ุณุฃุดุฑุญ ุจุงุฎุชุตุงุฑ ูุง ูู CUDA. </font><font style="vertical-align: inherit;">CUDA (Compute Unified Device Architecture) ูู ููุตุฉ ุญูุณุจุฉ ูุชูุงุฒูุฉ ุทูุฑุชูุง NVIDIA ููุญูุณุจุฉ ุงูุนุงูุฉ ุนูู ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช. </font><font style="vertical-align: inherit;">ูุน CUDA ุ ูููู ูููุทูุฑูู ุชุณุฑูุน ุชุทุจููุงุช ุงูุญูุณุจุฉ ุจุดูู ูุจูุฑ ุจุงุณุชุฎุฏุงู ุฅููุงูุงุช ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช. </font><font style="vertical-align: inherit;">ุชู ุชุซุจูุช ูุฐุง ุงููุธุงู ุงูุฃุณุงุณู ุจุงููุนู ุนูู ุฎุงุฏููุง ุงูุฐู ุงุดุชุฑููุงู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ุฃููุงู ูุนุฑูู GPU ูุฃูู ุฌูุงุฒ ุธุงูุฑ.</font></font><br>
<br>
<pre><code class="python hljs">device = torch . device ( <span class="hljs-string">"cuda:0"</span> <span class="hljs-keyword">if</span> torch . cuda . is_available () <span class="hljs-keyword">else</span> <span class="hljs-string">"cpu"</span> )
<span class="hljs-comment"># Assuming that we are on a CUDA machine, this should print a CUDA device:</span>
<span class="hljs-keyword">print</span> ( device )</code></pre><br>
<img src="https://habrastorage.org/webt/n2/2k/bf/n22kbfvilr6kn30eel6dfhaose4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุฑุณู ุงูุดุจูุฉ ุฅูู GPU:</font></font><br>
 <br>
<pre><code class="python hljs">net.to(device)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุชุนูู ุนูููุง ุฃูุถูุง ุฅุฑุณุงู ุงููุฏุฎูุงุช ูุงูุฃูุฏุงู ูู ูู ุฎุทูุฉ ูุฅูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช:</font></font><br>
<br>
<pre><code class="python hljs">inputs, labels = data[<span class="hljs-number">0</span>].to(device), data[<span class="hljs-number">1</span>].to(device)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุชุดุบูู ุฅุนุงุฏุฉ ุชุฏุฑูุจ ุงูุดุจูุฉ ุจุงููุนู ุนูู GPU: </font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim<font></font>
<font></font>
criterion = nn.CrossEntropyLoss()<font></font>
optimizer = optim.SGD(net.parameters(), lr=<span class="hljs-number">0.001</span>, momentum=<span class="hljs-number">0.9</span>)
<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> range(<span class="hljs-number">2</span>):  <span class="hljs-comment"># loop over the dataset multiple times</span><font></font>
<font></font>
    running_loss = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> i, data <span class="hljs-keyword">in</span> enumerate(trainloader, <span class="hljs-number">0</span>):
        <span class="hljs-comment"># get the inputs; data is a list of [inputs, labels]</span>
    inputs, labels = data[<span class="hljs-number">0</span>].to(device), data[<span class="hljs-number">1</span>].to(device)<font></font>
<font></font>
        <span class="hljs-comment"># zero the parameter gradients</span><font></font>
        optimizer.zero_grad()<font></font>
<font></font>
        <span class="hljs-comment"># forward + backward + optimize</span><font></font>
        outputs = net(inputs)<font></font>
        loss = criterion(outputs, labels)<font></font>
        loss.backward()<font></font>
        optimizer.step()<font></font>
<font></font>
        <span class="hljs-comment"># print statistics</span><font></font>
        running_loss += loss.item()<font></font>
        <span class="hljs-keyword">if</span> i % <span class="hljs-number">2000</span> == <span class="hljs-number">1999</span>:    <span class="hljs-comment"># print every 2000 mini-batches</span>
            print(<span class="hljs-string">'[%d, %5d] loss: %.3f'</span> %<font></font>
                  (epoch + <span class="hljs-number">1</span>, i + <span class="hljs-number">1</span>, running_loss / <span class="hljs-number">2000</span>))<font></font>
            running_loss = <span class="hljs-number">0.0</span><font></font>
<font></font>
print(<span class="hljs-string">'Finished Training'</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐู ุงููุฑุฉ ุ ุงุณุชูุฑ ุงูุชุฏุฑูุจ ุนูู ุงูุดุจูุฉ ุญูุงูู 3 ุฏูุงุฆู. </font><font style="vertical-align: inherit;">ุชุฐูุฑ ุฃู ููุณ ุงููุฑุญูุฉ ุนูู ุงููุนุงูุฌ ุงูุนุงุฏู ุงุณุชูุฑุช 5 ุฏูุงุฆู. </font><font style="vertical-align: inherit;">ุงููุฑู ููุณ ูุจูุฑุง ุ ูุฐูู ูุฃู ุดุจูุชูุง ููุณุช ูุจูุฑุฉ. </font><font style="vertical-align: inherit;">ุนูุฏ ุงุณุชุฎุฏุงู ุตูุงุฆู ูุจูุฑุฉ ููุชุฏุฑูุจ ุ ุณูุฒุฏุงุฏ ุงููุฑู ุจูู ุณุฑุนุฉ GPU ูุงููุนุงูุฌ ุงูุชูููุฏู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุฃู ูุฐุง ูู ุดูุก. </font><font style="vertical-align: inherit;">ูุง ุชูููุง ูู ุงูููุงู ุจู:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ูุญุตูุง ูุง ูู GPU ูุงุฎุชุฑูุง ุงูุฎุงุฏู ุงูุฐู ุชู ุชุซุจูุชู ุนููู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุดุฃูุง ุจูุฆุฉ ุจุฑูุฌูุฉ ูุฅูุดุงุก ุดุจูุฉ ุนุตุจูุฉ ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุดุฃูุง ุดุจูุฉ ุนุตุจูุฉ ููุชุนุฑู ุนูู ุงูุตูุฑุฉ ูุฏุฑุจูุงูุง ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุฑูุง ุชุฏุฑูุจ ุงูุดุจูุฉ ุจุงุณุชุฎุฏุงู GPU ูุญุตููุง ุนูู ุฒูุงุฏุฉ ูู ุงูุณุฑุนุฉ.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณุฃููู ุณุนูุฏุง ููุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ูู ุงูุชุนูููุงุช.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar488546/index.html">ูุงู ุฐุง ุจููุณ. ุชุฌูู JSON. ุงูุถุนู ูู Json.Net ู LPE ุนุจุฑ SeImpersonatePrivilege</a></li>
<li><a href="../ar488548/index.html">ุงูุชุฌุฑุจุฉ: ููููุฉ ุชุนูู ุฅูุดุงุก ูุตูุต ุดุงุฆุนุฉ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ (ูููุงุฐุง ููุฑุฃ ุงููุงุจุฑููู ุงููุงุทููู ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุงููููู ุฌุฏูุง)</a></li>
<li><a href="../ar488552/index.html">Apple FAS ููุทูุฑู ุงูุฑูุงุจุฉ ุงูุฃุจููุฉ</a></li>
<li><a href="../ar488558/index.html">ุถูุงู ุชููุฑ ุงูุชุทุจููุงุช ุจูุซุฑุฉ ูุน ุชูุงุฑ ูุงููุง</a></li>
<li><a href="../ar488560/index.html">ุงุณุชุถุงูุฉ ูุฌุงููุฉ ูุจุฑูุงูุฌ Telegram ุนูู Google Cloud Platform</a></li>
<li><a href="../ar488566/index.html">ููู ุฃููุฐ ูููุฏุณ ุถูุงู ุงูุฌูุฏุฉ ููููุง ูุงููุงู ูู ุฎูุงู ุฑุจุท ุงูุงุฎุชุจุงุฑุงุช ุงูุชููุงุฆูุฉ ูู Visual Studio ูุงุฎุชุจุงุฑ ุชูููุฉ ุงููุนูููุงุช</a></li>
<li><a href="../ar488568/index.html">ูู ุชุญูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุจุงููุงู ุงูููุฑุจุงุฆูุ</a></li>
<li><a href="../ar488570/index.html">ููู ุฃุฑุจูุช ุงูุฎุฏูุฉ ุงูุณุฑูุฉ ุงูุฃูุฑูููุฉ ูุนุจุฉ ุขุฑ ุจู ุฌู ุงูุณุงูุจุฑุจุงูู ูุน ูุชุงุจ ุฏุฑุงุณู ูููุชุณูููู</a></li>
<li><a href="../ar488572/index.html">ูุญููู ุงููุญุฏุฉ ุงูุขู ููุชูุญ ุงููุตุฏุฑ</a></li>
<li><a href="../ar488574/index.html">ููุชุจ ุงูุทูุงุจ ุณุงุฆู Uart ูู STM32F411</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>