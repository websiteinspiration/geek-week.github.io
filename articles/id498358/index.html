<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔇 🧖🏽 😺 Pelajari bahasa Prancis atau cara mendapatkan adaptor universal dari pemindai diagnostik PSA 🙆🏾 👨‍💻 👨🏿‍🎤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Untuk mencegah penurunan IQ selama isolasi diri, ada keinginan untuk melakukan sesuatu yang berguna untuk diri mereka sendiri, dan jika Anda beruntung...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pelajari bahasa Prancis atau cara mendapatkan adaptor universal dari pemindai diagnostik PSA</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498358/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mencegah penurunan IQ selama isolasi diri, ada keinginan untuk melakukan sesuatu yang berguna untuk diri mereka sendiri, dan jika Anda beruntung - tidak hanya. </font><font style="vertical-align: inherit;">Memotong lingkaran ke-3 di sekitar apartemen, mata saya tertuju pada pemindai mobil, yang saya ambil dari seorang teman untuk studi lebih lanjut, yaitu Lexia 3, alias Actia XS Evolution. </font><font style="vertical-align: inherit;">Ini satu: </font></font><br>
<img src="https://habrastorage.org/webt/8k/pd/yu/8kpdyuolcbvw8jvbs03qqbkqtys.jpeg" alt="gambar"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kelemahannya adalah hanya perangkat lunak DiagBox yang dirancang untuk mendiagnosis mobil Peugeout / Citroen yang dapat bekerja dengannya. </font><font style="vertical-align: inherit;">Mustahil untuk bertahan dengan yang terakhir, oleh karena itu timbul gagasan bahwa jika pemindai ini dipaksa untuk mengirim dan menerima pesan sewenang-wenang ke bus CAN kendaraan, dengan demikian mengubahnya menjadi adaptor universal.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, rencana tindakan:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kumpulkan komunikasi USB antara PC dan pasien kami.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pahami bagaimana komunikasi terjadi antara driver adaptor dan perangkat lunak.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ulangi pertukaran dan merasa baik (spoiler: itu ternyata sedikit lebih rumit).</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Pertukaran</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kompleks perangkat lunak DiagBox secara bebas menjelajahi Internet, sehingga tidak ada kesulitan dengan langkah 1, terutama karena dilengkapi dengan utilitas kecil untuk mengidentifikasi adaptor, yang agak menyederhanakan tugas dari langkah 2. Versi percobaan program </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USBLyzer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> membantu menerima </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">pertukaran</font></a><font style="vertical-align: inherit;"> USB </font><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita akan sukses. </font><font style="vertical-align: inherit;">Dalam gambar, paket data yang dikirim, jenis perangkat di operator, dan utilitas yang sama. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/ev/n1/n_evn1nmme3s8mrog8zea5lj_fu.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Melihat IRP ketika membuka perangkat dan bertukar dengannya, kita dapat menyimpulkan bahwa pekerjaan dilakukan melalui mekanisme Windows I / O standar, yaitu, untuk membuka file virtual perangkat, fungsi CreateFile dan untuk pertukaran itu, DeviceIOControl.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hz/3r/gr/hz3rgrrv-hbc_h13gg9zluh4m0q.png" alt="gambar"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Pembekalan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data dikumpulkan, ID IOCTL dan bendera diterima, itu tetap berlaku untuk kecil, buka perangkat file dan mengirim paket byte di sana. </font><font style="vertical-align: inherit;">Buka saja? </font><font style="vertical-align: inherit;">Cari melalui WinObj tidak memberikan hasil apa pun, ketika terhubung, adaptor tidak memiliki nama yang tepat, hanya tautan implisit dengan ID yang terus berubah, yaitu, hanya membuka perangkat seperti port COM tidak akan berfungsi</font></font><br>
<br>
<pre><code class="cpp hljs">CreateFile(<span class="hljs-string">"\\\\.\\COM1"</span>, ...)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mempelajari file program membuatnya jelas, semuanya ternyata cukup sederhana - adaptor memiliki GUID uniknya sendiri, dengan bantuan yang diminta sistem operasi untuk daftar semua perangkat dengan GUID ini dan jika ada, kita akan mendapatkan tautan ke perangkat, yang </font></font><br>
<code>\\?\USB#VID_103A&amp;PID_F000#6&amp;268bff9b&amp;0&amp;7#{75a835f4-d77d-4402-8585-c42247f25b76}\vcommusb0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pembukaannya akan berhasil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi mengembalikan jalur sebagai ganti dari GUID:</font></font><br>
<br>
<pre><code class="cpp hljs">CM_Get_Device_Interface_List(InterfaceClassGuid, pDeviceID, Buffer, BufferLen, ulFlags);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"File" berhasil dibuka, jangan lupa tentang flag yang diperoleh melalui USBLyzer</font></font><br>
<br>
<pre><code class="cpp hljs">Device = CreateFile(DeviceName, GENERIC_WRITE | GENERIC_READ, FILE_SHARE_WRITE | FILE_SHARE_READ, <span class="hljs-literal">NULL</span>, OPEN_EXISTING, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Final</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengirim paket byte, dan sebagai tanggapan - diam ...</font></font><br>
<br>
<pre><code class="cpp hljs">bStatus = DeviceIoControl(Device, <span class="hljs-number">0x220003</span>, send_buf, send_len, out_buf, max_out_len, &amp;returned_len, <span class="hljs-literal">NULL</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk waktu yang lama saya duduk dan memandangi monitor, ini pertukaran yang sama, inilah tanggapan dari perangkat, ini adalah benderanya, persis sama dengan yang saya ulangi, tetapi tidak ada yang datang darinya. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qw/cy/kx/qwcykx8st4jbyqhrk28d4k5qxcs.jpeg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah akhirnya kehilangan semua harapan untuk sukses, saya memiliki satu hal terakhir - artileri berat dalam bentuk disk dari majalah Hacker dengan program OllyDbg. </font><font style="vertical-align: inherit;">Kita mulai, lampirkan ke proses, letakkan breakpoint pada fungsi DeviceIoControl dan apa yang kita lihat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/en/nq/cf/ennqcflp-6n8tmii2x1qutuntp8.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Raja itu tidak nyata. </font><font style="vertical-align: inherit;">Kode IOCTL yang sama sekali berbeda, datanya sama sekali tidak seperti yang terlihat melalui USBLyzer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa yang dikirim ke perangkat:</font></font><br>
<br>
<pre><code class="plaintext hljs">&lt;b&gt;00 FA&lt;/b&gt; &lt;i&gt;AA&lt;/i&gt; BA 7C 15 00 00 00 00 00 00</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan itu melewati USB:</font></font><br>
<br>
<pre><code class="plaintext hljs">40 05 15 C0 &lt;b&gt;00 FA&lt;/b&gt; 00 00 &lt;i&gt;AA&lt;/i&gt; 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 41</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Petunjuk itu ada di nama perangkat yang terlihat di task manager. Saya menemukan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di </font><font style="vertical-align: inherit;">situs web Microsoft </font><font style="vertical-align: inherit;">tentang apa itu driver USB UMDF. Hapus blok diagram: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/d2/wc/gd/d2wcgdfeky6nkjd3oe8x2eh7h8g.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata apa yang kita lihat di USBLyzer adalah lapisan transport transfer data klien, yang diimplementasikan dalam driver UMDF (arah 7 pada gambar), sementara kami mentransfer data ke perangkat (arah 2 pada gambar), yang pertama akan pergi ke pengemudi, dan kemudian pergi ke bus USB. Saya harap saya menjelaskan dengan jelas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang semuanya jelas dari mana ID dan data IOCTL lainnya berasal. Yah, itu bahkan lebih sederhana, Anda tidak perlu memeras otak Anda tentang cara mengimplementasikan transportasi, kami memiliki antarmuka permintaan-respons paling sederhana. Juga dalam file program deskripsi protokol pertukaran (sebagian) secara tidak sengaja kelebihan beban, sangat disayangkan hanya dalam bahasa Prancis.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p1/y4/5e/p1y45e74qzrcfbffatkfde5osxm.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menurutnya, dalam pesan di atas, versi firmware (00 FA) diminta, yang menerima respons dengan garis APPLI_XS_Fuji_ P106138A V4.3.0 @ACTIA 02.01.12. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SEMUA. </font><font style="vertical-align: inherit;">Kami mengonfigurasi CAN, mengirim alamat respons permintaan untuk komunikasi menggunakan protokol ISO-TP, dan mendapatkan adaptor yang berfungsi penuh dengan mobil. </font><font style="vertical-align: inherit;">Untuk kemudahan penggunaan, pembungkus ditulis bahwa, sejauh mungkin, memenuhi standar PassThru J2534, sehingga adaptor ini dapat digunakan dengan berbagai perangkat lunak otomotif, termasuk desainnya sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Video kerja (stdout adalah output ke konsol untuk kenyamanan debugging):</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/pG5GZoDYQoM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber dapat ditemukan di sini</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id498340/index.html">Tentang Beranda IDA baru (ulasan)</a></li>
<li><a href="../id498346/index.html">GoLand 2020.1 - Dukungan yang ditingkatkan untuk Modul Go, banyak penyelesaian otomatis, dan banyak lagi</a></li>
<li><a href="../id498350/index.html">Bahan terbaik untuk wawancara kerja dan pencarian kerja</a></li>
<li><a href="../id498352/index.html">SHISHUA: generator nomor acak semu tercepat di dunia</a></li>
<li><a href="../id498354/index.html">Cara menerjemahkan "Wishlist" menjadi "perangkat keras", atau semi-mobile semi-ideal semi-mobile</a></li>
<li><a href="../id498360/index.html">Evaluasi Metrik Muat Server Terpadu</a></li>
<li><a href="../id498362/index.html">Kingston mempertahankan kepemimpinan dalam pengiriman SSD: bagaimana kita melakukannya?</a></li>
<li><a href="../id498366/index.html">Algoritma apa yang diterapkan pengembang Yandex setiap hari</a></li>
<li><a href="../id498368/index.html">Kisah satu saklar</a></li>
<li><a href="../id498370/index.html">SAP UI5 dan Confirmation Windows: Lagi Tentang Konteks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>