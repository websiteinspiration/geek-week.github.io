<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∞üèæ üßëüèø‚Äçü§ù‚Äçüßëüèæ üßëüèø‚Äçü§ù‚ÄçüßëüèΩ Hidden Threat - Vulnerability Analysis Using News Graph üë¥üèΩ üçù üíà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When you are faced with a new vulnerability, what is the first thought? Of course, respond as quickly as possible. However, speed is just one of the c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Hidden Threat - Vulnerability Analysis Using News Graph</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494332/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When you are faced with a new vulnerability, what is the first thought? Of course, respond as quickly as possible. However, speed is just one of the conditions for an effective fight against information security threats. When it comes to corporate security, it is equally important to accurately determine what you should respond to first. An underestimated threat can cause serious loss or loss of goodwill. But if the number of vulnerabilities is constantly growing, how to quickly assess their significance and not to miss important details? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ox/fc/y7/oxfcy7piopfljg5ltpypkr4vswe.png"><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vulnerability dynamics by CVSS group (source - vulners.com)</font></font></b></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For ranking vulnerabilities by various criteria, the CVSS Score (Common Vulnerability Scoring System) scale is traditionally used, ranking vulnerabilities by various criteria, from exploitation complexity to the harm done and other parameters. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It would seem, why come up with something else - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">but the CVSS Score has one weak point - it is based on expert estimates that are not supported by real statistics.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It would be much more efficient to offer experts cases that were already selected according to certain quantitative criteria and make decisions based on verified data - but where to get this data and what to do next? </font><font style="vertical-align: inherit;">It sounds like an unusual and interesting task for a datacenter - and it was this challenge that inspired me and the Vulners team for a new concept for assessing and classifying vulnerabilities based on a graph of related information.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why graphs? </font><font style="vertical-align: inherit;">In the case of social networks and the media, graph methods have long and successfully been used for various purposes: from analyzing the distribution of content in the news stream, to notes on the influence of TOP authors on readers' opinions and social network clustering by interests. </font><font style="vertical-align: inherit;">Any vulnerability can be represented as a graph containing data - news about changes in software or hardware and the effects caused by them.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About data</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I did not have to manually collect news about each update, all the necessary texts were found in the vulners.com open vulnerability database. Visually, the data is as follows: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/yy/61/kiyy61iatkc5gizf-mgvjvhuemw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each vulnerability, in addition to its name, publication date and description, has a family (NVD, scanner, exploit, etc.) that has already been assigned to it (CVD rating (CVSS is used hereinafter) v2), as well as links to related news.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you present these connections schematically in the form of a graph, one vulnerability will look like this: the orange circle indicates the source or parent publication, the black circles indicate the news that you can click on while on the parent page, and the gray circles represent the related news, accessed by You can only go through all the publications indicated by black circles. Each color of the circles is a new level of the graph of related information, from zero - the original vulnerability, to the first, second, and so on.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yp/zy/ec/ypzyec3jcmj-mzjwbxeedgmliz4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, when viewing one news item, we know only the zero and the first level, therefore, to get all the data, we used the method of traversing the graph in depth, which allowed us to unravel the tangle of news from the beginning to the most recent connected nodes (hereinafter referred to as the graph node). At this stage, optimization problems got out - graph assembly for a long period took a long time and had to be conjured with both a script and a data structure. By the way, I decided to pack the final data into parquet for further work with them using spark sql, which greatly facilitated the initial analysis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What does graph data look like? Visualization will help us better understand their nature. Figure 4 shows a graph of the known but not very dangerous Heartbleed vulnerability (only 5 out of 10 points on the cvss scale).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/it/wn/vy/itwnvyfq5jbjor_vh2k436o7sy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Looking at this magnificent ‚Äúbouquet‚Äù of related news and exploits, where the red dot is the original vulnerability, we understand that Heartbleed was significantly underestimated. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Based on this example, we can conclude that </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systematicity, duration, and other vulnerability parameters are estimated fairly well using graph metrics. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Below are a couple of examples of research metrics that served as the basis for an alternative classification:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the number of nodes in the graph - is responsible for the "breadth" of the vulnerability, how large a trace it left in various systems,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the number of subgraphs (large clusters of news) - is responsible for the granularity of the problem or the presence of large problem areas within the vulnerability,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the number of related exploits and patches - speaks about the explosiveness of the news and how many times it had to be "treated", </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the number of unique types and families of news in the graph is about systematicity, that is, the number of subsystems affected by the impact of the vulnerability,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the duration from the first publication to the first exploit, the time from the first publication to the last related news - about the temporal nature of the vulnerability, whether it stretches with a large ‚Äútail‚Äù of consequences or quickly develops and fades.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, these are not all metrics; under the hood of the research, there are now about 30 indicators that complement the basic set of CVSS criteria, including the average increase between the levels of the news vulnerability graph, the percentage of exploits at the first level of the graph, and much more. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open the gray zone</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And now a little data science and statistics - after all, hypotheses need to be confirmed on data, aren't they? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the experiment with an alternative scale and new metrics, news published in January 2019 were selected. </font><font style="vertical-align: inherit;">This is 2403 newsletters and about 150 thousand lines in the news column. </font><font style="vertical-align: inherit;">All source vulnerabilities were divided into three groups according to CVSS Score:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">High - from 8 points inclusive.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medium - from 6 inclusive to 8 points.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Low - less than 6 points.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, let's see how the CVSS score correlates with the number of related news in the graph, the number of news types and the number of exploits: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/qe/c2/owqec2zfiw8zt-_dyvtnjtc8sde.png"><br>
<br>
<img src="https://habrastorage.org/webt/l1/p-/k5/l1p-k5un_rkbwfmfu080vqlmtvs.png"><br>
<br>
<img src="https://habrastorage.org/webt/zj/gl/fi/zjglfivtyxofhraa6jmm5owapbu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the ideal picture, we should have seen a clear separation of metrics into three clusters, but this did not happen, which indicated the possible presence of a gray zone, which CVSS Score does not define - this is our goal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next logical step was the clustering of vulnerabilities into homogeneous groups and the construction of a new scale. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the first iteration, a simple metric classifier and k-means were chosen and a new matrix of estimates was obtained: the initial points (Medium, Low, High) are found on the Y axis, along the X, where 2 are the largest in the new vulnerability metrics, 1 are the new vulnerabilities, 0 are the smallest.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rg/jn/5h/rgjn5hjig6emomnhlmrqgntzhkw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A zone marked with an oval (Vulnerability Class 2 with an initial low &amp; medium rating) ‚ÄîPotentially underestimated vulnerabilities. Separation into new classes also looks clearer, which is what we were aiming for: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/aq/to/ec/aqtoecqvgy2qyukjhf34ipd-auu.png"><br>
<br>
<img src="https://habrastorage.org/webt/xd/y2/sv/xdy2svwhc4krnisetvm1momhnxs.png"><br>
<br>
<img src="https://habrastorage.org/webt/ym/mm/a6/ymmma6_1e5jlvjvxbpzcmw32c68.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, simply trusting models is a bad idea, especially when it comes to unsupervised clustering, where the correct answer is not known in principle, and you can only rely on the separation metrics of the obtained classes . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And this is where we need expert knowledge - because for a good test and interpretation of the results, knowledge of the subject area is necessary. Therefore, it is advisable to check the model pointwise, for example, by pulling out a couple of vulnerabilities for detailed analysis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Below are a few bright samples from the gray zone that have a low CVSS score, but a high graph score - which means potentially requiring a different priority for working with them. Here's what they look like in a graphical representation: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-0555 (CVSS score 4.4, graph class 2 high) </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/-f/cw/cv/-fcwcvutdlxwbhr5vzssit9-sfo.png"><br>
<br>
<img src="https://habrastorage.org/webt/xd/sb/s8/xdsbs8dp50therk8skdlmirjo6s.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMB_NT_MS19_JAN_DOTNET.NASL (CVSS score 5.0, graph class 2 high) </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/qm/rw/wx/qmrwwxlbgojb4sbp8fwmv8mbyxy.png"><br>
<br>
<img src="https://habrastorage.org/webt/9k/zd/dc/9kzddcv5w5e8vaomjiyccipzys8.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-1653 (CVSS score 5.0, graph class 2 - high) </font></font><br>
</b><br>
<img src="https://habrastorage.org/webt/jo/2u/b3/jo2ub3swkh-wqk55u0hvucfhbns.png"><br>
<br>
<img src="https://habrastorage.org/webt/uh/hq/ha/uhhqhadk3ozdud7tdpvw2toywxc.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RHSA-2019: 0130 (CVSS score 5.0, graph class 2 - high)</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/jw/xv/l_/jwxvl_pzzvyy_tdxuwfy8pn5bwc.png"><br>
<br>
<img src="https://habrastorage.org/webt/nm/wr/iv/nmwriv0gehjf9mjz6zzoqxdcl6w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems that the concept was confirmed by statistics and spot checks, so in the near future we want to refine and automate the collection of graph metrics, and - perhaps - the classifier itself. </font><font style="vertical-align: inherit;">Of course, there is still a lot of work to do - from collecting a huge number of new graphs for months not covered by the study, but this only adds enthusiasm, as does the essence of the task. </font><font style="vertical-align: inherit;">As a data scientist, I can say that the work on this study was an incredibly inspiring experience, both in terms of topic and complexity - even preparatory engineering work with loosely structured data was very interesting.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to take a step from expert assessments to real numbers and evaluate the invaluable? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the study, it became clear that first of all, a critical approach is needed not only to any metric or data, but also to the process as a whole, because the world is too dynamic and changes faster than methodologies and documentation. Always evaluated in one way - why not try to shift the angle of view? As our example shows, even the most unusual hypotheses can be confirmed.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An important role is played by the availability of data for datasaentists - it allows you to quickly check the most daring hypotheses and better understand the essence of your subject area in all its manifestations. </font><font style="vertical-align: inherit;">Therefore, if you are not yet collecting or deleting ‚Äúunnecessary‚Äù data, think about it, maybe there are a lot of discoveries lurking there. </font><font style="vertical-align: inherit;">This case suggests that data driven and information security complement each other perfectly.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en494310/index.html">Issue # 34: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../en494314/index.html">‚ÄúScrolling through boring GOSTs ...‚Äù or requirements analysis when developing an LED driver</a></li>
<li><a href="../en494316/index.html">Pratt Parsers for Dummies</a></li>
<li><a href="../en494318/index.html">How do you get 1024 colors in CGA? And are there really 1024?</a></li>
<li><a href="../en494322/index.html">Competition: show your home office and win PS4 *</a></li>
<li><a href="../en494334/index.html">Progressive web applications. Guide to action</a></li>
<li><a href="../en494336/index.html">Front-end toolkit: useful utilities and features to speed up development</a></li>
<li><a href="../en494338/index.html">Backups from WAL-G. What is there in 2019? Andrey Borodin</a></li>
<li><a href="../en494340/index.html">Microservices - combinatorial explosion of versions</a></li>
<li><a href="../en494342/index.html">Study: the perfect training for an IT professional</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>