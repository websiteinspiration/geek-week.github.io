<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë≤üèø üôÖüèΩ üëÉ C # 8 e validade nula. Como vivemos com isso üë®üèª‚Äçüè´ üë©‚Äçüé§ üë®üèª‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° colegas! √â hora de mencionar que temos planos de lan√ßar o livro fundamental de Ian Griffiths sobre C # 8:
 
 
 Enquanto isso, em seu blog, o autor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C # 8 e validade nula. Como vivemos com isso</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/501520/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ol√° colegas! </font><font style="vertical-align: inherit;">√â hora de mencionar que temos planos de lan√ßar </font><font style="vertical-align: inherit;">o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">livro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fundamental de </font><font style="vertical-align: inherit;">Ian Griffiths sobre C # 8:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/iw/to/l-/iwtol-20o3gyqy1ppgnewp68giw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enquanto isso, em seu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog, o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> autor publicou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dois </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> relacionados, </font><font style="vertical-align: inherit;">nos quais considera os meandros de novos fen√¥menos, como anulabilidade, esquecimento nulo e conscientiza√ß√£o nula. </font><font style="vertical-align: inherit;">Traduzimos os dois artigos sob um t√≠tulo e sugerimos discuti-los.</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O novo recurso mais ambicioso do C # 8.0 √© chamado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">refer√™ncias anul√°veis</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O objetivo desse novo recurso √© suavizar os danos causados ‚Äã‚Äãpor uma coisa perigosa, que o cientista da computa√ß√£o Tony Hoar chamou de " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erro de bilh√£o de d√≥lares</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">C # tem uma palavra-chave</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(o equivalente a isso √© encontrado em muitos outros idiomas), e as ra√≠zes dessa palavra-chave podem ser rastreadas at√© o idioma Algol W, no desenvolvimento do qual Hoar participou. Nesse idioma antigo (que apareceu em 1966), vari√°veis ‚Äã‚Äãque se referem a inst√¢ncias de um determinado tipo podem ter um significado especial, indicando que, no momento, essa vari√°vel n√£o √© referenciada em nenhum lugar. Essa oportunidade foi amplamente emprestada e hoje muitos especialistas (inclusive o pr√≥prio Hoar) acreditam que ela se tornou a maior fonte de erros de software dispendiosos de todos os tempos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que h√° de errado em assumir zero? Em um mundo em que qualquer link pode apontar para zero, voc√™ deve considerar isso onde quer que qualquer link seja usado em seu c√≥digo; caso contr√°rio, voc√™ corre o risco de ser recusado em tempo de execu√ß√£o. √Äs vezes, n√£o √© muito oneroso; se voc√™ inicializar uma vari√°vel com uma express√£o </font></font><code>new</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no mesmo local em que a declara, saber√° que essa vari√°vel n√£o √© igual a zero. Mas mesmo um exemplo t√£o simples est√° repleto de alguma carga cognitiva: antes do lan√ßamento do C # 8, o compilador n√£o sabia se voc√™ est√° fazendo algo que possa converter esse valor </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mas, assim que voc√™ come√ßa a costurar diferentes fragmentos de c√≥digo, fica muito mais dif√≠cil julgar com certeza sobre essas coisas: qual a probabilidade de que essa propriedade que estou lendo agora possa retornar </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? √â permitido transmitir</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nesse m√©todo? Em que situa√ß√µes posso ter certeza de que o m√©todo que estou chamando definir√° esse argumento </font></font><code>out</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o para </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas para um valor diferente? Al√©m disso, o assunto n√£o se limita a lembrar de verificar essas coisas; n√£o est√° totalmente claro o que voc√™ deve fazer se chegar a zero. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com tipos num√©ricos em C #, n√£o existe esse problema: se voc√™ escrever uma fun√ß√£o que recebe alguns n√∫meros como entrada e retorna um n√∫mero como resultado, n√£o precisa se perguntar se os valores transmitidos s√£o realmente n√∫meros e se alguma coisa entre eles pode ser misturada. Ao chamar essa fun√ß√£o, n√£o √© necess√°rio pensar se ela pode retornar algo em vez de um n√∫mero. A menos que esse desenvolvimento de eventos lhe interesse como uma op√ß√£o: nesse caso, voc√™ pode declarar par√¢metros ou resultados do tipo</font></font><code>int?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, indicando que, nesse caso espec√≠fico, voc√™ realmente deseja permitir a transmiss√£o ou o retorno de um valor nulo. Assim, para tipos num√©ricos e, em um sentido mais geral, tipos significativos, a toler√¢ncia zero sempre foi uma daquelas coisas que s√£o feitas voluntariamente, como uma op√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto aos tipos de refer√™ncia, anteriores ao C # 8.0, a permissibilidade de zero n√£o era apenas definida por padr√£o, mas tamb√©m n√£o podia ser desativada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, por raz√µes de compatibilidade com vers√µes anteriores, a validade zero continua a operar por padr√£o, mesmo no C # 8.0, porque os novos recursos de idioma nesta √°rea permanecem desativados at√© que voc√™ os solicite explicitamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, assim que voc√™ habilita esse novo recurso - tudo muda. A maneira mais f√°cil de ativ√°-lo √© adicion√°-lo </font></font><code>&lt;Nullablegt;enable&lt;/Nullablegt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dentro do elemento.</font></font><code>&lt;PropertyGroup&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no seu arquivo </font></font><code>.csproj</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. (Observo que mais controle de filigrana tamb√©m est√° dispon√≠vel. Se voc√™ realmente precisar dele, poder√° configurar o comportamento a ser permitido </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">separadamente em cada linha. Mas, quando recentemente decidimos incluir esse recurso em todos os nossos projetos, verificou-se que ele seria ativado em uma escala um projeto de cada vez √© uma tarefa fact√≠vel.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando os links permitidos no C # 8.0 s√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">totalmente ativados, a situa√ß√£o muda: agora, por padr√£o, presume-se que os links n√£o permitam nulo somente se voc√™ n√£o especificar o oposto, exatamente como nos tipos significativos ( at√© a sintaxe √© a mesma: voc√™ pode escrever int ?, se voc√™ realmente deseja que o valor inteiro seja opcional. Agora, voc√™ escreve string ?, se quer dizer que deseja um link para uma string ou</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa √© uma altera√ß√£o muito significativa e, em primeiro lugar, devido ao seu significado, esse novo recurso √© desativado por padr√£o. A Microsoft poderia ter projetado esse recurso de linguagem de maneira diferente: voc√™ poderia deixar os links padr√£o anul√°veis ‚Äã‚Äãe introduzir uma nova sintaxe que permitiria especificar que voc√™ deseja garantir que isso n√£o seja permitido </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Talvez isso reduza a fasquia ao explorar essa possibilidade, mas a longo prazo essa solu√ß√£o estaria incorreta, pois na pr√°tica a maioria dos links na grande massa de c√≥digo C # n√£o foi projetada para apontar </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assumir que zero √© uma exce√ß√£o, n√£o uma regra, e √© por isso que, quando esse novo recurso de idioma √© ativado, impedir que nulo se torne um novo padr√£o. Isso √© refletido mesmo no nome do recurso original: "refer√™ncias anul√°veis". O nome √© curioso, pois os links podem apontar </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para o C # 1.0. Mas os desenvolvedores optaram por enfatizar que agora a suposi√ß√£o nula entra na categoria de coisas que precisam ser explicitamente solicitadas. </font></font><br>
‚ÄÉ<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O C # 8.0 facilita o processo de introdu√ß√£o de links permissivos </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pois permite que voc√™ introduza esse recurso gradualmente. N√£o √© preciso fazer uma escolha sim ou n√£o. Isso √© bem diferente do recurso </font></font><code>async/await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adicionado no C # 5.0, que costumava se espalhar: de fato, opera√ß√µes ass√≠ncronas obrigam o chamador a ser</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, portanto, o c√≥digo que chama esse chamador deve estar </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e assim por diante, no topo da pilha. Felizmente, os tipos que permitem </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o constru√≠dos de maneira diferente: eles podem ser implementados de maneira seletiva e gradual. Voc√™ pode trabalhar com os arquivos um por um, ou mesmo linha por linha, se necess√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O aspecto mais importante dos tipos que permitem</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(gra√ßas √† qual a transi√ß√£o para eles √© simplificada), √© que, por padr√£o, eles est√£o desativados. Caso contr√°rio, a maioria dos desenvolvedores se recusaria a usar o C # 8.0, pois essa transi√ß√£o causaria avisos em quase qualquer base de c√≥digo. No entanto, pelas mesmas raz√µes, o limite de entrada para o uso desse novo recurso parece bastante alto: se um novo recurso faz altera√ß√µes t√£o dr√°sticas que √© desativado por padr√£o, √© prov√°vel que voc√™ n√£o queira mexer nele, mas h√° problemas associados √† mudan√ßa para ele sempre parecer√° um aborrecimento desnecess√°rio. Mas isso seria uma pena, porque o recurso √© muito valioso. Ajuda a encontrar erros no c√≥digo antes que os usu√°rios fa√ßam isso por voc√™. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, se voc√™ est√° pensando em introduzir tipos que permitem</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, lembre-se de poder introduzir esse recurso passo a passo. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Somente avisos</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O n√≠vel mais r√≠gido de controle sobre todo o projeto ap√≥s um simples ligar / desligar √© a capacidade de ativar avisos, independentemente das anota√ß√µes. Por exemplo, se eu ativar totalmente a suposi√ß√£o zero para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corvus.ContentHandling.Json</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em nosso reposit√≥rio </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corvus.ContentHandling</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , adicionando </font></font><code>&lt;Nullablegt;enable&lt;/Nullablegt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ao grupo de propriedades no arquivo do projeto, em seu estado atual, 20 avisos do compilador aparecer√£o imediatamente. No entanto, se eu us√°-lo, </font></font><code>&lt;Nullablegt;warnings&lt;/Nullablegt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">receberei apenas um aviso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas espere! Por que menos avisos ser√£o mostrados para mim? No final, aqui eu apenas pedi avisos. A resposta a essa pergunta n√£o √© totalmente √≥bvia: o fato √© que algumas vari√°veis ‚Äã‚Äãe express√µes podem ser </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulas. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neutralidade nula O</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
C # suporta duas interpreta√ß√µes de validade nula. Em primeiro lugar, qualquer vari√°vel de um tipo de refer√™ncia pode ser declarada como admitindo ou n√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, em segundo lugar, o compilador </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sempre que </font><font style="vertical-align: inherit;">poss√≠vel conclui logicamente se essa vari√°vel pode ou n√£o estar </font><font style="vertical-align: inherit;">em qualquer ponto espec√≠fico do c√≥digo. Este artigo trata apenas da primeira variedade de admissibilidade</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja, sobre o tipo est√°tico de uma vari√°vel (na verdade, isso se aplica n√£o apenas a vari√°veis ‚Äã‚Äãe par√¢metros e campos pr√≥ximos a eles em esp√≠rito; a admissibilidade est√°tica e logicamente dedut√≠vel √© </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">determinada para cada express√£o em C #.) De fato, a admissibilidade </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em seu primeiro sentido , o que estamos considerando √© uma extens√£o do sistema de tipos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, acontece que, se focarmos apenas na admissibilidade nula para um tipo, a situa√ß√£o n√£o ser√° t√£o coerente quanto se poderia supor. Este n√£o √© apenas um contraste entre "validade nula" e "inv√°lida</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" De fato, existem mais duas possibilidades. Existe uma categoria de "desconhecido", que √© obrigat√≥ria devido √† disponibilidade de gen√©ricos; se voc√™ tiver um par√¢metro de tipo ilimitado, n√£o ser√° poss√≠vel descobrir nada sobre a validade </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: c√≥digo usando o m√©todo ou tipo generalizado apropriado pode substituir um argumento neles, permitindo ou n√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Voc√™ pode adicionar restri√ß√µes, mas muitas vezes essas restri√ß√µes s√£o indesej√°veis, pois restringem o escopo do tipo ou m√©todo generalizado. Portanto, para vari√°veis ‚Äã‚Äãou express√µes de algum par√¢metro de tipo ilimitado, a </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(n√£o) validade de zero deve ser desconhecida; talvez, em cada caso, a quest√£o da admissibilidade</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser√° decidido separadamente para eles, mas n√£o sabemos qual op√ß√£o aparecer√° no c√≥digo gen√©rico, pois depender√° do argumento de tipo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A √∫ltima categoria √© chamada "neutra". Pelo princ√≠pio da "neutralidade", tudo funcionava antes do advento do C # 8.0, e isso funcionar√° se voc√™ n√£o ativar a capacidade de trabalhar com links anul√°veis. (Basicamente, este √© um exemplo de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retroatividade</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Embora a id√©ia de neutralidade nula tenha sido introduzida pela primeira vez no C # 8.0 como um estado natural de c√≥digo antes de ativar a validade nula para refer√™ncias, os designers de C # insistiram que essa propriedade nunca era realmente estranha ao C #.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Talvez voc√™ n√£o precise explicar o que "neutralidade" significa nesse caso, pois √© nesse sentido que o C # sempre funcionou, para que voc√™ entenda tudo ... embora, talvez, isso seja um pouco desonesto. Portanto, ou√ßa: em um mundo onde se sabe sobre admissibilidade </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, a caracter√≠stica mais importante das </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">express√µes -eutrais √© que elas n√£o causam avisos sobre aceitabilidade nula. Voc√™ pode atribuir uma express√£o nula-neutra como uma </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel </font><font style="vertical-align: inherit;">permitida </font><font style="vertical-align: inherit;">, mas n√£o permitida. </font></font><code>Null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°veis ‚Äã‚Äãvari√°veis ‚Äã‚Äã(assim como propriedades, campos, etc.), voc√™ pode atribuir express√µes que o compilador considerou "poss√≠vel </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" ou "n√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por isso, se voc√™ ativar os avisos, n√£o haver√° muitos alertas novos. Todo o c√≥digo permanece no contexto de anota√ß√µes de validade desabilitadas </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, portanto, todas as vari√°veis, par√¢metros, campos e propriedades ser√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neutros, o que significa que voc√™ n√£o receber√° nenhum aviso se tentar us√°-lo em conjunto com qualquer entidade que leve em considera√ß√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que, ent√£o, recebo avisos? Um motivo comum √© a tentativa de fazer amigos de uma maneira inaceit√°vel dois peda√ßos de c√≥digo que levam em considera√ß√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Por exemplo, suponha que eu tenha uma biblioteca em que os links permissivos sejam totalmente inclu√≠dos </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e essa biblioteca tenha a seguinte classe profundamente inventada:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NullableAwareClass</span><font></font>
	{<font></font>
	    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span>? GetNullable() =&gt; DateTime.Now.Hour &gt; <span class="hljs-number">12</span> ? <span class="hljs-literal">null</span> : <span class="hljs-string">"morning"</span>;<font></font>
	<font></font>
<font></font>
	    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">RequireNonNull</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> s</span>)</span> =&gt; s.Length;<font></font>
	}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, em outro projeto, eu posso escrever esse c√≥digo no contexto em que os avisos de validade nula s√£o ativados, mas as anota√ß√µes correspondentes est√£o desabilitadas: </font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">UseString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> x</span>)</span> =&gt; NullableAwareClass.RequireNonNull(x);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como as anota√ß√µes sobre validade nula est√£o desativadas, o par√¢metro </font></font><code>x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui √© </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neutro. </font><font style="vertical-align: inherit;">Isso significa que o compilador n√£o pode determinar se esse c√≥digo √© verdadeiro ou n√£o. </font><font style="vertical-align: inherit;">Se o compilador emitiu avisos nos casos em que </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">express√µes neutras s√£o misturadas com aquelas que levam em considera√ß√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, uma propor√ß√£o significativa desses avisos pode ser considerada duvidosa - portanto, os avisos n√£o s√£o emitidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com esse inv√≥lucro, eu realmente escondi o fato de que o c√≥digo leva em considera√ß√£o a validade </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Isso significa que agora eu posso escrever assim:</font></font><br>
<br>
<pre><code class="cs hljs">	<span class="hljs-keyword">int</span> x = UseString(NullableAwareClass.GetNullable());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O compilador sabe o que </font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode retornar </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas desde que chamei o m√©todo com um par√¢metro nulo-neutro, o programa n√£o sabe se isso est√° certo ou errado. Usando o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wrapper -neutral, desarmei o compilador, que agora n√£o v√™ nenhum problema aqui. No entanto, se eu combinasse esses dois m√©todos diretamente, tudo seria diferente:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">int</span> y = NullableAwareClass.RequireNonNull(NullableAwareClass.GetNullable());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui eu passo o resultado </font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diretamente para </font></font><code>RequireNonNull</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se eu tentasse fazer isso em um contexto em que hip√≥teses nulas est√£o ativadas, o compilador geraria um aviso, independentemente de eu ativar ou desativar o contexto das anota√ß√µes correspondentes. Nesse caso em particular, o contexto das anota√ß√µes n√£o importa, pois n√£o h√° declara√ß√µes com um tipo de refer√™ncia. Se voc√™ ativar avisos sobre a suposi√ß√£o de nulo, mas desativar as anota√ß√µes correspondentes, todas as declara√ß√µes se tornar√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neutras, o que, no entanto, n√£o significa que todas as express√µes se tornem tais. Portanto, sabemos que o resultado </font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© nulo. Portanto, recebemos um aviso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resumindo: como todas as declara√ß√µes no contexto de anota√ß√µes desativadas que permitem </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- neutro, n√£o receberemos muitos avisos, pois a maioria das express√µes ser√° - </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neutra. Mas o compilador ainda poder√° capturar erros relacionados √† suposi√ß√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nos casos em que as express√µes n√£o passam por algum intermedi√°rio nulo-neutro. Al√©m disso, o maior benef√≠cio nesse caso ser√° detectar erros associados a tentativas de desreferenciar poss√≠veis valores nulos usando </font></font><code>.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por exemplo:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">int</span> z = NullableAwareClass.GetNullable().Length;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se seu c√≥digo foi bem projetado, n√£o deve haver um grande n√∫mero de erros desse tipo. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anota√ß√£o gradual de todo o projeto</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Depois de dar o primeiro passo - basta ativar os avisos, voc√™ pode prosseguir para a ativa√ß√£o gradual das anota√ß√µes, arquivo por arquivo. √â conveniente inclu√≠-los imediatamente em todo o projeto, ver em quais avisos os arquivos aparecem - e depois selecionar um arquivo em que haja relativamente poucos avisos. Novamente, desative-os no n√≠vel de todo o projeto e escreva na parte superior do arquivo selecionado </font></font><code>#nullable enable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Isso ativar√° totalmente a suposi√ß√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(tanto para avisos quanto para anota√ß√µes) em todo o arquivo (a menos que voc√™ as desative novamente usando outra diretiva</font></font><code>#nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Em seguida, voc√™ pode percorrer o arquivo inteiro e garantir que todas as entidades que provavelmente s√£o nulas sejam anotadas como permitidas </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ou seja, adicionar </font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) e, em seguida, lidar com avisos nesse arquivo, se houver algum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pode acontecer que adicionar todas as anota√ß√µes necess√°rias seja o suficiente para eliminar todos os avisos. O inverso tamb√©m √© poss√≠vel: voc√™ pode notar que, quando anota um arquivo sobre validade</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, outros avisos apareceram em outros arquivos que o utilizam. Como regra geral, n√£o existem muitos avisos e voc√™ tem tempo para corrigi-los rapidamente. Mas, se por algum motivo, ap√≥s esta etapa, voc√™ se afogar em avisos, ainda ter√° algumas solu√ß√µes. Primeiramente, voc√™ pode simplesmente cancelar a sele√ß√£o, deixar este arquivo e escolher outro. Em segundo lugar, voc√™ pode desativar seletivamente anota√ß√µes para os membros que voc√™ acha que est√£o causando mais problemas. ( </font></font><code>#nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode usar a </font><font style="vertical-align: inherit;">diretiva </font><font style="vertical-align: inherit;">quantas vezes quiser, para controlar as configura√ß√µes de validade nula, linha por linha, se desejar.) Talvez se voc√™ retornar a esse arquivo mais tarde, quando j√° ativar a validade nula na maior parte do projeto, ver√° menos avisos do que a primeira vez.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° momentos em que os problemas n√£o podem ser resolvidos de maneira t√£o direta. </font><font style="vertical-align: inherit;">Portanto, em certos cen√°rios relacionados √† serializa√ß√£o (por exemplo, ao usar o Json.NET ou o Entity Framework), o trabalho pode ser mais dif√≠cil. </font><font style="vertical-align: inherit;">Eu acho que esse problema merece um artigo separado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os links com a suposi√ß√£o </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melhoram a expressividade do seu c√≥digo e aumentam as chances de o compilador detectar seus erros antes que os usu√°rios os encontrem. </font><font style="vertical-align: inherit;">Portanto, √© melhor incluir esse recurso, se poss√≠vel. </font><font style="vertical-align: inherit;">E, se voc√™ inclu√≠-lo seletivamente, seus benef√≠cios come√ßar√£o a parecer mais r√°pidos.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt501502/index.html">Nova s√≠ntese digital de laborat√≥rio continua Harris Book e ajuda a criar videogame FPGA</a></li>
<li><a href="../pt501506/index.html">Sobre vazamentos de GDI e a import√¢ncia da sorte</a></li>
<li><a href="../pt501508/index.html">Maldito CRM antigo</a></li>
<li><a href="../pt501510/index.html">Uma nova vis√£o do desenvolvimento do Fullstack com a estrutura Ruby on Rails</a></li>
<li><a href="../pt501516/index.html">Vamos desligar o aspirador ?! Alexey Lesovsky</a></li>
<li><a href="../pt501522/index.html">Webinars gratuitos do Skillbox: escrevendo jogos em PHP, Unity e Unreal Engine</a></li>
<li><a href="../pt501524/index.html">Segredos de sincronizar os campos eletromagn√©ticos da Terra e um organismo vivo</a></li>
<li><a href="../pt501526/index.html">Por que o ingl√™s canadense √© considerado "sujo" e o que Keanu Reeves tem a ver com isso?</a></li>
<li><a href="../pt501528/index.html">O livro "Bash e seguran√ßa cibern√©tica: ataque, defesa e an√°lise a partir da linha de comando do Linux"</a></li>
<li><a href="../pt501534/index.html">Agora, com o COVID-19, tamb√©m h√° uma erup√ß√£o cut√¢nea</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>