<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏽 🦐 🅾️ Dimulai dengan Data Inti! Sulit dalam kata-kata sederhana [Bagian 2] 🛴 📨 ✋🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini, saya ingin mengungkap lebih lanjut kemampuan Core Data. Artikel ini merupakan kelanjutan . Saya benar-benar berharap saya bisa menda...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Dimulai dengan Data Inti! Sulit dalam kata-kata sederhana [Bagian 2]</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495602/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada artikel ini, saya ingin mengungkap lebih lanjut kemampuan Core Data. </font><font style="vertical-align: inherit;">Artikel ini merupakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kelanjutan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Saya benar-benar berharap saya bisa mendapatkan ide bahwa Core Data bukan salah satu dari banyak basis data relasional, tetapi alat yang sangat kuat yang dapat menjadi senjata integral dalam gudang pengembang iOS yang menghargai diri sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baiklah, mari kita mulai!</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hari ini kita melihat bekerja dengan dua NSManageObjectContext dan NSFetchedResultsController. </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dua NSManageObjectContext dan mengapa ini diperlukan?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika aplikasi Anda secara aktif menggunakan API apa pun yang digunakannya menerima data, dan Anda ingin menyimpan data ini di suatu tempat, maka Core Data adalah pilihan yang sangat baik. Masalah apa yang mungkin Anda miliki dengan ini? Yang pertama dan paling jelas - jumlah data akan sangat besar sehingga ketika Anda mencoba untuk menyimpannya, aplikasi kami akan membeku selama beberapa waktu, yang akan mempengaruhi pengalaman pengguna. GCD biasa tidak dapat ditiadakan di sini, karena secara independen, Core Data Stack kami, yang disebutkan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , berfungsi secara sinkron dan untuk akses apa pun ke NSManageObjectContext kami, kami harus menunggu hingga akhir loop. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi di sini konteks pribadi NSManageObjectContext yang bekerja di latar belakang datang untuk menyelamatkan. Untuk menyebutnya, Anda harus terlebih dahulu menghubungi NSPersistentContainer kami.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inisialisasi akan terlihat seperti ini:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-built_in">lazy</span> <span class="hljs-keyword">var</span> persistentContainer: <span class="hljs-type">NSPersistentContainer</span> = {
    <span class="hljs-keyword">let</span> container = <span class="hljs-type">NSPersistentContainer</span>(name: <span class="hljs-string">"Preset"</span>)<font></font>
    container.loadPersistentStores { (persistent, error) <span class="hljs-keyword">in</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error = error {
            <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"Error: "</span> + error.localizedDescription)<font></font>
        }<font></font>
    }<font></font>
    container.viewContext.mergePolicy = <span class="hljs-type">NSMergeByPropertyStoreTrumpMergePolicy</span>
    container.viewContext.shouldDeleteInaccessibleFaults = <span class="hljs-literal">true</span>
    container.viewContext.automaticallyMergesChangesFromParent = <span class="hljs-literal">true</span>
    <span class="hljs-keyword">return</span> container<font></font>
}()<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mergepolicy</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini Anda menentukan kebijakan penggabungan NSManageObjectContext kami. </font><font style="vertical-align: inherit;">Di sini kami secara eksplisit menunjukkan bagaimana Data Inti harus berperilaku jika terjadi konflik data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Opsi MergePolicy:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSRollbackMergePolicy - Jika terjadi konflik, buang semua perubahan hingga terjadi </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSOverwriteMergePolicy - Menyimpan nilai baru terlepas dari data </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSMergeByPropertyStoreTrumpMergePolicy - Menyimpan properti objek yang diubah oleh properti, dalam hal ini, data yang disimpan akan menang</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSMergeByPropertyObjectTrumpMergePolicy - Menyimpan properti objek yang diubah oleh properti, dalam hal ini data baru akan menang </font></font></li>
</ol><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutomaticallyMergesChangesFromParent</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mengatakan apakah konteks kita akan secara otomatis menggabungkan data. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lalu buat konteks baru:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> context = persistentContainer.viewContext
<span class="hljs-keyword">let</span> context = persistentContainer.newBackgroundContext()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kami memiliki dua NSManageObjectContext. </font><font style="vertical-align: inherit;">Yang pertama adalah untuk bekerja dengan UI dan berjalan di utas utama, dan yang kedua memiliki privateQueueConcurrencyType untuk bekerja di latar belakang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan menggunakannya untuk mengunduh data.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> object = <span class="hljs-type">NSEntityDescription</span>.insertNewObject(forEntityName: <span class="hljs-string">"Name"</span>, into: context)<font></font>
saveChanges(with: context)<font></font>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita membuat Entity kita dan kemudian kita dapat menetapkan properti yang diperlukan untuk itu, setelah itu kita memanggil metode save, tampilannya seperti ini: </font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">saveChanges</span><span class="hljs-params">(with context: NSManagedObjectContext)</span></span> {<font></font>
        context.performAndWait {<font></font>
            <span class="hljs-keyword">if</span> context.hasChanges {
                <span class="hljs-keyword">do</span> {
                    <span class="hljs-keyword">try</span> context.save()<font></font>
                } <span class="hljs-keyword">catch</span> {<font></font>
                    context.rollback()<font></font>
                }<font></font>
            }<font></font>
            context.reset()<font></font>
        }<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada 2 metode untuk dipilih:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performAndWait - melakukan tindakan pada utas konteks secara serempak</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melakukan - melakukan tindakan pada aliran konteks secara tidak sinkron</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSFetchedResultsController</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NSFetchedResultsController - pengontrol yang melakukan permintaan tertentu dan menampilkan data yang diperlukan untuk pengguna.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-built_in">lazy</span> <span class="hljs-keyword">var</span> fetchedResultsController: <span class="hljs-type">NSFetchedResultsController</span>&lt;<span class="hljs-type">Pack</span>&gt; = {
        <span class="hljs-keyword">let</span> fetchRequest = <span class="hljs-type">NSFetchRequest</span>&lt;<span class="hljs-type">Pack</span>&gt;(entityName:<span class="hljs-string">"Pack"</span>)<font></font>
        fetchRequest.fetchBatchSize = <span class="hljs-number">20</span>
        fetchRequest.sortDescriptors = [<span class="hljs-type">NSSortDescriptor</span>(key: <span class="hljs-string">"name"</span>, ascending:<span class="hljs-literal">true</span>)]
        <span class="hljs-keyword">let</span> controller = <span class="hljs-type">NSFetchedResultsController</span>(fetchRequest: fetchRequest, managedObjectContext: context, sectionNameKeyPath: <span class="hljs-literal">nil</span>, cacheName: <span class="hljs-literal">nil</span>)<font></font>
<font></font>
        controller.delegate = <span class="hljs-keyword">self</span>
        <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">try</span> controller.performFetch()<font></font>
        } <span class="hljs-keyword">catch</span> {
            <span class="hljs-built_in">print</span>(error.localizedDescription)<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> controller<font></font>
    }()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NSFetchedResultsController memiliki sejumlah besar konfigurasi, kami akan menganalisis beberapa di antaranya:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fetchlimit</font></font></b><div class="spoiler_text">FetchLimit —      <br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sketchoffset</font></font></b><div class="spoiler_text">FetchOffset —  .    2,       .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FetchbatchSize</font></font></b><div class="spoiler_text">FetchBatchSize —        .      Table/CollectionView        5 ,        7   ,          .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FetchbatchSize</font></font></b><div class="spoiler_text">FetchBatchSize —                .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SortDescriptor</font></font></b><div class="spoiler_text">SortDescriptor —       ,       .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReturnsObjectsAsFaults</font></font></b><div class="spoiler_text">ReturnsObjectsAsFaults — ,      ,      ,      PersistentStore         RawCache<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat ini, kami memiliki NSFetchedResultsController yang akan menampilkan data kami dalam sebuah tabel. </font><font style="vertical-align: inherit;">Untuk memperbarui data, Anda perlu memanggil metode delegasi:</font></font><br>
 <br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">ViewController</span>: <span class="hljs-title">NSFetchedResultsControllerDelegate</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">controller</span><span class="hljs-params">(<span class="hljs-number">_</span> controller: NSFetchedResultsController&lt;NSFetchRequestResult&gt;, didChange anObject: <span class="hljs-keyword">Any</span>, at indexPath: IndexPath?, <span class="hljs-keyword">for</span> type: NSFetchedResultsChangeType, newIndexPath: IndexPath?)</span></span> {<font></font>
       collectionView.reloadData()<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode delegasi ini berfungsi ketika kami memiliki perubahan dalam konteks kami. </font><font style="vertical-align: inherit;">Dalam implementasi ini, ini terjadi setelah kami menyimpan data dalam konteks pribadi. </font><font style="vertical-align: inherit;">Pada saat ini, metode delegasi dipicu dan data diperbarui. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya beberapa tindakan dan Data Inti dari basis data biasa berubah menjadi senjata ampuh bagi pengembang iOS mana pun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selamat coding!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495580/index.html">Mentimun JVM - Bukan Hanya BDD</a></li>
<li><a href="../id495588/index.html">Membuat roguelike di Unity dari awal: generator penjara bawah tanah</a></li>
<li><a href="../id495592/index.html">Cara menggunakan kamus (dan tidak hanya)</a></li>
<li><a href="../id495594/index.html">Mulailah menghasilkan uang dari perangkat lunak: menciptakan bisnis mini-digital</a></li>
<li><a href="../id495596/index.html">Pekerjaan jauh di kantor. RDP, Port Knocking, Mikrotik: sederhana dan aman</a></li>
<li><a href="../id495604/index.html">Lokalisasi sementara pada Symfony 4 + Twig</a></li>
<li><a href="../id495606/index.html">"Pemantauan sosial." Skor 1: 0 menguntungkan kita</a></li>
<li><a href="../id495608/index.html">[Infografis] Visualisasi pandemi dalam sejarah umat manusia</a></li>
<li><a href="../id495610/index.html">Mengapa masa depan bukan untuk Python</a></li>
<li><a href="../id495612/index.html">Akankah Airbnb selamat dari coronavirus? [spoiler: ya]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>