<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò¢ üëºüèæ üéè TypeScript avanzado üÄÑÔ∏è ü•ß ‚úçüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apnea libre - buceo sin buceo. El buzo siente la ley de Arqu√≠medes: desplaza una cierta cantidad de agua, lo que lo empuja hacia atr√°s. Por lo tanto, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>TypeScript avanzado</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/499634/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apnea libre - buceo sin buceo. </font><font style="vertical-align: inherit;">El buzo siente la ley de Arqu√≠medes: desplaza una cierta cantidad de agua, lo que lo empuja hacia atr√°s. </font><font style="vertical-align: inherit;">Por lo tanto, los primeros metros son los m√°s dif√≠ciles, pero luego la fuerza de presi√≥n de la columna de agua sobre usted comienza a ayudar a moverse m√°s profundo. </font><font style="vertical-align: inherit;">Este proceso recuerda el aprendizaje y la inmersi√≥n en sistemas de tipo TypeScript: se vuelve un poco m√°s f√°cil a medida que bucea. </font><font style="vertical-align: inherit;">Pero no debemos olvidar emerger a tiempo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sh/eb/y9/sheby96u0qt6o3usirdpsc78hpg.jpeg"><br>
<font color="gray"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foto de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One Ocean One Breath</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></i></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Bashurov</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saitonakamura</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) - Ingeniero frontend senior en WiseBits, fan√°tico de TypeScript y freediver aficionado. </font><font style="vertical-align: inherit;">Las analog√≠as de aprender TypeScript y profundizar no son accidentales. </font><font style="vertical-align: inherit;">Michael le dir√° qu√© son las uniones discriminadas, c√≥mo usar la inferencia de tipos, por qu√© necesita compatibilidad nominal y marca. </font><font style="vertical-align: inherit;">Aguanta la respiraci√≥n y sum√©rgete.</font></font><a name="habracut"></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/m0uRxCCno00" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><font color="gray"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Presentaci√≥n y enlaces a GitHub con c√≥digo de muestra </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo de trabajo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los tipos de sumas suenan algebraicas; tratemos de descubrir qu√© es. </font><font style="vertical-align: inherit;">Se llaman variantes en ReasonML, uni√≥n etiquetada en Haskell y uni√≥n discriminada en F # y TypeScript. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wikipedia da la siguiente definici√≥n: "El tipo de cantidad es la suma de los tipos de obras". </font></font><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Gracias capit√°n! </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La definici√≥n es completamente correcta, pero in√∫til, as√≠ que comprendamos. </font><font style="vertical-align: inherit;">Vayamos de lo privado y comencemos con el tipo de trabajo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supongamos que tenemos un tipo </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tiene dos campos: </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y qui√©n lo cre√≥.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este tipo de trabajo es intersecci√≥n o </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intersecci√≥n</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esto significa que podemos escribir el mismo c√≥digo que cada campo individualmente.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task = { <span class="hljs-attr">id</span>: number } &amp; { <span class="hljs-attr">whoCreated</span>: number }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el √°lgebra de proposiciones, esto se llama multiplicaci√≥n l√≥gica: esta es la operaci√≥n "Y" o "Y". </font><font style="vertical-align: inherit;">El tipo de producto es el producto l√≥gico de estos dos elementos.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un objeto con un conjunto de campos se puede expresar a trav√©s de un producto l√≥gico.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El tipo de trabajo no se limita a los campos. </font><font style="vertical-align: inherit;">Imagina que amamos Prototype y decidimos que nos estamos perdiendo </font></font><code>leftPad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type RichString = string &amp; { <span class="hljs-attr">leftPad</span>: <span class="hljs-function">(<span class="hljs-params">toLength: number</span>) =&gt;</span> string }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A√±√°delo a </font></font><code>String.prototype</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para expresar en tipos, tomamos una cadena y una funci√≥n que toma los valores necesarios. </font><font style="vertical-align: inherit;">El m√©todo y la cadena son la intersecci√≥n.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una asociaci√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La uni√≥n - </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uni√≥n</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - es √∫til, por ejemplo, para representar el tipo de una variable que establece el ancho de un elemento en CSS: una cadena de 10 p√≠xeles o un valor absoluto. </font><font style="vertical-align: inherit;">La especificaci√≥n CSS es en realidad mucho m√°s complicada, pero por simplicidad, dej√©moslo as√≠.</font></font><br>
<br>
<pre><code class="javascript hljs">type Width = string | number</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un ejemplo es m√°s complicado. </font><font style="vertical-align: inherit;">Supongamos que tenemos una tarea. </font><font style="vertical-align: inherit;">Puede estar en tres estados: reci√©n creado, aceptado en el trabajo y completado.</font></font><br>
<br>
<pre><code class="javascript hljs">type InitialTask = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number }<font></font>
type InWorkTask = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number }<font></font>
type FinishTask = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number, <span class="hljs-attr">finishDate</span>: <span class="hljs-built_in">Date</span> }<font></font>
<font></font>
type Task = InitialTask | InWorkTask | FinishedTask</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el primer y segundo estado, la tarea tiene </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y qui√©n la cre√≥, y en el tercero, aparece la fecha de finalizaci√≥n. </font><font style="vertical-align: inherit;">Aqu√≠ aparece la uni√≥n, ya sea esto o aquello. </font></font><br>
<br>
<strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></em></strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En cambio, </font></font></em><code>type</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puedes usar </font></font></em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pero hay matices. </font><font style="vertical-align: inherit;">El resultado de la uni√≥n y la intersecci√≥n es siempre un tipo. </font><font style="vertical-align: inherit;">Puede expresar la intersecci√≥n a trav√©s </font></font></em><code>extends</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero la uni√≥n a trav√©s </font></font></em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no puede. </font><font style="vertical-align: inherit;">Es </font></font></em><code>type</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo m√°s corto. </font></font><br>
<br>
</em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ayuda solo a fusionar declaraciones. </font><font style="vertical-align: inherit;">Los tipos de biblioteca siempre deben expresarse </font></font></em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ya que esto permitir√° que otros desarrolladores lo expandan con sus campos. </font><font style="vertical-align: inherit;">As√≠ tipificado, por ejemplo, jQuery-plugins.</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compatibilidad de tipo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero hay un problema: en TypeScript, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compatibilidad de tipo estructural</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esto significa que si el primer y el segundo tipo tienen el mismo conjunto de campos, entonces estos son dos del mismo tipo. Por ejemplo, tenemos 10 tipos con diferentes nombres, pero con una estructura id√©ntica (con los mismos campos). Si proporcionamos cualquiera de los 10 tipos a una funci√≥n que acepta uno de ellos, a TypeScript no le importar√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En Java o C #, por el contrario, un </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sistema de compatibilidad nominal</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Escribiremos las mismas 10 clases con campos id√©nticos y una funci√≥n que tome una de ellas. Una funci√≥n no aceptar√° otras clases si no son descendientes directos del tipo para el que est√° destinada la funci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El problema de compatibilidad estructural se aborda agregando estado al campo: </font></font><code>enum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font><code>string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pero los tipos de suma son una forma de expresar c√≥digo m√°s sem√°nticamente que c√≥mo se almacena en la base de datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, nos dirigiremos a ReasonML. As√≠ es como se ve este tipo all√≠.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task =<font></font>
| Initial({ <span class="hljs-attr">id</span>: int, <span class="hljs-attr">whoCreated</span>: int })<font></font>
| InWork({ <span class="hljs-attr">id</span>: int, <span class="hljs-attr">whoCreated</span>: int })<font></font>
| Finished({<font></font>
        <span class="hljs-attr">id</span>: int,
        <span class="hljs-attr">whoCreated</span>: int,
        <span class="hljs-attr">finshDate</span>: <span class="hljs-built_in">Date</span>
    })</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los mismos campos, excepto que en su </font></font><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lugar </font></font><code>number</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si nos fijamos bien, observamos </font></font><code>Initial</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>InWork</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>Finished</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. No se encuentran a la izquierda, en el nombre del tipo, sino a la derecha en la definici√≥n. Esto no es solo una l√≠nea en el t√≠tulo, sino parte de un tipo separado, por lo que podemos distinguir el primero del segundo. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hack de la vida</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para los tipos gen√©ricos (como las entidades de su dominio) cree un archivo </font></font><code>global.d.ts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y agr√©guele todos los tipos. Ser√°n visibles autom√°ticamente en toda la base de c√≥digo TypeScript sin la necesidad de una importaci√≥n expl√≠cita. Esto es conveniente para la migraci√≥n porque no tiene que preocuparse por d√≥nde colocar los tipos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos c√≥mo hacer esto, usando el ejemplo del c√≥digo primitivo de Redux.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state, action) = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">erro</span>: action.payload }<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reescribe el c√≥digo en TypeScript. Comencemos renombrando el archivo, de </font></font><code>.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font><code>.ts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Active todas las opciones de estado y la opci√≥n noImplicitAny. Esta opci√≥n encuentra funciones en las que no se especifica el tipo de par√°metro y es √∫til en la etapa de migraci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typable </font></font><code>State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: agregar campo </font></font><code>isFetching</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(que no puede ser) y </font></font><code>Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task = { <span class="hljs-attr">title</span>: string }<font></font>
<font></font>
declare <span class="hljs-built_in">module</span> <span class="hljs-string">"*.jpg"</span> {
    <span class="hljs-keyword">const</span> url: string
    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> url<font></font>
}<font></font>
<font></font>
declare <span class="hljs-built_in">module</span> <span class="hljs-string">"*.png"</span> {
    <span class="hljs-keyword">const</span> url: string
    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> url<font></font>
}</code></pre><br>
<em><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lifehack se asom√≥ en la inmersi√≥n </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">profunda TypeScript de</font></font></em></a><font style="vertical-align: inherit;"><em><font style="vertical-align: inherit;"> Basarat Ali Syed </font></em></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Est√° un poco anticuado, pero sigue siendo √∫til para aquellos que quieren sumergirse en TypeScript. Lea sobre el estado actual de TypeScript en el </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog de</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Marius Schulz. Escribe sobre nuevas caracter√≠sticas y trucos. Tambi√©n estudie los </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">registros de cambios</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , no solo hay informaci√≥n sobre las actualizaciones, sino tambi√©n c√≥mo usarlas.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Acciones restantes. Escribiremos y declararemos cada uno de ellos.</font></font><br>
<br>
<pre><code class="javascript hljs">type FetchAction = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span><font></font>
}<font></font>
<font></font>
type SuccessAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>,
    <span class="hljs-attr">payload</span>: Task<font></font>
<font></font>
type FailAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>,
    <span class="hljs-attr">payload</span>: <span class="hljs-built_in">Error</span><font></font>
}<font></font>
<font></font>
type Actions = FetchAction | SuccessAction | FailAction</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El campo </font></font><code>type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para todos los tipos es diferente, no es solo una cadena, sino una cadena espec√≠fica: un </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">literal de cadena</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Este es el </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">discriminador</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : la etiqueta por la cual distinguimos todos los casos. </font><font style="vertical-align: inherit;">Tenemos un sindicato discriminado y, por ejemplo, podemos entender lo que hay en la carga √∫til. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actualice el c√≥digo original de Redux:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state: State, <span class="hljs-attr">action</span>: Actions): State = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay peligro aqu√≠ si escribimos </font></font><code>string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br>
<pre><code class="javascript hljs">type FetchAction = {
    <span class="hljs-attr">type</span>: string<font></font>
}</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... entonces todo se romper√°, porque ya no es un discriminador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta acci√≥n, el tipo puede ser cualquier cadena y no un discriminador espec√≠fico. </font><font style="vertical-align: inherit;">Despu√©s de eso, TypeScript no podr√° distinguir una acci√≥n de otra y encontrar errores. </font><font style="vertical-align: inherit;">Por lo tanto, debe haber exactamente un literal de cadena. </font><font style="vertical-align: inherit;">Por otra parte, podemos a√±adir este dise√±o </font></font><code>type ActionType = Actions["type"]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tres de nuestras opciones aparecer√°n en las indicaciones. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uf/gm/si/ufgmsit8lx5zzmmd9tvot5ibg5u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si t√∫ escribes ...</font></font><br>
<pre><code class="javascript hljs">type FetchAction = {
    <span class="hljs-attr">type</span>: string<font></font>
}</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... entonces las indicaciones ser√°n simples </font></font><code>string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque todas las dem√°s l√≠neas ya no son importantes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z1/g1/qe/z1g1qecermtbhjq62vju5ujmwv0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos hemos escrito y tenemos el tipo de cantidad.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comprobaci√≥n exhaustiva</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine una situaci√≥n hipot√©tica donde el manejo de errores no se agrega al c√≥digo.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state: State, <span class="hljs-attr">action</span>: Actions): State = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-comment">//case "TASK_FAIL":</span>
            <span class="hljs-comment">//return { isFetching: false, error: action.payload }</span><font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ la </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comprobaci√≥n exhaustiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos ayudar√° </font><font style="vertical-align: inherit;">, otra propiedad √∫til como la suma </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta es una oportunidad para verificar que hemos procesado todos los casos posibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A√±adir una variable despu√©s de la sentencia switch: </font></font><code>const exhaustiveCheck: never = action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nunca es un tipo interesante:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si es el resultado del retorno de una funci√≥n, la funci√≥n nunca termina correctamente (por ejemplo, siempre arroja un error o se ejecuta sin fin);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si es un tipo, este tipo no se puede crear sin ning√∫n esfuerzo adicional.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora el compilador indicar√° el error "Escriba 'FailAction' no es asignable para escribir 'nunca'". </font><font style="vertical-align: inherit;">Tenemos tres tipos posibles de acciones, de las cuales no hemos procesado </font></font><code>"TASK_FAIL"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, esto es </font></font><code>FailAction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pero para nunca, no es "asignable". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agreguemos procesamiento </font></font><code>"TASK_FAIL"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y no habr√° m√°s errores. </font><font style="vertical-align: inherit;">Procesado </font></font><code>"TASK_FETCH"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- devuelto, procesado </font></font><code>"TASK_SUCCESS"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- devuelto, procesado </font></font><code>"TASK_FAIL"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cuando procesamos las tres funciones, ¬øcu√°l podr√≠a ser la acci√≥n? </font><font style="vertical-align: inherit;">Nada - </font></font><code>never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si agrega otra acci√≥n, el compilador le dir√° cu√°les no se procesan. </font><font style="vertical-align: inherit;">Esto ayudar√° si desea responder a todas las acciones, y solo si es selectivo, entonces no.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primer consejo</font></font></h2><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intenta fuerte.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al principio ser√° dif√≠cil bucear: lea sobre el tipo de suma, luego sobre productos, tipos de datos algebraicos, etc. en la cadena. </font><font style="vertical-align: inherit;">Tendr√° que hacer un esfuerzo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando nos sumergimos m√°s profundamente, la presi√≥n de la columna de agua sobre nosotros aumenta. </font><font style="vertical-align: inherit;">A cierta profundidad, la fuerza de flotaci√≥n y la presi√≥n del agua sobre nosotros est√°n equilibradas. </font><font style="vertical-align: inherit;">Esta es una zona de "flotabilidad neutral", en la cual estamos en un estado de ingravidez. </font><font style="vertical-align: inherit;">En este estado, podemos recurrir a otros sistemas de tipos o idiomas.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema de tipo nominal</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la antigua Roma, los habitantes ten√≠an tres componentes del nombre: apellido, nombre y "apodo". </font><font style="vertical-align: inherit;">El nombre en s√≠ es "nomen". </font><font style="vertical-align: inherit;">De esto proviene el sistema de tipo nominal - "nominal". </font><font style="vertical-align: inherit;">A veces es √∫til. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, tenemos dicho c√≥digo de funci√≥n.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> githubUrl = process.env.GITHUB_URL <span class="hljs-keyword">as</span> string
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> nodeEnv = process.env.NODE_ENV <span class="hljs-keyword">as</span> string<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> fetchStarredRepos = (<font></font>
    nodeEnv: string,<font></font>
    <span class="hljs-attr">githubUrl</span>: string<font></font>
): <span class="hljs-built_in">Promise</span>&lt;GithubRepo[ ]&gt; =&gt; {
    <span class="hljs-keyword">if</span> (nodeEnv = <span class="hljs-string">"production"</span>) {
        <span class="hljs-comment">// log call</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// prettier-ignore</span>
    <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">'$githubUrl}/users/saitonakamura/starred'</span>)<font></font>
        .then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.json());<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La configuraci√≥n entra en la API: </font></font><code>GITHUB_URL=https://api.github.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">El m√©todo </font></font><code>githubUrl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API extrae los repositorios en los que ponemos un asterisco. </font><font style="vertical-align: inherit;">Y si </font></font><code>nodeEnv = "production"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, entonces registra esta llamada, por ejemplo, para m√©tricas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para la funci√≥n que queremos desarrollar (UI).</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span><font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> StarredRepos = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> [starredRepos, setStarredRepos] = useState&lt;GithubRepo[ ] | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (!starredRepos) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading‚Ä¶<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
            {starredRepos.map(repo =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{repo.name}</span>&gt;</span>repo.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><font></font>
    )<font></font>
}<font></font>
<font></font>
type GithubRepo = {<font></font>
    <span class="hljs-attr">name</span>: string<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La funci√≥n ya sabe c√≥mo mostrar datos, y si no hay ninguno, entonces un cargador. </font><font style="vertical-align: inherit;">Queda por agregar una llamada a la API y completar los datos.</font></font><br>
<br>
<pre><code class="javascript hljs">useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
    fetchStarredRepos(githubUrl, nodeEnv).then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> setStarredRepos(data))<font></font>
}, [ ])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero si ejecutamos este c√≥digo, todo se caer√°. </font><font style="vertical-align: inherit;">En el panel de desarrolladores, encontramos que est√° </font></font><code>fetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accediendo a la direcci√≥n </font></font><code>'/users/saitonakamura/starred'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: githubUrl ha desaparecido en alg√∫n lugar. </font><font style="vertical-align: inherit;">Resulta que todo por el extra√±o dise√±o </font></font><code>nodeEnv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es lo primero. </font><font style="vertical-align: inherit;">Por supuesto, puede ser tentador cambiarlo todo, pero la funci√≥n se puede usar en otros lugares de la base del c√≥digo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, ¬øqu√© pasa si el compilador solicita esto por adelantado? </font><font style="vertical-align: inherit;">Entonces no tiene que pasar por todo el ciclo de inicio, detectar un error, buscar los motivos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marca</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TypeScript tiene un truco para esto: tipos de marca. </font><font style="vertical-align: inherit;">Crear </font></font><code>Brand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(cadena) </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y dos tipos. </font><font style="vertical-align: inherit;">Crearemos el mismo tipo para </font></font><code>NodeEnv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type Brand&lt;T, B extends string&gt; = T &amp; { readonly _brand: B }<font></font>
<font></font>
type GithubUrl = Brand&lt;string, <span class="hljs-string">"githubUrl"</span>&gt;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> githubUrl = process.env.GITHUB_URL <span class="hljs-keyword">as</span> GithubUrl<font></font>
<font></font>
type NodeEnv = Brand&lt;string, <span class="hljs-string">"nodeEnv"</span>&gt;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> nodeEnv = process.env.NODE_ENV <span class="hljs-keyword">as</span> NodeEnv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero tenemos un error. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qi/_e/j-/qi_ej-yne7xhcj4qmozvbw6r7qc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora </font></font><code>githubUrl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es </font></font><code>nodeEnv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imposible asignarse entre s√≠, porque estos son tipos nominales. </font><font style="vertical-align: inherit;">Discreto, pero nominal. </font><font style="vertical-align: inherit;">Ahora no podemos intercambiarlos aqu√≠; los cambiamos en otra parte del c√≥digo.</font></font><br>
<br>
<pre><code class="javascript hljs">useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
    fetchStarresRepos(nodeEnv, githubUrl).then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> setStarredRepos(data))<font></font>
}, [ ])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora todo est√° bien: obtuvieron </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primitivas de marca</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La marca es √∫til cuando se encuentran varios argumentos (cadenas, n√∫meros). Tienen una cierta sem√°ntica (coordenadas x, y), y no deben confundirse. Es conveniente cuando el compilador le dice que est√°n confundidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pero hay dos problemas. Primero, TypeScript no tiene tipos nominales nativos. Pero hay esperanza de que se resuelva, hay una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">discusi√≥n sobre este tema</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en curso en el repositorio de idiomas </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo problema es "como", no hay garant√≠as de que el </font></font><code>GITHUB_URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enlace no est√© roto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As√≠ como con </font></font><code>NODE_ENV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Lo m√°s probable es que queramos no solo una cadena, sino </font></font><code>"production"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font><code>"development"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type NodeEnv = Brand&lt;<span class="hljs-string">"production"</span> | <span class="hljs-string">"development"</span> | <span class="hljs-string">"nodeEnv"</span>&gt;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> nodeEnv = process.env.NODE_ENV <span class="hljs-keyword">as</span> NodeEnv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo esto necesita ser verificado. </font><font style="vertical-align: inherit;">Me refiero a los dise√±adores inteligentes y al informe de Sergey Cherepanov " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dise√±o de un dominio con TypeScript en un estilo funcional</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segundo y tercer consejos</font></font></h2><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ten cuidado.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A veces, det√©ngase y mire a su alrededor: en otros idiomas, marcos, sistemas de tipos. </font><font style="vertical-align: inherit;">Aprende nuevos principios y aprende lecciones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando pasamos el punto de "flotabilidad neutral", el agua presiona m√°s y nos empuja hacia abajo.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relajarse.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√©rgete m√°s y deja que TypeScript haga su trabajo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu√© puede hacer TypeScript</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TypeScript puede </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imprimir tipos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span><font></font>
})<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createSuccess = <span class="hljs-function">(<span class="hljs-params">task: Task</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>
    <span class="hljs-attr">payload</span>: Task<font></font>
})<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFail = <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">Error</span></span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>
    <span class="hljs-attr">payload</span>: error<font></font>
})<font></font>
<font></font>
type FetchAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>,<font></font>
<font></font>
type SuccessAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>,
    <span class="hljs-attr">payload</span>: Task<font></font>
<font></font>
type FailAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>,
    <span class="hljs-attr">payload</span>: <span class="hljs-built_in">Error</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay TypeScript para esto </font></font><code>ReturnType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: obtiene el valor de retorno de la funci√≥n:</font></font><pre><code class="javascript hljs">type FetchAction = ReturnType&lt;<span class="hljs-keyword">typeof</span> createFetch&gt;</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En ella pasamos el tipo de funci√≥n. </font><font style="vertical-align: inherit;">Simplemente no podemos escribir una funci√≥n: para tomar un tipo de una funci√≥n o variable, necesitamos escribir </font></font><code>typeof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos en los consejos </font></font><code>type: string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6w/n0/tq/6wn0tq3zjhnnoqvjrk0saubafak.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto es malo: el discriminador se romper√° porque hay un objeto literal.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando creamos un objeto en JavaScript, es mutable por defecto. </font><font style="vertical-align: inherit;">Esto significa que en un objeto con un campo y una cadena, luego podemos cambiar la cadena a otra. </font><font style="vertical-align: inherit;">Por lo tanto, TypeScript extiende una cadena espec√≠fica a cualquier cadena para objetos mutables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos ayudar a TypeScript de alguna manera. </font><font style="vertical-align: inherit;">Hay como constante para esto.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agregar: la cadena desaparecer√° inmediatamente en las indicaciones. </font><font style="vertical-align: inherit;">Podemos escribir esto no solo a trav√©s de la l√≠nea, sino en general todo el literal.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces el tipo (y todos los campos) ser√°n de solo lectura.</font></font><br>
<br>
<pre><code class="javascript hljs">type FetchAction = {<font></font>
    readonly type: <span class="hljs-string">"TASK_FETCH"</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto es √∫til porque es poco probable que cambie la mutabilidad de su acci√≥n. </font><font style="vertical-align: inherit;">Por lo tanto, agregamos como constante en todas partes.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createSuccess = <span class="hljs-function">(<span class="hljs-params">task: Task</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>
    <span class="hljs-attr">payload</span>: Task<font></font>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFail = <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">Error</span></span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>
    <span class="hljs-attr">payload</span>: error<font></font>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)<font></font>
<font></font>
type Actions =<font></font>
    | ReturnType&lt;<span class="hljs-keyword">typeof</span> createFetch&gt;<font></font>
    | ReturnType&lt;<span class="hljs-keyword">typeof</span> createSuccess&gt;<font></font>
    | ReturnType&lt;<span class="hljs-keyword">typeof</span> createFail&gt;<font></font>
<font></font>
type State =<font></font>
    | { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }<font></font>
    | { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>; task: Task }<font></font>
    | { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>; error: <span class="hljs-built_in">Error</span> }<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state: State, <span class="hljs-attr">action</span>: Actions): State = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
}<font></font>
<font></font>
  <span class="hljs-keyword">const</span> _exhaustiveCheck: never = action<font></font>
<font></font>
  <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas las acciones que escriben c√≥digo se han reducido y agregado como constante. </font><font style="vertical-align: inherit;">TypeScript entendi√≥ todo lo dem√°s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TypeScript puede </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generar estado</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Est√° representado por la uni√≥n en el c√≥digo anterior con tres posibles estados de isFetching: verdadero, falso o Tarea. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilice el tipo State = ReturnType. </font><font style="vertical-align: inherit;">Las solicitudes de TypeScript indican que existe una dependencia circular. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ve/jk/vu/vejkvuzbnzraxku1y7yfm5qefhu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acortar.</font></font><br>
<br>
<pre><code class="javascript hljs">type State = ReturnType&lt;<span class="hljs-keyword">typeof</span> taskReducer&gt;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = <span class="hljs-function">(<span class="hljs-params">state, action: Actions</span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> _exhaustiveCheck: never = action<font></font>
<font></font>
<span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br>
<code>State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dej√≥ de maldecir, pero ahora lo est√° </font></font><code>any</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque tenemos una dependencia c√≠clica. </font><font style="vertical-align: inherit;">Escribimos el argumento.</font></font><br>
<br>
<pre><code class="javascript hljs">type State = ReturnType&lt;<span class="hljs-keyword">typeof</span> taskReducer&gt;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = <span class="hljs-function">(<span class="hljs-params">state: { isFetching: <span class="hljs-literal">true</span> }, action: Actions</span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> _exhaustiveCheck: never = action<font></font>
<font></font>
<span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conclusi√≥n est√° lista. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i-/7f/mt/i-7fmtcvakp9l6ldfo98cqxfbwy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conclusi√≥n es similar a lo que ten√≠amos originalmente: </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Aqu√≠ hay campos de basura </font></font><code>Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero con el tipo </font></font><code>undefined</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: el campo parece estar all√≠, pero parece que no.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuarto consejo</font></font></h2><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No trabajes demasiado.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si te relajas y buceas demasiado profundo, puede que no haya suficiente ox√≠geno para regresar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La capacitaci√≥n tambi√©n: si est√° demasiado inmerso en la tecnolog√≠a y decide aplicarla en todas partes, lo m√°s probable es que encuentre errores, las razones por las que no sabe. </font><font style="vertical-align: inherit;">Esto causar√° rechazo y ya no querr√° usar tipos est√°ticos. </font><font style="vertical-align: inherit;">Intenta evaluar tu fuerza.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥mo TypeScript ralentiza el desarrollo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tomar√° alg√∫n tiempo admitir la escritura. </font><font style="vertical-align: inherit;">No tiene el mejor UX, a veces da errores completamente incomprensibles, como cualquier otro tipo de sistema, como en Flow o Haskell.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuanto m√°s expresivo es el sistema, m√°s dif√≠cil es el error.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El valor del sistema de tipos es que proporciona una respuesta r√°pida cuando se producen errores. El sistema mostrar√° errores y tardar√° menos tiempo en encontrarlos y corregirlos. Si pasa menos tiempo corrigiendo errores, m√°s soluciones arquitect√≥nicas recibir√°n m√°s atenci√≥n. Los tipos no ralentizan el desarrollo si aprende a trabajar con ellos.</font></font><br>
<br>
<blockquote>              <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">++</a>.  -  ,   ,        (25  26 )  -      (27  ‚Äî 10 ). <br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a>   (5900  ),  ++            IT-,    . <br>
<br>
    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">AvitoTech</a>  FrontendConf 2019    .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">youtube-</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  telegram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">@FrontendConfChannel</a>,       . </blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es499624/index.html">Resumen de herramientas de Ansible</a></li>
<li><a href="../es499626/index.html">SOA en Laravel y JSON-RPC 2.0</a></li>
<li><a href="../es499628/index.html">Entrevistas de desarrollo: elige amigos</a></li>
<li><a href="../es499630/index.html">Aleteo. Actualizaci√≥n de primavera 2020</a></li>
<li><a href="../es499632/index.html">Mejora de la calidad de audio de Google Duo con WaveNetEQ</a></li>
<li><a href="../es499636/index.html">Reacciona nativo para los peque√±os. Experiencia de desarrollo m√≥vil</a></li>
<li><a href="../es499642/index.html">Pixockets: c√≥mo escribimos nuestra propia biblioteca de red para el servidor de juegos</a></li>
<li><a href="../es499644/index.html">Creaci√≥n de robots (RPA) con herramientas de AutoTest</a></li>
<li><a href="../es499646/index.html">5 reglas para integrar UX en Agile y Scrum</a></li>
<li><a href="../es499648/index.html">"Un dise√±ador de juegos siempre es un jugador": qu√© hace un especialista, qu√© habilidades son importantes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>