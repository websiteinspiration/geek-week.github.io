<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌪️ 🙆🏻 🤜🏿 用于构建信息安全系统的现代解决方案-网络数据包中介（Network Packet Broker） 🔵 🛬 🥜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="信息安全已从电信领域划分为具有自己的详细信息和设备的独立行业。但是，在电信和信息安全的交界处，鲜为人知的一类设备是网络数据包代理（Network Packet Broker），它们是负载平衡器，专用/监视交换机，流量聚合器，安全交付平台，网络可见性等。作为俄罗斯这类设备的开发商和制造商，我们真的很想...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>用于构建信息安全系统的现代解决方案-网络数据包中介（Network Packet Broker）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsol/blog/490252/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信息安全已从电信领域划分为具有自己的详细信息和设备的独立行业。</font><font style="vertical-align: inherit;">但是，在电信和信息安全的交界处，鲜为人知的一类设备是</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络数据包代理</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Network Packet Broker），它们是负载平衡器，专用/监视交换机，流量聚合器，安全交付平台，网络可见性等。</font><font style="vertical-align: inherit;">作为俄罗斯这类设备的开发商和制造商，我们真的很想谈论更多有关它们的信息。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ou/dk/el/oudkelhe8ubdir4vk7nymlouoyo.png" alt="图片" width="550" height="460"></div><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围和任务</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网络数据包代理是在信息安全系统中找到最大应用的专用设备。因此，与交换机，路由器等相比，设备类别相对较新，在公认的网络基础架构中规模较小。这种设备开发的先驱是美国公司Gigamon。当前，这个市场上有很多参与者（包括具有此类解决方案的著名测试系统制造商IXIA），但是只有一小部分专业人员仍然知道这种设备的存在。如上所述，即使有了术语，也没有明确的确定性：名称从“确保网络透明的系统”到简单的“平衡器”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在开发网络数据包代理时，我们面临的一个事实是，除了分析实验室/测试区域中的功能开发和测试领域之外，还必须同时向潜在消费者解释此类设备的存在，因为并非所有人都知道这一点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
早在15到20年前，网络中的流量很少，而且这些数据大多数都不重要。但是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尼尔森</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定律</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实际上重复了</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">摩尔定律</font></a><font style="vertical-align: inherit;">：互联网连接速度每年增长50％。流量也稳步增长（该图显示了思科对2017年的预测，来源是思科可视网络指数：2017-2022年预测与趋势）：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/r-/od/hh/r-odhhtesby81f0fqenm_et-are.png" alt="图片" width="768" height="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
随着速度的增长，流通信息（这是商业秘密和臭名昭著的个人数据）和基础架构的整体性能的重要性日益提高。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，信息安全产业也出现了。业界响应了一系列用于深度流量分析（DPI）的设备的出现：从DDOS攻击防御系统到信息安全事件管理系统，包括IDS，IPS，DLP，NBA，SIEM，Antimailware等。通常，每个工具都是在服务器平台上安装的软件。此外，每个程序（分析工具）都安装在其服务器平台上：软件制造商不同，并且在L7上有大量用于分析的计算资源。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在构建信息安全系统时，需要解决许多基本任务：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何将流量从基础架构转移到分析系统？</font><font style="vertical-align: inherit;">（在现代基础架构中，为此目的最初开发的SPAN端口在数量或性能上还不够）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何在不同的分析系统之间分配流量？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在缺乏分析器实例性能的情况下，如何扩展系统以处理进入系统的全部流量？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于分析工具目前仅支持1G / 10G / 25G接口，因此如何监视40G / 100G接口（以及不久的将来200G / 400G）？</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与以下相关任务：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何最大程度地减少不需要的流量，这些流量不需要处理，但会陷入分析工具并消耗其资源？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何处理封装的数据包和带有设备服务标记的数据包，要准备分析这些数据包要么占用资源，要么根本无法解决？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何从分析中排除不属于安全策略规定的流量（例如，管理员流量）。</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/u0/p2/dvu0p20eqotybc45qshr5n3zzb0.png" alt="图片" width="550" height="460"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
众所周知，需求创造了供应，为响应这些需求，网络数据包的经纪人开始发展。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络数据包代理的概述</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网络数据包代理在数据包级别上运行，在这种情况下，它们类似于常规交换机。与交换机的主要区别在于，在网络数据包代理中分发和聚合流量的规则完全由设置确定。网络数据包代理没有用于构建转发表（MAC表）和与其他交换机（例如STP）的通信协议的标准，因此可能的设置范围和可理解的字段范围更广。代理可以将输出从一个或多个输入端口均匀分布到给定范围的输出端口，并具有均匀的输出负载功能。您可以设置复制，过滤，分类，重复数据删除和流量修改的规则。这些规则可以应用于网络数据包代理的不同输入端口组，并依次在设备本身中依次应用。数据包代理的一个重要优点是能够以全流量处理流量并保持会话完整性（在将流量平衡到多个相同类型的DPI系统的情况下）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
保存会话的完整性包括将传输层会话（TCP / UDP / SCTP）的所有数据包传输到一个端口。这很重要，因为DPI系统（通常是在连接到数据包代理的输出端口的服务器上运行的软件）在应用程序级别分析流量的内容，并且一个应用程序发送/接收的所有数据包都必须进入同一分析器实例。 。如果来自一个会话的数据包丢失或分布在不同的DPI设备之间，则每个单独的DPI设备将处于类似于读取不是整个文本，而是从其中读取单个单词的情况。而且，很可能文本不会理解。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，面向信息安全系统，网络数据包代理具有帮助将DPI软件系统连接到高速电信网络并减少其负载的功能：它们执行初步的过滤，分类和流量准备，以简化后续处理。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另外，由于网络数据包的代理提供了大量的统计信息，并且经常发现自己已连接到网络的各个点，因此他们在诊断网络基础结构本身的健康问题时也能找到自己的位置。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络数据包代理的基本功能</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“专用/监视交换机”的名称源于其基本用途：从基础结构收集流量（通常使用无源TAP光纤耦合器和/或SPAN端口）并在分析工具之间分配流量。在异构系统之间，流量被镜像（复制），在同类系统之间，流量被平衡。基本功能通常包括按字段过滤到L4（MAC，IP，TCP / UDP端口等），并将几个轻载的通道聚合为一个（例如，在一个DPI系统上进行处理）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此功能为基本问题提供了解决方案-将DPI系统连接到网络基础结构。受基本功能限制的各种制造商的代理人，每个1U最多可处理32个100G接口（1U前面板上实际不适合更多接口）。但是，它们无法减轻分析工具的负担，对于复杂的基础架构，它们甚至无法提供基本功能的要求：在多个隧道（或配备MPLS标签）上分布的会话对于不同的分析器实例而言可能是不平衡的，并且通常无法进行分析。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了增加40 / 100G接口并因此提高生产率外，网络数据包代理还积极地提供基本的新功能：从平衡嵌套隧道头到解密流量。</font><font style="vertical-align: inherit;">不幸的是，这样的模型不能拥有TB级的性能，但是它们使您能够构建真正高质量的，技术上“美丽的”信息安全系统，在该系统中，保证每个分析工具仅以最适合的形式接收其所需的信息。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先进的网络数据包经纪人</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ut/tc/ek/uttcekss7ljjozpnwqxg5iv3o_y.png" alt="图片" width="621" height="460"></div><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提到了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在隧道流量中嵌套标头的平衡之上。</font></font></strong><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它为什么如此重要？</font><font style="vertical-align: inherit;">一起或单独考虑以下三个关键方面：</font></font><br>
<br>
<ul>
<li>       .   ,         2 ,        3       .       ,            ;</li>
<li>       (, FTP  VoIP),      .     : , ,     .   ,        ,  ,     .           ,   ,          .           ,        ;</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在存在MPLS，VLAN，单个设备标签等的情况下进行平衡 </font><font style="vertical-align: inherit;">并不是真正的隧道，但是具有基本功能的设备不能理解这种流量，不能理解为IP和MAC地址的平衡，这再次违反了会话的平衡或完整性。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网络数据包代理解析外部标头，然后依次将指针跟随到嵌套IP标头本身并对其进行平衡。</font><font style="vertical-align: inherit;">结果，线程数量明显增多（相应地，您可以在更大数量的平台上更均匀地进行不平衡），并且DPI系统接收所有会话数据包和多会话协议的所有已连接会话。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.修改流量。</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就功能而言，最广泛的功能之一，子功能的数量及其应用选项众多：</font></font><br>
<br>
<ul>
<li> payload,          .         ,        ,    . ,          (,  ,   ),  payload   ,      .  ,  payload ,     –      ;</li>
<li>,    ,    .  –         .                  ;</li>
<li>   : MPLS-, VLAN,    ;</li>
<li>  , ,  IP-    ;</li>
<li>    :  ,  ,     ..</li>
</ul><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.重复数据删除</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -清除传输到分析工具的重复流量数据包。重复的数据包通常是由于连接到基础结构的特殊性而产生的-流量可以经过多个分析点，并与每个点进行镜像。还会重复发送尚未到达的TCP数据包，但是如果有很多TCP数据包，则很可能是监视网络质量的问题，而不是网络中的信息安全性。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.先进的过滤功能</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -从以给定的偏移量搜索特定值到整个包的签名分析。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. NetFlow / IPFIX生成</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -收集大量有关通过流量并将其传输到分析工具的统计信息。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.解密SSL流量，</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只要证书和密钥先前已上载到网络数据包代理，它就可以工作。但是，这可以显着卸载分析工具。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
还有许多有用的和营销功能，但可能列出了主要功能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
预防系统中检测系统（入侵，DDOS攻击）的发展以及主动DPI工具的引入，要求将切换方案从被动（通过TAP或SPAN端口）切换到主动（“进入差距”）。这种情况增加了对可靠性的要求（因为这种情况下的故障会导致整个网络的中断，不仅会失去对信息安全性的控制），而且还会导致将光耦合器替换为光旁路（以解决网络性能对系统性能的依赖性问题）。信息安全性），但基本功能和要求保持不变。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们开发了具有100G，40G和10G接口的DS Integrity Network Packet Broker，从设计，电路到嵌入式软件。</font><font style="vertical-align: inherit;">此外，与其他数据包代理不同，嵌入式隧道头的修改和平衡功能是在硬件上以全端口速度实现的。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sq/gi/-n/sqgi-nmjhretaxt79qv6iv_uhye.png" alt="图片"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN490242/index.html">SIM800x模块的GSM定位服务及其与Yandex.Locator API的配合</a></li>
<li><a href="../zh-CN490244/index.html">使用ctypes的Python代码优化</a></li>
<li><a href="../zh-CN490246/index.html">九头蛇拥抱克里姆林宫塔：九头蛇2020并行和分布式计算会议</a></li>
<li><a href="../zh-CN490248/index.html">网络研讨会“ Winnum CNC：有效的监控”</a></li>
<li><a href="../zh-CN490250/index.html">恐怖设定全部移除</a></li>
<li><a href="../zh-CN490254/index.html">模糊数学。模糊集的基础</a></li>
<li><a href="../zh-CN490260/index.html">新存储技术：2020年是否有突破？</a></li>
<li><a href="../zh-CN490262/index.html">3D打印：从CAD模型移至打印对象的快速提示</a></li>
<li><a href="../zh-CN490264/index.html">针对EDMS移动应用程序示例组织自动测试</a></li>
<li><a href="../zh-CN490266/index.html">用英语发誓，他们不会为此打败（但这并不准确）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>