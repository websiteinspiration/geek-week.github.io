<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌘 🙅🏻 🥞 Automatisation d'appartement 👨🏽‍🤝‍👨🏻 🤳🏽 🤜🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Contexte
 Le vieux rêve de l'automatisation des appartements a commencé sa transformation en réalité en achetant un appartement dans un nouveau bâtime...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Automatisation d'appartement</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506558/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contexte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le vieux rêve de l'automatisation des appartements a commencé sa transformation en réalité en achetant un appartement dans un nouveau bâtiment. </font><font style="vertical-align: inherit;">Déjà au stade de la planification des réparations, les principales exigences pour les réseaux de services publics sont apparues:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contrôle flexible de l'éclairage, de l'alimentation en eau, de la ventilation, du chauffage et des charges électriques;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la possibilité de mettre en œuvre des scénarios;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">télécommande et notification;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arrêt centralisé de tout l'éclairage;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arrêt centralisé des charges non prioritaires et de l'approvisionnement en eau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à l'avenir - la possibilité de commande vocale.</font></font></li>
</ol><a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Électricien</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que pour moi l'option de contrôle la plus fiable est un circuit filaire, la mise en œuvre de l'idée, il a été décidé de commencer par la modification de l'électricité. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon le projet du développeur, toutes les charges ont été réparties en 4 groupes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaudière;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éclairage;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sorties de cuisine et de couloir;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tout le reste.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toute l'automatisation modulaire était située dans le plancher, 4 câbles sont entrés dans l'appartement - 2 3x2,5 mm2 et 2 3x1,5 mm2, ce qui ne répondait pas à mes besoins. </font><font style="vertical-align: inherit;">Il a été décidé de tirer le câble du panneau de plancher et de transférer le standard directement dans l'appartement. </font><font style="vertical-align: inherit;">En conséquence, un compteur et un disjoncteur d'introduction pour 40A sont restés dans le panneau de plancher, puis un câble de 3x6 mm2 vers le panneau de l'appartement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la conception d'un panneau d'appartement, les exigences suivantes ont été prises en compte:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protection contre les surtensions;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">charge prioritaire (non déconnectable);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">charge non prioritaire (déconnectée);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protection différentielle sur les groupes «dangereux» (tout ce qui fonctionne dans des pièces humides, tout ce qui est lié à l'eau et tout ce que les enfants peuvent atteindre).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, le schéma suivant a émergé:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/aj/ho/ue/ajhoueqw41w1cblhjxspipmvilm.png" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les charges ont été divisées en groupes déconnectables et non déconnectables. </font><font style="vertical-align: inherit;">Les groupes non déconnectables comprennent: l'alimentation électrique du réfrigérateur, de la chaudière, de l'armoire à courant faible et du contrôleur. </font><font style="vertical-align: inherit;">Le groupe déconnecté, auquel appartiennent toutes les autres charges, est alimenté par un disjoncteur et un contacteur communs, qui seront contrôlés par des signaux du contrôleur, et nous capterons également le signal d'état du contacteur au contrôleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour accueillir toute l'automatisation modulaire nécessaire, un blindage intégré pour 72 modules a été choisi (comme il s'est avéré plus tard - il n'y a pas beaucoup d'espace dans le blindage). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le processus de refonte complète des électriciens à l'intérieur de l'appartement a commencé. </font><font style="vertical-align: inherit;">Parmi les caractéristiques - les chemins de câbles de toutes les sources de lumière et interrupteurs ont été directement introduits dans le panneau de l'appartement.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatisation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que dans ma pratique, je devais m'occuper d'automatisation industrielle, diverses options pour PLC et PLR de Siemens, ABB, Schneider-Electric, Aries, etc. ont été considérées comme des dispositifs de contrôle. </font><font style="vertical-align: inherit;">En conséquence, le choix s'est porté sur le relais logique programmable ONI PLR (PLR-S-CPU-1004R-AC-BE, en outre, par souci de concision, le contrôleur). </font><font style="vertical-align: inherit;">Pourquoi exactement:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bus RS-485 intégré avec prise en charge du protocole Modbus;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sorties discrètes implémentées sous forme de relais de 3 et 10 ampères;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alimentation à partir de 220V; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tailles compactes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">facteur de forme pour le montage sur un rail DIN;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la présence d'un écran et de commandes directement sur le boîtier;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prix.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme 10 entrées numériques et 4 sorties relais ne suffisaient pas, en plus de l'unité principale, deux modules d'extension avec 8 entrées numériques, 4 sorties relais 3A, 4 sorties relais 10A ont été sélectionnés. </font><font style="vertical-align: inherit;">Le développement de ce relais s'effectue à l'aide du langage de diagramme fonctionnel (FBD).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Approvisionnement en eau</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le constructeur a vendu l'alimentation en eau de l'appartement de manière à ce qu'il y ait 3 colonnes montantes d'eau froide dans l'appartement. </font><font style="vertical-align: inherit;">Parce que </font><font style="vertical-align: inherit;">Étant donné que l'eau chaude est préparée dans une chaudière à gaz, pour couper complètement l'eau, par exemple dans la salle de bain, il est nécessaire de bloquer à la fois la colonne montante dans la salle de bain et la colonne montante dans la cuisine, à partir de laquelle la chaudière est alimentée. </font><font style="vertical-align: inherit;">Sur cette base, pour contrôler l'approvisionnement en eau et en tant que système de protection contre les fuites, 3 ensembles de serrures hydrauliques (entraînements et capteurs auto-alimentés), qui ont la capacité de combiner une commande externe centralisée en un seul système, ainsi que de recevoir un signal sur le fonctionnement des capteurs de fuite. </font><font style="vertical-align: inherit;">Un câble STP a été connecté à l'emplacement d'installation de chaque lecteur depuis le panneau de l'appartement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Robinet à boisseau sphérique monté avec actionneur:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/a1/ul/oc/a1ulocy0gp7iy1wpjhdzi_d4fag.png" alt="image"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sélection du logiciel de gestion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parce que </font><font style="vertical-align: inherit;">Je suis un utilisateur de divers gadgets Samsung, en tant que plate-forme logicielle de gestion, j'ai décidé de rester sur le logiciel SmartThings, qui prend en charge l'intégration via un connecteur cloud. </font><font style="vertical-align: inherit;">Pour connecter ONI PLR à SmartThings Cloud, vous devrez développer un serveur OPC et CloudConnector. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'avenir, l'intégration avec un modem GSM est prévue comme canal de contrôle de secours, ainsi que pour la notification d'urgence des situations d'urgence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, le diagramme suivant de l'interaction des composants du système a émergé:</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/me/am/eg/meameg3yhqclqqe6m3glbkjuvkg.png" alt="image"></div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la mise en oeuvre</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus gros problème à ce stade était la fourniture de composants, </font><font style="vertical-align: inherit;">le début du travail a coïncidé avec le début de la période d'auto-isolement. </font><font style="vertical-align: inherit;">Et comme le temps de réparation de l'appartement était très limité, tout le rembourrage du bouclier devait être récupéré par 5 fournisseurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les câbles nécessaires ont été posés autour de l'appartement, introduits dans le bouclier et marqués en conséquence. </font><font style="vertical-align: inherit;">Le résultat intermédiaire peut être vu sur la photo ci-dessous:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zi/23/en/zi23en4sgef8kzorqyyavsyfz38.png" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour réaliser la possibilité d'un contrôle d'éclairage habituel directement à partir des pièces, des interrupteurs standard à une ou deux touches avec une position non sécurisée ont été utilisés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La connexion des interrupteurs et des charges au contrôleur a été effectuée selon le schéma suivant:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bi/mr/on/bimrontj12po6p3cvftv2qtt1la.png" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commutateurs</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gg/zj/yj/ggzjyjcktctegzkyknlgorzhilc.png" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la mise en service et du débogage du contrôleur, des retards étranges de 0,5 à 1 seconde ont été constatés lors de la mise sous / hors tension des sorties de relais situées dans les modules d'extension. </font><font style="vertical-align: inherit;">Le problème s'est avéré très courant - étude inattentive des manuels. </font><font style="vertical-align: inherit;">Avant la connexion, il était nécessaire de définir les adresses des modules d'extension avec des commutateurs DIP, dès que cela était fait, le contrôleur fonctionnait comme une horloge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actuellement, le bouclier assemblé à l'intérieur est le suivant:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/z0/ms/e3/z0mse3wc4hbhqlylva1-7zhxnii.png" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actuellement implémenté les fonctions suivantes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande d'éclairage à partir d'interrupteurs, pour un certain nombre de pièces - à partir de plusieurs endroits;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scénarios simples avec activation automatique de la ventilation dans les pièces à forte humidité (jusqu'à présent sans capteurs appropriés, uniquement sur la base de scénarios comportementaux typiques, basés sur le temps passé par les personnes dans les pièces);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arrêt général de l'éclairage (interrupteur séparé);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arrêt forcé de l'approvisionnement en eau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arrêt de l'approvisionnement en eau lorsque les capteurs sont mouillés.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un futur proche, mise en place d'une interaction avec l'écosystème SmartThings, mise en place de scénarios de travail plus complexes. </font><font style="vertical-align: inherit;">À l'heure actuelle, les travaux de finition sont en cours d'achèvement, la mise en œuvre de la partie programme du projet est prévue après le déménagement.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr506530/index.html">Comment choisir un UPS</a></li>
<li><a href="../fr506532/index.html">À travers les épines jusqu'aux étoiles: fabriquez un appareil pour pointer un pointeur laser sur n'importe quel objet céleste</a></li>
<li><a href="../fr506538/index.html">Comment Wikipédia peut révéler vos données personnelles et comment il les utilise réellement</a></li>
<li><a href="../fr506542/index.html">Enregistrement vidéo bricolage dans le cloud</a></li>
<li><a href="../fr506548/index.html">Utilisation pratique de Kotlin dans les startups et les entreprises</a></li>
<li><a href="../fr506560/index.html">Ce qu'il faut écouter le week-end: 5 numéros sélectionnés du podcast en russe sur la technologie audio</a></li>
<li><a href="../fr506562/index.html">Pourquoi est-il préférable de compiler TS dans JS à l'avance</a></li>
<li><a href="../fr506568/index.html">Niveaux et moments d'évaluation du projet</a></li>
<li><a href="../fr506570/index.html">FizzBuzz fonctionnel sur Scala</a></li>
<li><a href="../fr506572/index.html">Création d'un prototype de boutique en ligne SPA sur htmlix.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>