<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤦🏿 ⏸️ 🔫 使用Keras，TensorFlow和深度学习检测X射线中的COVID-19 🔆 🔗 ⛎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在本指南的帮助下，在Keras，TensorFlow和深度学习的帮助下，我们将学习如何从X射线图像的手动组装数据集中自动确定COVID-19。
 
 像许多其他人一样，我真诚地担心COVID-19。我注意到我一直在分析自己的病情，想知道我是否会传染这种疾病以及何时会发生。而且我越担心，它就越会变成痛...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>使用Keras，TensorFlow和深度学习检测X射线中的COVID-19</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/493614/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/bt/gn/albtgnkhy92l7fzrjmwpm6fdu4o.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本指南的帮助下，在Keras，TensorFlow和深度学习的帮助下，我们将学习如何从X射线图像的手动组装数据集中自动确定COVID-19。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
像许多其他人一样，我真诚地担心COVID-19。</font><font style="vertical-align: inherit;">我注意到我一直在分析自己的病情，想知道我是否会传染这种疾病以及何时会发生。</font><font style="vertical-align: inherit;">而且我越担心，它就越会变成痛苦的心理游戏，在这种游戏中，症状学与下软骨症相结合：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我早上醒来，感到有些酸痛和无力。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当我爬下床时，我发现了流鼻涕（尽管</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经知道</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">流鼻涕</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19的症状）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到我去洗手间拿纸巾的时候，我已经咳嗽了。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
刚开始我没有特别注意-我对花粉过敏，由于美国东海岸的温暖天气，今年春天是早春。</font><font style="vertical-align: inherit;">这些很可能是过敏症状。</font><font style="vertical-align: inherit;">但是白天我的状况没有改善。</font><font style="vertical-align: inherit;">我坐着，用嘴里的温度计写这本手册。</font><font style="vertical-align: inherit;">我往下看，看到37.4°C。</font><font style="vertical-align: inherit;">我的正常体温略低于其他人，为36.3°C。</font><font style="vertical-align: inherit;">对我来说，高于37.2°C的一切都已经有点热了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
咳嗽和轻微发烧？</font><font style="vertical-align: inherit;">可能是COVID-19，或者只是我的过敏。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有测试就不可能发现，正是这种“无知”使这种情况在人的层面上如此令人生畏。</font></font></strong><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不明飞行物护理分钟</font></font></h3><br>
     COVID-19 —     ,   SARS-CoV-2 (2019-nCoV).        —    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管有我的恐惧，我还是尝试理性地思考。我30岁多一点，身体状况很好，免疫力很强。我将隔离自己（以防万一），休息并处理所有事情。从</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">个人</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康</font><font style="vertical-align: inherit;">的角度来看，COVID-19并没有吓到我</font><font style="vertical-align: inherit;">（至少我会为我自己站起来）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我担心我的老年亲戚，包括所有已经被诊断出患有这种疾病的人，以及在疗养院和医院中的人。这些人很脆弱，如果死于COVID-19，这将是可怕的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我决定不做任何事情而让自己的病使我呆在家里（无论是过敏，COVID-19还是我的恐惧），我决定做我能做的：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我将编写代码，进行实验，并使用实际示例教其他人如何使用计算机视觉和深度学习</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我必须马上说，这</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我写</font><i><font style="vertical-align: inherit;">的</font></i><font style="vertical-align: inherit;">最科学的文章。</font><font style="vertical-align: inherit;">她一点都不科学。</font><font style="vertical-align: inherit;">所使用的方法和数据集</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值得发布。</font><font style="vertical-align: inherit;">但是对于那些至少想要</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一些</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">帮助的</font><font style="vertical-align: inherit;">人来说，它们是一个起点</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我担心您和这个社区。</font><font style="vertical-align: inherit;">我想提供我所能提供的帮助：这篇文章是我在精神上应付困难时期的方法，同时可以帮助处于类似情况的其他人。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本指南中，您将学习：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何收集检测到COVID-19的患者的X射线图像的开源数据集。</font></font></li>
<li>   «» (  )    .</li>
<li>      COVID-19      .</li>
<li>      .</li>
</ol><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我已经暗示过这一点，但是现在我直接说。</font><font style="vertical-align: inherit;">此处描述的技术仅用于教育目的。</font><font style="vertical-align: inherit;">这</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">严格的科学研究；不会在期刊上发表。</font><font style="vertical-align: inherit;">本文面向对计算机视觉和深度学习感兴趣，希望在实践中学习的读者以及受时事启发的读者。</font><font style="vertical-align: inherit;">我请你考虑所有这些。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在手册的第一部分中，我们将讨论如何在肺部X射线中检测COVID-19。</font><font style="vertical-align: inherit;">然后，我们讨论数据集本身。</font><font style="vertical-align: inherit;">然后，我将展示如何使用Keras和TensorFlow训练模型以预测图像中的COVID-19。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这篇COVID-19自动检测文章仅用于教育目的。它</font></font></strong><i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有</font></font></strong></i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述可靠且准确的诊断系统COVID-19，也没有从专业人士或学术角度进行过测试。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我的目标是激发您的灵感，并展示对计算机视觉和深度学习的研究以及在医学领域的后续应用如何对世界产生重大影响。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
想象一下：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您不需要医学教育就能影响医学</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。如今，接受深度培训的从业人员与医生及其他医生紧密合作，共同解决复杂问题，挽救生命并让世界变得更加美好。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我希望我的领导能激励您这样做。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是考虑到以上所有因素，研究人员，杂志策展人和评论系统已经不胜枚举描述COVID-19可疑质量预测模型的作品。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请不要将本文的代码和模型发送给期刊或某些科学出版物，否则只会增加混乱</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，如果您想根据本文（或任何其他有关COVID-19的出版物）进行研究，请遵循</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRIPOD指南来描述预测模型。</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如您所知，在医学领域使用人工智能会产生非常严重的后果。仅当您是医学专家或得到专家的详细建议时，才发布和使用此类模型。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何在X射线中检测到COVID-19？</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/8bd/a46/dbb8bda4650156ba71b79b0db4309738.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图1：</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">诊断为COVID-19的患者的X射线示例。</font><font style="vertical-align: inherit;">在这些图像中，您可以使用Keras和TensorFlow教授分类器以确定COVID-19。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在很难对COVID-19进行测试-</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有足够的测试</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是不可能快速生成它们，这只会增加恐慌。</font><font style="vertical-align: inherit;">惊慌失措的是，有一些流氓企图利用他人的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">钱赚钱</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">在COVID-19上出售假测试</font></a><font style="vertical-align: inherit;">，</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">发现自己在社交网络和即时通讯工具中毫无戒心。</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
鉴于测试数量有限，我们需要依靠其他诊断方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我决定研究X射线，因为医生经常使用X射线和计算机断层扫描结果来诊断肺炎，肺部炎症，脓肿和淋巴结肿大。由于该病毒攻击呼吸道的上皮细胞，因此我们可以使用X射线研究人肺的状况。而且，由于X射线机几乎无处不在，使用图像您可以在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测试套件的</font><i><font style="vertical-align: inherit;">情况下</font></i><font style="vertical-align: inherit;">检测到COVID-19 </font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该方法的缺点包括需要放射科医生以及大量的处理时间。当世界各地的人们生病时，时间特别昂贵。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了节省医生的时间，您需要创建一个自动分析系统</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></strong></i><i>    ,   ,    COVID-19    .        .  ,  </i><i><strong></strong></i><i> ,  ,   ,     COVID-19,   .</i><br>
<br>
<h3>    COVID-19</h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e99/03e/e2a/e9903ee2a07ec44819bb4821671401fa.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图2：</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左侧是阳性结果（被感染）的图片，右侧是阴性结果。</font><font style="vertical-align: inherit;">在这些图像中，我们将讲授使用TensorFlow和Keras的模型来自动预测COVID-19的存在（即冠状病毒引起的疾病）。</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在蒙特利尔大学的研究生</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"> Joseph Cohen博士</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
的指导下，将此处使用的与COVID-19一起使用的患者图像数据集进行了编译</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">几天前，Cohen开始收集COVID-19患者的X射线图像，并将其上传</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">到GitHub存储库。</font></a><font style="vertical-align: inherit;">在这里，您不仅可以找到这种疾病的例子，还可以找到MERS，SARS和ARDS的例子。</font><font style="vertical-align: inherit;">
要创建数据集，请执行以下操作：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从存储库中解析metadata.csv文件。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择所有行：</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
总共获得</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25张照片</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><strong><font style="vertical-align: inherit;">在COVID-19上</font></strong><font style="vertical-align: inherit;">获得</font><strong><font style="vertical-align: inherit;">了阳性结果</font></strong><font style="vertical-align: inherit;">（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在选择健康人的照片。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
为此，我</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">采集</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Kaggle的肺部X射线数据集（肺炎），</font></a><font style="vertical-align: inherit;">并选择了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25张健康人的图像</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">右</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。该数据集有很多缺点，包括标签填充不正确或不正确，但是它适合作为测试COVID-19检测器假设的起点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，我得到了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50次注射：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 25例COVID-19患者和25例健康患者。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从</font></font></strong><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong><font style="vertical-align: inherit;">链接</font></strong></a><strong><font style="vertical-align: inherit;">下载数据集</font></strong></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong><font style="vertical-align: inherit;"></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">另外，我添加了用于生成数据集的Python脚本，但是在本文中我没有考虑它们。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目结构</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下载代码和数据。</font><font style="vertical-align: inherit;">从那里拉出文件，您将获得以下目录结构：</font></font><br>
<br>
<pre><code class="python hljs">$ tree --dirsfirst --filelimit <span class="hljs-number">10</span><font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [<span class="hljs-number">25</span> entries]<font></font>
│   └── normal [<span class="hljs-number">25</span> entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
三个目录，五个文件。</font><font style="vertical-align: inherit;">数据集位于数据集/目录中，分为两类-covid /和normal /。</font><font style="vertical-align: inherit;">下面我们看一下训练COVID-19检测器的train_covid19.py脚本。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">训练脚本实施</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们继续微调卷积神经网络，它将使用Keras，TensorFlow和深度学习自动诊断COVID-19。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
打开train_covid19.py文件并粘贴以下代码：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该脚本通过选择tensorflow.keras导入来利用TensorFlow 2.0和Keras库。</font><font style="vertical-align: inherit;">我们也使用：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事实上的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python机器学习库，</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于制图，</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于上传和预处理数据集中的图像。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要了解如何安装TensorFlow 2.0（包括scikit-learn，OpenCV和matplotlib），请查看我的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教程</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们解析命令行的参数并初始化超参数：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
    help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的三个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行参数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第24-31行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）包括：</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：输入数据集的路径。</font></font></li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：学习历史记录退出时间表的可选路径。</font><font style="vertical-align: inherit;">默认情况下，该图形称为plot.png，除非在命令行上指定了其他名称。</font></font></li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：输出COVID-19定义模型的可选路径。</font><font style="vertical-align: inherit;">默认情况下，它称为covid19.model。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们初始化初始学习频率，训练时代数和数据包大小超参数（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第35-37行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，下载并预处理X射线：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
    <span class="hljs-comment"># extract the class label from the filename</span>
    label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]<font></font>
<font></font>
    <span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
    <span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
    image = cv2.imread(imagePath)<font></font>
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
    image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))<font></font>
<font></font>
    <span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
    data.append(image)<font></font>
    labels.append(label)<font></font>
<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span><font></font>
labels = np.array(labels)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要加载数据，我们采用--dataset目录（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第42行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中</font><font style="vertical-align: inherit;">所有图像的路径</font><font style="vertical-align: inherit;">，然后为每个imagePath：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们从路径（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第49行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中</font><font style="vertical-align: inherit;">提取</font><font style="vertical-align: inherit;">类标签（共阴或普通）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们加载图像，将其转换为RGB通道，并将其缩小为224x224像素，以馈送卷积神经网络（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第53-55行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新数据和标签列表（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第58和59行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，我们将像素强度缩放到一个范围</font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并将数据和标签转换为NumPy数组格式（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第63和64行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们将对标签执行一次热编码，并将数据集分为训练集和测试集：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels); print(labels)<font></font>
<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
    test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
    rotation_range=<span class="hljs-number">15</span>,<font></font>
    fill_mode=<span class="hljs-string">"nearest"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
统一标签编码在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第67-69行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">：数据将以以下格式显示：</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以这种方式编码的每个标签都包含一个由两个元素组成的数组，其中一个元素为“ hot”（1），第二个元素为“ no”（0）。在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第73和74行中，</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据集分为两个部分：80％用于训练，20％用于测试。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了概括该模型，我们执行</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据扩展</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（数据增强），将图像随机旋转设置为顺时针旋转15度或对其进行抵消。扩展生成对象在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第77-79行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在初始化VGGNet模型并准备进行</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">微调</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
    input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))<font></font>
<font></font>
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)<font></font>
<font></font>
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
    layer.trainable = <span class="hljs-literal">False</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第83和84行中</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，使用预先在ImageNet上获得的权重（没有完全连接的层）创建了VGG16神经网络的实例。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们将创建一个由POOL =&gt; FC = </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SOFTMAX</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">层组成的完全连接的层（</font><strong><font style="vertical-align: inherit;">第88-93行</font></strong><font style="vertical-align: inherit;">），并将其放置在VGG16的顶部（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第97行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在冻结CONV权重，以便</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">训练</font><font style="vertical-align: inherit;">完全连接的图层（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第101-102行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。调整完成。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们准备编译和训练我们的深度学习模型：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
    metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
    trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
    steps_per_epoch=len(trainX) // BS,<font></font>
    validation_data=(testX, testY),<font></font>
    validation_steps=len(testX) // BS,<font></font>
    epochs=EPOCHS)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第106-108行中，</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编制了网络</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">衰减速度训练</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和优化器Adam。鉴于这是两类分类任务，我们使用二进制交叉熵（binary_crossentropy）的损失函数，而不是分类交叉熵（类别交叉熵）的损失函数。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要开始训练，我们将其称为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -technique </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">fit_generator，</font></a><font style="vertical-align: inherit;">并通过数据对象扩展名（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第112-117行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">为他提供X射线</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在让我们评估模型：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
    target_names=lb.classes_))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为此，我们首先基于测试套件执行预测并获得预测索引（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第121-125行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">然后，我们将使用scikit-learn实用工具生成并显示分类报告（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第128和129行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，让我们计算混淆矩阵，以便将来进行统计估计：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])<font></font>
<font></font>
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们在这儿：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成不准确性矩阵（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第133行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们使用此矩阵确定准确性，敏感性和特异性（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第135-137行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），然后得出所有这些指标（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第141-143行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，为了进行后续分析，我们以图形形式在文件中显示准确性和损失的变化历史：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，我们将tf.keras分类器模型序列化到磁盘：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们使用Keras和TensorFlow训练我们的探测器</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在执行train_covid19.py脚本之后，我们可以训练自动检测器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下载源代码，数据集和预训练的模型。</font><font style="vertical-align: inherit;">打开终端并运行命令来训练检测器：</font></font><br>
<br>
<pre><code class="python hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch <span class="hljs-number">1</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">20</span>s <span class="hljs-number">4</span>s/step - loss: <span class="hljs-number">0.7169</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.6590</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">2</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">86</span>ms/step - loss: <span class="hljs-number">0.8088</span> - accuracy: <span class="hljs-number">0.4250</span> - val_loss: <span class="hljs-number">0.6112</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">3</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.6809</span> - accuracy: <span class="hljs-number">0.5500</span> - val_loss: <span class="hljs-number">0.6054</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">4</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">100</span>ms/step - loss: <span class="hljs-number">0.6723</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.5771</span> - val_accuracy: <span class="hljs-number">0.6000</span><font></font>
...<font></font>
Epoch <span class="hljs-number">22</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3271</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2902</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">23</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3634</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2690</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">24</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">27</span>s <span class="hljs-number">5</span>s/step - loss: <span class="hljs-number">0.3175</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2395</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">25</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">101</span>ms/step - loss: <span class="hljs-number">0.3655</span> - accuracy: <span class="hljs-number">0.8250</span> - val_loss: <span class="hljs-number">0.2522</span> - val_accuracy: <span class="hljs-number">0.9000</span><font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
<font></font>
       covid       <span class="hljs-number">0.83</span>      <span class="hljs-number">1.00</span>      <span class="hljs-number">0.91</span>         <span class="hljs-number">5</span>
      normal       <span class="hljs-number">1.00</span>      <span class="hljs-number">0.80</span>      <span class="hljs-number">0.89</span>         <span class="hljs-number">5</span><font></font>
<font></font>
    accuracy                           <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
   macro avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
weighted avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span><font></font>
<font></font>
[[<span class="hljs-number">5</span> <span class="hljs-number">0</span>]<font></font>
 [<span class="hljs-number">1</span> <span class="hljs-number">4</span>]]<font></font>
acc: <span class="hljs-number">0.9000</span>
sensitivity: <span class="hljs-number">1.0000</span>
specificity: <span class="hljs-number">0.8000</span>
[INFO] saving COVID<span class="hljs-number">-19</span> detector model...
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动X射线诊断</font></font></h3><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本部分中，我们不会“解决”确定COVID-19的问题。它是在当前情况下编写的，仅用于教育目的。这是计算机视觉和深度学习的实际应用示例，因此您可以适应不同的指标，包括通常的准确性，敏感性和特异性（以及处理医学数据时必须考虑的权衡）。我再说一遍，我们</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能解决</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确定COVID-19 </font><strong><font style="vertical-align: inherit;">的</font></strong><font style="vertical-align: inherit;">问题。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
因此，我们的自动检测器</font><i><font style="vertical-align: inherit;">仅</font></i><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">X射线图像</font><font style="vertical-align: inherit;">样本上</font><font style="vertical-align: inherit;">显示的精度</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">约为90-92％</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。没有其他信息用于训练模型，包括地理位置，人口密度等。</font><font style="vertical-align: inherit;">
我们还收到了</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">敏感性为100％</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特异性为80％</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这意味着：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这些患者中</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19（真阳性病例），利用该模型，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们能够准确地识别为案件100％“COVID-19阳性”。</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19阴性</font><font style="vertical-align: inherit;">的患者</font><font style="vertical-align: inherit;">（真正的阴性病例）中，使用该模型，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们仅能将80％的病例准确地识别为“ COVID-19阴性”。</font></font></strong></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如训练历史图所示，尽管</font><font style="vertical-align: inherit;">训练数据的大小</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常小</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但并未对神经网络进行再</font><font style="vertical-align: inherit;">训练：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/566/c90/eb8/566c90eb8e4b35dd1d5c5293e90084f6.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图3：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此准确性和损失图表明我们的模型未经过重新训练。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我们在检测COVID-19时达到了100％的准确性，这非常好。但是，真正消极情况的情况令人尴尬：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们不想将实际上是“ COVID-19阳性”的人归因于“ COVID-19阴性”。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我们最不希望让患病的患者与家人和朋友一起回家，为疾病的进一步传播做出贡献。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还需要</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常小心</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假阳性病例：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们不想误认为某人有病，并将其与其他患者隔离，以使他被其他人感染</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在敏感性和特异性之间找到平衡-</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是一项极为艰巨的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务，尤其是在药物方面，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尤其是</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在迅速传播传染病方面。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在谈到医疗计算机视觉和深度学习时，您应该始终记住，我们的预测模型可能会产生非常严重的后果：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误的诊断可能会导致生命损失</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我再说一遍，本文中的结果</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅供参考</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这不是期刊出版物，该数据不符合</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">发布预测模型</font></a><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">TRIPOD</font></a><font style="vertical-align: inherit;">标准</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">局限性，改进和进一步工作</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/032/a41/702032a4173717d7cc9fddb00d67ee27.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图4：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如今，人工智能和深度学习专业人员缺乏高质量的COVID-19数据来有效地训练自动图像识别系统。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
本手册中描述的方法的主要限制之一是数据。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们没有足够的（可靠）数据来训练COVID-19检测器。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
医院已经有许多关于这种病毒的病史，但是鉴于隐私和人权，从医学图像快速组装高质量数据集变得更加困难。我相信在接下来的12-18个月中，我们将获得更多质量数据。但是就目前而言，您必须使用现有的东西。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我尝试在有限的时间和资源条件下（考虑到我的身体和精神状况）为有兴趣使用计算机视觉和深度学习的人编写本指南。但是，请</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许我</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提醒您，</font><strong><font style="vertical-align: inherit;">我不是专业医生</font></strong><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了在现实生活中使用COVID-19检测器，必须</font><font style="vertical-align: inherit;">由与深度学习专家携手合作的真正医生</font><font style="vertical-align: inherit;">进行</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">严格的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测试。我描述的方法不适用于此方法。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此外，必须谨慎对待模型“学习”的内容。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
正如我在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Grad-CAM手册中</font></a><font style="vertical-align: inherit;">所写</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该模型很可能会学习与COVID-19不相关的模式，但只能区分两个数据样本（即阳性和阴性诊断）。我们检测器的结果将需要由医生严格测试和检查。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，未来的（和更高级的）检测器将是多峰的。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
现在，我们仅使用视觉数据（X射线）。更好的检测器应使用其他数据：患者生命指标，人口密度，地理位置等。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅凭视觉数据通常不足以满足此类任务</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于这些原因，我想再次强调：本指南仅起培训材料的作用-不能视为可靠的COVID-19检测器。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您认为自己或接近COVID-19的人，请遵循医疗保健系统的建议。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
希望本指南对您有所帮助。</font><font style="vertical-align: inherit;">我也希望这对某人来说是寻找使用计算机视觉和深度学习自动确定COVID-19的方法的起点。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摘要</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本指南中，您学习了如何使用Keras，TensorFlow和深度学习在X射线图像的数据集上创建COVID-19自动检测器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
到目前为止，该疾病还没有高质量且经过验证的图像数据集，因此您必须使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joseph Cohen存储库</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们从他的</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据集中</font><strong><font style="vertical-align: inherit;">拍摄了25张图像，</font></strong><font style="vertical-align: inherit;">将自己局限于正向诊断病例的前后投影。</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，我们</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Kaggle胸部X射线图像（肺炎）数据集中</font></a><strong><font style="vertical-align: inherit;">拍摄了25 </font></strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">张健康</font></a><strong><font style="vertical-align: inherit;">人</font></strong><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">照片。</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后在Keras和TensorFlow的帮助下，我们训练了COVID-19检测器，该检测器</font><font style="vertical-align: inherit;">在我们的测试样品上</font><font style="vertical-align: inherit;">显示出</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90-92％</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><strong><font style="vertical-align: inherit;">准确度，</font></strong><font style="vertical-align: inherit;">灵敏度为100％，特异性为80％（在我们的小型数据集上）。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请记住，此处描述的检测器仅用于教育目的（请参见文本中的注释）。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我想激发其他人使用深度学习，以表明将其与计算机视觉结合可以</font><font style="vertical-align: inherit;">对我们的生活</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生重大影响</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我希望你喜欢它。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN493596/index.html">那个不急的人</a></li>
<li><a href="../zh-CN493598/index.html">隐藏电话号码的一部分</a></li>
<li><a href="../zh-CN493604/index.html">3月23日至29日在莫斯科举行的数字活动</a></li>
<li><a href="../zh-CN493606/index.html">创建具有赛博朋克风格的云服务的历史</a></li>
<li><a href="../zh-CN493610/index.html">使用DispmanX API在Raspberry Pi中编程视频层</a></li>
<li><a href="../zh-CN493616/index.html">像盒子一样的图片-里面有什么？Yandex中的报告</a></li>
<li><a href="../zh-CN493618/index.html">（不是）Twitter上明显的OSINT</a></li>
<li><a href="../zh-CN493620/index.html">逻辑曲线。流行病何时结束？</a></li>
<li><a href="../zh-CN493622/index.html">向Angular编写Retrowave</a></li>
<li><a href="../zh-CN493626/index.html">Selenoid-数以百计的并行UI测试轻松快速。帕维尔·塞宁</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>