<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äçüé§ üï∫üèæ üé¥ STM32MP1: U-Boot, Buildroot, Arch Linux et un peu de Debian üçê üîû üéπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! 
 
 Il y a quelque temps, STMicroelectronics a lanc√© d'int√©ressants processeurs de la s√©rie STM32MP1. Lorsque j'ai enfin mis la main su...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>STM32MP1: U-Boot, Buildroot, Arch Linux et un peu de Debian</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503600/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a quelque temps, STMicroelectronics a lanc√© d'int√©ressants processeurs de la s√©rie STM32MP1. </font><font style="vertical-align: inherit;">Lorsque j'ai enfin mis la main sur la carte de d√©bogage bas√©e sur ce processeur, j'ai √©t√© surpris de constater qu'il ne manque aucune version bas√©e sur des distributions populaires (Debian, Arch Linux, etc.). </font><font style="vertical-align: inherit;">Il ne restait plus qu'√† essayer d'adapter vous-m√™me un kit de distribution pour cette carte. </font><font style="vertical-align: inherit;">Sur la base des r√©sultats de cela, cet article est apparu.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ws/zo/9c/wszo9cao_bq-m_5z9q9fk8moxls.jpeg"><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelles en sont les caract√©ristiques?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet article ne serait pas complet sans au moins un bref aper√ßu des caract√©ristiques des processeurs de la s√©rie STM32MP1. </font><font style="vertical-align: inherit;">Il existe trois familles de processeurs dans la s√©rie STM32MP1: STM32MP151, STM32MP153 et STM32MP157. </font><font style="vertical-align: inherit;">Leurs principales caract√©ristiques sont donn√©es dans le tableau. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rf/ez/9u/rfez9ud26bcli38_4juxyx-byya.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir dans le tableau, la diff√©rence entre les familles est que STM32MP151 a un c≈ìur Cortex-A7, tandis que STM32MP153 et STM32MP157 ont deux c≈ìurs de ce type, et STM32MP157 a √©galement un support GPU 3D. </font><font style="vertical-align: inherit;">Mais en g√©n√©ral, les caract√©ristiques de ces processeurs en 2020 ne font aucune impression, elles sont plut√¥t modestes. </font><font style="vertical-align: inherit;">Pourquoi ai-je encore fait attention √† eux?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi STM32MP1?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En effet, une question tout √† fait logique peut se poser: y a-t-il un Raspberry Pi, il y a un Banana Pi, il y a un Orange Pi, et enfin - pourquoi avons-nous besoin d'un autre STM32MP1? </font><font style="vertical-align: inherit;">De plus, toutes ces cartes ont g√©n√©ralement des performances significativement plus √©lev√©es que l'objet de notre √©tude. </font><font style="vertical-align: inherit;">La r√©ponse est simple - pendant que vous faites de l'artisanat pour un usage domestique, c'est que vous devez prendre la framboise et ce sera juste. </font><font style="vertical-align: inherit;">Mais si nous parlons de produits fabriqu√©s en s√©rie pour des applications industrielles - ici, d'autres choses commencent √† jouer un r√¥le d√©cisif, gr√¢ce auquel le STM32MP1 est le gagnant:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plage de temp√©rature de fonctionnement. </font><font style="vertical-align: inherit;">Pour STM32MP1, il commence √† moins 40 degr√©s, tandis que pour de nombreux processeurs d'autres ordinateurs √† carte unique, il est bon s'il est de moins 20.</font></font></li>
<li>  .  STMicroelectronics      ,            .</li>
<li>      .   DigiKey  Mouser       STM32MP1,           .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien entendu, le ST32MP1 n'est pas le seul processeur du march√© pour les applications industrielles. </font><font style="vertical-align: inherit;">Il existe √† la fois NXP et TI. </font><font style="vertical-align: inherit;">Quant √† TI, j'avais un projet de module plut√¥t complexe bas√© sur celui-ci, et il y avait un s√©diment provenant d'un nombre notable de fonctionnalit√©s mat√©rielles qui n'√©taient pas couvertes dans la documentation, mais s'il n'√©tait pas respect√©, le processeur pourrait compl√®tement √©chouer, et pas imm√©diatement, mais avec le temps et au moment le plus inopportun. </font><font style="vertical-align: inherit;">De plus, il s'agissait d'un processeur monoc≈ìur, et avec l'augmentation du nombre de t√¢ches qui lui √©taient assign√©es, des probl√®mes de performances se posaient de plus en plus souvent. </font><font style="vertical-align: inherit;">En m√™me temps, je faisais affaire avec des microcontr√¥leurs STMicroelectronics, et ils se sont av√©r√©s assez bons, alors j'ai d√©cid√© d'essayer de choisir ce nouveau petit.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carte de d√©bogage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les exp√©riences, j'ai achet√© une carte de d√©bogage STM32MP157A-DK1. </font><font style="vertical-align: inherit;">Cette carte est plut√¥t modeste en termes d'√©quipement: elle n'a pas d'√©cran LCD comme le STM32MP157C-DK2 ou un p√©riph√©rique aussi riche que le STM32MP157A-EV1. </font><font style="vertical-align: inherit;">Cependant, il y a un emplacement pour carte microSD, une console USB-UART, plusieurs ports USB et Ethernet. </font><font style="vertical-align: inherit;">Pour le premier d√©part, plus que suffisant. </font><font style="vertical-align: inherit;">Et pour diluer l'histoire s√®che avec une photo, je joins une photo de ce tableau de d√©bogage.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/o9/ta/jqo9tap0mu2icbhbofhdjoocquk.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce qu'un logiciel pr√™t √† l'emploi?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chez STMicroelectronics, tout est g√©n√©ralement assez bon en termes de mat√©riel, mais terrible en termes de logiciels. Toutes ces modifications d'Atollic True Studio, CubeMX, CubeIDE, qui sont de plus en plus bogu√©es √† chaque nouvelle version, √©voquent une certaine angoisse. La situation est l√©g√®rement meilleure avec le support STM32MP1. STMicroelectronics ne propose qu'un certain assemblage d'OpenSTLinux. Cet assemblage est une distribution construite √† l'aide du projet Yocto. Bien s√ªr, tout cela peut exister sous cette forme, mais pour moi le principal inconv√©nient √©tait le manque d'acc√®s aux r√©f√©rentiels de distributions bien connues. Cela signifie que vous ne pourrez pas mettre sur votre carte un utilitaire √† partir des r√©f√©rentiels des distributions populaires simplement en ex√©cutant une commande comme apt-get install. Souvent, cela n'est pas requis pour les solutions int√©gr√©es, mais des situations sont possibles,quand une telle opportunit√© ne sera certainement pas superflue.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce qu'on fait?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, la t√¢che est claire - nous devons ex√©cuter une distribution populaire sur notre tableau de d√©bogage. </font><font style="vertical-align: inherit;">Mon choix s'est port√© sur Arch Linux. </font><font style="vertical-align: inherit;">Ce n'est pas la distribution la plus simple, mais elle est bien adapt√©e pour les appareils ARM: il y a des assemblages pr√™ts √† l'emploi et un site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">officiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©di√© √† cela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re chose que j'ai essay√© de r√©soudre le probl√®me en un clin d'≈ìil - je viens de glisser le noyau pr√™t pour le chargeur de d√©marrage de la distribution d'Arch Linux, assembl√© sous armv7. </font><font style="vertical-align: inherit;">Cela fonctionnait parfois sur d'autres cartes, mais un fiasco m'attendait: malgr√© le fait que le noyau ait √©t√© assembl√© pour la bonne architecture, il n'a pas d√©marr√©. </font><font style="vertical-align: inherit;">Eh bien, alors vous devez assembler votre noyau et en m√™me temps votre chargeur. </font><font style="vertical-align: inherit;">Mon plan d'action √©tait le suivant:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Construisez le chargeur de d√©marrage U-Boot.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Construisez le noyau Linux. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous marquons la carte microSD.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous √©crivons le chargeur de d√©marrage, le noyau et le syst√®me de fichiers racine sur la carte microSD.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profit</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©paration de l'assemblage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour mettre en ≈ìuvre ce plan, nous avons besoin d'un ordinateur avec Linux et d'un lecteur de carte pour l'enregistrement sur une carte microSD. </font><font style="vertical-align: inherit;">J'ai utilis√© un ordinateur portable avec Debian 10, mais en g√©n√©ral ce n'est pas important, les noms des utilitaires peuvent diff√©rer l√©g√®rement. </font><font style="vertical-align: inherit;">Nous mettons donc les utilitaires requis. </font><font style="vertical-align: inherit;">Je constate tout de suite que de temps en temps toutes les commandes doivent √™tre ex√©cut√©es en tant que root ou via sudo.</font></font><br>
<br>
<pre><code class="cpp hljs">apt-get install git<font></font>
apt-get install make<font></font>
apt-get install gcc<font></font>
apt-get install gcc-arm-linux-gnueabihf<font></font>
apt-get install bison<font></font>
apt-get install flex<font></font>
apt-get install g++<font></font>
apt-get install rsync<font></font>
apt-get install libncurses-dev</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En pr√©paration de l'assemblage, nous cr√©ons trois r√©pertoires dans le r√©pertoire de travail: u-boot (pour le chargeur de d√©marrage), buildroot (pour la construction du syst√®me) et archlinux (pour la distribution):</font></font><br>
<br>
<pre><code class="cpp hljs">mkdir u-boot<font></font>
mkdir buildroot<font></font>
mkdir archlinux</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous aurons besoin de ces r√©pertoires plus loin. </font><font style="vertical-align: inherit;">Je ferai r√©f√©rence √† ces noms plus loin dans le texte de l'article.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assemblage U-boot</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De nombreux articles ont d√©j√† √©t√© √©crits sur U-Boot, et dans le cadre de cela, je n'entrerai pas dans les d√©tails de ce que c'est, √† quoi il sert et comment cela fonctionne. Je peux seulement dire qu'il s'agit d'un chargeur de d√©marrage qui fournit le d√©marrage Linux sur les appareils ARM. Le code source du chargeur de d√©marrage U-Boot est disponible sur GitHub. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de construire U-Boot, nous clonons tout d'abord le r√©f√©rentiel U-Boot dans le r√©pertoire u-boot que nous avons cr√©√© pr√©c√©demment:</font></font><br>
<br>
<pre><code class="cpp hljs">git clone https:<span class="hljs-comment">//github.com/u-boot/u-boot</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cr√©er avec succ√®s U-Boot, nous avons besoin d'un fichier d'arborescence de p√©riph√©riques et d'un fichier de configuration U-Boot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier d'arborescence des p√©riph√©riques est un fichier d√©pendant du p√©riph√©rique. Ce fichier d√©crit la configuration du processeur pour une carte sp√©cifique. Si vous fabriquez votre mat√©riel sur la base d'un processeur ARM et pr√©voyez d'ex√©cuter Linux sur celui-ci, vous devrez d√©velopper votre fichier d'arborescence de p√©riph√©riques pour celui-ci (ou en adapter un pr√™t √† l'emploi). Cependant, de nombreuses cartes de d√©bogage ont d√©j√† des fichiers pr√™ts √† l'emploi: les d√©veloppeurs U-Boot attentionn√©s les incluent dans leur r√©f√©rentiel. Alors, regardez le r√©pertoire u-boot / arch / arm / dts. Il doit contenir le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier stm32mp157a-dk1.dtb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - il s'agit du fichier d'arborescence de p√©riph√©riques pour notre carte de d√©bogage.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier de configuration U-Boot, les param√®tres de base du chargeur de d√©marrage sont √©crits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurer U-Boot √† partir de z√©ro est un processus assez long et laborieux, car il existe de nombreux param√®tres. </font><font style="vertical-align: inherit;">√Ä ces fins, il existe des configurateurs de console et graphiques. </font><font style="vertical-align: inherit;">Cependant, nous avons eu de la chance: dans le r√©pertoire u-boot / configs, il y a un fichier </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stm32mp15_basic_defconfig</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il s'agit du fichier de configuration de base U-Boot pour les cartes de d√©bogage STM32MP15. </font><font style="vertical-align: inherit;">Nous ouvrons ce fichier et voyons que pour que nous d√©marrions rapidement, il suffit de changer une seule ligne: √† la place</font></font><br>
<br>
<pre><code class="cpp hljs">CONFIG_DEFAULT_DEVICE_TREE=‚Äùstm32mp157c-ev1‚Äù</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√©crire</font></font><br>
<br>
<pre><code class="cpp hljs">CONFIG_DEFAULT_DEVICE_TREE=‚Äùstm32mp157a-dk1‚Äù</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette ligne, nous indiquons au chargeur de d√©marrage que nous devons utiliser le fichier d'arborescence des p√©riph√©riques pour notre carte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous √™tes maintenant pr√™t √† cr√©er U-Boot. </font><font style="vertical-align: inherit;">Nous utilisons notre config:</font></font><br>
<br>
<pre><code class="cpp hljs">make CROSS_COMPILE=arm-linux-gnueabihf- stm32mp15_basic_defconfig</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ex√©cutez l'assemblage:</font></font><br>
<br>
<pre><code class="cpp hljs">make CROSS_COMPILE=arm-linux-gnueabihf-</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout s'est bien pass√©, alors dans le r√©pertoire u-boot, nous devrions avoir un tas de fichiers. </font><font style="vertical-align: inherit;">Parmi ceux-ci, deux nous int√©ressent: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u-boot-spl.stm32</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u-boot.img</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le premier fichier est le soi-disant First Stage Boot Loader (FSBL). </font><font style="vertical-align: inherit;">Il est situ√© devant l'U-Boot, d√©marre en premier et initialise la m√©moire DDR3, qui est n√©cessaire pour d√©marrer U-Boot. </font><font style="vertical-align: inherit;">Dans d'autres cartes, FSBL est souvent combin√© avec U-Boot en une seule image, mais ici, vous devez √©crire chaque image sur une cl√© USB s√©par√©ment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout avec U-Boot pour l'instant, enregistrez les fichiers d√©sign√©s et passez directement √† l'assemblage du noyau Linux.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assemblage du noyau Linux</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'utiliserai Buildroot pour construire le noyau Linux. Bien s√ªr, √† ces fins, vous pouvez utiliser le Yocto tout aussi populaire, ou m√™me essayer de construire le noyau √† partir des sources de kernel.org. Cependant, j'avais une certaine exp√©rience de travail avec Buildroot, alors j'ai d√©cid√©. De plus, Buildroot construit √©galement le syst√®me de fichiers racine (rootfs) et m√™me le chargeur U-Boot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, par tous les moyens disponibles, t√©l√©chargez l'archive de Buildroot depuis le site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">officiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , d√©compressez-la dans le r√©pertoire buildroot et acc√©dez-y. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme dans le cas de U-Boot, la premi√®re chose dont vous devez vous occuper est le fichier de configuration de notre mat√©riel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons dans le r√©pertoire buildroot / configs et voyons que les d√©veloppeurs ont d√©j√† ajout√© un fichier de configuration pour notre carte: il y a un fichier</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stm32mp157a_dk1_defconfig</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (vrai pour la version Buildroot-2020.05, dans les versions ant√©rieures de ce fichier il n'y en avait pas encore). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai essay√© de construire le noyau 5.4.26 en utilisant ce fichier de configuration, et il a g√©n√©ralement d√©marr√© avec succ√®s sur ma carte. Cependant, pour une raison quelconque, le fichier d'arborescence des p√©riph√©riques Linux dans cet assemblage s'est av√©r√© √™tre tronqu√©: par d√©faut, les ports USB n'√©taient m√™me pas pris en charge. Esp√©rons qu'avec le temps ce bug sera corrig√©, mais que faire maintenant?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suis all√© sur Google ce probl√®me et suis tomb√© sur les r√©f√©rentiels STMicroelectronics, o√π j'ai trouv√© des sources Linux 4.19 avec des correctifs pour leurs produits. </font><font style="vertical-align: inherit;">Y compris, les bons fichiers DTB √©taient √©galement l√†. </font><font style="vertical-align: inherit;">Il ne reste plus qu'√† dire √† Buildroot d'utiliser ce d√©p√¥t lors de la construction du noyau. </font><font style="vertical-align: inherit;">Pour ce faire, copiez le fichier stm32mp157a_dk1_defconfig et renommez-le en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stm32mp157a_dk1_new_defconfig</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ouvrez - </font><font style="vertical-align: inherit;">le et effectuez les modifications suivantes: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu</font></font><br>
<br>
<pre><code class="cpp hljs">BR2_PACKAGE_HOST_LINUX_HEADERS_CUSTOM_5_4=y</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous √©crivons </font></font><br>
<br>
<pre><code class="cpp hljs">BR2_PACKAGE_HOST_LINUX_HEADERS_CUSTOM_4_19=y</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu </font></font><br>
<br>
<pre><code class="cpp hljs">BR2_LINUX_KERNEL_CUSTOM_VERSION=y<font></font>
BR2_LINUX_KERNEL_CUSTOM_VERSION_VALUE=<span class="hljs-string">"5.4.26"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous √©crivons</font></font><br>
<br>
<pre><code class="cpp hljs">BR2_LINUX_KERNEL_CUSTOM_TARBALL=y<font></font>
BR2_LINUX_KERNEL_CUSTOM_TARBALL_LOCATION=<span class="hljs-string">"$(call github,STMicroelectronics,linux,v4.19-stm32mp-r1.2)/linux-v4.19-stm32mp-r1.2.tar.gz"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enregistrez et fermez le fichier. </font><font style="vertical-align: inherit;">Le fichier de configuration est pr√™t, appliquons-le (vous devez l'ex√©cuter depuis le r√©pertoire buildroot):</font></font><br>
<br>
<pre><code class="cpp hljs">make CROSS_COMPILE=arm-linux-gnueabihf- stm32mp157a_dk1_new_defconfig</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette commande transf√©rera les informations de notre fichier de configuration stm32mp157a_dk1_defconfig vers le fichier .config, qui se trouve dans le r√©pertoire buildroot. √Ä l'avenir, l'assemblage sera construit sur la base du fichier .config. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, maintenant tout est presque pr√™t pour d√©marrer le processus de construction, mais avant cela, vous devez configurer notre noyau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, il convient de dire que par d√©faut, une fonctionnalit√© minimale sera incluse dans le noyau. Si nous voulons l'√©tendre, le noyau devra √™tre configur√© pour nous-m√™mes. Au minimum, vous devrez ajouter la prise en charge du groupe de contr√¥le au noyau: sans cela, notre Arch Linux ne d√©marrera pas. De plus, √† titre d'exemple, je vais vous montrer comment ajouter la prise en charge des lecteurs flash USB au noyau: en cons√©quence, notre carte de d√©bogage pourra fonctionner avec les lecteurs flash.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour d√©marrer le configurateur de noyau √† partir du r√©pertoire buildroot, ex√©cutez la commande</font></font><br>
<br>
<pre><code class="cpp hljs">make linux-menuconfig</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et aller boire du th√©. </font><font style="vertical-align: inherit;">Ce processus n'est pas rapide et en fonction de la puissance de votre ordinateur peut prendre de quinze minutes √† plusieurs heures. </font><font style="vertical-align: inherit;">Important: pendant le travail de buildroot, vous avez besoin d'une connexion stable √† Internet, de nombreux packages diff√©rents seront t√©l√©charg√©s. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si dans le processus une erreur appara√Æt</font></font><br>
<br>
<pre><code class="cpp hljs">configure: error: <span class="hljs-function">you should <span class="hljs-keyword">not</span> run configure as <span class="hljs-title">root</span> <span class="hljs-params">(<span class="hljs-built_in">set</span> FORCE_UNSAFE_CONFIGURE=<span class="hljs-number">1</span> in environment to bypass <span class="hljs-keyword">this</span> check)</span>
See `config.<span class="hljs-built_in">log</span>' <span class="hljs-keyword">for</span> more details</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
devra ex√©cuter la commande</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">export</span> FORCE_UNSAFE_CONFIGURE=<span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et red√©marrez le configurateur de noyau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, la fen√™tre du configurateur devrait appara√Ætre: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xs/ah/h7/xsahh7p0h-ee5ly4sz54vvg1gcc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajouter le support du groupe de contr√¥le: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration g√©n√©rale -&gt; Support du groupe de contr√¥le</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et d√©finir l'ast√©risque avec un espace:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x-/hu/lm/x-hulmm3zia2p1azslxcwuszfto.jpeg"><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et comment ajouter le support de lecteur flash?</font></font></b>
                        <div class="spoiler_text">  SCSI .     80- ,  , ,     USB FLASH .   <b>Device Drivers -&gt; SCSI support</b>       :<br>
<br>
<img src="https://habrastorage.org/webt/kh/59/mq/kh59mqwq_7lppvsozcmqzq4pp94.jpeg"><br>
<br>
     USB FLASH .   <b>Device Drivers -&gt; USB support</b>    <b>USB Mass Storage support</b>:<br>
<br>
<img src="https://habrastorage.org/webt/ar/uu/qy/aruuqyuuanaakzw8mm1givi6yua.jpeg"><br>
<br>
,     FLASH     : <b>File systems -&gt; Native language support -&gt; Codepage 437</b>  <b>File systems -&gt; Native language support -&gt; NLS ISO 8859-1:</b><br>
<br>
<img src="https://habrastorage.org/webt/n2/mt/_x/n2mt_x_utdbu9zdr1dxcugqmaoy.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/0o/sy/f8/0osyf81e1zk8m8fyic9rhhh4yw0.jpeg"><br>
<br>
   ,  USB FLASH      . <br>
</div>
                    </div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois tous les param√®tres du configurateur du noyau d√©finis, enregistrez-les avec le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et quittez le configurateur avec le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quitter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, il ne reste plus qu'√† d√©marrer le processus de construction avec la commande:</font></font><br>
<br>
<pre><code class="cpp hljs">make CROSS_COMPILE=arm-linux-gnueabihf-</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et vous pouvez aller boire du th√© une deuxi√®me fois, ce processus prend √©galement beaucoup de temps. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout s'est bien pass√©, l'ensemble de fichiers suivant devrait appara√Ætre dans le r√©pertoire buildroot / output / images:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rootfs.ext2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un syst√®me de fichiers racine compil√© avec ext2. </font><font style="vertical-align: inherit;">Cela ne nous int√©resse pas;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rootfs.ext4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un syst√®me de fichiers racine compil√© avec ext4. </font><font style="vertical-align: inherit;">Il nous sera utile un peu plus tard;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sdcard.img</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Une image d'une carte microSD, y compris FSBL + U-Boot + zImage + rootfs. </font><font style="vertical-align: inherit;">Un fichier pour les paresseux, il vous permet de ne pas prendre la peine de baliser une carte microSD et d'y t√©l√©charger imm√©diatement l'ensemble du syst√®me. </font><font style="vertical-align: inherit;">Bien s√ªr, ce n'est pas notre chemin :).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stm32mp157a-dk1.dtb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fichier d'arborescence de p√©riph√©riques. </font><font style="vertical-align: inherit;">Assurez-vous d'√™tre utile pour d√©marrer le syst√®me;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u-boot.img</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u-boot-spl.stm32</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fichier FSBL et U-Boot. </font><font style="vertical-align: inherit;">Comme nous les avons collect√©s √† la derni√®re √©tape, nous n'en avons pas besoin;</font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi les avons-nous collect√©s s√©par√©ment?</font></font></b>
                        <div class="spoiler_text"> , Buildroot             U-Boot.    ,       .                 U-Boot,        ‚Äì     Linux.<br>
 </div>
                    </div></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zImage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - le c≈ìur de tout le syst√®me - un fichier de noyau Linux compress√©.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le processus d'assemblage est termin√©, maintenant nous proc√©dons au marquage de la carte m√©moire microSD et √† la cr√©ation de partitions sur celle-ci.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partitionnement et sections d'une carte microSD</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Marquer une carte microSD et cr√©er des partitions est une √©tape tr√®s importante, fortement li√©e √† une plateforme mat√©rielle sp√©cifique. Malheureusement, les informations sur ce probl√®me sur un processeur sp√©cifique ne sont pas toujours faciles √† trouver, et m√™me si vous collectez U-Boot enti√®rement fonctionnel et le noyau Linux, rien de tout cela ne fonctionnera avec la moindre erreur dans la disposition de la carte microSD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imm√©diatement, je note que la carte microSD avec laquelle le syst√®me est lanc√© sur le STM32MP1 doit avoir un balisage GPT. L'utilitaire </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gdisk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous aidera avec cela </font><font style="vertical-align: inherit;">, mais plus √† ce sujet plus tard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les sections de la carte microSD devraient ressembler √† ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xs/-l/rr/xs-lrrpr3mi-vrdqemol2sy8szg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir sur la figure, la carte doit contenir au moins 5 partitions: fsbl1, fsbl2, ssbl, kernel, rootfs. </font><font style="vertical-align: inherit;">De plus, vous pouvez √©galement cr√©er une ou plusieurs sections de donn√©es pour stocker des informations √† leur sujet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les </font><b><font style="vertical-align: inherit;">sections </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fsbl1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fsbl2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont compl√®tement identiques et le chargeur de d√©marrage principal y est √©crit (comme vous vous en souvenez, il s'agit du </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier u-boot-spl.stm32</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que nous avons re√ßu pendant le processus d'assemblage U-Boot). </font><font style="vertical-align: inherit;">Malgr√© le fait que tout devrait fonctionner et avec une seule section de ce type, la documentation sur STM2MP1 recommande d'en faire deux. </font><font style="vertical-align: inherit;">D'autres exigences s'appliquent √† ces sections:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque partition doit avoir une taille de 256 Ko.</font></font></li>
<li>    ,      <b>fsbl</b> (fsbl1  fsbl2).   :          ,     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssbl est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destin√©e √† l'√©criture du chargeur de d√©marrage U-Boot (le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier u-boot.img</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que nous avons re√ßu pendant le processus d'assemblage U-Boot). La taille de partition ssbl recommand√©e est de 2 Mo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section du </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noyau</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">destin√©e √† y √©crire le noyau Linux (fichier </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zImage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), l'arborescence des p√©riph√©riques ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier stm32mp157a-dk1.dtb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), ainsi que le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour U-Boot, avec lequel le syst√®me sera lanc√©. La taille de partition du noyau recommand√©e est de 64 Mo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rootfs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sert √† √©crire le syst√®me de fichiers racine. Nous allons essayer d'y √©crire le syst√®me de fichiers racine compil√© par Buildroot, ainsi que le syst√®me de fichiers racine d'Arch Linux. La taille de partition rootfs recommand√©e est de 1 Go ou plus.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section des donn√©es est destin√©e au stockage des donn√©es utilisateur. </font><font style="vertical-align: inherit;">Vous pouvez cr√©er une ou plusieurs de ces sections. </font><font style="vertical-align: inherit;">Et vous pouvez vous en passer du tout. </font><font style="vertical-align: inherit;">Dans cet article, je ne cr√©erai pas cette section. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, nous commen√ßons √† baliser. </font><font style="vertical-align: inherit;">Nous ins√©rons la carte microSD dans le lecteur de carte de notre ordinateur avec Linux √† bord et en utilisant tous les moyens disponibles (par exemple, en utilisant dmesg) d√©terminer le nom de l'appareil qui appara√Æt. </font><font style="vertical-align: inherit;">Dans mon cas, c'est / dev / sdb. </font><font style="vertical-align: inherit;">Dans votre cas, il peut s'agir d'un nom diff√©rent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ex√©cutez l'utilitaire gdisk et supprimez compl√®tement le balisage sur la carte microSD:</font></font><br>
<br>
<pre><code class="cpp hljs">root@debian:/home/myuser<span class="hljs-meta"># gdisk /dev/sdb</span>
<span class="hljs-function">GPT <span class="hljs-title">fdisk</span> <span class="hljs-params">(gdisk)</span> version 1.0.3
Partition table scan:
  MBR: protective
  BSD: <span class="hljs-keyword">not</span> present
  APM: <span class="hljs-keyword">not</span> present
  GPT: present
Found valid GPT with protective MBR</span>; <span class="hljs-keyword">using</span> GPT.<font></font>
Command (? <span class="hljs-keyword">for</span> help): <span class="hljs-function">x
Expert <span class="hljs-title">command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: z
About to wipe out GPT on /dev/sdb. Proceed? <span class="hljs-params">(Y/N)</span>: y
GPT data structures destroyed! You may now partition the disk <span class="hljs-keyword">using</span> fdisk <span class="hljs-keyword">or</span>
other utilities.
Blank out MBR? <span class="hljs-params">(Y/N)</span>: y</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cas o√π, nous martelons le d√©but de la carte microSD avec des z√©ros. </font></font><br>
<br>
<pre><code class="cpp hljs">dd <span class="hljs-keyword">if</span>=/dev/zero of=/dev/sdb bs=<span class="hljs-number">1</span>M count=<span class="hljs-number">64</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, ex√©cutez √† nouveau gdisk, ajoutez le balisage et cr√©ez 5 partitions sur la carte microSD conform√©ment au tableau que j'ai donn√© ci-dessus:</font></font><br>
<br>
<pre><code class="cpp hljs">root@debian:/home/myuser<span class="hljs-meta"># gdisk /dev/sdb</span>
<span class="hljs-function">GPT <span class="hljs-title">fdisk</span> <span class="hljs-params">(gdisk)</span> version 1.0.3

Partition table scan:
  MBR: <span class="hljs-keyword">not</span> present
  BSD: <span class="hljs-keyword">not</span> present
  APM: <span class="hljs-keyword">not</span> present
  GPT: <span class="hljs-keyword">not</span> present

Creating <span class="hljs-keyword">new</span> GPT entries.

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: o
This option deletes all partitions <span class="hljs-keyword">and</span> creates a <span class="hljs-keyword">new</span> protective MBR.
Proceed? <span class="hljs-params">(Y/N)</span>: y

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: n
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">1</span><span class="hljs-number">-128</span>, <span class="hljs-keyword">default</span> <span class="hljs-number">1</span>)</span>: 1
First <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">34</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">2048</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: 
<span class="hljs-function">Last <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">2048</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">30873566</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: +<span class="hljs-number">256</span>K<font></font>
Current type is <span class="hljs-string">'Linux filesystem'</span>
<span class="hljs-function">Hex code <span class="hljs-keyword">or</span> <span class="hljs-title">GUID</span> <span class="hljs-params">(L to show codes, Enter = <span class="hljs-number">8300</span>)</span>: 
Changed type of partition to 'Linux filesystem'

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: n
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">2</span><span class="hljs-number">-128</span>, <span class="hljs-keyword">default</span> <span class="hljs-number">2</span>)</span>: 2
First <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">34</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">4096</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: 
<span class="hljs-function">Last <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">4096</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">30873566</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: +<span class="hljs-number">256</span>K<font></font>
Current type is <span class="hljs-string">'Linux filesystem'</span>
<span class="hljs-function">Hex code <span class="hljs-keyword">or</span> <span class="hljs-title">GUID</span> <span class="hljs-params">(L to show codes, Enter = <span class="hljs-number">8300</span>)</span>: 
Changed type of partition to 'Linux filesystem'

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: n
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">3</span><span class="hljs-number">-128</span>, <span class="hljs-keyword">default</span> <span class="hljs-number">3</span>)</span>: 3
First <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">34</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">6144</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: 
<span class="hljs-function">Last <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">6144</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">30873566</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: +<span class="hljs-number">2</span>M<font></font>
Current type is <span class="hljs-string">'Linux filesystem'</span>
<span class="hljs-function">Hex code <span class="hljs-keyword">or</span> <span class="hljs-title">GUID</span> <span class="hljs-params">(L to show codes, Enter = <span class="hljs-number">8300</span>)</span>: 
Changed type of partition to 'Linux filesystem'

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: n
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">4</span><span class="hljs-number">-128</span>, <span class="hljs-keyword">default</span> <span class="hljs-number">4</span>)</span>: 4
First <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">34</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">10240</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: 
<span class="hljs-function">Last <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">10240</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">30873566</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: +<span class="hljs-number">64</span>M<font></font>
Current type is <span class="hljs-string">'Linux filesystem'</span>
<span class="hljs-function">Hex code <span class="hljs-keyword">or</span> <span class="hljs-title">GUID</span> <span class="hljs-params">(L to show codes, Enter = <span class="hljs-number">8300</span>)</span>: 
Changed type of partition to 'Linux filesystem'

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: n
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">5</span><span class="hljs-number">-128</span>, <span class="hljs-keyword">default</span> <span class="hljs-number">5</span>)</span>: 5
First <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">34</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">141312</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: 
<span class="hljs-function">Last <span class="hljs-title">sector</span> <span class="hljs-params">(<span class="hljs-number">141312</span><span class="hljs-number">-30873566</span>, <span class="hljs-keyword">default</span> = <span class="hljs-number">30873566</span>)</span> <span class="hljs-keyword">or</span> </span>{+-}size{KMGTP}: <font></font>
Current type is <span class="hljs-string">'Linux filesystem'</span>
<span class="hljs-function">Hex code <span class="hljs-keyword">or</span> <span class="hljs-title">GUID</span> <span class="hljs-params">(L to show codes, Enter = <span class="hljs-number">8300</span>)</span>: 
Changed type of partition to 'Linux filesystem'

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: w

Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
PARTITIONS!!

Do you want to proceed? <span class="hljs-params">(Y/N)</span>: y
OK</span>; <span class="hljs-function">writing <span class="hljs-keyword">new</span> GUID partition <span class="hljs-title">table</span> <span class="hljs-params">(GPT)</span> to /dev/sdb.
The operation has completed successfully.</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, ajoutez les noms aux sections sur la carte microSD. </font><font style="vertical-align: inherit;">Comme vous vous en souvenez, ceci est particuli√®rement critique pour les premi√®res sections o√π FSBL sera √©crit: si vous ne leur attribuez pas les noms requis, le syst√®me ne d√©marrera pas:</font></font><br>
<br>
<pre><code class="cpp hljs">root@debian:/home/myuser<span class="hljs-meta"># gdisk /dev/sdb</span>
<span class="hljs-function">GPT <span class="hljs-title">fdisk</span> <span class="hljs-params">(gdisk)</span> version 1.0.3

Partition table scan:
  MBR: protective
  BSD: <span class="hljs-keyword">not</span> present
  APM: <span class="hljs-keyword">not</span> present
  GPT: present

Found valid GPT with protective MBR</span>; <span class="hljs-keyword">using</span> GPT.<font></font>
<font></font>
Command (? <span class="hljs-keyword">for</span> help): <span class="hljs-function">c
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">1</span><span class="hljs-number">-5</span>)</span>: 1
Enter name: fsbl1

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: c
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">1</span><span class="hljs-number">-5</span>)</span>: 2
Enter name: fsbl2

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: c
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">1</span><span class="hljs-number">-5</span>)</span>: 3
Enter name: ssbl

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: c
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">1</span><span class="hljs-number">-5</span>)</span>: 4
Enter name: kernel

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: c
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">1</span><span class="hljs-number">-5</span>)</span>: 5
Enter name: roootfs

<span class="hljs-title">Command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: w

Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
PARTITIONS!!

Do you want to proceed? <span class="hljs-params">(Y/N)</span>: y
OK</span>; <span class="hljs-function">writing <span class="hljs-keyword">new</span> GUID partition <span class="hljs-title">table</span> <span class="hljs-params">(GPT)</span> to /dev/sdb.
The operation has completed successfully.</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä la fin du travail avec la carte microSD, nous devons ajouter l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attribut de d√©marrage BIOS h√©rit√©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† la section sur laquelle nous allons √©crire le noyau Linux. </font><font style="vertical-align: inherit;">Sans cet attribut, le noyau a refus√© de d√©marrer:</font></font><br>
<br>
<pre><code class="cpp hljs">root@debian:/home/myuser<span class="hljs-meta"># gdisk /dev/sdb</span>
<span class="hljs-function">GPT <span class="hljs-title">fdisk</span> <span class="hljs-params">(gdisk)</span> version 1.0.3

Partition table scan:
  MBR: protective
  BSD: <span class="hljs-keyword">not</span> present
  APM: <span class="hljs-keyword">not</span> present
  GPT: present

Found valid GPT with protective MBR</span>; <span class="hljs-keyword">using</span> GPT.<font></font>
<font></font>
Command (? <span class="hljs-keyword">for</span> help): <span class="hljs-function">x

Expert <span class="hljs-title">command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: a
Partition <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">1</span><span class="hljs-number">-5</span>)</span>: 4
Known attributes are:
0: system partition
1: hide from EFI
2: legacy BIOS bootable
60: read-only
62: hidden
63: <span class="hljs-keyword">do</span> <span class="hljs-keyword">not</span> automount

Attribute value is 0000000000000000. Set fields are:
  No fields <span class="hljs-built_in">set</span>

Toggle which attribute <span class="hljs-title">field</span> <span class="hljs-params">(<span class="hljs-number">0</span><span class="hljs-number">-63</span>, <span class="hljs-number">64</span> <span class="hljs-keyword">or</span> &lt;Enter&gt; to <span class="hljs-built_in">exit</span>)</span>: 2
Have enabled the 'legacy BIOS bootable' attribute.
Attribute value is 0000000000000004. Set fields are:
2 <span class="hljs-params">(legacy BIOS bootable)</span>

Toggle which attribute <span class="hljs-title">field</span> <span class="hljs-params">(<span class="hljs-number">0</span><span class="hljs-number">-63</span>, <span class="hljs-number">64</span> <span class="hljs-keyword">or</span> &lt;Enter&gt; to <span class="hljs-built_in">exit</span>)</span>: 

Expert <span class="hljs-title">command</span> <span class="hljs-params">(? <span class="hljs-keyword">for</span> help)</span>: w

Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
PARTITIONS!!

Do you want to proceed? <span class="hljs-params">(Y/N)</span>: y
OK</span>; <span class="hljs-function">writing <span class="hljs-keyword">new</span> GUID partition <span class="hljs-title">table</span> <span class="hljs-params">(GPT)</span> to /dev/sdb.
The operation has completed successfully.</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout, la disposition de la carte m√©moire est pr√™te. </font><font style="vertical-align: inherit;">Au cas o√π, v√©rifiez que tout est enregistr√© comme il se doit. </font><font style="vertical-align: inherit;">Pour ce faire, r√©ex√©cutez </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gdisk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ex√©cutez la commande </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le r√©sultat devrait conseiller l'image: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q9/ko/ff/q9koffmcelcxpna_qtwtfkdlzz8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, cr√©ez le syst√®me de fichiers ext4 sur / dev / sdb4 et / dev / sdb5:</font></font><br>
<br>
<pre><code class="cpp hljs">mkfs.ext4 /dev/sdb4<font></font>
mkfs.ext4 /dev/sdb5</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous prescrivons des √©tiquettes de volume pour que plus tard il soit plus facile d'y acc√©der:</font></font><br>
<br>
<pre><code class="cpp hljs">e2label /dev/sdb4 kernel<font></font>
e2label /dev/sdb5 rootfs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci termine la cr√©ation de sections de la carte m√©moire, vous pouvez y √©crire des fichiers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrement sur carte MicroSD</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, au stade actuel, tout est pr√™t pour l'enregistrement sur une carte microSD. </font><font style="vertical-align: inherit;">Nous l'ins√©rons dans le lecteur de cartes de l'ordinateur Linux et √©crivons le chargeur de d√©marrage principal (FSBL) dans les premi√®re et deuxi√®me sections de la carte mocroSD:</font></font><br>
<br>
<pre><code class="cpp hljs">dd <span class="hljs-keyword">if</span>=u-boot/u-boot-spl.stm32 of=/dev/sdb1<font></font>
dd <span class="hljs-keyword">if</span>=u-boot/u-boot-spl.stm32 of=/dev/sdb2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, √©crivez U-Boot dans la troisi√®me section de la carte microSD:</font></font><br>
<br>
<pre><code class="cpp hljs">dd <span class="hljs-keyword">if</span>=u-boot/u-boot.img of=/dev/sdb3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez copier le noyau, le fichier d'arborescence des p√©riph√©riques et le script de d√©marrage dans la quatri√®me section de la carte microSD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de commencer √† copier des fichiers, vous avez besoin d'une petite explication sur le script de t√©l√©chargement. Dans ce script, en fait, diverses informations pour U-Boot sont indiqu√©es, √† l'aide desquelles il peut d√©marrer le syst√®me et transf√©rer le contr√¥le au noyau. Il existe diff√©rentes fa√ßons d'√©crire ces scripts, mais la plus simple (√† mon avis) est d√©crite dans la documentation de STM32MP1: vous devez cr√©er le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©pertoire / extlinux</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† la racine de la section du noyau </font><font style="vertical-align: inherit;">et cr√©er un fichier texte avec le nom </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extlinux.conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec le contenu suivant:</font></font><br>
<br>
<pre><code class="cpp hljs">LABEL stm32mp157a-dk1<font></font>
KERNEL /zImage<font></font>
FDT /stm32mp157a-dk1.dtb<font></font>
APPEND root=/dev/mmcblk0p5 rootwait rw console=ttySTM0,<span class="hljs-number">115200</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est assez simple ici: nous disons au chargeur o√π trouver le noyau, l'arborescence des p√©riph√©riques, le syst√®me de fichiers racine et disons que nous aurons le port ttySTM0 comme console de travail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez maintenant le noyau:</font></font><br>
<br>
<pre><code class="cpp hljs">cp -a buildroot/output/images/zImage /media/myuser/kernel/</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque: dans le r√©pertoire / media / myuser /, je monte une carte microSD lorsqu'elle est install√©e dans le lecteur de carte. </font><font style="vertical-align: inherit;">Dans votre cas, il peut s'agir d'un r√©pertoire diff√©rent. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez le fichier d'arborescence des p√©riph√©riques:</font></font><br>
<br>
<pre><code class="cpp hljs">cp -a buildroot/output/images/stm32mp157a-dk1.dtb /media/myuser/kernel/</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cr√©ez un r√©pertoire:</font></font><br>
<br>
<pre><code class="cpp hljs">mkdir /media/myuser/kernel/extlinux</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cr√©ez un fichier:</font></font><br>
<br>
<pre><code class="cpp hljs">nano /media/myuser/kernel/extlinux/extlinux.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et remplissez-le avec le contenu:</font></font><br>
<br>
<pre><code class="cpp hljs">LABEL stm32mp157a-dk1<font></font>
KERNEL /zImage<font></font>
FDT /stm32mp157a-dk1.dtb<font></font>
APPEND root=/dev/mmcblk0p5 rootwait rw console=ttySTM0,<span class="hljs-number">115200</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enregistrez le fichier et fermez l'√©diteur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur ce point, la quatri√®me section de la carte microSD est pr√™te: le noyau linux et tous les fichiers auxiliaires sont d√©j√† √©crits. </font><font style="vertical-align: inherit;">D√©j√† √† ce stade, si vous ins√©rez une carte microSD dans la carte de d√©bogage, le noyau Linux devrait √™tre charg√©, cependant, √† la fin, il tombera en panne de noyau en raison du fait que le syst√®me de fichiers racine ne peut pas √™tre mont√©. </font><font style="vertical-align: inherit;">Ce n'est pas surprenant, car nous l'avons enregistr√© jusqu'√† pr√©sent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a la derni√®re √©tape, √† laquelle nous allons √©crire le syst√®me de fichiers racine sur la carte microSD. </font><font style="vertical-align: inherit;">Et ici, diff√©rentes options sont possibles:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âcrire le syst√®me de fichiers racine g√©n√©r√© par Buildroot</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©√©crire le syst√®me de fichiers racine Arch Linux</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, notez le syst√®me de fichiers racine que Buildroot a g√©n√©r√© pour nous et essayez de commencer avec. Ce n'√©tait pas le but de cet article, mais il me semblait qu'en g√©n√©ral il pourrait √™tre utile pour toutes les applications, d'autant plus que cette action ne prend pas beaucoup de temps. Le syst√®me de fichiers racine est √©crit dans la cinqui√®me section de notre carte microSD avec une seule commande:</font></font><br>
<br>
<pre><code class="cpp hljs">dd <span class="hljs-keyword">if</span>=buildroot/output/images/rootfs.ext4 of=/dev/sdb5</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ins√©rez maintenant la carte m√©moire dans la carte de d√©bogage et d√©marrez le syst√®me. Nous observerons la sortie des informations de d√©bogage via la console USB-UART: l'acc√®s est fourni via un port microUSB sur la carte STM32MP157A-DK1. L'affichage des informations affich√©es est possible dans n'importe quel programme de terminal, par exemple Putty ou Minicom. Pour les besoins de cet article, j'ai utilis√© ce dernier en ouvrant une autre fen√™tre de terminal dans Debian. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous ins√©rons la carte microSD dans la carte de d√©bogage, alimentons la carte et regardons le terminal. Si tout a √©t√© fait correctement, alors les journaux du noyau FSBL, U-Boot, devraient √™tre vers√©s l√†-bas et finalement - une invitation √† entrer la connexion appara√Ætra. Nous entrons en root et - voila - nous arrivons √† la console du syst√®me que nous venons de collecter:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1q/hh/sz/1qhhszribllpziacncz6titn6bw.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, il n'a m√™me pas de gestionnaire de paquets, et en g√©n√©ral, la fonctionnalit√© est tr√®s m√©diocre, mais avec l'aide de Buildroot, vous pouvez le cr√©er tr√®s cool et cr√©er un syst√®me complexe vraiment fonctionnel. </font><font style="vertical-align: inherit;">En attendant, sa taille n'est que de 7 m√©gaoctets! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rq/e7/iv/rqe7iv12mmdleosrwxo8jb-rmj8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s vous √™tre assur√© que le syst√®me de fichiers racine maison d√©marre correctement, il est temps de d√©marrer Arch Linux. </font><font style="vertical-align: inherit;">Ins√©rez √† nouveau la carte microSD dans le lecteur de carte de notre ordinateur et formatez √† nouveau la cinqui√®me section de la carte m√©moire:</font></font><br>
<br>
<pre><code class="cpp hljs">mkfs.ext4 /dev/sdb5</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
T√©l√©chargez l'archive avec Arch Linux, assembl√© sous armv7, depuis le site officiel. </font><font style="vertical-align: inherit;">D√©compressez l'archive dans le r√©pertoire archlinux et utilisez la commande:</font></font><br>
<br>
<pre><code class="cpp hljs">cp -a archlinux<span class="hljs-comment">/* /media/myuser/rootfs </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez-le dans la section rootfs de la carte microSD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous nettoyons le r√©pertoire / media / myuser / rootfs / boot: nous n'avons pas besoin du contenu, car le noyau et l'arborescence des p√©riph√©riques sont dans une section distincte de la carte microSD:</font></font><br>
<br>
<pre><code class="cpp hljs">rm ‚Äìrf /media/myuser/rootfs/boot<span class="hljs-comment">/*</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus tard, vous pouvez monter la partition / dev / sdb4 dans le r√©pertoire de d√©marrage, o√π nous avons l'image du noyau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, ins√©rez la carte microSD dans la carte de d√©bogage, dynamisez et profitez du travail ArchLinux: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bj/n8/6i/bjn86iex090rkcggj7v5sz7yayg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s le d√©marrage r√©ussi d'Arch Linux, j'ai d√©cid√© d'essayer √©galement d'ex√©cuter Debian sur la carte de d√©bogage. </font><font style="vertical-align: inherit;">En utilisant des manipulations absolument similaires avec le syst√®me de fichiers racine, cela a fonctionn√© avec succ√®s:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8h/kg/1c/8hkg1c82dcu2ruov5fm7rdu-j-i.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous avons suffisamment jou√© avec la carte de d√©bogage STM32MP157A-DK1: placez U-Boot, le noyau Linux, notre propre syst√®me de fichiers racine, et avons √©galement lanc√© Arch Linux et Debian. </font><font style="vertical-align: inherit;">J'esp√®re que ce mat√©riel sera utile √† quelqu'un √† la fois lorsque vous travaillez avec des processeurs de la famille STM32MP1 ou avec toute autre carte unique sur ARM.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liens utiles</font></font></b>
                        <div class="spoiler_text"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">www.st.com/en/microcontrollers-microprocessors/stm32mp1-series.html</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">wiki.st.com/stm32mpu/wiki/Category</a>:STM32_MPU_microprocessor_devices</div>
                    </div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr503578/index.html">Les bons programmeurs copient, les grands programmeurs volent</a></li>
<li><a href="../fr503580/index.html">Qu'est-ce que le Big Data?</a></li>
<li><a href="../fr503588/index.html">Bill Gates: ce que vous devez savoir sur le vaccin COVID-19</a></li>
<li><a href="../fr503594/index.html">Observateur √† distance</a></li>
<li><a href="../fr503598/index.html">FOSS News n ¬∞ 17 - revue des actualit√©s gratuites et open source du 18 au 24 mai 2020</a></li>
<li><a href="../fr503604/index.html">Sergey et ¬´la programmation vaut mieux que le sexe¬ª</a></li>
<li><a href="../fr503606/index.html">Swift 5.3: Quoi de neuf?</a></li>
<li><a href="../fr503608/index.html">Comment nous avons recherch√© les filtres antivirus</a></li>
<li><a href="../fr503610/index.html">Pourquoi ne pas cr√©er votre propre Lisp pour le Web?</a></li>
<li><a href="../fr503612/index.html">Meilleures pratiques Kubernetes. Cartographie des services externes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>