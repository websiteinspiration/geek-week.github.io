<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéä üì¶ üîÇ G√©olocalisation dans React Native üë©üèæ‚Äçüé® üë©üèæ‚Äç‚öïÔ∏è ü§¥üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une application mobile peut agir comme le ¬´lieu de travail¬ª d'un employ√©, alors qu'il peut √™tre n√©cessaire de transf√©rer des coordonn√©es g√©ographiques...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>G√©olocalisation dans React Native</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/493312/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une application mobile peut agir comme le ¬´lieu de travail¬ª d'un employ√©, alors qu'il peut √™tre n√©cessaire de transf√©rer des coordonn√©es g√©ographiques et d'autres donn√©es. Dans le d√©veloppement d'applications multiplateforme sur iOS et Android, des frameworks tels que Flutter ou React Native sont souvent utilis√©s pour cette t√¢che. Dans cet article, nous parlons des fonctionnalit√©s de la g√©olocalisation dans React Native en utilisant l'exemple de notre cas.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bq/d8/av/bqd8avprg_s7gfc5vohsywtdptg.png"><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fiabilit√©, la rapidit√© et la maturit√© de React Native sont parfois critiqu√©es par les d√©veloppeurs, et il y a environ trois ans, de tels doutes pouvaient √™tre consid√©r√©s comme justifi√©s. Cependant, pendant ce temps, la technologie est devenue plus avanc√©e et React Native a √©t√© reconnu comme un outil pratique pour cr√©er un large √©ventail d'applications. En particulier, React Native convient aux applications qui utilisent des coordonn√©es g√©ographiques - par exemple, divers trackers, applications pour les courriers, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aussi dans les magasins sont d√©velopp√©s sur React Native les applications des magasins en ligne, les menus des restaurants, les flux d'actualit√©s, les applications de livraison, les clients des r√©seaux sociaux - ainsi, un grand nombre de React Native utilisent constamment, sans m√™me y penser. Des exemples simples sont Facebook, Instagram, Skype, Uber Eats, Wallmart. Selon les pr√©visions, Microsoft peut reconstituer cette liste et transf√©rer ses applications mobiles vers React Native, en particulier apr√®s avoir mis en ≈ìuvre la prise en charge de la plate-forme Windows. Il existe une prise en charge React Native pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les applications </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weechat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬´int√©gr√©es¬ª </font><font style="vertical-align: inherit;">, bien que la prise en charge et la documentation de ces plateformes restent plut√¥t rares.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
React Native peut presque tout faire la m√™me chose qu'une application native. Par exemple, recevez des informations des capteurs de p√©riph√©rique, comme le font les applications Java / Kotlin ou ObjC / Swift, ou envoyez des donn√©es en arri√®re-plan √† l'aide du service de premier plan ou de la r√©cup√©ration en arri√®re-plan. La seule diff√©rence est que dans React Native, vous devez impl√©menter une interface pour l'interaction entre la partie native et Javascript. Pour les t√¢ches quotidiennes, ces interfaces sont souvent d√©j√† impl√©ment√©es. Cela s'applique √©galement au suivi de l'emplacement et du fonctionnement de Javascript en arri√®re-plan: il existe d√©j√† des solutions sous forme de biblioth√®ques open source ind√©pendantes. Il se trouve que la communaut√© "tire" Javascript de mani√®re ind√©pendante, les programmeurs et les entreprises utilisent activement les solutions Open Source. Peu de communaut√©s linguistiques disposent du m√™me nombre de biblioth√®ques, de cadres,services publics de qualit√©. Et pourtant, dans React Native, certaines fonctionnalit√©s qui existent dans le d√©veloppement natif sont encore limit√©es, et cela doit √™tre rappel√©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travailler avec React Native</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenez compte de plusieurs facteurs cl√©s qui garantissent la vitesse de d√©veloppement d'applications multiplateformes sur React Native:</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base de code commune</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois la logique √©crite, les √©crans de mise en page et les composants sur diff√©rentes plates-formes fonctionnent et se ressemblent autant que possible (par exemple, sur Android, au lieu des ombres habituelles, ils utilisent la notion d'exaltation). </font><font style="vertical-align: inherit;">Il n'y a pratiquement pas de casse-t√™te √©ternel pour un d√©veloppeur avec d'anciennes versions - par exemple, il est facile d'ajouter un support m√™me pour Android 4.4, bien qu'en pratique la mise en ≈ìuvre de cette t√¢che d√©pend √©galement de l'utilisation de modules natifs suppl√©mentaires.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flux de travail optimal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Souvent, React fournit un flux de travail optimal qui rend le d√©veloppement de nouvelles fonctionnalit√©s plusieurs fois plus rapide que dans les langues natives. </font><font style="vertical-align: inherit;">Cela s'applique √† la mise en page, √† l'approche des composants, √† l'installation des d√©pendances, aux solutions architecturales courantes pour React.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechargement √† chaud</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le d√©veloppeur n'a pas besoin de reconstruire l'application √† chaque fois pour voir les modifications. </font><font style="vertical-align: inherit;">Gr√¢ce √† Hot Reload, il suffit de quelques secondes pour mettre √† jour l'application √† l'√©tat actuel. </font><font style="vertical-align: inherit;">Et dans la version 0.61, Live Reload (maintenant c'est Fast Refresh) a √©galement √©t√© √©voqu√©, maintenant lorsque les modifications de composition sont tir√©es ¬´√† la vol√©e¬ª, sans r√©initialiser l'√©tat actuel des composants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la cr√©ation d'une application, plusieurs domaines cl√©s n√©cessitent une attention particuli√®re: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Javascript</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
React Native vise √† travailler avec Javascript, vous permettant de d√©crire rapidement la logique et les interfaces. Il existe de nombreux modules pr√™ts √† l'emploi du monde du Web et de Node.js qui peuvent √™tre utilis√©s de la mani√®re habituelle (naturellement, s'ils ne sont pas connect√©s avec le DOM ou avec le c√¥t√© serveur). Malgr√© sa grande vitesse, Javascript est parfois inf√©rieur aux langues natives. Il n'y a pas de multithreading. Dans React Native, nous ne pouvons pas acc√©der directement √† l'API Native, bien que cette restriction puisse bient√¥t √™tre supprim√©e. Javascript d√©crit principalement ce qui doit √™tre fait et rendu dans la partie native. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) Pont</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un bus qui accepte les appels Javascript via des interfaces sp√©ciales fournies par la biblioth√®que native de react. Les appels sont des messages s√©rialis√©s r√©guliers. Pour chaque composant - une simple vue, un champ de saisie ou un appel √† la bo√Æte de dialogue syst√®me - il existe une interface d√©crite en Javascript avec la logique impl√©ment√©e dans la partie native. Le bus est la partie la plus lente, il est asynchrone, le transfert de donn√©es entre Javascript et le natif prend du temps (tr√®s probablement, Facebook peut </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'en d√©barrasser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compl√®tement </font><font style="vertical-align: inherit;">). Souvent, les probl√®mes de performances des applications sur React Native sont caus√©s pr√©cis√©ment par le fonctionnement du pont, mais si vous l'utilisez correctement (r√©duisez le transfert de donn√©es dans les deux sens au minimum n√©cessaire), les performances des applications React Native ne diff√©reront pas de mani√®re significative. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) La partie native</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une application sur React Native est initialement une application native ordinaire. </font><font style="vertical-align: inherit;">La particularit√© est que toutes les biblioth√®ques n√©cessaires y sont d√©j√† connect√©es afin que vous puissiez √©crire toute la logique dans React JS. </font><font style="vertical-align: inherit;">Ici, nous pouvons √©crire notre propre logique native afin de l'utiliser (ou de ne pas l'utiliser) dans JS, ajouter des biblioth√®ques natives ordinaires (par exemple, pour prendre en charge TLS v1.2 sur KitKat et versions ant√©rieures). </font><font style="vertical-align: inherit;">Dans les applications natives pr√™tes √† l'emploi, vous pouvez ajouter la prise en charge de React Native.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation du suivi g√©ographique dans React Native</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'un des projets, nous devions d√©velopper un ¬´lieu de travail mobile¬ª pour les employ√©s de nos clients, notamment pour assurer le transfert de leurs coordonn√©es g√©ographiques en arri√®re-plan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe plusieurs outils pour travailler avec la g√©olocalisation dans React Native. Par exemple, il s'agit d'un package de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">communaut√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> React Native </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">@ react-native-community / geolocation</font></a><font style="vertical-align: inherit;"> , qui couvre la plupart des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">cas d'</font></a><font style="vertical-align: inherit;"> utilisation, mais ne fonctionne pas en arri√®re-plan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour mettre en ≈ìuvre notre t√¢che, nous avons utilis√© plusieurs solutions, dont une biblioth√®que avec le nom parlant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ mauron85 / react-native-background-geolocation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Initialement, cette biblioth√®que √©tait un plugin pour Cordova, mais plus tard, l'auteur a s√©par√© la base et cr√©√© des enveloppes distinctes pour React Native. Il existe √©galement une biblioth√®que payante du m√™me nom de transistorsoft, mais au moment de nos travaux sur le projet, elle ne gagnait qu'avec sa documentation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La biblioth√®que nous a permis de d√©finir des param√®tres flexibles pour le suivi de l'emplacement. Par exemple, avec quelle fr√©quence interroger un service syst√®me, comment fonctionner exactement en arri√®re-plan, dans quel rayon la position sera consid√©r√©e comme immobile. Les param√®tres et les m√©thodes d'envoi de ces coordonn√©es au serveur pouvaient √™tre utilis√©s ¬´pr√™ts √† l'emploi¬ª, mais nous avons d√©cid√© de ne pas envoyer de demandes de spam, mais d'agr√©ger les coordonn√©es re√ßues dans le r√©f√©rentiel et de les envoyer avec un grand intervalle. Dans le m√™me temps, la biblioth√®que nous a permis de lancer notre application en tant qu'activit√© de premier plan, nous √©vitant ainsi des maux de t√™te inutiles, car sur de nombreux appareils Android, les applications en arri√®re-plan ne peuvent fonctionner qu'avec des param√®tres suppl√©mentaires ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Huawei, MIUI, Samsung r√©cemment</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s l'installation, vous pouvez cr√©er un composant ou simplement un assistant qui g√®re le service. </font><font style="vertical-align: inherit;">Nous avons d√©cid√© d'utiliser le composant pour le monter avec les conditions du routeur et le connecter facilement √† redux. </font><font style="vertical-align: inherit;">Mettre en place notre service:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> BackgroundGeolocation, {<font></font>
  Location,<font></font>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@mauron85/react-native-background-geolocation'</span>;<font></font>
 <font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForegroundService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
<span class="hljs-comment">//...</span>
startBackgroundService = <span class="hljs-function">(<span class="hljs-params">config: GeotrackerConfig</span>) =&gt;</span> {
     <span class="hljs-comment">//    </span><font></font>
	BackgroundGeolocation.configure({<font></font>
  	<span class="hljs-attr">desiredAccuracy</span>: BackgroundGeolocation.HIGH_ACCURACY,
  	<span class="hljs-attr">stationaryRadius</span>: <span class="hljs-number">50</span>,
  	<span class="hljs-attr">distanceFilter</span>: config.distance,
  	<span class="hljs-attr">notificationTitle</span>: Strings.Geolocation.NOTIFICATION_TITLE,
  	<span class="hljs-attr">notificationText</span>: Strings.Geolocation.NOTIFICATION_DESCRIPTION,
  	<span class="hljs-attr">debug</span>: <span class="hljs-literal">false</span>,
  	<span class="hljs-attr">startOnBoot</span>: <span class="hljs-literal">false</span>,
  	<span class="hljs-attr">stopOnTerminate</span>: <span class="hljs-literal">true</span>,
  	<span class="hljs-attr">locationProvider</span>: BackgroundGeolocation.ACTIVITY_PROVIDER,
  	<span class="hljs-attr">interval</span>: <span class="hljs-keyword">this</span>.runnerInterval,
  	<span class="hljs-attr">fastestInterval</span>: <span class="hljs-number">10000</span>,
  	<span class="hljs-attr">activitiesInterval</span>: <span class="hljs-number">30000</span>,
  	<span class="hljs-attr">stopOnStillActivity</span>: <span class="hljs-literal">false</span>,
  	<span class="hljs-attr">notificationIconColor</span>: Colors.primary,
  	<span class="hljs-attr">notificationIconSmall</span>: <span class="hljs-string">'notification_icon'</span>,<font></font>
	});<font></font>
 <font></font>
     <span class="hljs-comment">//    start()      </span>
                    	BackgroundGeolocation.on(<span class="hljs-string">'authorization'</span>, status =&gt; {
  	<span class="hljs-keyword">if</span> (status !== BackgroundGeolocation.AUTHORIZED) {
    	<span class="hljs-comment">//   </span>
  	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status.hasPermissions) {
        <span class="hljs-comment">// hasPermission -  ,    </span><font></font>
  	}<font></font>
	});<font></font>
 <font></font>
     <span class="hljs-comment">//  </span><font></font>
                    	BackgroundGeolocation.start();<font></font>
};<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons ici que vous pouvez √©galement d√©finir les param√®tres de la notification, une ic√¥ne (√† partir des ressources natives). </font><font style="vertical-align: inherit;">Et les autorisations? </font><font style="vertical-align: inherit;">Pour Android, apr√®s l'installation du package, rien n'est requis, la biblioth√®que prendra en charge les demandes d'acc√®s √† la g√©olocalisation du syst√®me. </font><font style="vertical-align: inherit;">Mais pour un fonctionnement normal sur iOS dans Xcode, vous devez √©galement activer le traitement en arri√®re-plan et les mises √† jour d'emplacement dans l'onglet Signature et capacit√©s du projet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/q9/yw/vnq9ywwhisotkblbxko5g3je3he.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous impl√©mentons la m√©thode principale pour enregistrer et envoyer des coordonn√©es dans l'√©v√©nement on ('location') de la m√™me m√©thode. </font><font style="vertical-align: inherit;">Il fonctionnera √† la fois avec l'application active et dans l'√©tat r√©duit:</font></font><br>
<br>
<pre><code class="javascript hljs">BackgroundGeolocation.on(<span class="hljs-string">'location'</span>, location =&gt; {<font></font>
    BackgroundGeolocation.startTask(<span class="hljs-keyword">async</span> taskKey =&gt; {
     <span class="hljs-comment">//       ,</span>
     <span class="hljs-comment">//     iOS-</span>
      <span class="hljs-keyword">const</span> batteryLevel = <span class="hljs-keyword">this</span>.isSimulator<font></font>
        ? <span class="hljs-number">100</span>
        : (<span class="hljs-keyword">await</span> DeviceInfo.getBatteryLevel()) * <span class="hljs-number">100</span>;
      <span class="hljs-keyword">const</span> updateDelta = location.time - <span class="hljs-keyword">this</span>.lastUpdateAt;<font></font>
<font></font>
     <span class="hljs-comment">//      </span>
      <span class="hljs-keyword">this</span>.props.locationUpdate(location);
      <span class="hljs-keyword">this</span>.props.locationAddTrackerData({
        <span class="hljs-attr">altitude</span>: location.altitude,
        <span class="hljs-attr">batteryChargeLevel</span>: batteryLevel,
        <span class="hljs-attr">latitude</span>: location.latitude,
        <span class="hljs-attr">longitude</span>: location.longitude,
        <span class="hljs-attr">course</span>: location.bearing,
        <span class="hljs-attr">accuracy</span>: location.accuracy,
        <span class="hljs-attr">speed</span>: location.speed,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Number</span>(<span class="hljs-built_in">String</span>(location.time).substr(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)),
        <span class="hljs-attr">isAlertOn</span>: <span class="hljs-literal">false</span>,<font></font>
      });<font></font>
<font></font>
     <span class="hljs-comment">//  ?</span>
      <span class="hljs-keyword">if</span> (updateDelta / <span class="hljs-number">1000</span> &gt; config.sendInterval) {
        <span class="hljs-keyword">this</span>.syncDataWithInterval();
        <span class="hljs-keyword">this</span>.lastUpdateAt = location.time;<font></font>
      }<font></font>
<font></font>
     <span class="hljs-comment">//    AsyncStorage,    </span><font></font>
      Storage.setLastKnownLocation(location);<font></font>
      BackgroundGeolocation.endTask(taskKey);  <span class="hljs-comment">//   !</span><font></font>
    });<font></font>
});<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous appelons action √† partir du magasin, o√π nous transf√©rons les donn√©es de coordonn√©es dans un format personnalis√©, stockant en outre des donn√©es sur les lectures de la batterie, √† l'aide de la biblioth√®que React-Native-Device-Info. </font><font style="vertical-align: inherit;">Tout cela fonctionne aussi bien sur Android et iOS lorsque l'application est active ou en arri√®re-plan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, il existe des m√©thodes pour obtenir l'emplacement actuel (mais cela ne fonctionne que lorsque le service est en cours d'ex√©cution), en s'abonnant aux transitions de l'√©tat de l'application de l'actif √† l'arri√®re-plan, en passant aux param√®tres syst√®me de l'application. </font><font style="vertical-align: inherit;">Cependant, dans l'ensemble, le plus n√©cessaire est donn√© dans ces exemples. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le r√©sultat est un composant qui peut √™tre mont√©, par exemple, uniquement pour la pi√®ce autoris√©e:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForegroundService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
	<span class="hljs-comment">//...</span><font></font>
	componentDidMount() {<font></font>
		<span class="hljs-keyword">this</span>.startBackgroundService(<span class="hljs-keyword">this</span>.props.config);<font></font>
	}<font></font>
<font></font>
	componentWillUnmount() {<font></font>
    BackgroundGeolocation.stop();<font></font>
    BackgroundGeolocation.removeAllListeners();<font></font>
  }<font></font>
<font></font>
	startBackgroundService = <span class="hljs-function">(<span class="hljs-params">config: GeotrackerConfig</span>) =&gt;</span> {<font></font>
    BackgroundGeolocation.configure({<font></font>
		<span class="hljs-comment">// ...</span><font></font>
	};<font></font>
<font></font>
	render() {<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
  }<font></font>
} </code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si react-navigation est utilis√©, vous pouvez cr√©er la navigation pour la pi√®ce autoris√©e comme suit:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//  StackNavigator   </span>
<span class="hljs-keyword">const</span> Navigator = createStackNavigator(RouteConfigs, NavigatorConfig);<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppNavigator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
  <span class="hljs-keyword">static</span> router: NavigationRouter = Navigator.router;<font></font>
<font></font>
  componentDidMount(): <span class="hljs-keyword">void</span> {<font></font>
    SplashScreen &amp;&amp; SplashScreen.hide();<font></font>
  }<font></font>
<font></font>
  render() {<font></font>
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ForegroundService</span> <span class="hljs-attr">navigation</span>=<span class="hljs-string">{this.props.navigation}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Navigator</span> {<span class="hljs-attr">...this.props</span>} /&gt;</span>
      <span class="hljs-tag">&lt;/&gt;</span></span><font></font>
    );<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> AppNavigator;</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, ce navigateur peut √™tre utilis√© de la mani√®re habituelle dans le navigateur racine:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> RootNavigator = createSwitchNavigator(<font></font>
  {<font></font>
    <span class="hljs-attr">Auth</span>: AuthNavigator,
    <span class="hljs-attr">App</span>: AppNavigator,<font></font>
  },<font></font>
  {<font></font>
    <span class="hljs-attr">initialRouteName</span>: <span class="hljs-string">'Auth'</span>,<font></font>
  },<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createAppContainer(RootNavigator);</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le service de g√©olocalisation et d'√©change de donn√©es ne fonctionnera que dans la partie autoris√©e de l'application.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sumer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous avons examin√© les fonctionnalit√©s de l'utilisation de React Native dans les applications de g√©olocalisation. </font><font style="vertical-align: inherit;">Comme nous l'avons d√©couvert, √† l'aide de ce cadre, les d√©veloppeurs peuvent d√©sormais facilement suivre les coordonn√©es g√©ographiques de l'appareil - par exemple, dans les trackers de v√©los, les applications pour les courriers et les transitaires, les applications pour le choix de l'immobilier, etc. </font><font style="vertical-align: inherit;">La biblioth√®que couvre la plupart des cas li√©s √† la g√©olocalisation, en particulier, elle vous permet d'ajuster les intervalles et d'√©conomiser l'√©nergie de l'appareil, elle fonctionne de mani√®re stable en arri√®re-plan sur les deux plates-formes et prend en charge l'ex√©cution automatique sur Android. </font><font style="vertical-align: inherit;">Dans le m√™me temps, pour les applications complexes, le d√©veloppement natif est g√©n√©ralement plus adapt√© (par exemple, pour travailler avec des calculs et des widgets, comme nous l'avons d√©j√† √©crit dans l' </font><font style="vertical-align: inherit;">article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©c√©dent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merci de votre attention, nous esp√©rons que l'article vous a √©t√© utile!</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493302/index.html">Quelles technologies ont d√©j√† √©t√© sollicit√©es pour lutter contre les coronavirus?</a></li>
<li><a href="../fr493304/index.html">D√©velopper un hexapode √† partir de z√©ro (partie 8) - mouvement math√©matique am√©lior√©</a></li>
<li><a href="../fr493306/index.html">Utilisation des API de passerelle comme point d'entr√©e unique pour les applications Web et les API</a></li>
<li><a href="../fr493308/index.html">Exp√©rience r√©elle du transfert de presque tous les employ√©s vers un site distant</a></li>
<li><a href="../fr493310/index.html">Game of God: Organismes artificiels</a></li>
<li><a href="../fr493320/index.html">√âtendez Laravel avec nos propres composants</a></li>
<li><a href="../fr493322/index.html">IT GRAD: premi√®res impressions du format de travail √† distance</a></li>
<li><a href="../fr493332/index.html">Pourquoi les imageurs thermiques ne peuvent pas mesurer la temp√©rature corporelle d'une personne</a></li>
<li><a href="../fr493334/index.html">52 milliards d'attaques: menaces de Trend Micro 2019</a></li>
<li><a href="../fr493336/index.html">Comment l'informatique a traduit l'apprentissage en ligne</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>