<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☸️ 💺 📘 Feindliche KI: Jage einen Spieler ohne Navigation2D und finde den Pfad A * 😳 🔑 🏚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein Spiel erstellen, in dem Feinde einen Spieler jagen müssen? Alles beginnt mit einem einfachen - wir lassen den Feind zum Spieler rennen. Aber was p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Feindliche KI: Jage einen Spieler ohne Navigation2D und finde den Pfad A *</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496878/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Spiel erstellen, in dem Feinde einen Spieler jagen müssen? </font><font style="vertical-align: inherit;">Alles beginnt mit einem einfachen - wir lassen den Feind zum Spieler rennen. </font><font style="vertical-align: inherit;">Aber was passiert, wenn es sich hinter einem Baum oder um die Ecke einer Mauer befindet? </font><font style="vertical-align: inherit;">Nun, jetzt wird der Feind ziemlich dumm aussehen - er wird auf ein Objekt stoßen und an Ort und Stelle fingern. </font><font style="vertical-align: inherit;">Nicht sehr gut! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Problem zu lösen, können Sie die in Godot integrierten Navigation2D- oder AStar-Knoten verwenden ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier ist das GDQuest-Lernprogramm für beide Knoten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Aber in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helms of Fury haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir eine andere Methode verwendet, die für unser Spiel hervorragend funktioniert hat, und wir möchten sie in diesem Tutorial teilen. </font><font style="vertical-align: inherit;">So sieht es aus:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2d/ub/ss/2dubss3iyd2rns37pn9pzrjjybk.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An die Arbeit gehen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir gehen davon aus, dass Sie Feinde als KinematicBody2D-Objekte erstellen und eine Zustandsmaschine verwenden, um deren Zustände zu steuern. </font><font style="vertical-align: inherit;">Nicht sicher, was eine Zustandsmaschine ist? </font><font style="vertical-align: inherit;">Ich mag </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesen Artikel, in dem Zustandsautomaten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und ihre Verwendung erklärt werden. </font><font style="vertical-align: inherit;">Hier ist ein weiterer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel über die Implementierung einfacher Zustandsmaschinen in Godot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit einem einfachen Verfolgungszustand für einen dummen Feind, der nur zu seinem Ziel rennt und irgendwo auf dem Weg stecken bleibt:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># ChaseState.gd</span><font></font>
<font></font>
func _init(enemy, params):<font></font>
  enemy.dir = (enemy.target.position - enemy.position).normalized()<font></font>
<font></font>
func _physics_process(delta):<font></font>
  var motion = enemy.dir * enemy.speed<font></font>
  enemy.move_and_slide(motion)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geruchsspuren</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Zustand zu verbessern, werden wir den Spieler zwingen, beim Bewegen eine Spur von seinen vorherigen Positionen zu hinterlassen. </font><font style="vertical-align: inherit;">Wenn der Feind den Spieler nicht sieht, prüft er dank dessen, ob eine seiner früheren Positionen sichtbar ist, und folgt ihnen dann zum Spieler. </font><font style="vertical-align: inherit;">Da dies ähnlich ist, wie ein Hund einen Fußabdruck nimmt, nennen wir es einen Geruchsfußabdruck. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit die Geruchsverfolgung funktioniert, müssen wir dem Player den Timer-Knoten hinzufügen, ihn automatisch starten und wait_time einstellen (wir haben 0,1s verwendet) und dann den Code hinzufügen, damit der Player am Ende des Countdowns einen Geruch hinterlässt.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># Player.gd</span><font></font>
extends KinematicBody2D<font></font>
<font></font>
const scent_scene = preload(<span class="hljs-string">"res://Player/Scent.tscn"</span>)<font></font>
<font></font>
var scent_trail = []<font></font>
<font></font>
func _ready():<font></font>
  $ScentTimer.connect(<span class="hljs-string">"timeout"</span>, self, <span class="hljs-string">"add_scent"</span>)<font></font>
<font></font>
func add_scent():<font></font>
  var scent      = scent_scene.instance()<font></font>
  scent.player   = player<font></font>
  scent.position = player.position<font></font>
<font></font>
  Game.level.effects.add_child(scent)<font></font>
  scent_trail.push_front(scent)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann müssen Sie die verlassene Scent.tscn selbst hinzufügen. </font><font style="vertical-align: inherit;">Dies ist eine einfache Node2D-Szene, die einen Timer enthält, damit der Geruch abläuft.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># Player.gd</span><font></font>
extends KinematicBody2D<font></font>
<font></font>
const scent_scene = preload(<span class="hljs-string">"res://Player/Scent.tscn"</span>)<font></font>
<font></font>
var scent_trail = []<font></font>
<font></font>
func _ready():<font></font>
  $ScentTimer.connect(<span class="hljs-string">"timeout"</span>, self, <span class="hljs-string">"add_scent"</span>)<font></font>
<font></font>
func add_scent():<font></font>
  var scent      = scent_scene.instance()<font></font>
  scent.player   = player<font></font>
  scent.position = player.position<font></font>
<font></font>
  Game.level.effects.add_child(scent)<font></font>
  scent_trail.push_front(scent)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie möchten, dass Gerüche während des Debuggens sichtbar sind, können Sie ihnen einen ColorRect-Knoten hinzufügen und ihn dann einfach ausblenden. </font><font style="vertical-align: inherit;">Wenn Sie dies getan haben, werden Sie feststellen, dass beim Laufen hinter dem Spieler eine Spur von Geruch vorhanden ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt müssen wir die Feinde der inneren Bluthunde wecken, damit sie diesen neuen Gerüchen folgen, wenn sie den Spieler nicht sehen. </font><font style="vertical-align: inherit;">Dazu müssen wir den Feinden RayCast2D-Knoten hinzufügen und in Godot Physik-Ebenen einrichten, damit der Strahl weiß, womit er Kollisionen verursachen kann.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Physikschichten</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um Physik-Ebenen in Godot einzurichten, müssen Sie im oberen Menü auf Projekt und dann auf Projekteinstellungen klicken, dann zum Abschnitt Ebenennamen in der unteren linken Ecke gehen und dann 2D-Physik auswählen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://s3.amazonaws.com/manakeep/users/58991d6d3c545a24383fe280/2020-04-06/physics_layers.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gib ihnen einen passenden Namen. </font><font style="vertical-align: inherit;">Gehen Sie danach zu den Objekten im Spiel und erweitern Sie Kollision in der Seitenleiste des Eigenschafteninspektors. Klicken Sie dann auf ··, um sie zuzuweisen. </font><font style="vertical-align: inherit;">Für Objekte müssen sie als Ebenen zugewiesen werden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://s3.amazonaws.com/manakeep/users/58991d6d3c545a24383fe280/2020-04-06/picking_physics_layers.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie den Objekten die Physik-Ebenen zugewiesen haben, müssen Sie die RayCast2D der Feinde so ändern, dass die Ebenen überprüft werden, durch die sich die Feinde nicht bewegen können (in unserem Fall ist dies fest, Objekt, Kiste, Loch, Tor geschlossen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Einrichten der Physik-Ebenen besteht der letzte Schritt darin, den Status der Verfolgung zu ändern.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># ChaseState.gd</span><font></font>
<font></font>
func _init(enemy, params):<font></font>
  chase_target()<font></font>
<font></font>
func chase_target():<font></font>
  var look     = enemy.get_node(<span class="hljs-string">"RayCast2D"</span>)<font></font>
  look.cast_to = (enemy.target.position - enemy.position)<font></font>
  look.force_raycast_update()<font></font>
<font></font>
  <span class="hljs-comment"># if we can see the target, chase it</span>
  <span class="hljs-keyword">if</span> !look.is_colliding():<font></font>
    enemy.dir = look.cast_to.normalized()<font></font>
<font></font>
  <span class="hljs-comment"># or chase first scent we can see</span>
  <span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">for</span> scent <span class="hljs-keyword">in</span> enemy.target.scent_trail:<font></font>
      look.cast_to = (scent.position - enemy.position)<font></font>
      look.force_raycast_update()<font></font>
<font></font>
      <span class="hljs-keyword">if</span> !look.is_colliding():<font></font>
        enemy.dir = look.cast_to.normalized()<font></font>
        <span class="hljs-keyword">break</span><font></font>
<font></font>
func _physics_process(delta):<font></font>
  var motion = enemy.dir * enemy.speed<font></font>
  enemy.move_and_slide(motion)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der Feind in den Verfolgungszustand eintritt, beginnt er zu versuchen, den Spieler neu zu besetzen, und wenn ihm nichts im Weg steht, wird er ihm folgen! </font><font style="vertical-align: inherit;">Wenn etwas unterwegs ist, geht er zu den Geruchsspuren und versucht, jeden von ihnen neu zu wirken, bis er einen von ihnen findet, und verfolgt ihn dann!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://s3.amazonaws.com/manakeep/users/58991d6d3c545a24383fe280/2020-04-06/twitter-700x400.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und jetzt funktioniert alles, die Feinde wurden zu Bluthunden. </font><font style="vertical-align: inherit;">Um das System zu verbessern, ist es möglich, ein System zur Vermeidung von Kollisionen zwischen Feinden zu implementieren. Dies ist jedoch ein Thema für einen separaten Artikel.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496868/index.html">Small Space Symphony</a></li>
<li><a href="../de496870/index.html">Android deklarative Programmierung von Client-Server-Anwendungen</a></li>
<li><a href="../de496872/index.html">Neues Hyperledger Fabric: Go SDK-Softwaremodell</a></li>
<li><a href="../de496874/index.html">Wir untersuchen die Mediastreamer2 VoIP-Engine. Teil 9</a></li>
<li><a href="../de496876/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 410 (6. - 12. April 2020)</a></li>
<li><a href="../de496880/index.html">VDI Skala-R BPM. Was ist es und woher kommt es?</a></li>
<li><a href="../de496882/index.html">So starten Sie USB Type-C in Ihren Designs</a></li>
<li><a href="../de496884/index.html">Theorie der "g-Gruppen"</a></li>
<li><a href="../de496886/index.html">Elon Musk enthüllte den Zweck der Kamera über dem Rückspiegel in Tesla Model 3</a></li>
<li><a href="../de496888/index.html">Startup verwendet AI, um nach Molekülen zu suchen, die bei der Bekämpfung des Coronavirus helfen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>