<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ùóÔ∏è ‚òùüèø üôèüèΩ Acc√©l√©rer le frontend. Quand beaucoup de demandes de serveur sont bonnes ü§öüèª üë®‚Äçüëß‚Äçüë¶ üë©üèª‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article d√©crit certaines m√©thodes pour acc√©l√©rer le chargement des applications frontales afin d'impl√©menter une interface utilisateur rapide et r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Acc√©l√©rer le frontend. Quand beaucoup de demandes de serveur sont bonnes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/490210/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet article d√©crit certaines m√©thodes pour acc√©l√©rer le chargement des applications frontales afin d'impl√©menter une interface utilisateur rapide et r√©active. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous discuterons de l'architecture g√©n√©rale du frontend, comment pr√©charger les ressources n√©cessaires et augmenter la probabilit√© qu'elles soient dans le cache. </font><font style="vertical-align: inherit;">Nous verrons un peu comment donner des ressources depuis le backend et quand il est possible de se limiter √† des pages statiques au lieu d'une application cliente interactive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le processus de t√©l√©chargement est divis√© en trois √©tapes. </font><font style="vertical-align: inherit;">Pour chaque √©tape, nous formulons des strat√©gies g√©n√©rales pour augmenter la productivit√©:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendu initial</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : combien de temps faut-il √† l'utilisateur pour voir au moins quelque chose</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©duisez les demandes de blocage du rendu</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvitez les cha√Ænes s√©quentielles</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©utiliser les connexions au serveur</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travailleurs de service pour le rendu instantan√©</font></font></li>
</ul></li>
<li><b> </b>:   ,     <br>
<ul>
<li>    .    .    <br>
</li>
<li>,        <br>
</li>
<li>       <br>
</li>
<li>     <br>
</li>
<li>    </li>
</ul></li>
<li><b> </b>:        <br>
<ul>
<li>    ,   <br>
</li>
<li>      </li>
</ul></li>
</ol><a name="habracut"></a><br>
<h1> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'au rendu initial, l'utilisateur ne voit rien √† l'√©cran. De quoi avons-nous besoin pour ce rendu? Au minimum, t√©l√©chargez un document HTML et, dans la plupart des cas, des ressources suppl√©mentaires, telles que des fichiers CSS et JavaScript. Une fois qu'ils sont disponibles, le navigateur peut commencer une sorte de rendu. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Les</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
graphiques </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebPageTest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont fournis tout au long de cet article </font><font style="vertical-align: inherit;">. La s√©quence de requ√™tes pour votre site ressemblera probablement √† ceci. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/36a/970/f6e/36a970f6e3069679776958e6e0ef10d8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le document HTML charge un tas de fichiers suppl√©mentaires et la page est rendue apr√®s leur t√©l√©chargement. Veuillez noter que les fichiers CSS sont charg√©s en parall√®le les uns aux autres, donc chaque demande suppl√©mentaire n'ajoute pas de retard significatif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Remarque: dans la capture d'√©cran, gov.uk est un exemple o√π </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">HTTP / 2 est</font></a><font style="vertical-align: inherit;"> maintenant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">activ√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">afin que le domaine de ressources puisse r√©utiliser une connexion existante. </font><font style="vertical-align: inherit;">Voir ci-dessous pour les connexions au serveur.)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©duisez les demandes de blocage du rendu</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les feuilles de style et (par d√©faut) les scripts bloquent le rendu de tout contenu en dessous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe plusieurs options pour r√©soudre ce probl√®me:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©placez les balises de script au bas du corps </font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargez des scripts en mode asynchrone en utilisant </font></font><code>async</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si JS ou CSS doivent √™tre charg√©s s√©quentiellement, il est pr√©f√©rable de les incorporer avec de petits extraits</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvitez les conversations avec des requ√™tes s√©quentielles qui bloquent le rendu</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le retard dans le rendu du site n'est pas n√©cessairement associ√© √† un grand nombre de requ√™tes qui bloquent le rendu. </font><font style="vertical-align: inherit;">Plus important est la taille de chaque ressource, ainsi que l'heure de d√©but de son t√©l√©chargement. </font><font style="vertical-align: inherit;">Autrement dit, le moment o√π le navigateur se rend soudain compte que cette ressource doit √™tre t√©l√©charg√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le navigateur d√©tecte la n√©cessit√© de t√©l√©charger le fichier uniquement apr√®s avoir termin√© une autre demande, il existe une cha√Æne de demandes. </font><font style="vertical-align: inherit;">Il peut se former pour diverses raisons:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√®gles </font></font><code>@import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Polices Web r√©f√©renc√©es par le fichier CSS</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balises JavaScript ou script t√©l√©chargeables</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetez un ≈ìil √† cet exemple: l' </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ebe/a1b/e44/ebea1be44487e800d63034b7fb2e9b79.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
un des fichiers CSS de ce site charge la police Google via la r√®gle </font></font><code>@import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cela signifie que le navigateur doit ex√©cuter √† tour de r√¥le les requ√™tes suivantes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Document HTML</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Applications CSS</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS pour les polices Google</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier Google Font Woff (non illustr√© dans le diagramme)</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour r√©soudre ce probl√®me, d√©placez d'abord la demande CSS Google Fonts de la balise </font></font><code>@import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers le lien dans le document HTML. </font><font style="vertical-align: inherit;">Nous raccourcissons donc la cha√Æne d'un maillon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour acc√©l√©rer encore plus les choses, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int√©grez Google Fonts CSS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> directement dans votre fichier HTML ou CSS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Gardez √† l'esprit que la r√©ponse CSS du serveur Google Fonts d√©pend de la ligne d'agent utilisateur. Si vous faites une demande √† l'aide d'IE8, le CSS fera r√©f√©rence au fichier EOT, le navigateur IE11 recevra le fichier woff et les navigateurs modernes recevront le fichier woff2. Si vous acceptez que les anciens navigateurs seront limit√©s aux polices syst√®me, vous pouvez simplement copier et coller le contenu du fichier CSS pour vous-m√™me).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√™me apr√®s le d√©but du rendu, il est peu probable que l'utilisateur puisse interagir avec la page, car la police doit √™tre charg√©e pour afficher le texte. </font><font style="vertical-align: inherit;">Il s'agit d'un retard de r√©seau suppl√©mentaire que j'aimerais √©viter. </font><font style="vertical-align: inherit;">Le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param√®tre swap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est utile ici </font><font style="vertical-align: inherit;">, il vous permet de l'utiliser </font></font><code>font-display</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec Google Fonts et de stocker des polices localement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, la cha√Æne de requ√™te ne peut pas √™tre r√©solue. </font><font style="vertical-align: inherit;">Dans de tels cas, vous pouvez envisager </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la balise de pr√©charge ou de pr√©connexion</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Par exemple, le site Web de l'exemple ci-dessus peut se connecter </font></font><code>fonts.googleapis.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avant l'arriv√©e de la demande CSS r√©elle.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©utilisation des connexions serveur pour acc√©l√©rer les demandes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour √©tablir une nouvelle connexion au serveur, n√©cessite g√©n√©ralement trois √©changes de paquets entre le navigateur et le serveur:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recherche DNS</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtablir une connexion TCP</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtablir une connexion SSL</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois la connexion √©tablie, au moins un autre √©change de paquets est requis pour envoyer une demande et recevoir une r√©ponse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le tableau ci - </font><font style="vertical-align: inherit;">dessous montre que nous initions une connexion avec quatre serveurs diff√©rents: </font></font><code>hostgator.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>optimizely.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>googletagmanager.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>googelapis.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les demandes de serveur suivantes peuvent r√©utiliser une connexion existante</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le t√©l√©chargement </font></font><code>base.css</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">soit </font></font><code>index1.css</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arrive plus vite parce qu'ils sont situ√©s sur le m√™me serveur </font></font><code>hostgator.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec lequel une connexion a d√©j√† √©t√© √©tablie.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/78d/f76/03c/78df7603c84c54788fbec82a7d0622c7.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©duisez la taille des fichiers et utilisez CDN</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous contr√¥lez deux facteurs qui affectent le temps d'ex√©cution de la requ√™te: la taille des fichiers de ressources et l'emplacement des serveurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Envoyez le moins de donn√©es possible √† l'utilisateur et assurez-vous qu'elles sont compress√©es (par exemple, en utilisant brotli ou gzip). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les r√©seaux de distribution de contenu (CDN) ont des serveurs partout dans le monde. </font><font style="vertical-align: inherit;">Au lieu de se connecter √† un serveur central, un utilisateur peut se connecter √† un serveur CDN plus proche. </font><font style="vertical-align: inherit;">Ainsi, l'√©change de paquets sera beaucoup plus rapide. </font><font style="vertical-align: inherit;">Ceci est particuli√®rement adapt√© aux ressources statiques telles que CSS, JavaScript et les images, car elles sont faciles √† distribuer via CDN.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âliminez la latence du r√©seau avec les employ√©s de service</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les techniciens de maintenance vous permettent d'intercepter les demandes avant de les envoyer au r√©seau. </font><font style="vertical-align: inherit;">Cela signifie que la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©ponse vient presque instantan√©ment</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c0c/5b2/7bd/c0c5b27bd4df5e42b3b8e57b2dfb02f2.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, cela ne fonctionne que si vous n'avez vraiment pas besoin de recevoir de donn√©es du r√©seau. </font><font style="vertical-align: inherit;">La r√©ponse doit d√©j√† √™tre mise en cache, donc l'avantage n'appara√Ætra qu'√† partir du deuxi√®me t√©l√©chargement d'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'agent de service ci-dessous met en cache le code HTML et CSS n√©cessaire pour rendre la page. </font><font style="vertical-align: inherit;">Lorsque l'application se charge √† nouveau, elle essaie d'√©mettre elle-m√™me les ressources mises en cache - et acc√®de au r√©seau uniquement si elles ne sont pas disponibles.</font></font><br>
<br>
<pre><code class="javascript hljs">self.addEventListener(<span class="hljs-string">"install"</span>, <span class="hljs-keyword">async</span> e =&gt; {<font></font>
 caches.open(<span class="hljs-string">"v1"</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cache</span>) </span>{
   <span class="hljs-keyword">return</span> cache.addAll([<span class="hljs-string">"/app"</span>, <span class="hljs-string">"/app.css"</span>]);<font></font>
 });<font></font>
});<font></font>
<font></font>
self.addEventListener(<span class="hljs-string">"fetch"</span>, event =&gt; {<font></font>
 event.respondWith(<font></font>
   caches.match(event.request).then(<span class="hljs-function"><span class="hljs-params">cachedResponse</span> =&gt;</span> {
     <span class="hljs-keyword">return</span> cachedResponse || fetch(event.request);<font></font>
   })<font></font>
 );<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce guide,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expliqu√© en d√©tail sur l'utilisation des services pour pr√©charger et mettre en cache les ressources.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargez l'application</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'utilisateur voit quelque chose √† l'√©cran. </font><font style="vertical-align: inherit;">Quelles autres √©tapes sont n√©cessaires pour qu'il utilise l'application?</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©charger le code d'application (JS et CSS)</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargez les donn√©es requises pour la page</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargez des donn√©es et des images suppl√©mentaires</font></font></li>
</ol><br>
<img src="https://habrastorage.org/getpro/habr/post_images/175/e7f/810/175e7f810d7e33f9647203ad609b402f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que non seulement le t√©l√©chargement de donn√©es √† partir du r√©seau peut retarder le rendu. </font><font style="vertical-align: inherit;">Une fois votre code charg√©, le navigateur doit l'analyser, le compiler et l'ex√©cuter.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargez uniquement le code n√©cessaire et maximisez le nombre de hits dans le cache</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬´Casser un package¬ª signifie t√©l√©charger uniquement le code n√©cessaire pour la page en cours, pas l'application enti√®re. </font><font style="vertical-align: inherit;">Cela signifie √©galement que des parties du package peuvent √™tre mises en cache, m√™me si d'autres parties ont chang√© et doivent √™tre recharg√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En r√®gle g√©n√©rale, le code est divis√© en plusieurs parties:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code pour une page sp√©cifique (sp√©cifique √† la page)</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code d'application commun</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modules tiers qui changent rarement (id√©al pour la mise en cache!)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webpack peut automatiquement effectuer cette optimisation, casser le code et r√©duire le poids total de la charge. </font><font style="vertical-align: inherit;">Le code est divis√© en morceaux √† l'aide de l'objet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimisation.splitChunks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">S√©parez le runtime (runtime) dans un fichier s√©par√©: de cette fa√ßon, vous pouvez b√©n√©ficier d'une mise en cache √† long terme. </font><font style="vertical-align: inherit;">Ivan Akulov a √©crit un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guide d√©taill√© sur la d√©composition d'un package en fichiers s√©par√©s et la mise en cache dans Webpack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'est pas possible d'allouer automatiquement du code pour une page sp√©cifique. </font><font style="vertical-align: inherit;">Vous devez identifier manuellement les pi√®ces pouvant √™tre t√©l√©charg√©es s√©par√©ment. </font><font style="vertical-align: inherit;">Il s'agit souvent d'un chemin ou d'un ensemble de pages sp√©cifique. </font><font style="vertical-align: inherit;">Utilisez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des importations dynamiques</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour charger paresseusement ce code.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La division du package global en parties augmentera le nombre de demandes de t√©l√©chargement de votre application. Mais ce n'est pas un gros probl√®me si les requ√™tes sont ex√©cut√©es en parall√®le, surtout si le site est charg√© en utilisant le protocole HTTP / 2. Vous pouvez le voir pour les trois premi√®res requ√™tes dans le diagramme suivant: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/995/816/714/9958167144c54dc634d1b7daa03077e3.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, deux requ√™tes cons√©cutives sont √©galement visibles dans le diagramme. Ces fragments sont n√©cessaires uniquement pour cette page particuli√®re et ils sont charg√©s dynamiquement </font></font><code>import()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez essayer de r√©soudre le probl√®me en ins√©rant une pr√©charge de balise de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©charge</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/955/2cf/efc/9552cfefcbb751b50e378a0834320b73.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais nous constatons que le temps total de chargement des pages a augment√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le pr√©chargement des ressources est parfois contre-productif car il retarde le chargement de fichiers plus importants. Lis</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Article d'Andy Davis sur le pr√©chargement des polices</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et comment cette proc√©dure bloque le d√©but du rendu de page.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chargement de donn√©es pour une page</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Votre application devrait probablement afficher des donn√©es. </font><font style="vertical-align: inherit;">Voici quelques conseils que vous pouvez utiliser pour t√©l√©charger ces donn√©es t√¥t sans d√©lais de rendu inutiles.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'attendez pas le t√©l√©chargement complet du package avant de commencer le t√©l√©chargement des donn√©es</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un cas particulier d'une cha√Æne de requ√™tes s√©quentielles: vous t√©l√©chargez l'int√©gralit√© du package d'application, puis ce code demande les donn√©es n√©cessaires pour la page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a deux fa√ßons d'√©viter cela:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incorporer des donn√©es dans un document HTML</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cutez une demande de donn√©es √† l'aide du script int√©gr√© dans le document</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'incorporation des donn√©es dans HTML garantit que l'application n'attend pas son chargement. Cela r√©duit √©galement la complexit√© du syst√®me, car vous n'avez pas besoin de g√©rer l'√©tat de d√©marrage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, ce n'est pas une bonne id√©e si une telle technique retarde le rendu initial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, ainsi que si vous soumettez un document HTML mis en cache via un technicien de service, vous pouvez utiliser le script int√©gr√© pour t√©l√©charger ces donn√©es comme alternative. Vous pouvez le rendre disponible en tant qu'objet global, voici une promesse:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>.userDataPromise = fetch(<span class="hljs-string">"/me"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si les donn√©es sont pr√™tes et dans une telle situation, l'application peut imm√©diatement d√©marrer le rendu ou attendre qu'elle soit pr√™te. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous utilisez les deux m√©thodes, vous devez savoir √† l'avance quelles donn√©es la page va charger avant que l'application ne commence le rendu. </font><font style="vertical-align: inherit;">Cela est g√©n√©ralement √©vident pour les donn√©es li√©es √† l'utilisateur (nom d'utilisateur, notifications, etc.), mais plus difficile avec un contenu sp√©cifique √† une page particuli√®re. </font><font style="vertical-align: inherit;">Il est peut-√™tre judicieux de mettre en √©vidence les pages les plus importantes et d'√©crire votre propre logique pour elles.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne bloquez pas le rendu en attendant des donn√©es non pertinentes</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, pour g√©n√©rer des donn√©es, vous devez ex√©cuter une logique complexe lente sur le backend. </font><font style="vertical-align: inherit;">Dans de tels cas, vous pouvez d'abord essayer de t√©l√©charger une version plus simple des donn√©es, si cela suffit pour rendre l'application fonctionnelle et interactive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, un outil d'analyse peut d'abord t√©l√©charger une liste de tous les graphiques avant de charger des donn√©es. </font><font style="vertical-align: inherit;">Cela permet √† l'utilisateur de rechercher imm√©diatement le diagramme qui l'int√©resse, et aide √©galement √† distribuer les requ√™tes backend √† diff√©rents serveurs.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/996/ab6/613/996ab66136976b0b22d95e7778fb4664.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvitez les requ√™tes de donn√©es cons√©cutives</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela peut contredire le paragraphe pr√©c√©dent selon lequel il est pr√©f√©rable de publier des donn√©es non essentielles dans une demande distincte. </font><font style="vertical-align: inherit;">Par cons√©quent, il convient de clarifier: √©viter les cha√Ænes avec des demandes de donn√©es s√©quentielles, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si chaque demande termin√©e ne conduit pas au fait que l'utilisateur dispose de plus d'informations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de demander d'abord quel utilisateur est connect√©, puis de demander une liste de ses groupes, renvoyez imm√©diatement la liste des groupes avec les informations sur l'utilisateur dans la premi√®re requ√™te. </font><font style="vertical-align: inherit;">Vous pouvez utiliser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GraphQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour cela </font><font style="vertical-align: inherit;">, mais le point de terminaison </font></font><code>user?includeTeams=true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionne √©galement tr√®s bien.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendu c√¥t√© serveur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le rendu c√¥t√© serveur signifie le pr√©-rendu de l'application, donc un code HTML pleine page est renvoy√© √† la demande du client. Le client voit la page compl√®tement restitu√©e, sans attendre le chargement de code ou de donn√©es suppl√©mentaires! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que le serveur envoie au client uniquement du code HTML statique, l'application n'est pas interactive √† ce stade. Vous devez t√©l√©charger l'application elle-m√™me, d√©marrer la logique de rendu, puis connecter les √©couteurs d'√©v√©nements n√©cessaires au DOM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilisez le rendu c√¥t√© serveur si la visualisation de contenu non interactif est pr√©cieuse en soi. Il est √©galement agr√©able de mettre en cache le HTML rendu sur le serveur et de le renvoyer imm√©diatement √† tous les utilisateurs sans d√©lai. Par exemple, le rendu c√¥t√© serveur est id√©al lorsque vous utilisez React pour afficher des articles de blog. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet article de Mikhail Yanashek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©crit comment combiner les travailleurs de service et le rendu c√¥t√© serveur.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page suivante</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä un moment donn√©, l'utilisateur s'appr√™te √† appuyer sur un bouton et √† passer √† la page suivante. </font><font style="vertical-align: inherit;">√Ä partir du moment o√π vous ouvrez la page de d√©marrage, vous contr√¥lez ce qui se passe dans le navigateur, vous pouvez donc vous pr√©parer √† la prochaine interaction.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©chargement des ressources</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous pr√©chargez le code n√©cessaire pour la page suivante, le d√©lai dispara√Æt lorsque l'utilisateur d√©marre la navigation. </font><font style="vertical-align: inherit;">Utilisez des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">balises de pr√©lecture</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><code>webpackPrefetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour l'importation dynamique:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span>(
    <span class="hljs-comment">/* webpackPrefetch: true, webpackChunkName: "todo-list" */</span> <span class="hljs-string">"./TodoList"</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez le type de charge que vous placez sur l'utilisateur en termes de trafic et de bande passante, surtout s'il est connect√© via une connexion mobile. </font><font style="vertical-align: inherit;">Si une personne a t√©l√©charg√© la version mobile du site et que le mode de stockage des donn√©es est actif, il est raisonnable de pr√©charger de mani√®re moins agressive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©fl√©chissez strat√©giquement aux parties de l'application dont l'utilisateur aura besoin auparavant.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©utilisation de donn√©es d√©j√† t√©l√©charg√©es</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mettez les donn√©es en cache localement dans votre application et utilisez-les pour √©viter de futures demandes. </font><font style="vertical-align: inherit;">Si l'utilisateur passe de la liste de ses groupes √† la page ¬´Modifier le groupe¬ª, vous pouvez effectuer la transition instantan√©ment, en r√©utilisant les donn√©es pr√©c√©demment t√©l√©charg√©es sur le groupe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que cela ne fonctionnera pas si l'objet est souvent modifi√© par d'autres utilisateurs et que les donn√©es t√©l√©charg√©es peuvent devenir obsol√®tes. </font><font style="vertical-align: inherit;">Dans ces cas, il existe une option pour afficher d'abord les donn√©es en lecture seule existantes tout en ex√©cutant simultan√©ment une demande de donn√©es mises √† jour.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet article r√©pertorie un certain nombre de facteurs qui peuvent ralentir votre page √† diff√©rentes √©tapes du processus de chargement. Des outils tels que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome DevTools</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebPageTest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lighthouse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous aideront √† d√©terminer lesquels de ces facteurs affectent votre application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la pratique, l'optimisation va rarement imm√©diatement dans toutes les directions. Nous devons d√©couvrir ce qui a le plus d'impact sur les utilisateurs et nous concentrer sur cela.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant que j'√©crivais l'article, j'ai r√©alis√© une chose importante: j'avais une croyance bien ancr√©e que de nombreuses demandes de serveur individuelles √©taient mauvaises pour les performances. </font><font style="vertical-align: inherit;">C'√©tait le cas dans le pass√©, lorsque chaque demande n√©cessitait une connexion distincte, et les navigateurs n'autorisaient que quelques connexions par domaine. </font><font style="vertical-align: inherit;">Mais avec HTTP / 2 et les navigateurs modernes, ce n'est plus le cas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe de bons arguments en faveur de la division de l'application en plusieurs parties (avec multiplication des requ√™tes). </font><font style="vertical-align: inherit;">Cela vous permet de t√©l√©charger uniquement les ressources n√©cessaires et il est pr√©f√©rable d'utiliser le cache, car seuls les fichiers modifi√©s devront √™tre recharg√©s.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490196/index.html">[Flipper Zero] refusez le Raspberry Pi, faites notre propre planche √† partir de z√©ro. Trouver la bonne puce WiFi</a></li>
<li><a href="../fr490198/index.html">Faites confiance mais v√©rifiez! Zone de d√©monstration avec projecteurs Epson pour home cin√©ma dans la salle de d√©monstration Pult.ru</a></li>
<li><a href="../fr490202/index.html">Comptage de requ√™tes: test de base des performances Django</a></li>
<li><a href="../fr490204/index.html">Le condens√© des √©v√©nements pour les recruteurs RH et IT en mars 2020</a></li>
<li><a href="../fr490208/index.html">Section backend sur DUMP2020: badinage, ventilateur, √©chec</a></li>
<li><a href="../fr490222/index.html">Biblioth√®que standard du jour de la mort</a></li>
<li><a href="../fr490224/index.html">Furtivit√© √† la mode</a></li>
<li><a href="../fr490226/index.html">Blending et Unity Terrain: comment se d√©barrasser des intersections et arr√™ter de se faire mal aux yeux</a></li>
<li><a href="../fr490242/index.html">Service de localisation GSM des modules SIM800x et son travail avec l'API Yandex.Locator</a></li>
<li><a href="../fr490244/index.html">Optimisation de code Python avec ctypes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>