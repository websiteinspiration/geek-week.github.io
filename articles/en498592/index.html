<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äç‚úàÔ∏è üêè üë©üèæ‚Äçüîß Now I understand why almost no one encrypts their mail üõ°Ô∏è üå´Ô∏è üë©üèæ‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Email encryption is a difficult and painful procedure. Recently, I myself realized how much. A friend of mine, very advanced in the field of informati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Now I understand why almost no one encrypts their mail</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/globalsign/blog/498592/"><div style="text-align:center;"><img src="https://cheapskatesguide.org/pics/sealed-640.jpg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Email encryption is a difficult and painful procedure. Recently, I myself realized how much. A friend of mine, very advanced in the field of information security, sent me her PGP public key and asked me to switch to encryption. No, she‚Äôs not from the NSA or the CIA, she‚Äôs just an ordinary person who cares about her privacy. I had never sent encrypted letters before, but I thought, ‚ÄúWhy not?‚Äù For many years I wanted to learn this, but there was no one to exchange encrypted letters with. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I started by installing GnuPG on my Linux machine.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GnuPG is similar to PGP in that it uses public and private keys for encryption and decryption, but comes with open source code and comes with many Linux distributions. Another open source version of PGP is OpenPGP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GnuPG for Windows called Gpg4win can be downloaded from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">official website</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . I chose a general method of encrypting and decrypting messages, which is not tied to any email provider, because I did not want to limit myself to the ability to encrypt only one provider. In addition, the only way to make sure that even the mail provider does not have access to your letters is to encrypt them yourself. I found the most comprehensive GnuPG guide on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How-To Geek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I imported my friend‚Äôs public key using this command:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --import her_public_key_file.key</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This command </font></font><code>her_public_key_file.key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is replaced with the actual public key file. </font><font style="vertical-align: inherit;">Then I checked that her key was imported successfully:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --list-keys</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A message like this appeared:</font></font><br>
<br>
<pre><code class="bash hljs">pub 2048R/FFE7947D 2019-10-11 [expires: 2021-10-10]<font></font>
uid her_email@her_email_provider.com<font></font>
sub 2048R/AB48FEC2 2019-10-11</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This means that GnuPG recognizes its public key as valid and saves it for future use. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then signed her public key:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --sign-key her_email_address@email_provider.com</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Signing the public key tells GnuPG that you trust this key, that is, it really came from this person. </font><font style="vertical-align: inherit;">Each public key must be signed before messages from the owner of this public key can be decrypted. </font><font style="vertical-align: inherit;">In my opinion, this step does not make any sense. </font><font style="vertical-align: inherit;">Why would you import a key if you do not think it came from the right person? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then I tried to generate my keys:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --output ~/temp.key --armor --<span class="hljs-built_in">export</span> My Name </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, after such a command, an error message popped up that the end of a new line was found. I thought that this could be due to spaces in my name and between the name and email address, so I tried various formats. After about an hour and many unsuccessful attempts, some of which looked like successful, but were not, I finally found the right command:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --gen-key</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The above command asks you a series of questions. </font><font style="vertical-align: inherit;">At first I chose option ‚Äú1‚Äù, then I chose the option of 2048-bit key length. </font><font style="vertical-align: inherit;">Set an unlimited key validity period. </font><font style="vertical-align: inherit;">I did not indicate the surname in the name field, but spaces are also supported there: you can specify both the name and surname. </font><font style="vertical-align: inherit;">Then entered his email address. </font><font style="vertical-align: inherit;">The comment field is left blank. </font><font style="vertical-align: inherit;">And finally, he introduced a long passphrase. </font><font style="vertical-align: inherit;">A passphrase is simply a synonym for a password. </font><font style="vertical-align: inherit;">I wrote it down where it won‚Äôt get lost. </font><font style="vertical-align: inherit;">In fact, I put it in a file encrypted using Truecrypt. </font><font style="vertical-align: inherit;">A passphrase will be needed later in order to encrypt messages in case of reinstalling GnuPG on the hard drive and re-importing the keys. </font><font style="vertical-align: inherit;">And do not forget to backup the keys themselves! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After creating the keys, we check the result:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --list-keys</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This command produces something like this:</font></font><br>
<br>
<pre><code class="bash hljs">pub 2048R/FFE7947D 2019-10-11 [expires: 2021-10-10]<font></font>
uid her_email@her_email_provider.com<font></font>
sub 2048R/AB48FEC2 2019-10-11<font></font>
<font></font>
<font></font>
pub 2048R/3A785D3F 2020-02-22<font></font>
uid My Name<font></font>
sub 2048R/A7B384FE 2020-02-22</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I ran the key generation twice because I was not sure if this result means there is a pair of public / private keys or only one key. </font><font style="vertical-align: inherit;">Somehow, I eventually realized that I had created two key pairs, so I deleted the second pair. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then I tried to export my public key to a file. </font><font style="vertical-align: inherit;">The public key must be sent to everyone to whom you send an encrypted letter so that it can decrypt it. </font><font style="vertical-align: inherit;">I'm not sure which command I used, but it produced a text file that starts with </font></font><code>-----BEGIN PGP PUBLIC KEY BLOCK----- Version: GnuPG v1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">I sent this letter to my friend, and she answered me with an encrypted message. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I tried to decrypt the file </font></font><code>message.asc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with her letter:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --decrypt message.asc &gt; plain.txt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But GnuPG gave an error message that it could not find the secret key:</font></font><br>
<br>
<pre><code class="bash hljs">gpg: encrypted with RSA key, ID XXXXXXXX<font></font>
gpg: decryption failed: secret key not available</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But I saw my secret key. I could even export it. I knew he was! What can I say, sometimes programmers write really terrible error messages. At this point, I had already begun to experience some irritation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I did not know what I did wrong. The only thing I could assume was that somehow I couldn‚Äôt create the keys correctly. Either that, or I exported the wrong public key. So I decided to start all over again. I deleted my key pair, generated a new key pair and exported my public key to a file using this command:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --output ~/my_public_gpg_key.key --armor --<span class="hljs-built_in">export</span> My Name my-email@my-email-povider.com</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then he sent a friend a new public key. The parameter </font></font><code>--armor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tells GnuPG to create the public key file in text form. File Name - </font></font><code>my_public_gpg_key.key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
She again encrypted her message and sent it to me. When I tried to decrypt it, I again saw the same error message:</font></font><br>
<br>
<pre><code class="bash hljs">gpg: encrypted with RSA key, ID XXXXXXXX<font></font>
gpg: decryption failed: secret key not available</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This time, I noticed that the key identifier matches my old public key, not the new one. I decided that she was wrong, and asked her to try again with a new key. Then, to make sure that I was not mistaken, I decided to check that the key that I used was really my new key. The new key that I sent was not even one of my public keys! It was her public key that started with </font></font><code>-----BEGIN PGP PUBLIC KEY BLOCK----- Version: GnuPG v1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! Somehow I exported her key with the addition </font></font><code>Version: GnuPG v1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! I know this because I still had a file with her key that she sent me, and it starts with </font></font><code>-----BEGIN PGP PUBLIC KEY BLOCK-----</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Not there </font></font><code>Version: GnuPG v1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! And her public key matches the one I sent her.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I re-exported my public key using the same command above. This time I checked that it was really my key before sending it to her by e-mail. From Internet GnuPG reference materials, I learned that a message about the absence of a secret key may appear if people use different versions of GnuPG. I mentioned this to her when I sent a new key by email.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A few weeks later I received a response letter. By this time, I had already decided that she had surrendered. Over the following weeks, I had some problems with the computer, which made it necessary to reformat the hard drive. So I had to reinstall GnuPG, re-import my keys and re-import its public key. Fortunately, I made backups! Then I answered her last letter with another letter that I encrypted with this command:</font></font><br>
<br>
<pre><code class="bash hljs">gpg --encrypt --sign --armor -r her-email@her-email-provider.com --passphrase my-pass-phrase my-msg.txt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, this is not my real password, I replaced it with </font></font><code>my-pass-phrase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the unencrypted message with </font></font><code>my-msg.txt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A ciphertext was generated and its file was named </font></font><code>my-msg.tx.gpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. I could not find any information on how to decrypt my own ciphertext myself, so I had to send it to her, not knowing if I had encrypted it correctly. I only knew that he seemed to be the right size. After a couple of weeks, I received from her a new encrypted letter on a different topic. Only then did the confidence appear that I had finally reached the point where we can successfully communicate via encrypted email. The whole process from start to finish took more than a month! I'm still trying to automate the GnuPG commands so I can use them without thinking too much about what I'm doing.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From this experience, I realized that encrypted email, although an interesting exercise, is not very practical. Unless you are the Edward Snowden monitored by the NSA, you are unlikely to be able to justify the effort to create and use encrypted mail. And if you are not Edward Snowden with important secrets, it is unlikely that anyone will want to spend energy on encrypting correspondence with you.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encrypting and decrypting email, as I have with GnuPG, is just too tedious. </font><font style="vertical-align: inherit;">Since I have already spent too much effort on this, I will continue to use it to communicate with my online friend. </font><font style="vertical-align: inherit;">But I would not recommend that an ordinary person use GnuPG to encrypt email, if this can be avoided. </font><font style="vertical-align: inherit;">I understand that there are simpler solutions on the market from specific mail providers, such as Protonmail, but most people will not want to change the provider to use them. </font><font style="vertical-align: inherit;">We all need an easier way to send and receive encrypted mail without changing the mail provider. </font><font style="vertical-align: inherit;">GnuPG is not a solution. </font><font style="vertical-align: inherit;">If you know a simpler way to encrypt mail, please consider leaving a comment.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/la/or/-y/laor-yldjqn4hfjnnkpdnpq9dda.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en498574/index.html">Why did I decide to develop games, or a nostalgic trip for zero</a></li>
<li><a href="../en498576/index.html">How we developed the field for entering new messages in our messenger (Gem4me)</a></li>
<li><a href="../en498580/index.html">Quantification of the "bowl effect" on tomographic images</a></li>
<li><a href="../en498582/index.html">Get and switch WebVTT subtitles in ExoPlayer</a></li>
<li><a href="../en498588/index.html">What awaits at the first job</a></li>
<li><a href="../en498602/index.html">B.P. Gerasimovich - astrophysicist and man</a></li>
<li><a href="../en498604/index.html">Remove your children from our blue screens, or why you can‚Äôt buy Yandex.Station for a child</a></li>
<li><a href="../en498608/index.html">Making of NES gameinvitro "MULTIDEFENDER"</a></li>
<li><a href="../en498610/index.html">How to reuse code with symfony 5 bundles? Part 3. Integration of the bundle with the host: templates, styles, JS</a></li>
<li><a href="../en498612/index.html">Do not decide for the designer the task of the designer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>