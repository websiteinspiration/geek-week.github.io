<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌁 👂🏿 🧚🏾 リモート作業を含む、シスコの脅威応答を使用したDNSpionageキャンペーンの調査 👇 🛕 🍁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="私は無料のCisco Threat Response（CTR）ソリューションについて繰り返し話しました。これにより、ファイルハッシュ、IPアドレス、ドメイン名、電子メールアドレスなど、さまざまなタイプの侵害インジケーターによって特徴付けられるインシデントを調査する時間を大幅に短縮できます。しかし、過...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>リモート作業を含む、シスコの脅威応答を使用したDNSpionageキャンペーンの調査</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/494140/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私は無料のCisco Threat Response（CTR）ソリューションについて繰り返し話しました。これにより、ファイルハッシュ、IPアドレス、ドメイン名、電子メールアドレスなど、さまざまなタイプの侵害インジケーターによって特徴付けられるインシデントを調査する時間を大幅に短縮できます。しかし、過去のメモは、個別のシスコソリューションでCTRを使用する例、またはGosSOPKAとFinCERTとの統合のいずれかに当てられていました。今日は、CTRを使用して、社内のさまざまな目標に対して多くのベクトルを使用できる個々のハッカーキャンペーンを調査する方法について説明します。例として、前の記事で述べた</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNSpionageキャンペーン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を考えて</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">みましょう</font></a><font style="vertical-align: inherit;">。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前回、1つのソリューションであるCisco Stealthwatch Enterpriseネットワーク異常分析システムでそれを検出する方法を示しました。次に、DNSプロトコルを使用して、悪意のあるクライアント部分とコマンドサーバーとのやり取りを記録しました。DNSプロトコルは、企業ネットワーク内の不正なノードで使用されているかどうかの指標として機能しました。実際、ネットワークトラフィックの異常を探して、インシデントの兆候を探しました。次に、悪意のあるアクティビティ（IOC）のより身近なインジケーターを使用してDNSpionageキャンペーンを識別する方法を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指標のリストは脅威インテリジェンスの掲示板で確認できます。この場合、最初にDNSpionageキャンペーンを明らかにした世界最大の非政府インシデント調査グループであるCisco Talosのサイトを使用します（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/if/ov/-1/ifov-1vhdwekrvyy45jaovtiix4.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニュースレターには、インジケーターのリストが表示されます。ファイルハッシュ、コマンドのIPアドレスとドメインアドレス、および攻撃に関与しているフィッシングサーバーです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/dy/bv/xpdybvedg1uraqxn0yo2m1ehzpy.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
適切な保護手段を使用して各インジケーターを「駆動」すると、時間がかかりすぎます。たとえば、EDRクラスのソリューションであるCisco AMP for Endpointsで、関心のある1つまたは複数のハッシュを検索バー（右上）に入力します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jd/us/2b/jdus2bkm5mu_b4s0l1cdnr9vtri.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、関心のある結果が表示されます-悪意のあるプログラムのアクティビティが検出されたノードが見つかりました。 。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tl/ea/6q/tlea6qaed_a8kcopyzzfepcx07m.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、ハッシュ検索は悪意のあるアクティビティを検出するだけでなく、情報漏えい対策にも利用できることを付け加えておきます。リークに対処するためのテクノロジーの1つは（コンテナー/タグおよびコンテンツ分析とともに）デジタル指紋の使用であることを思い出してください。これは、AMP4Eが制御するハッシュだけでなく、他のシスコソリューションに含まれる可能性のあるものを使用して実装できます。実装されたAMPエンジン-Cisco Firepower、Cisco Email Security Appliance、Cisco Web Security Appliance、Cisco Umbrellaなど）。確かに、このようなメカニズムはほとんど変更されていないファイルに対してのみ機能します。リークに対処するためにシスコが提供するものに興味がある場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">録音</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">プレゼンテーションを</font></a><font style="vertical-align: inherit;">お勧めし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このトピックに特化した最新のウェビナー。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、私たちの話に戻りましょう。</font><font style="vertical-align: inherit;">コマンドまたはフィッシングサーバーのドメインへのアクセスを追跡する場合、Cisco Umbrellaが役立ちます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c2/1x/gx/c21xgx-dvavn5o9cgpjurhzr4mm.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのインシデントにおける感染の主な原因は電子メールであるため、電子メールで関心のある指標を探す必要もあります。</font><font style="vertical-align: inherit;">これを行うには、Ciscoセキュリティ管理アプライアンスまたはCisco Eメールセキュリティアプライアンスで対応するインジケータのハッシュを示し</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/ul/r8/ygulr8dih6q_5u4xb77qmdel2eq.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。探しているファイルのトレースが見つかった5つのメールボックスが見つかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fy/zm/pf/fyzmpftvdwyxm2gejaovdfsgmb0.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、侵入防御システムが組み込まれた次世代ファイアウォールであるCisco Firepowerは、悪意のあるキャンペーンのクライアント部分が対話するIPアドレスを追跡（およびブロック）するのに役立ちます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yn/zk/y7/ynzky7yzkvxxrhipzos4ypgu7iu.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、DNSpionageの兆候を検出しましたが、期待したほど速くは行っていません。コンソールを切り替えています。私たちは多くの過去のコピー操作を実行しており、4つの異なる製品が4つの異なるタイプの侵害の兆候を探しているため、調査と対応の時間が長くなります。このプロセスを加速できますか？もちろん。 SIEMを使用できます。SIEMは、TIソースと統合するか、外部のTIソースから侵害のインジケーターをダウンロードできます。しかし、それが商業的である場合、またはオープンソースのカテゴリからのものである場合、高い能力が必要な場合は高価です。よりシンプルで無料のソリューションがあります。CiscoThreat Responseは、主にシスコのソリューションだけでなく、他のベンダーのソリューションにも焦点を当てています。ブラウザプラグインを使用して、DNSpionageキャンペーンを説明するCisco Talosブログページからすべての指標を「引き出し」ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vk/wz/sh/vkwzshjii1wgjxmth16plgfxb5e.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
応答プロセスをスピードアップするために、プラグインを介して関連するインジケーターを直接ブロックできます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w1/jw/iw/w1jwiwoxjpkmmvm_is3eunkjnga.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、どのノードとユーザーが侵害されたかを理解するために、インシデントを調査することに関心があります。また、すべてを1つの画面に表示することをお勧めします。 CTRはこの機会を与えてくれます。グラフィカルインターフェイスの左上に、すべてのインジケーターが表示されます。左下-「感染」の地図。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qb/p9/mr/qbp9mrufw-sj1vki2ofqyyuemgo.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
紫は、PC、メールボックス、サブネットなど、インフラストラクチャですでに影響を受けているターゲットを示しています。右上には、ネットワーク環境でのインジケーターの表示（最初を含む）の日付を表示するタイムラインがあります。最後に、右下の領域では、VirusTotalやサードパーティの保護ツールなどの外部TIソースによって強化および検証された、各インジケータに関する詳細情報を取得できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l9/jx/yq/l9jxyqsjricd3smbegy3su8hsoy.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
感染の程度を理解した後、コマンドサーバードメインとの相互作用をブロックするCisco Umbrella </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/0c/ac/xp0cactpyjnuh4dnluuvjediqhg.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を介して、または悪意のあるファイルまたはプロセスの操作を分離するCisco AMP for Endpointsを介して</font><font style="vertical-align: inherit;">、発生をブロックすることにより、特定された脅威に適切に対応し始めることができます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/un/jz/mo/unjzmo-jhiuzledetjvf-t_q5fy.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CTRインターフェースからすぐに、ファイル、ドメイン、またはその他のインジケーターをブロックした結果を確認できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hk/qa/jo/hkqajo70ap-vqaw4gc51wfulglg.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CTRをCisco EメールセキュリティアプライアンスまたはCisco Firepowerと統合することにより、感染したメールボックスまたは侵害されたサイトをそれぞれ分離することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じことをすることは可能ですが、Cisco Threat Responseインターフェイスを使用しなくても可能ですか？時々、あなたはこれのためにあなた自身のより身近なツールを使いたいです。はい、できます。たとえば、ブラウザーをサポートする任意のテクノロジー（たとえば、独自のポータル）にCTR機能を組み込むことができます。また、APIを利用できるため、どこからでもCTR関数にアクセスできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドラインインターフェースを好み、キーボードからすべてのコマンドを入力して調査および応答したいとします。これも簡単です。たとえば、ここでは、CTR統合がCisco Webex Teamsチームワークシステムと連携する方法と、DNSpionageキャンペーンを例として使用して、そのために開発されたAskWillボットを示します。 Cisco Webex Teamsは、お客様が情報セキュリティの専門家とのやり取りを整理するためによく使用されます。この例は、SOCスペシャリストを統合する唯一のものが通信システムであるときに、リモートで作業するときに調査と対応のプロセスを構築する方法を示しているため、さらに興味深いものです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、DNSpionageの一部としてコマンドサーバーによって使用されたドメイン0ffice36o.comのステータスを取得したいとします。 Cisco Umbrellaが「malicious」のステータスを返すことがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g6/ml/p6/g6mlp61yd2fe8a1lr48j2kwvgju.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、インフラストラクチャ内のCisco Talosによって一度に特定されたDNSpionageキャンペーンの侵害の兆候がいくつかあるかどうかに関する情報をチームがどのように探すかを以下に示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aw/2l/ax/aw2laxyma1otgdyvtp5ewi1sduu.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Cisco UmbrellaまたはCisco Stealthwatch Cloudを介して悪意のあるドメインをブロックできます。後者の場合、異常分析システムは、Amazon AWS、MS Azureクラウドインフラストラクチャなどのコマンドサーバーとのやり取りをブロックします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kz/yp/ba/kzypbayjmcv56maxri4jjmblzgq.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、誤ってインジケーターをブロックした場合、または時間の経過とともにインジケーターが脅威を停止したことが判明した場合は、保護ソリューションのブラックリストから削除できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bh/a5/rs/bha5rsgaph_on7cm55cbvucvm5c.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが無料のCisco Threat Responseソリューションの仕組みであり、主なタスクはインシデントの調査と対応にかかる時間を短縮することです。</font><font style="vertical-align: inherit;">そして、お客様の言うとおり、CTRを使用すると大幅に削減できます。</font><font style="vertical-align: inherit;">ユーザーの60％が50％削減しています。</font><font style="vertical-align: inherit;">さらに23％は少なくとも25％を持っています。</font><font style="vertical-align: inherit;">無料のソリューションとしては悪くありませんね。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加情報：</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Threat ResponseとCisco Stealthwatch Enterpriseの統合</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GosSOPKoyとFinCERTにおけるシスコソリューションの相互作用</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シスコがSplunkを購入しない理由、またはシスコプラットフォームが脅威ハンティングにどのように機能するかについての話</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シスコの可視性による脅威ハンティング</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク異常分析ツールの使用に関するケーススタディ：DNSpionageキャンペーンの発見</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja494128/index.html">ハックスペースニューロン-ハッカーがモスクワで集まる場所</a></li>
<li><a href="../ja494130/index.html">オンラインイベントはどうなるか：統計の一部</a></li>
<li><a href="../ja494132/index.html">PythonのBefungeコンパイラ</a></li>
<li><a href="../ja494136/index.html">かゆみを防ぐために目に入るもの</a></li>
<li><a href="../ja494138/index.html">人権とアルゴリズム：米国、オーストラリア、ロシア、EUでは著作権の総当たりは機能しません</a></li>
<li><a href="../ja494152/index.html">HoughNet：古典的なアルゴリズムと融合した消失点の検索</a></li>
<li><a href="../ja494154/index.html">ビデオエンコーディングを8倍高速化する方法</a></li>
<li><a href="../ja494156/index.html">在宅勤務の方法-Pleskリムーバーの経験</a></li>
<li><a href="../ja494158/index.html">検疫下での作業の品質を維持する方法</a></li>
<li><a href="../ja494162/index.html">pgCenterを使用したPostgresのトラブルシューティング。アレクセイ・レソフスキー</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>