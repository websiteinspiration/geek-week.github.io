<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò≠ üë®üèº‚Äçüè≠ üë®üèæ‚Äç‚öïÔ∏è How to establish secure access to servers in remote mode üßÄ üë®üèø‚Äçüî¨ ü§æüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Here on Habr√© there are already dozens of articles telling how people experienced the transition to a remote place, how they experienced the first day...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How to establish secure access to servers in remote mode</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/497384/"><img src="https://habrastorage.org/webt/bz/yf/1i/bzyf1iwo4u_rvwjplqeghc7pige.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here on Habr√© there are already dozens of articles telling how people experienced the transition to a remote place, how they experienced the first days of a remote site, then how the first week went, and so on. Sometimes some practical advice slipped between the description of emotions. We, as people with 12 years of experience in remote server administration, decided to talk about a tool without which the remote server turns into a rather dangerous event for your business. Why? - Because people think about anything (first of all, of course, about the damned free 40 minutes in the ‚Äúzoom‚Äù), but not about security. More precisely, of course, you were thinking about this issue - but we bet that he was not the first in line?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And the counter-question: I wonder what your thoughts led to. </font><font style="vertical-align: inherit;">After all, your colleagues, sitting in cozy apartments and houses, go with unprotected equipment through insecure channels and literally touch the company's servers with all of these ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We want to share with you an open-source version of the tool used in our company as a bastion server. </font><font style="vertical-align: inherit;">It is called the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DevOpsProdigy Isolate Authentication Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How it works</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Isolate adds a one-time password and two-factor authentication to the SSH login. You can use the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">YubiKey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> equipment </font><font style="vertical-align: inherit;">or the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Authenticator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> application </font><font style="vertical-align: inherit;">for this </font><font style="vertical-align: inherit;">. Even if a user has lost the password from his account, without an OTP key, an attacker cannot use it and get to the Isolate server. To implement two-factor authentication, we use the pam-module. You can read more about this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in this old article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Users do not get direct access to the end servers - the connection passes through the Isolate server, and the system monitors and records all their activity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All user actions come down to using two commands:</font></font><br>
<br>
<b><code>s &lt;search-str&gt;</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- to search for information by project name or server name, information is stored in the built-in Redis database, which is closed by authorization. </font></font><br>
<br>
<b><code>g &lt;ip-address&gt; / g &lt;project-name&gt; &lt;server-name&gt;</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- a call to this command starts </font></font><code>/usd/bin/ssh </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Arguments for the call (for example, username, ip-address, port, proxy) are taken from the database. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. It is easy to manage access to the authentication server - add / remove users, etc. You can find a large number of examples on the use of commands in the readme </font></font><b><code>auth-add-user</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><b><code>auth-add-host</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Technically, you need to generate and put the Isolate server key on the destination servers, and your users must get regular access to the Isolate server from sudo to ssh.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And when they want to connect to the destination server, the system will execute the ssh command. Next, an ssh client launched from a privileged user will receive a key, using which the system, in turn, will gain access to the desired server. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's all. Isolate runs on </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CentOS 7 / Ubuntu 16.04 / Debian 9 setup</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ansible 2.3+ is</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> also needed </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I cannot but note that </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DevOpsProdigy Isolate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It‚Äôs also useful in ‚Äúpeacetime‚Äù: you can be calm with it for your servers, even if someone loses a laptop with an SSH key. </font><font style="vertical-align: inherit;">And when an employee who had access leaves the company, you will not have to rush to change all passwords and keys. </font><font style="vertical-align: inherit;">Now we are preparing a list of improvements and features for the current version of this tool, which are implemented in our internal system. </font><font style="vertical-align: inherit;">We are waiting for wishes, issue's, PR in our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">For discussions and questions, there is also a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telegram chat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chat in Slack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So now remote work in your company may become a little easier. </font><font style="vertical-align: inherit;">And for sure - much safer. </font><font style="vertical-align: inherit;">Good luck</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497368/index.html">Hackintosh on Powermac G5 or how to assemble a workstation</a></li>
<li><a href="../en497370/index.html">Investing in PPC, increasing LTV and mobile conversion - which brings together fast-growing companies</a></li>
<li><a href="../en497372/index.html">Alexander Zeynalov: ‚ÄúYou may not even know that you have OpenStreetMap, but it will be it‚Äù</a></li>
<li><a href="../en497376/index.html">What to do with red cheeks so that your nose does not grow</a></li>
<li><a href="../en497382/index.html">8 difficulties of Agile teams during the pandemic: ‚ÄúNdagwurugwu nke anya mmiri‚Äù, ·ª•j·ªç, oke iwe, ag·ªçnar, COVID-19</a></li>
<li><a href="../en497386/index.html">VK Fellowship fellows talk about the future of distance learning, discipline and socialization</a></li>
<li><a href="../en497388/index.html">A millionth shooter from scratch: an indie developer path</a></li>
<li><a href="../en497390/index.html">How we learned to recommend films and why you shouldn‚Äôt rely only on ratings</a></li>
<li><a href="../en497392/index.html">How to grow from a student a software engineer?</a></li>
<li><a href="../en497394/index.html">Ten Resources with Computer Science Courses Available for Free in April</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>