<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçº ü§¥üèæ üßëüèº Pointill√© sur les capteurs de gaz de la s√©rie MQ - compr√©hension approfondie de la fiche technique et du r√©glage üòü üëß üî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apr√®s avoir achet√© un d√©tecteur de fuite de gaz, il y avait un d√©sir de tout d√©monter sur les √©tag√®res et de savoir ce qui se passe √† l'int√©rieur. Il ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pointill√© sur les capteurs de gaz de la s√©rie MQ - compr√©hension approfondie de la fiche technique et du r√©glage</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490654/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/aj/tw/2i/ajtw2iwb5ombl2yqqgfhyxotoz0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir achet√© un d√©tecteur de fuite de gaz, il y avait un d√©sir de tout d√©monter sur les √©tag√®res et de savoir ce qui se passe √† l'int√©rieur. Il y a beaucoup d'informations et d'articles sur les capteurs, mais la plupart se limitent au brochage du module chinois standard, parfois aux principes de fonctionnement. √Ä propos de la d√©termination relativement pr√©cise des valeurs absolues des informations. √Ä l'avenir, je dirai que nous allons essayer de tout extraire de la fiche technique, y compris: les fonctions exactes de d√©termination des "perroquets", la correction de la temp√©rature et de l'humidit√© et certaines possibilit√©s de s√©lection.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, un capteur de gaz combustible (principalement du m√©thane) MQ-4. </font><font style="vertical-align: inherit;">En bref, l'√©l√©ment capteur, en raison de ses propri√©t√©s chimiques, change de r√©sistance √† diff√©rentes concentrations de gaz et agit comme une r√©sistance du diviseur de tension dont nous obtenons la valeur de tension via l'ADC. </font><font style="vertical-align: inherit;">Ces propri√©t√©s se manifestent √† une certaine temp√©rature de l'√©l√©ment pour lequel le capteur doit √™tre chauff√©.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oo/4q/wb/oo4qwb2riinmgctynzrukmkespi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ci-dessus est une repr√©sentation sch√©matique d'un capteur et d'un circuit diviseur, o√π H est une bobine de chauffage (33 Ohms - environ 150 mA, les courants sont trop importants pour les bateaux √©quip√©s de contr√¥leurs, il doit √™tre pris en compte lors de la conception d'un circuit de puissance), AV sont les sorties d'un √©l√©ment sensible √† r√©sistance interchangeable en fonction de la concentration de gaz , RL est la deuxi√®me r√©sistance de diviseur recommand√©e par la fiche technique - 20 kOhm.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaire sur le choix d'une tension de r√©f√©rence ADC (Vref)</font></font></b><div class="spoiler_text">  Hanwei    Vc = 5 ,   Winsen ‚Äì Vc &lt; 24 . ,   3.3  ,       ,      .       5  . <br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertir ADC en ppm</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aux sorties du diviseur ADC, nous prenons la valeur de tension (Uadc) sur la base de laquelle nous pouvons calculer la r√©sistance du capteur Rs (connaissant la valeur de la deuxi√®me r√©sistance du diviseur RL), c'est-√†-dire </font><font style="vertical-align: inherit;">d√©terminer exactement ce que le capteur nous transmet:</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mi>s</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>V</mi><mi>r</mi><mi>e</mi><mi>f</mi><mo>&amp;#xD7;</mo><mi>R</mi><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>U</mi><mi>a</mi><mi>d</mi><mi>c</mi><mo>&amp;#x2212;</mo><mi>R</mi><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.732ex" height="2.634ex" viewBox="0 -809.3 13662.4 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-73" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-3D" x="1506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-28" x="2563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-56" x="2952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-72" x="3722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-65" x="4173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-66" x="4640" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-D7" x="5412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-52" x="6413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-4C" x="7173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-29" x="7854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2F" x="8244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-55" x="8744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-61" x="9512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-64" x="10041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-63" x="10565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2212" x="11220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-52" x="12221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-4C" x="12980" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mi>r</mi><mi>e</mi><mi>f</mi><mo>√ó</mo><mi>R</mi><mi>L</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>U</mi><mi>a</mi><mi>d</mi><mi>c</mi><mo>‚àí</mo><mi>R</mi><mi>L</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">Rs = (Vref √óRL) / Uadc-RL</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec la valeur de Rs, nous pouvons d√©j√† d√©terminer la concentration de gaz selon le graphique de la fiche technique. </font><font style="vertical-align: inherit;">Un simple rapport Rs / Ro est utilis√© pour d√©terminer la concentration. </font><font style="vertical-align: inherit;">Ro dans ce cas est la r√©sistance de l'√©l√©ment capteur √† une concentration de gaz de d√©tection de 1000 ppm.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaire sur les points de d√©part dans les calculs</font></font></b><div class="spoiler_text">    ,       <br>
<blockquote>¬´Ro: sensor resistance at 1000ppm of CH4 in the clean air¬ª</blockquote> ,            1000 ppm.     ¬´¬ª    .     ,         ¬´  ¬ª ,  ,       1800 ppb (  1.8 ppm,    1000 ppm).     ,        4.4 Rs/Ro.<br>
</div></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pp/km/zg/ppkmzg2fcdtqu4pzjjgzliez4uq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A ce stade, gr√¢ce √† l'ADC et √† la formule, on ne conna√Æt que la valeur de la r√©sistance de courant (Rs) dont on va se repousser. </font><font style="vertical-align: inherit;">Nous supposerons que nous l'avons mesur√© dans de l'air propre (√† partir de gaz d√©tect√©s), √† la temp√©rature et √† l'humidit√© d'√©talonnage (par fiche technique 20C, 65%). </font><font style="vertical-align: inherit;">Un peu plus tard, il y aura un commentaire int√©ressant sur l'humidit√© √† laquelle l'√©talonnage est effectu√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, la valeur de r√©f√©rence Ro pour le capteur MQ-4 est:</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mi>o</mi><mo>=</mo><mi>R</mi><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>4.4</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.979ex" height="2.634ex" viewBox="0 -809.3 5588.1 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-6F" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-3D" x="1522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-52" x="2579" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-73" x="3338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2F" x="3808" y="0"></use><g transform="translate(4308,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-34" x="779" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mi>o</mi><mo>=</mo><mi>R</mi><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4.4</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">Ro=Rs/4.4</script></p><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaire sur la s√©lection de fum√©e</font></font></b><div class="spoiler_text"> ,     ,       Rs/Ro   ‚Äì 1.8‚Ä¶0.43,   ‚Äì 3.8‚Ä¶2.6.          .  ,  , ¬´¬ª   .       .  RsRo   2.8,  ¬´¬ª :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xf/ms/ay/xfmsayti8hipqb0dn1x0ymup8fe.png"></div><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le calcul de la concentration r√©elle de gaz est un peu compliqu√© par la courbure du graphique et le manque de points de contr√¥le distincts permettant d'ajuster ce graphique. </font><font style="vertical-align: inherit;">De plus, le probl√®me r√©side dans la faible expansion de l'image, √† cause de laquelle il est n√©cessaire de d√©terminer les points de contr√¥le pixel par pixel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour clarifier les calculs, les valeurs les plus √©videntes sont espac√©es sur une grille de coordonn√©es. </font><font style="vertical-align: inherit;">Les points de contr√¥le ont d√©termin√© la fonction de la d√©pendance de ppm √† Rs / Ro:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaire sur les limites de mesure</font></font></b><div class="spoiler_text">     400‚Ä¶10000 ppm.      (Winsen/Hanwei)    200  400 ppm,     400.    ppm  Rs/Ro,  x = ppm/1000; y= (Rs/Ro)*10:<br>
</div></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fm/dq/fk/fmdqfknpnud93wwitd2lgqhduea.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le graphique construit correspond √† la fonction:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uf/t-/ug/uft-ugzeblq_hebbv-id34yslg0.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le nombre de "perroquets" est reconnu par la formule:</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bc/uq/fz/bcuqfzxkyfx9sontj8xehalniyq.png"></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu sur la compensation de temp√©rature</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base du graphique de la fiche technique suivante, il est connu que, selon l'environnement dans lequel le capteur est utilis√©, les lectures s'√©cartent des valeurs r√©elles: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xa/wr/jc/xawrjc2ujhhcxuwdyzx06qnu1fk.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaire sur l'humidit√© typique de l'environnement de mesure</font></font></b><div class="spoiler_text"> ,         = 65%.       RsRo/ppm (    ppm)  RsRo/Temp (    ).     Rs/Ro = 1  ppm=1000   20,    :  33%  65%.    . ,      ,      33%.        .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour d√©terminer plus pr√©cis√©ment la d√©pendance des indicateurs vis-√†-vis de l'environnement, un graphique de fonction a √©galement √©t√© construit, le capteur est limit√© √† une plage de temp√©rature de -10 ¬∞ C ... + 50 ¬∞ C (x = TEMP / 10; y = RsRo (erreur) * 100):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uv/dc/ek/uvdcekdqdsn2szxgfm3ye1mzj08.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le graphique correspond √† la fonction:</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0.83</mn><msup><mi>x</mi><mn>2</mn></msup><mo>&amp;#x2212;</mo><mn>9.2</mn><mi>x</mi><mo>+</mo><mn>25</mn><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0.3</mn><mo>&amp;#xD7;</mo><mi>H</mi><mi>U</mi><mi>M</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.092ex" height="3.009ex" viewBox="0 -970.7 18553.2 1295.7" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-29" x="1512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-3D" x="2179" y="0"></use><g transform="translate(3236,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-38" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-33" x="1279" y="0"></use></g><g transform="translate(5016,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-32" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2212" x="6264" y="0"></use><g transform="translate(7265,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-32" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-78" x="8544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2B" x="9339" y="0"></use><g transform="translate(10340,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-35" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2212" x="11563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-28" x="12564" y="0"></use><g transform="translate(12953,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-33" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-D7" x="14455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-48" x="15456" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-55" x="16344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMATHI-4D" x="17112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/490654/&amp;usg=ALkJrhjAJbUwNO8IdgeSpbQl9JV8nbrpPg#MJMAIN-29" x="18163" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0.83</mn><msup><mi>x</mi><mn>2</mn></msup><mo>‚àí</mo><mn>9.2</mn><mi>x</mi><mo>+</mo><mn>25</mn><mo>‚àí</mo><mo stretchy="false">(</mo><mn>0.3</mn><mo>√ó</mo><mi>H</mi><mi>U</mi><mi>M</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">f(x)=0.83x^2-9.2x+25-(0.3√óHUM)</script></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La base est un graphique avec une humidit√© de 33% (il, √† en juger par l'intersection 1, est un √©talonnage). Si vous faites attention √† l'humidit√©, 1% d'humidit√© d√©cale le graphique de 0,3 Y (en valeurs r√©elles de l'ajustement, RsRo sera divis√© par 100 - le coefficient est utilis√© dans le graphique pour plus de clart√©). ¬´+25¬ª d√©cale la position du graphique en Y pour une humidit√© ¬´nulle¬ª, ¬´0,3 x HUM¬ª renvoie la position Y pour une humidit√© r√©elle. Certains changements dans le ¬´poids¬ª de 1% d'humidit√© √† des temp√©ratures extr√™mes ont peu d'importance et ne sont pas pris en compte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remarque importante: tout cela s'applique si l'√©talonnage est effectu√© √† l'air propre √† une humidit√© de 33% et une temp√©rature de 20 degr√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La valeur de correction RsRo (erreur), qui devra √™tre ajout√©e aux valeurs RsRo pour compenser l'impact environnemental, peut √™tre calcul√©e par la formule:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ap/dj/je/apdjje0di63lldgrcoho5tqwhfu.png"></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La t√¢che "avec un ast√©risque" est de clarifier la compensation lors de l'√©talonnage dans un environnement non standard</font></font></b><div class="spoiler_text">       ,       (20/33%),      RsRo(error)    :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ym/vd/kx/ymvdkxgyamyi9qaanh664cqknjc.png"></div><br>
      Y     ‚Äì   .        X:       .       ,       ,     .<br>
<br>
   ,       ,         ,          . <br>
<br>
    , ‚Äî   . <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour calculer une valeur d√©j√† compens√©e:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3r/jb/-k/3rjb-kl0vr_okrgqt5vhw9s4jeu.png"></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous transf√©rons la th√©orie au microcontr√¥leur</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour tester le capteur, le microcontr√¥leur STM32F407VET et la biblioth√®que HAL ont √©t√© utilis√©s, les valeurs de correction ont √©t√© re√ßues du capteur BME280. </font><font style="vertical-align: inherit;">Dans le fichier d'en-t√™te, nous d√©finissons des valeurs constantes pour notre configuration.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mq4.h</font></font></h4><br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MQ4_H_</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_H_</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_default_work</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>; <span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_advanced_work</span> <span class="hljs-params">(<span class="hljs-keyword">float</span> temp, <span class="hljs-keyword">float</span> hum)</span></span>; <span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_full_work</span> <span class="hljs-params">(<span class="hljs-keyword">float</span> temp, <span class="hljs-keyword">float</span> hum, <span class="hljs-keyword">float</span> temp_cal, <span class="hljs-keyword">float</span> hum_cal)</span></span>; <span class="hljs-comment">//      </span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_calib_Ro</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>; <span class="hljs-comment">// </span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_get_adc</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>; <span class="hljs-comment">//   ,   </span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_ADC hadc1 <span class="hljs-comment">//    </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_ADC_PRECISION 4096 <span class="hljs-comment">//     (4096 = 12 bit)</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_REFERENCE_VOLTAGE 3.3f <span class="hljs-comment">//  </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_STATIC_RESISTOR 20000 <span class="hljs-comment">//RL -     </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_RO_DEF 13600 <span class="hljs-comment">//Ro -   1000 ppm (RsRo=1),   </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_HUM_WEIGHT 0.3f <span class="hljs-comment">//     (  ) </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MQ4_AIR_RSRO 4.4f <span class="hljs-comment">// RsRo    (   )</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* MQ4_H_ */</span></span></code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mq4.c</font></font></h4><br>
<pre><code class="cpp hljs">mq4.c
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"mq4.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"adc.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"math.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">int</span> mq4_Rs; <span class="hljs-comment">//  </span>
<span class="hljs-keyword">int</span> mq4_adc_value; <span class="hljs-comment">// </span>
<span class="hljs-keyword">float</span> mq4_volts; <span class="hljs-comment">// </span>
<span class="hljs-keyword">float</span> mq4_RsRo; <span class="hljs-comment">//  .  . 1000 ppm</span>
<span class="hljs-keyword">float</span> mq4_calib_value;  <span class="hljs-comment">//   RsRo</span>
<span class="hljs-keyword">float</span> mq4_calib_value2; <span class="hljs-comment">//   RsRo (    )</span><font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> mq4_Ro; <span class="hljs-comment">//   1000ppm </span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> mq4_temp_cal; <span class="hljs-comment">//     </span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> mq4_hum_cal; <span class="hljs-comment">//     </span>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonction de calcul de Ppm (pas de corrections)</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_default_work</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
<span class="hljs-keyword">int</span> ppm; 
<span class="hljs-keyword">int</span> mq4_adc;
<span class="hljs-keyword">float</span> volts;
<span class="hljs-keyword">int</span> Rs;
<span class="hljs-keyword">float</span> RsRo;
<span class="hljs-comment">//  : </span><font></font>
mq4_adc = mq4_get_adc(); <font></font>
<span class="hljs-comment">//   :</span><font></font>
volts = mq4_adc/(MQ4_ADC_PRECISION/MQ4_REFERENCE_VOLTAGE); <font></font>
<span class="hljs-comment">//    :</span><font></font>
Rs = ((MQ4_REFERENCE_VOLTAGE * MQ4_STATIC_RESISTOR)/volts)- MQ4_STATIC_RESISTOR; <font></font>
<span class="hljs-comment">//    :</span>
RsRo = (<span class="hljs-keyword">float</span>)Rs / (<span class="hljs-keyword">float</span>)mq4_Ro; <font></font>
<font></font>
<span class="hljs-comment">//   ( ,  ):</span><font></font>
mq4_RsRo = RsRo; <font></font>
mq4_adc_value = mq4_adc; <font></font>
mq4_volts = volts; <font></font>
 <font></font>
<span class="hljs-keyword">if</span> (RsRo&gt;<span class="hljs-number">0.437</span>) <span class="hljs-comment">//    (  )</span>
 <span class="hljs-comment">//     :</span>
 {ppm = (<span class="hljs-built_in">pow</span>((<span class="hljs-number">10</span>/(RsRo*<span class="hljs-number">10</span>)),(<span class="hljs-number">1</span>/<span class="hljs-number">0.36152689</span>)))*<span class="hljs-number">1000</span>;} 
 <span class="hljs-comment">//     -  9999 :</span>
 <span class="hljs-keyword">else</span> {ppm=<span class="hljs-number">9999</span>;} <font></font>
 <font></font>
 <span class="hljs-keyword">return</span> (<span class="hljs-keyword">int</span>)ppm;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonction de calcul du Ppm avec compensation de la temp√©rature et de l'humidit√© actuelles</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_advanced_work</span> <span class="hljs-params">(<span class="hljs-keyword">float</span> temp, <span class="hljs-keyword">float</span> hum)</span>
</span>{
<span class="hljs-keyword">int</span> ppm; 
<span class="hljs-keyword">int</span> mq4_adc;
<span class="hljs-keyword">float</span> volts;
<span class="hljs-keyword">int</span> Rs;
<span class="hljs-keyword">float</span> RsRo;
<span class="hljs-keyword">float</span> K; <span class="hljs-comment">// </span><font></font>
<font></font>
<span class="hljs-comment">//   :</span><font></font>
mq4_adc = mq4_get_adc(); <font></font>
<span class="hljs-comment">//    :</span><font></font>
volts = mq4_adc/(MQ4_ADC_PRECISION/MQ4_REFERENCE_VOLTAGE); <font></font>
<font></font>
<span class="hljs-comment">//    </span><font></font>
Rs = ((MQ4_REFERENCE_VOLTAGE * MQ4_STATIC_RESISTOR)/volts)- MQ4_STATIC_RESISTOR; <font></font>
<span class="hljs-comment">//    :</span>
RsRo = (<span class="hljs-keyword">float</span>)Rs / (<span class="hljs-keyword">float</span>)mq4_Ro;  
<span class="hljs-comment">// :</span>
K = ((<span class="hljs-number">0.83</span>*(<span class="hljs-built_in">pow</span>((temp/<span class="hljs-number">10</span>),<span class="hljs-number">2</span>)))-(<span class="hljs-number">9.2</span>*(temp/<span class="hljs-number">10</span>))+ <span class="hljs-number">25</span> - (hum*MQ4_HUM_WEIGHT))/<span class="hljs-number">100</span>; 
<span class="hljs-comment">//  </span><font></font>
RsRo = RsRo - K; <font></font>
<font></font>
<span class="hljs-comment">//    (  )</span>
<span class="hljs-keyword">if</span> (RsRo&gt;<span class="hljs-number">0.437</span>) 
<span class="hljs-comment">//     :</span>
{ppm = (<span class="hljs-built_in">pow</span>((<span class="hljs-number">10</span>/(RsRo*<span class="hljs-number">10</span>)),(<span class="hljs-number">1</span>/<span class="hljs-number">0.36152689</span>)))*<span class="hljs-number">1000</span>;} 
<span class="hljs-comment">//     -  9999ppm:</span>
<span class="hljs-keyword">else</span> {ppm=<span class="hljs-number">9999</span>;}<font></font>
 <font></font>
<span class="hljs-comment">//    ( ,  ):</span><font></font>
mq4_RsRo = RsRo; <font></font>
mq4_calib_value = K; <font></font>
mq4_adc_value = mq4_adc; <font></font>
mq4_Rs = Rs; <font></font>
<font></font>
    <span class="hljs-keyword">return</span> ppm;<font></font>
 }<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonction de calcul du Ppm (avec compensation temp√©rature / humidit√© et correction pour le milieu d'√©talonnage)</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_full_work</span> <span class="hljs-params">(<span class="hljs-keyword">float</span> temp, <span class="hljs-keyword">float</span> hum, <span class="hljs-keyword">float</span> temp_cal, <span class="hljs-keyword">float</span> hum_cal)</span> 
<span class="hljs-comment">//:    ,       </span>
</span>{
<span class="hljs-keyword">int</span> ppm; 
<span class="hljs-keyword">int</span> mq4_adc;
<span class="hljs-keyword">float</span> volts;
<span class="hljs-keyword">int</span> Rs;
<span class="hljs-keyword">float</span> RsRo;
<span class="hljs-keyword">float</span> K;
<span class="hljs-comment">//  :</span>
temp = temp + (<span class="hljs-number">20</span> - temp_cal);  <font></font>
<font></font>
<span class="hljs-comment">//   : </span><font></font>
mq4_adc = mq4_get_adc(); <font></font>
<span class="hljs-comment">//    :</span><font></font>
volts = mq4_adc/(MQ4_ADC_PRECISION/MQ4_REFERENCE_VOLTAGE); <font></font>
<font></font>
<span class="hljs-comment">//     :</span><font></font>
Rs = ((MQ4_REFERENCE_VOLTAGE * MQ4_STATIC_RESISTOR)/volts)- MQ4_STATIC_RESISTOR; <font></font>
<span class="hljs-comment">//  :</span>
RsRo = (<span class="hljs-keyword">float</span>)Rs / (<span class="hljs-keyword">float</span>)mq4_Ro;  
<span class="hljs-comment">//  (   - MQ4_HUM_WEIGHT*(hum_cal-33)          ): </span>
K = ((<span class="hljs-number">0.83</span>*(<span class="hljs-built_in">pow</span>((temp/<span class="hljs-number">10</span>),<span class="hljs-number">2</span>)))-(<span class="hljs-number">9.2</span>*(temp/<span class="hljs-number">10</span>))+ <span class="hljs-number">25</span> - (hum*MQ4_HUM_WEIGHT)+(MQ4_HUM_WEIGHT*(hum_cal<span class="hljs-number">-33</span>)))/<span class="hljs-number">100</span>; <span class="hljs-comment">//</span>
<span class="hljs-comment">//   RsRo:</span><font></font>
RsRo = RsRo - K; <font></font>
<font></font>
<span class="hljs-keyword">if</span> (RsRo&gt;<span class="hljs-number">0.437</span>) ppm = (<span class="hljs-built_in">pow</span>((<span class="hljs-number">10</span>/(RsRo*<span class="hljs-number">10</span>)),(<span class="hljs-number">1</span>/<span class="hljs-number">0.36152689</span>)))*<span class="hljs-number">1000</span>; 
<span class="hljs-keyword">else</span> {ppm=<span class="hljs-number">9999</span>;}<font></font>
<font></font>
<span class="hljs-comment">//    ( ,  ) </span><font></font>
mq4_RsRo = RsRo; <font></font>
mq4_calib_value2 = K; <font></font>
mq4_adc_value = mq4_adc; <font></font>
mq4_Rs = Rs; <font></font>
<font></font>
   <span class="hljs-keyword">return</span> ppm;<font></font>
 }<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Valeur ADC</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_get_adc</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
 </span>{
 <span class="hljs-keyword">int</span> mq4_adc_bits; <font></font>
 HAL_ADC_Start(&amp;MQ4_ADC);<font></font>
 HAL_ADC_PollForConversion(&amp;MQ4_ADC,<span class="hljs-number">100</span>);<font></font>
 mq4_adc_bits = HAL_ADC_GetValue(&amp;MQ4_ADC);<font></font>
 HAL_ADC_Stop(&amp;MQ4_ADC);<font></font>
    <span class="hljs-keyword">return</span> mq4_adc_bits;<font></font>
 }<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtalonnage</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mq4_calib_Ro</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
<span class="hljs-keyword">float</span> mq4_adc_volts;
<span class="hljs-keyword">int</span> Rs;
<span class="hljs-keyword">int</span> Ro;
<span class="hljs-keyword">int</span> mq4_adc;<font></font>
mq4_adc = mq4_get_adc(); <font></font>
mq4_adc_volts = (<span class="hljs-keyword">float</span>)mq4_adc/((<span class="hljs-keyword">float</span>)MQ4_ADC_PRECISION/MQ4_REFERENCE_VOLTAGE); 
<span class="hljs-comment">//     </span>
Rs = (((<span class="hljs-keyword">float</span>)MQ4_REFERENCE_VOLTAGE * (<span class="hljs-keyword">float</span>)MQ4_STATIC_RESISTOR)/mq4_adc_volts)- (<span class="hljs-keyword">float</span>)MQ4_STATIC_RESISTOR;
<span class="hljs-comment">//    1000 ppm (      RsRo 4.4  MQ-4):</span><font></font>
Ro = Rs/MQ4_AIR_RSRO;<font></font>
   <span class="hljs-keyword">return</span> Ro;<font></font>
 }<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal c</font></font></h4><br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"main.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"adc.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"gpio.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"mq4.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">int</span> ppm_def;  <span class="hljs-comment">//ppm  </span>
<span class="hljs-keyword">int</span> ppm_adv;  <span class="hljs-comment">//ppm     </span>
<span class="hljs-keyword">int</span> ppm_full;  <span class="hljs-comment">//ppm        </span><font></font>
<font></font>
<span class="hljs-keyword">float</span> mq4_temp_cal = <span class="hljs-number">20</span>; <span class="hljs-comment">//    </span>
<span class="hljs-keyword">float</span> mq4_hum_cal = <span class="hljs-number">33</span>; <span class="hljs-comment">//    </span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">float</span> mq4_calib_value; <span class="hljs-comment">//   RsRo</span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">float</span> mq4_calib_value2; <span class="hljs-comment">//   RsRo c   </span><font></font>
<font></font>
<span class="hljs-keyword">int</span> mq4_Ro = MQ4_RO_DEF; <span class="hljs-comment">//   1000ppm   </span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> mq4_Rs;   <span class="hljs-comment">//    </span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> mq4_adc_value; <span class="hljs-comment">// </span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">float</span> mq4_volts; <span class="hljs-comment">//   </span>
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">float</span>  mq4_RsRo; <span class="hljs-comment">//   .  . 1000 ppm</span><font></font>
<font></font>
<span class="hljs-comment">//  :</span>
<span class="hljs-keyword">float</span> tf = <span class="hljs-number">0.0f</span>, hf = <span class="hljs-number">0.0f</span>; <span class="hljs-comment">//     </span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{<font></font>
 HAL_Init();<font></font>
 MX_GPIO_Init();<font></font>
 MX_ADC1_Init();<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
{<font></font>
 <span class="hljs-comment">//    :</span><font></font>
 ppm_def = mq4_default_work();              <font></font>
 ppm_adv = mq4_advanced_work(tf,hf);<font></font>
 ppm_full= mq4_full_work(tf,hf,mq4_temp_cal,mq4_hum_cal);<font></font>
 <span class="hljs-comment">//   : </span>
  <span class="hljs-keyword">if</span>(HAL_GPIO_ReadPin(KEY_1_GPIO_Port, KEY_1_Pin)==GPIO_PIN_RESET) <font></font>
   {<font></font>
   mq4_Ro = mq4_calib_Ro(); <span class="hljs-comment">// </span>
   mq4_temp_cal = tf;   <span class="hljs-comment">//     </span>
   mq4_hum_cal = hf;   <span class="hljs-comment">//     </span><font></font>
   }<font></font>
}<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemples d'utilisation</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©terminer la valeur ppm:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uy/ck/sk/uycksku72gsvnzsejgxqlv3cagm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction du calcul de la compensation de temp√©rature (dans ce cas, √† la m√™me humidit√©):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/px/vv/ce/pxvvceqaffjkishhom0tb_as2nw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correction des valeurs lors de l'√©talonnage dans des conditions non standard:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/p9/cq/es/p9cqesincmvt2u0lnacftqtj3ie.png"></div> <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h4><br>
<ol>
<li>,   ,       .      TGS2611 (   15-20   MQ-4).           header-      ppm (      Graph 4.4.2).</li>
<li>      1$  ,            . </li>
<li> ,    ,  RsRo    0,5‚Ä¶0,8,      (   ).        (    1000 ppm), ..     ,     .  ,   ,       ‚Äì      4‚Ä¶5 RsRo    . </li>
<li>      .      ,   ¬´¬ª    header- (     Y).</li>
<li>    ,    , .        (20  , 33%  ( 65%      )).</li>
<li>          3.8 RsRo.      ‚Äî   2.6,     1.2‚Ä¶1.5.</li>
<li>         ,     RL (   20 ,    10‚Ä¶47 ).     High Precision Resistor.</li>
</ol> <br>
<h4> </h4><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">  MQ-4</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">   Graph 4.4.2</a>      Rs/Ro.  . </li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490642/index.html">Plugin pour la surveillance des applications K8s DevOpsProdigy KubeGraf v1.3.0: nouvelle version et nouvelles fonctionnalit√©s</a></li>
<li><a href="../fr490644/index.html">R√©f√©rentiel rpm simple utilisant Inotify et webdav</a></li>
<li><a href="../fr490648/index.html">Utilisation de conteneurs Kata dans Kubernetes</a></li>
<li><a href="../fr490650/index.html">Les principales erreurs dans la compilation d'un CV par des informaticiens d√©butants</a></li>
<li><a href="../fr490652/index.html">Logistique. introduction √Ä peu pr√®s compliqu√©</a></li>
<li><a href="../fr490656/index.html">T√¢ches externes Camunda - un outil puissant pour cr√©er des applications avec une architecture r√©siliente et √©volutive</a></li>
<li><a href="../fr490660/index.html">Comment avons-nous assur√© la croissance de CityMobile</a></li>
<li><a href="../fr490664/index.html">PHP: array_key_exists recherche 500 fois plus vite que in_array</a></li>
<li><a href="../fr490668/index.html">L'histoire de la transformation du produit au projet et vice versa (en utilisant l'exemple de la bont√© dans la r√©gion de Moscou)</a></li>
<li><a href="../fr490670/index.html">Comment faire en sorte qu'une voiture √©crive des tests √† partir du code pour vous</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>