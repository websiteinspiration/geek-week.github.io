<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèæ üí± üë®üèΩ‚Äçüéì Program for changing access rights and register of file / directory names on Bash üÖ∞Ô∏è üë©üèª‚Äçüåæ ü¶Ö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As part of the laboratory exercises, we needed to write a script that, when entering the appropriate key, had to change the case of letters in the fil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Program for changing access rights and register of file / directory names on Bash</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493436/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As part of the laboratory exercises, we needed to write a script that, when entering the appropriate key, had to change the case of letters in the file / directory name from upper to lower and vice versa, change the case of the first letter of each word in the name to upper, with separate keys, which should not be executed independently, do the same conversions, but with the output of information to the terminal and perform register changes recursively.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With the teacher‚Äôs footsteps, our script has acquired additional features. </font><font style="vertical-align: inherit;">So in our script, first, checks for the presence of forbidden characters in the file names and Cyrillic alphabet appeared, a check for write permissions (we decided to limit ourselves to files with write permissions):</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-keyword">if</span> [[ -w \"<span class="hljs-variable">$n</span>\" ]]; <span class="hljs-keyword">then</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$adress</span>"</span> != *[--]* ]] &amp;&amp; [[ <span class="hljs-string">"<span class="hljs-variable">$adress</span>"</span> != *[\"\`\<span class="hljs-string">'\:\?\&lt;\&gt;\|\!]* ]]; then
</span></code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After adding various checks and providing for various kinds of errors, the question arose, what will happen if the system cannot reproduce the Russian language? </font><font style="vertical-align: inherit;">The question was the place to be, because </font><font style="vertical-align: inherit;">All information issued by the user was written in Russian. </font><font style="vertical-align: inherit;">For a while we ignored this question, the teacher didn‚Äôt remember about it, okay, but we redid our script and created a graphical interface for it using Zenity. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For convenience, we split the script into several files, in the initial file we set the variables, which are then passed on, and we check for Zenity.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code</font></font></b><div class="spoiler_text"><pre><code class="bash hljs">pr_way=`<span class="hljs-built_in">pwd</span>`<font></font>
pr_way=<span class="hljs-string">"<span class="hljs-variable">${pr_way#*$USER/}</span>"</span>
pr_name=<span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>
pr_name=<span class="hljs-string">"<span class="hljs-variable">${pr_name#*/}</span>"</span>
start_scr=<span class="hljs-string">"0"</span>
<span class="hljs-comment">#----------------------------------------------------------------</span>
<span class="hljs-keyword">if</span> find /usr/bin/zenity
<span class="hljs-keyword">then</span>
<span class="hljs-built_in">cd</span> selection<font></font>
./language.sh <span class="hljs-string">"<span class="hljs-variable">$pr_way</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$pr_name</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$start_scr</span>"</span>
<span class="hljs-keyword">else</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Zenity is not installed on this computer."</span>
<span class="hljs-keyword">fi</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having made a fully graphical interface, we returned to the question of language. </font><font style="vertical-align: inherit;">They limited themselves to three languages: Russian, English and Belarusian. </font><font style="vertical-align: inherit;">The language is automatically selected, depending on your system language, if it does not turn out to be one of these three, then a language selection window will simply open where you can choose it yourself.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$LANG</span> == *[<span class="hljs-string">"ru"</span>]* ]]; <span class="hljs-keyword">then</span>
	./key-ru.sh <span class="hljs-string">"<span class="hljs-variable">$pr_way</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$pr_name</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$start_scr</span>"</span>
<span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$LANG</span> == *[<span class="hljs-string">"en"</span>]* ]]; <span class="hljs-keyword">then</span>
	./key-en.sh <span class="hljs-string">"<span class="hljs-variable">$pr_way</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$pr_name</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$start_scr</span>"</span>
<span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$LANG</span> == *[<span class="hljs-string">"by"</span>]* ]]; <span class="hljs-keyword">then</span>
	./key-by.sh <span class="hljs-string">"<span class="hljs-variable">$pr_way</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$pr_name</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$start_scr</span>"</span>
<span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$LANG</span> != *[<span class="hljs-string">"ru"</span>]* ]] &amp;&amp; [[ <span class="hljs-variable">$LANG</span> == *[<span class="hljs-string">"en"</span>]* ]] &amp;&amp; [[ <span class="hljs-variable">$LANG</span> == *[<span class="hljs-string">"by"</span>]* ]]; <span class="hljs-keyword">then</span><font></font>
language=$(zenity \<font></font>
	--list --width=400 --height=150 \<font></font>
	--title=<span class="hljs-string">"Language selection"</span> \<font></font>
	--text=<span class="hljs-string">"Sorry. This program does not support your system language. Please, select language below."</span> \<font></font>
	--column=<span class="hljs-string">"Language"</span> \
	<span class="hljs-string">"Russian"</span> \
	<span class="hljs-string">"English"</span> \
	<span class="hljs-string">"Belarussian"</span> )
</code></pre><br>
</div></div><br>
<img src="https://sun1.velcom-by-minsk.userapi.com/3Azu-jc6MhRPGhTdaEcqglJ6MTaGMxcA1yN48Q/Dq-MTU6D-XI.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After determining the language in which you will continue to work, a window opens with a choice of key. </font></font><br>
<br>
<img src="https://sun2.velcom-by-minsk.userapi.com/Dnl9EKLl27okFC2v3mhVbjq4g6gb7nbIG3-lTg/HVQmGLkeeiw.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Once you have decided what you want to do by selecting the key, proceed to the selection of the file / directory with which you will do this. </font></font><br>
<br>
<img src="https://sun1.velcom-by-minsk.userapi.com/XpgEcfloGLHnTmAqM_XIQiaVCM2C5Dsrx0naPQ/Ayi-SW_wJ9c.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After completing the work, the program will inform you of what happened and will kindly ask if you want to continue. </font></font><br>
<br>
<img src="https://sun1.velcom-by-minsk.userapi.com/fjytl6zpoBZx5uhfXbndD2C_pSFez0u81RVdng/KKA3lQj0pXA.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a bonus, we added to our program the ability to change the access rights of files / directories, this was our previous task, therefore, it was decided to combine them.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code</font></font></b><div class="spoiler_text"><pre><code class="bash hljs">
<span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment">#    </span>
adress=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>
pr_way=<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span>
pr_name=<span class="hljs-string">"<span class="hljs-variable">$3</span>"</span>
<span class="hljs-built_in">echo</span> 
<span class="hljs-built_in">cd</span>
<span class="hljs-comment">#     "/",  ,   /   - </span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$adress</span>"</span> == *[<span class="hljs-string">"/"</span>]* ]]; <span class="hljs-keyword">then</span>
<span class="hljs-comment">#    /  </span>
way=<span class="hljs-string">"<span class="hljs-variable">${adress%/*}</span>"</span>
name=<span class="hljs-string">"<span class="hljs-variable">${adress##*/}</span>"</span>
<span class="hljs-built_in">cd</span> <span class="hljs-string">"<span class="hljs-variable">$way</span>"</span>
<span class="hljs-keyword">else</span>
<span class="hljs-comment">#   "/"  ,  /  </span>
name=<span class="hljs-string">"<span class="hljs-variable">$adress</span>"</span>
<span class="hljs-keyword">fi</span>
<span class="hljs-comment">#     </span><font></font>
format=$(zenity \<font></font>
	--list --width=400 --height=150 \<font></font>
	--title=<span class="hljs-string">"   "</span> \<font></font>
	--text=<span class="hljs-string">", ,    ."</span> \<font></font>
	--column=<span class="hljs-string">""</span> \
	<span class="hljs-string">""</span> \
	<span class="hljs-string">""</span> )
<span class="hljs-comment">#    </span>
<span class="hljs-keyword">if</span> [ $? -eq <span class="hljs-string">"1"</span> ];<span class="hljs-keyword">then</span>
	<span class="hljs-built_in">exit</span>
<span class="hljs-keyword">fi</span>
<span class="hljs-keyword">case</span> <span class="hljs-string">"<span class="hljs-variable">$format</span>"</span> <span class="hljs-keyword">in</span><font></font>
	)<font></font>
<span class="hljs-comment">#      </span><font></font>
mod=$(zenity \<font></font>
	--entry \<font></font>
	--title=<span class="hljs-string">"  "</span> \<font></font>
	--text=<span class="hljs-string">", , ,     '<span class="hljs-variable">$name</span>'.
     ,      0  7:
0 ‚Äì   ;
1 ‚Äì   ;
2 ‚Äì   ;
3 ‚Äì    ;
4 ‚Äì   ;
5 ‚Äì    ;
6 ‚Äì    ;
7 ‚Äì  ."</span> \<font></font>
	--entry-text=<span class="hljs-string">""</span>)
<span class="hljs-comment">#    </span>
<span class="hljs-keyword">if</span> [ $? -eq <span class="hljs-string">"1"</span> ];<span class="hljs-keyword">then</span>
	<span class="hljs-built_in">exit</span>
<span class="hljs-keyword">fi</span>	
<span class="hljs-comment">#    (3  ,     0  7)</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$mod</span> == *[0-7]* ]] &amp;&amp; [[ <span class="hljs-variable">${#mod}</span> = 3 ]]; <span class="hljs-keyword">then</span>
<span class="hljs-comment">#  </span>
	chmod <span class="hljs-variable">$mod</span> <span class="hljs-string">"<span class="hljs-variable">$name</span>"</span>
<span class="hljs-comment">#  </span>
	zenity --info --title=<span class="hljs-string">" "</span> --text=<span class="hljs-string">"'<span class="hljs-variable">$name</span>'    '<span class="hljs-variable">$mod</span>'."</span>
<span class="hljs-keyword">else</span>
	zenity --error --title=<span class="hljs-string">"!"</span> --text=<span class="hljs-string">"    . ,         ."</span>
<span class="hljs-keyword">fi</span><font></font>
;;<font></font>
	)<font></font>
<span class="hljs-comment">#     </span><font></font>
mod=$(zenity \<font></font>
	--entry --width=600 \<font></font>
	--title=<span class="hljs-string">"  "</span> \<font></font>
	--text=<span class="hljs-string">"  ,     '<span class="hljs-variable">$name</span>'.
     ,      (u/g/o/a),
,    (+/-/=)      (r/w/x):
u ‚Äì ;
g ‚Äì ;
o ‚Äì ;
a ‚Äì ;
+ ‚Äì ;
- ‚Äì ;
= ‚Äì ;
r ‚Äì ;
w ‚Äì ;
x ‚Äì ."</span> \<font></font>
	--entry-text=<span class="hljs-string">""</span>)
<span class="hljs-comment">#    </span>
<span class="hljs-keyword">if</span> [ $? -eq <span class="hljs-string">"1"</span> ];<span class="hljs-keyword">then</span>
	<span class="hljs-built_in">exit</span>
<span class="hljs-keyword">fi</span>
<span class="hljs-comment">#             </span>
<span class="hljs-keyword">if</span>  [[ <span class="hljs-variable">$mod</span> == *[ugoa]*+*[rwx]* || <span class="hljs-variable">$mod</span> == *[ugoa]*-*[rwx]* || <span class="hljs-variable">$mod</span> == *[ugoa]*<span class="hljs-string">"="</span>*[rwx]* ]]; <span class="hljs-keyword">then</span>
	chmod <span class="hljs-variable">$mod</span> <span class="hljs-string">"<span class="hljs-variable">$name</span>"</span>
	zenity --info --title=<span class="hljs-string">""</span> --text=<span class="hljs-string">"'<span class="hljs-variable">$name</span>'    '<span class="hljs-variable">$mod</span>'."</span>
<span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$mod</span> == +*[rwx]* ]] || [[ <span class="hljs-variable">$mod</span> == -*[rwx]* ]] || [[ <span class="hljs-variable">$mod</span> == =*[rwx]* ]]; <span class="hljs-keyword">then</span>
	pre_mod=<span class="hljs-string">"<span class="hljs-variable">${mod%[-+=]*}</span>"</span>
	pre_mod+=<span class="hljs-string">" "</span>
	<span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$pre_mod</span> == <span class="hljs-string">" "</span> ]]; <span class="hljs-keyword">then</span>
		pre_mod=<span class="hljs-string">"<span class="hljs-variable">${pre_mod/ /a}</span>"</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$pre_mod</span>"</span>
		pre_mod+=<span class="hljs-string">"<span class="hljs-variable">$mod</span>"</span>
		mod=<span class="hljs-string">"<span class="hljs-variable">$pre_mod</span>"</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$mod</span>"</span>
	<span class="hljs-keyword">fi</span>
	chmod <span class="hljs-variable">$mod</span> <span class="hljs-string">"<span class="hljs-variable">$name</span>"</span>
	zenity --info --title=<span class="hljs-string">""</span> --text=<span class="hljs-string">"'<span class="hljs-variable">$name</span>'    '<span class="hljs-variable">$mod</span>'."</span>
<span class="hljs-keyword">else</span>
	zenity --error --title=<span class="hljs-string">"!"</span> --text=<span class="hljs-string">"    . ,         ."</span>
<span class="hljs-keyword">fi</span><font></font>
;;<font></font>
<span class="hljs-keyword">esac</span>
<span class="hljs-built_in">cd</span>
<span class="hljs-built_in">cd</span> <span class="hljs-string">""</span><span class="hljs-variable">$pr_way</span><span class="hljs-string">"/selection"</span>
<span class="hljs-comment">#         </span><font></font>
next=$(zenity \<font></font>
	--list --width=400 --height=200 \<font></font>
	--title=<span class="hljs-string">"  "</span> \<font></font>
	--text=<span class="hljs-string">", ,         ,
  , ,    ."</span> \<font></font>
	--column=<span class="hljs-string">""</span> \
	<span class="hljs-string">" "</span> \
	<span class="hljs-string">"   "</span> )
<span class="hljs-keyword">case</span> <span class="hljs-variable">$next</span> <span class="hljs-keyword">in</span>
	<span class="hljs-string">" "</span>) <font></font>
start_scr=<span class="hljs-string">"0"</span>
./key-ru.sh <span class="hljs-string">"<span class="hljs-variable">$pr_way</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$pr_name</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$start_scr</span>"</span><font></font>
;;<font></font>
	<span class="hljs-string">"   "</span>) <font></font>
start_scr=<span class="hljs-string">"C"</span>
./key-ru.sh <span class="hljs-string">"<span class="hljs-variable">$pr_way</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$pr_name</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$start_scr</span>"</span><font></font>
;;<font></font>
<span class="hljs-keyword">esac</span>
</code></pre><br>
</div></div><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A link to all our work</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , for a detailed acquaintance with it, is attached.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493424/index.html">We implement Python code conversions</a></li>
<li><a href="../en493426/index.html">Organization of code in microservices and my approach of using hexagonal architecture and DDD</a></li>
<li><a href="../en493428/index.html">"We will not give rise to conspiracy theories." Talk about ML conferences with people from science and IT companies</a></li>
<li><a href="../en493430/index.html">Net Architecture for Web Applications</a></li>
<li><a href="../en493432/index.html">Why not start a career in a small non-IT company</a></li>
<li><a href="../en493438/index.html">Display search results and performance issues</a></li>
<li><a href="../en493440/index.html">Influencer Marketing in China: what it is based on and what influencers can offer in the context of emergencies</a></li>
<li><a href="../en493442/index.html">PPE Reminder</a></li>
<li><a href="../en493444/index.html">The project "Glass". Energy Efficiency Disposable Tea / Coffee Cups</a></li>
<li><a href="../en493446/index.html">Weekend Reading: 10 Unusual Sound Stories - From Spy Games and Conspiracy Theories to Relaxing ASMR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>