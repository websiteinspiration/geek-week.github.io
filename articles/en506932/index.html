<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçî üë®üèΩ‚Äçüî¨ üîê Exploring Cobalt cybergrouping: what new tools and attacks do hackers use üî∂ üò• ü•í</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Specialists at PT Expert Security Center have been monitoring the activity of the Cobalt group since 2016 . Today, the group is attacking financial in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Exploring Cobalt cybergrouping: what new tools and attacks do hackers use</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/506932/"><img src="https://habrastorage.org/webt/y2/c0/qd/y2c0qdpfwf0ykktfxq6kcdjxjcc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Specialists at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT Expert Security Center have been</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> monitoring the activity of the Cobalt group </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">since 2016</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Today, the group is attacking financial institutions around the world. </font><font style="vertical-align: inherit;">The damage from these attacks a year ago </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exceeded</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 billion rubles. </font><font style="vertical-align: inherit;">Over the past four years, we have </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">published</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> several </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reports of attacks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> related to this group.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the past year, the Cobalt group not only modified its main CobInt tools and COM-DLL dropper in conjunction with the more_eggs JavaScript backdoor, but also used new delivery methods and new techniques to bypass protection at the initial stage of the attack. </font><font style="vertical-align: inherit;">Updating tactics and tools may be due to the fact that the group has long been targeted by researchers from all over the world, and it needs to be one step ahead to bypass the protective equipment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On average, in 2019, the group carried out three attacks per month. </font><font style="vertical-align: inherit;">In our new article - analysis of new tactics and tools of cyber grouping. </font><font style="vertical-align: inherit;">The full version of the study is available </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phishing site European Central Bank</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the end of August 2019, while investigating information security threats, we recorded an attack using CobInt. The attack was allegedly aimed at European financial institutions. We have no data on how successful it was. A custom NSIS-installer served as a dropper for CobInt. We found three versions of such a dropper: for Chrome, Firefox, and Opera. Inside each was the same version of CobInt and the corresponding installer for the browser. After starting, the dropper saved CobInt to the% TEMP% folder, and the installer also launched it. After analyzing malware, we found that the distribution of droppers occurred from the phb site ecb-european [.] Eu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/by/up/fmbyupvcfdyjqxqtv_rva-ubnay.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phishing Site Home</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The site was a copy of the site of the European Central Bank - except that when it was visited, the user was shown a pop-up window asking him to update the browser. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9i/pn/ni/9ipnniehr72_vbnv0evoyy5m7a4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pop-up window on a fake ECB website</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As a result, the aforementioned dropper was downloaded to the user's computer. </font><font style="vertical-align: inherit;">In the source code of the page there was a link to the script that displayed this window. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most likely, users got to the site using a phishing email similar to the ones that the Cobalt group most often uses.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Malicious VHD</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the end of December 2019, we discovered the next CobInt Cobalt bootloader. Unusual was the container that contained this bootloader. It was a virtual hard disk (VHD), which was supposedly mailed out. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The VHD format has been used since the creation of Hyper-V virtualization technology. A VHD file can contain everything that can be found on a regular HDD: disk partitions, a file system with folders and files. Starting with Windows 7, the user can manually connect the VHD, for example through the MMC console. Starting with Windows 8, a user can connect VHD simply by double-clicking on it with the mouse, and it will appear in the system as a regular disk. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In September 2019, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">an article</font></a><font style="vertical-align: inherit;"> was published on the CERT / CC blog</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the dangers of VHD files and their use as a potential vector in attacks. Will Dorman showed that neither antiviruses, nor mark on the web will not signal to the user that the contents of the VHD file downloaded from the Internet can harm the computer. It is possible that the Cobalt group used the results of this study. Their VHD file was also not detected by antiviruses at the time it appeared on VirusTotal. Six months later, this file is detected by just one antivirus: this is a very low indicator. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vy/ok/xu/vyokxub26hafxvwac-cdikvtams.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inside VHD are two CobInt files. Two invalid Google certificates are attached to the end of one of the files to reduce the likelihood of detection by security features.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the VHD is mounted, the user must manually start one of the files. </font><font style="vertical-align: inherit;">By function, the two files are identical. </font><font style="vertical-align: inherit;">After starting one of CobInt, the main library is loaded. </font><font style="vertical-align: inherit;">The main library is loaded by CobInt from the control server as an HTML file.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. BIFF macro </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In March 2020, we recorded a Cobalt group document in XLS format, which downloaded and ran a COM-DLL dropper. The document contained a fairly old Excel 4.0 macro format and was practically not detected by antiviruses (1 verdict out of 60 according to the VirusTotal service). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4n/8m/w-/4n8mw-eh7eh8vodwp2zwbauplg4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The number of antivirus verdicts on the first download of an Excel 4.0 macro file to VirusTotal </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This macro standard has been in use for 20 years. Its peculiarity is that the macro is not stored in a VBA project, it is located in the cells of the page, while the page can be hidden in Excel itself. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This means that the macro will not be in the VBA stream, but in the BIFF record (Binary Interchange File Format).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you open the document in Excel, then we will see only one page and the absence of macros in the VBA project. </font><font style="vertical-align: inherit;">However, Excel will still detect the presence of a macro and block its execution. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Opening the source document in the formula manager, we will see that one of the formulas starts automatically when you open the document. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/20/9w/e5/209we5fodrts0svk62kuavorzky.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The macro formula that starts when the document is opened. The</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
initial formula launches a large chain of COMBIN, EXECUTE, SYMBOL, CALL commands, which ultimately leads to the loading and launching of the COM-DLL dropper. </font><font style="vertical-align: inherit;">The entire command chain is scattered across a huge field of cells in an Excel page, which makes analysis difficult. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ir/fo/tv/irfotvsrlnkddg31oszuzjhnwy4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Macro Formulas for Downloading and Running a COM-DLL Dropper</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Analysis of COM-DLL dropper</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In early April 2020, we discovered a new version of the COM-DLL dropper. </font><font style="vertical-align: inherit;">In terms of functions, it differed from all that we saw earlier. </font><font style="vertical-align: inherit;">However, the payload in the form of the more_eggs JavaScript backdoor remains the same. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The COM-DLL dropper appeared in the Cobalt arsenal in the summer of 2017 and is still used by the group to deliver the JavaScript backdoor </font></font><code>more_eggs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which is contained in it in encrypted and archived form. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Features dropper:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully written in PureBasic.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uses a large number of different anti-analysis techniques.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It contains an encrypted and archived JavaScript loader, a JavaScript backdoor, a legitimate command line conversion utility for launching the more_eggs JavaScript backdoor.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It has a built-in obfuscator for the JavaScript backdoor and the JavaScript loader wired inside.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Cobalt Group continues to attack financial institutions around the world, takes on new tactics, updates tools, and tries to more effectively bypass defenses. </font><font style="vertical-align: inherit;">Due to quarantine, many credit and financial sector employees are now working "from a distance", out of the reach of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corporate remedies</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In addition, many attackers use the coronavirus theme in their attacks, such as the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Higaisa group</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It is possible that the Cobalt group will try to use this theme in its future attacks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The full version of the study </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is available here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Authors</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Denis Kuvshinov, Sergey Tarasov, Daniil Koloskov, PT Expert Security Center</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506906/index.html">Black hole paradoxes reveal the fundamental connection between energy and order</a></li>
<li><a href="../en506908/index.html">Top science. May media ten: desperation of aquarium fish, voices of mental disorders and many times COVID</a></li>
<li><a href="../en506916/index.html">What is a Service Mesh?</a></li>
<li><a href="../en506924/index.html">How to choose the best material in the early stages of design?</a></li>
<li><a href="../en506926/index.html">Analysis: why the powerful increase in the number of users and revenue of Zoom does not indicate the success of the company after the pandemic</a></li>
<li><a href="../en506938/index.html">Games from the Sony PlayStation 5 presentation</a></li>
<li><a href="../en506940/index.html">The road to ideal: a short guide for programmers and their leaders</a></li>
<li><a href="../en506950/index.html">What is School 21, and why is it so designed</a></li>
<li><a href="../en506952/index.html">API portal: what to look for when designing. Wrike Experience</a></li>
<li><a href="../en506954/index.html">Another article about Rails and ELK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>