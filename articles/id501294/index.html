<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛬 🥜 👨‍🚀 Apa yang bisa dihasilkan dari melemahnya tingkat isolasi transaksi dalam database 🤛 🆔 💃🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Dalam sentuhan Vladislav Rodin. Saat ini, saya adalah kepala kursus Arsitek Beban Tinggi di OTUS, dan saya juga mengajar kursus arsitek...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Apa yang bisa dihasilkan dari melemahnya tingkat isolasi transaksi dalam database</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/501294/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo semuanya. </font><font style="vertical-align: inherit;">Dalam sentuhan Vladislav Rodin. </font><font style="vertical-align: inherit;">Saat ini, saya adalah kepala kursus Arsitek Beban Tinggi di OTUS, dan saya juga mengajar kursus arsitektur perangkat lunak. </font></font><br>
</i><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain mengajar, seperti yang Anda lihat, saya telah menulis untuk materi hak cipta blog OTUS Habré dan artikel hari ini saya ingin bertepatan dengan dimulainya kursus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«PostgreSQL»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang sekarang sedang membuka set.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/wc/kz/hr/wckzhr5i0yusvkgrw6ibzhuu5rm.png"><br>
<hr><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terakhir kali</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anda dan saya berbicara tentang bahwa transaksi di database yang digunakan untuk dua tujuan: untuk memastikan toleransi kesalahan dan akses data dalam lingkungan yang kompetitif. </font><font style="vertical-align: inherit;">Untuk menyelesaikan tugas ini, transaksi harus memiliki properti ACID. </font><font style="vertical-align: inherit;">Hari ini kita akan berbicara secara rinci tentang huruf </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I (isolasi)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam singkatan ini.</font></font><br>
<a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isolasi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isolasi memecahkan masalah mengakses data dalam lingkungan yang kompetitif, secara efektif memberikan perlindungan terhadap kondisi ras. Idealnya, isolasi berarti serialisasi, yaitu properti yang memastikan bahwa hasil pelaksanaan transaksi secara paralel adalah sama seperti jika mereka dieksekusi secara berurutan. Masalah utama dari properti ini adalah secara teknis sangat sulit untuk diberikan dan, sebagai akibatnya, memiliki dampak signifikan pada kinerja sistem. Itulah sebabnya isolasi sering melemah, menerima risiko beberapa anomali, yang akan dibahas di bawah ini. Kemungkinan terjadinya anomali tertentu sama saja mencirikan tingkat isolasi transaksi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anomali yang paling terkenal adalah: baca kotor, baca tidak dapat diulang, baca hantu, tetapi sebenarnya ada 5 lagi: tulis kotor, pembaruan kursor hilang, pembaruan hilang, baca miring, baca miring, tulis miring.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menulis kotor</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inti dari anomali adalah transaksi dapat menimpa data yang tidak berkomitmen. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/007/48f/64e/00748f64e3706c7ecd676eaabe4a0351.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anomali ini berbahaya bukan hanya karena data dapat bertentangan setelah melakukan kedua transaksi (seperti pada gambar), tetapi juga karena atomisitas dilanggar: karena kami mengizinkan menimpa data yang tidak dikunci, tidak jelas cara mengembalikan satu transaksi tanpa memukul yang lain . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anomali diperlakukan cukup sederhana: kita menggantung kunci tulis sebelum perekaman dimulai, melarang transaksi lain untuk mengubah catatan sampai kunci dilepaskan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotor baca</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Membaca kotor berarti membaca data yang tidak dikomit. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/334/54a/0a2/33454a0a2a3312fa8f010e33110ec5f3.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masalah muncul ketika, berdasarkan sampel, perlu untuk melakukan beberapa tindakan atau membuat keputusan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memperbaiki anomali, Anda dapat menggantung kunci baca, tetapi itu akan memukul kinerja yang sulit. </font><font style="vertical-align: inherit;">Lebih mudah untuk mengatakan bahwa untuk transaksi rollback, keadaan awal data (sebelum merekam) harus disimpan dalam sistem. </font><font style="vertical-align: inherit;">Kenapa tidak baca dari sana? </font><font style="vertical-align: inherit;">Ini cukup murah, sehingga sebagian besar database menghapus pembacaan kotor secara default.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembaruan yang hilang</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kehilangan pembaruan berarti kehilangan pembaruan, dan terjemahan secara akurat mencerminkan esensi dari masalah: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7a7/185/a1b/7a7185a1b409181482510eec788255ae.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan, hasil transaksi T2 dibatalkan. </font><font style="vertical-align: inherit;">Situasi ini diperbaiki oleh kunci tulis eksplisit atau implisit. </font><font style="vertical-align: inherit;">Yaitu, kita cukup memperbarui catatan, dan kemudian kunci implisit terjadi, atau kita melakukan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilih untuk pembaruan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , menyebabkan kunci baca dan tulis terjadi. </font><font style="vertical-align: inherit;">Harap dicatat bahwa operasi semacam itu cukup berbahaya: dengan pembacaan "tidak bersalah" kami, kami memblokir bacaan lainnya. </font><font style="vertical-align: inherit;">Beberapa database menawarkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilih yang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lebih aman </font><b><font style="vertical-align: inherit;">untuk dibagikan</font></b><font style="vertical-align: inherit;"> yang memungkinkan Anda membaca data, tetapi tidak memungkinkannya untuk berubah.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kursor kehilangan pembaruan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk kontrol yang lebih halus, pangkalan dapat menawarkan alat lain, misalnya kursor. </font><font style="vertical-align: inherit;">Kursor adalah struktur yang berisi sekumpulan garis dan memungkinkan Anda untuk mengulanginya. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mendeklarasikan cursor_name untuk select_statement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Isi kursor dijelaskan dengan pilih. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengapa kita membutuhkan kursor? </font><font style="vertical-align: inherit;">Faktanya adalah bahwa beberapa database menawarkan penguncian pada semua catatan yang dipilih dengan pilih (baca stabilitas), atau hanya pada catatan di mana kursor saat ini berada (stabilitas kursor). </font><font style="vertical-align: inherit;">Dengan stabilitas kursor, kunci pendek diterapkan, yang memungkinkan kita untuk mengurangi jumlah kunci jika kita beralih pada sampel data yang besar. </font><font style="vertical-align: inherit;">Oleh karena itu, anomali pembaruan yang hilang disorot secara terpisah untuk kursor.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baca tidak dapat diulang</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pembacaan yang tidak dapat diulangi adalah bahwa selama pelaksanaan transaksi kami, 2 pembacaan berurutan dari catatan yang sama akan menghasilkan hasil yang berbeda, karena transaksi lain mengintervensi antara dua pembacaan ini, mengubah data kami dan berkomitmen. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3b8/ac7/be3/3b8ac7be3f4b29b3b20f8d4d72e52e35.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengapa ini menjadi masalah? </font><font style="vertical-align: inherit;">Bayangkan bahwa tujuan transaksi T2 dalam gambar adalah untuk memilih semua produk yang harganya kurang dari 150 cu </font><font style="vertical-align: inherit;">Orang lain memperbarui harga menjadi $ 200 </font><font style="vertical-align: inherit;">Dengan demikian, filter yang dipasang tidak berfungsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anomali ini berhenti terjadi ketika kunci dua fase ditambahkan atau ketika menggunakan mekanisme MVCC, yang ingin saya bicarakan secara terpisah.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phantom membaca</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Phantom sedang membaca data yang telah ditambahkan oleh transaksi lain. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/946/4dc/24e/9464dc24e22f13034a28f3b798d0aadc.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai contoh, Anda dapat mengamati pemilihan produk termurah yang salah ketika anomali ini terjadi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menyingkirkan pembacaan hantu sudah cukup sulit. </font><font style="vertical-align: inherit;">Pemblokiran normal tidak cukup, karena kita tidak akan dapat memblokir apa yang belum tersedia. </font><font style="vertical-align: inherit;">Sistem 2PL menggunakan penguncian prediktif, sedangkan sistem MVCC menggunakan penjadwal transaksi untuk membatalkan transaksi yang dapat dipatahkan oleh sebuah insert. </font><font style="vertical-align: inherit;">Mekanisme pertama dan kedua cukup berat.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baca miring</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemiringan baca muncul ketika kami bekerja dengan beberapa tabel, yang isinya harus berubah secara konsisten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan ada tabel yang mewakili posting dan meta-informasi mereka: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b9c/982/e3e/b9c982e3e51222ea919510ce857a2ab6.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Satu transaksi membaca dari tabel, yang lain mengubahnya: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/04e/df8/5a1/04edf85a1ceb8791f55ab6afa1c40b8f.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai hasil dari transaksi T1, pos tersebut memiliki judul = Baik dan updated_by = T2, yang merupakan beberapa inkonsistensi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebenarnya, ini adalah bacaan yang tidak dapat diulang, tetapi sebagai bagian dari beberapa tabel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk koreksi, T1 dapat menggantung kunci pada semua baris yang akan dibaca, yang akan mencegah T2 dari mengubah informasi. </font><font style="vertical-align: inherit;">Dalam hal MVCC, transaksi T2 akan dibatalkan. </font><font style="vertical-align: inherit;">Perlindungan terhadap anomali ini bisa menjadi penting jika kita menggunakan kursor.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tulis miring</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anomali ini juga lebih mudah dijelaskan dengan menggunakan contoh: misalkan dalam sistem kami setidaknya satu dokter harus bertugas, tetapi kedua dokter memutuskan untuk membatalkan tugas mereka: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/23a/f78/439/23af784391a4f9adaeb322e5e509f933.jpg" alt="gambar"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8ec/2cb/d15/8ec2cbd1598ce5fa1e4d22607284795a.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anomali telah mengarah pada fakta bahwa tidak ada dokter yang akan bertugas. Kenapa ini terjadi? Karena transaksi memeriksa kondisi yang mungkin dilanggar oleh transaksi lain, dan karena isolasi, kami tidak melihat perubahan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah bacaan yang tidak dapat diulang yang sama. Atau, pilih yang dapat menggantung kunci pada catatan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menulis miring dan membaca miring adalah kombinasi dari anomali sebelumnya. Anda dapat mempertimbangkan menulis miring, yang pada dasarnya adalah membaca hantu. Pertimbangkan tabel di mana terdapat nama-nama karyawan, gaji mereka dan proyek tempat mereka bekerja:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ab4/61a/f1e/ab461af1ee01323db8377074875a044b.jpg" alt="gambar"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/acd/126/e73/acd126e73fbe5310bfcb5bf0291e36c2.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai hasilnya, kami mendapatkan gambar berikut: setiap manajer berpikir bahwa perubahannya tidak akan mengarah pada anggaran, sehingga mereka membuat perubahan personil, yang secara total menyebabkan overrun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penyebab masalah persis sama dengan membaca hantu.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temuan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Melemahnya tingkat isolasi transaksi dalam basis data merupakan kompromi antara keamanan dan kinerja, pilihan tingkat ini harus didekati berdasarkan risiko potensial terhadap bisnis jika terjadi anomali.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelajari lebih lanjut tentang kursus.</font></font><br>
</a><br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id501282/index.html">Efek samping Coronavirus: robot akan menempati pekerjaan kita lebih cepat</a></li>
<li><a href="../id501284/index.html">8 pertanyaan tentang kendaraan tak berawak dari Lembah Silikon</a></li>
<li><a href="../id501286/index.html">Dasar-dasar python Easygui. Bagian 1</a></li>
<li><a href="../id501288/index.html">Jangan buru-buru beralih ke EDI dan EDS hari ini: jebakan yang mungkin tidak Anda ketahui</a></li>
<li><a href="../id501292/index.html">Perkiraan nilai kapal komersial. Aritmatika dan akal sehat</a></li>
<li><a href="../id501296/index.html">Cara menjadikan karier sebagai programmer tanpa menyelesaikan masalah bisnis</a></li>
<li><a href="../id501298/index.html">Membuat repositori plugin QGIS Anda sendiri</a></li>
<li><a href="../id501300/index.html">Bereaksi dan Atlaskit di server Atlassian dan plugin pusat data</a></li>
<li><a href="../id501302/index.html">Tolong jangan membuat kebisingan</a></li>
<li><a href="../id501306/index.html">Membangun saluran pipa untuk mengirim Graal Native Image ke pengguna akhir</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>