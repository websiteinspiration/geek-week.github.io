<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💛 ♏️ 🌎 C for Metal-Intelグラフィックスカードでのコンピューティング用の貴金属 👨‍🎤 ➗ 🚍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="コンピューターにはいくつのIntelプロセッサーコアがありますか？Intelベースのシステムを使用している場合、ほとんどの場合、答えに1を追加する必要があります。AtomからXeon E3までのほぼすべてのIntelプロセッサには、もちろんCoreを欠かすことなく、本質的に完全なプロセッサである統合...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C for Metal-Intelグラフィックスカードでのコンピューティング用の貴金属</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/466521/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンピューターにはいくつのIntelプロセッサーコアがありますか？</font><font style="vertical-align: inherit;">Intelベースのシステムを使用している場合、ほとんどの場合、答えに1を追加する必要があります。</font><font style="vertical-align: inherit;">AtomからXeon E3までのほぼすべてのIntelプロセッサには、もちろんCoreを欠かすことなく、本質的に完全なプロセッサである統合グラフィックコアIntel Graphicsが長年にわたって含まれており、画面に画像を表示したりビデオを加速したりできるだけでなく、また、「通常の」汎用計算も実行します。</font><font style="vertical-align: inherit;">これはどのように効果的に使用できますか？</font><font style="vertical-align: inherit;">カットの下を見てください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/od/zy/qg/odzyqgwdoyvgvhlbsvulnty_doo.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、インテルGPUで数える価値がある理由を簡単に説明します。</font><font style="vertical-align: inherit;">もちろん、システムのCPUパフォーマンスはほとんどの場合、GPUを大幅に上回ります。これは、GPUがセントラルプロセッサでもあるためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、興味深いのは、過去10年間のIntel統合GPUのパフォーマンスがCPUのパフォーマンスよりもパーセンテージで大幅に向上しており、この傾向が確実に新しいディスクリートIntelグラフィックカードの登場を続けることです。さらに、GPUは、そのアーキテクチャー（多くのベクトル実行デバイス）により、特定のタイプのタスク（画像処理、つまり実際にはデータアレイで同じタイプの操作を実行する）を実行するのに非常に適しています。 GPUはこれを完全な内部並列化で実行し、CPUよりも少ないエネルギーを消費し、場合によっては絶対速度でそれを超えます。最後に、GPUとCPUは並行して動作し、それぞれが独自のタスクを実行して、システム全体のパフォーマンスを最大化したり、電力消費を最小化したりできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -OK、インテル。インテルGPUを一般的な計算に使用することを決定しました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -グラフィック（Direct3DおよびOpenGLシェーダー）で特別な知識を必要としない最も簡単な方法は、OpenCLです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenCLコアはプラットフォームに依存せず、システムで使用可能なすべてのコンピューティングデバイス（CPU、GPU、FPGAなど）で自動的に実行されます。しかし、そのような多様性に対する料金は、各タイプのデバイス、特に統合型Intel GPUで可能な最大のパフォーマンスとはかけ離れています。次に例を示します。16x16バイトマトリックスを転置するIntel GPUでコードを実行すると、Intel GPUの「直接プログラミング」のパフォーマンス上の利点は、OpenCLバージョンの場合よりも8倍高くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、一般的なアルゴリズムの実装に必要な一部の機能（たとえば、単一の変換でピクセルの大きなグループからのデータを使用する「ワイドフィルター」）、OpenCLは単にサポートしていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、GPUで最大速度が必要な場合、またはアレイの各要素とその最近傍で個別に作業するよりも複雑な場合は、Intel Graphicsで実行されるアプリケーションを開発するためのツールであるIntel C for Metal（ICM）が役立ちます。 。</font></font><br>
<br>
<h2><font color="#0071c5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICM-フォージへようこそ！</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パフォーマンスと機能性の観点から、ICMは「インテルグラフィックスカード用のアセンブラー」と見なすことができ、回路と使いやすさの点で「インテルグラフィックスカード用OpenCLの類似物」と見なすことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ICMは長年にわたり、インテルGPUでメディア処理製品を開発する際にインテル内部で使用されてきました。しかし、2018年にICMは一般にリリースされ、オープンソースでもリリースされました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intel C for Metalは、数か月前に現在の名前になりました。その前は、Intel C for Media（同じ頭字語ICMまたは単にCMまたはCm）と呼ばれていました。以前は、Media Development Framework（MDF）と呼ばれていました。したがって、コンポーネント名、ドキュメント、またはオープンソースコードのコメントのどこかに古い名前があったとしても、心配する必要はありません。これは過去の値です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、OpenCLと同様に、ICMアプリケーションコードには2つの部分が含まれています。「管理用」の部分はプロセッサで実行され、カーネルはGPUで実行されます。</font><font style="vertical-align: inherit;">当然のことながら、最初の部分はホストと呼ばれ、2番目の部分はカーネルです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カーネルは、ピクセルの特定のブロック（またはデータのみ）を処理する機能であり、Intel C for Metal言語で記述され、ICMコンパイラを使用してIntel GPU命令セット（ISA）にコンパイルされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホストは一種の「カーネルチームマネージャー」であり、CPUとGPU間のデータ転送プロセスを管理し、ICMランタイムランタイムライブラリとIntel GPUメディアドライバーを通じて他の「管理作業」を実行します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
詳細なICMワークフローは次のようになります。</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ol/a1/q4/ola1q4zotlteitoqxvmttsuulu0.png"></div><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICMホストコードは、アプリケーション全体とともに、x86 C / C ++コンパイラーによってコンパイルされます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICMカーネルコードは、ICMコンパイラによって、いくつかの一般的な命令セット（一般ISA）を含むバイナリファイルにコンパイルされます。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行時に、この一般的なJIT命令セットは特定のIntel GPUに変換されます。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICMホストはICMランタイムライブラリを呼び出して、GPUおよびオペレーティングシステムと通信します。 </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いくつかのより重要で有用なポイント：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICMでデータを表現/保存するために使用されるサーフェスは、DirectX 11および9（Linux上のDXVA）と共有できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPUは、CPUと共有されているビデオメモリとシステムメモリの両方からデータを取得して書き込むことができます。</font><font style="vertical-align: inherit;">ICMには、双方向のデータ転送の両方のケースに対応する特別な機能が含まれています。</font><font style="vertical-align: inherit;">同時に、システムメモリは正確に共有され、その中での実際のコピーは必要ありません。これのために、いわゆるゼロコピーがICMで提供されます。</font></font></li>
</ul><br>
<h2><font color="#0071c5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICM-火山のベントで！</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「C for Iron」自体の名前から、デバイスの言語は内部グラフィックデバイスIntelに対応していることがわかります。つまり、コードがグラフィックカードの数十の実行ユニットで実行されるという事実を考慮に入れます。各実行ユニットは、複数のスレッドを同時に実行できる完全なベクトルプロセッサです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ICM言語自体はC ++であり、いくつかの制限と拡張があります。 C ++と比較すると、ICMには...ポインタ、メモリ割り当て、静的変数がありません。禁止の下でも再帰的な機能。しかし、明示的なベクトルモデル（SIMD）プログラミングがあります。ベクトルデータタイプ-ベクトル、行列、表面。これらのデータ型に対するベクター演算、ベクター条件（if / else）、ベクターの各要素に対して独立して実行。また、インテルGPUハードウェアの固定機能にアクセスするための組み込み機能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際の問題におけるベクトル、行列、および表面の操作は、「サブセット」のオブジェクトによって促進されます。対応する基本オブジェクトから、関心のある「参照」ブロックのみ、または特別な場合として、マスクによって個々の要素を選択できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、線形フィルターを実装するICMコードを見てみましょう- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各ピクセルのRGBカラー</font><font style="vertical-align: inherit;">値を</font><font style="vertical-align: inherit;">、画像の平均値と8つの隣接ピクセルで</font><font style="vertical-align: inherit;">置き換えます</font><font style="vertical-align: inherit;">。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/0q/xk/of/0qxkofxlflf0p_pxmtzgvcd7aze.png"></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I（x、y）= [I（x-1、y-1）+ I（x-1、y）+ I（x-1、y + 1）+ I（x、y-1）+ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ I （x、y）+ I（x、y + 1）+ I（x + 1、y-1）+ I（x + 1、y）+ I（x + 1、y + 1）] / 9</font></font></b><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マトリックスの色（データ）が</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R8G8B8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として配置されている</font><b><font style="vertical-align: inherit;">場合</font></b><font style="vertical-align: inherit;">、入力画像を6x8ピクセルのブロック（6x24バイトのデータ要素）に分割する計算は次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">_GENX_MAIN_ <span class="hljs-keyword">void</span> <span class="hljs-title">linear</span><span class="hljs-params">(SurfaceIndex inBuf, SurfaceIndex outBuf, 
	uint h_pos, uint v_pos)</span></span>{
<span class="hljs-comment">//    8x32</span>
    matrix&lt;uchar, <span class="hljs-number">8</span>, <span class="hljs-number">32</span>&gt; in;
<span class="hljs-comment">//   6x24 </span>
    matrix&lt;uchar, <span class="hljs-number">6</span>, <span class="hljs-number">24</span>&gt; out;<font></font>
    matrix&lt;<span class="hljs-keyword">float</span>, <span class="hljs-number">6</span>, <span class="hljs-number">24</span>&gt; m;
<span class="hljs-comment">//   </span>
    read(inBuf h_pos*<span class="hljs-number">24</span>, v_pos*<span class="hljs-number">6</span>, in); 
<span class="hljs-comment">//    - </span>
    m  = in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>);<font></font>
    m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>); m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>); m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>);<font></font>
    m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>); m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>);<font></font>
    m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>); m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>); m += in.select&lt;<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>&gt;(<span class="hljs-number">2</span>,<span class="hljs-number">6</span>);
<span class="hljs-comment">//  -   9     * 0.111f;</span>
    out = m * <span class="hljs-number">0.111f</span>;
<span class="hljs-comment">//  </span>
    write(outBuf, h_pos*<span class="hljs-number">24</span>, v_pos*<span class="hljs-number">6</span>, out); }</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行列のサイズは、&lt;data type、height、width&gt;;の形式で設定されます。</font></font></li>
<li> <i>select&lt;v_size, v_stride, h_size, h_stride&gt;(i, j)</i>      <i>(i, j)</i>, <i>v_size</i>    , <i>v_stride</i> –     <i>h_size</i> –   , <i>h_stride</i> —   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8x30ブロックは6x24ブロックのすべてのピクセルの値を計算するのにアルゴリズム的に十分ですが、データブロックはバイトではなく32ビットのdword要素によってICMで読み取られるため、8x32入力行列のサイズが選択されていることに注意してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のコードは、実際には、本格的なICMカーネルです。前述のように、ICMコンパイラーによって2つの段階（プリコンパイルと後続のJIT変換）でコンパイルされます。 ICMコンパイラはLLVMに基づいて構築されており、必要に応じて、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">調べて、自分で構築することができます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ICMホストは何をしますか？次のICMランタイムランタイムライブラリ関数を呼び出します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPUデバイス（CmDevice）、およびカーネルで使用されるユーザーデータを含むサーフェス（CmSurface）を使用した後、作成、初期化、削除します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネルでの作業-プリコンパイルされた</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.isa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">からそれらをダウンロードし</font><font style="vertical-align: inherit;">、引数を準備して、各カーネルで使用するデータの一部を示します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネル実行キューを作成および管理します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらは、GPUで各カーネルを実行するスレッドの動作を制御します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベントの管理（CmEvent）-GPUおよびCPU同期オブジェクト。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPUとCPU間、またはシステムとビデオメモリ間でデータを転送します。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラーを報告し、カーネルの動作時間を測定します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も単純なホストコードは次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//   CmDevice </span><font></font>
  cm_result_check(::CreateCmDevice(p_cm_device, version));<font></font>
  <span class="hljs-comment">//  hello_world_genx.isa </span>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> isa_code = isa::loadFile(<span class="hljs-string">"hello_world_genx.isa"</span>);<font></font>
<font></font>
  <span class="hljs-comment">//    isa   CmProgram </span>
  CmProgram *p_program = <span class="hljs-literal">nullptr</span>;<font></font>
  cm_result_check(p_cm_device-&gt;LoadProgram(<span class="hljs-keyword">const_cast</span>&lt;<span class="hljs-keyword">char</span>* &gt;(isa_code.data()),isa_code.size(), p_program));
  <span class="hljs-comment">//  hello_world .</span>
  CmKernel *p_kernel = <span class="hljs-literal">nullptr</span>;<font></font>
  cm_result_check(p_cm_device-&gt;CreateKernel(p_program,<font></font>
                                           <span class="hljs-string">"hello_world"</span>,<font></font>
                                            p_kernel));<font></font>
<font></font>
  <span class="hljs-comment">//        CmKernel </span>
  CmThreadSpace *p_thread_space = <span class="hljs-literal">nullptr</span>;<font></font>
  cm_result_check(p_cm_device-&gt;CreateThreadSpace(thread_width,<font></font>
                                                 thread_height,<font></font>
                                                 p_thread_space));<font></font>
  <span class="hljs-comment">//   .</span>
  cm_result_check(p_kernel-&gt;SetKernelArg(<span class="hljs-number">0</span>,
                                         <span class="hljs-keyword">sizeof</span>(thread_width),<font></font>
                                         &amp;thread_width));<font></font>
<font></font>
  <span class="hljs-comment">//   CmTask –      </span>
  <span class="hljs-comment">//         </span>
  <span class="hljs-comment">//     .</span>
  CmTask *p_task = <span class="hljs-literal">nullptr</span>;<font></font>
  cm_result_check(p_cm_device-&gt;CreateTask(p_task));<font></font>
  cm_result_check(p_task-&gt;AddKernel(p_kernel));<font></font>
<font></font>
  <span class="hljs-comment">//   </span>
  CmQueue *p_queue = <span class="hljs-literal">nullptr</span>;<font></font>
  cm_result_check(p_cm_device-&gt;CreateQueue(p_queue));<font></font>
<font></font>
  <span class="hljs-comment">//    GPU (    ). </span>
  CmEvent *p_event = <span class="hljs-literal">nullptr</span>;<font></font>
  cm_result_check(p_queue-&gt;Enqueue(p_task, p_event, p_thread_space));<font></font>
<font></font>
  <span class="hljs-comment">//   .</span>
    cm_result_check(p_event-&gt;WaitForTaskFinished());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のように、カーネルとホストの作成と使用は複雑ではありません。</font><font style="vertical-align: inherit;">すべてが簡単です！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現実の世界に戻るために警告する唯一の難しさ：現在、ICMの一般公開バージョンでは、カーネルをデバッグする唯一の方法はprintfメッセージです。</font><font style="vertical-align: inherit;">これらを正しく使用する方法は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello、Worldの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例で確認できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#0071c5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICM-重金属ではありません！</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それが実際にどのように機能するか見てみましょう。</font><font style="vertical-align: inherit;">ICM Developer Kit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はWindowsとLinux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">利用でき、</font></a><font style="vertical-align: inherit;">両方のオペレーティングシステムでICMコンパイラ、ドキュメント、チュートリアルの使用例が含まれています。</font><font style="vertical-align: inherit;">これらのトレーニング例の詳細な説明は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個別にダウンロードされ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linuxの場合、パッケージには、ICMランタイムランタイムライブラリが統合されたVAAPIのユーザーモードメディアドライバーも含まれています。</font><font style="vertical-align: inherit;">Windowsの場合、通常のWindows用Intel Graphics DriverはICMで動作します。</font><font style="vertical-align: inherit;">ICMランタイムランタイムライブラリは、このドライバーのdllセットに含まれています。</font><font style="vertical-align: inherit;">ICMパッケージには、リンクの.libファイルのみが含まれています。</font><font style="vertical-align: inherit;">ドライバーがシステムに何らかの理由で欠落している場合、それはIntel Webサイトからダウンロードされ、ドライバーのICMの正しい動作が保証されます（リリースのバージョン15.60-2017以降）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントのソースコードはここにあります：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VAAPI用インテルメディアドライバーおよびメディアランタイム用インテルC：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/intel/media-driver</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メディアコンパイラ向けIntel Cおよび例：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/intel/cm-compiler</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Graphics Compiler：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/intel/intel-graphics-compiler</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このセクションの残りの部分はWindowsに固有ですが、ICMを使用するための一般的な原則はLinuxにも適用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ICMパッケージで「通常の」作業を行うには、2015年からVisual Studio、バージョン3.2以降のCmakeが必要です。</font><font style="vertical-align: inherit;">同時に、トレーニング例の構成ファイルとスクリプトファイルはVS 2015用に設計されています。VSファイルの新しいバージョンを使用するには、VSコンポーネントへのパスを自分で調べて編集する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでは、Windows用ICMについて理解してください。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アーカイブをダウンロードしてください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開梱してください。</font></font></li>
<li> (    VS)    setupenv.bat    —  Intel GPU ( ,    GPU,    -: gen9),  : x86\x64   DirectX     ICM: dx9/dx11.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、すべてのトレーニングサンプルをビルドするだけです</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。examples</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーで、</font><i><font style="vertical-align: inherit;">build_all.bat</font></i><font style="vertical-align: inherit;">スクリプトが</font><i><font style="vertical-align: inherit;">これ</font></i><font style="vertical-align: inherit;">を実行</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">か、Microsoft Visual Studioのプロジェクトを生成</font><font style="vertical-align: inherit;">します。これにより、パラメーターとして特定のサンプルの名前を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用してcreate_vs.bat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトが</font><i><font style="vertical-align: inherit;">作成さ</font></i><font style="vertical-align: inherit;">れます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、ICMアプリケーションは、ホストパーツを含む.exeファイルと、対応するプリコンパイルされたGPUパーツを含む.isaファイルになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ICMパッケージにはさまざまな例が含まれています-ICM操作の基本原理を示す最も単純なHello、Worldからかなり複雑なものまで-画像のセグメンテーションとスティッチングで使用される「最大フロー-最小カット」グラフ（最大フロー最小カット問題）を見つけるためのアルゴリズムの実装。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのICMケーススタディは、コード内、およびすでに述べた</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個別の説明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内で適切に文書化されています</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ICMを正確に調査することをお勧めします-例を順番に調査して実行し、次に-ニーズに合わせてそれらを変更します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
既存のすべてのICM機能を一般的に理解するには、「仕様」、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">つまり</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ documents \ compiler \ html \ cmlangspecフォルダーに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あるICM記述</font><i><font style="vertical-align: inherit;">cmlangspec.html</font></i><font style="vertical-align: inherit;">を調べることを強くお勧めし</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特に、ハードウェアに実装されたICM関数のAPI-いわゆるテクスチャサンプラー（サンプラー）へのアクセス-さまざまな形式の画像をフィルタリングするメカニズム、およびビデオフレームと一部のビデオ分析機能の間の動き（モーション推定）を評価するメカニズムについて説明します。</font></font><br>
<br>
<h2><font color="#0071c5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICM-熱いうちにアイロンをかけてください！</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ICMアプリケーションのパフォーマンスについて言えば、ケーススタディにはそれらの作業時間の測定が含まれるため、それらをターゲットシステムで実行してタスクと比較することにより、ICMを使用する適切性を評価できることに注意してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ICMのパフォーマンスに関する一般的な考慮事項は非常に簡単です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計算をGPUにアップロードするときは、CPUデータ&lt;-&gt; GPUの送信とこれらのデバイスの同期のオーバーヘッドに注意してください。</font><font style="vertical-align: inherit;">したがって、Hello、Worldなどの例は、ICM実装には適していません。</font><font style="vertical-align: inherit;">しかし、特にプロセス内または出力でのこのデータの順序の変更を伴う、コンピュータビジョン、AI、およびデータアレイの重要な処理のアルゴリズムがICMに必要です。</font></font></li>
<li> ,   ICM–      GPU,  ,     (&gt;1000) GPU      .  ,          .    ,            –  . ,         GPU ( CPU). </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenCLコードはありますか？しかし、そのパフォーマンスは満足できませんか？</font><font style="vertical-align: inherit;">またはCUDAコードですが、はるかに多くのプラットフォームで作業したいですか？</font><font style="vertical-align: inherit;">次に、ICMを検討する価値があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ICMは生きて進化する製品です。</font><font style="vertical-align: inherit;">あなたはその使用とその開発に参加することができます-github上の対応するリポジトリはあなたのコミットを待っています。</font><font style="vertical-align: inherit;">両方のプロセスに必要なすべての情報は、この記事とgithubのreadmeファイルにあります。</font><font style="vertical-align: inherit;">不足しているものがある場合は、コメント内の質問の後に表示されます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja466505/index.html">YIMP-Bootstrap 4上のYii 2のコントロールパネル</a></li>
<li><a href="../ja466509/index.html">内観：Googleで機能するデバイスと適応のプロセス</a></li>
<li><a href="../ja466515/index.html">インタビュー。エンジニアがヨーロッパのスタートアップで働くことから何を期待すべきか、インタビューはどのように行われているか、そして適応するのは難しいか</a></li>
<li><a href="../ja466517/index.html">ワシントン大学ローカリゼーショントレーニング</a></li>
<li><a href="../ja466519/index.html">AWS Lambdaの詳細な分析</a></li>
<li><a href="../ja466525/index.html">PSD iPhoneレイアウトとは何ですか？</a></li>
<li><a href="../ja466527/index.html">カピバラページオブジェクトを使用したウェブサイトユーザー機能のテスト</a></li>
<li><a href="../ja466529/index.html">JVMのコンパイルタイプ：ブラックマジックセッションの公開</a></li>
<li><a href="../ja466533/index.html">パスティルダ：結果</a></li>
<li><a href="../ja466535/index.html">deepCloneの再考</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>