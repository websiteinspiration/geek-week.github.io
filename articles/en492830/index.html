<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤙🏾 👉🏿 🍑 SameSite = Lax by default - already in Chrome 80 stable (though not for everyone yet) 🤴🏿 🐉 👨🏽‍🤝‍👨🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The other day, an attentive colleague (thank you, Lena) reported a strange bug - the server normally set cookie in the browser, but it didn’t arrive b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>SameSite = Lax by default - already in Chrome 80 stable (though not for everyone yet)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492830/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The other day, an attentive colleague (thank you, Lena) reported a strange bug - the server normally set cookie in the browser, but it didn’t arrive back. Everything worked the day before, but now the cookie was set, but after a few seconds it magically disappeared (although it should last 24 hours). It was reproduced only by a few people in the team and only in the new Chrome 80, but the rest in Chrome had exactly the same version, everything was in order. In other browsers, everything worked like a clock. Mystic. They started to figure it out, and after some time, the Chrome console noticed a warning for the response header setting the cookie:</font></font><br>
<blockquote><code>A cookie associated with a cross-site resource at _your_domain_ was set without the `SameSite` attribute. A future release of Chrome will only deliver cookies with cross-site requests if they are set with `SameSite=None` and `Secure`.</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They began to study what it was, and gradually it became clear how the error arose and why not everyone showed it. </font><font style="vertical-align: inherit;">Since our service must process requests from different domains, then this </font></font><code>SameSite</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is just our case. </font><font style="vertical-align: inherit;">They added </font></font><code>SameSite=None; Secure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the problem was solved for us.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why is that?</font></font></h3><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, according to the HTTP standard, the browser sent </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cookies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (or just cookies) for any request to the corresponding domain. This opened up opportunities for a CSRF attack, that is, it allowed unscrupulous people, under a certain set of circumstances, to gain access to some resources under the guise of unsuspecting bona fide ones, simply by using their cookies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In 2016, an attribute was introduced </font></font><code>SameSite</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that allows you to control whether the browser will send cookies if the page sends a request to another domain. The developers have the opportunity to block the transfer of their cookies, if the request is executed from a third-party site. For this, the attribute </font></font><code>SameSite</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">had to be explicitly set to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strict.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(cookies are transmitted only upon requests and transitions from the domain to which they belong), or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lax</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (cookies are transmitted upon transition to the site from other sites by a direct link, but are not transmitted upon other requests from them, for example, when an AJAX request or uploading pictures ) The absence </font></font><code>SameSite</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">was equivalent </font></font><code>SameSite=None</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, that is, by default, cookies were still transmitted on any request. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In May 2019, Google Chrome developers announced that they would gradually change this behavior and interpret the absence of SameSite as </font></font><code>SameSite=Lax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(more </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) That is - by default, the browser will block the transmission of cookies for requests from the current page to any other resources, except for direct clicks on the link. Firefox and Edge developers have announced that over time, they will also implement this change in their browsers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For users, this browser behavior is more secure. Developers of sites and web services need to keep in mind that if they still need to receive their cookies when requesting from other sites, they will have to explicitly set their cookies attributes </font></font><code>SameSite=None, Secure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>Secure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- because such a request, in addition, should only come to the server via a secure channel )</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the innovation changes the current standard, and not all sites will be able to adapt quickly, the transition to a new behavior occurs gradually. </font><font style="vertical-align: inherit;">Initially, it was turned on for a limited number of Chrome beta users, and now their number is gradually increasing. </font><font style="vertical-align: inherit;">Actual information is available </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The latest entry on the link:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Last updated March 9, 2020. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have begun enforcing the new behavior for Chrome 80 stable, just not for 100% of users. </font><font style="vertical-align: inherit;">The controlled rollout is to a limited initial population,</font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That is, the beta testing period is behind, and Chrome developers have begun to slowly include new functionality among ordinary users. Which is good in principle, since it is really safer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can restore the old behavior through the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">settings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : in the Chrome address bar, enter </font></font><code>chrome://flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, go to the page, find the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SameSite be default cookies</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> item </font><font style="vertical-align: inherit;">, and set it to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disabled</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . But this is more suitable for testing than for ordinary users. Similarly, if your Chrome 80 is still running the old behavior, you can force the new functionality by setting the same setting to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enabled</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, if your site needs to receive cookies when requesting from different domains - be prepared for the upcoming changes (and whoever is ready is good for that). </font><font style="vertical-align: inherit;">Good to all! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Added by:</font></font></b><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xdenser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indicated in the comments that some older versions of browsers do not support </font></font><code>SameSite=None</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, not accepting such cookies at all or processing them in a non-standard way. </font><font style="vertical-align: inherit;">Among them are browsers for desktops and mobile devices. </font><font style="vertical-align: inherit;">The page </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.chromium.org/updates/same-site/incompatible-clients</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> provides a list of browsers and a possible solution to the problem (in pseudo-code, but quite detailed). </font><font style="vertical-align: inherit;">The authors suggest detecting problematic versions of browsers by title </font></font><code>useragent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and not setting their cookies attribute </font></font><code>SameSite=None</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at all. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Added 2:</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In connection with the situation with COVID-19, from April 3, 2020, Google temporarily suspends the implementation of the described changes in the processing of SameSite, to ensure the smooth operation of Internet services. </font><font style="vertical-align: inherit;">On devices where changes are already applied, they will be canceled. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(c) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog.chromium.org/2020/04/temporarily-rolling-back-samesite.html</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sources: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web.dev/samesite-cookies-explained </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.chromium.org/updates/same-site </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.chromestatus.com/ feature / 5088147346030592 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.chromium.org/updates/same-site/incompatible-clients </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog.chromium.org/2020/04/temporarily-rolling-back-samesite.html</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492812/index.html">Trying to run GAN networks in OpenVINO</a></li>
<li><a href="../en492816/index.html">IntelliJ IDEA Tips & Tricks: 4. Synchronize and share settings</a></li>
<li><a href="../en492820/index.html">.Net Core Api: getting data in a request from different sources</a></li>
<li><a href="../en492822/index.html">CSS developers - why do the world need them?</a></li>
<li><a href="../en492828/index.html">How to survive in a locked up world</a></li>
<li><a href="../en492832/index.html">IoT-gateway for industrial protocols based on i.MX6 and Linux</a></li>
<li><a href="../en492834/index.html">What is common between LVM and matryoshka?</a></li>
<li><a href="../en492838/index.html">Connect M5Stack to TV</a></li>
<li><a href="../en492844/index.html">How to visualize and animate (geophysical) models. 3D animation and visualization of 4D data</a></li>
<li><a href="../en492850/index.html">Not everyone wants to switch to remote work</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>