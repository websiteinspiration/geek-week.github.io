<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚰 👜 🎍 Transfer dinamika molekul ke CUDA. Bagian I: Dasar-Dasar 👨🏾‍🌾 🙇🏽 🗺️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tujuan artikel ini adalah untuk mengangkat masalah paralelisasi kode program untuk pemodelan numerik menggunakan metode dinamika molekul (MD) mengguna...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Transfer dinamika molekul ke CUDA. Bagian I: Dasar-Dasar</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/508396/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tujuan artikel ini adalah untuk mengangkat masalah paralelisasi kode program untuk pemodelan numerik menggunakan metode dinamika molekul (MD) menggunakan teknologi CUDA. Mengapa ini perlu sama sekali, karena paket perangkat lunak MD sudah ada, termasuk yang bekerja pada CUDA? Faktanya adalah bahwa saya sedang mengembangkan konsep saya sendiri tentang "medan gaya non-konstan", yang tidak diimplementasikan dalam program MD yang ada. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Membuat ulang kode orang lain untuk kebutuhan ini adalah tugas yang agak tidak berterima kasih, jadi saya memutuskan untuk mentransfer kode sekuensial saya yang sudah ditulis dan pada saat yang sama membagikan beberapa pemikiran. Selain itu, ini adalah tanggapan terhadap komentar yang sering berkedip-kedip di artikel CUDA seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi apa itu dinamika molekuler? </font><font style="vertical-align: inherit;">Di Habré sudah ada beberapa pos mengenai hal ini, misalnya di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Secara singkat, MD adalah metode yang memungkinkan Anda untuk mensimulasikan gerakan banyak partikel (termasuk atom, ion, molekul) dan menghitung sifat kolektif sistem, tergantung pada gerakan ini. </font><font style="vertical-align: inherit;">Bagaimana itu bekerja? </font><font style="vertical-align: inherit;">Misalkan untuk set partikel N beberapa koordinat awal, kecepatan, massa dan (paling penting!) Hukum interaksi di antara mereka diberikan. </font><font style="vertical-align: inherit;">Kami mengubah koordinat sesuai dengan kecepatan. </font><font style="vertical-align: inherit;">Berdasarkan hukum interaksi, kami menghitung gaya yang bekerja di antara partikel. </font><font style="vertical-align: inherit;">Karena kita tahu kekuatan dan massa, kita tahu percepatan. </font><font style="vertical-align: inherit;">Kami menyesuaikan kecepatan dengan mempertimbangkan akselerasi akun. </font><font style="vertical-align: inherit;">Dan lagi, kita beralih ke mengubah koordinat. </font><font style="vertical-align: inherit;">Jadi kami ulangi ribuan kali sampai </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda lelah</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami tidak akan mendapatkan statistik yang cukup.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/getpro/habr/post_images/d14/4f3/4f0/d144f34f09888282c2118202bc8d201a.jpg" alt="gambar">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam aplikasi nyata, urutan perhitungan "koordinat - kecepatan - gaya" agak lebih rumit, berdasarkan ekspansi dalam serangkaian fungsi koordinat partikel. Yang paling umum adalah algoritma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Velocity Verlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pseudocode program MD berdasarkan integrator Verlet adalah sebagai berikut:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">init_md;
<span class="hljs-keyword">int</span> iStep = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (iStep &lt; nStep)<font></font>
{<font></font>
    reset_quantities;<font></font>
    clear_cell_list;<font></font>
    verlet_1stage;<font></font>
    forces_calculation;<font></font>
    verlet_2stage;<font></font>
    temp_scale;<font></font>
    termostat;<font></font>
    some_output;<font></font>
    iStep++;<font></font>
}<font></font>
final_md; <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Loop program utama mengeksekusi sejumlah kali yang ditentukan pengguna ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nStep</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Iterasi dari loop ini disebut langkah waktu, atau hanya tanda waktu. Fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INIT_MD</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some_output</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak akan dipertimbangkan, mereka membaca informasi input, nilai-nilai yang di-nolkan, menampilkan data, mengalokasikan dan melepaskan memori, dll. Dari sudut pandang keluaran informasi, dinamika molekul sangat ideal untuk perhitungan pada kartu video: sebagian besar perhitungan tidak perlu dibongkar. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsinya </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_2stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berhubungan dengan integrator persamaan gerak dan suhu. </font><font style="vertical-align: inherit;">Fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forces_calculation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menghitung gaya yang bekerja di antara partikel, dan fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clear_cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengacu pada teknik mempercepat perhitungan (lebih lanjut tentang ini nanti). </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertimbangkan semua kelompok fungsi ini.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 Integrasi persamaan gerak</font></font></h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esensi dari tahap pertama algoritma Verlet dapat diekspresikan dengan rumus berikut:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.568ex" height="5.134ex" viewBox="0 -1455.1 9716.9 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-58" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2B" x="3261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-56" x="4262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-64" x="5031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-74" x="5555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2B" x="6138" y="0"></use><g transform="translate(6917,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-6D" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-64" x="8377" y="0"></use><g transform="translate(8901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-32" x="511" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">X = X + Vdt + \frac{F}{m}dt^2</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2E" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">V = V + \frac{F}{m}\frac{dt}{2}. </script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedua:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2C" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">V = V + \frac{F}{m}\frac{dt}{2},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
di mana X adalah koordinat partikel, V adalah kecepatannya, F adalah gaya yang bekerja padanya, m adalah massanya dan dt adalah langkah waktu. </font><font style="vertical-align: inherit;">Semua ini berlaku untuk semua partikel dan, secara alami, terjadi dalam 3 dimensi, jadi:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_1stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i, t
  <span class="hljs-keyword">float</span> charge;
  <span class="hljs-keyword">float</span> engElecField = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//     </span>
  __shared__ <span class="hljs-keyword">float</span> shEngElField;	<span class="hljs-comment">// shared   </span><font></font>
<font></font>
  <span class="hljs-comment">//    shared </span>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shEngElField = <span class="hljs-number">0</span>;<font></font>
    __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//   ,     </span>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
<font></font>
     t = md-&gt;types[i];<font></font>
     charge = md-&gt;specs[t].charge;<font></font>
<font></font>
     <span class="hljs-comment">//  v = v + f/m * 0.5 dt</span><font></font>
     md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
     md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
     md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
     <span class="hljs-comment">// x = x + v * dt</span><font></font>
     md-&gt;xyz[i].x += md-&gt;vls[i].x * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].y += md-&gt;vls[i].y * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].z += md-&gt;vls[i].z * md-&gt;tSt;<font></font>
<font></font>
     put_periodic(&amp;md-&gt;xyz[i], md-&gt;vls[i], md-&gt;masses[i], md-&gt;types[i], md);<font></font>
<font></font>
     keep_in_cell(i, md-&gt;xyz[i], md);<font></font>
<font></font>
     <span class="hljs-comment">//   </span>
     engElecField += charge * md-&gt;xyz[i].x * md-&gt;elecField.x; <span class="hljs-comment">// Eng = q * x * dU/dx</span><font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//     shared …</span><font></font>
  atomicAdd(&amp;shEngElField, engElecField);<font></font>
   __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//..    </span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)   <span class="hljs-comment">// 0th thread</span><font></font>
  {<font></font>
      atomicAdd(&amp;md-&gt;engElecField, shEngElField);<font></font>
  }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter input </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerBlock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerTherad</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan jumlah partikel (atom) yang diproses oleh satu blok dan aliran, masing-masing. </font><font style="vertical-align: inherit;">Karena jumlah atom dalam perhitungan seperti itu biasanya konstan, variabel-variabel ini dapat dihitung sekali dan untuk semua tempat di fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Parameter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari </font><font style="vertical-align: inherit;">tipe * cudaMD adalah tautan ke struktur, yang berisi tautan ke semua variabel yang diperlukan untuk perhitungan, seperti:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah jumlah partikel;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xyz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - array koordinat tipe float3;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vls</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - larik kecepatan tipe float3 (3 komponen vektor);</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - array gaya (juga 3 komponen vektor);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rMasshdT segera</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menyimpan ekspresi 0,5 * dt * m untuk setiap partikel;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jenis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - susunan jenis partikel, karena atom dapat berbeda;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spec</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menyimpan properti partikel, massa, muatan, dll. </font><font style="vertical-align: inherit;">Untuk mendapatkan properti partikel ith, Anda perlu membalikkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spec</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> form </font><b><font style="vertical-align: inherit;">[types [i]]</font></b><font style="vertical-align: inherit;"> .</font></font></li>
</ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya menggabungkan semua ini ke dalam struktur agar tidak melewatkan banyak parameter ke dalam fungsi. </font><font style="vertical-align: inherit;">Mungkin ini bukan solusi terbaik? </font><font style="vertical-align: inherit;">Mungkin layak untuk dideklarasikan sebagai variabel global? </font><font style="vertical-align: inherit;">Tidak dalam arti bahwa mereka berada dalam memori global, tetapi pada kenyataan bahwa mereka terlihat di semua fungsi program. </font></font></font><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kita akan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> membahas </font><font style="vertical-align: inherit;">fungsi </font><i><font style="vertical-align: inherit;">keep_in_cell</font></i><font style="vertical-align: inherit;"> di bagian untuk mempercepat perhitungan, dan fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_ periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menempatkan partikel dalam volume yang disimulasikan (kotak) jika ia terbang keluar dari itu (seperti dalam pacman, sebagaimana tepat meletakkannya)</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berani</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam posnya tentang MD). </font><font style="vertical-align: inherit;">Nah, karena fungsi yang dijelaskan melakukan pembaruan koordinat partikel, masuk akal untuk menghitung semua energi yang hanya bergantung pada koordinat, misalnya, energi partikel dalam bidang eksternal, jika ada. </font><font style="vertical-align: inherit;">Selanjutnya, menurut komentar yang valid</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Saya menghapus fungsi dari kode, menghapus zeroing variabel seperti </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engElecField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sekarang dipilih untuk keperluan ini </font><font style="vertical-align: inherit;">. Pertanyaan pada fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font><i><font style="vertical-align: inherit;">sebagai</font></i><font style="vertical-align: inherit;"> berikut: </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beberapa variabel (koordinat, kecepatan, dll.) Digunakan beberapa kali dan apakah disarankan untuk menurunkannya terlebih dahulu ke dalam memori yang lebih cepat? Atau apakah kompiler dapat mengoptimalkan hal-hal seperti itu sendiri?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_ periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> membuatnya sehingga partikel yang terbang keluar dari batas wilayah simulasi (kotak) muncul di sisi yang lain (kondisi batas periodik):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">put_periodic</span><span class="hljs-params">(float3&amp; xyz, float3 vel, <span class="hljs-keyword">float</span> mass, <span class="hljs-keyword">int</span> type, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">if</span> (xyz.x &lt; <span class="hljs-number">0</span>)<font></font>
   {<font></font>
      xyz.x += md-&gt;leng.x;<font></font>
<font></font>
      atomicAdd(&amp;md-&gt;specAcBoxNeg[type].x, <span class="hljs-number">1</span>); <font></font>
      atomicAdd(&amp;md-&gt;negMom.x, mass * (-vel.x)); <font></font>
   }<font></font>
   <span class="hljs-keyword">else</span>
     <span class="hljs-keyword">if</span> (xyz.x &gt;= md-&gt;leng.x)<font></font>
     {<font></font>
        xyz.x -= md-&gt;leng.x;<font></font>
<font></font>
        atomicAdd(&amp;md-&gt;specAcBoxPos[type].x, <span class="hljs-number">1</span>);<font></font>
        atomicAdd(&amp;md-&gt;posMom.x, mass * vel.x);<font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi ini berfungsi untuk kotak dengan geometri kotak persegi panjang. </font><font style="vertical-align: inherit;">Kode ini untuk mengukur x, sisa pengukuran benar-benar mirip. </font><font style="vertical-align: inherit;">Bidang </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revLeng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah ukuran kotak di dimensi yang sesuai dan nilai kebalikannya. </font><font style="vertical-align: inherit;">Secara umum, untuk mengembalikan partikel ke tinju, Anda dapat melakukannya tanpa operator bersyarat:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">xyz.x -= <span class="hljs-built_in">floor</span>(xyz.x * md-&gt;revLeng.x) * md-&gt;leng.x;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menggunakan operator kondisional dalam versi serial, karena saya harus menghitung jumlah partikel yang melewati batas kotak dan momentum total dari partikel-partikel ini (tekanan dapat dinyatakan dari itu). </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penghitung ini juga termasuk dalam kode di atas, mungkin untuk CUDA Anda perlu memikirkan bagaimana melakukannya tanpa jika</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian kedua integrator kecepatan Verlet:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_2stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i;
  <span class="hljs-keyword">float</span> kinE = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//  </span>
  __shared__ <span class="hljs-keyword">float</span> shKinE;	<span class="hljs-comment">// shared </span><font></font>
<font></font>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-comment">//     shared </span>
 <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shKinE = <span class="hljs-number">0.0</span>;<font></font>
  __syncthreads();<font></font>
<font></font>
<font></font>
  <span class="hljs-comment">// v = v + f/m * 0.5 dt</span>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
    md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
    md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
    md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
    <span class="hljs-comment">//  mv2</span><font></font>
    kinE += (md-&gt;vls[i].x * md-&gt;vls[i].x + md-&gt;vls[i].y  * md-&gt;vls[i].y + md-&gt;vls[i].z * md-&gt;vls[i].z) * md-&gt;masses[i];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//      shared memory...</span>
  atomicAdd(&amp;shKinE, <span class="hljs-number">0.5</span> * kinE);   <span class="hljs-comment">// kinE = mv2/2</span><font></font>
  __syncthreads();<font></font>
  <span class="hljs-comment">//...   global memory</span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     atomicAdd(&amp;md-&gt;engKin, shKinE);<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode struktur benar-benar mirip dengan bagian pertama integrator. Kami memperbarui kecepatan untuk setiap partikel, merangkum energi kinetik. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Temperatur" berfungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sistem molekuler berbeda dari sistem mekanik karena mereka memiliki konsep suhu. MD mewarisi definisi suhu dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teori molekul-kinetik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , di mana suhu adalah nilai yang sebanding dengan energi </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">kinetik</font></a><font style="vertical-align: inherit;"> rata-rata partikel (ada alasan untuk percaya bahwa ini adalah kekeliruan). Untuk mempertahankan suhu yang diinginkan dalam istilah seperti itu, Anda dapat dengan mudah skala kecepatan partikel, seperti fungsi temp_scale:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">temp_scale</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">float</span> k;
   <span class="hljs-keyword">int</span> i;
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   k = <span class="hljs-built_in">sqrt</span>(md-&gt;teKin / md-&gt;engKin);
   <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)<font></font>
   {<font></font>
      md-&gt;vls[i].x *= k;<font></font>
      md-&gt;vls[i].y *= k;<font></font>
      md-&gt;vls[i].z *= k;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
    <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;teKin;<font></font>
     }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bidang </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengandung energi kinetik target, sebanding dengan suhu yang ditentukan oleh pengguna. Fungsi ini hanya mengalikan semua komponen vektor kecepatan dengan k, dan kemudian satu aliran menetapkan energi kinetik sama dengan nilai yang diberikan. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di sini, variabel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> didefinisikan di setiap utas, meskipun dimungkinkan untuk mendefinisikannya dalam satu (karena itu sama) agar tidak melakukan pekerjaan yang tidak perlu, terutama karena akar kuadrat terlibat.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penskalaan suhu primitif seperti itu biasanya digunakan pada tahap awal simulasi (periode ekuilibrasi) dengan frekuensi beberapa langkah. </font><font style="vertical-align: inherit;">Algoritma pemeliharaan suhu (termostat) yang lebih canggih mensimulasikan tumbukan partikel dengan reservoir tertentu pada suhu tertentu, yang paling populer adalah termostat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nose-Hoover</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">tstat_nose</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> i;<font></font>
<font></font>
<span class="hljs-comment">//          </span>
<span class="hljs-comment">//   if (!blockIdx.x)</span>
<span class="hljs-comment">//     if (!threadIdx.x)   </span>
<span class="hljs-comment">//        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass;</span>
<span class="hljs-comment">//   __synctreads();</span><font></font>
<font></font>
   <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.0</span> - md-&gt;tSt * md-&gt;chit;<font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
       md-&gt;vls[i].x *= scale;<font></font>
       md-&gt;vls[i].y *= scale;<font></font>
       md-&gt;vls[i].z *= scale;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
     <span class="hljs-keyword">if</span> (!threadIdx.x)   <font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;engKin * scale * scale;<font></font>
        md-&gt;consInt += md-&gt;tSt * md-&gt;chit * md-&gt;qMassTau2;<font></font>
        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass; <font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perbedaan dari fungsi sebelumnya hanya dalam definisi faktor koreksi yang lebih kompleks. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk meringkas kelompok fungsi ini. </font><font style="vertical-align: inherit;">Semuanya paralel sempurna, tidak hanya karena mereka melakukan tindakan yang persis sama untuk semua partikel, tetapi juga karena mereka tidak memerlukan referensi silang. </font><font style="vertical-align: inherit;">Aliran, pemrosesan array dengan indeks i, tidak mengakses indeks j, tidak ada konflik akses ke data yang sama.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 Perhitungan kekuatan dan daftar sel</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam sistem molekuler, sumber utama gaya yang bekerja pada partikel (kecuali untuk bidang eksternal yang telah disebutkan) adalah partikel lain. </font><font style="vertical-align: inherit;">Perhitungan kekuatan-kekuatan ini adalah bagian MD yang paling rumit, memakan waktu, dan ambigu. </font><font style="vertical-align: inherit;">Salah satu perkiraan paling sederhana adalah bahwa semua interaksi dalam sistem adalah jumlah interaksi antara pasangan SETIAP partikel (perkiraan berpasangan). </font><font style="vertical-align: inherit;">Untuk tujuan ini, pasangan potensial diperkenalkan - ketergantungan fungsional energi potensial interaksi dua partikel pada jarak di antara mereka. </font><font style="vertical-align: inherit;">Potensi pasangan paling terkenal: potensi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lennard-Jones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (atau "6-12"), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buckingham</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan Born-Mayer-Huggins. </font><font style="vertical-align: inherit;">Sebagai contoh, saya akan memberikan ekspresi analitis dari dua yang pertama:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mn>4</mn><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>&amp;#x2212;</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup></mfrac><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.901ex" height="5.634ex" viewBox="0 -1616.6 8137.9 2425.9" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-34" x="2101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-3F5" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-28" x="3008" y="0"></use><g transform="translate(3398,0)"><g transform="translate(120,0)"><rect stroke="none" width="1146" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-36" x="810" y="513"></use></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2212" x="5007" y="0"></use><g transform="translate(5785,0)"><g transform="translate(342,0)"><rect stroke="none" width="1500" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-3C3" x="0" y="0"></use><g transform="translate(572,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-32" x="500" y="0"></use></g></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,288)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-32" x="500" y="0"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-29" x="7748" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mn>4</mn><mi>ϵ</mi><mo stretchy="false">(</mo><mfrac><msup><mi>σ</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>−</mo><mfrac><msup><mi>σ</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">U=4\epsilon(\frac{\sigma^6}{r^6}-\frac{\sigma^{12}}{r^{12}})</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mfrac><mi>r</mi><mi>&amp;#x03C1;</mi></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.645ex" height="5.634ex" viewBox="0 -1455.1 9750.1 2425.9" role="img" focusable="false" style="vertical-align: -2.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-41" x="2101" y="0"></use><g transform="translate(3018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-65"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-78" x="444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-70" x="973" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-28" x="4548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2212" x="4937" y="0"></use><g transform="translate(5716,0)"><g transform="translate(120,0)"><rect stroke="none" width="637" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-72" x="93" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-3C1" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-29" x="6593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2212" x="7205" y="0"></use><g transform="translate(7983,0)"><g transform="translate(342,0)"><rect stroke="none" width="1025" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-43" x="132" y="676"></use><g transform="translate(60,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhj1QBBYB9Qxjn4RiquJSNiNiEplIw#MJMAIN-2C" x="9471" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mfrac><mi>r</mi><mi>ρ</mi></mfrac><mo stretchy="false">)</mo><mo>−</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">U=A\exp(-\frac{r}{\rho})-\frac{C}{r^6},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
di mana U adalah energi potensial dari sepasang partikel, r adalah jarak antara partikel, dan semua huruf lainnya adalah parameter yang hanya bergantung pada jenis partikel yang berinteraksi dan ditetapkan pada tahap inisialisasi. Namun, bahkan lebih dari energi, kami tertarik pada kekuatan interaksi antara partikel-partikel ini. Pasukan sepele, melalui turunan dari potensi pasangan, yang juga mudah untuk memperoleh ekspresi analitis dan menjahit ke dalam program. Dan, karena gaya aksi sama dengan kekuatan reaksi, kita segera mendapatkan gaya yang bekerja pada kedua partikel dari satu sama lain, pseudocode:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">U = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)
	<span class="hljs-keyword">for</span> (j = i + <span class="hljs-number">1</span>; j &lt; N<span class="hljs-number">-1</span>; j++)<font></font>
	{<font></font>
		dx = x[i] – x[j];<font></font>
		dy = y[i] – y[j];<font></font>
		dz = z[i] – z[j];<font></font>
		r = <span class="hljs-built_in">sqrt</span>(dx*dx + dy*dy + dz*dz);<font></font>
		U += pair_pot(r, types[i], types[j]);<font></font>
		F = force(r, types[i], types[j])<font></font>
		fx[i] = F * dx;<font></font>
		fx[j] = -F * dx;<font></font>
		fy[i] = F * dy;<font></font>
		fy[j] = -F * dy;<font></font>
		fz[i] = F * dz;<font></font>
		fz[j] = -F * dz;<font></font>
<font></font>
	}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode ini sederhana: kami menemukan jarak antara partikel, menggantikannya dalam fungsi untuk potensial pasangan dan dalam fungsi untuk gaya (keduanya tergantung pada jenis partikel yang berinteraksi) dan menghitung proyeksi gaya. Siklus dilakukan N (N-1) / 2 kali, di mana N adalah jumlah partikel. Untuk setidaknya mengurangi jumlah perhitungan, kita dapat mengambil keuntungan dari kenyataan bahwa nilai dari potensi ini dengan cepat berkurang dengan jarak. Pada jarak yang lebih besar dari 6-8 angstrom, potensi tidak dapat dihitung, akan hampir nol. Menambahkan kondisi untuk memeriksa jarak (atau lebih tepatnya kuadratnya) kami akan mengurangi jumlah perhitungan, tetapi bukan jumlah iterasi siklus. Untuk sistem besar, sebagian besar cek akan memberikan false. Teknik-teknik berikut mengurangi jumlah cek dengan menjatuhkan bagian dari pasangan dengan jarak interatomik yang diketahui besar.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada dua metode utama untuk mengurangi jumlah pencarian pasangan partikel: daftar tetangga (alias </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">daftar Verlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">daftar sel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(daftar sel). Yang pertama, untuk setiap partikel kita ingat tetangganya yang berada dalam radius potensi. Daftar tetangga perlu diperbarui dengan beberapa, sebelumnya tidak diketahui, periodisitas, yang merupakan kelemahan dari metode ini. Oleh karena itu, mari kita memikirkan daftar sel, intinya adalah untuk membagi volume yang disimulasikan (kotak) menjadi (sub) sel. Awalnya, ukuran sel dipilih lebih besar dari atau sama dengan radius cutoff. Maka itu cukup untuk memilah pasangan partikel di dalam setiap sel dan antara sel yang berdekatan. Ukuran sel mungkin berbeda, hal utama adalah menentukan pasangan sel mana yang perlu Anda periksa. Bahkan, ini merupakan upaya untuk menggambarkan bola dalam kubus. Secara tradisional, untuk mengimplementasikan daftar sel dalam kode sekuensial, dua array diperkenalkan, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kepala</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">daftar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ukuran yang pertama sama dengan jumlah sel, yang kedua dengan jumlah partikel. </font><font style="vertical-align: inherit;">Yang pertama menyimpan indeks dari salah satu partikel dalam sel yang diberikan, indeks yang kedua sesuai dengan indeks partikel, dan isinya sesuai dengan indeks partikel berikutnya dalam sel (-1, jika tidak ada lagi partikel dalam sel), ilustrasi diberikan di bawah ini. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/tu/bw/hu/tubwhuvbci2oc2uxlupu3nt4zsc.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode semu untuk melintasi daftar seperti itu di dalam sel dengan indeks cell_index:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">i = head[cell_index];
<span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
{<font></font>
      j = <span class="hljs-built_in">list</span>[i];
      <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
              i-j;<font></font>
           j = <span class="hljs-built_in">list</span>[j];<font></font>
      }<font></font>
i = <span class="hljs-built_in">list</span>[i]; <font></font>
}	<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita coba mengimplementasikan daftar sel pada CUDA. </font><font style="vertical-align: inherit;">Dalam perkiraan nol, kami hanya mendistribusikan rentang sel untuk setiap aliran, jika tidak, meninggalkan kode berurutan untuk menghitung pasangan partikel di dalam sel dan pasangan yang melibatkan partikel sel tetangga. </font><font style="vertical-align: inherit;">Untuk setiap sel, array sel tetangga </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lstHNeig [iC] [jC]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan jumlah tetangga ini, array </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nHeadNeig [],</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus ditentukan </font><font style="vertical-align: inherit;">:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cellPerBlock, <span class="hljs-keyword">int</span> cellPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iC, jC;	<span class="hljs-comment">//  </span>
   <span class="hljs-keyword">int</span> i, j;	<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * cellPerBlock + threadId.x * cellPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-comment">//   </span>
   <span class="hljs-keyword">for</span> (iC = id0; iC &lt; N; iC++)<font></font>
   {<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         <span class="hljs-comment">//    </span><font></font>
         j = md-&gt;clist[i]; 	<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
               i-j;<font></font>
            j = md-&gt;clist[j];  <font></font>
         }<font></font>
<font></font>
         <span class="hljs-comment">//    </span>
         <span class="hljs-keyword">for</span> (jC = <span class="hljs-number">0</span>; jC &lt; md-&gt;nHeadNeig[iC]; jC++)<font></font>
         {<font></font>
            j = md-&gt;chead[md-&gt;lstHNeig[iC][jC]];<font></font>
            <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
            {<font></font>
                  i-j;    <font></font>
               j = md-&gt;clist[j];<font></font>
            }<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menurut pendapat saya, implementasi seperti itu tidak sepenuhnya mengungkapkan potensi kartu video, karena aliran tunggal memproses satu sel, yang, sebagai suatu peraturan, secara signifikan lebih kecil dari jumlah partikel. Kedua, di dalam fungsi pemrosesan sepasang partikel, kerja hanya dimungkinkan melalui operasi atom. Mari kita coba untuk menyejajarkan tugas dengan lebih kuat, biarkan setiap utas memproses sepasang sel tetangga (kami percaya bahwa daftar pasangan tersebut telah dibuat):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pairPerBlock, <span class="hljs-keyword">int</span> pairPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, jC;	<span class="hljs-comment">//     </span>
   <span class="hljs-keyword">int</span> i, j;		<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * pairPerBlock + threadId.x * pairPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (iP = id0; iC &lt; N; iP++)<font></font>
   {<font></font>
      iC = md-&gt;cellPairs[iP].x;<font></font>
      jC = md-&gt;cellPairs[iP].y;<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         j = md-&gt;chead[jC];<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
                i-j;<font></font>
             j = md-&gt;clist[j];<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellPairs []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> array yang </font><font style="vertical-align: inherit;">berisi jumlah pasangan sel tetangga (.v adalah sel pertama dari pasangan, .v adalah yang kedua). Kode ini lebih sederhana dan lebih elegan, tetapi di sini pemrosesan pasangan partikel di dalam satu sel menghilang, di mana fungsi terpisah harus ditulis. Ada masalah lain, pengorganisasian daftar sel dan perayapannya tidak efisien untuk komputasi paralel, karena untuk mendapatkan indeks partikel berikutnya dalam sel, Anda harus menjalankan semua yang sebelumnya. Mari kita coba membuat kode dan struktur data yang lebih efisien sehingga beberapa sel dapat diproses oleh beberapa utas sekaligus. Sekarang biarkan daftar sel disimpan dalam </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> array dua dimensi </font><b><font style="vertical-align: inherit;">[] []</font></b><font style="vertical-align: inherit;"> , di mana indeks pertama menentukan jumlah sel, dan yang kedua - nomor atom di dalam sel. Saya juga menyimpan jumlah partikel dalam sel dalam elemen nol array:</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sel [i] [0]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nilai </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sel [i] [j + 1]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan indeks umum partikel dalam memori global. Benar, implementasi seperti itu membutuhkan mengetahui jumlah maksimum partikel dalam sel dan akan memakan lebih banyak memori. Kami juga akan membagi tugas kami menjadi 2 subtugas. Fungsi pertama akan menghitung interaksi dalam pasangan sel yang terpisah (misalnya, dengan indeks 0-1, 2-3, 4-5, dll.) Dan di dalam sel:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2a</span><span class="hljs-params">(cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, iCA, iCB, step, step1; 
   <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;
   <span class="hljs-keyword">int</span> id;
   <span class="hljs-keyword">int</span> nA, nB, nOwn;  
   <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;		<span class="hljs-comment">//   </span><font></font>
<font></font>
   <span class="hljs-comment">//  --        </span>
   __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
   <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
   <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
<span class="hljs-comment">//   shared </span>
  <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      
  <span class="hljs-keyword">int</span>* sAids = shMem;		<span class="hljs-comment">//     1 (   )</span>
  <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell]; <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//     2 (B)</span>
  <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
  <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
  float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
  float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
   <span class="hljs-comment">//   ,    </span><font></font>
   float3 *sXyz;<font></font>
   float3 *sFrs;<font></font>
   <span class="hljs-keyword">int</span> *sTypes;
   <span class="hljs-keyword">int</span> *sIds;<font></font>
<font></font>
   <span class="hljs-comment">//       </span>
   iCA = md-&gt;cellPairs[blockIdx.x].x;  <span class="hljs-comment">//   </span>
   iCB = md-&gt;cellPairs[blockIdx.x].y;  <span class="hljs-comment">//   B</span><font></font>
<font></font>
   <span class="hljs-comment">//    -- </span>
  <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
<font></font>
   <span class="hljs-comment">//      shared_memory</span>
   <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>) <span class="hljs-comment">//!       A,  -   B. ,     </span><font></font>
     {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
     }<font></font>
   <span class="hljs-keyword">else</span><font></font>
     {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
     }<font></font>
<font></font>
   <span class="hljs-comment">//        </span>
   nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
   nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
   nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA  nB</span><font></font>
<font></font>
   <span class="hljs-comment">//   ,     </span>
  step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
   id0 = (threadIdx.x - deltId) * step;<font></font>
   N = min(id0 + step, nOwn);<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
      id = md-&gt;cells[iC][i+<span class="hljs-number">1</span>];<font></font>
      sIds[i] = id;		<span class="hljs-comment">//   </span>
      sXyz[i] = md-&gt;xyz[id];	<span class="hljs-comment">//  </span>
      sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <span class="hljs-comment">//  </span><font></font>
   sTypes[i] = md-&gt;types[id];<font></font>
   }<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//        i=0  j=1,    j     </span>
   i = <span class="hljs-number">0</span>;<font></font>
   j = threadIdx.x – deltId + <span class="hljs-number">1</span>;<font></font>
   step1 = blockDim.x / <span class="hljs-number">2</span>;
   <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
   {<font></font>
      <span class="hljs-keyword">while</span> (j &gt;= nOwn)<font></font>
      {<font></font>
          i++;<font></font>
          <span class="hljs-keyword">if</span> (i &gt;= nOwn<span class="hljs-number">-1</span>)<font></font>
          {<font></font>
              ex = <span class="hljs-number">1</span>;
              <span class="hljs-keyword">break</span>;<font></font>
          }<font></font>
          j = i + <span class="hljs-number">1</span> + j - nOwn;<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
      pair_in_cell(sXyz[i], @sFrs[i], sTypes[i], sXyz[j], @sFrs[j], sTypes[j], md, eVdW, eCoul);<font></font>
      j = j + step1;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//       </span><font></font>
   step1 = ceilf(nA / blockDim.x);<font></font>
   id1 = threadIdx.x * step1;<font></font>
   N1 = min(id1 + step1, nA);<font></font>
   <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
     <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
       pair_between_cell(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[blockId.x], md, eVdW, eCoul);<font></font>
<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
       md-&gt;frs[sIds[i]] = sFrs[i];<font></font>
<font></font>
   <span class="hljs-comment">//     </span><font></font>
   atomicAdd(&amp;engCoul, eCoul);<font></font>
   atomicAdd(&amp;engVdw, eVdW);<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">if</span> (!threadIdx.x) <font></font>
   {<font></font>
      atomicAdd(&amp;md-&gt;engCoul, engCoul);  <font></font>
      atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
   }<font></font>
}<font></font>
 </code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variabel bentuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">float3PerCell</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah produk dari jumlah maksimum partikel dalam sel dan ukuran float3. Masuk akal untuk menghitungnya sekali selama inisialisasi sistem. Fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_in_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menghitung interaksi antara partikel dalam sel yang sama dan berbeda, masing-masing. Sebagai parameter, mereka mendapatkan koordinat partikel, tipe, dan penunjuk tempat untuk menulis gaya. Parameter untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga termasuk besarnya pergeseran, untuk memperhitungkan kondisi batas periodik. Kode untuk fungsi-fungsi ini akan diberikan di bawah ini. Untuk memilah pasangan partikel di dalam sel, saya ingin pergi dengan cara standar - membagi jumlah pasangan menjadi interval yang sama dan memberikan setiap aliran interval. Namun, untuk mendapatkan indeks partikel ij dengan nomor pasangan, saya datang dengan persamaan kuadrat dan memutuskan untuk melakukannya secara berbeda: utas pertama memproses sepasang partikel dengan indeks 0-1, yang kedua - 0-2, dll. Setelah memproses pasangan ij, aliran menuju ke pasangan i- (j + N), di mana N adalah jumlah aliran dalam blok dan jika melampaui batas jangkauan, ia meningkatkan indeks partikel pertama dalam pasangan tersebut, lihat diagram:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/fv/-h/qa/fv-hqah4yeuzhpa9jbidswkmse8.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enumerasi pasangan antara sel yang berbeda adalah sebagai berikut: semua aliran menerima interval indeks partikel mereka dari sel A dan menghitung interaksi antara partikel-partikel ini dan semua partikel dalam sel B. Fungsi kedua menghitung interaksi di semua pasangan yang tersisa:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2b</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> iPair, iC, iCA, iCB, step, step1; 
    <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;    
    <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">int</span> nA, nB, nOwn; <font></font>
<font></font>
    __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
    <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      <span class="hljs-comment">// declaration of shared memory</span>
    <span class="hljs-keyword">int</span>* sAids = shMem;
    <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell];<font></font>
    float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell];<font></font>
    <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
    <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
    float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
    float3* sXyz;<font></font>
    float3* sFrs;  <font></font>
    <span class="hljs-keyword">int</span>* sTypes;
    <span class="hljs-keyword">int</span>* sIds;<font></font>
<font></font>
    iPair = blockIdx.x + md-&gt;nPair1;<font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    iCA = md-&gt;cellPairs[iPair].x; <font></font>
    iCB = md-&gt;cellPairs[iPair].y;<font></font>
    nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
    nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
    <font></font>
    <span class="hljs-comment">//    ,        </span>
    <span class="hljs-keyword">if</span> (!nA)
       <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!nB)
        <span class="hljs-keyword">return</span>;<font></font>
<font></font>
    <span class="hljs-comment">//      shared_memory</span>
    <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>)<font></font>
    {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
    }<font></font>
    nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA or nB</span><font></font>
<font></font>
    step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id0 = (threadIdx.x - deltId) * step;<font></font>
    N = min(id0 + step, nOwn);<font></font>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        id = md-&gt;cells[iC][i + <span class="hljs-number">1</span>];<font></font>
        sIds[i] = id;     <font></font>
        sXyz[i] = md-&gt;xyz[id];    <font></font>
        sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <font></font>
        sTypes[i] = md-&gt;types[id];<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    <span class="hljs-comment">//       </span>
    step1 = ceilf((<span class="hljs-keyword">double</span>)nA / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id1 = threadIdx.x * step1;<font></font>
    N1 = min(id1 + step1, nA);<font></font>
    <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
        {<font></font>
            pair_between_cell1(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[iPair], md, eVdW, eCoul);<font></font>
<font></font>
        }<font></font>
    __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].x), sFrs[i].x);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].y), sFrs[i].y);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].z), sFrs[i].z);<font></font>
    }<font></font>
<font></font>
    atomicAdd(&amp;engCoul, eCoul);<font></font>
    atomicAdd(&amp;engVdW, eVdW);<font></font>
    __syncthreads();<font></font>
 <font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        atomicAdd(&amp;md-&gt;engCoul1, engCoul);<font></font>
        atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode hampir mirip dengan fungsi sebelumnya, hanya pasangan yang tersisa sekarang diproses (indeks pasangan digeser oleh </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; nPair1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), interaksi dihitung hanya antara pasangan sel (sudah dihitung di dalam sel), dan ketika menyalin ke memori global, kami menggunakan atomicd untuk meringkas hasil dan tidak menimpa hasil mereka. </font><font style="vertical-align: inherit;">Sekarang saya membawa fungsi yang tersisa:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">keep_in_cell</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, float3 xyz, cudaMD* md)</span>
<span class="hljs-comment">//  index    xyz  cell list</span>
</span>{
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">int</span> c = <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.x / (<span class="hljs-keyword">double</span>)md-&gt;cSize.x) * md-&gt;cnYZ + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.y / (<span class="hljs-keyword">double</span>)md-&gt;cSize.y) * md-&gt;cNumber.z + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.z / (<span class="hljs-keyword">double</span>)md-&gt;cSize.z);<font></font>
<font></font>
    <span class="hljs-keyword">int</span> j = atomicAdd(&amp;(md-&gt;cells[c][<span class="hljs-number">0</span>]), <span class="hljs-number">1</span>);<font></font>
    md-&gt;cells[c][j + <span class="hljs-number">1</span>] = index;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berdasarkan koordinat, kami menghitung indeks sel tempat partikel ini masuk. Kami meningkatkan penghitung partikel dalam sel ini. Kami menulis indeks partikel ke dalam sel baru. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cSize</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah ukuran sel, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cnYZ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah produk dari jumlah sel dalam pengukuran Y dan Z. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mungkin bermanfaat untuk tidak menghitung indeks sel, tetapi untuk menyimpannya sebagai array 3 dimensi dalam memori tekstur, menggunakan indeks bentuk [x / md-&gt; cSize.x ] Apakah ini akan memberikan peningkatan kinerja?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Fungsi menghitung interaksi:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_in_cell</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw = <span class="hljs-literal">NULL</span>;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x; <font></font>
    dy = xyzA.y - xyzB.y;<font></font>
    dz = xyzA.z - xyzB.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-comment">//if (r2 &lt;= sim-&gt;r2Max)    </span>
    <span class="hljs-comment">//{</span>
    r = <span class="hljs-number">0.0</span>;<font></font>
    f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul);<font></font>
<font></font>
    <span class="hljs-comment">// -- </span><font></font>
    vdw = md-&gt;vdws[typeA][typeB];<font></font>
    <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
        <span class="hljs-comment">//if (r2 &lt;= vdw-&gt;r2cut)   //!      </span><font></font>
            f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
    <span class="hljs-comment">//      atomic,        </span><font></font>
    atomicAdd(&amp;(fxyzA-&gt;x), f * dx);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;y), f * dy);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;z), f * dz);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    <span class="hljs-comment">//}</span><font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menghitung jarak antara partikel, menggantikannya pertama-tama ke fungsi untuk Coulomb, dan kemudian untuk interaksi van der Waals. Jika ukuran sel dipilih sehingga diagonalnya tidak melebihi kisaran jenis interaksi terpendek, maka pemeriksaan jarak dapat dihapus (saya secara khusus meninggalkan mereka berkomentar dalam kode). Saya perhatikan bahwa di sini saya menghitung kuadrat jarak ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), dan jarak ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) itu sendiri dihitung dalam fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chProd [i] [j]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> array yang </font><font style="vertical-align: inherit;">menyimpan produk dari tuduhan jenis yang sesuai partikel. Mungkin juga harus ditempatkan dalam memori tekstur. Struktur vdw menyimpan parameter potensial berpasangan dan penunjuk fungsi ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feng_r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) untuk menghitung interaksi van der Waals. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi untuk menghitung interaksi antara dua sel yang berbeda:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_between_cell1</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, float3 shift, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x - shift.x;<font></font>
    dy = xyzA.y - xyzB.y - shift.y;<font></font>
    dz = xyzA.z - xyzB.z - shift.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)<font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul); <font></font>
<font></font>
        vdw = md-&gt;vdws[typeA][typeB];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
<font></font>
        fxyzA-&gt;x += f * dx;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
        fxyzA-&gt;y += f * dy;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
        fxyzA-&gt;z += f * dz;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode hampir identik dengan fungsi sebelumnya, ada koreksi pada perbedaan koordinat untuk memperhitungkan kondisi batas periodik, pemeriksaan jarak tidak dikomunikasikan, dan seperti yang kita ingat dari fungsi grup fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">tidak perlu menerapkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atomicAdd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke sel A, karena partikel di dalamnya diproses secara independen. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya perhatikan bahwa tergantung pada jarak antara sel-sel tertentu dalam suatu pasangan, Anda dapat menghilangkan beberapa pemeriksaan jarak dan perhitungan. </font><font style="vertical-align: inherit;">Untuk melakukan ini, Anda dapat menulis versi yang sedikit berbeda dari fungsi ini. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya juga memberikan fungsi yang menghitung kekuatan dan energi potensi pasangan untuk potensi Lennard-Jones dan Buckingham:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fe_lj</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = 4e[(s/r)^12 - (s/r)^6]</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> sr2 = vdw-&gt;p1 * r2i;
    <span class="hljs-keyword">float</span> sr6 = sr2 * sr2 * sr2;<font></font>
<font></font>
    eng += vdw-&gt;p0 * sr6 * (sr6 - <span class="hljs-number">1.0</span>);
    <span class="hljs-keyword">return</span> vdw-&gt;p2 * r2i * sr6 * (<span class="hljs-number">2.0</span> * sr6 - <span class="hljs-number">1.0</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fer_buck</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = A exp(-r/ro) - C/r^6</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> r4i = r2i * r2i;
    <span class="hljs-keyword">if</span> (r == <span class="hljs-number">0.0</span>)    <span class="hljs-comment">//  r , </span>
        r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
<font></font>
    eng += vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) - vdw-&gt;p2 * r4i * r2i;
    <span class="hljs-keyword">return</span> vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) / r / vdw-&gt;p1 - <span class="hljs-number">6.0</span> * vdw-&gt;p2 * r4i * r4i;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi mengembalikan gaya (yang harus dikalikan dengan proyeksi vektor jarak) dan menambah energi ke variabel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pointer ke salah satu fungsi ini disimpan dalam struktur cudaVdW. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secara umum, untuk mendapatkan lintasan gerak, energi tidak dapat dihitung, diperlukan untuk statistik yang berbeda. Jika kita menghilangkan ekspresi untuk energi dari fungsi-fungsi ini, perhitungannya cenderung dipercepat. Dan Anda dapat melakukan ini: sekali beberapa langkah untuk memanggil fungsi penuh, dan sisa waktu - hanya analog yang dikurangi.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bagian dari interaksi Coulomb dihitung oleh fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">real_ewald</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, <span class="hljs-keyword">float</span> chprd, <span class="hljs-keyword">float</span> alpha, <span class="hljs-keyword">float</span>&amp; eng)</span>
</span>{
    <span class="hljs-keyword">float</span> ar; 
    <span class="hljs-keyword">float</span> erfcar;
    <span class="hljs-keyword">float</span> kqq = chprd * d_Fcoul_scale; <span class="hljs-comment">// q[i]*q[j]*1/4pie0;</span><font></font>
<font></font>
    r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
    ar = alpha * r;<font></font>
    erfcar = erfc(ar);<font></font>
<font></font>
    eng += kqq * erfcar / r;<font></font>
    <span class="hljs-keyword">return</span> kqq / r / r2 * (erfcar + <span class="hljs-number">2</span> * ar / d_sqrtpi * <span class="hljs-built_in">exp</span>(-ar * ar));<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini berbeda dari hukum Coulomb yang sudah dikenal, tetapi lebih pada itu dalam artikel terpisah. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengujian dengan contoh nyata menunjukkan bahwa ada sangat sedikit partikel dalam sepasang sel untuk memuat semua aliran yang dialokasikan ke blok. Optimalisasi lebih lanjut dari fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah memproses beberapa pasangan sekaligus dalam satu blok. Sejauh ini saya hanya menulis versi paling sederhana, di mana arus dibagi menjadi beberapa pasang sel, yaitu satu blok memproses bukan satu pasangan, tetapi katakanlah 4: 0-1, 1-2, 3-4, 5-6. Anda mungkin memperhatikan bahwa dalam kasus ini, memuat data ke dalam memori bersama dapat sekaligus memproses pasangan 0-2, 0-3, 0-4, dll. Namun, ini membutuhkan trik tambahan pada tahap mempersiapkan data, yang belum saya pikirkan. Juga jika dalam fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda memuat pasangan dengan sel umum (misalnya, 0-2, 0-3, 0-4, dll.) Yang sama, Anda dapat mengurangi jumlah panggilan ke memori global dengan menyalin data dari sel 0 hanya sekali. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memeriksa apakah semuanya berfungsi dengan benar dalam penerapan algoritma daftar sel saya, saya juga menulis sebuah fungsi yang menghitung interaksi dengan cara yang naif, cukup menyortir semua pasangan:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">all_pair</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> i, j;
    <span class="hljs-keyword">int</span> step = blockDim.x * gridDim.x;
    <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;  <span class="hljs-comment">// exit flag</span>
    <span class="hljs-keyword">int</span> nAt = md-&gt;nAt;<font></font>
<font></font>
    i = <span class="hljs-number">0</span>;<font></font>
    j = blockIdx.x * blockDim.x + threadIdx.x + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">while</span> (j &gt;= nAt)<font></font>
        {<font></font>
            i++;<font></font>
            <span class="hljs-keyword">if</span> (i &gt;= nAt - <span class="hljs-number">1</span>)<font></font>
            {<font></font>
                ex = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
            j = i + <span class="hljs-number">1</span> + j - nAt;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
        global_pair(i, j, iStep, md);<font></font>
        j = j + step;<font></font>
    }<font></font>
} <font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">global_pair</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> engCoul = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">float</span> engVdw = <span class="hljs-number">0</span>;<font></font>
    cudaVdW* vdw;<font></font>
    <span class="hljs-keyword">int</span> ti, tj;<font></font>
<font></font>
    <span class="hljs-keyword">float</span> dx = md-&gt;xyz[i].x - md-&gt;xyz[j].x;
    <span class="hljs-keyword">float</span> dy = md-&gt;xyz[i].y - md-&gt;xyz[j].y;
    <span class="hljs-keyword">float</span> dz = md-&gt;xyz[i].z - md-&gt;xyz[j].z;<font></font>
<font></font>
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">if</span> (dx &gt; md-&gt;halfLeng.x)<font></font>
        dx -= md-&gt;leng.x;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dx &lt; -md-&gt;halfLeng.x)<font></font>
            dx += md-&gt;leng.x;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dy &gt; md-&gt;halfLeng.y)<font></font>
        dy -= md-&gt;leng.y;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dy &lt; -md-&gt;halfLeng.y)<font></font>
            dy += md-&gt;leng.y;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dz &gt; md-&gt;halfLeng.z)<font></font>
        dz -= md-&gt;leng.z;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dz &lt; -md-&gt;halfLeng.z)<font></font>
            dz += md-&gt;leng.z;<font></font>
<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)    <font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        ti = md-&gt;types[i];<font></font>
        tj = md-&gt;types[j];<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[ti][tj], md-&gt;alpha, engCoul);<font></font>
<font></font>
        vdw = md-&gt;vdws[ti][tj];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw); <font></font>
<font></font>
        dx *= f;<font></font>
        dy *= f;<font></font>
        dz *= f;<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].x), dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].x), -dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].y), dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].y), -dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].z), dz);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].z), -dz);<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;engCoul1), engCoul);<font></font>
        atomicAdd(&amp;(md-&gt;engVdW), engVdw);<font></font>
<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasil perhitungannya bertepatan. </font><font style="vertical-align: inherit;">Benar, tampaknya, karena urutan pembulatan yang berbeda, koordinat partikel dalam tempat desimal ke-3 dapat bervariasi dari awal hingga awal. </font><font style="vertical-align: inherit;">Saya perhatikan bahwa pada sistem sekitar 1.400 partikel dan radius cut-off 6 angstrom, fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kehilangan sekitar dua kali waktu eksekusi untuk penghitungan sederhana. </font><font style="vertical-align: inherit;">Saat memproses beberapa blok (8 dan 16) sekaligus dalam satu blok, kecepatannya dibandingkan dan bahkan mungkin sedikit di depan fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all_pair</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Namun, ini harus sangat tergantung pada ukuran sistem. </font><font style="vertical-align: inherit;">Dengan peningkatan jumlah atom, kecepatan algoritma daftar sel tumbuh secara linear, dan enumerasi sederhana secara kuadratik. </font><font style="vertical-align: inherit;">Selain itu, daftar sel sangat efektif dalam memodelkan sistem yang dikeluarkan (jarak besar antar partikel), misalnya gas</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini menyimpulkan artikel ini, saya akan senang dengan pertanyaan dan komentar, terutama pada peningkatan produktivitas. </font><font style="vertical-align: inherit;">Saat-saat yang paling disengketakan dalam perjalanan narasi yang saya catat dengan warna merah. </font><font style="vertical-align: inherit;">Karena pemindahan sisa fungsional dari dinamika molekuler masih perlu dilakukan, saya berencana untuk melanjutkan siklus artikel-artikel ini:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penjumlahan Ewald.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interaksi intramolekul.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gap dan pembentukan ikatan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transfer elektronik.</font></font></li>
</ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari literatur tentang MD saya dapat merekomendasikan buku </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daan Frenkel dan Berend Smit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memahami Simulasi Molekul: Dari Algoritma ke Aplikasi</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulasi Cairan Komputer,</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ditulis oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MP Allen, DJ Tildesley</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Untuk yang pertama, sejauh yang saya tahu, ada terjemahan ke dalam bahasa Rusia. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya juga berterima kasih kepada Pavel Kudinov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pavel_kudinov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk komentarnya, menyerukan " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menulis kode GPGPU sesederhana dan sejelas palu,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " bacaan yang akhirnya saya lanjutkan ke tindakan, yang menghasilkan artikel ini.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">06/27/2020. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terima kasih atas komentarnya</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menghapus zeroing dari parameter global dari fungsi dan mendefinisikan kisaran partikel yang dikeluarkan ke aliran dengan cara yang berbeda.</font></font></div>
      
    </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id508380/index.html">Otomatisasi pengiriman barang di Cina</a></li>
<li><a href="../id508384/index.html">Cara membiasakan pengembang dengan nilai-nilai bisnis Anda tanpa menggunakan kekerasan</a></li>
<li><a href="../id508390/index.html">VR saat melatih staf. Pro dan kontra yang nyata</a></li>
<li><a href="../id508392/index.html">Pendanaan Perang Sipil (AS vs. AS)</a></li>
<li><a href="../id508394/index.html">Bagaimana mahasiswa baru dari St. Petersburg HSE menulis klien torrent, penganalisa kode, editor foto dan tidak hanya untuk semester</a></li>
<li><a href="../id508398/index.html">Tiga cara untuk seorang programmer: ahli, pemimpin, pendiri</a></li>
<li><a href="../id508400/index.html">Bagaimana seorang “warga negara aktif” membiasakan orang untuk melakukan phishing</a></li>
<li><a href="../id508402/index.html">Bagaimana Arsitektur HiCampus Menyederhanakan Jaringan Kampus</a></li>
<li><a href="../id508404/index.html">AI vs AI battle: penipuan dan konten palsu</a></li>
<li><a href="../id508408/index.html">Antivirus seluler tidak berfungsi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>