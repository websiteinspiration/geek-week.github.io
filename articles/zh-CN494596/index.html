<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👐🏻 🕺🏽 💍 如何创建多主体传输模型 🚪 🏤 ♂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha！
 
 想象一下，我们有一项建设新道路的任务。您可以在每个方向上建立两条车道的高速公路，但是如果这还不够呢？或者相反，事实证明，一块土地就足够了，但是对于项目的实施，有必要购买许多土地吗？在这两种情况下，该决定都是无效的。为了最大程度地降低此类风险，运输计划人员会向计算机建模寻求帮助。本文是...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>如何创建多主体传输模型</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494596/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">哈Ha！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
想象一下，我们有一项建设新道路的任务。您可以在每个方向上建立两条车道的高速公路，但是如果这还不够呢？或者相反，事实证明，一块土地就足够了，但是对于项目的实施，有必要购买许多土地吗？在这两种情况下，该决定都是无效的。为了最大程度地降低此类风险，运输计划人员会向计算机建模寻求帮助。本文是对多主体建模领域的简要介绍。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bq/k0/kj/bqk0kjbb814y7q7twu1uvqk3yf4.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用模型（该模型是实际运输系统的副本），您可以估计预计道路的每个部分的必要吞吐量，尝试不同的跟踪选项，或者例如在公私合营框架下估计收费公路的项目投资回收期。但是还有其他重要的任务可以解决：如何组织最佳的公共交通路线并计算运营商的潜在收入，如何评估特定区域中停车位不足的存在，等等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最有趣的是，在自由软件时代，任何人都可以构建类似的模型！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开源是最常见的多主体建模工具之一。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATSim（多代理传输仿真）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MATSim模拟单个代理的行为。代理是现实世界中个人的计算机表示。每个这样的代理都有一个日常计划，他根据该计划从一项活动转移到另一项活动（例如，家庭工作家庭，家庭研究所工作家庭，家庭商店工作1-工作2-家庭等），创建因此对道路基础设施的需求。每日计划的示意图表示如下：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n6/xt/m_/n6xtm_ps8u0stk6f8doybvsxzq8.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了创建能反映白天人们真实行为的代理商的现实计划，要考虑代理商居民的总数，他们的安置，工作地点，学习场所，商店，购物中心，火车站和其他活动场所。为了验证需求，还基于现场调查对模型进行了校准：使用神经网络或（例如）道路强度的手动测量来识别和计算监视摄像机和无人机的流量。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0x/t-/ke/0xt-kelsnwf39k3mmu2saye2zky.gif" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在模拟过程中，代理商分布在网络上，模仿人们的真实行为：实施他们的计划，汽车在道路和停车位上占据一席之地，公交用户在公交车上占位，并且彼此交互，如果许多代理商一次选择一条道路，造成交通堵塞和拥堵。一切都像现实世界一样！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
模拟完成后，将评估座席的日常计划的执行情况，称为得分。代理人在活动过程中获得公用事业单位，而在活动过程中丢失它们。因此，陷入交通拥堵的代理商比沿自由道路移动的代理商损失更多的公用事业单位。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每次迭代之后，某些代理商都会根据有关路网负荷的信息来重建其计划，以提高其性能：代理商可以更改出发时间，更改运输方式或更改路线。</font><font style="vertical-align: inherit;">其余代理遵循其先前的计划，这些计划存储在程序存储器中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理想情况下，在模拟之后，应达到Nash平衡-也就是说，没有任何代理人可以提高其位置而不恶化其他代理人的位置。</font><font style="vertical-align: inherit;">通常，考虑到居民每天对前一天的经历的重新思考，这种情况会随着时间在城市道路上逐步发展。</font><font style="vertical-align: inherit;">为此，在一种情况下至少执行200次迭代。</font><font style="vertical-align: inherit;">整个MATSim工作周期如下所示：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mr/zv/ds/mrzvds3njmsli5hbkiqvzhnuoju.png" alt="图片"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从理论到实践！ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要运行第一种情况，我们需要板载Java 1.8的Intellij IDEA（或Eclipse）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们打开IDE，</font><font style="vertical-align: inherit;">从github </font><font style="vertical-align: inherit;">克隆</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATSim存储库</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，第一个方案已准备就绪！</font><font style="vertical-align: inherit;">很简单。</font><font style="vertical-align: inherit;">但是首先让我们看看我们使用什么输入文件。</font><font style="vertical-align: inherit;">对于最简单的模拟，共有三个：网络，计划，配置。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网络文件是代理程序在其上移动的网络。</font><font style="vertical-align: inherit;">它由节点和节点/链接组成。</font><font style="vertical-align: inherit;">每个链接具有不同的属性：类型，路段长度，吞吐量，最大速度，车道数量，单向交通，允许的运输方式等。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_n/5p/rx/_n5prxnenyiuei82fndy2uekigy.jpeg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手动创建城市网格非常困难，不切实际且效率低下。</font><font style="vertical-align: inherit;">例如，我们的圣彼得堡网格由26,000个节点和46,000个链接组成。</font><font style="vertical-align: inherit;">但是有个好消息。</font><font style="vertical-align: inherit;">可以从OpenStreetMap转换网格，然后使用也是开源的JOSM进行编辑。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计划</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计划文件是代理商日常计划的结构化表示。</font><font style="vertical-align: inherit;">在最初的情况下，我们有100名特工在早上（end_time =“ 05:59”）从家中（类型=“ h”，链接=“ 1”）开车（工作方式=“汽车”）离开工作（类型= “ W”，链接=“ 20”），之后一段时间（dur =“ 02:30”），他们返回家中。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8g/vh/sp/8gvhsph0hfmjwzpfspy0liqv7xo.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设定档</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，在配置文件中，所有必需的设置都已设置为运行脚本。</font><font style="vertical-align: inherit;">MATSim包含您可以根据需要自定义，添加或删除的模块。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配置文件中的许多设置都很直观，但是您也可以随时查看所谓的。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATSim书</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">现在，我们将仅考虑两个模块。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计分参数在planCalcScore模块中设置：例如，特工收到18个单位的迟到罚款。</font><font style="vertical-align: inherit;">每小时的效用（分别是，延迟10分钟相当于损失3个效用单位）；</font><font style="vertical-align: inherit;">某项活动（例如表演）的表现每小时可带来6个效用单位，而驾车的成本则为每小时6个效用单位。时间。” </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在策略模块，重新规划的参数配置，例如，什么药（ModuleProbability）的比例将尝试下一个迭代过程中新的路由（重路由）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/jf/yo/dcjfyoldbtrsg_zgrydyrrkc6ce.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，仿真的目标是帮助从A点代理获取到B点以最低的成本。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脚本运行</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是时候打开RunMatsim运行程序并运行我们的第一个脚本了！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仿真结果将位于项目根目录的输出文件夹中。可视化的主要文件是网络和事件。事件文件包含有关每个代理的所有动作的每秒信息，因此，基于该文件，您可以恢复所有代理的运动的全貌。您可以使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Via</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可视化结果</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了获得更具代表性的结果，我将代理数量增加到500。这是第一次迭代后500个代理的分布情况…… </font></font><br>
<br>
<img src="https://habrastorage.org/webt/by/o3/zk/byo3zk14bt0yj1y7od2sth35nok.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font><font style="vertical-align: inherit;">迭代</font><font style="vertical-align: inherit;">开始时，代理使用</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Dijkstra</font></a><font style="vertical-align: inherit;">计算出了最短的方法</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果，网络的一个部分中的流量强度超过其吞吐量，形成了拥塞。</font><font style="vertical-align: inherit;">但是，如果您给他们机会尝试不同的路线怎么办？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7l/_j/5_/7l_j5_q_n2g3roivtbnht8iwqfq.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
经过200次迭代（〜5分钟）后，代理已通过网络重新分配，链路负载级别现在不超过0.5，所有代理的平均旅行时间减少了14％（5分钟）。</font><font style="vertical-align: inherit;">万岁，我们已经克服了软木塞！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
哦，就这么简单！</font><font style="vertical-align: inherit;">实际上，运输系统要复杂得多。</font><font style="vertical-align: inherit;">在以下文章中，我将告诉您如何参与圣彼得堡和其他城市的模型开发以及如何解决实际案例中的实际问题。</font><font style="vertical-align: inherit;">Scientia潜力EST！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/v-/t0/cjv-t0plurhha0_szf4vhthcubo.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由OTSLab运输分析师Andrey Kolomatsky发表。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN494580/index.html">分形在沙子上，或三个以上不聚集</a></li>
<li><a href="../zh-CN494582/index.html">Microsoft将不再颁发MCSE / MCSD / MCSA证书</a></li>
<li><a href="../zh-CN494586/index.html">以线性代数理论为例，以函数式编程作为处理矩阵的示例</a></li>
<li><a href="../zh-CN494590/index.html">冠状病毒-恐慌症</a></li>
<li><a href="../zh-CN494592/index.html">自制锰蒸气激光</a></li>
<li><a href="../zh-CN494598/index.html">斯坦福大学的研究人员开发了一种用于跑步的外骨骼</a></li>
<li><a href="../zh-CN494600/index.html">使用discord.py库创建一个简单的Discord机器人</a></li>
<li><a href="../zh-CN494604/index.html">紫外线消毒盒，可重复使用一次性口罩</a></li>
<li><a href="../zh-CN494606/index.html">如何观察月球和行星</a></li>
<li><a href="../zh-CN494608/index.html">准备大胆敢</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>