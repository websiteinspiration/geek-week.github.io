<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏆 🥜 🙊 探索Cobalt网络分组：黑客使用哪些新工具和攻击 👨‍👨‍👦‍👦 👩🏻‍🚒 🤽🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="自2016年以来 ，PT专家安全中心的专家一直在监视Cobalt集团的活动。今天，该组织正在袭击全球的金融机构。一年前，这些袭击造成的损失超过 10亿卢布。在过去的四年中，我们发布了有关该组攻击的几份报告。
 
 在过去的一年中，Cobalt组不仅结合了more_eggs JavaScript后门修...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>探索Cobalt网络分组：黑客使用哪些新工具和攻击</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/506932/"><img src="https://habrastorage.org/webt/y2/c0/qd/y2c0qdpfwf0ykktfxq6kcdjxjcc.png"><br>
<br><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">自2016年以来</font></a><font style="vertical-align: inherit;"> 
，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT专家安全中心的专家一直在</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">监视Cobalt集团的活动</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">今天，该组织正在袭击全球的金融机构。</font><font style="vertical-align: inherit;">一年前，这些袭击造成的损失</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">超过</font></a><font style="vertical-align: inherit;"> 10亿卢布。</font><font style="vertical-align: inherit;">在过去的四年中，我们</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">发布</font></a><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">有关该组</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">攻击的</font></a><font style="vertical-align: inherit;">几份</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">报告</font></a><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在过去的一年中，Cobalt组不仅结合了more_eggs JavaScript后门修改了其主要CobInt工具和COM-DLL删除程序，而且还在攻击的初始阶段使用了新的传递方法和新技术来绕过保护。</font><font style="vertical-align: inherit;">更新策略和工具可能是由于以下事实：该组织长期以来一直是来自世界各地的研究人员的攻击目标，因此，绕过保护手段必须向前迈出一步。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
平均而言，在2019年，该组织每月进行3次攻击。</font><font style="vertical-align: inherit;">在我们的新文章中-分析网络分组的新策略和工具。</font><font style="vertical-align: inherit;">该研究的完整版本可</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此处获得</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络钓鱼网站欧洲中央银行</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2019年8月末，在调查信息安全威胁时，我们记录了使用CobInt进行的攻击。据称袭击是针对欧洲金融机构的。我们没有成功的数据。定制的NSIS安装程序充当CobInt的放置程序。我们发现了这种吸管的三个版本：Chrome，Firefox和Opera。每个内部都有相同版本的CobInt和相应的浏览器安装程序。启动后，滴管将CobInt保存到％TEMP％文件夹，安装程序也启动了它。经过分析恶意软件，我们发现丢弃程序的分布来自phb网站ecb-european [。] Eu。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/by/up/fmbyupvcfdyjqxqtv_rva-ubnay.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络钓鱼网站首页</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该网站是欧洲中央银行网站的副本-除了在访问该网站时，向用户显示一个弹出窗口，要求他更新浏览器。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9i/pn/ni/9ipnniehr72_vbnv0evoyy5m7a4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假的ECB网站上的弹出窗口</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
结果，上述的放置程序被下载到用户的计算机上。</font><font style="vertical-align: inherit;">在页面的源代码中，有一个指向显示此窗口的脚本的链接。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
用户最有可能使用类似于Cobalt组最常使用的网络钓鱼电子邮件到达站点。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.恶意VHD</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在2019年12月底，我们发现了下一个CobInt Cobalt引导程序。不寻常的是包含此引导加载程序的容器。它是一个虚拟硬盘（VHD），据推测已经寄出了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自创建Hyper-V虚拟化技术以来，一直使用VHD格式。 VHD文件可以包含在常规HDD上可以找到的所有内容：磁盘分区，包含文件夹和文件的文件系统。从Windows 7开始，用户可以手动连接VHD，例如通过MMC控制台。从Windows 8开始，用户只需用鼠标双击VHD即可连接VHD，它将在系统中显示为常规磁盘。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2019年9月，在CERT / CC博客上发表</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了一篇文章</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VHD文件的危险及其在攻击中的潜在载体。威尔·多曼（Will Dorman）表示，杀毒软件或Web上的标记都不会向用户发出信号，即从Internet下载的VHD文件的内容可能会损害计算机。 Cobalt组可能使用了这项研究的结果。他们的VHD文件在VirusTotal上出现时也未被防病毒检测到。六个月后，该文件仅被一种防病毒软件检测到：这是一个非常低的指标。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vy/ok/xu/vyokxub26hafxvwac-cdikvtams.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VHD内有两个CobInt文件。其中一个文件的末尾附加了两个无效的Google证书，以减少通过安全功能检测到的可能性。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
挂载VHD之后，用户必须手动启动其中一个文件。</font><font style="vertical-align: inherit;">按功能，这两个文件是相同的。</font><font style="vertical-align: inherit;">启动CobInt之一后，将加载主库。</font><font style="vertical-align: inherit;">CobInt从控制服务器将主库作为HTML文件加载。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. BIFF宏 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2020年3月，我们记录了XLS格式的Cobalt组文档，该文档下载并运行了COM-DLL删除程序。该文档包含一个相当古老的Excel 4.0宏格式，实际上并未被防病毒软件检测到（根据VirusTotal服务，有60分之1的结论）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4n/8m/w-/4n8mw-eh7eh8vodwp2zwbauplg4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一次将Excel 4.0宏文件下载到VirusTotal时，确定的防病毒数量</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
已经使用20年了。它的特点是宏没有存储在VBA项目中，它位于页面的单元格中，而页面可以隐藏在Excel本身中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这意味着该宏将不在VBA流中，而是在BIFF记录（二进制交换文件格式）中。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您在Excel中打开文档，那么我们将只看到一页，并且VBA项目中没有宏。</font><font style="vertical-align: inherit;">但是，Excel仍将检测宏的存在并阻止其执行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在公式管理器中打开源文档，我们将看到打开文档时其中一个公式自动启动。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/20/9w/e5/209we5fodrts0svk62kuavorzky.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打开文档时开始的宏公式，</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
初始公式将启动大型链的COMBIN，EXECUTE，SYMBOL，CALL命令，最终导致COM-DLL插入器的加载和启动。</font><font style="vertical-align: inherit;">整个命令链散布在Excel页面中巨大的单元格区域中，这使分析变得困难。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ir/fo/tv/irfotvsrlnkddg31oszuzjhnwy4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于下载和运行COM-DLL删除程序的宏公式</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. COM-DLL删除器的分析</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2020年4月上旬，我们发现了COM-DLL滴管的新版本。</font><font style="vertical-align: inherit;">在功能方面，它与我们之前看到的所有内容不同。</font><font style="vertical-align: inherit;">但是，more_eggs JavaScript后门形式的有效负载保持不变。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COM-DLL删除器于2017年夏天出现在Cobalt军械库中，并且仍被该组织用来提供JavaScript后门</font></font><code>more_eggs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该</font><font style="vertical-align: inherit;">后门</font><font style="vertical-align: inherit;">以加密和存档的形式包含在其中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功能滴管：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全用PureBasic编写。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用大量不同的抗分析技术。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它包含一个加密和存档的JavaScript加载器，一个JavaScript后门，一个用于启动more_eggs JavaScript后门的合法命令行转换实用程序。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它具有一个内置的混淆器，用于JavaScript后门和内部连接的JavaScript加载器。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
钴集团继续攻击全球的金融机构，采取新策略，更新工具，并试图更有效地绕过防御。</font><font style="vertical-align: inherit;">由于隔离问题，许多信贷和金融部门的员工现在无法在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公司的补救措施</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围内“远距离”工作</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">另外，许多攻击者在他们的攻击中使用冠状病毒主题，例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Higaisa组</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Cobalt小组有可能在以后的攻击中尝试使用此主题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该研究的完整版本</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可在此处获得</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作者</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Denis Kuvshinov，Sergey Tarasov，Daniil Koloskov，PT专家安全中心</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN506906/index.html">黑洞悖论揭示了能量与秩序之间的根本联系</a></li>
<li><a href="../zh-CN506908/index.html">顶尖科学。可能媒体十：绝望的水族馆鱼，精神障碍的声音和许多次COVID</a></li>
<li><a href="../zh-CN506916/index.html">什么是服务网格？</a></li>
<li><a href="../zh-CN506924/index.html">在设计初期如何选择最佳材料？</a></li>
<li><a href="../zh-CN506926/index.html">分析：为什么Zoom的用户数和收入强劲增长并不能说明大流行之后公司的成功</a></li>
<li><a href="../zh-CN506938/index.html">索尼PlayStation 5演示文稿中的游戏</a></li>
<li><a href="../zh-CN506940/index.html">理想之路：程序员及其领导者的简要指南</a></li>
<li><a href="../zh-CN506950/index.html">什么是21世纪学校，为什么如此设计</a></li>
<li><a href="../zh-CN506952/index.html">API门户：设计时要寻找的内容。罢工经验</a></li>
<li><a href="../zh-CN506954/index.html">关于Rails和ELK的另一篇文章</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>