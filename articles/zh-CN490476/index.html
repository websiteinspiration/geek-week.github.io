<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ğŸ•™ ğŸ¾ æ— çº¿ä¼ æ„Ÿå™¨ï¼Œç”¨äºæ‰“å¼€å’Œå…³é—­ï¼Œå…·æœ‰é«˜çº§åŠŸèƒ½ ğŸ´ â¹ï¸ ğŸ˜‘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘æ¬¢è¿Habrçš„æ‰€æœ‰è¯»è€…ï¼Œå°¤å…¶æ˜¯â€œ DIYæˆ–è‡ªå·±åŠ¨æ‰‹åšâ€éƒ¨åˆ†çš„è¯»è€…ï¼è€Œä¸”ï¼Œå¦‚æœæˆ‘æ— æ³•æå‡ºç±»ä¼¼çš„å»ºè®®ï¼Œé‚£æˆ‘å°±æ˜¯ä¸€åarduinoï¼Œæˆ‘å¯ä»¥...æˆ‘ä¸æ¶‰åŠç®¡ç†ç”µæ¢¯è½¿å¢çš„ä¸»è¦ä¸»é¢˜:)ã€‚ç»è¿‡ä¸€ç•ªæ€è€ƒï¼Œå‡ºäºæŸç§åŸå› ï¼Œæˆ‘æƒ³åˆ¶ä½œä¸€ä¸ªå¼€åˆä¼ æ„Ÿå™¨ã€‚å°±åƒæˆ‘æœ€è¿‘åšçš„å…¶ä»–æ‰‹å·¥è‰ºå“ä¸€æ ·ï¼Œè¯¥ä¼ æ„Ÿå™¨ä¹Ÿæ˜¯åŸºäºNordic Semic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>æ— çº¿ä¼ æ„Ÿå™¨ï¼Œç”¨äºæ‰“å¼€å’Œå…³é—­ï¼Œå…·æœ‰é«˜çº§åŠŸèƒ½</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490476/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘æ¬¢è¿Habrçš„æ‰€æœ‰è¯»è€…ï¼Œå°¤å…¶æ˜¯â€œ DIYæˆ–è‡ªå·±åŠ¨æ‰‹åšâ€éƒ¨åˆ†çš„è¯»è€…ï¼è€Œä¸”ï¼Œå¦‚æœæˆ‘æ— æ³•æå‡ºç±»ä¼¼çš„å»ºè®®ï¼Œé‚£æˆ‘å°±æ˜¯ä¸€åarduinoï¼Œæˆ‘å¯ä»¥...æˆ‘ä¸æ¶‰åŠç®¡ç†ç”µæ¢¯è½¿å¢çš„ä¸»è¦ä¸»é¢˜:)ã€‚ç»è¿‡ä¸€ç•ªæ€è€ƒï¼Œå‡ºäºæŸç§åŸå› ï¼Œæˆ‘æƒ³åˆ¶ä½œä¸€ä¸ªå¼€åˆä¼ æ„Ÿå™¨ã€‚å°±åƒæˆ‘æœ€è¿‘åšçš„å…¶ä»–æ‰‹å·¥è‰ºå“ä¸€æ ·ï¼Œè¯¥ä¼ æ„Ÿå™¨ä¹Ÿæ˜¯åŸºäºNordic Semiconductorçš„èŠ¯ç‰‡ã€‚ä¼ æ„Ÿå™¨å†³å®šé‡‡ç”¨ä¸¤ç§ç‰ˆæœ¬ï¼Œä¸€ç§åœ¨nRF52840èŠ¯ç‰‡ä¸Šï¼Œå¦ä¸€ç§åœ¨nRF52811èŠ¯ç‰‡ä¸Šã€‚</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zu/u9/48/zuu948wn8duosrmce4hvtao1une.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºç‰ˆæœ¬nRF52840èŠ¯ç‰‡æ¨¡å—ç”¨äºE73_2G4M08S1Cå…¬å¸</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EBYTE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä¸ºverciyaèŠ¯ç‰‡æ¨¡å—nRF52811 MC50SFAå…¬å¸</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MiNEW</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦ç™½åœ°è¯´ï¼Œå¯»æ‰¾ä»·æ ¼åˆç†çš„nRF52811èŠ¯ç‰‡ä»ç„¶æ˜¯ä¸€æ¬¡å†’é™©ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œç”±äºå™¨ä»¶çš„è¿™ç§å†’é™©æ€§ï¼ŒMINEWçš„nRF52811èŠ¯ç‰‡ä¸Šçš„æ¨¡å—ä»¥åŠç„Šæ¥åˆ°è¿™äº›æ¨¡å—çš„å‡ ç§ç‰ˆæœ¬çš„èŠ¯ç‰‡å½¢å¼çš„é¢åŒ…éƒ½æ˜¯nRF52810å’ŒnRF52832ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cn/yx/4l/cnyx4lcnu6q_isgpvrszxy7c9wy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥è®¾å¤‡çš„ä¸»è¦åŠŸèƒ½æ˜¯åŸºäºèˆŒç°§å¼€å…³æ£€æµ‹æ‰“å¼€å’Œå…³é—­ã€‚</font><font style="vertical-align: inherit;">èˆŒç°§å¼€å…³çš„ç”µè·¯é€šè¿‡é˜²è·³åŠ¨é‡æ–°å®šç›¸ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”µè·¯åŸç†å›¾ï¼š</font></font><br>
<img src="https://habrastorage.org/webt/o7/io/x-/o7iox-c4oobmvx6zldll_m1vowu.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduinoæ–¹æ¡ˆ:)</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/j4/au/cy/j4aucyctci1fdwtfdkbiz_exsyi.png"><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è€ƒè™‘è¿‡ä»€ä¹ˆåº”è¯¥é€‚å½“åœ°ç¨€é‡Šè¿™ç§å¼€åˆä¼ æ„Ÿå™¨çš„ä¸»è¦åŠŸèƒ½ï¼Œæˆ‘å†³å®šçœ‹çœ‹å¸‚åœºä¸Šæœ‰å…³æ­¤çš„å†…å®¹ã€‚ç”±äºå‡ ä¹æ²¡æœ‰ç»“æœï¼Œå› æ­¤æ‰“å¼€å’Œå…³é—­ä¼ æ„Ÿå™¨åœ¨éæ´²ä¹Ÿæ˜¯æ‰“å¼€å’Œå…³é—­ä¼ æ„Ÿå™¨ã€‚åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REDMOND</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°äº†æœ€â€œå…ˆè¿›â€çš„è§£å†³æ–¹æ¡ˆ</font><font style="vertical-align: inherit;">ã€‚åœ¨ä»–ä»¬çš„BLEä¼ æ„Ÿå™¨ä¸­ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œä¹Ÿæ˜¯åœ¨Nordicçš„ä¸€ä¸ªèŠ¯ç‰‡ä¸Šï¼‰ï¼Œé™¤äº†ç£ç°§å¼€å…³ä¹‹å¤–ï¼ŒTTP223èŠ¯ç‰‡ä¸Šè¿˜å®‰è£…äº†ä¸€ä¸ªæ¸©åº¦ä¼ æ„Ÿå™¨å’Œä¸€ä¸ªç”µå®¹å¼æŒ‰é’®ã€‚ä½†æ˜¯å‡ºäºæŸç§åŸå› ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸é€‚åˆç”¨äºé—¨æˆ–çª—é™„è¿‘çš„æ¸©åº¦è¯»æ•°ï¼ˆä»¥åŠé˜²æ­¢å…¶è¢«èŠ¯ç‰‡æµ‹é‡çš„åŸå› ï¼‰ä»¥åŠåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨æ‚¬æŒ‚åœ¨çª—æˆ–é—¨ä¸Šçš„ä¼ æ„Ÿå™¨ä¸Šçš„æŒ‰é’®ï¼ˆå—¯ï¼Œä¹Ÿè®¸é™¤äº†è¾“å…¥:)ï¼‰ã€‚ç»“æœï¼Œæˆ‘å†³å®šæ‰©å±•ä¼ æ„Ÿå™¨çš„å®‰å…¨åŠŸèƒ½ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/7v/y7/fn7vy79b2eivip0yber_90a_zew.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸»è¦çš„é€‰æ‹©æ ‡å‡†æ˜¯é™„åŠ ä¼ æ„Ÿå™¨çš„æ¶ˆè€—ï¼Œå› ä¸ºå·²å†³å®šåœ¨è¯¥ä¼ æ„Ÿå™¨ä¸­ä½¿ç”¨CR2032ç”µæ± ã€‚å€™é€‰äººä¸­çš„è·å¥–è€…æ˜¯ä¸¤ä¸ªä¼ æ„Ÿå™¨ï¼ŒLIS2DW12åŠ é€Ÿåº¦è®¡å’ŒDRV5032FBç£åœºä¼ æ„Ÿå™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LIS2DW12å½“å‰å¯èƒ½æ˜¯æœ€ç»æµçš„åŠ é€Ÿåº¦è®¡ã€‚åœ¨ä½åŠŸè€—æ¨¡å¼ä¸‹ï¼Œè¯¥åŠ é€Ÿåº¦è®¡çš„åŠŸè€—ä¸º1Î¼Aï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®è¡¨</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚ DRV5032FBç£åœºä¼ æ„Ÿå™¨è¿˜å…·æœ‰å‡ºè‰²çš„åŠŸè€—ç‰¹æ€§ã€‚å®ƒçš„åŠŸè€—çº¦ä¸º500nAï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®è¡¨</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŠ é€Ÿåº¦è®¡è¢«ç¡®å®šç”¨äºéœ‡åŠ¨ä¼ æ„Ÿå™¨æ¨¡å¼ï¼Œè€Œç£åœºä¼ æ„Ÿå™¨åˆ™ç”¨äºå…¶é¢„å®šç”¨é€”ã€‚å¦‚æœæˆ‘å¯¹éœ‡åŠ¨ä¼ æ„Ÿå™¨çš„åŠŸèƒ½æ„Ÿåˆ°å¹³é™ï¼Œé‚£ä¹ˆä½¿ç”¨ç£åœºä¼ æ„Ÿå™¨ä»ç„¶æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®ƒæ¯”æ¸©åº¦ä¼ æ„Ÿå™¨è¦å¥½ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/si/ni/64/sini6468k7gc4btzzjjwcaco8y8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥é¡¹ç›®çš„è½¯ä»¶éƒ¨åˆ†ä¸“é—¨ç”¨äºåœ¨Maysensorsç½‘ç»œä¸­æ“ä½œä¼ æ„Ÿå™¨ã€‚è‡³å°‘ç°åœ¨ï¼ˆæ˜¯ã€‚åœ¨è¾ƒä½çº§åˆ«çš„åŒ—æ¬§èŠ¯ç‰‡ï¼ˆnRF24ï¼ˆ+ atmega 328ï¼Œstm32f1ï¼‰ï¼ŒnRF51å’ŒnRF52ï¼‰ä¸Šå·¥ä½œçš„å˜ä½“ä¸­çš„Meisensorsä½¿ç”¨Nordicä¸“æœ‰åè®®-Enhanced ShockBurstï¼ˆESBï¼‰ï¼Œä»è€Œç¡®ä¿nRF24å’ŒnRF51-52ä¸Šè®¾å¤‡çš„å…¼å®¹æ€§ã€‚ Maysensorsæ˜¯ä¸€ä¸ªå¼€æ”¾çš„Arduinoé¡¹ç›®ï¼Œå›´ç»•è¿™ä¸ªé¡¹ç›®ï¼Œä¸–ç•Œä¸Šè®¸å¤šå›½å®¶å·²ç»å»ºç«‹äº†ä¸€ä¸ªç›¸å½“å¤§çš„ç¤¾åŒºã€‚ä½†æ˜¯ï¼Œåœ¨nRF52èŠ¯ç‰‡ä¸Šçš„è‰¯å¥½è§£å†³æ–¹æ¡ˆæ˜¯ä¸å¿…ä½¿ç”¨Maysensorsï¼ˆESBï¼‰ã€‚ç”±äºèŠ¯ç‰‡æ˜¯å¤šåè®®çš„ï¼Œå› æ­¤åªéœ€æ›¿æ¢åŸºäºZigbeeæˆ–BLEåè®®çš„è½¯ä»¶å°±è¶³å¤Ÿäº†ã€‚...å…³äºBLEï¼Œæˆ‘å°†ä»‹ç»ä¸€ä¸‹ï¼Œçœ‹çœ‹E73_2G4M08S1Cæ¨¡å—å¯ä»¥åˆ¶é€ å‡ºå¤šä¹ˆå‡ºè‰²çš„Arduino NANO 33 Bleï¼Œæˆ‘çš„NANO 33çš„ä»·æ ¼æ˜¯4ç¾å…ƒã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ot/8f/vh/ot8fvhkkqsnzw_vhcqy7rubbgg0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¼ æ„Ÿå™¨çš„è‰å›¾æ˜¯åœ¨Arduinoä¸­åˆ¶ä½œçš„.IDEä¸­ä½¿ç”¨äº†å…¶ä»–åº“çš„åŠ é€Ÿåº¦è®¡LIS2DW12çš„åº“ï¼Œåœ¨æˆ‘çš„å¯„å­˜å™¨é»˜è®¤è®¾ç½®ä¸­ï¼Œæˆ‘åšäº†ä¸€äº›æ”¹åŠ¨ï¼Œåœ¨æˆ‘çš„ç‰ˆæœ¬ä¸­ï¼Œå®ƒå¯ä»¥åœ¨æœ€ä½åŠŸè€—ç‰ˆæœ¬çš„è®¾ç½®ä¸‹ç«‹å³ä½¿ç”¨ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æˆ‘çš„gitä¸Šå¯ç”¨</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å°†æè¿°ç¨‹åºçš„é€»è¾‘ã€‚åœ¨ä¸»è¦æ“ä½œæ¨¡å¼ä¸‹ï¼Œä¼ æ„Ÿå™¨å¤„äºé…ç½®çŠ¶æ€ï¼Œåªæœ‰4ä¸ªä¸­æ–­å¤„äºç†æƒ³çŠ¶æ€ã€‚ä¸­æ–­æœ‰ä¸¤ç§é…ç½®ï¼› configsåœ¨ç¨‹åºæ“ä½œæœŸé—´æ ¹æ®ç°§ç‰‡å¼€å…³çš„çŠ¶æ€é‡æ–°é…ç½®ä¸­æ–­ã€‚å¦‚æœé—¨æ˜¯æ‰“å¼€çš„ï¼Œåˆ™éœ‡åŠ¨ä¼ æ„Ÿå™¨å’Œç£åœºä¼ æ„Ÿå™¨çš„ä¸­æ–­å°†è¢«ç¦ç”¨ã€‚é—¨ä¸€æ—¦å…³é—­ï¼Œå°±ä¼šæ¿€æ´»å…¶ä¸­ä¸¤ä¸ªä¼ æ„Ÿå™¨çš„ä¸­æ–­ã€‚æˆ‘è¿˜é‡åˆ°ä¸€ä¸ªäº‹å®ï¼Œå³åœ¨æ‰“å¼€è¿‡ç¨‹ä¸­ï¼Œæœ‰äº›æƒ…å†µæ˜¯åœ¨ç°§ç‰‡å¼€å…³ä¹‹å‰è§¦å‘äº†éœ‡åŠ¨ä¼ æ„Ÿå™¨ï¼Œè¿™æ˜¯ç”±äºæ‰“å¼€é”æ—¶çš„æŒ¯åŠ¨å¼•èµ·çš„ã€‚ä»…åœ¨é…ç½®äº†åŠ é€Ÿåº¦è®¡çš„é«˜çµæ•åº¦çš„æƒ…å†µä¸‹è®°å½•äº†æ­¤æ•…éšœã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æ¶ˆé™¤æ­¤é—®é¢˜ï¼ŒåŠ é€Ÿåº¦è®¡è¢«è§¦å‘æ—¶éœ€è¦ç­‰å¾…2ç§’é’Ÿï¼Œåœ¨æ­¤æœŸé—´ï¼Œå°†ç›‘æ§ç£ç°§å¼€å…³çš„å¼•è„šã€‚å¦‚æœåœ¨ç­‰å¾…æœŸé—´èˆŒç°§å¼€å…³çš„å¼•è„šä¸Šå‘ç”Ÿç”µå¹³å˜åŒ–ï¼Œåˆ™åœæ­¢é€šè¿‡åŠ é€Ÿåº¦è®¡ä¸­æ–­æ¥è¿›ä¸€æ­¥å¤„ç†äº‹ä»¶ï¼Œå¹¶å¼€å§‹å¤„ç†èˆŒç°§å¼€å…³ä¸­çš„äº‹ä»¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¼ æ„Ÿå™¨å…·æœ‰é…ç½®æ¨¡å¼ã€‚æŒ‰ä¸‹ç»´ä¿®æŒ‰é’®åï¼Œä¼ æ„Ÿå™¨å°†åœ¨ä¸­æ–­åå”¤é†’ï¼Œæ— çº¿ç”µæ¨¡å—è¿›å…¥ç›‘å¬æ¨¡å¼ï¼Œå¹¶ç­‰å¾…UDæ§åˆ¶å™¨çš„ä¼ å…¥å‘½ä»¤ã€‚å¦‚æœæ”¶åˆ°å‘½ä»¤ï¼Œåˆ™ä¼ æ„Ÿå™¨å°†æ–°å€¼å†™å…¥å†…å­˜ï¼Œå¹¶ç«‹å³è¿›å…¥ç¡çœ æ¨¡å¼ã€‚è¦å‘é€ä¸‹ä¸€æ¡å‘½ä»¤ï¼Œå¿…é¡»é‡å¤æ¿€æ´»é…ç½®æ¨¡å¼ã€‚å¦‚æœåœ¨é…ç½®æ¨¡å¼ä¸‹ä¼ æ„Ÿå™¨åœ¨30ç§’å†…æœªæ”¶åˆ°ä»»ä½•ä¿¡æ¯ï¼Œåˆ™åœ¨æ­¤æ—¶é—´ä¹‹åå®ƒä¹Ÿä¼šåˆ‡æ¢åˆ°æ“ä½œæ¨¡å¼å¹¶è¿›å…¥ç¡çœ çŠ¶æ€ã€‚é™¤äº†é…ç½®æ¨¡å¼å¤–ï¼Œè¿˜å¯ä»¥ä»æœåŠ¡æŒ‰é’®å¼€å§‹æ˜¾ç¤ºä¼ æ„Ÿå™¨ä¼ æ„Ÿå™¨å¹¶æ¢å¤å‡ºå‚è®¾ç½®ï¼ˆä¼ æ„Ÿå™¨ä¼šå¿˜è®°å·²æ·»åŠ ä¼ æ„Ÿå™¨çš„ç½‘ç»œï¼Œå¿…é¡»åœ¨é‡ç½®åå†æ¬¡è¿›è¡Œä¼ æ„Ÿå™¨çš„æ³¨å†Œï¼‰ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jn/1f/j3/jn1fj3ih6xil_iyk_c5abhzmg8q.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/u-/bt/gd/u-btgdierfsy0aqpvt2yhmimjic.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/gk/mr/ml/gkmrmlazpn6iwyxujq_82tk0ipc.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/do/en/m6/doenm6q7xz4ri8cxv57gipihkbq.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/er/x9/wu/erx9wumdn9jpozoie_o20c_kmqe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦åœ¨Arduino IDEä¸­å¯¹ä¼ æ„Ÿå™¨è¿›è¡Œç¼–ç¨‹ï¼Œæ‚¨éœ€è¦æ·»åŠ å¯¹ä»¥ä¸‹å¼€å‘æ¿çš„æ”¯æŒï¼š</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sandeepmistry / arduino-nRF5 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysensors / ArduinoBoards</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åº“ï¼š</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mysensor </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIS2DW12</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ç¼–ç¨‹å™¨ï¼šst-linkï¼Œj-linkã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç´ æç¨‹åº</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword">bool</span> configMode = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int8_t</span> int_status = <span class="hljs-number">0</span>;
<span class="hljs-keyword">bool</span> door_status = <span class="hljs-number">1</span>;
<span class="hljs-keyword">bool</span> check;
<span class="hljs-keyword">bool</span> magnet_status = <span class="hljs-number">1</span>;
<span class="hljs-keyword">bool</span> nosleep = <span class="hljs-number">0</span>;
<span class="hljs-keyword">bool</span> button_flag = <span class="hljs-number">0</span>;
<span class="hljs-keyword">bool</span> onoff = <span class="hljs-number">1</span>;
<span class="hljs-keyword">bool</span> flag_update_transport_param;
<span class="hljs-keyword">bool</span> flag_sendRoute_parent;
<span class="hljs-keyword">bool</span> flag_no_present;
<span class="hljs-keyword">bool</span> flag_nogateway_mode;
<span class="hljs-keyword">bool</span> flag_find_parent_process;
<span class="hljs-keyword">bool</span> flag_fcount;
<span class="hljs-keyword">bool</span> Ack_TL;
<span class="hljs-keyword">bool</span> Ack_FP;
<span class="hljs-keyword">bool</span> PRESENT_ACK;
<span class="hljs-keyword">bool</span> send_a;
<span class="hljs-keyword">bool</span> batt_flag;<font></font>
byte conf_vibro_set = <span class="hljs-number">2</span>;<font></font>
byte err_delivery_beat;<font></font>
byte problem_mode_count;<font></font>
<span class="hljs-keyword">uint8_t</span>  countbatt = <span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> batt_cap;
<span class="hljs-keyword">uint8_t</span> old_batt_cap = <span class="hljs-number">100</span>;
<span class="hljs-keyword">uint32_t</span> BATT_TIME;
<span class="hljs-keyword">uint32_t</span> SLEEP_TIME = <span class="hljs-number">10800000</span>;
<span class="hljs-keyword">uint32_t</span> SLEEP_NOGW = <span class="hljs-number">60000</span>;
<span class="hljs-keyword">uint32_t</span> oldmillis;
<span class="hljs-keyword">uint32_t</span> newmillis;
<span class="hljs-keyword">uint32_t</span> previousMillis;
<span class="hljs-keyword">uint32_t</span> lightMillisR;
<span class="hljs-keyword">uint32_t</span> configMillis;
<span class="hljs-keyword">uint32_t</span> interrupt_time;
<span class="hljs-keyword">uint32_t</span> SLEEP_TIME_W;
<span class="hljs-keyword">uint32_t</span> axel_time;
<span class="hljs-keyword">uint32_t</span> axel_time0;
<span class="hljs-keyword">int16_t</span> myid;
<span class="hljs-keyword">int16_t</span> mypar;
<span class="hljs-keyword">int16_t</span> old_mypar = <span class="hljs-number">-1</span>;
<span class="hljs-keyword">bool</span> vibro = <span class="hljs-number">1</span>;
<span class="hljs-keyword">uint32_t</span> PIN_BUTTON_MASK;
<span class="hljs-keyword">uint32_t</span> AXEL_INT_MASK;
<span class="hljs-keyword">uint32_t</span> GERKON_INT_MASK;
<span class="hljs-keyword">uint32_t</span> MAGNET_INT_MASK;
<span class="hljs-keyword">float</span> ODR_1Hz6_LP_ONLY = <span class="hljs-number">1.6f</span>;
<span class="hljs-keyword">float</span> ODR_12Hz5 = <span class="hljs-number">12.5f</span>;
<span class="hljs-keyword">float</span> ODR_25Hz = <span class="hljs-number">25.0f</span>;
<span class="hljs-keyword">float</span> ODR_50Hz = <span class="hljs-number">50.0f</span>;
<span class="hljs-keyword">float</span> ODR_100Hz = <span class="hljs-number">100.0f</span>;
<span class="hljs-keyword">float</span> ODR_200Hz = <span class="hljs-number">200.0f</span>;
<span class="hljs-keyword">volatile</span> byte axelIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> byte gerkIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> byte magIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> byte buttIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">uint16_t</span> batteryVoltage;
<span class="hljs-keyword">int16_t</span> linkQuality;
<span class="hljs-keyword">int16_t</span> old_linkQuality;<font></font>
<font></font>
<span class="hljs-comment">//#define MY_DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MY_DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_DISABLED_SERIAL</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_RADIO_NRF5_ESB</span>
<span class="hljs-keyword">int16_t</span> mtwr;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_TRANSPORT_WAIT_READY_MS (mtwr)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_NRF5_ESB_PA_LEVEL (NRF5_PA_MAX)</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;MySensors.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"app_gpiote.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"nrf_gpio.h"</span></span><font></font>
}<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> APP_GPIOTE_MAX_USERS 1</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">app_gpiote_user_id_t</span> m_gpiote_user_id;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;LIS2DW12Sensor.h&gt;</span></span><font></font>
LIS2DW12Sensor *lis2;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DWS_CHILD_ID 0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> V_SENS_CHILD_ID 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> M_CHILD_ID 2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LEVEL_SENSIV_V_SENS_CHILD_ID 230</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SIGNAL_Q_ID 250</span><font></font>
<font></font>
<span class="hljs-function">MyMessage <span class="hljs-title">dwsMsg</span><span class="hljs-params">(DWS_CHILD_ID, V_TRIPPED)</span></span>;
<span class="hljs-function">MyMessage <span class="hljs-title">mMsg</span><span class="hljs-params">(M_CHILD_ID, V_TRIPPED)</span></span>;
<span class="hljs-function">MyMessage <span class="hljs-title">vibroMsg</span><span class="hljs-params">(V_SENS_CHILD_ID, V_TRIPPED)</span></span>;
<span class="hljs-function">MyMessage <span class="hljs-title">conf_vsensMsg</span><span class="hljs-params">(LEVEL_SENSIV_V_SENS_CHILD_ID, V_VAR1)</span></span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SN <span class="hljs-meta-string">"DOOR &amp; WINDOW SENS"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SV <span class="hljs-meta-string">"1.12"</span></span><font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span> </span>{<font></font>
  board_Init();<font></font>
  happy_init();<font></font>
  delay(<span class="hljs-number">500</span>);<font></font>
  batteryVoltage = hwCPUVoltage();<font></font>
  digitalWrite(BLUE_LED, LOW);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">presentation</span><span class="hljs-params">()</span>
</span>{<font></font>
  NRF_POWER-&gt;DCDCEN = <span class="hljs-number">0</span>;<font></font>
  wait(<span class="hljs-number">10</span>);<font></font>
<font></font>
  check = sendSketchInfo(SN, SV);<font></font>
  wait(<span class="hljs-number">30</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">30</span>);<font></font>
    check = sendSketchInfo(SN, SV);<font></font>
    wait(<span class="hljs-number">30</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(DWS_CHILD_ID, S_DOOR, <span class="hljs-string">"STATUS RS SENS"</span>);<font></font>
  wait(<span class="hljs-number">40</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">40</span>);<font></font>
    check = present(DWS_CHILD_ID, S_DOOR, <span class="hljs-string">"STATUS RS SENS"</span>);<font></font>
    wait(<span class="hljs-number">40</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(V_SENS_CHILD_ID, S_VIBRATION, <span class="hljs-string">"STATUS SHOCK SENS"</span>);<font></font>
  wait(<span class="hljs-number">50</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
    check = present(V_SENS_CHILD_ID, S_VIBRATION, <span class="hljs-string">"STATUS SHOCK SENS"</span>);<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(M_CHILD_ID, S_DOOR, <span class="hljs-string">"ANTI-MAGNET ALARM"</span>);<font></font>
  wait(<span class="hljs-number">60</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">60</span>);<font></font>
    check = present(M_CHILD_ID, S_DOOR, <span class="hljs-string">"ANTI-MAGNET ALARM"</span>);<font></font>
    wait(<span class="hljs-number">60</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(SIGNAL_Q_ID, S_CUSTOM, <span class="hljs-string">"SIGNAL %"</span>);<font></font>
  wait(<span class="hljs-number">70</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">70</span>);<font></font>
    check = present(SIGNAL_Q_ID, S_CUSTOM, <span class="hljs-string">"SIGNAL %"</span>);<font></font>
    wait(<span class="hljs-number">70</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(LEVEL_SENSIV_V_SENS_CHILD_ID, S_CUSTOM, <span class="hljs-string">"SENS LEVEL VIBRO"</span>);<font></font>
  wait(<span class="hljs-number">80</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">80</span>);<font></font>
    check = present(LEVEL_SENSIV_V_SENS_CHILD_ID, S_CUSTOM, <span class="hljs-string">"SENS LEVEL VIBRO"</span>);<font></font>
    wait(<span class="hljs-number">80</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = send(conf_vsensMsg.<span class="hljs-built_in">set</span>(conf_vibro_set));<font></font>
  wait(<span class="hljs-number">90</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">90</span>);<font></font>
    check = send(conf_vsensMsg.<span class="hljs-built_in">set</span>(conf_vibro_set));<font></font>
    wait(<span class="hljs-number">90</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
  NRF_POWER-&gt;DCDCEN = <span class="hljs-number">0</span>;<font></font>
  wait(<span class="hljs-number">10</span>);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  digitalWrite(BLUE_LED, HIGH);<font></font>
  config_Happy_node();<font></font>
  sensors_Init();<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (flag_update_transport_param == <span class="hljs-number">1</span>) {<font></font>
    update_Happy_transport();<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (flag_sendRoute_parent == <span class="hljs-number">1</span>) {<font></font>
    present_only_parent();<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (isTransportReady() == <span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (flag_find_parent_process == <span class="hljs-number">1</span>) {<font></font>
        find_parent_process();<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (configMode == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> ((axelIntStatus == AXEL_INT) || (buttIntStatus == PIN_BUTTON) || (gerkIntStatus == GERKON_INT) || (magIntStatus == MAGNET_INT)) {<font></font>
          nosleep = <span class="hljs-number">1</span>;<font></font>
          newmillis = millis();<font></font>
          interrupt_time = newmillis - oldmillis;<font></font>
          BATT_TIME = BATT_TIME - interrupt_time;<font></font>
          <span class="hljs-keyword">if</span> (BATT_TIME &lt; <span class="hljs-number">60000</span>) {<font></font>
            BATT_TIME = SLEEP_TIME;<font></font>
            batteryVoltage = hwCPUVoltage();<font></font>
            batt_flag = <span class="hljs-number">1</span>;<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (gerkIntStatus == GERKON_INT) {<font></font>
            send_Gerkon();<font></font>
            axel_time = millis();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (magIntStatus == MAGNET_INT) {<font></font>
            send_Magnet();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (axelIntStatus == AXEL_INT) {
            <span class="hljs-keyword">if</span> (millis() - axel_time0 &gt;= <span class="hljs-number">2000</span>) {<font></font>
              send_Axel();<font></font>
              nosleep = <span class="hljs-number">0</span>;<font></font>
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (digitalRead(GERKON_INT) == LOW) {<font></font>
                send_Gerkon();<font></font>
                axel_time = millis();<font></font>
                nosleep = <span class="hljs-number">0</span>;<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (buttIntStatus == PIN_BUTTON) {
            <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">0</span>) {<font></font>
              button_flag = <span class="hljs-number">1</span>;<font></font>
              previousMillis = millis();<font></font>
              ledsOff();<font></font>
            }<font></font>
            <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">0</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">1750</span>)) {
                <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">70</span>) {<font></font>
                  lightMillisR = millis();<font></font>
                  onoff = !onoff;<font></font>
                  digitalWrite(BLUE_LED, onoff);<font></font>
                }<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) {<font></font>
                ledsOff();<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">3750</span>)) {
                <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">50</span>) {<font></font>
                  lightMillisR = millis();<font></font>
                  onoff = !onoff;<font></font>
                  digitalWrite(GREEN_LED, onoff);<font></font>
                }<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">3750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>)) {<font></font>
                ledsOff();<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">4000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">5750</span>)) {
                <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">30</span>) {<font></font>
                  lightMillisR = millis();<font></font>
                  onoff = !onoff;<font></font>
                  digitalWrite(RED_LED, onoff);<font></font>
                }<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> (millis() - previousMillis &gt; <span class="hljs-number">5750</span>) {<font></font>
                ledsOff();<font></font>
              }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">1</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &lt;= <span class="hljs-number">1750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                blinky(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, BLUE_LED);<font></font>
                button_flag = <span class="hljs-number">0</span>;<font></font>
                buttIntStatus = <span class="hljs-number">0</span>;<font></font>
                presentation();<font></font>
                nosleep = <span class="hljs-number">0</span>;<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">3750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                blinky(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, GREEN_LED);<font></font>
                configMode = <span class="hljs-number">1</span>;<font></font>
                button_flag = <span class="hljs-number">0</span>;<font></font>
                configMillis = millis();<font></font>
                interrupt_Init(<span class="hljs-number">1</span>);<font></font>
                NRF_POWER-&gt;DCDCEN = <span class="hljs-number">0</span>;<font></font>
                buttIntStatus = <span class="hljs-number">0</span>;<font></font>
                NRF5_ESB_startListening();<font></font>
                wait(<span class="hljs-number">50</span>);<font></font>
              }<font></font>
<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">4000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">5750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, RED_LED);
                <span class="hljs-comment">//new_device();</span><font></font>
              }<font></font>
<font></font>
              <span class="hljs-keyword">if</span> ((((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) || ((millis() - previousMillis &gt; <span class="hljs-number">3750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>)) || ((millis() - previousMillis &gt; <span class="hljs-number">5750</span>))) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                nosleep = <span class="hljs-number">0</span>;<font></font>
                button_flag = <span class="hljs-number">0</span>;<font></font>
                buttIntStatus = <span class="hljs-number">0</span>;<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
          batteryVoltage = hwCPUVoltage();<font></font>
          BATT_TIME = SLEEP_TIME;<font></font>
          sendBatteryStatus(<span class="hljs-number">1</span>);<font></font>
          nosleep = <span class="hljs-number">0</span>;<font></font>
        }<font></font>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (millis() - configMillis &gt; <span class="hljs-number">30000</span>) {<font></font>
          blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, GREEN_LED);<font></font>
          configMode = <span class="hljs-number">0</span>;<font></font>
          nosleep = <span class="hljs-number">0</span>;<font></font>
          interrupt_Init(<span class="hljs-number">0</span>);<font></font>
          NRF_POWER-&gt;DCDCEN = <span class="hljs-number">1</span>;<font></font>
          wait(<span class="hljs-number">50</span>);<font></font>
        }<font></font>
      }<font></font>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (buttIntStatus == PIN_BUTTON) {
        <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">0</span>) {<font></font>
          button_flag = <span class="hljs-number">1</span>;<font></font>
          nosleep = <span class="hljs-number">1</span>;<font></font>
          previousMillis = millis();<font></font>
          ledsOff();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">0</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">1750</span>)) {
            <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">25</span>) {<font></font>
              lightMillisR = millis();<font></font>
              onoff = !onoff;<font></font>
              digitalWrite(GREEN_LED, onoff);<font></font>
            }<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) {<font></font>
            ledsOff();<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>)) {
            <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">25</span>) {<font></font>
              lightMillisR = millis();<font></font>
              onoff = !onoff;<font></font>
              digitalWrite(RED_LED, onoff);<font></font>
            }<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> (millis() - previousMillis &gt; <span class="hljs-number">4000</span>) {<font></font>
            ledsOff();<font></font>
          }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">1</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &lt;= <span class="hljs-number">1750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
          {<font></font>
            ledsOff();<font></font>
            blinky(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, BLUE_LED);<font></font>
            button_flag = <span class="hljs-number">0</span>;<font></font>
            buttIntStatus = <span class="hljs-number">0</span>;<font></font>
            check_parent();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
          {<font></font>
            ledsOff();<font></font>
            blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, RED_LED);
            <span class="hljs-comment">//new_device();</span><font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> ((((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) || ((millis() - previousMillis &gt; <span class="hljs-number">4000</span>))) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
          {<font></font>
            ledsOff();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
            button_flag = <span class="hljs-number">0</span>;<font></font>
            buttIntStatus = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
        }<font></font>
      } <span class="hljs-keyword">else</span> {<font></font>
        check_parent();<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (_transportSM.failureCounter &gt; <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    _transportConfig.parentNodeId = loadState(<span class="hljs-number">101</span>);<font></font>
    _transportConfig.nodeId = myid;<font></font>
    _transportConfig.distanceGW = loadState(<span class="hljs-number">103</span>);<font></font>
    mypar = _transportConfig.parentNodeId;<font></font>
    nosleep = <span class="hljs-number">0</span>;<font></font>
    flag_fcount = <span class="hljs-number">1</span>;<font></font>
    err_delivery_beat = <span class="hljs-number">6</span>;<font></font>
    happy_node_mode();<font></font>
    gateway_fail();<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (nosleep == <span class="hljs-number">0</span>) {<font></font>
    oldmillis = millis();<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    buttIntStatus = <span class="hljs-number">0</span>;<font></font>
    gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
    magIntStatus = <span class="hljs-number">0</span>;<font></font>
    sleep(SLEEP_TIME_W, <span class="hljs-literal">false</span>);<font></font>
    nosleep = <span class="hljs-number">1</span>;<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">blinky</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> pulses, <span class="hljs-keyword">uint8_t</span> repit, <span class="hljs-keyword">uint8_t</span> ledColor)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>; x &lt; repit; x++) {
    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>) {<font></font>
      wait(<span class="hljs-number">150</span>);<font></font>
    }<font></font>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; pulses; i++) {
      <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) {<font></font>
        wait(<span class="hljs-number">40</span>);<font></font>
      }<font></font>
      digitalWrite(ledColor, LOW);<font></font>
      wait(<span class="hljs-number">10</span>);<font></font>
      digitalWrite(ledColor, HIGH);<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">board_Init</span><span class="hljs-params">()</span> </span>{<font></font>
  pinMode(PIN_BUTTON, INPUT_PULLUP);<font></font>
  pinMode(MAGNET_INT, INPUT);<font></font>
  pinMode(GERKON_INT, INPUT);<font></font>
  pinMode(AXEL_INT, INPUT);<font></font>
  pinMode(RED_LED, OUTPUT);<font></font>
  pinMode(GREEN_LED, OUTPUT);<font></font>
  pinMode(BLUE_LED, OUTPUT);<font></font>
  ledsOff();<font></font>
  NRF_POWER-&gt;DCDCEN = <span class="hljs-number">1</span>;<font></font>
  wait(<span class="hljs-number">5</span>);
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MY_DEBUG</span>
  NRF_UART0-&gt;ENABLE = <span class="hljs-number">0</span>;<font></font>
  wait(<span class="hljs-number">5</span>);
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
  <span class="hljs-comment">//NRF_NFCT-&gt;TASKS_DISABLE = 1;</span>
  <span class="hljs-comment">// NRF_NVMC-&gt;CONFIG = 1;</span>
  <span class="hljs-comment">// NRF_UICR-&gt;NFCPINS = 0;</span>
  <span class="hljs-comment">// NRF_NVMC-&gt;CONFIG = 0;</span>
  <span class="hljs-comment">// NRF_SAADC -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_PWM0  -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_PWM1  -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_PWM2  -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_TWIM1 -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_TWIS1 -&gt;ENABLE = 0;</span>
  NRF_RADIO-&gt;TXPOWER = <span class="hljs-number">8</span>;<font></font>
  wait(<span class="hljs-number">5</span>);<font></font>
<font></font>
  conf_vibro_set = loadState(<span class="hljs-number">230</span>);
  <span class="hljs-keyword">if</span> ((conf_vibro_set &gt; <span class="hljs-number">5</span>) || (conf_vibro_set == <span class="hljs-number">0</span>)) {<font></font>
    conf_vibro_set = <span class="hljs-number">2</span>;<font></font>
    saveState(<span class="hljs-number">230</span>, conf_vibro_set);<font></font>
  }<font></font>
<font></font>
  blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ledsOff</span><span class="hljs-params">()</span> </span>{<font></font>
  digitalWrite(RED_LED, HIGH);<font></font>
  digitalWrite(GREEN_LED, HIGH);<font></font>
  digitalWrite(BLUE_LED, HIGH);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">happy_init</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">//hwWriteConfig(EEPROM_NODE_ID_ADDRESS, 255); // ******************** checking the node config reset *************************</span><font></font>
<font></font>
  <span class="hljs-keyword">if</span> (hwReadConfig(EEPROM_NODE_ID_ADDRESS) == <span class="hljs-number">0</span>) {<font></font>
    hwWriteConfig(EEPROM_NODE_ID_ADDRESS, <span class="hljs-number">255</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (loadState(<span class="hljs-number">100</span>) == <span class="hljs-number">0</span>) {<font></font>
    saveState(<span class="hljs-number">100</span>, <span class="hljs-number">255</span>);<font></font>
  }<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"EEPROM NODE ID: %d\n"</span>), hwReadConfig(EEPROM_NODE_ID_ADDRESS));<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"USER MEMORY SECTOR NODE ID: %d\n"</span>), loadState(<span class="hljs-number">100</span>));<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (hwReadConfig(EEPROM_NODE_ID_ADDRESS) == <span class="hljs-number">255</span>) {<font></font>
    mtwr = <span class="hljs-number">0</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    mtwr = <span class="hljs-number">11000</span>;<font></font>
    no_present();<font></font>
  }<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MY_TRANSPORT_WAIT_MS: %d\n"</span>), mtwr);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">no_present</span><span class="hljs-params">()</span> </span>{<font></font>
  _coreConfig.presentationSent = <span class="hljs-literal">true</span>;<font></font>
  _coreConfig.nodeRegistered = <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">interrupt_Init</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> start)</span> </span>{
  <span class="hljs-comment">//***</span>
  <span class="hljs-comment">//SET</span>
  <span class="hljs-comment">//NRF_GPIO_PIN_NOPULL</span>
  <span class="hljs-comment">//NRF_GPIO_PIN_PULLUP</span>
  <span class="hljs-comment">//NRF_GPIO_PIN_PULLDOWN</span>
  <span class="hljs-comment">//***</span><font></font>
  nrf_gpio_cfg_input(PIN_BUTTON, NRF_GPIO_PIN_PULLUP);<font></font>
  nrf_gpio_cfg_input(AXEL_INT, NRF_GPIO_PIN_NOPULL);<font></font>
  nrf_gpio_cfg_input(GERKON_INT, NRF_GPIO_PIN_NOPULL);<font></font>
  nrf_gpio_cfg_input(MAGNET_INT, NRF_GPIO_PIN_NOPULL);<font></font>
  APP_GPIOTE_INIT(APP_GPIOTE_MAX_USERS);<font></font>
  PIN_BUTTON_MASK = <span class="hljs-number">1</span> &lt;&lt; PIN_BUTTON;<font></font>
  AXEL_INT_MASK = <span class="hljs-number">1</span> &lt;&lt; AXEL_INT;<font></font>
  GERKON_INT_MASK = <span class="hljs-number">1</span> &lt;&lt; GERKON_INT;<font></font>
  MAGNET_INT_MASK = <span class="hljs-number">1</span> &lt;&lt; MAGNET_INT;
  <span class="hljs-comment">//  app_gpiote_user_register(p_user_id, pins_low_to_high_mask, pins_high_to_low_mask, event_handler)</span>
  <span class="hljs-keyword">if</span> (start == <span class="hljs-number">0</span>) {<font></font>
    app_gpiote_user_register(&amp;m_gpiote_user_id, AXEL_INT_MASK | GERKON_INT_MASK, GERKON_INT_MASK | MAGNET_INT_MASK | PIN_BUTTON_MASK, gpiote_event_handler);<font></font>
    wait(<span class="hljs-number">5</span>);<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (start == <span class="hljs-number">1</span>) {<font></font>
    app_gpiote_user_register(&amp;m_gpiote_user_id, GERKON_INT_MASK, GERKON_INT_MASK | MAGNET_INT_MASK | PIN_BUTTON_MASK, gpiote_event_handler);<font></font>
    wait(<span class="hljs-number">5</span>);<font></font>
  }<font></font>
  app_gpiote_user_enable(m_gpiote_user_id);<font></font>
  wait(<span class="hljs-number">5</span>);<font></font>
  axelIntStatus = <span class="hljs-number">0</span>;<font></font>
  buttIntStatus = <span class="hljs-number">0</span>;<font></font>
  gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
  magIntStatus = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gpiote_event_handler</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> event_pins_low_to_high, <span class="hljs-keyword">uint32_t</span> event_pins_high_to_low)</span>
</span>{<font></font>
  MY_HW_RTC-&gt;CC[<span class="hljs-number">0</span>] = (MY_HW_RTC-&gt;COUNTER + <span class="hljs-number">2</span>); <span class="hljs-comment">// Taken from d0016 example code, ends the sleep delay</span><font></font>
<font></font>
  <span class="hljs-keyword">if</span> (PIN_BUTTON_MASK &amp; event_pins_high_to_low) {
    <span class="hljs-keyword">if</span> ((buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>)) {<font></font>
      buttIntStatus = PIN_BUTTON;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (AXEL_INT_MASK &amp; event_pins_low_to_high) {
      <span class="hljs-keyword">if</span> ((axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (door_status == <span class="hljs-number">1</span>)) {<font></font>
        axelIntStatus = AXEL_INT;<font></font>
        axel_time0 = millis();<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> ((GERKON_INT_MASK &amp; event_pins_low_to_high) || (GERKON_INT_MASK &amp; event_pins_high_to_low)) {
      <span class="hljs-keyword">if</span> ((axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>)) {<font></font>
        gerkIntStatus = GERKON_INT;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (MAGNET_INT_MASK &amp; event_pins_high_to_low) {
      <span class="hljs-keyword">if</span> ((axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (door_status == <span class="hljs-number">1</span>)) {<font></font>
        magIntStatus = MAGNET_INT;<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sensors_Init</span><span class="hljs-params">()</span> </span>{<font></font>
  Wire.begin();<font></font>
  wait(<span class="hljs-number">100</span>);<font></font>
  lis2 = <span class="hljs-keyword">new</span> LIS2DW12Sensor (&amp;Wire);<font></font>
  vibro_Init();<font></font>
  <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (digitalRead(GERKON_INT) == HIGH) {<font></font>
      door_status = <span class="hljs-number">1</span>;<font></font>
      interrupt_Init(<span class="hljs-number">0</span>);<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      door_status = <span class="hljs-number">0</span>;<font></font>
      interrupt_Init(<span class="hljs-number">1</span>);<font></font>
    }<font></font>
    send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
<font></font>
    SLEEP_TIME_W = SLEEP_TIME;<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    buttIntStatus = <span class="hljs-number">0</span>;<font></font>
    gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
    magIntStatus = <span class="hljs-number">0</span>;<font></font>
    sendBatteryStatus(<span class="hljs-number">0</span>);<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
    axel_time = millis();<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    interrupt_Init(<span class="hljs-number">0</span>);<font></font>
    blinky(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, RED_LED);<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">config_Happy_node</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (mtwr == <span class="hljs-number">0</span>) {<font></font>
    myid = getNodeId();<font></font>
    saveState(<span class="hljs-number">100</span>, myid);<font></font>
    mypar = _transportConfig.parentNodeId;<font></font>
    old_mypar = mypar;<font></font>
    saveState(<span class="hljs-number">101</span>, mypar);<font></font>
    saveState(<span class="hljs-number">102</span>, _transportConfig.distanceGW);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (mtwr != <span class="hljs-number">0</span>) {<font></font>
    myid = getNodeId();<font></font>
    <span class="hljs-keyword">if</span> (myid != loadState(<span class="hljs-number">100</span>)) {<font></font>
      saveState(<span class="hljs-number">100</span>, myid);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isTransportReady() == <span class="hljs-literal">true</span>) {<font></font>
      mypar = _transportConfig.parentNodeId;<font></font>
      <span class="hljs-keyword">if</span> (mypar != loadState(<span class="hljs-number">101</span>)) {<font></font>
        saveState(<span class="hljs-number">101</span>, mypar);<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (_transportConfig.distanceGW != loadState(<span class="hljs-number">102</span>)) {<font></font>
        saveState(<span class="hljs-number">102</span>, _transportConfig.distanceGW);<font></font>
      }<font></font>
      present_only_parent();<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isTransportReady() == <span class="hljs-literal">false</span>)<font></font>
    {<font></font>
      no_present();<font></font>
      flag_fcount = <span class="hljs-number">1</span>;<font></font>
      err_delivery_beat = <span class="hljs-number">6</span>;<font></font>
      _transportConfig.nodeId = myid;<font></font>
      _transportConfig.parentNodeId = loadState(<span class="hljs-number">101</span>);<font></font>
      _transportConfig.distanceGW = loadState(<span class="hljs-number">102</span>);<font></font>
      mypar = _transportConfig.parentNodeId;<font></font>
      happy_node_mode();<font></font>
      gateway_fail();<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">send_Axel</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (millis() - axel_time &gt;= <span class="hljs-number">5000</span>) {<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
<font></font>
    send_a = send(vibroMsg.<span class="hljs-built_in">set</span>(vibro));<font></font>
    wait(<span class="hljs-number">50</span>);
    <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
      send_a = send(vibroMsg.<span class="hljs-built_in">set</span>(vibro));<font></font>
      wait(<span class="hljs-number">100</span>);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">true</span>) {<font></font>
      err_delivery_beat = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">1</span>) {<font></font>
        flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: NORMAL GATEWAY MODE\n"</span>));<font></font>
        err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
      }<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (err_delivery_beat &lt; <span class="hljs-number">6</span>) {<font></font>
        err_delivery_beat++;<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (err_delivery_beat == <span class="hljs-number">5</span>) {
        <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {<font></font>
          gateway_fail();<font></font>
          CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: LOST GATEWAY MODE\n"</span>));<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
    axel_time = millis();<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    nosleep = <span class="hljs-number">0</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    nosleep = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">send_Gerkon</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (digitalRead(GERKON_INT) == HIGH) {<font></font>
    door_status = <span class="hljs-number">1</span>;<font></font>
    interrupt_Init(<span class="hljs-number">0</span>);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    door_status = <span class="hljs-number">0</span>;<font></font>
    interrupt_Init(<span class="hljs-number">1</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (door_status == <span class="hljs-number">1</span>) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
  send_a = send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
  wait(<span class="hljs-number">50</span>);
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
    send_a = send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
    wait(<span class="hljs-number">100</span>);
    <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
      send_a = send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
      wait(<span class="hljs-number">150</span>);<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">true</span>) {<font></font>
    err_delivery_beat = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">1</span>) {<font></font>
      flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
      CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: NORMAL GATEWAY MODE\n"</span>));<font></font>
      err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (err_delivery_beat &lt; <span class="hljs-number">6</span>) {<font></font>
      err_delivery_beat++;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (err_delivery_beat == <span class="hljs-number">5</span>) {
      <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {<font></font>
        gateway_fail();<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: LOST GATEWAY MODE\n"</span>));<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">send_Magnet</span><span class="hljs-params">()</span> </span>{<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  send_a = send(mMsg.<span class="hljs-built_in">set</span>(magnet_status));<font></font>
  wait(<span class="hljs-number">50</span>);
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
    send_a = send(mMsg.<span class="hljs-built_in">set</span>(magnet_status));<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">true</span>) {<font></font>
    err_delivery_beat = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">1</span>) {<font></font>
      flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
      CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: NORMAL GATEWAY MODE\n"</span>));<font></font>
      err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (err_delivery_beat &lt; <span class="hljs-number">6</span>) {<font></font>
      err_delivery_beat++;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (err_delivery_beat == <span class="hljs-number">5</span>) {
      <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {<font></font>
        gateway_fail();<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: LOST GATEWAY MODE\n"</span>));<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  magIntStatus = <span class="hljs-number">0</span>;<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">new_device</span><span class="hljs-params">()</span> </span>{<font></font>
  hwWriteConfig(EEPROM_NODE_ID_ADDRESS, <span class="hljs-number">255</span>);<font></font>
  saveState(<span class="hljs-number">100</span>, <span class="hljs-number">255</span>);<font></font>
  wdt_enable(WDTO_15MS);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update_Happy_transport</span><span class="hljs-params">()</span> </span>{<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: UPDATE TRANSPORT CONFIGURATION\n"</span>));<font></font>
  mypar = _transportConfig.parentNodeId;<font></font>
  <span class="hljs-keyword">if</span> (mypar != loadState(<span class="hljs-number">101</span>))<font></font>
  {<font></font>
    saveState(<span class="hljs-number">101</span>, mypar);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (_transportConfig.distanceGW != loadState(<span class="hljs-number">102</span>))<font></font>
  {<font></font>
    saveState(<span class="hljs-number">102</span>, _transportConfig.distanceGW);<font></font>
  }<font></font>
  present_only_parent();<font></font>
  wait(<span class="hljs-number">50</span>);<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
  flag_update_transport_param = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">present_only_parent</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (old_mypar != mypar) {<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: SEND LITTLE PRESENT:) WITH PARENT ID\n"</span>));
    <span class="hljs-keyword">if</span> (_sendRoute(build(_msgTmp, <span class="hljs-number">0</span>, NODE_SENSOR_ID, C_INTERNAL, <span class="hljs-number">6</span>).<span class="hljs-built_in">set</span>(mypar))) {<font></font>
      flag_sendRoute_parent = <span class="hljs-number">0</span>;<font></font>
      old_mypar = mypar;<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      flag_sendRoute_parent = <span class="hljs-number">1</span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">happy_node_mode</span><span class="hljs-params">()</span> </span>{<font></font>
  _transportSM.findingParentNode = <span class="hljs-literal">false</span>;<font></font>
  _transportSM.transportActive = <span class="hljs-literal">true</span>;<font></font>
  _transportSM.uplinkOk = <span class="hljs-literal">true</span>;<font></font>
  _transportSM.pingActive = <span class="hljs-literal">false</span>;<font></font>
  _transportSM.failureCounter = <span class="hljs-number">0</span>;<font></font>
  _transportSM.uplinkOk = <span class="hljs-literal">true</span>;<font></font>
  _transportSM.failureCounter = <span class="hljs-number">0u</span>;<font></font>
  _transportSM.failedUplinkTransmissions = <span class="hljs-number">0u</span>;<font></font>
  transportSwitchSM(stReady);<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"TRANSPORT: %d\n"</span>), isTransportReady());<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gateway_fail</span><span class="hljs-params">()</span> </span>{<font></font>
  flag_nogateway_mode = <span class="hljs-number">1</span>;<font></font>
  flag_update_transport_param = <span class="hljs-number">0</span>;<font></font>
  SLEEP_TIME_W = SLEEP_NOGW;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">check_parent</span><span class="hljs-params">()</span> </span>{<font></font>
  _transportSM.findingParentNode = <span class="hljs-literal">true</span>;<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: SEND FIND PARENT REQUEST, WAIT RESPONSE\n"</span>));<font></font>
  _sendRoute(build(_msg, <span class="hljs-number">255</span>, NODE_SENSOR_ID, C_INTERNAL, <span class="hljs-number">7</span>).<span class="hljs-built_in">set</span>(<span class="hljs-string">""</span>));<font></font>
  wait(<span class="hljs-number">1500</span>, C_INTERNAL, <span class="hljs-number">8</span>);
  <span class="hljs-keyword">if</span> (_msg.sensor == <span class="hljs-number">255</span>) {
    <span class="hljs-keyword">if</span> (mGetCommand(_msg) == <span class="hljs-number">3</span>) {
      <span class="hljs-keyword">if</span> (_msg.type == <span class="hljs-number">8</span>) {<font></font>
        Ack_FP = <span class="hljs-number">1</span>;<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: PARENT RESPONSE FOUND\n"</span>));<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (Ack_FP == <span class="hljs-number">1</span>) {<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: FIND PARENT PROCESS\n"</span>));<font></font>
    Ack_FP = <span class="hljs-number">0</span>;<font></font>
    transportSwitchSM(stParent);<font></font>
    flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
    flag_find_parent_process = <span class="hljs-number">1</span>;<font></font>
    problem_mode_count = <span class="hljs-number">0</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    _transportSM.findingParentNode = <span class="hljs-literal">false</span>;<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: PARENT RESPONSE NOT FOUND\n"</span>));<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"TRANSPORT: %d\n"</span>), isTransportReady());<font></font>
    nosleep = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (problem_mode_count &lt; <span class="hljs-number">9</span>) {<font></font>
      CORE_DEBUG(PSTR(<span class="hljs-string">"PROBLEM MODE COUNTER: %d\n"</span>), problem_mode_count);<font></font>
      problem_mode_count++;<font></font>
      SLEEP_TIME_W = SLEEP_TIME_W + SLEEP_TIME_W;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">find_parent_process</span><span class="hljs-params">()</span> </span>{<font></font>
  flag_update_transport_param = <span class="hljs-number">1</span>;<font></font>
  flag_find_parent_process = <span class="hljs-number">0</span>;<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: STANDART TRANSPORT MODE IS RESTORED\n"</span>));<font></font>
  err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
  SLEEP_TIME_W = SLEEP_TIME;<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sendBatteryStatus</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> start)</span> </span>{<font></font>
  batt_cap = battery_level_in_percent(batteryVoltage);<font></font>
  <span class="hljs-keyword">if</span> (start == <span class="hljs-number">1</span>) {
    <span class="hljs-comment">//if (batt_cap &lt; old_batt_cap) {</span>
    sendBatteryLevel(battery_level_in_percent(batteryVoltage), <span class="hljs-number">1</span>);<font></font>
    wait(<span class="hljs-number">1500</span>, C_INTERNAL, I_BATTERY_LEVEL);<font></font>
    old_batt_cap = batt_cap;<font></font>
    <span class="hljs-comment">// }</span>
  } <span class="hljs-keyword">else</span> {<font></font>
    sendBatteryLevel(battery_level_in_percent(batteryVoltage), <span class="hljs-number">1</span>);<font></font>
    wait(<span class="hljs-number">1500</span>, C_INTERNAL, I_BATTERY_LEVEL);<font></font>
  }<font></font>
<font></font>
  linkQuality = calculationRxQuality();<font></font>
  <span class="hljs-keyword">if</span> (linkQuality != old_linkQuality) {<font></font>
    wait(<span class="hljs-number">10</span>);<font></font>
    sendSignalStrength(linkQuality);<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
    old_linkQuality = linkQuality;<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">sendSignalStrength</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int16_t</span> level, <span class="hljs-keyword">const</span> <span class="hljs-keyword">bool</span> ack)</span>
</span>{
  <span class="hljs-keyword">return</span> _sendRoute(build(_msgTmp, GATEWAY_ADDRESS, SIGNAL_Q_ID, C_SET, V_VAR1,<font></font>
                          ack).<span class="hljs-built_in">set</span>(level));<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">int16_t</span> <span class="hljs-title">calculationRxQuality</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">int16_t</span> nRFRSSI_temp = transportGetReceivingRSSI();
  <span class="hljs-keyword">int16_t</span> nRFRSSI = <span class="hljs-built_in">map</span>(nRFRSSI_temp, <span class="hljs-number">-85</span>, <span class="hljs-number">-40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>);
  <span class="hljs-keyword">if</span> (nRFRSSI &lt; <span class="hljs-number">0</span>) {<font></font>
    nRFRSSI = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (nRFRSSI &gt; <span class="hljs-number">100</span>) {<font></font>
    nRFRSSI = <span class="hljs-number">100</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> nRFRSSI;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">receive</span><span class="hljs-params">(<span class="hljs-keyword">const</span> MyMessage &amp; message)</span>
</span>{
  <span class="hljs-keyword">if</span> (message.sensor == LEVEL_SENSIV_V_SENS_CHILD_ID) {
    <span class="hljs-keyword">if</span> (message.type == V_VAR1) {<font></font>
      conf_vibro_set = message.getByte();<font></font>
      vibro_Init();<font></font>
      saveState(<span class="hljs-number">230</span>, conf_vibro_set);<font></font>
      wait(<span class="hljs-number">200</span>);<font></font>
      send(conf_vsensMsg.<span class="hljs-built_in">set</span>(conf_vibro_set));<font></font>
      wait(<span class="hljs-number">200</span>);<font></font>
      blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, GREEN_LED);<font></font>
      configMode = <span class="hljs-number">0</span>;<font></font>
      nosleep = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vibro_Init</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">1</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_1Hz6_LP_ONLY;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">2</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_12Hz5;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">3</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_25Hz;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">4</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_100Hz;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">5</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_200Hz;<font></font>
  }<font></font>
  lis2-&gt;Enable_X();<font></font>
  wait(<span class="hljs-number">100</span>);<font></font>
  lis2-&gt;Enable_Wake_Up_Detection();<font></font>
  wait(<span class="hljs-number">100</span>);<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">git</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ä¸Šæä¾›äº†é¡¹ç›®æ–‡ä»¶çš„å®Œæ•´åˆ—è¡¨</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½œä¸ºUDç³»ç»Ÿï¼Œæˆ‘å·²ç»ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Majordomo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾ˆé•¿æ—¶é—´äº†</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†æè¿°ä¸€ä¸ªä¼ æ„Ÿå™¨å¦‚ä½•é€šè¿‡UDæ§åˆ¶å™¨åœ¨Maysensorsç½‘ç»œä¸­å·¥ä½œçš„ç¤ºä¾‹ã€‚</font><font style="vertical-align: inherit;">åœ¨æ­¤å®æ–½ä¾‹ä¸­ï¼Œæ¥è‡ªä¼ æ„Ÿå™¨çš„æ•°æ®é€šè¿‡Maysensorsç½‘å…³å‘é€åˆ°UDç³»ç»Ÿã€‚</font><font style="vertical-align: inherit;">Majordomo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å•ç‹¬çš„æ¨¡å—ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ç°äº†å¯¹Mysensorsåè®®çš„æ”¯æŒ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">UDç³»ç»Ÿçš„é™„åŠ ç»„ä»¶å¸‚åœºçš„â€œè®¾å¤‡â€éƒ¨åˆ†ä¸­æä¾›äº†ç”¨äºä¸‹è½½å’Œå®‰è£…çš„æ¨¡å—ã€‚</font></font><br>
<img src="https://habrastorage.org/webt/22/ho/ia/22hoiaoqgc-wbzualelk3bhxks8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç›®å‰ï¼ŒMajordomo UDçš„å®æ–½æ˜¯æœ€å®Œæ•´çš„ï¼Œå—æ”¯æŒçš„ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰Mesensorsæ•°æ®ç±»å‹ï¼Œ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸OTAåˆä½œï¼Œ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ä¸€ä¸ªæ¨¡å—ï¼ˆå¤šé—¨ï¼‰ä¸­ä¸€æ¬¡å¤„ç†å¤šä¸ªç½‘ç»œï¼Œ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SmartSleepè®¾å¤‡æ”¯æŒï¼Œ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¨¡å—å¯åŠ¨æ—¶å‘ç½‘ç»œä¸­çš„ä¼ æ„Ÿå™¨è¯·æ±‚æ•°æ®ï¼Œ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¶ˆæ¯ä¼ é€’ç¡®è®¤è¯·æ±‚ï¼Œ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ”¯æŒæœåŠ¡è¯·æ±‚ï¼Œä¾‹å¦‚æ•°æ®æ”¶é›†ï¼Œå¿ƒè·³ï¼Œæ¼”ç¤ºï¼Œé‡å¯ï¼Œ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸NodeManagerä¸€èµ·å·¥ä½œ</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“ç„¶ï¼Œåœ¨ç³»ç»Ÿè‡ªç„¶å‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨ä¸€äº›ç¼ºé™·ï¼Œå³ä»¥å‰æ·»åŠ çš„å¯¹ä¸²è¡Œç½‘å…³çš„æ”¯æŒï¼ŒMajordomoè®¢è´­çš„ä½¿ç”¨å¯¿å‘½å¾ˆé•¿ï¼Œç›®å‰ä¸å—æ”¯æŒã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»€è‡³æ²¡æœ‰æœºä¼šåœ¨Majordomoä¸­æµ‹è¯•è¿™ç§ç±»å‹çš„é—¨ï¼Œå› ä¸ºåœ¨æˆ‘å‘ç°Mysensorsä¹‹å‰ï¼Œè¯¥åŠŸèƒ½å°±ä¸å¯ç”¨äº†ã€‚</font><font style="vertical-align: inherit;">æ¨¡å—å¼€å‘äººå‘˜æ‰¿è¯ºå°†åœ¨2019å¹´9æœˆä¹‹å‰å†æ¬¡æ·»åŠ æ­¤åŠŸèƒ½ï¼Œä½†æ˜¯19æœˆçš„ç§‹å¤©å·²ç»è¿‡å»äº†ï¼Œå¹¶ä¸”ä»ç„¶ä¸æ”¯æŒè¯¥ç³»åˆ—ç½‘å…³:(ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨ä¹Ÿå¯ä»¥å°†Mysensors mqttç½‘å…³ä¸Majordomoä¸€èµ·ä½¿ç”¨ï¼Œä½†ä¸èƒ½é€šè¿‡Mysensorsæ¨¡å—ï¼Œè€Œæ˜¯é€šè¿‡MQTTæ¨¡å—ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æˆ‘çš„ä¼ æ„Ÿå™¨ä¸­ï¼Œéœ‡åŠ¨ä¼ æ„Ÿå™¨å’Œç£åœºä¼ æ„Ÿå™¨ä»…åœ¨è§¦å‘æ—¶æ‰ä¼ è¾“ä¸€ä¸ªå•å…ƒï¼Œäº‹å®è¯æ˜è¿™æ˜¯ä¸€ä¸ªå°é—®é¢˜ã€‚ â€œç®€å•è®¾å¤‡â€æ¨¡å—ä¸æ”¯æŒè¿™äº›ç±»å‹çš„ä¼ æ„Ÿå™¨ï¼Œå½“ç„¶æœ‰ä¸€ä¸ªé€šç”¨çš„ä¼ æ„Ÿå™¨ï¼Œä½†æ˜¯å…¶è‡ªå®šä¹‰è®¾ç½®éå¸¸æœ‰é™ã€‚æ·»åŠ ä¼ æ„Ÿå™¨æ—¶ï¼Œä¸€ä¸ªä¸èˆ’æœçš„é—®é¢˜æ˜¯ï¼Œå½“ä¸‹ä¸€ä¸ªå•å…ƒæ¥è‡ªä¼ æ„Ÿå™¨æ—¶ï¼Œæˆ‘å¿…é¡»å¯åŠ¨ä¸€ä¸ªåå‘è®¡æ—¶å™¨ï¼Œä»¥ä¾¿åœ¨è®¡æ—¶å™¨æŒ‡å®šçš„æ—¶é—´é—´éš”åï¼Œå°†é›¶å†™å…¥å¯¹è±¡å±æ€§ã€‚ä½†æ˜¯ï¼Œç”±äºä¸€åˆ‡éƒ½é€šè¿‡â€œçŠ¶æ€æ›´æ–°â€æ–¹æ³•å·¥ä½œï¼Œç„¶åå†™å…¥é›¶ï¼Œå› æ­¤æ¥æ”¶æ–°çŠ¶æ€çš„meysensorsæ¨¡å—å°†åŒ…å«æ­¤æ•°æ®çš„æ¶ˆæ¯å‘é€åˆ°ç½‘ç»œï¼Œå¹¶å‘é€åˆ°æˆ‘çš„è®¾å¤‡ï¼Œè¯¥ç‚¹ä¸ºé›¶ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œæœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯æ·»åŠ ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†è½¬ç§»ä»property1åˆ°property2çš„çŠ¶æ€ï¼Œå¹¶å¯åŠ¨ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œå°†é›¶å†™å…¥property2ã€‚åœ¨ç®€å•è®¾å¤‡ä¸­åˆ›å»ºçš„å¯¹è±¡å°†ä¸property2ä¸€èµ·ä½¿ç”¨ï¼Œåœ¨Maysensorsæ¨¡å—ä¸­å°†ä¸property1ä¸€èµ·ä½¿ç”¨ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ne/n0/ui/nen0uibfj0kw4wuupvbxr9z7zoo.png"><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;getProperty(<span class="hljs-string">'value2'</span>) == <span class="hljs-string">'1'</span>){
<span class="hljs-keyword">$this</span>-&gt;setProperty(<span class="hljs-string">'status'</span>,<span class="hljs-string">'1'</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œåœ¨æ‰€éœ€å¯¹è±¡çš„çŠ¶æ€æ›´æ–°æ–¹æ³•ä¸­ï¼Œæ‚¨éœ€è¦æ·»åŠ ä¸€ä¸ªè®¡æ—¶å™¨å¯åŠ¨ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">if</span> (gg(<span class="hljs-string">"MysensorsSmoke03.status"</span>) == <span class="hljs-string">"1"</span>) {<font></font>
SetTimeOut(<span class="hljs-string">'AlarmShock'</span>,<span class="hljs-string">'sg("MysensorsSmoke03.status","0");'</span>,<span class="hljs-number">10</span>);<font></font>
}<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨Majordomoç³»ç»Ÿå’ŒMajordroidåº”ç”¨ç¨‹åº</font><b><font style="vertical-align: inherit;">ä¸­å…·æœ‰ä¼ æ„Ÿå™¨æ“ä½œçš„è§†é¢‘</font></b><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘å»ºè®®æ‚¨å°½å¯èƒ½åœ°çœ‹ä¸€ä¸‹å®ƒï¼Œä»¥æ˜¾ç¤ºä¸»è¦åŠŸèƒ½çš„æ“ä½œï¼Œå½“ç„¶ï¼Œå¯¹äºæˆ‘çš„å°å®¶åº­é¢‘é“è€Œè¨€ï¼Œæ‚¨çš„å–œæ¬¢å’Œè®¢é˜…ç‰¹åˆ«å®è´µï¼Œä½†æ˜¯å•å‡»é“ƒé“›ï¼Œæ‚¨å°†ä¸ä¼šé”™è¿‡å¸¦æœ‰æ–°ä¼ æ„Ÿå™¨çš„è§†é¢‘;ï¼‰ã€‚</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OmclWv2vLog" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®¾å¤‡æ¿æ˜¯ä½¿ç”¨DeepTraceç¨‹åºåˆ¶æˆçš„ã€‚</font><font style="vertical-align: inherit;">è¿™æ¬¾ç”¨äºç”µå­äº§å“å¼€å‘çš„ç¼–è¾‘å™¨çš„å¼€å‘æ›¾ç»ä½¿æˆ‘æå¤§åœ°æ‰©å±•äº†è‡ªå·±çš„èƒ½åŠ›ã€‚</font><font style="vertical-align: inherit;">æˆ‘æ³¨æ„åˆ°æˆ‘ä¸æ˜¯ä¸“ä¸šçš„ç”µå­å·¥ç¨‹å¸ˆï¼Œæˆ‘åœ¨ä¸»æ¿å®¶åº­å¼€å‘æ–¹é¢çš„ç»éªŒä¸ºä¸€å¹´åŠæˆ–ä¸¤å¹´ã€‚</font><font style="vertical-align: inherit;">å¯¹äºå»ºè®®åœ¨é¢åŒ…æ¿ä¸Šåˆ¶ä½œè®¾å¤‡çš„æ¯ä¸ªäººï¼Œæˆ‘å»ºè®®å°è¯•å­¦ä¹ æŸç§ç¼–è¾‘å™¨ï¼ŒYouTubeä¸Šæœ‰å¾ˆå¤šè§†é¢‘æ‰‹å†Œã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qh/qn/oc/qhqnocyny82yvitjx84lso-irzo.png"><br>
<br>
<img src="https://habrastorage.org/webt/dw/vi/ez/dwviez3dctkm_yuxfawnlto9lrm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maysensorså¯¹nRF5èŠ¯ç‰‡çš„æ”¯æŒåŸºäºSandeep Mistryåº“-arduino-nRF5ã€‚ä½†æ˜¯ï¼Œè¯¥åº“ç¼ºå°‘å¯¹nRF52840ï¼ŒnRF52810èŠ¯ç‰‡å’Œå…¨æ–°nRF52811èŠ¯ç‰‡çš„æ”¯æŒã€‚æˆ‘ä¸å¾—ä¸å¢åŠ å¯¹è¿™äº›èŠ¯ç‰‡çš„æ”¯æŒï¼ŒNordic SDKè¿›è¡Œäº†ç§»æ¤å’Œæ”¹ç¼–ã€‚ç”±äºä¸éœ€è¦ä½¿ç”¨Mysensorsï¼Œå› æ­¤ä¸æ”¯æŒè½¯è®¾å¤‡ï¼Œå¹¶ä¸”ä¸æ”¯æŒnRF52840èŠ¯ç‰‡çš„Port1ã€‚æœ€è¿‘ï¼Œæˆ‘åœ¨è¿™ä¸ªä¸»é¢˜ä¸Šçš„ç ”ç©¶</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Maysensorsç¤¾åŒº</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å¦ä¸€ä½</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">æˆå‘˜</font></a><font style="vertical-align: inherit;">çš„ç ”ç©¶</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ç›¸ç»“åˆï¼Œ</font></a><font style="vertical-align: inherit;">ç»“æœï¼Œå·²ç»é€šè¿‡port1è·å¾—äº†å¯¹nRF52840çš„æ”¯æŒï¼Œé”€é’‰æˆäº†ä¸€ç‰‡å¤§æµ·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¼ æ„Ÿå™¨çš„å¤–å£³æ˜¯åœ¨SolidWorksç¨‹åºä¸­å¼€å‘çš„ï¼Œå®ƒä¹Ÿæ˜¯ç‹¬ç«‹äºå¤§çº¦ä¸€å¹´å‰åœ¨YouTubeä¸Šçš„è¯¾ç¨‹è€Œç†Ÿç»ƒæŒæ¡çš„ã€‚æ¡ˆä»¶è¢«æ‰“å°åœ¨ANYCUBIC FOTON SLAæ‰“å°æœºä¸Šã€‚æˆ‘å¯¹æ‰“å°è´¨é‡å’Œå‡†ç¡®æ€§æ„Ÿåˆ°éå¸¸æ»¡æ„ã€‚å”¯ä¸€çš„è´Ÿé¢å½±å“æ˜¯ï¼Œè¿™ç±»å®¶ç”¨æ‰“å°æœºæ— æ³•ä½¿ç”¨çš„UVæ ‘è„‚çš„é€‰æ‹©ç›¸å½“å·®ã€‚è®¾å¤‡å¤–å£³çš„å°ºå¯¸ï¼šé•¿43æ¯«ç±³ï¼Œå®½26æ¯«ç±³ï¼Œé«˜12.5æ¯«ç±³ã€‚å¸¦ç£é“çš„è¡¨å£³å°ºå¯¸ï¼šé•¿37æ¯«ç±³ï¼Œå®½11æ¯«ç±³ï¼Œé«˜12.5æ¯«ç±³ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/hm/97/myhm97dmggj8d7sdauhlx9oyk5c.png"><br>
<br>
<img src="https://habrastorage.org/webt/wz/9j/cy/wz9jcyajh87x1l7zlncvy_eb1sy.png"><br>
<br>
<img src="https://habrastorage.org/webt/e4/u-/rw/e4u-rwqymkdi701zplhs_b3kn-e.png"><br>
<br>
<img src="https://habrastorage.org/webt/r1/ve/h4/r1veh45ljjnvdwjlappikjgxr_g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç†æƒ³æƒ…å†µä¸‹ï¼Œä¼ æ„Ÿå™¨åŠŸè€—èŒƒå›´ä¸º4Î¼Aè‡³7Î¼Aï¼Œå…·ä½“å–å†³äºæ‰€é€‰çš„èŠ¯ç‰‡ã€‚æ•°æ®ä¼ è¾“æ¨¡å¼ä¸‹çš„åŠŸè€—ä¸º8â€‹â€‹ mAã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¼ æ„Ÿå™¨ä½¿ç”¨CR2032ç”µæ± ã€‚é‰´äºç¼ºå°‘åˆ†æå™¨ï¼ˆç”±äºå…¶ç›¸å½“å¤§çš„æˆæœ¬ï¼‰ï¼Œæ‰€æœ‰æµ‹é‡å‡ç”±ä¸­æ–‡â€œ multifilerâ€è¿›è¡Œï¼š:ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥è®¾å¤‡å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œä½¿ç”¨ä¹¦é¢è‰å›¾æˆ–è‡ªå·±ç¼–å†™ã€‚</font><font style="vertical-align: inherit;">è¦é‡å¤ä¼ æ„Ÿå™¨ï¼Œæ‚¨éœ€è¦çš„æ‰€æœ‰å†…å®¹éƒ½æ”¾åœ¨æˆ‘çš„githubä¸Šï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerberasï¼Œä»£ç ï¼Œæ¡ˆä¾‹æ¨¡å‹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæœ‰äººå‡†å¤‡ååŠ©æŒ‰ç…§ZIGBEEåè®®ç¼–å†™è½¯ä»¶ï¼Œæˆ‘å°†å¾ˆä¹æ„åˆä½œã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨å¯¹æ­¤é¡¹ç›®æ„Ÿå…´è¶£ï¼Œè¯·è®¿é—®ç”µæŠ¥ç»„ï¼Œä»–ä»¬ä¸ä»…ä¼šå¸®åŠ©æ‚¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç†Ÿç»ƒ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒæ¡</font><b><font style="vertical-align: inherit;">Maysensors</font></b><font style="vertical-align: inherit;">åè®®</font><font style="vertical-align: inherit;">ï¼Œè€Œä¸”è¿˜</font><font style="vertical-align: inherit;">å¯ä»¥å¸®åŠ©æ‚¨æŒæ¡</font><b><font style="vertical-align: inherit;">nRF5ä¸Šçš„</font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zigbee</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä»–ä»¬ä¼šè¿…é€Ÿä¸ºæ‚¨æä¾›æœ‰å…³Arduino IDEä¸­nRF52ç¼–ç¨‹çš„æ‰€æœ‰é—®é¢˜çš„å»ºè®®ï¼Œä¸ä»…é™äºæ­¤ã€‚</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">è´­ç‰©</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
è½¦åœ¨æˆ‘ä½çš„åœ°æ–¹å’Œåƒæˆ‘è¿™æ ·çš„äººèŠå¤©- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ MYSENSORS_RUS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹æ‰€æœ‰äººéƒ½å¥½ï¼</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN490464/index.html">å…³äºæš´åŠ›ç‰ˆæƒæˆ–680äº¿é¦–æ›²è°ƒçš„æˆåŠŸå°è¯•ï¼Œä¸ä¼šæ”¹å˜ä»»ä½•äº‹æƒ…</a></li>
<li><a href="../zh-CN490466/index.html">æœºå™¨å­¦ä¹ æ•°å­¦å­¦ç§‘çš„è·¯çº¿å›¾ï¼Œç¬¬2éƒ¨åˆ†ï¼ˆæ¦‚ç‡ï¼‰</a></li>
<li><a href="../zh-CN490470/index.html">OWASPè«æ–¯ç§‘2020/1</a></li>
<li><a href="../zh-CN490472/index.html">å½“æˆ‘ç”¨PHPç¼–å†™åŠåˆ†æ•£å¼åŠ å¯†è´§å¸æ—¶ã€‚ï¼ˆç¬¬1éƒ¨åˆ†-é¦†è—ï¼‰</a></li>
<li><a href="../zh-CN490474/index.html">STM32ç¬¬1éƒ¨åˆ†ï¼šåŸºç¡€çŸ¥è¯†</a></li>
<li><a href="../zh-CN490478/index.html">DIY DIYç„Šæ¥ç«™v2</a></li>
<li><a href="../zh-CN490480/index.html">O Tiling-wmç”¨2ä¸ªè¯</a></li>
<li><a href="../zh-CN490484/index.html">ä½¿ç”¨Google Assistantç®¡ç†æ™ºèƒ½å®¶å±…ä¼ æ„Ÿå™¨</a></li>
<li><a href="../zh-CN490490/index.html">å‘¨æœ«è¯»ç‰©ï¼š10ç§æœ‰å…³å£°éŸ³å¯¹å¥åº·å½±å“çš„ææ–™-ä»â€œå™ªéŸ³å«ç”Ÿâ€åˆ°è‰¯å¥½çš„ç¡çœ å’ŒGTD</a></li>
<li><a href="../zh-CN490492/index.html">ä»“åº“æœºå™¨äººå­¦ä¹ å¯¹éæ ‡å‡†ç‰©å“è¿›è¡Œåˆ†ç±»</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>