<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📅 👩‍✈️ 😾 Utilisation de NAT Traversal pour connecter les utilisateurs de manière passive 🚶🏿 🙆🏾 🥔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article est une traduction gratuite de l'une des entrées du blog des développeurs DC ++ . 
 
 Avec la permission de l'auteur (ainsi que pour des r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Utilisation de NAT Traversal pour connecter les utilisateurs de manière passive</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497944/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet article est une traduction gratuite de l'une des entrées du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog des développeurs DC ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec la permission de l'auteur (ainsi que pour des raisons de clarté et d'intérêt, pour le bien), je l'ai épanoui avec des liens et ajouté quelques recherches personnelles.</font></font><a name="habracut"></a></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Actuellement, au moins un utilisateur d'une paire d'utilisateurs connectés doit être en mode actif. Le mécanisme de «contournement» NAT sera utile si le mode actif n'est configuré sur aucun côté. Cela se produit généralement car le pare-feu ou le périphérique NAT entrant bloque les connexions entrantes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si les deux clients sont en mode actif, le</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> client </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">initiateur envoie la</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
commande </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ ConnectToMe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contenant sa propre adresse IP et son propre port à </font><font style="vertical-align: inherit;">un autre client. À l'aide de ces données, le client recevant la commande établit une connexion avec l'initiateur. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si l'un des clients est en mode passif</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Au moyen du concentrateur, le client passif </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> envoie la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande $ RevConnectToMe au</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> client actif </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui répond ensuite avec la commande $ ConnectToMe. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/l7/vz/bn/l7vzbngdxp3yprlxzcymuutpvp4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme le serveur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le cas des actes ci - </font><font style="vertical-align: inherit;">dessus hub DC </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si les </font><font style="vertical-align: inherit;">deux clients en mode passif, le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=http://h" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hub ADC</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
situé derrière différents clients NAT </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se sont joints au moyeu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yz/li/l3/yzlil3rmvxyjvuz6sv0jqtar3dy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, la connexion au concentrateur regarde du côté client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A.</font></font></b></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;"> Le</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
concentrateur accepte les connexions sur le port 1511. Le client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> établit les connexions sortantes de son réseau privé via le port 50758. Le concentrateur, à son tour, voit l'adresse du périphérique NAT, travaille avec lui et diffuse les clients en fonction de leurs identifiants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> envoie au serveur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un message demandant de l'aide pour se connecter avec le client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bed and</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Etant également en mode passif, le client </font><b><font style="vertical-align: inherit;">B</font></b><font style="vertical-align: inherit;"> , ayant reçu cette commande, doit renseigner son port privé utilisé pour se connecter au concentrateur via NAT. </font><font style="vertical-align: inherit;">
Après avoir reçu ces informations, le client </font><b><font style="vertical-align: inherit;">A</font></b><font style="vertical-align: inherit;"> essaie immédiatement d'établir une connexion avec le client </font><b><font style="vertical-align: inherit;">B</font></b><font style="vertical-align: inherit;"> et signale son propre port privé.</font></font><br>
<br>
<code>Hub: [Outgoing][178.79.159.147:1511] D<b>RCM</b> AAAA BBBB ADCS/0.10 1649612991</code><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<code>Hub: [Incoming][178.79.159.147:1511] D<b>NAT</b> BBBB AAAA ADCS/0.10 <b>59566</b> 1649612991</code><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<code>Hub: [Outgoing][178.79.159.147:1511] D<b>RNT</b> AAAA BBBB ADCS/0.10 <b>50758</b> 1649612991</code><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quel est l'intérêt? </font><font style="vertical-align: inherit;">L'intérêt est de déplacer le point de terminaison de la même connexion en créant une nouvelle connexion à une adresse publique via le port privé déjà utilisé.</font></font></blockquote><br>
<img src="https://habrastorage.org/webt/q3/up/g7/q3upg7hmlgqkvge0cvcfft6mmf0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bingo!</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bien sûr, en même temps, le NAT du client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a le droit de rejeter la première demande de connexion du client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais sa propre demande se précipite déjà dans le «trou» créé par cette connexion, et la connexion est établie. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h1/f4/cd/h1f4cdqdozb75akwftzuxs49tce.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Illustration adaptée à l'ensemble du processus avec la mise en garde que le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocole</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'utilise pas les ports publics ouverts par la session </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NAT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ainsi que les adresses privées. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Épilogue</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Au moment de la rédaction de l'article (original), environ la moitié des clients DC sont passifs. Cela signifie qu'un quart de toutes les connexions possibles ne peuvent pas être établies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'avenir, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DC ++ pourra «contourner» NAT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utiliser les </font><font style="vertical-align: inherit;">connexions </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existantes pour établir une connexion client - client directe, même si </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont en mode passif.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497930/index.html">Émulation Sinclair zx80 / ​​zx81</a></li>
<li><a href="../fr497932/index.html">Nous étudions le moteur VoIP Mediastreamer2. Partie 10</a></li>
<li><a href="../fr497934/index.html">COVID-19: ce qu'ils essaient de traiter, ce qui peut être traité et quelques théories du complot</a></li>
<li><a href="../fr497938/index.html">Le réveil d'un Sleeping Institute: comment supprimer les marcheurs en python de REAPER</a></li>
<li><a href="../fr497940/index.html">Développeur Heart: Sega Saturn Devkits</a></li>
<li><a href="../fr497946/index.html">Y avait-il une vie avant un CD audio? Décodeur logiciel PCM</a></li>
<li><a href="../fr497950/index.html">21 leçons apprises en 21 ans de programmation</a></li>
<li><a href="../fr497952/index.html">Abréviations anglaises et titres informatiques que nous prononçons mal</a></li>
<li><a href="../fr497956/index.html">Sars miraculeux? Généalogie du coronavirus de Wuhan</a></li>
<li><a href="../fr497958/index.html">Ils sont parmi nous: explorer les vulnérabilités et les codes malveillants dans Zoom pour Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>