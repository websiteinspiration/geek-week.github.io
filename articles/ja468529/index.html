<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📈 🚣🏻 ♣️ Goryraを使いこなす、またはGhidraでeBPFを逆コンパイルする 🥄 👋 👩🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="記事の著者https://github.com/Nalen98
 

こんにちは！
 

 «Summer of Hack 2019» Digital Security « eBPF Ghidra». Sleigh eBPF PCode Ghidra , eBPF-. Ghidra, eBPF-. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Goryraを使いこなす、またはGhidraでeBPFを逆コンパイルする</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468529/"><p><img src="https://habrastorage.org/webt/iv/og/7r/ivog7rx1sixvcarbuhefc7myery.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事の著者</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Nalen98</font></font></a></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは！</font></font></p><br>
<p>       «Summer of Hack 2019»   Digital Security  « eBPF  Ghidra».      Sleigh    eBPF  PCode Ghidra    ,    eBPF-.       Ghidra,    eBPF-. ,     ,     «»,      -      eBPF.</p><a name="habracut"></a><br>
<h2 id="predystoriya"></h2><br>
<p>       ,    eBPF     ,  Ghidr-   ,    ,  «IDA Pro ».  ,    .</p><br>
<p>  Ghidra   ,         .  ,      Sleigh,     .             <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Sleigh</a>,     .</p><br>
<p>     extended Berkeley Packet Filter. eBPF       Linux,     ,            .       RISC  11 64- ,    512- .  eBPF   :</p><br>
<ul>
<li> ;</li>
<li>       (    );</li>
<li>      - (eBPF-helpers).</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/ys/gk/wv/ysgkwvdtrqvdgb8vdlyld7awrfu.png"><br>
<i> eBPF-.  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://www.brendangregg.com/ebpf.html</a>.</i></p><br>
<p> ,       — ,        .  eBPF   3.15  ,  «Linux plumbers conference 2019»       .   eBPF,    Ghidra, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>     . ,         .       ,    ,       .</p><br>
<h2 id="plohaya-dokumentaciya"> </h2><br>
<p> ,     Sleigh,   ,     .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</p><br>
<p>   :</p><br>
<ul>
<li><p>    eBPF.</p><br>
<p>  ,  Intel x86,  ,      ,    .  ,   eBPF       ,   ,             Linux. </p><br>
<p>,    <code>op:8, dst_reg:4, src_reg:4, off:16, imm:32</code>    ,  offset (off)  immediate (imm)  <code>signed</code>,    ,          .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  Linux.</p><br>
</li>
<li><p>       .</p><br>
<p>       ,  ,      C,  ,     .   eBPF   ,     .   -.</p><br>
<p>   eBPF 64-,  <code>LDDW</code> (Load double word),    128 ,      imm  32 . eBPF-   .<br>
<img src="https://habrastorage.org/webt/vp/vg/y0/vpvgy0gcsrrh3-uuax8ja3fgvvs.png"><br>
<i>eBPF instruction encoding</i></p><br>
<p>  <code>OPAQUE</code>     (ALU/JMP, Load/Store). </p><br>
<p>,   <code>ALU</code>:<br>
<img src="https://habrastorage.org/webt/wd/9o/un/wd9ounsyetsua9ztfnd_zgxsfdc.png"><br>
<i>ALU instructions encoding</i></p><br>
<p>  <code>JMP</code>    :<br>
<img src="https://habrastorage.org/webt/au/bf/kz/aubfkz1yol8kjewuqesnlcsizm0.png"><br>
<i>Branch instructions encoding</i> </p><br>
<p> Load/Store   :<br>
<img src="https://habrastorage.org/webt/6y/ei/5h/6yei5h-0e6uazrqib0ihmffi2lg.png"><br>
<i>Load/Store instructions encoding</i> </p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  eBPF</a>.</p><br>
</li>
<li><p>   call-helpers,      eBPF-   Linux.</p><br>
<p>   ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a> —  ,    eBPF-,       ,     .</p><br>
</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/wk/ao/a6/wkaoa6jcgrqrqczkw4vjmrlczf4.png"><br>
<i> eBPF   </i> </p><br>
<p>     ,         ,   ,   eBPF maps,   ,   userspace-.   ,    ,         -.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a> Linux.</p><br>
<ul>
<li>   «tail calls».</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/f6/yf/f_/f6yff_btrkhq2pe1f_p4artfbla.png"><br>
<i>  eBPF.  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://cilium.readthedocs.io/en/latest/bpf/#tail-calls</a>.</i> </p><br>
<p>  —  ,    eBPF-  ,    ,      eBPF-.      ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Cilium</a>.</p><br>
<p>      eBPF   «»  ,     .  ,      .</p><br>
<h2 id="o-srede-razrabotki">  </h2><br>
<p><img src="https://habrastorage.org/webt/5z/l7/qa/5zl7qa8zrk3sz5bwogqqbjkzj0y.png"></p><br>
<p>   ,      Sleigh-     /  Ghidra     — Eclipse IDE    <strong>GhidraDev</strong>  <strong>GhidraSleighEditor</strong>.           ,      Sleigh-,        .</p><br>
<p> Eclipse   Ghidra (   ),  ,   . , ,       "Ghidra Headless",    Ghidr-  GUI  100500 ,     ,      .</p><br>
<p>  !   Eclipse   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>.   ,  Ecplise  <strong>Help → Install New Software...</strong>,  <strong>Add</strong>   zip- .</p><br>
<h2 id="razrabotka-rasshireniya"> </h2><br>
<p>      , ,     ELF-        eBPF-,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">eBPF Maps</a>     Ghidra,       eBPF-.</p><br>
<p><img src="https://habrastorage.org/webt/9b/au/py/9baupyq-7nmirl9wzrg8rhgs5aq.png"></p><br>
<p><img src="https://habrastorage.org/webt/b7/ql/w3/b7qlw3ziz1trmobuvp8jb1ynnu8.png"><br>
<i>      Eclipse IDE</i> </p><br>
<p>   :</p><br>
<p><code>.cspec</code> — ,    ,       eBPF,   ,   «stackpointer»   <code>R10</code>,    .  (  )    :</p><br>
<blockquote>Therefore, eBPF calling convention is defined as:<br>
<ul>
<li>R0 — return value from in-kernel function, and exit value for eBPF program</li>
<li>R1 — R5 — arguments from eBPF program to in-kernel function</li>
<li>R6 — R9 — callee saved registers that in-kernel function will preserve</li>
<li>R10 — read-only frame pointer to access stack</li>
</ul><br>
</blockquote><br>
<div class="spoiler"><b class="spoiler_title">eBPF.cspec</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">compiler_spec</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">data_organization</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">absolute_max_alignment</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">machine_alignment</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">default_alignment</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">default_pointer_alignment</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">pointer_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">wchar_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">short_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">integer_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">long_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">long_long_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"8"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">float_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">double_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"8"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">long_double_size</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"8"</span> /&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">size_alignment_map</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">alignment</span>=<span class="hljs-string">"1"</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">alignment</span>=<span class="hljs-string">"2"</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">alignment</span>=<span class="hljs-string">"4"</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"8"</span> <span class="hljs-attr">alignment</span>=<span class="hljs-string">"8"</span> /&gt;</span>
     <span class="hljs-tag">&lt;/<span class="hljs-name">size_alignment_map</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">data_organization</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">global</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">range</span> <span class="hljs-attr">space</span>=<span class="hljs-string">"ram"</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">range</span> <span class="hljs-attr">space</span>=<span class="hljs-string">"syscall"</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">global</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">stackpointer</span> <span class="hljs-attr">register</span>=<span class="hljs-string">"R10"</span> <span class="hljs-attr">space</span>=<span class="hljs-string">"ram"</span>/&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">default_proto</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">prototype</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"__fastcall"</span> <span class="hljs-attr">extrapop</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">stackshift</span>=<span class="hljs-string">"0"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pentry</span> <span class="hljs-attr">minsize</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">maxsize</span>=<span class="hljs-string">"8"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R1"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">pentry</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pentry</span> <span class="hljs-attr">minsize</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">maxsize</span>=<span class="hljs-string">"8"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R2"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">pentry</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pentry</span> <span class="hljs-attr">minsize</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">maxsize</span>=<span class="hljs-string">"8"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R3"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">pentry</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">pentry</span> <span class="hljs-attr">minsize</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">maxsize</span>=<span class="hljs-string">"8"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R4"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">pentry</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">pentry</span> <span class="hljs-attr">minsize</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">maxsize</span>=<span class="hljs-string">"8"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R5"</span>/&gt;</span>       
    <span class="hljs-tag">&lt;/<span class="hljs-name">pentry</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">input</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">output</span> <span class="hljs-attr">killedbycall</span>=<span class="hljs-string">"true"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pentry</span> <span class="hljs-attr">minsize</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">maxsize</span>=<span class="hljs-string">"8"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R0"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">pentry</span>&gt;</span>
       <span class="hljs-tag">&lt;/<span class="hljs-name">output</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">unaffected</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">varnode</span> <span class="hljs-attr">space</span>=<span class="hljs-string">"ram"</span> <span class="hljs-attr">offset</span>=<span class="hljs-string">"8"</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"8"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R6"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R7"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R8"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R9"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">register</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"R10"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">unaffected</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">prototype</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">default_proto</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-name">compiler_spec</span>&gt;</span></code></pre></div></div><br>
<p> ,     ,     <code>.cspec</code>-.</p><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">stackpointer</span> <span class="hljs-attr">register</span>=<span class="hljs-string">"R10"</span> <span class="hljs-attr">space</span>=<span class="hljs-string">"ram"</span>/&gt;</span></code></pre><br>
<p>       eBPF  Ghidra,         eBPF,     ,        .</p><br>
<h2 id="all-we-need-isstack">All we need is…Stack</h2><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a> :</p><br>
<blockquote>Q: Can BPF programs access instruction pointer or return address?<br>
<br>
A: NO.<br>
<br>
Q: Can BPF programs access stack pointer?<br>
<br>
A: NO. Only frame pointer (register R10) is accessible. From compiler point of view it's necessary to have stack pointer. For example, LLVM defines register R11 as stack pointer in its BPF backend, but it makes sure that generated code never uses it.</blockquote><p>      (IP),    (SP),    Ghidra  ,      .  <code>cspec</code>-  ,    stackpointer- (   ). <code>R10</code> —   eBPF,      ,  framepointer,     .   «stackpointer»  <code>R10</code>  <code>cspec</code>-   ,    ,   Ghidra      . ,  SP ,        eBPF.</p><br>
<p>    :</p><br>
<ol>
<li><p> "Stack Depth"  Ghidra   ,      <code>R10</code>     ,       ,    . "Stack Depth"       «stackpointer». </p><br>
<p>    ,   .</p><br>
</li>
<li><p>,    <code>R10</code> ( ,    )   . Ghidra     ,     (  ,    ).   <code>R10</code> ,   store/load   Ghidr-  deadcode    .</p><br>
<p> ,       ,        eBPF-  <code>pspec</code> — ,       Ghidra  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Issue </a>.</p><br>
</li>
</ol><br>
<h2 id="razrabotka-rasshireniya-continued">  (continued)</h2><br>
<p><code>.ldefs</code>   ,   .</p><br>
<div class="spoiler"><b class="spoiler_title">eBPF.ldefs</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">language_definitions</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">language</span> <span class="hljs-attr">processor</span>=<span class="hljs-string">"eBPF"</span>
            <span class="hljs-attr">endian</span>=<span class="hljs-string">"little"</span>
            <span class="hljs-attr">size</span>=<span class="hljs-string">"64"</span>
            <span class="hljs-attr">variant</span>=<span class="hljs-string">"default"</span>
            <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>
            <span class="hljs-attr">slafile</span>=<span class="hljs-string">"eBPF.sla"</span>
            <span class="hljs-attr">processorspec</span>=<span class="hljs-string">"eBPF.pspec"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"eBPF:LE:64:default"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>eBPF processor 64-bit little-endian<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">compiler</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"default"</span> <span class="hljs-attr">spec</span>=<span class="hljs-string">"eBPF.cspec"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"default"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">external_name</span> <span class="hljs-attr">tool</span>=<span class="hljs-string">"DWARF.register.mapping.file"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"eBPF.dwarf"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">language</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">language_definitions</span>&gt;</span></code></pre></div></div><br>
<p> <code>.opinion</code>      .</p><br>
<div class="spoiler"><b class="spoiler_title">eBPF.opinion</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">opinions</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">constraint</span> <span class="hljs-attr">loader</span>=<span class="hljs-string">"Executable and Linking Format (ELF)"</span> <span class="hljs-attr">compilerSpecID</span>=<span class="hljs-string">"default"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">constraint</span> <span class="hljs-attr">primary</span>=<span class="hljs-string">"247"</span> <span class="hljs-attr">processor</span>=<span class="hljs-string">"eBPF"</span>  <span class="hljs-attr">endian</span>=<span class="hljs-string">"little"</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"64"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">constraint</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">opinions</span>&gt;</span></code></pre></div></div><br>
<p> <code>.pspec</code>   ,   eBPF        ,     . , <code>PC</code>  eBPF ,    (  ,     ),      .</p><br>
<p>        eBPF-,      .</p><br>
<div class="spoiler"><b class="spoiler_title">eBPF.pspec</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">processor_spec</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">programcounter</span> <span class="hljs-attr">register</span>=<span class="hljs-string">"PC"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">default_symbols</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_unspec"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x0"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_map_lookup_elem"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x1"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_map_update_elem"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x2"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_map_delete_elem"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x3"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_probe_read"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x4"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_ktime_get_ns"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x5"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_trace_printk"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x6"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_prandom_u32"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x7"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_smp_processor_id"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x8"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_store_bytes"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x9"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_l3_csum_replace"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0xa"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_l4_csum_replace"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0xb"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_tail_call"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0xc"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_clone_redirect"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0xd"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_current_pid_tgid"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0xe"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_current_uid_gid"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0xf"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_current_comm"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x10"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_cgroup_classid"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x11"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_vlan_push"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x12"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_vlan_pop"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x13"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_get_tunnel_key"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x14"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_set_tunnel_key"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x15"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_perf_event_read"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x16"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_redirect"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x17"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_route_realm"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x18"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_perf_event_output"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x19"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_load_bytes"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x1a"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_stackid"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x1b"</span>/&gt;</span> 
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_csum_diff"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x1c"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_get_tunnel_opt"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x1d"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_set_tunnel_opt"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x1e"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_change_proto"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x1f"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_change_type"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x20"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_skb_under_cgroup"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x21"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_hash_recalc"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x22"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_get_current_task"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x23"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">symbol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bpf_probe_write_user"</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"syscall:0x24"</span>/&gt;</span>
       <span class="hljs-tag">&lt;/<span class="hljs-name">default_symbols</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">default_memory_blocks</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">memory_block</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"eBPFHelper_functions"</span> <span class="hljs-attr">start_address</span>=<span class="hljs-string">"syscall:0"</span> <span class="hljs-attr">length</span>=<span class="hljs-string">"0x200"</span> <span class="hljs-attr">initialized</span>=<span class="hljs-string">"true"</span>/&gt;</span>    
       <span class="hljs-tag">&lt;/<span class="hljs-name">default_memory_blocks</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">processor_spec</span>&gt;</span></code></pre></div></div><br>
<p><code>.sinc</code>  —    ,    ,   eBPF, ,       Sleigh.</p><br>
<div class="spoiler"><b class="spoiler_title">  eBPF.sinc</b><div class="spoiler_text"><pre><code class="plaintext hljs">define space ram type=ram_space size=8 default;<font></font>
define space register type=register_space size=4;<font></font>
define space syscall type=ram_space size=2;<font></font>
<font></font>
define register offset=0 size=8 [ R0  R1  R2  R3  R4  R5  R6  R7  R8  R9  R10  PC ];<font></font>
<font></font>
define token instr(64)<font></font>
    imm=(32, 63) signed<font></font>
    off=(16, 31) signed<font></font>
    src=(12, 15)<font></font>
    dst=(8, 11)<font></font>
    op_alu_jmp_opcode=(4, 7)<font></font>
    op_alu_jmp_source=(3, 3)<font></font>
    op_ld_st_mode=(5, 7)<font></font>
    op_ld_st_size=(3, 4)<font></font>
    op_insn_class=(0, 2)<font></font>
;<font></font>
#We'll need this token to operate with LDDW instruction, which has 64 bit imm value<font></font>
define token immtoken(64)<font></font>
    imm2=(32, 63)<font></font>
;<font></font>
#To operate with registers<font></font>
attach variables [ src dst ] [  R0  R1  R2  R3  R4  R5  R6  R7  R8  R9  R10  _  _  _  _  _  ];<font></font>
…<font></font>
:ADD dst, src  is src &amp; dst &amp; op_alu_jmp_opcode=0x0 &amp; op_alu_jmp_source=1 &amp; op_insn_class=0x7 { dst=dst + src; }<font></font>
:ADD dst, imm  is imm &amp; dst &amp; op_alu_jmp_opcode=0x0 &amp; op_alu_jmp_source=0 &amp; op_insn_class=0x7 { dst=dst + imm; }<font></font>
…</code></pre></div></div><br>
<p> eBPF    ELF-,    ,   ,     Ghidra,  — eBPF.    <code>ElfConstants</code> Ghidra  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">BPF-</a>,      eBPF-.</p><br>
<div class="spoiler"><b class="spoiler_title">eBPF_ElfExtension.java</b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword">package</span> ghidra.app.util.bin.format.elf.extend;<font></font>
<font></font>
<span class="hljs-keyword">import</span> ghidra.app.util.bin.format.elf.*;
<span class="hljs-keyword">import</span> ghidra.program.model.lang.*;
<span class="hljs-keyword">import</span> ghidra.util.exception.*;
<span class="hljs-keyword">import</span> ghidra.util.task.TaskMonitor;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eBPF_ElfExtension</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ElfExtension</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canHandle</span><span class="hljs-params">(ElfHeader elf)</span> </span>{
        <span class="hljs-keyword">return</span> elf.e_machine() == ElfConstants.EM_BPF &amp;&amp; elf.is64Bit();<font></font>
    }<font></font>
    <span class="hljs-meta">@Override</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canHandle</span><span class="hljs-params">(ElfLoadHelper elfLoadHelper)</span> </span>{<font></font>
        Language language = elfLoadHelper.getProgram().getLanguage();<font></font>
        <span class="hljs-keyword">return</span> canHandle(elfLoadHelper.getElfHeader()) &amp;&amp;
                <span class="hljs-string">"eBPF"</span>.equals(language.getProcessor().toString()) &amp;&amp;<font></font>
                        language.getLanguageDescription().getSize() == <span class="hljs-number">64</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getDataTypeSuffix</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"eBPF"</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processGotPlt</span><span class="hljs-params">(ElfLoadHelper elfLoadHelper, TaskMonitor monitor)</span> <span class="hljs-keyword">throws</span> CancelledException </span>{
        <span class="hljs-keyword">if</span> (!canHandle(elfLoadHelper)) {
            <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">super</span>.processGotPlt(elfLoadHelper, monitor);<font></font>
    }<font></font>
<font></font>
}</code></pre></div></div><br>
<p>     eBPF maps    .       ,        map-.    , ,     <code>LDDW</code>,   <code>Rn</code>    (, <code>bpf_map_lookup_elem(…)</code>).</p><br>
<p>,     ,    (),        . ,    ,        .</p><br>
<div class="spoiler"><b class="spoiler_title">eBPF_ElfRelocationHandler.java</b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eBPF_ElfRelocationHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ElfRelocationHandler</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canRelocate</span><span class="hljs-params">(ElfHeader elf)</span> </span>{
        <span class="hljs-keyword">return</span> elf.e_machine() == ElfConstants.EM_BPF;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">relocate</span><span class="hljs-params">(ElfRelocationContext elfRelocationContext, ElfRelocation relocation,
            Address relocationAddress)</span> <span class="hljs-keyword">throws</span> MemoryAccessException, NotFoundException </span>{<font></font>
<font></font>
        ElfHeader elf = elfRelocationContext.getElfHeader();<font></font>
        <span class="hljs-keyword">if</span> (elf.e_machine() != ElfConstants.EM_BPF) {
            <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
<font></font>
        Program program = elfRelocationContext.getProgram();<font></font>
        Memory memory = program.getMemory();<font></font>
<font></font>
        <span class="hljs-keyword">int</span> type = relocation.getType();    
        <span class="hljs-keyword">int</span> symbolIndex = relocation.getSymbolIndex();              
        <span class="hljs-keyword">long</span> value;
        <span class="hljs-keyword">boolean</span> appliedSymbol = <span class="hljs-keyword">true</span>;<font></font>
<font></font>
<span class="hljs-comment">//Relocations with maps always have type 0x1. Since eBPF hasn't names of constants (types) of relocations, it was decided to use magic //number 1.</span>
        <span class="hljs-keyword">if</span> (type == <span class="hljs-number">1</span>) {            
            <span class="hljs-keyword">try</span> {                   
                <span class="hljs-keyword">int</span> SymbolIndex= relocation.getSymbolIndex();<font></font>
                ElfSymbol Symbol = elfRelocationContext.getSymbol(SymbolIndex);<font></font>
                String map = Symbol.getNameAsString();              <font></font>
<font></font>
                SymbolTable table = program.getSymbolTable();<font></font>
                Address mapAddr = table.getSymbol(map).getAddress();<font></font>
                String sec_name = elfRelocationContext.relocationTable.getSectionToBeRelocated().getNameAsString();<font></font>
                <span class="hljs-keyword">if</span> (sec_name.toString().contains(<span class="hljs-string">"debug"</span>)) {
                    <span class="hljs-keyword">return</span>;<font></font>
                }<font></font>
<font></font>
                value = mapAddr.getAddressableWordOffset();     <font></font>
                Byte dst = memory.getByte(relocationAddress.add(<span class="hljs-number">0x1</span>));<font></font>
                memory.setLong(relocationAddress.add(<span class="hljs-number">0x4</span>), value);          <font></font>
                memory.setByte(relocationAddress.add(<span class="hljs-number">0x1</span>), (<span class="hljs-keyword">byte</span>) (dst + <span class="hljs-number">0x10</span>));                <font></font>
                }<font></font>
                <span class="hljs-keyword">catch</span>(NullPointerException e) {}<font></font>
        }       <font></font>
<font></font>
        <span class="hljs-keyword">if</span> (appliedSymbol &amp;&amp; symbolIndex == <span class="hljs-number">0</span>) {<font></font>
            markAsWarning(program, relocationAddress, Long.toString(type),<font></font>
                <span class="hljs-string">"applied relocation with symbol-index of 0"</span>, elfRelocationContext.getLog());<font></font>
        }<font></font>
<font></font>
    }<font></font>
}</code></pre></div></div><br>
<p><img src="https://habrastorage.org/webt/_8/l_/1m/_8l_1mca5r1spj1ffuvpabjs0es.png"><br>
<i>    eBPF</i> </p><br>
<p>  ,     eBPF!   !</p><br>
<p>  GitHub: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">eBPF for Ghidra</a>.</p><br>
<p> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</p><br>
<h3 id="ps">P.S.</h3><br>
<p>  <strong>Digital Security</strong>   ,      (  ).   !</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468519/index.html">共通のコードベースを作成する</a></li>
<li><a href="../ja468521/index.html">情報セキュリティを一般化する方法</a></li>
<li><a href="../ja468523/index.html">ロケットからロボットへ、そしてPythonはそれと何をしなければならないか。GeekBrains Alumni Story</a></li>
<li><a href="../ja468525/index.html">木のおもちゃ、パート1-1982-1985</a></li>
<li><a href="../ja468527/index.html">逆動力学問題法によるコントローラーの合成</a></li>
<li><a href="../ja468531/index.html">VKontakte向けの最初のPHPボット</a></li>
<li><a href="../ja468533/index.html">Express 42によるDevOpsでのヒッチハイク</a></li>
<li><a href="../ja468535/index.html">ログは必要ありませんか？</a></li>
<li><a href="../ja468537/index.html">DevOpsの基本。プロジェクトへの最初からの参入</a></li>
<li><a href="../ja468541/index.html">ドラッグ＆＆-視覚障害者向けのコンポーネントをドロップしますか？冗談ですか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>