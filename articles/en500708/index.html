<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¶ üë®‚Äçüî¨ üî∑ Security and DBMS: what you need to remember when choosing protection tools üë©üèæ‚Äçüéì üìÜ üßñüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My name is Denis Rozhkov, I‚Äôm the head of software development at Gazinformservice, in the Jatoba product team . Legislation and corporate regulations...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Security and DBMS: what you need to remember when choosing protection tools</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/500708/"><h1><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e1/315/3ed/1e13153edc98d4ac4b2de6858a7ea48c.png"></div></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My name is Denis Rozhkov, I‚Äôm the head of software development at Gazinformservice, in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jatoba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> product </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">team</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Legislation and corporate regulations impose certain requirements for the security of data storage. </font><font style="vertical-align: inherit;">Nobody wants third parties to gain access to confidential information, therefore the following issues are important for any project: identification and authentication, management of data access, ensuring the integrity of information in the system, recording security events. </font><font style="vertical-align: inherit;">Therefore, I want to talk about some interesting points regarding the DBMS security.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article was </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">written</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">@Databases Meetup,</font></a><font style="vertical-align: inherit;"> hosted by </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mail.ru Cloud Solutions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">If you do not want to read, you can see:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/n-54j9FHaMU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The article will have three parts:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to protect connections.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is an audit of actions and how to record what is happening on the part of the database and connecting to it.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to protect data in the database itself and what technologies are there for this.</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a7d/19f/d89/a7d19fd894a9ea6e3f0ff7a0ad42db36.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The three components of DBMS security: connection protection, activity audit, and data protection</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connection Protection</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can connect to the database either directly or indirectly through web applications. </font><font style="vertical-align: inherit;">As a rule, the user from the side of the business, that is, the person who works with the DBMS, does not interact directly with it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before talking about securing connections, you need to answer important questions that depend on how security measures will be built:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">whether one business user is equivalent to one DBMS user;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is access to DBMS data provided only through the API that you control, or is there access to tables directly;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">whether the DBMS is allocated in a separate protected segment, who interacts with it and how;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">whether pooling / proxy and middleware are used, which can change information about how the connection is built and who uses the database.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's see what tools can be used to protect connections:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use database firewall class solutions. </font><font style="vertical-align: inherit;">An additional layer of protection, at least, will increase the transparency of what is happening in the DBMS, as a maximum - you can provide additional data protection.</font></font></li>
<li>  .     ,    .    ‚Äî      -,    ,   .    ,  ,      .<br>
<br>
       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a>,    MS SQL Vulnerability Assessmen   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a>.&nbsp;</li>
<li>    .   ,   ,       ,         , ,    .      .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configure SSL, if you do not have a network separation of the DBMS from end users, it is not in a separate VLAN. </font><font style="vertical-align: inherit;">In such cases, it is necessary to protect the channel between the consumer and the DBMS itself. </font><font style="vertical-align: inherit;">Protection tools are among open source.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How will this affect DBMS performance?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's look at a PostgreSQL example, how SSL affects the CPU load, increasing timings and decreasing TPS, if too many resources go if you enable it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We load PostgreSQL using pgbench - it is a simple program for running performance tests. </font><font style="vertical-align: inherit;">It repeatedly executes one sequence of commands, possibly in parallel database sessions, and then calculates the average transaction speed. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test 1 without SSL and using SSL</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a connection is established with each transaction:</font></font><br>
<br>
<pre><code class="plaintext hljs">pgbench.exe --connect -c 10 -t 5000 "host=192.168.220.129 dbname=taskdb user=postgres sslmode=require&nbsp;<font></font>
sslrootcert=rootCA.crt sslcert=client.crt sslkey=client.key"</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vs</font></font></strong><br>
<br>
<pre><code class="plaintext hljs">pgbench.exe --connect -c 10 -t 5000 "host=192.168.220.129 dbname=taskdb user=postgres"</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test 2 without SSL and using SSL</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - all transactions are performed in one connection:</font></font><br>
<br>
<pre><code class="plaintext hljs">pgbench.exe -c 10 -t 5000 "host=192.168.220.129 dbname=taskdb user=postgres sslmode=require<font></font>
sslrootcert=rootCA.crt sslcert=client.crt sslkey=client.key"</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vs</font></font></strong><br>
<br>
<pre><code class="plaintext hljs">pgbench.exe -c 10 -t 5000 "host=192.168.220.129 dbname=taskdb user=postgres"</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Other settings</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">scaling factor: 1<font></font>
query mode: simple<font></font>
number of clients: 10<font></font>
number of threads: 1<font></font>
number of transactions per client: 5000<font></font>
number of transactions actually processed: 50000/50000</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test Results</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td>&nbsp;</td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NO SSL</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL</font></font></strong></td>
</tr>
<tr>
<td colspan="3"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connection is established at each transaction</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">latency average</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">171.915 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">187.695 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tps including connections establishing</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">58.168112</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">53.278062</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tps excluding connections establishing</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64.084546</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">58.725846</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28%</font></font></td>
</tr>
<tr>
<td colspan="3"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All transactions are performed in one connection.</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">latency average</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.722 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.342 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tps including connections establishing</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1587.657278</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1576.792883</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tps excluding connections establishing</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1588.380574</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1577.694766</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At light loads, the effect of SSL is comparable to the measurement error. If the amount of data transferred is very large, the situation may be different. If we establish one connection for each transaction (this is rare, usually the connection is shared between users), you have a large number of connections / disconnections, the effect may be a little more. That is, there may be risks to performance degradation, however, the difference is not so large as not to use protection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that there is a strong difference when comparing the operating modes: within the same session, you work or different. This is understandable: resources are spent on creating each connection.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We had a case when we connected Zabbix in trust mode, that is, we did not check md5, there was no need for authentication. Then the customer asked to enable md5 authentication mode. This gave a large load on the CPU, performance dipped. They began to look for ways to optimize. One of the possible solutions to the problem is to implement a network restriction, make separate VLANs for the DBMS, add settings so that it is clear who is connecting from where and remove authentication. You can also optimize authentication settings to reduce the costs of enabling authentication, but generally using different methods authentication affects performance and requires these factors to be considered when designing the computing power of servers (hardware) for a DBMS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conclusion: in a number of solutions, even small nuances of authentication can greatly affect the project and it‚Äôs bad when it becomes clear only when implemented in a product.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audit of actions</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An audit can be not only a DBMS. </font><font style="vertical-align: inherit;">Audit is the receipt of information about what is happening on different segments. </font><font style="vertical-align: inherit;">It can be both a database firewall and the operating system on which the DBMS is built. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In commercial enterprise-level DBMSs with auditing, everything is fine, in open source - not always. </font><font style="vertical-align: inherit;">Here is what PostgreSQL has:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">default log - built-in logging;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extensions: pgaudit - if you do not have enough default logging, you can use separate settings that solve some of the problems.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Addition to the report in the video:</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
‚ÄúBasic registration of operators can be provided with standard logging facility with log_statement = all. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is acceptable for monitoring and other uses, but does not provide the level of detail typically needed for an audit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is not enough to have a list of all operations performed with the database. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should also be possible to find specific statements that are of interest to the auditor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The standard logging tool shows what the user requested, while pgAudit focuses on the details of what happened when the database made the request. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, the auditor may want to ensure that a specific table has been created in a documented maintenance window.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This may seem like a simple task for basic auditing and grep, but what if you come across something like this (intentionally confusing) example: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DO $$ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BEGIN </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 EXECUTE 'CREATE TABLE import' || 'ant_table (id INT)'; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
END $$; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standard logging will give you this: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LOG: statement: DO $$ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BEGIN </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 EXECUTE 'CREATE TABLE import' || 'ant_table (id INT)'; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
END $$; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems that searching for a table of interest may require some code knowledge in cases where tables are created dynamically. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is not ideal, as it would be preferable to just search by table name. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is where pgAudit will be useful. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the same input, it will output this output in the log:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AUDIT: SESSION, 33.1, FUNCTION, DO ,,, ‚ÄúDO $$ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BEGIN </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 EXECUTE 'CREATE TABLE import' || </font><font style="vertical-align: inherit;">'ant_table (id INT)'; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
END $$; " </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AUDIT: SESSION, 33,2, DDL, CREATE TABLE, TABLE, public.important_table, CREATE TABLE important_table (id INT) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not only the DO block is registered, but also the full text CREATE TABLE with the operator type, object type and full name, making it easier to search. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
in the conduct of the operators magazine SELECT and DML pgAudit can be configured to log a separate entry for each relationship, which is referenced in the statement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do not need to parse to find all the statements that relate to a specific table ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) " .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How will this affect DBMS performance?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's run the tests with full audit enabled and see what happens with the performance of PostgreSQL. </font><font style="vertical-align: inherit;">We enable the maximum database logging in all respects. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We almost do not change anything in the configuration file, from the important one - turn on debug5 mode to get the maximum information. </font></font><br>
<br>
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postgresql.conf</font></font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log_destination = 'stderr' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
logging_collector = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_truncate_on_rotation = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_rotation_age = 1d </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_rotation_size = 10MB </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_min_messages = </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debug5</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
log_min_error_statement = </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debug5</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
log_min_duration_statement = 0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
debug_print_parse =</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debug_print_rewritten = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
debug_print_plan = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
debug_pretty_print = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_checkpoints = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_connections = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_disconnections = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_duration = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_hostname = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_lock_waits = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_replication_commands = on </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_temp_files = 0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_timezone =</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the PostgreSQL DBMS with the parameters 1 CPU, 2.8 GHz, 2 GB RAM, 40 GB HDD, we carry out three load tests using the following commands:</font></font><br>
<br>
<pre><code class="plaintext hljs">$ pgbench -p 3389 -U postgres -i -s 150 benchmark<font></font>
$ pgbench -p 3389 -U postgres -c 50 -j 2 -P 60 -T 600 benchmark<font></font>
$ pgbench -p 3389 -U postgres -c 150 -j 2 -P 60 -T 600 benchmark</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test results:</font></font></strong><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Without logging</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With logging</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total database filling time</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">43.74 sec</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">53.23 sec</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">72%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">91%</font></font></td>
</tr>
<tr>
<td colspan="3"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test 1 (50 connections)</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Number of transactions in 10 minutes</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">74169</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32445</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transaction / sec</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">54</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Average delay</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">405 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">925 ms</font></font></td>
</tr>
<tr>
<td colspan="3"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test 2 (150 connections at 100 possible)</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Number of transactions in 10 minutes</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">81727</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">31429</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transaction / sec</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">136</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Average delay</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">550 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1432 ms</font></font></td>
</tr>
<tr>
<td colspan="3"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About sizes</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DB size</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2251 MB</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2262 MB</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Database Log Size</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 Mb</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4587 Mb</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bottom line: a full audit is not very good. </font><font style="vertical-align: inherit;">The data from the audit will turn out in volume, as the data in the database itself, or even more. </font><font style="vertical-align: inherit;">The amount of logging that is generated when working with the DBMS is a common problem on the product. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We look at other parameters:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The speed does not change much: without logging - 43.74 seconds, with logging - 53.23 sec.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance on RAM and CPU will sink, since you need to create a file with the audit. </font><font style="vertical-align: inherit;">It is also noticeable on the productive.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With an increase in the number of connections, of course, the performance will slightly deteriorate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In corporations with auditing, it‚Äôs even more difficult:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">there is a lot of data;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auditing is needed not only through syslog in SIEM, but also into files: suddenly something happens with syslog, the file in which the data is saved should be close to the database;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">audit requires a separate shelf, so as not to sink on I / O disks, since it takes up a lot of space;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it happens that IS employees need GOSTs everywhere, they require guest identification.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data access restriction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's look at the technologies that are used to protect data and access to it in commercial DBMS and open source. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What can be used as a whole:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encryption and obfuscation of procedures and functions (Wrapping) - that is, separate tools and utilities that make code unreadable from readable code. </font><font style="vertical-align: inherit;">True, then it can neither be changed nor refactored back. </font><font style="vertical-align: inherit;">Such an approach is sometimes required at least on the DBMS side ‚Äî the logic of licensing restrictions or the authorization logic is encrypted precisely at the level of procedure and function.</font></font></li>
<li>     (RLS) ‚Äî       ,      ,   - -     .</li>
<li>   (Masking) ‚Äî          ,   ,    -    .  ,        .</li>
<li>  Security DBA/Application DBA/DBA ‚Äî , ,      ,        database-  application-.  open source   ,     .  ,        .</li>
<li>       .   ,    ,         .</li>
<li>     ‚Äî    .</li>
<li>End-to-end encryption   ‚Äî  client-side       .</li>
<li> . ,   ‚Äî    ,     .</li>
</ol><br>
<h3>     ?</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's look at an example of column encryption in PostgreSQL. </font><font style="vertical-align: inherit;">There is a pgcrypto module, it allows you to store selected fields in encrypted form. </font><font style="vertical-align: inherit;">This is useful when only some data is valuable. </font><font style="vertical-align: inherit;">To read the encrypted fields, the client passes the decryption key, the server decrypts the data and issues it to the client. </font><font style="vertical-align: inherit;">Without a key with your data, no one can do anything. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's test with pgcrypto</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Create a table with encrypted data and regular data. </font><font style="vertical-align: inherit;">Below is the command for creating tables, in the very first line a useful command is creating the extension itself with the registration of the DBMS:</font></font><br>
<br>
<pre><code class="plaintext hljs">CREATE EXTENSION pgcrypto;<font></font>
CREATE TABLE t1 (id integer, text1 text, text2 text);<font></font>
CREATE TABLE t2 (id integer, text1 bytea, text2 bytea);<font></font>
INSERT INTO t1 (id, text1, text2)<font></font>
VALUES (generate_series(1,10000000), generate_series(1,10000000)::text, generate_series(1,10000000)::text);<font></font>
INSERT INTO t2 (id, text1, text2) VALUES (<font></font>
generate_series(1,10000000),<font></font>
encrypt(cast(generate_series(1,10000000) AS text)::bytea, 'key'::bytea, 'bf'),<font></font>
encrypt(cast(generate_series(1,10000000) AS text)::bytea, 'key'::bytea, 'bf'));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we will try to make data sampling from each table and look at the execution timings. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selection from the table without encryption function</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">psql -c "\timing" -c "select * from t1 limit 1000;" "host=192.168.220.129 dbname=taskdb<font></font>
user=postgres sslmode=disable" &gt; 1.txt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stopwatch is on. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;id | </font><font style="vertical-align: inherit;">text1 | </font><font style="vertical-align: inherit;">text2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
------ + ------- + ------- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 1 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 2 | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 3 | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">3 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
997 | </font><font style="vertical-align: inherit;">997 | </font><font style="vertical-align: inherit;">997 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
998 | </font><font style="vertical-align: inherit;">998 | </font><font style="vertical-align: inherit;">998,999 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">999 | </font><font style="vertical-align: inherit;">999 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1000 | </font><font style="vertical-align: inherit;">1000 | </font><font style="vertical-align: inherit;">1000 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(1000 rows) </font></font><br>
<br>
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Time: 1.386 ms. </font></font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sampling from a table with encryption function:</font></font></strong><br>
<br>
<pre><code class="plaintext hljs">psql -c "\timing" -c "select id, decrypt(text1, 'key'::bytea, 'bf'),<font></font>
decrypt(text2, 'key'::bytea, 'bf') from t2 limit 1000;"<font></font>
"host=192.168.220.129 dbname=taskdb user=postgres sslmode=disable" &gt; 2.txt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stopwatch is on. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;id | </font><font style="vertical-align: inherit;">decrypt | </font><font style="vertical-align: inherit;">decrypt </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----- + -------------- + ------------ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 1 | </font><font style="vertical-align: inherit;">\ x31 | </font><font style="vertical-align: inherit;">\ x31 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 2 | </font><font style="vertical-align: inherit;">\ x32 | </font><font style="vertical-align: inherit;">\ x32 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 3 | </font><font style="vertical-align: inherit;">\ x33 | </font><font style="vertical-align: inherit;">\ x33 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
999 | </font><font style="vertical-align: inherit;">\ x393939 | </font><font style="vertical-align: inherit;">\ x393939 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1000 | </font><font style="vertical-align: inherit;">\ x31303030 | </font><font style="vertical-align: inherit;">\ x31303030 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(1000 lines) </font></font><br>
<br>
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Time: 50.203 ms </font></font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test results</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td>&nbsp;</td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No encryption</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pgcrypto (decrypt)</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1000 row fetch</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,386 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50,203 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fifteen%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">35%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM</font></font></td>
<td>&nbsp;</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ 5%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encryption has a big impact on performance. </font><font style="vertical-align: inherit;">It can be seen that the timing has increased, since the operations of decrypting encrypted data (and decryption is usually still wrapped in your logic) require significant resources. </font><font style="vertical-align: inherit;">That is, the idea of ‚Äã‚Äãencrypting all columns containing some kind of data is fraught with reduced performance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, encryption is not a silver bullet that solves all issues. </font><font style="vertical-align: inherit;">The decrypted data and the decryption key in the process of decryption and data transfer are located on the server. </font><font style="vertical-align: inherit;">Therefore, keys can be intercepted by those who have full access to the database server, for example, a system administrator.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the whole column for all users has one key (even if not for all, but for a limited set of customers), this is not always good and right. </font><font style="vertical-align: inherit;">That is why they began to do end-to-end encryption, the DBMS began to consider options for encrypting data from the client and server, the same key-vault repositories appeared - separate products that provide key management on the DBMS side.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a97/d2d/cb2/a97d2dcb29c95253ff37b99f2bf1be40.png"></div><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of such encryption in MongoDB</font></font></i></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Security features in commercial and open source DBMS</font></font></h2><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Functions</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A type</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Password policy</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audit</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protecting source code for procedures and functions</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RLS</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encryption</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oracle</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commercial</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Msql</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commercial</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
</tr>
<tr>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jatoba</font></font></strong></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commercial</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extensions</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Free</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extensions</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extensions</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extensions</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mongodb</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Free</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Available in MongoDB Enterprise only</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The table is far from complete, but the situation is this: in commercial products, security problems have been solved for a long time, in open source, as a rule, some add-ons are used for security, many functions are not enough, sometimes you have to add something. For example, password policies - in PostgreSQL there are many different extensions ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) that implement password policies, but in my opinion, none of the needs of the domestic corporate segment are covered. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What to do if nowhere is what is needed</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? For example, I want to use a specific DBMS, in which there are no functions that the customer requires.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then you can use third-party solutions that work with different DBMSs, for example, ‚ÄúCrypto DB‚Äù or ‚ÄúGarda DB‚Äù. If we are talking about solutions from the domestic segment, then they know about GOSTs better than in open source. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second option is to write yourself what you need, implement data access and encryption in the application at the procedure level. True, with GOST it will be more difficult. But in general - you can hide the data as needed, put it in the DBMS, then get it and decrypt it as it should, right at the application level. At the same time, immediately think about how you will protect these algorithms on application. In our opinion, this should be done at the DBMS level, because it will work faster. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This talk was first made at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@Databases Meetup</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by Mail.ru Cloud Solutions. Watch the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/redirect%3Fq%3D"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">video</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other appearances and sign up for Telegram event announcements </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Around Kubernetes at Mail.ru Group</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What else to read on the topic</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More than Ceph: MCS Block Cloud Storage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to choose a database for the project, so as not to select again</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500696/index.html">How running shoes are trying to adapt to the female foot</a></li>
<li><a href="../en500698/index.html">Evgeny Katyshev: ‚ÄúOpenStreetMap is not suitable for any information‚Äù</a></li>
<li><a href="../en500700/index.html">Support for TLS1.3 and expansion of your personal account: what has been done for the first quarter of 2020</a></li>
<li><a href="../en500704/index.html">Unicorns (Airbnb, Uber, Lyft, Careem) lay off thousands of employees amid problems during the coronavirus pandemic</a></li>
<li><a href="../en500706/index.html">Upgrading MySQL (Percona Server) from 5.7 to 8.0</a></li>
<li><a href="../en500712/index.html">Digital Coronavirus - A Combination of Ransomware and Infostealer</a></li>
<li><a href="../en500718/index.html">EPAM in remote mode: how it works</a></li>
<li><a href="../en500720/index.html">New information security standards: make life more difficult for attackers</a></li>
<li><a href="../en500722/index.html">‚ÄúBake until ready‚Äù: who saves rare tape recordings in such an unusual way</a></li>
<li><a href="../en500724/index.html">How US financial authorities limit the negative impact of the game on the decline</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>