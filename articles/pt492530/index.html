<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç∑ ‚ÜñÔ∏è üïê MVVMs baseadas em combina√ß√£o nos aplicativos UIKit e SwiftUI para desenvolvedores do UIKit ‚úÇÔ∏è ü§ûüèø üòã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sabemos que ObservableObject classes com suas @Publishedpropriedades s√£o criadas Combineespecialmente para View Modelin SwiftUI. Mas exatamente o mesm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MVVMs baseadas em combina√ß√£o nos aplicativos UIKit e SwiftUI para desenvolvedores do UIKit</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492530/"><img src="https://habrastorage.org/webt/ku/lm/v5/kulmv5qftg5ynrc21jjj3rou7ro.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sabemos que </font></font><code>ObservableObjec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t classes com suas </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades s√£o criadas </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especialmente para </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mas exatamente o mesmo </font></font><code> View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode ser usado na </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementa√ß√£o da arquitetura&nbsp; </font></font><code>MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, embora neste caso tenhamos que "ligar" manualmente </font></font><code>bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos √†s </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades de </font></font><code>View Mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l. Voc√™ ficar√° surpreso, mas com a ajuda </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disso, algumas linhas de c√≥digo s√£o conclu√≠das. Al√©m disso, aderindo a essa ideologia ao projetar </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicativos, voc√™ posteriormente mudar√° sem problemas para </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O objetivo deste artigo √© mostrar com um exemplo primitivamente simples como voc√™ pode elegantemente implementar uma </font></font><code>MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquitetura </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com </font></font><code>&nbsp;Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Por outro lado, mostramos o uso do mesmo</font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O artigo discutir√° dois aplicativos simples que permitem selecionar </font><font style="vertical-align: inherit;">as informa√ß√µes meteorol√≥gicas mais recentes para uma cidade espec√≠fica </font><font style="vertical-align: inherit;">no site da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mas </font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um deles ser√° criado com o aplicativo </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e o outro com ajuda </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para o usu√°rio, esses aplicativos ter√£o a mesma apar√™ncia. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3r/2m/mo/3r2mmow1d4zuhf7a8gcaabv6adi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo est√° no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A interface do usu√°rio ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) conter√° apenas 2 </font></font><code>UI </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos: um campo de texto para inserir a cidade e um r√≥tulo para exibir a temperatura. A caixa de texto para entrar na cidade √© a entrada ativa ( </font></font><code>Input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) e o r√≥tulo de temperatura √© a sa√≠da passiva ( </font></font><code>Output</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).&nbsp;&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O papel </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">da arquitetura </font></font><code>MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© que leva a entrada (s) da </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ou </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), implementa a l√≥gica de neg√≥cios do aplicativo e passa as sa√≠das de volta para&nbsp; </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ou </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), possivelmente apresentando esses dados no formato desejado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Criando&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o importa que tipo de l√≥gica de neg√≥cios - s√≠ncrona ou ass√≠ncrona - √© muito simples se voc√™ usar uma </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe com suas </font></font><code> @Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades.</font></font><br>
<br>
<h2>   <code>API</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">OpenWeatherMap</a></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora o servi√ßo&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp; permita a sele√ß√£o de informa√ß√µes meteorol√≥gicas muito extensas, o Modelo dos dados em que estamos interessados ‚Äã‚Äãser√° muito simples, fornece informa√ß√µes detalhadas&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sobre o clima atual na cidade selecionada e est√° localizado no arquivo&nbsp; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Model.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nn/mk/bp/nnmkbpg0dfdnan0olkkx_amlwus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora nesta tarefa espec√≠fica estaremos interessados ‚Äã‚Äãapenas em temperatura </font></font><code>temp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que est√° na estrutura&nbsp; </font></font><code>Main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o Modelo fornece informa√ß√µes detalhadas completas sobre o clima atual como uma estrutura raiz&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, acreditando que no futuro voc√™ desejar√° expandir os recursos deste aplicativo. A estrutura </font></font><code>WeatherDetail&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© codific√°vel, isso nos permitir√° decodificar literalmente os </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados no modelo com </font><font style="vertical-align: inherit;">apenas duas linhas de c√≥digo&nbsp; </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A estrutura&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;tamb√©m deve ser</font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se desejarmos tornar mais f√°cil para n√≥s mesmos, no futuro, exibir uma s√©rie de previs√µes do tempo&nbsp; </font></font><code>[WeatherDetail]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;por v√°rios dias antes, na forma de uma lista&nbsp; </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;de </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Este tamb√©m √© um espa√ßo em branco para um futuro aplicativo meteorol√≥gico atual mais sofisticado. O protocolo </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requer a presen√ßa da propriedade </font></font><code> id,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que j√° possu√≠mos, portanto nenhum esfor√ßo adicional ser√° necess√°rio de n√≥s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geralmente, os servi√ßos, incluindo o servi√ßo&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , oferecem todos os tipos de servi√ßos </font></font><code>URLs </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para obter os recursos de que precisamos. O servi√ßo&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oferece-nos </font></font><code>URLs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para obter informa√ß√µes detalhadas sobre o tempo atual ou previs√£o de 5 dias em uma determinada cidade </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nesta aplica√ß√£o, estaremos interessados ‚Äã‚Äãapenas nas informa√ß√µes meteorol√≥gicas atuais e, neste caso,</font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculado usando a fun√ß√£o </font></font><code>absoluteURL (city: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i1/3i/ha/i13ihapejao-kzmclk5fz1k4vni.png"><br>
<br>
<code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;para o servi√ßo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">&nbsp;o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colocaremos no</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arquivo </font><i><font style="vertical-align: inherit;">WeatherAPI.swift</font></i><font style="vertical-align: inherit;"> . Sua parte central ser√° um m√©todo para selecionar informa√ß√µes meteorol√≥gicas detalhadas&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em uma cidade&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><code>fetchWeather (for city: String) -&gt; AnyPublisher&lt;WeatherDetail, Never&gt;</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No contexto da estrutura, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;esse m√©todo retorna n√£o apenas informa√ß√µes meteorol√≥gicas detalhadas&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas o "editor" correspondente </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nosso "editor" </font></font><code>AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o retorna nenhum erro - </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e se ainda ocorreu um erro de amostragem ou codifica√ß√£o, o representante retorna&nbsp; </font></font><code>WeatherDetail.placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem nenhuma mensagem adicional sobre a causa do erro.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere com mais detalhes o m√©todo&nbsp; </font></font><code>fetchWeather (for city: String) -&gt; AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que seleciona </font><font style="vertical-align: inherit;">&nbsp;informa√ß√µes meteorol√≥gicas detalhadas para a cidade </font><font style="vertical-align: inherit;">no site do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"></font><code>&nbsp;city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e n√£o retorna nenhum erro </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3h/am/tl/3hamtl2_qeyqozmtw3vnp6ezmeq.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com base no nome da cidade,&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;formamos </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;usando a fun√ß√£o </font></font><code>absoluteURL(city:city)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para solicitar informa√ß√µes detalhadas do tempo&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li> ¬´¬ª <code>dataTaskPublisher(for:)</code>,     <code>Output</code>   <code>(data: Data, response: URLResponse)</code>, &nbsp; <code>Failure</code>&nbsp;-&nbsp;<code>URLError</code>,</li>
<li>  <code>map { }</code>    (<code>data: Data, response: URLResponse) </code>    &nbsp;<code>data</code>,&nbsp;</li>
<li> <code>JSON </code>&nbsp;<code>data</code>   ,   &nbsp;<code>WeatherDetail</code>,     ,</li>
<li>  -     ¬´¬ª   &nbsp;<code>catch (error ... )</code>&nbsp;  ¬´¬ª <code>WeatherDetail.placeholder</code>,</li>
<li>  <code> main</code> ,          <code>UI</code>,</li>
<li>¬´¬ª  ¬´¬ª   <code>eraseToAnyPublisher()</code>    <code>AnyPublisher</code>.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O "publicador" ass√≠ncrono assim obtido </font></font><code>AnyPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"n√£o decola" por si s√≥; ele n√£o entrega nada at√© que algu√©m "assine". </font><font style="vertical-align: inherit;">Vamos us√°-lo em uma&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;classe que desempenha um papel </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ambos e </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criar modelo de vista</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para </font></font><code> View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criar uma classe muito simples&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que implementa um protocolo </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;com duas&nbsp; </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades: &nbsp;</font></font><br>
<br>
<img src="https://habrastorage.org/webt/db/gz/mt/dbgzmtbrpltinyd30ap_j6ykiok.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uma&nbsp; </font></font><code>@Published var city: String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© a cidade (voc√™ pode cham√°-la condicionalmente de ENTRADA, j√° que seu valor √© regulado pelo usu√°rio </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">),&nbsp;&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o segundo&nbsp; </font></font><code>@Published var currentWeather = WeatherDetail.placeholder </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o clima nesta cidade no momento (podemos chamar condicionalmente essa propriedade de EXIT, pois ela √© obtida buscando dados no site do&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de definir uma&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriedade&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, podemos come√ßar a us√°-la como uma propriedade simples&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e como uma "editora"&nbsp; </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em uma classe&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, voc√™ pode n√£o apenas declarar as propriedades de interesse para n√≥s, mas tamb√©m prescrever a l√≥gica de neg√≥cios de sua intera√ß√£o. Para esse fim, ao inicializar uma inst√¢ncia de classe&nbsp; </font></font><code>TempViewModel&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em, </font></font><code>init?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podemos criar uma "assinatura" que funcionar√° durante todo o "ciclo de vida" da inst√¢ncia de classe&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e reproduzir√° a depend√™ncia do clima atual&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;na cidade&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estendemos a cadeia do "editor" de entrada para o "editor" </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;de sa√≠da </font></font><code>AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cujo valor √© o clima atual. Posteriormente, n√≥s "assinamos" com a ajuda de um "assinante"&nbsp;</font></font><code>assign (to: \.currentWeather, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e obtenha o valor desejado do clima atual&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;como uma </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriedade de </font><font style="vertical-align: inherit;">"sa√≠da"&nbsp; </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s devemos puxar a cadeia N√ÉO simplesmente das propriedades </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja, dos "editores" </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que participar√£o da cria√ß√£o </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e √© a√≠ que a mudaremos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como faremos isso? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° temos uma fun√ß√£o em nosso arsenal </font></font><code> fetchWeather (for city: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que est√° na classe&nbsp; </font></font><code>WeatherAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e retorna o ‚Äúpublicador‚Äù </font></font><code>AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;com informa√ß√µes detalhadas do tempo, dependendo da cidade&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e s√≥ podemos de alguma forma usar o valor do ‚Äúpublicador‚Äù&nbsp; </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para transform√°-lo em argumento dessa fun√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;V√° para o editor certo&nbsp; </font></font><code>fetchWeather (for city: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;para&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nos ajudar na operadora&nbsp; </font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wz/1r/9j/wz1r9juemdlcse18ko2k4xcvgcs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Operadora</font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cria um novo "editor" com base nos dados recebidos do "editor" anterior. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, n√≥s "assinamos" este "editor" rec√©m-recebido com a ajuda de um "assinante" muito simples&nbsp; </font></font><code>assign (to: \.currentWeather, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e atribu√≠mos o valor recebido do "editor" √† </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedade&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/ug/yt/ygugytbie7fl6ezfiala6jn-p9o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acabamos de criar um </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editor" ASS√çNCRONO e um "assinante", resultando em uma </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"assinatura" " </font></font><br>
<br>
<code>AnyCancellable </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A "assinatura" permite que o chamador cancele a "assinatura" a qualquer momento e n√£o receba mais valores do "editor", mas al√©m disso, assim que a </font></font><code>&nbsp;AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"assinatura" sair do seu escopo, a mem√≥ria ocupada pelo "editor" √© liberada. Portanto, assim que for </font></font><code>init( ) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conclu√≠da, essa "assinatura" ser√° exclu√≠da pelo sistema&nbsp;</font></font><code>ARC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e sem tempo para atribuir as informa√ß√µes ass√≠ncronas sobre o clima atual recebido com um atraso de tempo&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para salvar essa ‚Äúassinatura‚Äù, √© necess√°rio criar uma </font></font><code>init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel </font><font style="vertical-align: inherit;">OUTSIDE </font></font><code>var&nbsp;cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que manter√° nossa </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúassinatura‚Äù nessa vari√°vel durante todo o ‚Äúciclo de vida‚Äù da inst√¢ncia da classe&nbsp; </font></font><code>TempViewMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"assinatura" na vari√°vel </font><font style="vertical-align: inherit;">
√© armazenada </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando o operador&nbsp; </font></font><code>store ( in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dq/xh/y9/dqxhy9d4lnobqznxdlhx_lt83k4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado, a "assinatura" ser√° preservada durante todo o "ciclo de vida" da inst√¢ncia da classe&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Podemos alterar o valor do editor conforme desejado </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e o clima atual </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;para esta cidade </font><font style="vertical-align: inherit;">estar√° sempre √† nossa disposi√ß√£o </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para reduzir o n√∫mero de chamadas do servidor ao digitar uma cidade&nbsp;</font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, n√£o devemos usar diretamente o "publicador" da linha com o nome da cidade&nbsp; </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas sua vers√£o modificada com operadores </font></font><code>debounce</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>removeDuplicates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ho/m9/ho/hom9ho7cbdou92ol4fd6dizlqd4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O operador √©&nbsp; </font></font><code>debounce</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;usado para aguardar at√© que o usu√°rio termine de digitar as informa√ß√µes necess√°rias no teclado e s√≥ ent√£o execute a tarefa com muitos recursos uma vez. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da mesma forma, um operador </font></font><code>removeDuplicates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publicar√° valores somente se eles diferirem de quaisquer valores anteriores. </font><font style="vertical-align: inherit;">Por exemplo, se o usu√°rio entrar pela primeira </font></font><code>john</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vez </font></font><code>joe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e depois novamente </font></font><code>john</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, receberemos </font></font><code>john</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apenas uma vez. </font><font style="vertical-align: inherit;">Isso ajuda a tornar a nossa </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mais eficiente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando uma interface do usu√°rio com o SwiftUI</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora que temos </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">vamos </font><font style="vertical-align: inherit;">come√ßar </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Primeiro em </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e depois em </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao </font></font><code>Xcode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criarmos um novo projeto com </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e na estrutura resultante, </font></font><code>ContentView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp; colocamos o nosso&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como uma </font></font><code> @ObservedObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel </font></font><code>model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Substitua&nbsp; </font></font><code>Text ("Hello, World!") </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pelo t√≠tulo&nbsp; </font></font><code>Text ("WeatherApp")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, adicione uma caixa de texto para inserir a cidade&nbsp; </font></font><code>TextField ("City", text: self.$model.city)&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e um r√≥tulo para exibir a temperatura: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/oc/si/zzocsimzbd7bpssf_-ckigkggdi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usamos diretamente os valores de nossa vari√°vel </font></font><code>model:&nbsp;TempViewModel()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Usamos na caixa de texto para entrar na cidade </font></font><code>$model.city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e no r√≥tulo para exibir a temperatura - </font></font><code>model.currentWeather.main?.temp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, quaisquer altera√ß√µes nas&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriedades levar√£o a "redesenho" </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sd/jx/uk/sdjxukkrljf2xfbo944koyt4ee4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© garantido pelo fato de que a nossa </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©</font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja, √© realizada a "liga√ß√£o" AUTOM√ÅTICA ( </font></font><code>binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de nossas propriedades </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e elementos da interface do usu√°rio ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Essa "liga√ß√£o" AUTOM√ÅTICA s√≥ √© poss√≠vel em </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando uma interface do usu√°rio com o UIKit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que fazer com isso </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">N√£o est√° l√°&nbsp;  </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Em&nbsp; </font></font><code>UIKit </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">executaremos a "liga√ß√£o" ( </font></font><code>binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) manualmente. </font><font style="vertical-align: inherit;">H√° muitas maneiras de fazer essa "liga√ß√£o manual":</font></font><br>
<br>
<ul>
<li><code>Key-Value Observing </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>KVO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: um mecanismo para&nbsp; </font></font><code>key paths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monitorar uma propriedade e receber uma notifica√ß√£o de que ela foi alterada.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programa√ß√£o reativa funcional ou </font></font><code>FRP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: uso de uma estrutura </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><code>Delegation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Usando m√©todos delegados para enviar uma notifica√ß√£o de que um valor da propriedade foi alterado.</font></font></li>
<li><code>Boxing</code>:    <code>didSet { }</code>    ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado o t√≠tulo do artigo, trabalharemos naturalmente no campo </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. No </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicativo, mostraremos como √© f√°cil criar "encaderna√ß√£o manual" </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicativo, tamb√©m teremos dois </font></font><code>UI </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos: </font></font><code>UITextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para entrar na cidade e </font></font><code> UILabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exibir a temperatura. Em </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√≥s, naturalmente, ter√° </font></font><code>Outlet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estes elementos: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/_w/xs/dc_wxscdvx2gfvhkzpn2sppn_k8.png"><br>
<br>
<img src="https://habrastorage.org/webt/dp/hi/du/dphidu2qg7ym1bn1sorekv0opts.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sob a forma de uma vari√°vel comum </font></font><code>viewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, temos o mesmo que </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na se√ß√£o anterior: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/py/lr/n1/pylrn1luepommf97vwrthhyz3oy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de fazer o ‚ÄúManual de liga√ß√£o‚Äù com </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vamos fazer o campo de texto </font></font><code>UITextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nosso aliado e ‚Äúpublisher‚Äù do nosso conte√∫do </font></font><code>text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z0/dn/wg/z0dnwgxqkqam7mcy8qbyo6ajvx4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso nos permitir√° </font></font><code>viewDidLoad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementar </font><font style="vertical-align: inherit;">muito facilmente </font><font style="vertical-align: inherit;">‚Äúencaderna√ß√£o manual‚Äù usando a fun√ß√£o</font></font><code>binding ()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q0/qu/-f/q0qu-ftfjqr_giedbnah50cwe2m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, n√≥s ‚Äúsubscribe‚Äù para o ‚Äúpublisher‚Äù </font></font><code> cityTextField.textPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando um ‚Äúassinante‚Äù muito simples&nbsp; </font></font><code>assign (to: \.city, on: viewModel)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e atribuir o texto digitado pelo usu√°rio na caixa de texto </font></font><code>cityTextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para o nosso ‚Äúinput‚Äù&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de propriedade de </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nosso </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, fazemos altera√ß√µes em outra dire√ß√£o: ‚Äúassinamos‚Äù a </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedade&nbsp; </font><font style="vertical-align: inherit;">‚Äúoutput‚Äù&nbsp; </font></font><code>$currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;com a ajuda do ‚Äúassinante‚Äù </font></font><code>sink </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e seu fechamento </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, formamos o valor da temperatura e atribu√≠mos √† etiqueta </font></font><code> temperatureLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recebido na&nbsp; </font></font><code>viewDidLoad&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"assinatura" √© armazenado em uma vari√°vel </font></font><code>var&nbsp;cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Depois de cri√°-los uma vez, permitimos que eles ajam durante todo o ‚Äúciclo de vida‚Äù da inst√¢ncia da classe </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e em conjunto com a ‚Äúassinatura‚Äù em nossa&nbsp;</font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementar toda a l√≥gica de neg√≥cios do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A prop√≥sito, o protocolo </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o funciona </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas n√£o interfere. </font></font><code>UIKit </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">completamente indiferente ao protocolo </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, em princ√≠pio, poderia ser removido&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as </font></font><code>UIKit </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplica√ß√µes: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wp/fs/pi/wpfspirlf9jp-e2magbcorvzany.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas n√£o vamos fazer isso, j√° que queremos mant√™-lo inalterado </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para o aplicativo atual na </font></font><code> UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e para, possivelmente, futuras aplica√ß√µes em </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© tudo. O c√≥digo est√° no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conclus√£o </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma estrutura reativa funcional </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permite implementar de maneira muito simples e concisa a </font></font><code> MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquitetura </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e na forma de c√≥digo compreens√≠vel e leg√≠vel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Links: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combinar + UIKit + MVVM</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tutorial do </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Combine </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">iOS MVVM: Refatorando do MVC </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MVVM com o Tutorial do Combine para iOS</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS Se voc√™ quiser ver algumas informa√ß√µes sobre o clima, √© necess√°rio se registrar no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;e obter </font></font><code> API key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Esse processo n√£o levar√° mais de 2 minutos.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492514/index.html">Como estabelecer um fluxo de documentos eletr√¥nicos juridicamente significativo de contrapartes na R√∫ssia e no Cazaquist√£o?</a></li>
<li><a href="../pt492518/index.html">O surto de v√≠rus requer trabalho remoto, o que significa assinatura digital de documentos</a></li>
<li><a href="../pt492520/index.html">Modelagem 3D parametrizada do copo do rolamento no nanoCAD Plus 20</a></li>
<li><a href="../pt492522/index.html">Comunica√ß√£o de equipe remota</a></li>
<li><a href="../pt492524/index.html">Como ganhei US $ 1.000.000 sem experi√™ncia e conex√µes e os gastei para fazer meu tradutor</a></li>
<li><a href="../pt492534/index.html">Ent√£o, existem furac√µes reais em Moscou ou n√£o? Analisamos o caso de 13 de mar√ßo de 2020 em persegui√ß√£o</a></li>
<li><a href="../pt492538/index.html">Wrike TechClub: Infraestrutura de entrega - processos e ferramentas (DevOps + QAA). Artigos em ingl√™s</a></li>
<li><a href="../pt492540/index.html">O jogo "Espere um momento!" no arduino</a></li>
<li><a href="../pt492546/index.html">Verificando a vulnerabilidade de qualquer site usando o Nikto</a></li>
<li><a href="../pt492548/index.html">Unity Machine Learning: ensinando agentes do MO a pular muros</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>