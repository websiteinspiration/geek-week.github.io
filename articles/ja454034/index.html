<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤲🏽 🛩️ 🤢 最初のモデル：ファッションMNISTデータセット 🧒🏿 👨🏽‍🔬 👉🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ロシア語の完全なコースはこのリンクで見つけることができます。
 元の英語コースはこのリンクから入手できます。
 
 新しい講義は2〜3日ごとに予定されています。
 
 Udacity CEO、Sebastian Trunへのインタビュー
 -それで、私たちは再びあなたと私たちと一緒に、まだセバスチャ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>最初のモデル：ファッションMNISTデータセット</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454034/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロシア語の完全なコースは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このリンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で見つけることができます</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元の英語コースは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このリンクから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入手できます</font><font style="vertical-align: inherit;">。</font></font><br>
<img src="https://habrastorage.org/webt/ry/3a/55/ry3a55ljajwq9gp5jwwhztrxyxo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい講義は2〜3日ごとに予定されています。</font></font></i><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Udacity CEO、Sebastian Trunへのインタビュー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -それで、私たちは再びあなたと私たちと一緒に、まだセバスチャンです。ここでは、完全に接続されたレイヤー、つまり同じ高密度レイヤーについて説明します。その前に、一つ質問させていただきます。ディープラーニングの妨げとなり、今後10年間で最も大きな影響を与える境界と主な障害は何ですか？すべてが非常に速く変化します！次の「大きなこと」は何だと思いますか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -二つ言ってみます。 1つは、複数のタスクのためのGeneral AIです。これは素晴らしい！人々は複数の問題を解決できるため、同じことをしてはいけません。 2つ目は、テクノロジーを市場に投入することです。私にとって、機械学習の特徴は、コンピューターにデータのパターンを観察および発見する機能を提供し、専門家レベルで人々がフィールドで最高になるのを助けることです！機械学習は、法律、医学、自動運転車で使用できます。そのようなアプリケーションを開発すると、莫大な金額をもたらす可能性がありますが、最も重要なのは、世界をより良い場所にする機会があることです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 「私は、ディープラーニングとそのアプリケーションの全体像を1つにまとめる方法が本当に気に入っています。これは、特定の問題を解決するのに役立つツールにすぎません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - はい、正確に！素晴らしいツールですよね？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -はい、はい、私はあなたに完全に同意します！</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 「ほとんど人間の脳のようです！」</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ビデオコースの最初の部分で、最初のインタビューで医療アプリケーションについて言及しました。あなたの意見では、ディープラーニングの使用はどのアプリケーションで最も喜びと驚きですか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - 沢山の！非常に！医学は、ディープラーニングを積極的に使用する分野のリストに含まれています。数か月前に妹を亡くしましたが、彼女は癌で病気でした。これはとても悲しいことです。早期に発見できる病気はたくさんあると思います-初期の段階では、病気を治したり、その進行を遅らせることができます。実際には、いくつかの器具を家（スマートホーム）に移すという考え方です。そのため、このような健康の逸脱を、本人がそれらを見る瞬間のずっと前に検出することができます。私はまた追加します-すべてが繰り返されます、あなたが同じタイプのアクションを何度も何度も実行する事務作業、たとえば簿記。私もCEOとして、多くの反復的な行動をとります。それらを自動化することは素晴らしいことですメール対応も！</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -私はあなたに反対することはできません！このレッスンでは、高密度層と呼ばれるニューラルネットワーク層を備えたコースを学生に紹介します。完全に接続されたレイヤーについて、どう思いますか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -それでは、各ネットワークが異なる方法で接続できるという事実から始めましょう。それらの一部は非常に緊密な接続性を持っている可能性があり、これによりスケーリングからいくつかの利点を得て、大規模ネットワークに対して「勝つ」ことができます。必要な接続の数がわからない場合があるため、すべてをすべてに接続します。これは完全接続レイヤーと呼ばれます。このアプローチは、より構造化されたものよりもはるかに多くの力と可能性を持っていると付け加えます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - まったく同感です！</font><font style="vertical-align: inherit;">完全に接続されたレイヤーについてもう少し学ぶのを助けてくれてありがとう。</font><font style="vertical-align: inherit;">ようやく実装してコードを書いていくのが楽しみです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - 楽しい！</font><font style="vertical-align: inherit;">本当に楽しいでしょう！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - お帰りなさい！</font><font style="vertical-align: inherit;">前のレッスンでは、TensorFlowとKerasを使用して最初のニューラルネットワークを構築する方法、ニューラルネットワークのしくみ、トレーニング（トレーニング）プロセスのしくみを理解しました。</font><font style="vertical-align: inherit;">特に、摂氏を華氏に変換するモデルをトレーニングする方法を見ました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7h/jc/jq/7hjcjqzg5rz1qzpbncjes5ipor8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -また、ニューラルネットワークで最も重要なレイヤーである完全に接続されたレイヤー（高密度レイヤー）の概念についても理解しました。しかし、このレッスンでは、もっとクールなことをします！このレッスンでは、衣服の要素と画像を認識できるニューラルネットワークを開発します。前述したように、機械学習は「特徴」と呼ばれる入力と「ラベル」と呼ばれる出力を使用して、モデルが変換アルゴリズムを学習および検出します。したがって、最初に、衣服のさまざまな要素を認識するようにニューラルネットワークをトレーニングする多くの例が必要になります。トレーニングの例は、ニューラルネットワークの入力に供給される値のペア（入力フィーチャと出力ラベル）であることを思い出してください。新しい例では、入力は画像です。また、出力ラベルは、写真に示されている衣料品が属する衣料品のカテゴリである必要があります。幸い、そのようなデータセットはすでに存在しています。それはファッションMNISTと呼ばれています。このデータセットについては、次のパートで詳しく見ていきます。</font></font><br>
<br>
<h2>  Fashion MNIST</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MNISTデータセットの世界へようこそ！したがって、私たちのセットは28x28の画像で構成され、各ピクセルは灰色の濃淡を表します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ua/mr/f6/uamrf6n8gci7qi2c1t_ganxtai8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセットには、Tシャツ、トップス、サンダル、さらにはブーツの画像が含まれています。以下に、MNISTデータセットに含まれる内容の完全なリストを示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3i/ce/7n/3ice7nwlkok2g_n-trodker5s7e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各入力画像には、上記のラベルのいずれかがあります。 Fashion MNISTデータセットには70,000枚の画像が含まれているため、作業を開始する場所があります。これらの70,000のうち、60,000を使用してニューラルネットワークをトレーニングします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4b/ur/60/4bur602odizkfsdpt0fds-3fnxk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、残りの10,000個の要素を使用して、ニューラルネットワークが衣服の要素を認識することをどれだけ学んだかを確認します。後で、データセットをトレーニングセットとテストセットに分割した理由について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが私たちのファッションMNISTデータセットです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mx/lw/dz/mxlwdzjrfhviwmgsliwdcy6tbwq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセット内の各画像は、グレーシェードのサイズ28x28の画像であることを忘れないでください。つまり、各画像のサイズは784バイトです。</font><font style="vertical-align: inherit;">私たちのタスクは、入力でこれらの784バイトを受け取るニューラルネットワークを作成し、出力で、利用可能な10のうち服のどのカテゴリに戻り、入力で適用された要素が属するかです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">神経網</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレッスンでは、ファッションMNISTデータセットから画像を分類することを学習するディープニューラルネットワークを使用します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xg/cr/h_/xgcrh_cowdhfz-owx34wp-kqzi0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上の画像は、ニューラルネットワークがどのようになるかを示しています。より詳しく見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニューラルネットワークの入力値は、長さが784の1次元配列です。これは、各画像が28x28ピクセル（画像全体で784ピクセル）であるため、その長さの配列であり、1次元配列に変換します。 2D画像をベクトルに変換するプロセスはフラット化と呼ばれ、平滑化レイヤー（フラット化レイヤー）を介して実装されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7d/wu/d_/7dwud_tt2qctnaigzc8my3pz1j0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
適切なレイヤーを作成してスムージングを実行できます。</font></font><br>
<br>
<pre><code class="python hljs">tf.keras.layers.Flatten(input_shape=[<span class="hljs-number">28</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレイヤーは、28x28ピクセルの2D画像（1ピクセルあたりのグレーシェードに1バイト）を784ピクセルの1D配列に変換します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力値は</font></font><code>dense</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、128ニューロンに等しいサイズを選択した</font><font style="vertical-align: inherit;">最初の</font><font style="vertical-align: inherit;">ネットワーク層に</font><font style="vertical-align: inherit;">完全に関連付けられます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mk/n_/3w/mkn_3wrocxruhbwhil0fmh5wh_8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードでのこのレイヤーの作成は次のようになります。</font></font><br>
<br>
<pre><code class="python hljs">tf.keras.layers.Dense(<span class="hljs-number">128</span>, activation=tf.nn.relu)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
やめる！これは一体何な</font></font><code>tf.nn.relu</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">んだ？前のニューラルネットワークの例では、摂氏を華氏に変換するときにこれを使用しませんでした。一番下の行は、現在のタスクは、オリエンテーションの例として使用されたタスクよりもはるかに複雑であることです。摂氏を華氏に変換します。</font></font><br>
<br>
<code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全に接続されたレイヤーに追加する数学関数であり、ネットワークにより多くの力を与えます。実際、これは完全に接続されたレイヤーの小さな拡張であり、ニューラルネットワークがより複雑な問題を解決できるようにします。詳細には触れませんが、もう少し詳細な情報を以下に示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、最後の層は出力層とも呼ばれ、10個のニューロンで構成されています。私たちのファッションMNISTデータセットには10​​個の衣料品カテゴリが含まれているため、10個のニューロンで構成されています。これらの10個の出力値のそれぞれは、入力画像がこの衣服カテゴリに含まれる可能性を表しています。言い換えれば、これらの値は、出力の10の衣服カテゴリーのうちの特定のフィールド化された画像と予測の正確さおよび相関関係におけるモデルの「信頼度」を反映しています。たとえば、画像がドレス、スニーカー、靴などを示している可能性はどのくらいですか。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fo/2b/3v/fo2b3vakws6ubmiwtj9rrctltla.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、シャツの画像がニューラルネットワークの入力に送信された場合、モデルは上の画像のような結果、つまり入力画像が出力ラベルと一致する確率を提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意を払うと、最大の確率-0.85がシャツに対応するタグ6を参照していることがわかります。モデルは85％シャツのイメージを確実にしています。通常、シャツのように見えるものは高い確率評価を持ち、類似性が最も低いものは最も低い確率評価を持ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10個の出力値はすべて確率に対応するため、これらの値をすべて合計すると1になります。これらの10個の値は、確率分布とも呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、各ラベルの確率を計算するための出力レイヤーが必要です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v5/tt/hk/v5tthkilik-9reer8owxjpv-x3m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これを次のコマンドで行います：</font></font><br>
<br>
<pre><code class="python hljs">tf.keras.layers.Dense(<span class="hljs-number">10</span>, activation=tf.nn.softmax)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、分類の問題を解決するニューラルネットワークを作成するときは常に、常に完全に接続されたレイヤーをニューラルネットワークの最後のレイヤーとして使用します。</font><font style="vertical-align: inherit;">ニューラルネットワークの最後の層には、クラスの数と同じ数のニューロンが含まれている必要があります。クラスのメンバーシップは、</font></font><code>softmax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクティベーション関数</font><font style="vertical-align: inherit;">を決定して使用し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h3><code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ニューロン活性化機能</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレッスンでは</font></font><code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ニューラルネットワークの機能を拡張し、追加の機能を提供する方法</font><font style="vertical-align: inherit;">について</font><font style="vertical-align: inherit;">説明しました。</font></font><br>
<br>
<code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のような数学関数</font><font style="vertical-align: inherit;">です。入力値が負の値またはゼロの場合、</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/691/c04/e7b/691c04e7b270706458daf61c4b38cf22.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数</font></font><code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は0を返します。それ以外の場合はすべて、関数は元の入力値を返します。</font></font><br>
<br>
<code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非線形問題を解くことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
摂氏度から華氏度への変換</font></font><code>f = 1.8*c + 32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、式が直線の方程式である</font><font style="vertical-align: inherit;">ため、線形タスクです</font><font style="vertical-align: inherit;">- </font></font><code>y = m*x + b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。しかし、解決したいタスクのほとんどは非線形です。そのような場合、完全に接続されたレイヤーにReLUアクティベーション機能を追加すると、そのようなタスクに対処するのに役立ちます。</font></font><br>
<br>
<code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1種類のアクティベーション関数だけです。</font><font style="vertical-align: inherit;">シグモイド、ReLU、ELU、tanhなどのアクティベーション関数がありますが</font></font><code>ReLU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、デフォルトのアクティベーション関数として最もよく使用されます。</font><font style="vertical-align: inherit;">ReLUを含むモデルを作成して使用するために、内部でどのように機能するかを理解する必要はありません。</font><font style="vertical-align: inherit;">それでも理解を深めたい場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をお勧め</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">します</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレッスンで導入された新しい用語について見ていきましょう。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平滑化-2D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像を1Dベクトルに変換するプロセス。</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReLU</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、モデルが非線形問題を解決できるようにするアクティベーション関数です。</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Softmax-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能な各出力クラスの確率を計算する関数。</font></font></li>
<li><b></b> —              ().</li>
</ul><br>
<h2>  </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデル、つまり機械学習の任意のモデルをトレーニングする場合、データセットを少なくとも2つの異なるセット（トレーニングに使用されるデータセットとテストに使用されるデータセット）に分割する必要があります。この部分では、これを行う価値がある理由を理解します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
70,000部からなるFashion MNISTからデータセットを配布した方法を思い出してみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4b/ur/60/4bur602odizkfsdpt0fds-3fnxk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
70,000を2つの部分に分割することを提案しました。最初の部分ではトレーニング用に60,000を残し、2番目の部分ではテスト用に10,000を残しました。このアプローチの必要性は、次の事実によって引き起こされます。モデルが60,000コピーでトレーニングされた後、モデルがトレーニングされたデータセットにまだ含まれていない例について、その結果とその効果を確認する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独自の方法で、それは学校で試験に合格することに似ています。試験に合格する前に、特定のクラスの問題の解決に熱心に取り組んでいます。次に、試験では、同じ種類の問題に遭遇しますが、入力データは異なります。トレーニング中と同じデータを送信しても意味がありません。そうでない場合、タスクは決定を覚えるだけになり、ソリューションモデルを検索しません。そのため、試験ではこれまでカリキュラムになかった課題に直面します。この方法でのみ、モデルが一般的なソリューションを学習したかどうかを検証できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機械学習でも同じことが起こります。解決方法を学びたい特定のクラスのタスクを表すいくつかのデータを表示します。今回のケースでは、Fashion MNISTからのデータセットを使用して、画像内の衣料要素が属するカテゴリをニューラルネットワークで特定できるようにします。これが、すべてのカテゴリの衣料品を含む60,000の例でモデルをトレーニングする理由です。トレーニング後、モデルの有効性を確認したいので、モデルがまだ「見ていない」残りの10,000アイテムの衣類を供給します。これを行わず、10,000の例でテストを行わない場合、モデルが実際に衣料品のクラスを決定するようにトレーニングされているかどうか、または入力値と出力値のすべてのペアを覚えているかどうかを確実に判断することはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、機械学習では常に学習用のデータセットとテスト用のデータセットを用意しています。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TensorFlow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、すぐに使用できるトレーニングデータのコレクションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセットは通常、いくつかのブロックに分割されており、各ブロックは、ニューラルネットワークの有効性のトレーニングとテストの特定の段階で使用されます。</font><font style="vertical-align: inherit;">この部分では、以下について説明します。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニングデータセット</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ニューラルネットワークのトレーニング用に設計されたデータセット。</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストデータセット</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ニューラルネットワークの効率を検証するために設計されたデータセット。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検証データセットと呼ぶ別のデータセットについて考えてみましょう。</font><font style="vertical-align: inherit;">このデータセットは</font><font style="vertical-align: inherit;">モデルの</font><font style="vertical-align: inherit;">トレーニングに</font><font style="vertical-align: inherit;">は使用さ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ず</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニング</font><b><font style="vertical-align: inherit;">中</font></b><font style="vertical-align: inherit;">にのみ</font><font style="vertical-align: inherit;">使用さ</font><b><font style="vertical-align: inherit;">れ</font></b><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">したがって、モデルがいくつかのトレーニングサイクルを経た後、テストデータセットにモデルをフィードして、結果を確認します。</font><font style="vertical-align: inherit;">たとえば、トレーニング中に損失関数の値が減少し、テストデータセットの精度が低下する場合、これは、モデルが単純に入出力値のペアを記憶していることを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検証データセットはトレーニングの最後に再利用され、モデル予測の最終的な精度を測定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Googleのクラッシュコースでのトレーニングとテストデータセットの詳細を読むことができます。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CoLabの実際の部分</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">英語の元のCoLabへの</font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンクとロシアのCoLabへ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">リンク</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">衣料品の画像の分類</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レッスンのこの部分では、ニューラルネットワークを構築してトレーニングし、ドレス、スニーカー、シャツ、Tシャツなどの衣類要素の画像を分類します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はっきりしない瞬間があっても大丈夫です。</font><font style="vertical-align: inherit;">このコースの目的は、実装の詳細を掘り下げるのではなく、TensorFlowを紹介すると同時に、その作業のアルゴリズムを説明し、TensorFlowを使用するプロジェクトの一般的な理解を深めることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパートでは</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、TensorFlowでモデルを構築およびトレーニングするために高レベルAPI </font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">依存関係のインストールとインポート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数のサービスによって提供されるデータセットの読み込みとアクセスを簡素化するAPIで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あるTensorFlowデータセット</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
が必要</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">また、いくつかの補助ライブラリも必要です。</font></font><br>
<br>
<pre><code class="python hljs">!pip install -U tensorflow_datasets
</code></pre><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> absolute_import, division, print_function, unicode_literals<font></font>
<font></font>
<span class="hljs-comment">#  TensorFlow    TensorFlow</span>
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">import</span> tensorflow_datasets <span class="hljs-keyword">as</span> tfds<font></font>
tf.logging.set_verbosity(tf.logging.ERROR)<font></font>
<font></font>
<span class="hljs-comment">#  </span>
<span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<font></font>
<font></font>
<span class="hljs-comment">#   </span>
<span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> tqdm.auto<font></font>
tqdm.tqdm = tqdm.auto.tqdm<font></font>
<font></font>
print(tf.__version__)<font></font>
<font></font>
tf.enable_eager_execution()<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fashion MNISTデータセットをインポートする</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、ファッションMNISTデータセットを使用しています。このデータセットには、10のカテゴリの70,000枚の衣料品の画像がグレースケールで含まれています。</font><font style="vertical-align: inherit;">以下に示すように、画像には低解像度（28x28ピクセル）の衣料品が含まれています。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/18d/2c1/da3/18d2c1da3b5c7dbff14ea81077d9ed24.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファッションMNISTは、クラシックMNISTデータセットの代わりに使用されます。</font><font style="vertical-align: inherit;">機械学習とコンピュータビジョンの分野で。</font><font style="vertical-align: inherit;">MNISTデータセットには、この例の衣料品と同じ形式で手書きの数字（0、1、2など）の画像が含まれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、ファッションのMNISTを使用しています。これは、MNISTデータセットの一般的な問題を解決するよりも、実装の観点からこのタスクの方が興味深いためです。</font><font style="vertical-align: inherit;">どちらのデータセットも十分に小さいため、アルゴリズムの正しい操作性を検証するために使用されます。</font><font style="vertical-align: inherit;">機械学習、テスト、およびデバッグコードの学習を開始するための優れたデータセット。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
60,000枚の画像を使用してネットワークをトレーニングし、10,000枚の画像を使用してトレーニングと画像分類の精度をテストします。</font><font style="vertical-align: inherit;">APIを使用してTensorFlowを介してFashion MNISTデータセットに直接アクセスできます。</font></font><br>
<br>
<pre><code class="python hljs">dataset, metadata = tfds.load(<span class="hljs-string">'fashion_mnist'</span>, as_supervised=<span class="hljs-literal">True</span>, with_info=<span class="hljs-literal">True</span>)<font></font>
train_dataset, test_dataset = dataset[<span class="hljs-string">'train'</span>], dataset[<span class="hljs-string">'test'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセットを読み込むことにより、メタデータ、トレーニングデータセット、テストデータセットを取得します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルは「train_dataset」のデータセットでトレーニングされます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルは「test_dataset」のデータセットでテストされます</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像は2次元配列</font></font><code>2828</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、各セルの値は範囲内にあります</font></font><code>[0, 255]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ラベルは、各値が範囲内にある整数の配列です</font></font><code>[0, 9]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらのラベルは、次のように出力画像クラスに対応します。</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラベル</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tシャツ/トップス</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ショーツ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セーター</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">３</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドレス</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マント</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンダル</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャツ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スニーカー</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッグ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブート</font></font></td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各画像は1つのタグを参照します。</font><font style="vertical-align: inherit;">クラス名は元のデータセットに含まれていないので、画像を描画するときに後で使用できるように保存しておきましょう。</font></font><br>
<br>
<pre><code class="python hljs">class_names = [<span class="hljs-string">' / '</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>,
              <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>,
              <span class="hljs-string">""</span>]
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データを研究</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルをトレーニングする前に、トレーニングセットで提示されるデータの形式と構造を調べてみましょう。</font><font style="vertical-align: inherit;">次のコードは、60,000の画像がトレーニングデータセットにあり、10,000の画像がテストデータセットにあることを示しています。</font></font><br>
<br>
<pre><code class="python hljs">num_train_examples = metadata.splits[<span class="hljs-string">'train'</span>].num_examples<font></font>
num_test_examples = metadata.splits[<span class="hljs-string">'test'</span>].num_examples<font></font>
print(<span class="hljs-string">'  : {}'</span>.format(num_train_examples))<font></font>
print(<span class="hljs-string">'  : {}'</span>.format(num_test_examples))
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データの前処理</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像内の各ピクセルの値は範囲内</font></font><code>[0,255]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">モデルが正しく機能するためには、これらの値を正規化する必要があります-間隔内の値に減らします</font></font><code>[0,1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">したがって、少し下では、正規化関数を宣言して実装し、トレーニングおよびテストデータセットの各画像に適用します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">normalize</span>(<span class="hljs-params">images, labels</span>):</span><font></font>
  images = tf.cast(images, tf.float32)<font></font>
  images /= <span class="hljs-number">255</span>
  <span class="hljs-keyword">return</span> images, labels<font></font>
<font></font>
<span class="hljs-comment">#  map        </span>
<span class="hljs-comment">#     </span><font></font>
train_dataset = train_dataset.map(normalize)<font></font>
test_dataset = test_dataset.map(normalize)<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">処理されたデータを調査します</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像を描いて見てみましょう。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#         </span>
<span class="hljs-comment">#   reshape()</span>
<span class="hljs-keyword">for</span> image, label <span class="hljs-keyword">in</span> test_dataset.take(<span class="hljs-number">1</span>):
  <span class="hljs-keyword">break</span>;<font></font>
image = image.numpy().reshape((<span class="hljs-number">28</span>, <span class="hljs-number">28</span>))<font></font>
<font></font>
<span class="hljs-comment">#  </span><font></font>
plt.figure()<font></font>
plt.imshow(image, cmap=plt.cm.binary)<font></font>
plt.colorbar()<font></font>
plt.grid(<span class="hljs-literal">False</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/ce/se/hw/cesehwjbca_ol0s1dcpxnaxyu2i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングデータセットの最初の25個の画像を表示し、各画像の下に、それが属するクラスを示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データが正しい形式であることを確認し、ネットワークの作成とトレーニングを開始する準備ができました。</font></font><br>
<br>
<pre><code class="python hljs">plt.figure(figsize=(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>))<font></font>
i = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> (image, label) <span class="hljs-keyword">in</span> test_dataset.take(<span class="hljs-number">25</span>):<font></font>
  image = image.numpy().reshape((<span class="hljs-number">28</span>,<span class="hljs-number">28</span>))<font></font>
  plt.subplot(<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,i+<span class="hljs-number">1</span>)<font></font>
  plt.xticks([])<font></font>
  plt.yticks([])<font></font>
  plt.grid(<span class="hljs-literal">False</span>)<font></font>
  plt.imshow(image, cmap=plt.cm.binary)<font></font>
  plt.xlabel(class_names[label])<font></font>
  i += <span class="hljs-number">1</span><font></font>
plt.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/4h/_v/s7/4h_vs7mj97mmqknia5mpnzaqfis.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルを構築する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニューラルネットワークを構築するには、レイヤーを調整してから、最適化および損失関数を使用してモデルをアセンブルする必要があります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レイヤーをカスタマイズする</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニューラルネットワークを構築する上での基本的な要素はレイヤーです。</font><font style="vertical-align: inherit;">レイヤーは、入力に入ってきたデータからビューを抽出します。</font><font style="vertical-align: inherit;">いくつかのレイヤーが接続された作業の結果、問題を解決するのに意味のあるビューが得られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの場合、深層学習を行うと、単純なレイヤー間にリンクが作成されます。</font><font style="vertical-align: inherit;">たとえば、tf.keras.layers.Denseなどのほとんどのレイヤーには、学習プロセス中に「適合」できる一連のパラメーターがあります。</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Sequential([<font></font>
    tf.keras.layers.Flatten(input_shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>)),<font></font>
    tf.keras.layers.Dense(<span class="hljs-number">128</span>, activation=tf.nn.relu),<font></font>
    tf.keras.layers.Dense(<span class="hljs-number">10</span>, activation=tf.nn.softmax)<font></font>
])<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークは3つの層で構成されています。</font></font><br>
<br>
<ul>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入力</font></font></b> <code>tf.keras.layers.Flatten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -このレイヤーは、サイズが28x28ピクセルの画像を784サイズ（28 * 28）の1D配列に変換します。</font><font style="vertical-align: inherit;">このレイヤーでは入力データの変換のみを処理するため、このレイヤーにはトレーニング用のパラメーターはありません。</font></font></li>
<li> <b> </b> <code>tf.keras.layers.Dense</code> —    128 .   ()     784    ,                  .</li>
<li> <b> </b> <code>ts.keras.layers.Dense</code> — <code>softmax</code>-   10 ,        .     ,        128   .             ,       <code>[0,1]</code>     ,      .     10   1.</li>
</ul><br>
<h4> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルのトレーニングを始める前に、もう少し設定する価値があります。</font><font style="vertical-align: inherit;">これらの設定は、compileメソッドが呼び出されるモデルのアセンブリ中に行われます。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">損失関数</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -望ましい値が予測からどれだけ離れているかを測定するアルゴリズム。</font></font></li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最適化関数</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -モデルの内部パラメーター（重みとオフセット）を「適合」させて損失関数を最小化するアルゴリズム。</font></font></li>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メトリック</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -トレーニングプロセスとテストの監視に使用されます。</font><font style="vertical-align: inherit;">以下の例</font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、正しく分類された画像</font><font style="vertical-align: inherit;">の</font><font style="vertical-align: inherit;">パーセンテージ</font><font style="vertical-align: inherit;">などのメトリックを使用</font><font style="vertical-align: inherit;">しています。</font></font></li>
</ul><br>
<pre><code class="python hljs">model.compile(optimizer=<span class="hljs-string">'adam'</span>,<font></font>
             loss=<span class="hljs-string">'sparse_categorical_crossentropy'</span>,<font></font>
             metrics=[<span class="hljs-string">'accuracy'</span>])
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルを訓練する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、トレーニングデータセットのトレーニング中のアクションのシーケンスを決定します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを使用して、入力データのセットを無限回繰り返し</font></font><code>dataset.repeat()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます（</font></font><code>epochs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下で説明する</font><font style="vertical-align: inherit;">パラメーター</font><font style="vertical-align: inherit;">によって、実行されるすべてのトレーニング反復の数が決まり</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このメソッド</font></font><code>dataset.shuffle(60000)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、モデルのトレーニングが入力データ入力の順序の影響を受けないように、すべての画像をシャッフルします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このメソッド</font></font><code>dataset.batch(32)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><code>model.fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、モデルの内部変数を更新するときに32の画像とラベルのブロック</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用する</font><font style="vertical-align: inherit;">ようにトレーニングメソッドに指示し</font><font style="vertical-align: inherit;">ます。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングは、メソッドを呼び出すことによって行われます</font></font><code>model.fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"></font><code>train_dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルを入力に</font><font style="vertical-align: inherit;">送信</font><font style="vertical-align: inherit;">します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> モデルは、入力画像とラベルを一致させることを学習します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font></font><code>epochs=5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、トレーニングセッションの数を、データセットの5回の完全なトレーニング反復に制限し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。これにより、最終的に5 * 60,000 = 300,000の例でトレーニングが提供されます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（</font></font><code>steps_per_epoch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このパラメーターは無視できますが、すぐにこのパラメーターはメソッドから除外されます）。</font></font><br>
<br>
<pre><code class="python hljs">BATCH_SIZE = <span class="hljs-number">32</span><font></font>
train_dataset = train_dataset.repeat().shuffle(num_train_examples).batch(BATCH_SIZE)<font></font>
test_dataset = test_dataset.batch(BATCH_SIZE)<font></font>
</code></pre><br>
<pre><code class="python hljs">model.fit(train_dataset, epochs=<span class="hljs-number">5</span>, steps_per_epoch=math.ceil(num_train_examples/BATCH_SIZE))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてここに結論があります：</font><font style="vertical-align: inherit;">
モデルのトレーニング中、各トレーニングの繰り返しについて、損失関数の値と精度メトリックが表示されます。</font><font style="vertical-align: inherit;">このモデルは、トレーニングデータで約0.88（88％）の精度を実現します。</font></font><br>
<br>
<code>Epoch 1/5<br>
1875/1875 [==============================] - 26s 14ms/step - loss: 0.4921 - acc: 0.8267<br>
Epoch 2/5<br>
1875/1875 [==============================] - 20s 11ms/step - loss: 0.3652 - acc: 0.8686<br>
Epoch 3/5<br>
1875/1875 [==============================] - 20s 11ms/step - loss: 0.3341 - acc: 0.8782<br>
Epoch 4/5<br>
1875/1875 [==============================] - 19s 10ms/step - loss: 0.3111 - acc: 0.8858<br>
Epoch 5/5<br>
1875/1875 [==============================] - 16s 8ms/step - loss: 0.2911 - acc: 0.8922<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精度を確認する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストデータでモデルがどの程度正確かを確認してみましょう。</font><font style="vertical-align: inherit;">精度をチェックするために、テストデータセットにあるすべての例を使用します。</font></font><br>
<br>
<pre><code class="python hljs">test_loss, test_accuracy = model.evaluate(test_dataset, steps=math.ceil(num_test_examples/BATCH_SIZE))<font></font>
print(<span class="hljs-string">"    : "</span>, test_accuracy)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font><font style="vertical-align: inherit;">
ご覧のとおり、テストデータセットの精度はトレーニングデータセットの精度よりも低くなっています。</font><font style="vertical-align: inherit;">モデルはtrain_datasetデータでトレーニングされているため、これは非常に正常です。</font><font style="vertical-align: inherit;">モデルがこれまでに見たことのない画像を（train_datasetデータセットから）検出すると、分類効率が低下することは明らかです。</font></font><br>
<br>
<code>313/313 [==============================] - 1s 5ms/step - loss: 0.3440 - acc: 0.8793<br>
    : 0.8793<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測して探る</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
訓練されたモデルを使用して、一部の画像の予測を取得できます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> test_images, test_labels <span class="hljs-keyword">in</span> test_dataset.take(<span class="hljs-number">1</span>):<font></font>
  test_images = test_images.numpy()<font></font>
  test_labels = test_labels.numpy()<font></font>
  predictions = model.predict(test_images)<font></font>
</code></pre><br>
<pre><code class="python hljs">predictions.shape
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font><font style="vertical-align: inherit;">
上記の例では、モデルは各テスト入力画像のラベルを予測しました。</font><font style="vertical-align: inherit;">最初の予測を見てみましょう：</font></font><br>
<br>
<code>(32, 10)<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">predictions[<span class="hljs-number">0</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font></font><br>
<br>
<pre><code class="python hljs">array([<span class="hljs-number">3.1365351e-05</span>, <span class="hljs-number">9.0029374e-08</span>, <span class="hljs-number">5.0016739e-03</span>, <span class="hljs-number">6.3597057e-05</span>,
       <span class="hljs-number">6.8342477e-02</span>, <span class="hljs-number">1.0856857e-08</span>, <span class="hljs-number">9.2655218e-01</span>, <span class="hljs-number">1.8982398e-09</span>,
       <span class="hljs-number">8.4999456e-06</span>, <span class="hljs-number">1.0296091e-09</span>], dtype=float32)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデル予測は10個の値の配列であることを思い出してください。</font><font style="vertical-align: inherit;">これらの値は、入力画像が特定のクラス（衣料品）に属するモデルの「信頼度」を示します。</font><font style="vertical-align: inherit;">次のように最大値を確認できます。</font></font><br>
<br>
<pre><code class="python hljs">np.argmax(predictions[<span class="hljs-number">0</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-number">6</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、モデルがこの画像が6というラベルの付いたクラス（class_names [6]）に属していることを最も確信していたことを意味します。</font><font style="vertical-align: inherit;">結果が正しいことを確認して確認できます。</font></font><br>
<br>
<pre><code class="python hljs">test_labels[<span class="hljs-number">0</span>]
</code></pre><br>
<pre><code class="python hljs"><span class="hljs-number">6</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10個のクラスのすべての入力画像と対応するモデル予測を表示できます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_image</span>(<span class="hljs-params">i, predictions_array, true_labels, images</span>):</span><font></font>
  predictions_array, true_label, img = predictions_array[i], true_label[i], images[i]<font></font>
  plt.grid(<span class="hljs-literal">False</span>)<font></font>
  plt.xticks([])<font></font>
  plt.yticks([])<font></font>
  <font></font>
  plt.imshow(img[...,<span class="hljs-number">0</span>], cmap=plt.cm.binary)<font></font>
  <font></font>
  predicted_label = np.argmax(predictions_array)<font></font>
  <span class="hljs-keyword">if</span> predicted_label == true_label:<font></font>
    color = <span class="hljs-string">'blue'</span>
  <span class="hljs-keyword">else</span>:<font></font>
    color = <span class="hljs-string">'red'</span><font></font>
    <font></font>
  plt.xlabel(<span class="hljs-string">"{} {:2.0f}% ({})"</span>.format(class_names[predicted_label],
                                      <span class="hljs-number">100</span> * np.max(predictions_array),<font></font>
                                      class_names[true_label]),<font></font>
                                      color=color)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_value_array</span>(<span class="hljs-params">i, predictions_array, true_label</span>):</span><font></font>
  predictions_array, true_label = predictions_array[i], true_label[i]<font></font>
  plt.grid(<span class="hljs-literal">False</span>)<font></font>
  plt.xticks([])<font></font>
  plt.yticks([])<font></font>
  thisplot = plt.bar(range(<span class="hljs-number">10</span>), predictions_array, color=<span class="hljs-string">"#777777"</span>)<font></font>
  plt.ylim([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
  predicted_label = np.argmax(predictions_array)<font></font>
  <font></font>
  thisplot[predicted_label].set_color(<span class="hljs-string">'red'</span>)<font></font>
  thisplot[true_label].set_color(<span class="hljs-string">'blue'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルの予測の結果である0番目の画像と予測の配列を見てみましょう。</font></font><br>
<br>
<pre><code class="python hljs">i = <span class="hljs-number">0</span>
plt.figure(figsize=(<span class="hljs-number">6</span>,<span class="hljs-number">3</span>))<font></font>
plt.subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<font></font>
plot_image(i, predictions, test_labels, test_images)<font></font>
plt.subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)<font></font>
plot_value_array(i, predictions, test_labels)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/fc/7i/ef/fc7iefucuvtopx4_avluy-rq1ei.png"><br>
<br>
<pre><code class="python hljs">i = <span class="hljs-number">12</span>
plt.figure(figsize=(<span class="hljs-number">6</span>,<span class="hljs-number">3</span>))<font></font>
plt.subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<font></font>
plot_image(i, predictions, test_labels, test_images)<font></font>
plt.subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)<font></font>
plot_value_array(i, predictions, test_labels)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/n0/2y/tj/n02ytjjdkeubvkqvjdusbkwoemy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、いくつかの画像をそれぞれの予測とともに表示します。</font><font style="vertical-align: inherit;">正しい予測は青、誤った予測は赤です。</font><font style="vertical-align: inherit;">画像の下の値は、入力画像がこのクラスに対応する信頼度の割合を反映しています。</font><font style="vertical-align: inherit;">「confidence」の値が高くても、結果が正しくない場合がありますのでご注意ください。</font></font><br>
<br>
<pre><code class="python hljs">num_rows = <span class="hljs-number">5</span>
num_cols = <span class="hljs-number">3</span><font></font>
num_images = num_rows * num_cols<font></font>
plt.figure(figsize=(<span class="hljs-number">2</span>*<span class="hljs-number">2</span>*num_cols, <span class="hljs-number">2</span>*num_rows))
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_images):<font></font>
  plt.subplot(num_rows, <span class="hljs-number">2</span>*num_cols, <span class="hljs-number">2</span>*i + <span class="hljs-number">1</span>)<font></font>
  plot_image(i, predictions, test_labels, test_images)<font></font>
  plt.subplot(num_rows, <span class="hljs-number">2</span>*num_cols, <span class="hljs-number">2</span>*i + <span class="hljs-number">2</span>)<font></font>
  plot_value_array(i, predictions, test_labels)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/m1/11/je/m111jevw7ptxblu2ccmlwmtonva.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニング済みモデルを使用して、単一の画像のラベルを予測します。</font></font><br>
<br>
<pre><code class="python hljs">img = test_images[<span class="hljs-number">0</span>]<font></font>
print(img.shape)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font></font><br>
<br>
<pre><code class="python hljs">(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
のモデルは</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ブロック（コレクション）による予測用に最適化されています。</font><font style="vertical-align: inherit;">したがって、単一の要素を使用しているにもかかわらず、それをリストに追加する必要があります。</font></font><br>
<br>
<pre><code class="python hljs">img = np.array([img])<font></font>
print(img.shape)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font></font><br>
<br>
<code>(1, 28, 28, 1)</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、結果を予測します。</font></font><br>
<br>
<pre><code class="python hljs">predictions_single = model.predict(img)<font></font>
print(predictions_single)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">3.1365438e-05</span> <span class="hljs-number">9.0029722e-08</span> <span class="hljs-number">5.0016833e-03</span> <span class="hljs-number">6.3597123e-05</span> <span class="hljs-number">6.8342514e-02</span>
  <span class="hljs-number">1.0856857e-08</span> <span class="hljs-number">9.2655218e-01</span> <span class="hljs-number">1.8982469e-09</span> <span class="hljs-number">8.4999692e-06</span> <span class="hljs-number">1.0296091e-09</span>]]
</code></pre><br>
<pre><code class="python hljs">plot_value_array(<span class="hljs-number">0</span>, predictions_single, test_labels)<font></font>
_ = plt.xticks(range(<span class="hljs-number">10</span>), class_names, rotation=<span class="hljs-number">45</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/eo/vw/sl/eovwslxcn_ldtj2abz870ninw4g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
model.predictメソッドは、リストのリスト（配列の配列）を返します。各リストは、入力ブロックからの画像に対応しています。</font><font style="vertical-align: inherit;">単一の入力画像の唯一の結果が得られます。</font></font><br>
<br>
<pre><code class="python hljs">np.argmax(predictions_single[<span class="hljs-number">0</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-number">6</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前と同様に、モデルはラベル6（シャツ）を予測しました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演習</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さまざまなモデルを試して、精度がどのように変化するかを確認してください。</font><font style="vertical-align: inherit;">特に、次の設定を変更してみてください。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> エポックパラメータを1に設定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> たとえば、非表示層のニューロンの数を10の低い値から512に変更し、予測モデルの精度がどのように変化するかを確認します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 平坦化層（平滑化層）と最後の高密度層の間に追加の層を追加し、この層のニューロンの数を試してください。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ピクセル値を正規化せず、何が起こるかを確認してください。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての計算が高速になるように、GPUをアクティブにすることを忘れないでください（</font></font><code>Runtime -&gt; Change runtime type -&gt; Hardware accelertor -&gt; GPU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">また、作業中に問題が発生した場合は、グローバル環境設定をリセットしてみてください。</font></font><br>
<br>
<ul>
<li> <code>Edit -&gt; Clear all outputs</code></li>
<li> <code>Runtime -&gt; Reset all runtimes</code></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摂氏VS MNIST</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -この段階で、すでに2種類のニューラルネットワークに遭遇しています。私たちの最初のニューラルネットワークは、摂氏を華氏に変換する方法を学び、広範囲の数値になり得る単一の値を返します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o8/ag/_t/o8ag_trkedahoa0ftg3pstkirt4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のニューラルネットワークは、入力画像が特定のクラスに対応するというネットワークの信頼度を反映する10個の確率値を返します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニューラルネットワークは、さまざまな問題を解決するために使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/no/0v/jo/no0vjoulnrva_-bky0uauc3tesi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
単一の値の予測で解決した問題の最初のクラスは、</font><b><font style="vertical-align: inherit;">回帰</font></b><font style="vertical-align: inherit;">と呼ばれます</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。摂氏を華氏に変換することは、このクラスのタスクの一例です。このクラスのタスクの別の例は、部屋の数、総面積、場所、およびその他の特性によって家の価値を決定するタスクです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我々は利用可能なカテゴリに画像を分類するこのレッスンで取り上げることを作業の第二のクラスが呼び出され</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た分類</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。入力データに基づいて、モデルは確率分布（入力値がこのクラスに属するモデルの「信頼度」）を返します。このレッスンでは、衣服の要素を10のカテゴリに分類するニューラルネットワークを開発しました。次のレッスンでは、写真に犬または猫が表示されているかどうかを判別する方法を学習します。このタスクは分類タスクにも関係します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの2つのクラスの問題（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回帰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分類）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の違いを要約してメモし</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_c/wj/qu/_cwjquy9ivk-s3zma34qamyakoq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おめでとうございます。2種類のニューラルネットワークについて学習しました。</font><font style="vertical-align: inherit;">次の講義の準備をします。そこでは、新しいタイプのニューラルネットワークである畳み込みニューラルネットワーク（CNN）を研究します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレッスンでは、衣服の要素を含む画像を分類するようにニューラルネットワークをトレーニングしました。これを行うために、ファッションMNISTデータセットを使用しました。これには、70,000枚の衣料品の画像が含まれています。 60,000はニューラルネットワークのトレーニングに使用し、残りの10,000はその効果をテストするために使用しました。これらの画像をニューラルネットワークの入力に送信するには、28x28の2D形式から784要素の1D形式に変換（スムーズ）する必要があります。私たちのネットワークは、ラベル（クラス、衣料品のカテゴリ）の数に対応する、128ニューロンの完全に接続されたレイヤーと10ニューロンの出力レイヤーで構成されていました。これらの10個の出力値は、各クラスの確率分布を表しています。</font><i><font style="vertical-align: inherit;">Softmax</font></i><font style="vertical-align: inherit;">アクティベーション</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確率分布を数えた。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回帰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分類の</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">違いについても学びました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回帰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：家の値など、単一の値を返すモデル。</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分類</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：複数のカテゴリ間の確率分布を返すモデル。</font><font style="vertical-align: inherit;">たとえば、ファッションMNISTを使用したタスクでは、出力値は10個の確率値であり、それぞれの値は特定のクラス（衣料品のカテゴリ）に関連付けられていました。</font><font style="vertical-align: inherit;">最後の層の確率分布を得るためだけに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソフトマックス</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">活性化関数を使用したことを思い出します</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事のビデオ版</font></font></b><div class="spoiler_text">          .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...そして標準の行動を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">促すフレーズ</font></a><font style="vertical-align: inherit;"> -サインアップして、プラスを入れて共有:) </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">YouTube </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VKontakte</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454018/index.html">iOSダイジェスト6（5月17日-5月30日）</a></li>
<li><a href="../ja454024/index.html">STM32F334C8T6のMPPT充電コントローラー</a></li>
<li><a href="../ja454028/index.html">PHPロシア2019でのスケッチ：クリーンなコード、ダークマジック</a></li>
<li><a href="../ja454030/index.html">Odigest：今週のデザイナーにとって興味深い</a></li>
<li><a href="../ja454032/index.html">ルーターとデータを渡すClean Swiftアーキテクチャ</a></li>
<li><a href="../ja454036/index.html">既製のソリューションの地獄に行き、100万または2つを減らす6つの方法</a></li>
<li><a href="../ja454038/index.html">イリヤズベレフ：長年にわたり、OpenStreetMapは家を離れることなく地図を描くことができるほどの深刻なインフラストラクチャを獲得してきました</a></li>
<li><a href="../ja454040/index.html">React Russia 2019カンファレンスはすでに6月1日です</a></li>
<li><a href="../ja454042/index.html">あなたが望むものを支払う：このモデルが音楽でどのように現れたのか、そして誰がそのようなお金を稼ごうとしたのか</a></li>
<li><a href="../ja454044/index.html">iPadとiPhoneの創造性</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>