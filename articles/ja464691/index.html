<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧥 🎎 😁 スタンドオフサイバーバトルの結果、またはPT Expert Security Centerが攻撃者を追跡する方法 😺 🤛🏼 🙇🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Positive Hack Daysでスタンドオフコンペティションが4回開催されました。これは、仮想都市Fのインフラストラクチャを制御するための攻撃者、防御者、エキスパートセキュリティセンター（SOC）のチーム間のサイバー戦いです。
 
 攻撃者は、サイバー犯罪者が通常狙うのと同じ目標を持っています...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>スタンドオフサイバーバトルの結果、またはPT Expert Security Centerが攻撃者を追跡する方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/464691/"><img src="https://habrastorage.org/webt/z4/9o/zq/z49ozqdn__t4k3ukmmrmnkbryyu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Positive Hack Daysで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタンドオフ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンペティションが4回開催されました</font><font style="vertical-align: inherit;">。これは、仮想都市Fのインフラストラクチャを制御するための攻撃者、防御者、エキスパートセキュリティセンター（SOC）のチーム間のサイバー戦いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃者は、サイバー犯罪者が通常狙うのと同じ目標を持っています-盗む銀行からのお金、機密データの盗難、技術事故の手配。彼らはタスクを完了しようとしました、そしてSOCチームと一緒にディフェンダーチームは彼らの企業の安全を確実にしそして敵の攻撃を即座に撃退する準備ができていました。また、今年は開発チームがコンテストに参加しました。スタンドオフの一環としてハッカソンが開催されました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その結果については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前回の記事ですでに説明しました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタンドオフは、Positive Technologies </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セキュリティセンター</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">PT Expert Security Center</font></a><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">によって監視されました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">弊社のスペシャリストが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Positive Technologies保護ツール</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（MaxPatrol SIEM、PTネットワーク攻撃検出、PTアプリケーションファイアウォール、PTマルチスキャナー、PT ISIM）</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">によって</font></a><font style="vertical-align: inherit;">記録さ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">れ</font></a><font style="vertical-align: inherit;">たイベントを分析しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">彼らの助けにより、対立の全体像が復元されました。</font><font style="vertical-align: inherit;">この記事では、サイトで何が起こったか、チームがさまざまな企業や都市のインフラストラクチャへの攻撃にどのように対処したかについて説明します。</font><font style="vertical-align: inherit;">長い読みを読むのが面倒な人のため</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルウェア対策</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">に関するレポートの要約版があり</font></a><font style="vertical-align: inherit;">ます。</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">市インフラF</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F市は以前よりもかなり大きくなっています。プロットによると、それは現代のデジタルメトロポリスでした。市内の主な産業企業は、ビッグブログループが保有する火力発電所、石油精製所、化学プラントです。すべての生産プロセスは、最新の産業用制御システムによって制御されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F市では、空港、港湾、鉄道が運行している。ハリネズミ航空のオフィスと海運会社のヘビーシップロジスティクスの本社もここにありました。市のインフラには多数のオフィスが含まれていました。FutureElectronics IT会社、Behealthy保険会社、City-F Media Groupのメディアホールディング、さらにはVoshodフットボールクラブです。通りは交通量が多く、信号機や道路照明は完全に自動化されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
市内には多数の人口が住んでいました。人々はオフィスや生産現場で働き、近代的な家に住んでおり、デジタルテクノロジーのすべての利点を享受しました-Eコインバンクサービスと、国営通信事業者Future TeleComの携帯電話およびインターネットアクセスサービス。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
市のインフラ全体は、イベント会場で大きなレイアウトの形で提示されました。</font><font style="vertical-align: inherit;">レイアウト面積は約17平方メートル。</font><font style="vertical-align: inherit;">それを作成するために、3000本以上の人工木、467種類のフィギュア、153メートルのミニチュアレール、300メートル以上のワイヤーが使用されました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kf/9a/dl/kf9adlfrwevsjlyfiqfeh-wtths.jpeg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">対決結果</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテストに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 18の攻撃チーム、6つの防御チーム、3つのSOCチームが参加しました。攻撃者はタスクを実行し、成功裏に完了するために仮想通貨を受け取りました。防御側は、委託されたオフィスにセキュリティを提供し、攻撃側の攻撃を撃退しました。 SOCチームは、街で何が起こっているかを監視し、防御チームを支援しました-彼らは、ネットワークアクティビティの監視、インシデントの検出と調査のためのサービスを提供しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初期構成が同じ5つのオフィス（保険会社、航空会社、サッカークラブ、メディアホールディング、IT会社のオフィス）は、事前にシステムの脆弱性をチェックし、特定された欠点を排除し、独自の救済策を確立する必要がある弁護士の監督下にありました。防御側の別のチームがEコインバンクの安全性を確保しましたが、総合評価には参加しませんでした。ゲームインフラストラクチャの残りのセグメントは、保護されていないままでした（人生の場合もそうです）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
True0x3Aチームは、Big Bro Groupが保持するオフィスを最初に占領し、長い間、その管理下に置いていました。しかし、後でチームはオフィスへのアクセスを受け取りました。攻撃者は相互にインフラストラクチャを制御しようとし、その結果、ドメインの別々のノードに存在を維持し、タスクを並行して実行することができました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じ2つのチームが、ACSセグメントの生産プロセスを混乱させることができました。 「CARK」の参加者は、SCADAへのアクセスを得て、石油貯蔵施設で障害を組織し、そこから石油供給用のポンプを制御することが可能でした。 True0x3Aは石油管理にもアクセスできるようになり、ほとんど緊急事態を引き起こし、街路の照明をオフにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通信事業者であるFuture TeleComもサイバー攻撃の被害を受けました。一部のチームは、モバイルネットワークに過度の負荷がかかっていても、加入者に通信品質の向上を提供するという枠組みの中で、収益性の高い料金プランに接続できました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
参加者は、ゲーム中にインフラストラクチャが変化することを事前に知っていました。主催者は、F市の企業間の関係に影響を与えるいくつかのサプライズを準備し、チームが追加のポイントを獲得できるようにしました。たとえば、初日の夕方までに、ビッグブログループがCity-F Mediaメディアホールディングを取得したことが判明し、2つのドメイン間を移動できるようになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲームの終わりに向かって、大きなデータリークがありました。主催者のアイデアによると、保護された各セグメントのドメインアカウントが侵害されました。防御側の4つのチームが攻撃者に迅速に対応しましたが、保険会社Behealthyのオフィスを割り当てられたチームはそれほど迅速ではありませんでした。攻撃者は防御側に気付かれずにネットワークに入り、MS17-010からの更新がインストールされていないサーバーをネットワーク上で見つけました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲーム全体を通して、チームTrue0x3AとTsARKAがリードし、他の参加者との差が大きく、最も多くのタスクを完了しました。</font><font style="vertical-align: inherit;">今年の優勝者はTrue0x3Aチーム（3,023,264ポイント）で、TsARKA（1,261,019ポイント）が2位でした。</font><font style="vertical-align: inherit;">防御側の中で、Jet Security Team（44 040 600）が最も多くのポイントを獲得しました。これは、輸送会社Heavy Ship Logisticsのオフィスのセキュリティを担当し、攻撃者がインフラストラクチャに侵入することを許可しませんでした。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終ランキングの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細結果</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃機能</font></font></h2><br><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">MITER ATT＆CK</font></a><font style="vertical-align: inherit;"> 
モデルでの攻撃者のすべてのアクションを調べました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このモデルはもともと、APTグループが実際に使用する手法と方法に関する情報を構造化するために作成されました。このモデルにより、チームが使用した攻撃に関する一般的な統計を示し、どの技術がより頻繁に、どの段階で使用されたかを明確に示すことができます。以下のヒートマップは、参加者が使用した上位100のテクニックを示しています。攻撃者はインフラストラクチャを積極的に探索したため、ほとんどの場合、ネットワークリソーススキャン（ネットワークサービススキャン）の事実が明らかになりました。また、アクセシブルなサービス（Exploit Public-Facing Applications）および資格情報（Brute Force）の脆弱性を悪用する試みがしばしば記録されました。会社のオフィスに侵入した後の一般的なアクションの中で、参加者はスクリプト（スクリプトおよびPowershellテクニック）を使用しました。資格情報を抽出してネットワーク内を移動するための従来の方法（資格情報のダンプとPass-the-Hash）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上位100には、アカウントの操作、ローカルジョブスケジューリング、Webシェルなど、ネットワークの統合の段階で通常適用される手法が含まれています。スタンドオフは典型的なCTFのように見えず、ハッカーのタスクは単純な旗のキャプチャよりもはるかに複雑です。参加者は都市Fの企業を攻撃してシステムを制御するため、彼らの立場を維持することが重要です。今年、参加者は、ハッキングされたインフラストラクチャの固定と競合するチームからの保護に特に徹底的に取り組みました。これはすべて、実際のAPT中の攻撃者のアクションに似ています。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ju/e2/fx/jue2fxg717aq6wxqzbfsljdvqby.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲームの期間中、私たちの専門家は、攻撃されたシステムへのリモートアクセスを整理するさまざまな方法を見てきました。参加者は、攻撃されたノードにWebシェルをダウンロードし、bash、SSH、netcat、Python、Redisサーバーを使用してネットワーク接続を確立しました。 DMZオフィスにあるノードへの攻撃中に、攻撃チームは外部サービスを使用する必要がありました。したがって、平均して、チームには3つの外部VPSサーバーがあり、リバースシェルを確立してエクスプロイトを保存するために使用していました。さらに、Pastebinサービスを使用してシェルを保存し、transfer.shを使用してファイルを外部ストレージにアップロードしました。もちろん、一般的なアクセス方法は、RDPプロトコルを使用してノードに接続することでした。チームはリモート管理ツール、特にTeamViewerとRAdminも使用しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
疑わしい実行可能ファイルが作成されました。 PT MultiScannerのスクリーンショットを見るとわかるように、このアプリケーションはRAdminです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/wb/ck/gjwbck4tw06mky1oddisegh2ydc.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAdminのロード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
一部の参加者は、VPNトンネルの作成に頼っています。たとえば、Big Bro Groupドメインをハイジャックした後、攻撃チームはこのインフラストラクチャ内に直接ネットワーク接続を確立することを決定しました。最初に、メインドメインコントローラーの管理者アカウントに代わってOpenVPNアプリケーションをダウンロードしてインストールし、少し後にバックアップのアプリケーションをダウンロードしてインストールすることが明らかになりました。アクセスするには、ルーティングを構成する必要がありました。攻撃者は必要なすべてのルートを追加した後、RDPプロトコルを使用して、ただしVPNネットワークからドメインコントローラーに正常に接続しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ルーティングは簡単ではありません。特に、ルーティングが多い場合、それは多様で無秩序です。したがって、最も高級なマスターであっても、ルートを正しく登録できるとは限りません。スクリーンショットでは、攻撃者が不要なルートを削除して新しいルートを追加する方法を確認できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n3/mh/a5/n3mha5thl6p_orf3ipzu--qykq4.png"><br>
<br>
<img src="https://habrastorage.org/webt/pi/1f/8a/pi1f8atiee4meji1fyvmtsoj8ha.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルーティングの設定</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
異常に、Another Teamチームがマークされました。 Hedgehog Airlinesサービスへの攻撃中に、彼らは内部のGo言語ツールを使用してアンカーしました。攻撃者は、実行可能ファイルをスタートアップディレクトリに追加するスクリプトを外部サーバーからダウンロードしました。このファイルは、リモートサーバーとのVPNトンネルを作成し、クライアントが同じサーバーに接続するのを待ちます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gd/_7/ex/gd_7exugwpctne95b3c6ovi4rc0.png"><br>
<br>
<img src="https://habrastorage.org/webt/pp/j2/gh/ppj2gh_uuqkidmd0ev3fcsj-giq.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動実行に実行可能ファイルを追加する</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、DMZセグメントから内部ノードに接続するための3proxyユーティリティの使用、およびリレー攻撃を実行するために使用されたResponderおよびInveighユーティリティにも注意します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Big Bro Groupへの攻撃の例として、チームが使用した他のアンカー手法を示します。前述のとおり、この会社のオフィスは防御されていなかったため、非常に迅速にハッキングされました。 True0x3Aチームは、Windows 2012 R2がインストールされているリモートデスクトップゲートウェイ（RDG）サーバーのMS17-010の脆弱性を最初に発見し、すぐにそれを悪用しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他のチームが同じ脆弱性を悪用してインフラストラクチャの制御を引き継ぐことを防ぐために、攻撃者はSMBポートを閉じました。組み込みのWindows netshユーティリティを使用して、ローカルファイアウォールポリシーにブロックルールを追加し、SMBおよびRPCプロトコルを介したホストへのアクセスを無効にしました。また、ターミナルアクセスサーバーサービスを無効にしました。これは、対応するレジストリキーの値の変更から明らかでした。数分後、netshユーティリティを使用して、TCPポート80および443へのアクセスが閉じられました</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8u/lg/gb/8ulggbyw7rhnqz3kavpdciuesye.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。TCPポートを閉じる</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Big Bro Groupインフラストラクチャの所有者は、他の参加者が何もクラックできないように最新のOSアップデートをインストールすることを決定しました。彼らは、スタンバイドメインコントローラーを含む多くのドメインノードでWindows Updateサービスを開始しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mg/kh/3d/mgkh3drvlwfy5y1sz7tsnlaeluu.png"><br>
<br>
<img src="https://habrastorage.org/webt/fw/wp/ca/fwwpca1utyzfeyhagq210ki9hwm.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSアップデートのインストール</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
攻撃者はいくつかの特権アカウントを作成しています。 MS17-010の脆弱性が悪用されると、攻撃者はSYSTEMアカウントの権限で任意のコードを実行できるようになるため、攻撃者は新しいユーザーを作成し、特権を持つローカルセキュリティグループに追加することができます。一部の新しいユーザーがDomain Adminsドメインセキュリティグループに追加されました。他のユーザーの特権も特に増加しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fx/bs/iy/fxbsiy1cslwmnlzn0qc6zwceoqg.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい特権アカウントの追加</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーの資格情報を取得する主な方法の1つは、lsassプロセスをダンプして解析することです。特に、このようなモジュールは、プレーヤーが使用したmimikatzユーティリティに実装されています。おそらく、mimikatzモジュールを介して資格情報を抽出する試みは成功しました-ドメインユーザー管理者のパスワードが受信されました。その後、RDGサーバーからドメインコントローラーへのRDP接続が成功しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/el/lg/5y/ellg5yzh4jugnhbh6tgebni5eps.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSメモリから資格情報を取得しようとしています</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテストの間、主催者はゲームインフラストラクチャに変更を加え、ポイントを獲得するための新しい機会を開きました。都市に暗号通貨が存在することが判明した後、攻撃者はBig Bro Groupのキャプチャされたインフラストラクチャ全体にマイナーエージェントをすばやくダウンロードしてインストールしました。初日の夕方、主催者はビッグブログループとシティ-Fメディアの合併に関するニュースを発表しました。攻撃者はドメイン間の信頼関係を認識し、CF-Mediaドメインに移動しました。 OSとPass-the-Hashのメモリからパスワードハッシュを抽出する手法を一貫して適用することで、このオフィスを完全に制御することができました。以前のBig Bro Groupインフラストラクチャと同様に、暗号通貨マイナーは中央に分散され、CF-Mediaドメインにインストールされていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初日、Big Bro Groupのオフィスで、True0x3AチームとTsARKAチームの対立という興味深いイベントが開催されました。 CARKAチームは、phpMyAdminの脆弱性CVE-2018-12613を利用して、オフィスインフラストラクチャにアクセスすることもできました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/61/tc/6d/61tc6dt1vcncp5dk2l3hvvlladu.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">phpMyAdminの脆弱性CVE-2018-12613の悪用</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
カザフスタンにある外部サーバー109.233.110.31への接続を作成する</font><i><font style="vertical-align: inherit;">CARKA</font></i><font style="vertical-align: inherit;"> Webアプリケーションのディレクトリに、新しい実行可能ファイルが追加されました。次に、BigBroGroupセグメントの内部インフラストラクチャのネットワークスキャンが開始され、スキャンは同じ実行可能ファイルによって開始されました。</font><i><font style="vertical-align: inherit;">外部サーバーとのネットワーク接続のグラフ</font></i></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ij/3v/35/ij3v35eyxbthp3mi-ffnlw3up5a.png"></a><br>
<br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「TSARKA」はドメイン内ですぐに最大の特権を獲得し、ドメイン管理者のパスワードを変更することで競合他社を強制的に排除しようとしました。 True0x3Aチームはこれにすぐに気付き、数分後にいくつかの特権ユーザーが残った後、メインドメイン管理者およびその他の戦略的に重要なアカウントのパスワードを変更しました。この短期間のパスワードを使用した両方のチームの操作は、下の図に部分的に反映されています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e1/n0/9l/e1n09lwnrvnxy0rkxrm8xotsz2c.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アカウントパスワードの変更</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さらに、ドメインコントローラへの代替ネットワークアクセスを作成するために、True0x3Aチームは外部サーバーへのTCPポート転送を構成しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tb/-b/bi/tb-bbiwpogdfxrshzcv5k8ydkgg.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPポート転送を構成する</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
True0x3Aの参加者が責任を持って統合フェーズに取り組みました。インフラストラクチャ内に特権アカウントと多数の代替ネットワークアクセスチャネルがあるという事実により、一部のネットワークノードの制御を維持し、ドメインコントローラーをオフにすることができました。最終的に、両方のチーム（TsARKAとTrue0x3A）は、ドメイン内の別々のノードで作業を続けました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xs/2q/7j/xs2q7jnoxa-n0y6fmbkqav6yw_q.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメインコントローラーの無効化</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これらの同じ2つのチームが石油供給プロセスに介入し、石油貯蔵に障害を引き起こす可能性がありました。 CARKAは、ICSセグメントでEternalBlueに脆弱なワークステーションを見つけ、SCADA WinCCおよびCitectシステムにアクセスし、True0x3AをAllen-Bradley CompactLogixコントローラ管理に接続しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/vk/wn/zzvkwnvkl87wjx36xtn_568u8f4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ICSネットワークトポロジ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
True0x3Aチームはまた、街路の照明をオフにしました。攻撃者はICSネットワークでModicon M340コントローラーを発見し、その後既製のMetasploitモジュールを使用してそれを阻止しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oz/uc/cr/ozuccrefwbewfcfwc9l2vyw48q4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modicon M340コントローラの攻撃チェーン</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲームが終了する1時間前に、主催者は都市での新しい事件を報告しました。保護された各オフィスのドメインユーザーの資格情報が侵害されました。攻撃者は受け取った情報をすぐに利用してVPN経由でネットワークに接続しようとしましたが、防御側は不審な接続をすぐにブロックし、侵害されたアカウントのパスワードを変更しました。 Behealthy保険会社のオフィスでのみ、侵入は見過ごされました。 True0x3Aチームはネットワーク内で迅速に偵察を行い、脆弱なExchangeサーバーを発見しました。コンテストの準備中に、防御側はMS17-010更新をインストールしませんでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/br/ed/fw/bredfwizzfp62woqvkztq4xtfqi.jpeg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Behealthyサーバーでの脆弱性CVE-2017-0146の悪用</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
同じサーバー上で、攻撃者はドメイン管理者のパスワードのハッシュを取得し、PsExecを使用してドメインコントローラーに接続しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zu/xh/vg/zuxhvg1wef9obwrssafjktwcdgo.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Behealthyドメインコントローラーへの接続</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Behealthyオフィスへの攻撃全体に7分かかりました。</font><font style="vertical-align: inherit;">防御側と協力したSOCの専門家は異常な活動を確認しましたが、チームがインシデントに間に合うように支援することができませんでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仮想都市Fのインフラストラクチャは、実際の都市のインフラストラクチャに可能な限り近いです。</font><font style="vertical-align: inherit;">さまざまなセグメントの作成に使用されるシステム（商業組織のオフィス、銀行、通信事業者、および産業企業）は実際に広く使用されており、それらに固有の脆弱性と保護はほとんどすべての実際のネットワークで見つかります。</font><font style="vertical-align: inherit;">これは、スタンドオフを情報セキュリティの世界の他の同様の競争と区別します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最新のサイバー犯罪者に対抗するには、最も関連性の高い攻撃方法を認識し、定期的にスキルを向上させる必要があります。安全なゲーム環境での攻撃者と防御者間の競争は、新しい攻撃シナリオを学び、効果的な対抗手段を練り上げる良い機会です。 Standoffへの参加により、情報セキュリティの専門家は実際にスキルをテストできます。各参加者は新しいことを学び、長所と短所を理解できます。攻撃者側のゲームは、侵入テストのスペシャリストが脆弱性の発見と悪用、防御システムの回避、適切に調整されたチームワークの編成をトレーニングするのに役立ちます。 SOCの擁護者と専門家は、インシデントを検出して迅速に対応する意欲をテストする機会があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この対立はオブザーバーに何を与えましたか？サイトとインターネットを介した観客は、チームがどのようにポイントを獲得したかをリアルタイムで見ることができましたが、彼らがどれほど正確にそれをしたかは残りました。この記事では、参加しているチームの一部がすでに行っているように（True0xA3チームの解析</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-1部</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2部</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3部</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jet Security Team</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Jet Antifraud Teamおよび</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jet CSIRT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の擁護者からの解析</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポート）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたはチームをパスしてはならない）。</font><font style="vertical-align: inherit;">しかし、チームとは異なり、PT Expert Security Centerは競技会場でのイベントに介入しませんでした。当社のスペシャリストの目標は、サイバーインシデントを検出および調査するための最新システムの有効性を実際に示すことでした。</font><font style="vertical-align: inherit;">そして、ご覧のように、デモは成功しました。</font><font style="vertical-align: inherit;">使用したソリューションは、エキスパートが攻撃者のアクションを確認し、攻撃ベクトルを復元するのに役立ちました。</font><font style="vertical-align: inherit;">このような攻撃が実際に発生した場合、攻撃者は数時間以内に計算され、停止する可能性があります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja464677/index.html">証券取引所への投資と関連費用：証券会社のサービスはいくらですか</a></li>
<li><a href="../ja464679/index.html">Voxgun-余計な手間をかけずにプロフェッショナルなビデオコンテンツを作成するためのサービス</a></li>
<li><a href="../ja464685/index.html">光電信、マイクロ波ネットワーク、テスラタワー：珍しい通信塔</a></li>
<li><a href="../ja464687/index.html">Если вы хотите спасти мир, веганство — это не выход</a></li>
<li><a href="../ja464689/index.html">Panda Frontend Meetup＃22コンテンツ：プラグイン、洗練されたデータ、テスト、宣言型Angular</a></li>
<li><a href="../ja464695/index.html">解釈された機械学習モデル。パート1</a></li>
<li><a href="../ja464701/index.html">効果的なスタートアップサイト：顧客、パートナー、投資家が1つのサイトを好む方法</a></li>
<li><a href="../ja464705/index.html">PythonでのAPIの記述（FlaskおよびRapidAPIを使用）</a></li>
<li><a href="../ja464709/index.html">Alive and Living：2019年のランサムウェアウイルス</a></li>
<li><a href="../ja464711/index.html">歯の妖精はここでは機能しません。ワニの歯のエナメル質構造と先史時代の祖先</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>