<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçù ‚úäüèæ üìì C # 8 et validit√© nulle. Comment vivons-nous avec cela üî£ ‚ÄºÔ∏è ü§æüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour coll√®gues! Il est temps de mentionner que nous pr√©voyons de publier le livre fondamental d' Ian Griffiths sur C # 8:
 
 
 Entre-temps, sur son...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C # 8 et validit√© nulle. Comment vivons-nous avec cela</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/501520/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour coll√®gues! </font><font style="vertical-align: inherit;">Il est temps de mentionner que nous pr√©voyons de publier </font><font style="vertical-align: inherit;">le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">livre</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fondamental d' </font><font style="vertical-align: inherit;">Ian Griffiths sur C # 8:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/iw/to/l-/iwtol-20o3gyqy1ppgnewp68giw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre-temps, sur son </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog, l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auteur a publi√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">articles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> connexes </font><font style="vertical-align: inherit;">dans lesquels il examine les subtilit√©s de nouveaux ph√©nom√®nes tels que la nullit√©, la nullit√© ou la conscience nulle. </font><font style="vertical-align: inherit;">Nous avons traduit les deux articles sous un m√™me titre et sugg√©rons d'en discuter.</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La nouvelle fonctionnalit√© la plus ambitieuse de C # 8.0 est appel√©e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©f√©rences nullables</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le but de cette nouvelle fonctionnalit√© est de lisser les dommages caus√©s par une chose dangereuse, que l'informaticien Tony Hoar a appel√© une fois son " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erreur d'un milliard de dollars</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">C # a un mot-cl√©</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(dont l'√©quivalent se trouve dans de nombreuses autres langues), et les racines de ce mot-cl√© remontent √† la langue Algol W, √† laquelle Hoar a particip√©. Dans cette langue ancienne (apparue en 1966), les variables se r√©f√©rant √† des instances d'un certain type pouvaient recevoir une signification particuli√®re indiquant qu'√† l'heure actuelle cette variable n'est r√©f√©renc√©e nulle part. Cette opportunit√© a √©t√© tr√®s largement emprunt√©e et aujourd'hui, de nombreux experts (dont Hoar lui-m√™me) pensent qu'elle est devenue la plus grande source d'erreurs logicielles co√ªteuses de tous les temps.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quel est le probl√®me avec l'hypoth√®se z√©ro? Dans un monde o√π n'importe quel lien peut pointer vers z√©ro, vous devez en tenir compte chaque fois que des liens sont utilis√©s dans votre code, sinon vous courez le risque d'√™tre refus√© au moment de l'ex√©cution. Parfois, ce n‚Äôest pas trop lourd; si vous initialisez une variable avec une expression </font></font><code>new</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au m√™me endroit o√π vous la d√©clarez, alors vous savez que cette variable n'est pas √©gale √† z√©ro. Mais m√™me un exemple aussi simple est lourd de charge cognitive: avant la sortie de C # 8, le compilateur ne pouvait pas vous dire si vous faites quoi que ce soit qui puisse convertir cette valeur en </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mais, d√®s que vous commencez √† assembler diff√©rents fragments de code, il devient beaucoup plus difficile de juger avec certitude de telles choses: quelle est la probabilit√© que cette propri√©t√© que je lis maintenant puisse revenir </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Est-il permis de transmettre</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans cette m√©thode? Dans quelles situations puis-je √™tre s√ªr que la m√©thode que j'appelle d√©finira cet argument </font></font><code>out</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">non pas sur </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais sur une valeur diff√©rente? De plus, la question ne se limite m√™me pas √† penser √† v√©rifier de telles choses; ce que vous devez faire si vous tombez sur z√©ro n'est pas tout √† fait clair. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec les types num√©riques en C #, il n'y a pas un tel probl√®me: si vous √©crivez une fonction qui prend des nombres en entr√©e et renvoie un nombre en cons√©quence, alors vous n'avez pas √† vous demander si les valeurs transmises sont vraiment des nombres, et si quelque chose parmi elles peut √™tre m√©lang√©. Lors de l'appel d'une telle fonction, il n'est pas n√©cessaire de se demander si elle peut renvoyer quelque chose au lieu d'un nombre. A moins qu'une telle √©volution des √©v√©nements ne vous int√©resse en option: dans ce cas, vous pouvez d√©clarer des param√®tres ou des r√©sultats du type</font></font><code>int?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, indiquant que dans ce cas particulier, vous voulez vraiment autoriser la transmission ou le retour d'une valeur nulle. Ainsi, pour les types num√©riques et, dans un sens plus g√©n√©ral, les types significatifs, la tol√©rance z√©ro a toujours √©t√© l'une de ces choses qui se font volontairement, en option. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ce qui concerne les types de r√©f√©rence, avant C # 8.0, la tol√©rance de z√©ro √©tait non seulement d√©finie par d√©faut, mais elle ne pouvait pas non plus √™tre d√©sactiv√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, pour des raisons de compatibilit√© descendante, la validit√© z√©ro continue de fonctionner par d√©faut m√™me en C # 8.0, car les nouvelles fonctions de langage dans cette zone restent d√©sactiv√©es jusqu'√† ce que vous les demandiez explicitement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, d√®s que vous activez cette nouvelle fonctionnalit√© - tout change. La fa√ßon la plus simple de l'activer est de l'ajouter </font></font><code>&lt;Nullablegt;enable&lt;/Nullablegt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† l'int√©rieur de l'√©l√©ment.</font></font><code>&lt;PropertyGroup&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans votre dossier </font></font><code>.csproj</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. (Je note que plus de contr√¥le en filigrane est √©galement disponible. Si vous en avez vraiment besoin, vous pouvez configurer le comportement pour qu'il soit autoris√© </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√©par√©ment sur chaque ligne. Mais, lorsque nous avons r√©cemment d√©cid√© d'inclure cette fonctionnalit√© dans tous nos projets, il s'est av√©r√© qu'elle serait activ√©e √† l'√©chelle un projet √† la fois est une t√¢che r√©alisable.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque les liens autoris√©s dans C # 8.0 sont </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enti√®rement activ√©s, la situation change: maintenant, par d√©faut, il est suppos√© que les liens n'autorisent pas null uniquement si vous ne sp√©cifiez pas l'inverse, exactement comme avec les types significatifs ( m√™me la syntaxe est la m√™me: vous pourriez √©crire int?, si vous vouliez vraiment que la valeur enti√®re soit facultative. Maintenant, vous √©crivez cha√Æne ?, si vous voulez dire que vous voulez soit une r√©f√©rence de cha√Æne, soit</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un changement tr√®s important et, tout d'abord, en raison de son importance, cette nouvelle fonctionnalit√© est d√©sactiv√©e par d√©faut. Microsoft aurait pu concevoir cette fonctionnalit√© de langage diff√©remment: vous pourriez laisser les liens par d√©faut nullables et introduire une nouvelle syntaxe qui vous permettrait de sp√©cifier que vous voulez vous assurer qu'elle n'est pas autoris√©e </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Peut-√™tre que cela abaisserait la barre lors de l'exploration de cette possibilit√©, mais √† long terme, une telle solution serait incorrecte, car dans la pratique, la plupart des liens dans l'√©norme masse de code C # ne sont pas con√ßus pour pointer </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En supposant que z√©ro est une exception, pas une r√®gle, c'est pourquoi, lorsque cette nouvelle fonctionnalit√© de langue est activ√©e, emp√™cher null devient une nouvelle valeur par d√©faut. Cela se refl√®te m√™me dans le nom de la fonction d'origine: ¬´r√©f√©rences nullables¬ª. Le nom est curieux, √©tant donn√© que les liens pourraient </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renvoyer vers C # 1.0. Mais les d√©veloppeurs ont choisi de souligner que maintenant l'hypoth√®se nulle entre dans la cat√©gorie des choses qui doivent √™tre explicitement demand√©es. </font></font><br>
‚ÄÉ<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C # 8.0 adoucit le processus d'introduction de liens permissifs </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car il vous permet d'introduire cette fonctionnalit√© progressivement. Il n'est pas n√©cessaire de faire un choix oui ou non. Ceci est assez diff√©rent de la fonctionnalit√© </font></font><code>async/await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajout√©e en C # 5.0, qui avait tendance √† se r√©pandre: en fait, les op√©rations asynchrones obligent l'appelant √† √™tre</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et par cons√©quent, le code qui appelle cet appelant doit √™tre </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et ainsi de suite, tout en haut de la pile. Heureusement, les types qui le permettent </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont construits diff√©remment: ils peuvent √™tre impl√©ment√©s de mani√®re s√©lective et progressive. Vous pouvez parcourir les fichiers un par un, ou m√™me ligne par ligne si n√©cessaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'aspect le plus important des types permettant</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(gr√¢ce √† quoi la transition vers eux est simplifi√©e), c'est que par d√©faut ils sont d√©sactiv√©s. Sinon, la plupart des d√©veloppeurs refuseraient d'utiliser C # 8.0, car une telle transition entra√Ænerait des avertissements dans presque toutes les bases de code. Cependant, pour les m√™mes raisons, le seuil d'entr√©e pour utiliser cette nouvelle fonctionnalit√© semble assez √©lev√©: si une nouvelle fonctionnalit√© apporte des changements si spectaculaires qu'elle est d√©sactiv√©e par d√©faut, alors vous ne voudrez probablement pas jouer avec elle, mais il y a des probl√®mes associ√©s au passage √† celle-ci semblera toujours inutile. Mais ce serait dommage, car la fonctionnalit√© est tr√®s pr√©cieuse. Cela aide √† trouver des bogues dans le code avant que les utilisateurs ne le fassent pour vous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, si vous envisagez d'introduire des types qui permettent</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, n'oubliez pas de noter que vous pouvez introduire cette fonctionnalit√© √©tape par √©tape. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissements uniquement</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le niveau de contr√¥le le plus approximatif sur l'ensemble du projet apr√®s une simple activation / d√©sactivation est la possibilit√© d'activer des avertissements ind√©pendamment des annotations. Par exemple, si </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j'active</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compl√®tement l'hypoth√®se z√©ro pour </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Corvus.ContentHandling.Json</font></a><font style="vertical-align: inherit;"> dans notre r√©f√©rentiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corvus.ContentHandling</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en ajoutant </font></font><code>&lt;Nullablegt;enable&lt;/Nullablegt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au groupe de propri√©t√©s dans le fichier de projet, alors dans son √©tat actuel, 20 avertissements du compilateur appara√Ætront imm√©diatement. Cependant, si je l‚Äôutilise √† la place, je </font></font><code>&lt;Nullablegt;warnings&lt;/Nullablegt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n‚Äôobtiendrai qu‚Äôun seul avertissement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais attendez! Pourquoi moins d'avertissements me seront-ils affich√©s? En fin de compte, ici, je viens de demander des avertissements. La r√©ponse √† cette question n'est pas enti√®rement √©vidente: le fait est que certaines variables et expressions peuvent √™tre </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulles. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Null Neutrality</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
C # prend en charge deux interpr√©tations de la validit√© nulle. Premi√®rement, toute variable d'un type de r√©f√©rence peut √™tre d√©clar√©e comme admettant ou ne pas admettre </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et deuxi√®mement, le compilateur conclura </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chaque fois que </font><font style="vertical-align: inherit;">possible logiquement si cette variable peut √™tre ou non </font><font style="vertical-align: inherit;">√† un point particulier du code. Cet article ne traite que de la premi√®re vari√©t√© de recevabilit√©</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-√†-dire sur le type statique d'une variable (en fait, cela ne s'applique pas seulement aux variables et aux param√®tres et aux champs qui leur sont proches dans l'esprit; la recevabilit√© statique et logiquement d√©ductible est </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©termin√©e pour chaque expression en C #.) En fait, la recevabilit√© </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans son premier sens , celui que nous envisageons est une extension du syst√®me de types. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, il s'av√®re que si nous nous concentrons uniquement sur l'admissibilit√© nulle pour un type, la situation ne sera pas aussi coh√©rente qu'on pourrait le supposer. Ce n'est pas seulement un contraste entre "validit√© nulle" et "invalide"</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">". En fait, il y a deux autres possibilit√©s. Il existe une cat√©gorie ¬´inconnue¬ª, qui est obligatoire en raison de la disponibilit√© des g√©n√©riques; si vous avez un param√®tre de type illimit√©, il ne sera pas possible de trouver quoi que ce soit sur sa validit√© </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: le code utilisant la m√©thode ou le type g√©n√©ralis√© appropri√© peut y substituer un argument, qu'il autorise ou non </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Vous pouvez ajouter des restrictions, mais souvent ces restrictions ne sont pas souhaitables, car elles r√©duisent la port√©e du type ou de la m√©thode g√©n√©ralis√©e. Ainsi, pour les variables ou expressions d'un param√®tre de type illimit√©, la </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(non) validit√© de z√©ro doit √™tre inconnue; peut-√™tre, dans chaque cas, la question de la recevabilit√©</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cela sera d√©cid√© s√©par√©ment pour eux, mais nous ne savons pas quelle option appara√Ætra dans le code g√©n√©rique, car cela d√©pendra de l'argument type. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette derni√®re cat√©gorie est dite ¬´neutre¬ª. Par le principe de ¬´neutralit√©¬ª, tout fonctionnait avant l'av√®nement de C # 8.0, et cela fonctionnera si vous n'activez pas la possibilit√© de travailler avec des liens annulables. (Fondamentalement, il s'agit d'un exemple de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©troactivit√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . M√™me si l'id√©e de neutralit√© nulle a √©t√© introduite pour la premi√®re fois dans C # 8.0 en tant qu'√©tat naturel de code avant d'activer la validit√© nulle pour les r√©f√©rences, les concepteurs C # ont insist√© sur le fait que cette propri√©t√© n'√©tait jamais vraiment √©trang√®re √† C #.)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-√™tre que vous n'avez pas √† expliquer ce que signifie la ¬´neutralit√©¬ª dans ce cas, car c'est dans cette veine que C # a toujours fonctionn√©, alors vous comprenez vous-m√™me tout ... m√™me si, peut-√™tre, c'est un peu malhonn√™te. Alors √©coutez: dans un monde o√π l'on conna√Æt l'admissibilit√© </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, la caract√©ristique la plus importante des </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">expressions -eutrales est qu'elles ne provoquent pas d'avertissement concernant l'acceptabilit√© nulle. Vous pouvez affecter une expression neutre neutre en tant que </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">autoris√©e </font><font style="vertical-align: inherit;">, mais non autoris√©e. </font></font><code>Null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-les variables neutres (ainsi que les propri√©t√©s, les champs, etc.), vous pouvez attribuer des expressions que le compilateur consid√©rait comme ¬´possibles </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬ª ou ¬´non </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬ª.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C‚Äôest pourquoi, si vous activez simplement les avertissements, il n‚Äôy a pas tellement de nouveaux avertissements. Tout le code reste dans le contexte des annotations de validit√© d√©sactiv√©es </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, donc toutes les variables, param√®tres, champs et propri√©t√©s seront </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neutres, ce qui signifie que vous ne recevrez aucun avertissement si vous essayez de les utiliser en conjonction avec des entit√©s qui prennent en compte </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi alors puis-je recevoir des avertissements? Une raison courante est due √† une tentative de se faire des amis de mani√®re inacceptable deux morceaux de code qui prennent en compte </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Par exemple, supposons que j'ai une biblioth√®que o√π les liens permissifs sont enti√®rement inclus </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et cette biblioth√®que a la classe profond√©ment artificielle suivante:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NullableAwareClass</span><font></font>
	{<font></font>
	    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span>? GetNullable() =&gt; DateTime.Now.Hour &gt; <span class="hljs-number">12</span> ? <span class="hljs-literal">null</span> : <span class="hljs-string">"morning"</span>;<font></font>
	<font></font>
<font></font>
	    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">RequireNonNull</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> s</span>)</span> =&gt; s.Length;<font></font>
	}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, dans un autre projet, je peux √©crire ce code dans le contexte o√π les avertissements de validit√© nulle sont activ√©s, mais les annotations correspondantes sont d√©sactiv√©es: </font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">UseString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> x</span>)</span> =&gt; NullableAwareClass.RequireNonNull(x);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme les annotations sur la validit√© nulle sont d√©sactiv√©es, le param√®tre </font></font><code>x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici est </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neutre. </font><font style="vertical-align: inherit;">Cela signifie que le compilateur ne peut pas d√©terminer si ce code est vrai ou non. </font><font style="vertical-align: inherit;">Si le compilateur a √©mis des avertissements dans les cas o√π </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des expressions neutres sont m√©lang√©es √† celles qui prennent en compte </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, une proportion importante de ces avertissements peut √™tre consid√©r√©e comme douteuse - par cons√©quent, aucun avertissement n'est √©mis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec ce wrapper, j'ai en fait cach√© le fait que le code prend en compte la validit√© </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cela signifie que maintenant je peux √©crire comme ceci:</font></font><br>
<br>
<pre><code class="cs hljs">	<span class="hljs-keyword">int</span> x = UseString(NullableAwareClass.GetNullable());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le compilateur sait ce qu'il </font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut retourner </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais comme j'ai appel√© la m√©thode avec un param√®tre neutre neutre, le programme ne sait pas si c'est bien ou pas. En utilisant le </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wrapper -neutral, j'ai d√©sarm√© le compilateur, qui ne voit plus de probl√®me ici. Cependant, si je combinais ces deux m√©thodes directement, tout serait diff√©rent:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">int</span> y = NullableAwareClass.RequireNonNull(NullableAwareClass.GetNullable());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, je passe le r√©sultat </font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directement √† </font></font><code>RequireNonNull</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si j'essayais de le faire dans un contexte o√π les hypoth√®ses nulles sont activ√©es, le compilateur g√©n√©rerait un avertissement, que j'active ou d√©sactive le contexte des annotations correspondantes. Dans ce cas particulier, le contexte des annotations n'a pas d'importance, car il n'y a pas de d√©clarations avec un type de r√©f√©rence. Si vous activez les avertissements concernant l'hypoth√®se de null, mais d√©sactivez les annotations correspondantes, toutes les d√©clarations deviendront </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neutres, ce qui, cependant, ne signifie pas que toutes les expressions le deviennent. Donc, nous savons que le r√©sultat </font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est nul. Par cons√©quent, nous recevons un avertissement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En r√©sum√©: puisque toutes les d√©clarations dans le contexte d'annotations d√©sactiv√©es qui le permettent </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-neutre, nous n'obtiendrons pas beaucoup d'avertissements, car la plupart des expressions seront </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-neutres. Mais le compilateur sera toujours en mesure de d√©tecter les erreurs li√©es √† l'hypoth√®se </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans les cas o√π les expressions ne passent pas par un interm√©diaire neutre neutre. De plus, le plus grand avantage dans ce cas sera de d√©tecter les erreurs associ√©es aux tentatives de d√©r√©f√©rencement de valeurs nulles potentielles en utilisant </font></font><code>.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par exemple:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">int</span> z = NullableAwareClass.GetNullable().Length;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si votre code est bien con√ßu, il ne devrait pas y avoir un grand nombre d'erreurs de ce type. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annotation progressive de l'ensemble du projet</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Apr√®s avoir fait la premi√®re √©tape - il suffit d'activer les avertissements, puis vous pouvez proc√©der √† l'activation progressive des annotations, fichier par fichier. Il est pratique de les inclure imm√©diatement dans l'ensemble du projet, de voir dans quels fichiers les avertissements apparaissent - puis de s√©lectionner un fichier dans lequel il y a relativement peu d'avertissements. Encore une fois, d√©sactivez-les au niveau de l'ensemble du projet et √©crivez en haut du fichier que vous avez s√©lectionn√© </font></font><code>#nullable enable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Cela activera enti√®rement l'hypoth√®se </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(√† la fois pour les avertissements et pour les annotations) dans le fichier entier (sauf si vous les d√©sactivez √† nouveau √† l'aide d'une autre directive</font></font><code>#nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Ensuite, vous pouvez parcourir l'int√©gralit√© du fichier et vous assurer que toutes les entit√©s susceptibles d'√™tre nulles sont annot√©es comme autorisant </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(c'est-√†-dire, ajouter </font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), puis traiter les avertissements dans ce fichier, le cas √©ch√©ant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il peut s'av√©rer que l'ajout de toutes les annotations n√©cessaires est tout ce qui est n√©cessaire pour √©liminer tous les avertissements. L'inverse est √©galement possible: vous remarquerez peut-√™tre que lorsque vous annotez soigneusement un fichier sur la validit√©</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, d'autres avertissements sont apparus dans d'autres fichiers l'utilisant. En r√®gle g√©n√©rale, il n'y a pas beaucoup d'avertissements de ce type et vous avez le temps de les corriger rapidement. Mais, si pour une raison quelconque, apr√®s cette √©tape, vous vous noyez dans les avertissements, vous avez encore quelques solutions. Tout d'abord, vous pouvez simplement annuler la s√©lection, quitter ce fichier et en reprendre un autre. Deuxi√®mement, vous pouvez d√©sactiver de mani√®re s√©lective les annotations pour les membres qui, selon vous, posent le plus de probl√®mes. ( </font></font><code>#nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez utiliser la </font><font style="vertical-align: inherit;">directive </font><font style="vertical-align: inherit;">autant de fois que vous le souhaitez, afin de pouvoir contr√¥ler les param√®tres de validit√© nulle, m√™me ligne par ligne, si vous le souhaitez.) Peut-√™tre que si vous revenez √† ce fichier plus tard lorsque vous activez d√©j√† la validit√© nulle dans la plupart du projet, vous verrez moins avertissements que la premi√®re fois.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a des moments o√π les probl√®mes ne peuvent pas √™tre r√©solus d'une mani√®re aussi simple. </font><font style="vertical-align: inherit;">Ainsi, dans certains sc√©narios li√©s √† la s√©rialisation (par exemple, lors de l'utilisation de Json.NET ou Entity Framework), le travail peut √™tre plus difficile. </font><font style="vertical-align: inherit;">Je pense que ce probl√®me m√©rite un article s√©par√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les liens avec l'hypoth√®se </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">am√©liorent l'expressivit√© de votre code et augmentent les chances que le compilateur d√©tecte vos erreurs avant que les utilisateurs ne les rencontrent. </font><font style="vertical-align: inherit;">Par cons√©quent, il est pr√©f√©rable d'inclure cette fonctionnalit√© si possible. </font><font style="vertical-align: inherit;">Et, si vous l'incluez de mani√®re s√©lective, les avantages de celle-ci commenceront √† se sentir plus rapidement.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501502/index.html">Le nouveau laboratoire de synth√®se num√©rique poursuit Harris Book et aide √† cr√©er un jeu vid√©o FPGA</a></li>
<li><a href="../fr501506/index.html">√Ä propos des fuites GDI et de l'importance de la chance</a></li>
<li><a href="../fr501508/index.html">Merde vieux CRM</a></li>
<li><a href="../fr501510/index.html">Un nouveau regard sur le d√©veloppement Fullstack avec le framework Ruby on Rails</a></li>
<li><a href="../fr501516/index.html">Coupons le vide?! Alexey Lesovsky</a></li>
<li><a href="../fr501522/index.html">Webinaires Skillbox gratuits: jeux d'√©criture en PHP, Unity et Unreal Engine</a></li>
<li><a href="../fr501526/index.html">Pourquoi l'anglais canadien est consid√©r√© comme "sale" et qu'est-ce que Keanu Reeves a √† voir avec cela?</a></li>
<li><a href="../fr501528/index.html">Le livre "Bash et cybers√©curit√©: attaque, d√©fense et analyse depuis la ligne de commande Linux"</a></li>
<li><a href="../fr501534/index.html">Maintenant, avec COVID-19, il y a aussi une √©ruption cutan√©e</a></li>
<li><a href="../fr501536/index.html">Sur mesure: une histoire sur la fa√ßon dont une ligne de code s'est transform√©e en kilotonnes de charbon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>