<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš¢ ğŸš© â—ï¸ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ç”¨ã‚«ãƒ¼ãƒˆ ğŸ” âœ‹ğŸ» ğŸš£ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Google Cloud Platformã§Webhookã‚’ä½¿ç”¨ã—ã¦Python Telegramãƒœãƒƒãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•
 åºæ–‡ã®ä»£ã‚ã‚Šã«
 
 

-é›»å ±ãƒœãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ä»Šã§ã¯å°å­¦ç”Ÿã§ã•ãˆæ›¸ã„ã¦ã„ã‚‹ã€ã¨å½¼å¥³ã¯è¨€ã£ãŸã€‚
 ã€Œãã—ã¦ã€ãªãœãã†ã§ã¯ãªã„ã®ã‹ã€ã¨ç§ã¯è€ƒãˆã¾ã—ãŸï¼ˆã€Œã¾ã‚ã€ã¾ã‚ã€ã¨ç§ã¯ä»Š...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ç”¨ã‚«ãƒ¼ãƒˆ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/462141/"><p><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Cloud Platformã§Webhookã‚’ä½¿ç”¨ã—ã¦Python Telegramãƒœãƒƒãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•</font></font></i></p><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åºæ–‡ã®ä»£ã‚ã‚Šã«</font></font></h2><br>
<img src="https://habrastorage.org/webt/oi/jo/yy/oijoyytwumhn8skry24krjfi8ke.jpeg" width="45%" height="45%" alt="ç”»åƒ" align="left"><br>
<p><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-é›»å ±ãƒœãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä»Šã§ã¯å°å­¦ç”Ÿã§ã•ãˆæ›¸ã„ã¦ã„ã‚‹ã€ã¨å½¼å¥³ã¯è¨€ã£ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€Œãã—ã¦ã€ãªãœãã†ã§ã¯ãªã„ã®ã‹ã€ã¨ç§ã¯è€ƒãˆã¾ã—ãŸï¼ˆã€Œã¾ã‚ã€ã¾ã‚ã€ã¨ç§ã¯ä»Šè¨€ã„ã¾ã™ï¼‰ã€‚</font></font></i></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ãŸã¡ã¯è±†ã«åº§ã£ã¦ã€ä¸€æ¯ã®ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’é£²ã¿ãªãŒã‚‰ã€å‹äººã®è¼ªã§ã¯ãªãã€è¦ªã—ã„è¼ªã§äººå·¥çŸ¥èƒ½ãƒ¢ãƒ‡ãƒ«ã§ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹å¯èƒ½æ€§ã«ã¤ã„ã¦è©±ã—åˆã„ã¾ã—ãŸã€‚ç§ã®å…ƒåŒåƒšã§ã‚ã‚‹ãƒ¬ãƒŠã¯ã€ã‚ã‚‰ã‚†ã‚‹ç‚¹ã§ã€æ”¿æ²»å­¦ã‚’å’æ¥­ã—ãŸã°ã‹ã‚Šã®ãƒ–ãƒ­ãƒ³ãƒ‰ã§ã¯ãªãã€æ¬¡ã®ã‚ˆã†ã«æ¨è«–ã—ã¾ã—ãŸã€‚ãƒœãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã¨ã€æ©Ÿæ¢°å­¦ç¿’ã§ã‚³ã‚¢ã«é›†ä¸­ã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æ™‚é–“ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚ãã®ç¾ã—ã„æ—¥æ›œæ—¥ã®æœã€ã€Œã‚¹ãƒãƒ¼ãƒ„é¸æ‰‹ã€ã‚³ãƒ ã‚½ãƒ¢ãƒ¼ãƒ«ã®ãƒ¡ãƒ³ãƒãƒ¼ã€ãã—ã¦å˜ã«ç¾ã—ã„ã€ã¨ã„ã†ãã®ã‚ˆã†ãªè«–ç†ã«æŠµæŠ—ã™ã‚‹ã“ã¨ã¯ä¸å¯èƒ½ã§ã‚ã£ãŸã“ã¨ã‚’èªã‚ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ãã‚Œã¯è§£æ±ºã•ã‚Œã¾ã—ãŸã€‚é›»å ±ãƒœãƒƒãƒˆã¨ã¯é›»å ±ãƒœãƒƒãƒˆã‚’æ„å‘³ã—ã¾ã™ã€‚</font></font></p><br>
<p>           â€œ    30 â€.    ,          .              NLP (natural language processing).    ,  ,  (   -  ).         ,              send-receive,         .   - . </p><br>
<p>    .             ,  ,    ,    â€œâ€   .     .</p><a name="habracut"></a><br>
<h2> . </h2><br>
<p>    Pythonâ€™  -.       : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">python-telegram-bot</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">pyTelegramBotAPI</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">AIOGram</a>.               <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>. ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">API  </a>.         API   pyTelegramBotAPI.     .</p><br>
<p>     .   ,  . Python-telegram-bot,  ,     ,      (, ). ,   pyTelegramBotAPI  ,   . AIOGram    .    ,     webhookâ€™     .   ,  .      .</p><br>
<p>           . </p><br>
<p>    , ,    ,     ,       .      .         pyTelegramBotAPI: </p><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">-   polling</a>;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://github.com/eternnoir/pyTelegramBotAPI/blob/master/examples/webhook_examples/webhook_aio">-   webhook</a>.</li>
</ol><br>
<p>    -  ssl-, webhookâ€™, .      .     ,             -        ,      (  ,   ).  ssl-,           .      ,       ,    .<br>
&nbsp;</p><br>
<h2>Polling vs Webhook</h2><br>
<img src="https://habrastorage.org/webt/tp/2b/ve/tp2bveonfyk-z9uqucefpqkg90k.jpeg" width="45%" height="45%" alt="ç”»åƒ" align="left"><br>
<p>    polling vs webhook    ( )  webhookâ€™,       .     ,   .</p><br>
<p>        ? ,   ,       .          .        ,   â€”  ( â€œâ€  ).        . </p><br>
<p> â€”   (   polling)       .  â€”  â€œ â€  ip- (webhook â€”    -),       .</p><br>
<p>     .   ( ) â€”   ,   â€”   . ,    (polling)       .       ,    ,        .  ,       !               ,     . </p><br>
<p>,       . ,   ,         ,      .     ,     .   ,  ( )    ,  .       (polling)  ,          . </p><br>
<p>    â€œ â€   (webhookâ€™)   .    ,   ,   ,   .    ,    ,      . </p><br>
<p> ,    (.  )    .   ,  .      ,      -,        . </p><br>
<p>,          . ,   ,   .   ,      pollingâ€™   . </p><br>
<p>   ,    .     pollingâ€™, ,  -    webhookâ€™.    .      macOS         (,  VPN)   .          Linuxâ€™      20 .         ,      . ,  .  ,    webhookâ€™,    .   ,        ,    .<br>
&nbsp;</p><br>
<h2>   webhook</h2><br>
<p><i>   webhook   .</i> </p><br>
<p>        pollingâ€™,     webhook     .      pyTelegramBotAPI.    .  13-25  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>    56-67 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://github.com/eternnoir/pyTelegramBotAPI/blob/master/examples/webhook_examples/webhook_aio"> </a>.   ,    ,   .      ,     .</p><br>
<pre><code class="python hljs"><span class="hljs-comment"># Handle '/start' and '/help'</span>
<span class="hljs-meta">@bot.message_handler(commands=['help', 'start'])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_welcome</span>(<span class="hljs-params">message</span>):</span>
    bot.reply_to(message, <span class="hljs-string">"""\
Hi there, I am EchoBot.
I am here to echo your kind words back to you. Just say anything nice and I'll say the exact same thing to you!\
"""</span>)<font></font>
<font></font>
<span class="hljs-comment"># Handle all other messages with content_type 'text' (content_types defaults to ['text'])</span>
<span class="hljs-meta">@bot.message_handler(func=lambda message: True)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">echo_message</span>(<span class="hljs-params">message</span>):</span>
    bot.reply_to(message, message.text)</code></pre><br>
<p> ,       ,   ,   copy-past        (..   1-55  70-87).     ,  ,    ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://aio">aiohttp</a>    http-       ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ssl</a>     .  aiohttp     ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</p><br>
<p>.   webhookâ€™   .       ,          API_TOKEN, WEBHOOK_HOST, WEBHOOK_PORT, WEBHOOK_SSL_CERT, WEBHOOK_SSL_PRIV.           .<br>
&nbsp;</p><br>
<h2>   </h2><br>
<p>   .      -     @BotFather.   â€œ/newbotâ€.   BotFather    name  username        â€œ712308912:DLGSteczdUnPdnNYLzNikaGOhome7l9q3vovaâ€ (,    ).  ,   .      API_TOKEN.<br>
&nbsp;</p><br>
<h2> ? Google Cloud Platform vs Heroku</h2><br>
<p>      .      ,  -   Heroku. Heroku â€”  PaaS  (  ).     GitHub,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Heroku</a>.       .    , Python  ,     .      .         .     . </p><br>
<p>  ,     Heroku    â€œ  30 â€    Heroku <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>. ,    ,  ,            ,     .</p><br>
<p>   Heroku <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Google Cloud Platform</a> (GCP)           300 .         .      ,   ,   . , , GCP  PaaS,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.    ,    Heroku.          ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Compute Engine</a>  GCP.<br>
&nbsp;</p><br>
<h2>Google Cloud Platform </h2><br>
<p><i>Project, instance, static ip, port</i></p><br>
<h4>   </h4><br>
<p>  GCP,  â€œGet started for freeâ€   .    ,         300      .         ,   .      â€œCompute Engine/VM Instanceâ€    . </p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hw/mu/dn/hwmudnnoog3fhutxopij3vmdaeo.png" width="60%" height="60%" alt="ç”»åƒ"></div><br>
<p> â€œCREATE INSTANCEâ€    , ,     .     micro       4   .   ,       Google  300 .</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ah/u9/h9/ahu9h9oqvk0xvbltw08odqqkium.png" alt="ç”»åƒ"></div><br>
<p>  .</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s_/cv/x_/s_cvx_fytblpl3hbpwx48gdmrj8.png" alt="ç”»åƒ"></div><br>
<p>&nbsp;</p><br>
<h4> ip- </h4><br>
<p>  â€œExternal IPâ€   ,     WEBHOOK_HOST    (    35.224.231.90).       ssl-.        (,       GCP),     ip- ,        instance  .     â€œVPC/External IP addressesâ€.</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ws/08/f7/ws08f71j4vink6sredri7sn5k7w.png" width="60%" height="60%" alt="ç”»åƒ"></div><br>
<p>  â€œTypeâ€  â€œEphemeralâ€  â€œStaticâ€,    ,    ,       ip-.</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vd/sy/ug/vdsyugaqmpgjrcnn_v9lniyrp2y.png" alt="ç”»åƒ"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/fh/i0/pufhi0ermqi0jckodbpyx_qyjdu.png" alt="ç”»åƒ"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yg/ly/ln/yglylnfmm7oclpudssp7sycu8a4.png" width="60%" height="60%" alt="ç”»åƒ"></div><br>
<p>&nbsp;</p><br>
<h4> </h4><br>
<p>   webhookâ€™    ,     .    ( 2019 )    : 443, 80, 88, 8443.          webhookâ€™ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.    8443.         WEBHOOK_PORT.      GCP    webhook-bot.   ?    â€œVPC/Firewall rulesâ€    â€œCREATE FIREWALL RULEâ€.</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gr/4i/f5/gr4if5xforj5psjgljivxmru8y4.png" width="60%" height="60%" alt="ç”»åƒ"></div><br>
<p>  ,      .</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ne/gt/jl/negtjln_cf8mbb0sledqn5wvvkg.png" alt="ç”»åƒ"></div><br>
<p>&nbsp;</p><br>
<h4>  ,  </h4><br>
<p>      Google Cloud Platform .     GCP,  ,      ()   Ubuntu 19.04,  ip-,   8443.</p><br>
<p> . ,          Python  .  . </p><br>
<p>  GCP   â€œCompute Engine/VM Instanceâ€    â€œConnectâ€   â€œSSHâ€.</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s_/cv/x_/s_cvx_fytblpl3hbpwx48gdmrj8.png" alt="ç”»åƒ"></div><br>
<p>            GCP.    Ubuntu.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">conda</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">virtualenv</a>,      Python 3   .   ,     :<br>
pip install pyTelegramBotAPI<br>
pip install aiohttp</p><br>
<p>    ,   .<br>
&nbsp;</p><br>
<h2>   SSL  IP</h2><br>
<p> ,      ssl     .       : </p><br>
<p><i>â€œ   , ,<br>
   <br>
   â€¦â€ </i> </p><br>
<p> ,    ,  ,     webhookâ€™  ,       .  ,     ip.       .  ,    ,    ,     ,      . </p><br>
<p>  .     ?  ,          ,     â€œâ€.       webhookâ€™.   -        (    ).  -       ,      ssl-,   .     .          ,    ip,  ,   ,     ,     .  ,         . ,   - . </p><br>
<p> ,       ,      .  ,     â€œ  â€,       .       . </p><br>
<p>      ssl-     ,    ip (    ),  (.. )        .</p><br>
<p>  (    )   ,         .          .</p><br>
<pre><code class="bash hljs">$ openssl req -newkey rsa:2048 -sha256 -nodes -keyout url_private.key -x509 -days 3560 -out url_cert.pem</code></pre><br>
<p>         .     . , ,     , , ,   (  ),   ip   email. </p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wi/q3/fi/wiq3fixoya8owjmt_-hafyn3urw.png" alt="ç”»åƒ"></div><br>
<p>       ,     .   url_cert.pem    ,     url_private.key.        WEBHOOK_SSL_CERT  WEBHOOK_SSL_PRIV .           .         . </p><br>
<p>  .<br>
&nbsp;</p><br>
<h2> webhook  </h2><br>
<h4> webhook   </h4><br>
<p>,     â€œ   ?â€.          . IP-  ,  8443  .    BotFather   â€œ/botâ€  â€œ/setWebhookâ€)  YOUR-TOKEN.    ,   .</p><br>
<pre><code class="bash hljs">$ curl -F <span class="hljs-string">"url=https://35.224.231.90:8443"</span> -F <span class="hljs-string">"certificate=@url_cert.pem"</span> https://api.telegram.org/botYOUR-TOKEN/setWebhook</code></pre><br>
<p>  ,        ,  webhook . </p><br>
<h4> webhook  â€œâ€ </h4><br>
<p>     ,   webhook      .</p><br>
<pre><code class="dos hljs"><span class="hljs-function">https://<span class="hljs-title">api.telegram.org</span>/<span class="hljs-title">botYOUR</span>-<span class="hljs-title">TOKEN</span>/<span class="hljs-title">setWebhook</span>?<span class="hljs-title">url</span>=<span class="hljs-title">https</span>://<span class="hljs-title">YOUR.DOMAIN</span>:8443/<span class="hljs-title">YOUR</span>-<span class="hljs-title">TOKEN</span>/</span></code></pre><br>
<p> ,      .  , ,  YOUR.DOMAIN     ,    . .    mydreem.com,    ssl-   www.mydreem.com.  YOUR.DOMAIN    www.mydreem.com.</p><br>
<h4> ,   webhook?</h4><br>
<p>     webhook    :</p><br>
<pre><code class="dos hljs"><span class="hljs-function">https://<span class="hljs-title">api.telegram.org</span>/<span class="hljs-title">botYOUR</span>-<span class="hljs-title">TOKEN</span>/<span class="hljs-title">getWebhookInfo</span></span></code></pre><br>
<p>    .      -    ,  webhook    :</p><br>
<pre><code class="dos hljs">{"ok":true,"result":{"url":"https://<span class="hljs-number">35</span>.<span class="hljs-number">224</span>.<span class="hljs-number">231</span>.<span class="hljs-number">90</span>:<span class="hljs-number">8443</span>/<span class="hljs-number">712308912</span>:DLGSteczdUnPdnNYLzNikaGOhome7l9q3vova/","has_custom_certificate":true,"pending_update_count":<span class="hljs-number">0</span>,"max_connections":<span class="hljs-number">40</span>}}</code></pre><br>
<p>  ,  webhook ,     ( ):</p><br>
<pre><code class="dos hljs">{"ok":true,"result":{"url":"https://<span class="hljs-number">35</span>.<span class="hljs-number">224</span>.<span class="hljs-number">231</span>.<span class="hljs-number">90</span>:<span class="hljs-number">8443</span>/<span class="hljs-number">712308912</span>:DLGSteczdUnPdnNYLzNikaGOhome7l9q3vova/","has_custom_certificate":true,"pending_update_count":<span class="hljs-number">2</span>,"last_error_date":<span class="hljs-number">1564506964</span>,"last_error_message":"Connection refused","max_connections":<span class="hljs-number">40</span>}}</code></pre><br>
<h4>  webhook?</h4><br>
<p>       , ,       ().   ,    (webhook  ).        webhookâ€™,   pollingâ€™ ( webhook , polling   ).     ,  â€œâ€ webhook:</p><br>
<pre><code class="dos hljs"><span class="hljs-function">https://<span class="hljs-title">api.telegram.org</span>/<span class="hljs-title">botYOUR</span>-<span class="hljs-title">TOKEN</span>/<span class="hljs-title">setWebhook</span></span></code></pre><br>
<p>          .          ,       .      .  ,        /       .<br>
&nbsp;</p><br>
<h2>Cloud Shell or â€œDrop Dead Beautifulâ€ (â€œ â€)</h2><br>
<p>        ,                    / â€” . ,   ,    .     Cloud Shell  GCP     .   ,    ,     .    ,     .</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Cloud Shell</a>           .   <del></del>     ,   Google Cloud SDK       (      , â€œâ€  ).          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.        .  Cloud Shell (. gif- ,    google).</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/si/7p/yh/si7pyhijurtp0i4ta3brjsee8yk.gif" alt="ç”»åƒ"></div><br>
<p>   Cloud Shell. ,       ,   â€œ   betaâ€. </p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jy/op/rt/jyoprt3zetf5mgzyoykqqwzfojs.png" width="45%" height="45%" alt="ç”»åƒ"></div><br>
<p>  â€œHelp/Aboutâ€  ,   â€œtheia-editor-for-cloudshell-preview 0.0.1â€.             .    .        (   Python),    .        Cloud Shell    .          Cloud Shell. </p><br>
<p> ,     ,             ().     ,    .     .        Cloud Shell.   ,     ,     .</p><br>
<p>Cloud Shell â€”     Debian  5     1.7  .       ( Python). Cloud Shell      ,    conda,  env   . ,    polling,    .   webhook,    ,      Cloud Shell !       ,  Cloud Shell   . </p><br>
<p>              ,         webhookâ€™.    .   ,   ,    .</p><br>
<p>, Cloud Shell      (   ).          ,  Cloud Shell    120   ,     .        .</p><br>
<p>. ,  .             .</p><br>
<p>,     Cloud Shell        (, webhook-bot),        :</p><br>
<pre><code class="bash hljs">$ gcloud compute ssh webhook-bot --zone us-central1<span class="hljs-_">-a</span></code></pre><br>
<p>        .   Cloud Shell   â€œexitâ€.     -   Cloud Shell  .      Cloud Shell ( )   :</p><br>
<pre><code class="bash hljs">$ gcloud compute scp --recurse ~/telebot/my_favorite_robot.py webhook-bot:~/telebot --zone us-central1<span class="hljs-_">-a</span></code></pre><br>
<p>     ,       Cloud Shell.       â€œex1.pyâ€   â€œ/examplesâ€  â€œwebhook-botâ€   â€œ/telebot2â€ Cloud Shell:</p><br>
<pre><code class="bash hljs">$ gcloud compute scp --recurse webhook-bot:~/examples/ex1.py --zone us-central1<span class="hljs-_">-a</span> ~/telebot2</code></pre><br>
<p>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.     ,    .      ,   .             Cloud Shell     â€œtheia-editor-for-cloudshell-preview 0.0.1â€.        ()  .    -  ,          Cloud Shell        .   .</p><br>
<p>,                   GCP (      ). ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Cloud Storage</a>.  ,            .   ,          .</p><br>
<p>.      (). ,      ,    ,    ,          â€œpython my_webhook_bot.pyâ€.   .       ,      . ,  â€œnohup python my_webhook_bot.py &amp;â€. ,         ,   , , ,    .<br>
&nbsp;</p><br>
<h2></h2><br>
<p>,     ,      ,      -  webhookâ€™     . ,    ,   ,    , - 2019 ,   .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>       GCP       .    ,           .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">@Eduard_Lanchev</a>.</p><br>
<p>       ,       -.   ,  .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">@AelitaSoccerBot</a>.     ,       .  ,  -  , ,        .         . <em>.   2019             .</em></p><br>
<p>           !<br>
&nbsp;</p><br>
<h4> </h4><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Telegram Bot API</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Bot Code Examples</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">python-telegram-bot</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">pyTelegramBotAPI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">AIOGram</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ssl â€” TLS/SSL wrapper for socket objects</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Heroku</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Google Cloud Platform</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Google Compute Engine</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Marvin's Marvellous Guide to All Things Webhook</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Conda</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Virtualenv</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Cloud Shell</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">The gcloud compute command-line tool</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Transferring files using the gcloud command-line tool</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Google Cloud Storage</a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja462125/index.html">Yaml Zenã¸ã®10ã‚¹ãƒ†ãƒƒãƒ—</a></li>
<li><a href="../ja462127/index.html">ã‚»ãƒŸãƒŠãƒ¼ã€Œå½¼è‡ªèº«ã®ãŸã‚ã®ç›£æŸ»äººï¼šãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨å—ã‘å…¥ã‚Œãƒ†ã‚¹ãƒˆã®ç›£æŸ»ã€ã€8æœˆ15æ—¥ã€ãƒ¢ã‚¹ã‚¯ãƒ¯</a></li>
<li><a href="../ja462131/index.html">ã„ã°ã‚‰ã‹ã‚‰å¤¢ã®ã‚²ãƒ¼ãƒ ã¸</a></li>
<li><a href="../ja462133/index.html">ã‚­ãƒ—ãƒ­ã‚¹ã«ã¤ã„ã¦ã‚‚ã†ä¸€åº¦ã€äººç”Ÿã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹</a></li>
<li><a href="../ja462135/index.html">æˆ¦ç•¥çš„ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—ï¼šServiceNowãŒå¤§è¦æ¨¡ãªã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨ææºã™ã‚‹ç†ç”±</a></li>
<li><a href="../ja462145/index.html">ç™»éŒ²è§£é™¤ã«æ•°æ—¥ã‹ã‹ã‚‹ã®ã¯ãªãœã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja462147/index.html">React Nativeã§ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã¨ãã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®æ“ä½œ</a></li>
<li><a href="../ja462149/index.html">iOSãƒ‡ãƒã‚¤ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚µãƒªã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™ãƒ¢ãƒ¼ãƒ‰ã¨ãã‚Œã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja462151/index.html">Kubernetesãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒˆãƒƒãƒ—5</a></li>
<li><a href="../ja462153/index.html">Unity Interactive Mapã‚·ã‚§ãƒ¼ãƒ€ãƒ¼</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>