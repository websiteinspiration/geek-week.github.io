<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥘 🥞 🏴󠁧󠁢󠁥󠁮󠁧󠁿 ROS والشبكة العصبية متسول الروبوت 💞 🤥 🕝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="عادة ، يطرح سؤالان من هذا القبيل لهذه الحرف: "كيف؟" و لماذا؟" تم تخصيص المنشور نفسه للسؤال الأول ، وسأجيب على الفور على السؤال الثاني: 
 
 لقد بدأت هذ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ROS والشبكة العصبية متسول الروبوت</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500150/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">عادة ، يطرح سؤالان من هذا القبيل لهذه الحرف: "كيف؟" و لماذا؟" تم تخصيص المنشور نفسه للسؤال الأول ، وسأجيب على الفور على السؤال الثاني: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لقد بدأت هذا المشروع من أجل إتقان الروبوتات ، بدءًا من Raspberry Pi والكاميرا. كما تعلم ، فإن إحدى أفضل الطرق لتعلم شيء ما هي التوصل إلى مهمة فنية ومحاولة إنجازها ، مع الحصول على المهارات اللازمة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في ذلك الوقت ، لم يكن لدي أي أفكار مشرقة في مجال الروبوتات ، لذلك قررت أن أصنع مشروعًا ممتعًا حصريًا - روبوت متسول. والنتيجة هي روبوت مستقل على Raspberry Pi و ROS ، باستخدام عصا Movidius Neural Cumpute Stick لاكتشاف الوجوه. يتجول في الغرفة ، يبحث عن الناس ، ويهز علبة أمامهم. إليك ما يبدو عليه هذا الروبوت:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pt/wp/nt/ptwpntdd13lkskxbxjuhoyx1oom.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتحرك الروبوت بشكل عشوائي حول الغرفة ، وإذا لاحظ شخصًا ، فإنه يتدحرج إليه ويهز جرة للأشياء الصغيرة. </font><font style="vertical-align: inherit;">للمتعة ، أضفت القليل من تعبيرات الوجه إليه - فهو يعرف كيف يحرك حاجبيه: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2x/lm/aw/2xlmaw5tm_hogsuqfuvqwjmeblk.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد المحاولة الأولى ، يحاول الروبوت العثور على وجهه مرة أخرى في الأفق ، ويلتفت إلى الشخص ويهز البنك مرة أخرى. </font><font style="vertical-align: inherit;">ولكن ماذا يحدث إذا غادرت في هذه اللحظة:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/8x/xz/ko8xxzvzo_owit62gkv8z3wn1ik.gif"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إنسان آلي</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أخذت فكرة روبوت التسول من </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مجلة Popular Mechanics</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">يبدو أن تأليف النموذج كريس إيكيرت الذي يدعى Gimme ممتع من الناحية الجمالية.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/374/8d6/dbc/3748d6dbcb97d04751dacd866eb94e07.jpg" alt="صورة" width="300" height="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كنت أرغب في التركيز أكثر على الوظائف ، لذلك تم تجميع العلبة من مواد مرتجلة. </font><font style="vertical-align: inherit;">على وجه الخصوص ، أثبتت زوايا PVC أنها أكثر المواد تنوعًا والتي يمكنك من خلالها توصيل أي جزءين تقريبًا. </font><font style="vertical-align: inherit;">يبدو أنه في الوقت الحالي يتكون الروبوت من خمسة بالمائة من زوايا PVC ومسامير M3. </font><font style="vertical-align: inherit;">تتكون العلبة نفسها من ثلاث منصات صفائحية يتم تركيب الرأس وجميع الإلكترونيات عليها. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أساس الروبوت هو </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspberry Pi 2B</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">والكتابة</font></a><font style="vertical-align: inherit;"> مكتوبة بلغة C ++ وتقع على </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رؤية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لإدراك الواقع ، يستخدم الروبوت </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كاميرا Paspberry Pi Camera Module v2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، والتي يمكن التحكم فيها باستخدام مكتبة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RaspiCam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لاكتشاف الوجه ، جربت عدة طرق مختلفة. جودة أجهزة الكشف الكلاسيكية من OpenCV لم ترضيني ، لذلك في النهاية توصلت إلى حل غير قياسي إلى حد ما. الكشف عن الأشخاص العاملين في الشبكة العصبية ، التي تعمل على جهاز </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Movidius Neural Compute Stick (NCS)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ضمن إطار التحكم </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenVINO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إن NCS هي قطعة من الأجهزة من أجل الإطلاق الفعال للشبكات العصبية ، حيث يوجد بداخلها العديد من المعالجات الموجهة المصممة خصيصًا لهذا الغرض. الجهاز متصل عبر USB ويستهلك فقط 1 واط من الطاقة. وبالتالي ، يعمل NCS كمعالج مساعد لـ Raspberry Pi ، الذي لا يسحب الشبكة العصبية. بينما يقوم NCS بمعالجة الإطار التالي ، فإن معالج Paspberry مجاني لعمليات أخرى. تجدر الإشارة إلى أنه من أجل التشغيل الأمثل للجهاز ، يلزم وجود واجهة USB 3.0 ، والتي لا تتوفر في الإصدارات القديمة من Raspberry ؛ مع USB 2.0 ، يعمل أيضًا بشكل أبطأ. أيضًا ، حتى لا أحجب موصلات Raspberry USB ، أقوم بتوصيل NCS به عبر كابل USB قصير. لقد كتبت بالتفصيل حول العمل مع Neute Compute Stick </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">في مقالتي السابقة</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في البداية حاولت التدريب</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">جهاز كشف الوجه الخاص بهندسة MobileNet + SSD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> على مجموعات البيانات المفتوحة. عمل الكاشف حقًا ، ولكنه ليس مستقرًا جدًا: مع التدهور الحتمي لظروف التصوير (التعرض والطلقات الباهتة) ، تراجعت جودة الكاشف بشكل كبير. ومع ذلك ، بعد مرور بعض الوقت ، ظهرت كاشفات الوجه الجاهزة في OpenVINO ، وتحولت إلى كاشف مع </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بنية SqueezeNet light + SSD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، والتي لم تعمل بشكل أفضل فقط في مجموعة متنوعة من ظروف التصوير ، ولكنها كانت أيضًا أسرع. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
قبل تحميل الصورة إلى NCS للحصول على تنبؤات الكاشف ، يجب معالجة الصورة مسبقًا. يعمل كاشف من اختياري مع الصور الملونة</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>300</mn><mo>&amp;#x00D7;</mo><mn>300</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.815ex" height="2.009ex" viewBox="0 -755.5 4225.9 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-D7" x="1723" y="0"></use><g transform="translate(2724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>300</mn><mo>×</mo><mn>300</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">300 \times 300</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، لذا يجب ضغط الصورة أولاً. للقيام بذلك ، أستخدم خوارزمية التحجيم الأخف - أقرب طريقة جار (INTER_NEAREST في مكتبة OpenCV). يعمل بشكل أسرع قليلاً من طرق الاستيفاء ، ولا يؤثر تقريبًا على النتيجة. يجدر أيضًا الانتباه إلى ترتيب قنوات الصور: يتوقع الكاشف ترتيب BGR ، لذلك تحتاج إلى تعيين الشيء نفسه للكاميرا.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حاولت أيضًا فصل معالجة الفيديو إلى دفقين ، تلقى أحدهما الإطار التالي من الكاميرا ومعالجته ، والآخر في ذلك الوقت قام بتحميل الإطار السابق إلى NCS وانتظر نتائج الكاشف. مع هذا المخطط ، من الناحية الفنية ، تزداد سرعة المعالجة ، ولكن يزيد أيضًا التأخير بين استلام الإطار واستقبال الاكتشافات. بسبب هذا التخلف عن الواقع ، تصبح مراقبة الوجه أكثر صعوبة فقط ، لذلك في النهاية رفضت هذا المخطط. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالإضافة إلى اكتشاف الوجوه فعليًا ، يجب أيضًا تتبعها لتجنب أخطاء الكاشف. للقيام بذلك ، أستخدم جهاز تعقب خفيف الوزن </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simple Online Realtime Tracker (SORT)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . يتكون هذا المتتبع البسيط من جزأين: يتم استخدام </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">الخوارزمية المجرية</font></a><font style="vertical-align: inherit;"> لمطابقة الكائنات على الإطارات المجاورة</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، والتنبؤ بمسار الكائن ، إذا اختفى فجأة - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مرشح كالمان</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">بينما كنت ألعب بتتبع الوجه ، وجدت أن المسارات التي تنبأ بها مرشح كالمان يمكن أن تكون غير معقولة للغاية مع الحركات المفاجئة ، الأمر الذي يعقد العملية مرة أخرى. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذلك ، أوقفت مرشح كالمان ، وتركت فقط خوارزمية مطابقة الوجه وعداد العدد المتسلسل للإطارات التي تم الكشف عن الوجه عليها - بهذه الطريقة أتخلص من الإيجابيات الخاطئة للكاشف. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المنصة العلوية ، من اليسار إلى اليمين: الكاميرا ، الماكينات للتحكم في الرأس والحاجبين ، التبديل ، محطات الطاقة ، الزر الأحمر الكبير.</font></font></i><br>
<img src="https://habrastorage.org/webt/hb/ky/kk/hbkykkpwtkhtfl39aonaop5indg.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حركة المرور</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
للحركة ، يحتوي الروبوت على خمسة أجهزة: اثنان من أجهزة FS5103R ذات الدوران المستمر تدوران العجلات ؛ هناك نوعان من FS5109Ms عاديان ، أحدهما يدور الرأس ، والآخر يهز العلبة ؛ وأخيرًا ، يحرك SG90 الصغير حاجبيه.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لنكون صادقين ، بدت أجهزة SG90 المصغرة وكأنها قمامة بالنسبة لي - كان لدى أحد أجهزةي عرض نبض تحكم خاطئ ، ونجا واحد فقط من بين الأربعة الآخرين. في الإنصاف ، أخذت بطريق الخطأ أحد الخدم مع كوعي ، لكن الاثنين الآخرين ببساطة لا يمكنهما تحمل الحمل (كنت أستخدمهما في الرأس والعلبة). حتى الماكينة الأخيرة ، التي حصلت على أبسط وظيفة - تحريك الحاجبين ، يجب أن تطعن عصا من وقت لآخر حتى لا تتدحرج. مع أجهزة أخرى ، لم ألاحظ أي مشاكل. صحيح ، في بعض الأحيان يجب معايرة أجهزة الدوران المستمر بحيث لا تدور في حالة غير نشطة - لهذا يوجد منظم صغير عليها يمكن تشغيله بمفك براغي على مدار الساعة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
اتضح أن إدارة الماكينات مع Raspberry ليست بهذه البساطة. أولا ، يتم التحكم فيها بواسطة</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تعديل عرض النبض (PWM / PWM)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وفي Raspberry هناك دبابيس فقط </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يتم دعم PWM بواسطة الأجهزة</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ثانيًا ، بالطبع ، لن يكون Raspberry قادرًا على تشغيل الماكينات ، ولن يقف هذا. لحسن الحظ ، يتم حل هذه المشاكل باستخدام وحدة تحكم PWM خارجية. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adafruit PCA9685</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هو جهاز تحكم PWM 16 قناة يمكن التحكم فيه عبر </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">واجهة I2C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . كما أنه من الملائم للغاية أنه يحتوي على محطات لتزويد الطاقة للمعدات. علاوة على ذلك ، [نظريًا] من الممكن ربط ما يصل إلى 62 وحدة تحكم ، أثناء تلقي ما يصل إلى 992 دبابيس تحكم - لهذا تحتاج إلى تعيين عنوان فريد لكل وحدة تحكم باستخدام وصلات مرور خاصة. لذلك إذا كنت بحاجة فجأة إلى جيش من الماكينات - فأنت تعرف ماذا تفعل.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
للتحكم في PCA9685 ، هناك </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مكتبة</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> عالية المستوى </font><font style="vertical-align: inherit;">تعمل </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كملحق WiringPi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">العمل مع هذا الشيء مناسب تمامًا - أثناء التهيئة ، يقوم بإنشاء 16 دبابيس افتراضية يمكنك كتابة إشارة PWM فيها ، ولكن عليك أولاً حساب عدد القراد. </font><font style="vertical-align: inherit;">لتحويل ذراع المؤازرة إلى زاوية معينة في النطاق [0 ، 180] ، يجب عليك أولاً ترجمة هذه الزاوية إلى نطاق أطوال نبضة التحكم بالمللي ثانية [SERVO_MS_MIN، SERVO_MS_MAX]. </font><font style="vertical-align: inherit;">بالنسبة لجميع أجهزة بلدي ، هذه القيم هي حوالي 0.6 مللي ثانية و 2.4 مللي ثانية على التوالي. </font><font style="vertical-align: inherit;">بشكل عام ، يمكن العثور على هذه القيم في ورقة بيانات المؤازرة ، ولكن الممارسة أظهرت أنها يمكن أن تختلف ، لذلك قد تحتاج إلى التحديد. </font><font style="vertical-align: inherit;">ثم اقسم القيمة الناتجة على 20 مللي ثانية (القيمة القياسية لطول دورة التحكم) واضرب في الحد الأقصى لعدد علامات التجزئة PCA9685 (4096):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">driveDegs</span><span class="hljs-params">(<span class="hljs-keyword">float</span> angle, <span class="hljs-keyword">int</span> pin)</span> </span>{
    <span class="hljs-keyword">int</span> ticks = (<span class="hljs-keyword">int</span>) (PCA_MAX_PWM * (angle/<span class="hljs-number">180.0f</span>*(SERVO_MS_MAX-SERVO_MS_MIN) + SERVO_MS_MIN) / <span class="hljs-number">20.0f</span>); <font></font>
    pwmWrite(pin, ticks);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وبالمثل ، يتم ذلك باستخدام أجهزة الدوران المستمر - بدلاً من الزاوية ، نقوم بتعيين السرعة في النطاق [-1،1].</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لقد قمت بتجميع هيكل الروبوت ، بالإضافة إلى الجسم ، من الوسائل المرتجلة: أضع عجلات الأثاث على محركات مؤازرة للدوران المستمر ، ويعمل دعم كرة الأثاث كعجلة ثالثة. في السابق ، بدلاً من ذلك ، كانت العجلة تقف على دعم دوار ، ولكن مع هذا الهيكل كان من الصعب القيام بدورات دقيقة ، لذلك اضطررت إلى استبدالها. هناك أيضًا عجلة صغيرة أسفل العلبة لنقل جزء من الوزن من المؤازرة إلى السكن. الشيء البسيط الذي لم يكن واضحًا بالنسبة لي في البداية هو أنه يجب تثبيت أذرع المؤازرة بمسمار ، خاصة للعجلات ، بحيث لا تسقط على طول الطريق. بسبب هذا الغباء ، اضطررت إلى إعادة الهيكل مرة واحدة. لقد جعلت الروبوت أيضًا مصدًا واسعًا مصنوعًا من زوايا PVC بحيث لا يعلق كثيرًا.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن حول ما يمكنك القيام به حيال ذلك. أولاً ، يمكنك هز البرطمان وتحريك الحاجبين - لهذا تحتاج فقط إلى تحويل ذراع المؤازرة إلى زوايا محددة مسبقًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثانيًا ، يمكنك تدوير رأسك. لم أكن أريد أن يدور الرأس بأقصى سرعة للمكابح ، لأنه يحتوي على كاميرا. لذلك ، قررت تقليل السرعة برمجيًا: أحتاج إلى تحويل الرافعة بزاوية صغيرة ، ثم الانتظار لبضع ثوان - وهكذا حتى يتم الوصول إلى الزاوية المطلوبة. في هذه الحالة ، من الضروري تذكر الوضع المطلق الحالي للرأس وفي كل مرة تحقق مما إذا كان قد تجاوز الحدود المسموح بها (على الروبوت الخاص بي في نطاق [10 ، 90] درجة).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثالثًا ، يمكنك تغيير اتجاه الحركة عن طريق تغيير سرعة دوران العجلات. </font><font style="vertical-align: inherit;">بنفس الطريقة ، يمكنك تدوير المنصة ، على سبيل المثال ، لمتابعة الوجه. </font><font style="vertical-align: inherit;">تعتمد السرعة الزاوية للدوران على كل من الماكينة نفسها وموقعها على الهيكل ، لذلك من الأسهل قياسها مرة واحدة ثم أخذها في الاعتبار عند الانعطاف. </font><font style="vertical-align: inherit;">للعثور على التأخير الضروري بين تشغيل المحركات للدوران وإيقاف تشغيلها ، تحتاج إلى تقسيم وحدة الزاوية بالسرعة الزاوية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أخيرًا ، يمكنك تدوير الرأس والهيكل في وقت واحد وبشكل غير متزامن حتى لا تضيع الوقت. </font><font style="vertical-align: inherit;">أفعل ذلك على هذا النحو:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> waitRotation = <span class="hljs-built_in">std</span>::async(<span class="hljs-built_in">std</span>::launch::async, rotatePlatform, platformAngle);<font></font>
success = driveHead(headAngle);<font></font>
waitRotation.wait();<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المنصة المركزية ، من اليسار إلى اليمين: PCA9685 ، ناقل الطاقة ، Raspberry Pi ، MCP3008 ADC</font></font></i><br>
<img src="https://habrastorage.org/webt/bq/q1/8_/bqq18_ilwmgadlcsz0ydepdk44u.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التنقل</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم لم أقم بتعقيد أي شيء ، لذلك يستخدم الروبوت اثنين فقط من محددات الأشعة تحت الحمراء Sharp GP2Y0A02YK للتنقل. هذا أيضًا ليس بهذه البساطة ، لأن المستشعرات تناظرية ، لكن Raspberry ، على عكس Arduino ، </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ليس</font></a><font style="vertical-align: inherit;"> لديه </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مدخلات تناظرية</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. يتم حل هذه المشكلة عن طريق المحول التناظري إلى الرقمي (ADC / ADC) - أستخدم MCP3008 10 بت و 8 قنوات. يتم بيعها كدائرة صغيرة منفصلة ، لذلك كان لا بد من لحامها على لوحة الدوائر المطبوعة وتم لحام الدبابيس هناك أيضًا لجعلها أكثر ملاءمة للتوصيل. أيضًا ، بناء على نصيحة من بلدي الخفافيش ، الذي يتخبط أكثر في الدوائر ، قمت بحاميل مكثفين (السيراميك والكهرباء) بين أرجل مزود الطاقة والأرض لامتصاص الضوضاء من الجزء الرقمي من الدائرة بأكملها. لا ينتج المستشعر أكثر من ثلاثة فولت عند الإخراج ، لذلك يمكن توصيل 3.3 فولت مع Raspberry كجهد ADC (VREF) مرجعي - وهو نفسه بالنسبة لمزود الطاقة MCP3008 (VDD). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن التحكم في MCP3008 عبر واجهة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، ولهذا يسهل العثور </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">على كود جاهز على GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">على الرغم من ذلك ، من أجل العمل المريح مع ADC ، يلزم بعض الرقصات مع الدف.</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> <span class="hljs-title">analogRead</span><span class="hljs-params">(mcp3008Spi &amp;adc, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> channel)</span>
</span>{
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> spi_data[<span class="hljs-number">3</span>];
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> val = <span class="hljs-number">0</span>;<font></font>
<font></font>
    spi_data[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;  <span class="hljs-comment">// start bit</span>
    spi_data[<span class="hljs-number">1</span>] = <span class="hljs-number">0b10000000</span> | ( channel &lt;&lt; <span class="hljs-number">4</span>); <span class="hljs-comment">// mode and channel</span>
    spi_data[<span class="hljs-number">2</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// anything</span>
    adc.spiWriteRead(spi_data, <span class="hljs-keyword">sizeof</span>(spi_data));<font></font>
  <font></font>
    <span class="hljs-comment">// read value, combine last two bits of second byte with whole third byte</span>
    val = (spi_data[<span class="hljs-number">1</span>]&lt;&lt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0b1100000000</span>; <font></font>
    val |= (spi_data[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0xff</span>);
    <span class="hljs-keyword">return</span> val;<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يجب إرسال ثلاثة بايتات إلى MCP3008 ، حيث تتم كتابة بت البداية في البايت الأول ، والوضع ورقم القناة (0-7) في الثانية. </font><font style="vertical-align: inherit;">نستعيد أيضًا ثلاث وحدات بايت ، وبعد ذلك نحتاج إلى لصق البتتين الأقل أهمية من البايت الثاني مع جميع وحدات البت الثالثة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن بعد أن استطعنا الحصول على القيم من أجهزة الاستشعار ، نحتاج إلى معايرتها ، لأن المستشعرين قد يختلفان قليلاً عن بعضهما البعض. </font><font style="vertical-align: inherit;">بشكل عام ، تكون الشاشة من مسافة بعيدة بسبب قوة إشارة أجهزة الاستشعار هذه غير خطية وليست بسيطة للغاية ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لمزيد من التفاصيل انظر ورقة البيانات ، pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">لذلك ، يكفي التقاط معاملين ، عند ضربهما بحيث تعطي أجهزة الاستشعار قيمة 1.0 على مسافة ذات مغزى ومتساوية.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن أن تكون قراءات المستشعر صاخبة تمامًا ، خاصة على العوائق الصعبة ، لذلك أستخدم متوسط ​​متحرك موزون بشكل كبير (EWMA) لتنعيم الإشارة من كل مستشعر. </font><font style="vertical-align: inherit;">لقد اخترت معلمات التنعيم بالعين ، بحيث لا تصدر الإشارة ضوضاء ولا تتأخر كثيرًا عن الواقع. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المنظر الأمامي: البنك ، وجهاز ضبط المسافات ، والمصد.</font></font></i><br>
<img src="https://habrastorage.org/webt/kb/vw/l-/kbvwl-usmln86iqj8aq236ifhpo.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التغذية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أولاً ، دعنا نقيم التيار الذي سيستهلكه الروبوت ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حول الاستهلاك الحالي لتوت العليق والأجهزة الطرفية</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspberry Pi 2B: لا يقل عن 350 مللي أمبير ، ولكن أكثر تحت الحمل (حتى 750-820 مللي أمبير (؟)) ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الكاميرا: حوالي 250 مللي أمبير.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neute Compute Stick: استهلاك الطاقة المعلن عنه 1 واط ، بجهد 5 فولت على USB ، 200 مللي أمبير ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أجهزة استشعار الأشعة تحت الحمراء: 33 مللي أمبير لكل منها ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ورقة بيانات ، pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ؛</font></font></li>
<li>MCP3008:  ,  0.5  (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">, pdf</a>);</li>
<li>PCA9685:  , 6  (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">, pdf</a>);</li>
<li>:  ~150-200   1500-2000     (stall current),          (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"> FS5109M, pdf</a>)</li>
<li>HDMI (   ): 50 ;</li>
<li> +  ( ): ~200 .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في المجموع ، يمكن تقدير أن 1.5-2.5 أمبير يجب أن تكون كافية ، بشرط ألا تتحرك جميع الماكينات في وقت واحد تحت الحمل الثقيل. في الوقت نفسه ، يحتاج توت العليق المشروط إلى 5 فولت من الجهد ، وللخدمات المؤازرة - 4.8-6 فولت. يبقى العثور على مصدر طاقة يلبي هذه المتطلبات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ونتيجة لذلك ، قررت تشغيل الروبوت من 18650 بطارية. إذا كنت تأخذ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بطاريتين ROBITON 3.4 / Li18650</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (3.6 فولت ، 3400 مللي أمبير ، تيار التفريغ الأقصى 4875 مللي أمبير) </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">وربطهما</font></a><font style="vertical-align: inherit;"> في سلسلة ، </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">فيمكنهما</font></a><font style="vertical-align: inherit;"> إنتاج ما يصل إلى 4.8 أمبير بجهد 7.2 فولت. مع تيار استهلاك 1.5-2.5 أمبير ، يجب أن تكون كافية لمدة ساعة أو ساعتين. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالمناسبة ، البطاريات لها مصيد: على الرغم من عامل الشكل المشار إليه 18650 ، فإن أحجامها بعيدة عن</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>18</mn><mo>&amp;#x00D7;</mo><mn>650</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.653ex" height="2.009ex" viewBox="0 -755.5 3725.4 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-D7" x="1223" y="0"></use><g transform="translate(2223,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>18</mn><mo>×</mo><mn>650</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">18 \times 650</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مم - يبلغ طولها عدة مليمترات بسبب دائرة التحكم في الشحن المدمجة. وبسبب هذا ، اضطررت إلى طعن حجرة البطارية بسكين بحيث تناسبهم هناك. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يبقى فقط لخفض الجهد إلى 5 فولت. لهذا ، أستخدم محولين DC-DC منفصلين DC-DC </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وحدة الطاقة DFRobot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. تسمح لك هذه القطعة من الحديد بخفض الجهد عند جهد دخل من 3.6-25 فولت وفرق جهد لا يقل عن 0.6 فولت. للراحة ، يحتوي على مفتاح يسمح لك بتحديد 5 فولت بالضبط عند الإخراج ، أو يمكنك تكوين جهد خرج تعسفي باستخدام منظم خاص. قمت بتعيين كلا المحولين إلى 5 فولت ؛ واحد منهم يغذي التوت من خلال موصل Micro-USB ، والثاني يغذي الماكينات من خلال محطات PCA9685. يعد ذلك ضروريًا لزيادة إمدادات الطاقة للأجزاء المنطقية والطاقة من الروبوت بحيث لا تتداخل مع بعضها البعض.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في مرحلة تصحيح الأخطاء ، استخدمت مصدر طاقة صيني 9 فولت ، 2 أمبير بدلاً من البطاريات ، وكان ذلك كافيًا لعمل الروبوت - لقد قمت بتوصيله ، مثل البطاريات ، بمحولين DC-DC. لذلك ، من أجل الراحة ، قمت بإنشاء محطات على الروبوت ، يمكنك توصيل مصدر طاقة أو حجرة بطارية للاختيار من بينها. ساعد هذا كثيرًا عندما أعيدت كتابة جميع الرموز تمامًا على ROS ، واضطررت إلى تصحيح الروبوت لفترة طويلة ، بما في ذلك الماكينات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من أجل الراحة ، كان علي أيضًا عمل "حافلة كهربائية" - في الواقع ، مجرد قطعة من اللوحة مع ثلاثة صفوف من المسامير المتصلة للأرض ، 3.3 فولت و 5 فولت ، على التوالي. تتصل الحافلة بدبابيس التوت المقابلة. يتم تشغيل محددات المدى IR فقط من ناقل 5 فولت و MCP3008 و PCA9685 من ناقل 3.3 فولت.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وبالطبع ، وفقًا للتقاليد القديمة الجيدة ، أضع الزر الأحمر الكبير على الروبوت - عندما يتم الضغط عليه ، فإنه يقاطع دائرة الطاقة بالكامل. </font><font style="vertical-align: inherit;">لم يكن من الضروري استخدامه للتوقف في حالات الطوارئ ، ولكن تشغيل الروبوت بمساعدة زر أكثر ملاءمة حقًا. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المنصة السفلية ، من اليسار إلى اليمين: حجرة البطارية ، NCS ، محولات DC-DC ، محركات مؤازرة بعجلات ، محددات المدى.</font></font></i><br>
<img src="https://habrastorage.org/webt/od/tf/6b/odtf6b5gksijt0nhbflim7wrh1m.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التحكم في الروبوت</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لا توجد شبكة Wi-Fi على Raspberry Pi 2B ، لذلك يجب علي الاتصال عبر ssh عبر كابل إيثرنت (بالمناسبة ، يمكن القيام بذلك </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مباشرة من الكمبيوتر المحمول ، دون استخدام جهاز توجيه</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). اتضح هذا المخطط: نقوم بالاتصال عبر ssh عبر الكابل ، وبدء الروبوت وإزالة الكابل. ثم يمكن إعادته إلى مكانه للوصول إلى التوت مرة أخرى. هناك حلول أكثر أناقة ، لكنني قررت ألا أعقد. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حتى يمكن إيقاف الروبوت بسهولة دون إيقاف التشغيل ، أضفت مفتاحًا سوفيتيًا ضخمًا (من غواصة؟) إليه ، عند إيقاف تشغيله ، ينتهي البرنامج ويتوقف الروبوت. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتصل المفتاح بالأرض وبأحد دبابيس Raspberry GPIO ، ويمكنك القراءة منه باستخدام </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مكتبة WiringPi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs">wiringPiSetup();<font></font>
pinMode(PIN_SWITCH, INPUT);<font></font>
pullUpDnControl(PIN_SWITCH, PUD_UP);<font></font>
<span class="hljs-keyword">bool</span> value = digitalRead(BB_PIN_SWITCH);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تجدر الإشارة إلى أنه مع هذا الاتصال ، يجب سحب الجهد على الدبوس إلى 3.3 فولت ، وفي الوقت نفسه سوف ينتج إشارة عالية في الحالة المفتوحة وإشارة منخفضة في الحالة المغلقة.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ضع كل شيء معا</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الخيوط</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
الآن يجب دمج كل ما سبق في برنامج واحد يتحكم في الروبوت. </font><font style="vertical-align: inherit;">في الإصدار الأول من الروبوت ، فعلت ذلك باستخدام الخيوط ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pthread</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">هذه النسخة موجودة في الفرع </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الرئيسي</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، لكن الكود هناك مخيف جدًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يعمل البرنامج في أربعة خيوط: خيط واحد يأخذ إطارات من الكاميرا ويبدأ الكاشف على NCS ؛ </font><font style="vertical-align: inherit;">يقرأ التيار الثاني البيانات من محددات المدى ؛ </font><font style="vertical-align: inherit;">الخيط الثالث يراقب التبديل ويضبط المتغير العام </font></font><code>is_running</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">على</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا كانت متوقفة ؛ الخيط الرئيسي مسؤول عن سلوك الروبوت والتحكم المؤازر. للخيوط مؤشرات مشتركة مع الخيط الرئيسي ، والتي من خلالها يكتبون نتائج عملهم. اقتصرت المتجهات التي تخزن المعلومات حول الوجوه التي عثر عليها الكاشف على كائن المزامنة ، وأعلنت المتغيرات الشائعة الأخرى الأبسط على أنها ذرية. لتنسيق تدفق كاشف الوجه مع الخيط الرئيسي ، هناك إشارة </font></font><code>face_processed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يتم إعادة تعيينها عندما تأتي نتيجة جديدة من الكاشف ، وترتفع عندما يستخدم الخيط الرئيسي هذه النتيجة لتحديد سلوك - وهذا ضروري حتى لا تتم معالجة البيانات القديمة التي قد لا تكون ذات صلة بعد الانتقال. </font><font style="vertical-align: inherit;">
عملت نسخة </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROS</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> مع التدفقات بشكل جيد ، لكنني بدأت كل هذا لتعلم شيء ما ، فلماذا لا تتقن في نفس الوقت</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">روس</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ؟ </font><font style="vertical-align: inherit;">لقد سمعت هذا الإطار لفترة طويلة ، واضطررت حتى للعمل معه قليلاً على hackathon ، لذلك في النهاية قررت إعادة كتابة جميع التعليمات البرمجية على ROS. </font><font style="vertical-align: inherit;">يكمن هذا الإصدار من الشفرة في الفرع الافتراضي من </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ros</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ويبدو أكثر لائقًا. </font><font style="vertical-align: inherit;">من الواضح أن التنفيذ على ROS سيكون على الأغلب أبطأ من التنفيذ على التدفقات بسبب النفقات العامة لإرسال الرسائل وكل شيء آخر - السؤال الوحيد هو كم؟</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مفهوم ROS</font></font></b>
                        <div class="spoiler_text">ROS (Robot Operating System) —     ,             ,   ,        .<br>
<br>
    ,  ,  ,     (node), ,    ,       .<br>
<br>
      (topic)      (message)  ,         -    . <br>
<br>
    —   (service).         ,       ,     .      « »,    .<br>
<br>
         <code>.msg</code>  <code>.srv</code> .          .<br>
<br>
 ROS    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"> </a>.<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالنسبة إلى الروبوت الخاص بي ، لم أستخدم أي حزم جاهزة مع خوارزميات من ROS ، لكنني صممت رمز الروبوت فقط في حزمة منفصلة تتكون من خمس عقد تتواصل مع بعضها البعض باستخدام الرسائل وخدمات ROS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أبسط عقدة </font></font><code>switch_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">،، تراقب حالة التبديل. بمجرد إيقاف تشغيل التبديل ، تبدأ العقدة في إرسال رسائل غير إخبارية من النوع </font></font><code>bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">في الموضوع </font><font style="vertical-align: inherit;">إلى الرسائل غير المرغوب فيها </font></font><code>terminator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. هذه إشارة إلى العقدة الرئيسية بأن الوقت قد حان لإكمال العمل. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
العقدة الثانية ، </font></font><code>sensor_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تقرأ بشكل دوري قراءات كل من محددات المدى IR وترسلها إلى الموضوع في </font></font><code>sensor_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رسالة واحدة. كما أن هذه العقدة مسؤولة عن معالجة الإشارة: التحجيم بواسطة عوامل المعايرة والمتوسط ​​المتحرك. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
العقدة الثالثة</font></font><code>camera_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إنه مسؤول عن كل ما يتعلق بالوجوه: فهو يأخذ صورًا من الكاميرا ، ويعالجها ، ويتلقى نتائج الكاشف ، ويمررها من خلال المتتبع ، ثم يجد الوجه الأقرب إلى مركز الإطار - لا يستخدم الروبوت الباقي على أي حال ، لكنك تريد إنشاء رسائل أصغر. تحتوي الرسائل التي ترسلها العقدة إلى الموضوع </font></font><code>camera_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">على رقم الإطار ، وحقيقة وجود وجه (لأنك تحتاج أيضًا إلى معرفة عدم وجود وجه) ، والإحداثيات النسبية للركن العلوي الأيسر ، وعرض وارتفاع الوجه. هكذا يبدو وصف نوع الرسالة في الملف </font></font><code>DetectionBox.msg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">int64 count<font></font>
bool present<font></font>
float32 x<font></font>
float32 y<font></font>
float32 width<font></font>
float32 height<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
العقدة الرابعة ، </font></font><code>servo_node</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هي المسؤولة عن الماكينات. أولاً ، إنها تدعم خدمة </font></font><code>servo_action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تسمح بتنفيذ أحد الإجراءات بواسطة أجهزة مؤازرة من خلال رقمها: لوضع العقدة بأكملها في حالتها الأولية (الحاجبين ، البنك ، الرأس ، إيقاف الهيكل) ؛ نقل الرأس إلى حالته الأولية ؛ هز الجرة. يصور بحاجب واحد من ثلاثة تعبيرات (جيد ، محايد ، شرير). ثانيًا ، باستخدام الخدمة ، </font></font><code>servo_speed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يمكنك تعيين سرعات جديدة لكلتا العجلتين عن طريق إرسالهما في الطلب. لا تعيد كلتا الخدمتين أي شيء. أخيرًا ، هناك خدمة </font></font><code>servo_head_platform</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تسمح لك بتدوير الرأس و / أو الهيكل بزاوية معينة بالنسبة إلى الوضع الحالي. تعود هذه الخدمة </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا كان من الممكن إدارة الرأس جزئيًا على الأقل ، و</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">خلاف ذلك ، في حالة عندما يكون الرأس بالفعل على حدود الزاوية المسموح بها ، ونحن نحاول تحويلها إلى أبعد من ذلك. </font><font style="vertical-align: inherit;">إذا كانت الزوايا في الطلب غير صفرية ، فإن الخدمة تدور بشكل غير متزامن ، كما هو موضح أعلاه. </font><font style="vertical-align: inherit;">في الحلقة الرئيسية ، لا تفعل العقدة المؤازرة أي شيء. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هنا ، على سبيل المثال ، وصف الخدمة </font></font><code>servo_head_platform</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">float32 head_delta<font></font>
float32 platform_delta<font></font>
---<font></font>
bool head_success<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تدعم كل عقد مدرجة خدمة </font></font><code>terminate_{switch, camera, sensor, servo}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بطلب استجابة فارغ ، مما يوقف تشغيل العقدة. </font><font style="vertical-align: inherit;">يتم تنفيذه بهذه الطريقة:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بعض التعليمات البرمجية</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs">...
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">atomic_bool</span> is_running; <span class="hljs-comment">// global</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">terminate_node</span><span class="hljs-params">(std_srvs::Empty::Request &amp;req, std_srvs::Empty::Response &amp;ignored)</span> </span>{<font></font>
    is_running = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> </span>{<font></font>
    is_running = <span class="hljs-literal">true</span>;<font></font>
    ...<font></font>
    <span class="hljs-keyword">while</span> (is_running &amp;&amp; ros::ok()) {
        <span class="hljs-comment">// do stuff</span><font></font>
    }<font></font>
    ...<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تحتوي العقدة على متغير عام </font></font><code>is_running</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، تحدد قيمته الدورة الرئيسية للعقدة. تقوم الخدمة ببساطة بإعادة تعيين هذا المتغير ، ويتم مقاطعة الحلقة الرئيسية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك أيضًا عقدة رئيسية يتم </font></font><code>beggar_bot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">فيها تنفيذ المنطق الأساسي للروبوت. قبل بدء الحلقة الرئيسية، فإنه يشترك في المواضيع </font></font><code>sensor_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">و </font></font><code>camera_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يحفظ محتويات الرسائل في المتغيرات العالمية في وظائف الاستدعاء. كما أنه مشترك في الموضوع </font></font><code>terminator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، وهو رد الاتصال الذي يعيد تعيين العلم </font></font><code>is_running</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، ويقطع الحلقة الرئيسية. أيضًا ، قبل بدء الدورة ، تعلن العقدة عن واجهات خدمات العقدة المؤازرة وتنتظر بضع ثوان حتى تبدأ العقد الأخرى. بعد انتهاء الحلقة الرئيسية ، تستدعي هذه العقدة الخدمات</font></font><code>terminate_{switch, camera, sensor, servo}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، وبالتالي إيقاف تشغيل جميع العقد الأخرى ، ثم إيقاف تشغيلها بنفسها. أي عندما يتم إيقاف تشغيل المفتاح ، تكمل جميع العقد الخمس العملية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لقد أجبرني التحول إلى ROS على تغيير هيكل البرنامج كثيرًا. على سبيل المثال ، في وقت سابق كان من الممكن تغيير سرعة العجلة بتردد عالٍ ، وكان هذا يعمل بشكل جيد ، ولكن خدمة ROS تعمل بأمر أبطأ ، لذلك كان علي إعادة كتابة الرمز بحيث تم استدعاء الخدمة فقط عندما تتغير السرعة حقًا (في "الوضع الكسول"). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يسمح لك ROS أيضًا بتشغيل جميع عقد الروبوت بشكل ملائم. للقيام بذلك ، تحتاج إلى كتابة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ملف تشغيل .lunch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يسرد جميع العقد والسمات الأخرى للروبوت بتنسيق xml ، ثم قم بتشغيل الأمر:</font></font><br>
<br>
<pre><code class="plaintext hljs">roslaunch beggar_bot robot.launch</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROS مقابل pthread</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
الآن ، أخيرًا ، يمكنك مقارنة سرعة إصدار ROS وإصدار pthread. </font><font style="vertical-align: inherit;">أفعل ذلك بهذه الطريقة: يعتبر الخيط / العقدة المسؤولة عن العمل مع الكاميرا FPS (كأبطأ عنصر) ، شريطة أن يعمل كل شيء آخر أيضًا. </font><font style="vertical-align: inherit;">بالنسبة لإصدار pthread ، كنت أحصل دائمًا على FPS 9.99 أو ما شابه ، بالنسبة لإصدار ROS ، تم إصداره حوالي 8.3. </font><font style="vertical-align: inherit;">في الواقع ، هذا يكفي تمامًا لمثل هذه اللعبة ، لكن النفقات العامة ملحوظة تمامًا.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">سلوك الروبوت</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الفكرة بسيطة للغاية: إذا رأى الروبوت شخصًا ، فيجب أن يقود إليه ويهز العلبة. إن اهتزاز البرطمان أمر بسيط وممتع ، ولكن عليك أولاً الوصول إلى الشخص. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك وظيفة </font></font><code>follow_face</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، إذا كان هناك وجه في الإطار ، يقوم بتدوير الهيكل ورأس الروبوت في اتجاهه (يتم أخذ الوجه الأقرب إلى المركز فقط في الاعتبار). هذا ضروري حتى يحافظ الروبوت دائمًا على مساره على الشخص ، إذا كان في الإطار ، وينظر أيضًا مباشرة في الوجه عندما يهز البرطمان. </font><font style="vertical-align: inherit;">يتم استخدام نفس المتغير </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لمزامنة هذه الوظيفة مع الموضوع </font></font><code>camera_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><code>face_processed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، كما في الإصدار مع الجداول. الفكرة هي نفسها - نريد معالجة البيانات مرة واحدة فقط ، لأن الروبوت يتحرك باستمرار. تنتظر الوظيفة أولاً حتى يؤدي رد الموضوع مع عمليات الكشف إلى تقليل علامة معالجة الإطار الأخير. أثناء انتظارها ، تتصل باستمرار </font></font><code>ros::spinOnce()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لتلقي رسائل جديدة (بشكل عام ، يجب أن يتم ذلك في أي مكان يتوقع فيه البرنامج بيانات جديدة). إذا كان هناك وجه في الإطار ، يتم حساب الزوايا ، والتي تحتاج إلى تدوير المنصة والرأس - يمكن القيام بذلك من خلال معرفة الإحداثيات النسبية لمركز الوجه ومجال رؤية الكاميرا أفقيًا وعموديًا. بعد ذلك ، يمكنك الاتصال بالخدمة </font></font><code>servo_head_platform</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وتحريك الروبوت.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك نقطة واحدة خفية: معلومات حول وضع الوجه متخلفة عن الحركة الفعلية للوجه وقد تتخلف عن حركات الروبوت نفسه. لذلك ، يمكن للروبوت أن يبالغ في تقدير زاوية الدوران ، والتي بسببها يبدأ الرأس في التحرك ذهابًا وإيابًا مع السعة المتزايدة. لمنع حدوث ذلك ، أقوم بالتأخير بعد النقل (300 مللي ثانية) ، وأتخطى أيضًا إطارًا واحدًا بعد النقل. لنفس الغرض ، يتم ضرب زوايا دوران الهيكل والرأس بعامل 0.8 (تكون المكونات P </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لوحدة التحكم PID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> منطقية </font><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وظيفة</font></font><code>follow_face</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يعيد حالة الشخص. </font><font style="vertical-align: inherit;">يمكن للشخص: أن يكون غائبًا ، وأن يكون قريبًا بما فيه الكفاية من المركز ، وأن يكون بعيدًا جدًا عن الروبوت ؛ </font><font style="vertical-align: inherit;">خيار آخر - عندما قمنا بتشغيل الروبوت ولا نعرف ما حدث للوجه (في عملية البحث) ؛ </font><font style="vertical-align: inherit;">لا تزال هناك حالة نادرة عندما يكون الرأس على الحدود ، وهذا هو السبب في أنه من المستحيل اللجوء إلى الوجه. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يحدث شيء بسيط إلى حد ما في الحلقة الرئيسية:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اتصل </font></font><code>follow_face</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حتى يحصل الشخص على حالة معينة (أي ، باستثناء "في عملية البحث"). </font><font style="vertical-align: inherit;">في نهاية هذه الخطوة ، سينظر الروبوت مباشرة في الوجه.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا تم العثور على الوجه وهو قريب: </font></font><br>
 <ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هز العلبة</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ابحث عن الوجه مرة أخرى ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا كان الوجه في مكانه ، قم بعمل تعبير جيد بالحاجبين وهز البرطمان مرة أخرى ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا اختفى الوجه ، قم بعمل تعبير غاضب بالحاجبين.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إستدر ، إذهب إلى بداية الدورة.</font></font></li>
</ol><br>
 </li>
<li>   (  ) —   :<br>
 <ol>
<li>       —   (   ,    ,    );</li>
<li>     ,      <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x222A;</mo><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>180</mn><mo>,</mo><mo>&amp;#x2212;</mo><mn>90</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.479ex" height="2.634ex" viewBox="0 -809.3 9678.3 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2C" x="1279" y="0"></use><g transform="translate(1724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5D" x="3226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-222A" x="3726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5B" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2212" x="4895" y="0"></use><g transform="translate(5673,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2C" x="7175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2212" x="7620" y="0"></use><g transform="translate(8398,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5D" x="9399" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy="false">]</mo><mo>∪</mo><mo stretchy="false">[</mo><mo>−</mo><mn>180</mn><mo>,</mo><mo>−</mo><mn>90</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">[90, 180] \cup [-180, -90]</script>;</li>
<li>     ,        <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>90</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.815ex" height="2.634ex" viewBox="0 -809.3 2503.7 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2C" x="779" y="0"></use><g transform="translate(1224,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5D" x="2225" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>90</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">[0, 90]</script>;</li>
<li>      (, ),          <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x222A;</mo><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>180</mn><mo>,</mo><mo>&amp;#x2212;</mo><mn>90</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.479ex" height="2.634ex" viewBox="0 -809.3 9678.3 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2C" x="1279" y="0"></use><g transform="translate(1724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5D" x="3226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-222A" x="3726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5B" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2212" x="4895" y="0"></use><g transform="translate(5673,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2C" x="7175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-2212" x="7620" y="0"></use><g transform="translate(8398,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/500150/&amp;usg=ALkJrhh2e_3tgeLNPsShL_clZF-1ywAEIA#MJMAIN-5D" x="9399" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>90</mn><mo>,</mo><mn>180</mn><mo stretchy="false">]</mo><mo>∪</mo><mo stretchy="false">[</mo><mo>−</mo><mn>180</mn><mo>,</mo><mo>−</mo><mn>90</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">[90, 180] \cup [-180, -90]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ؛</font></font></li>
</ol><br>
 </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لا تدعي هذه الخوارزمية أنها ذكاء اصطناعي قوي ، ومع ذلك ، فإن السلوك العشوائي والمصد الواسع يسمح للروبوت بالخروج من أي موضع تقريبًا عاجلاً أم آجلاً.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">استنتاج</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
على الرغم من بساطته الواضحة ، يغطي هذا المشروع العديد من الموضوعات غير التافهة: العمل مع أجهزة الاستشعار التناظرية ، والعمل مع PWM ، رؤية الكمبيوتر ، تنسيق المهام غير المتزامنة. </font><font style="vertical-align: inherit;">بالإضافة إلى ذلك ، إنها مجرد متعة جنونية. </font><font style="vertical-align: inherit;">ربما ، سأفعل شيئًا أكثر فائدة ، ولكن أكثر مع التحيز في التعلم العميق. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كمكافأة - المعرض:</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/el/cw/jd/elcwjdoa21liogjvhakstzg-yru.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/il/12/fp/il12fpucbbreblnwyb2ojwsfmwu.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/3w/kr/7m/3wkr7mfjqjo2b_f9kvekia82ztq.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/z4/3q/wr/z43qwrmlfgwndbi3dw-jnvxzqew.jpeg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar500140/index.html">"حتى 10 آلاف": أكثر من 25 مراجعة لسماعات الرأس</a></li>
<li><a href="../ar500142/index.html">إدارة الحقوق على مستوى المنشأة</a></li>
<li><a href="../ar500144/index.html">ديفيد أوبراين (Xirus): المقاييس! المقاييس! المقاييس! الجزء الأول</a></li>
<li><a href="../ar500146/index.html">البحث عن وظيفة في ألمانيا كمدير منتج وأكثر من ذلك. الجزء 3/5. ما عليك القيام به قبل البدء في إرسال السير الذاتية</a></li>
<li><a href="../ar500148/index.html">مرشح جدار الحماية Mikrotik: نص يولد الأساس لسياسة التصفية</a></li>
<li><a href="../ar500152/index.html">كيف قمت بدمج POS-terminal و FR IKKM-Touch في 1C: enterprise</a></li>
<li><a href="../ar500154/index.html">التعلم الآلي السري. مكتبة PySyft</a></li>
<li><a href="../ar500158/index.html">تفاعل SwiftUI مع Redux</a></li>
<li><a href="../ar500160/index.html">العناصر البصرية</a></li>
<li><a href="../ar500162/index.html">بيثون رائع تعليمي معالجة البيانات الرياضية</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>