<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐝 🔨 #⃣ 我们如何学会推荐电影，以及为什么您不应该仅依赖评级 ⏏️ 👧🏾 📮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="想象一下，您想度过一整晚看电影，却不知道该选择哪一个。 Yandex用户经常会遇到相同的情况，因此我们的团队会提出可以在Search和Air上找到的建议。看来这很复杂：我们会给用户打分，在他们的帮助下，我们训练汽车来寻找可能给满分5分的电影，并获得一份现成的电影清单。但是这种方法行不通。为什么？那就...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>我们如何学会推荐电影，以及为什么您不应该仅依赖评级</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/497390/"><img src="https://habrastorage.org/webt/vu/_4/oo/vu_4oolbpa8pde7nsycpg5vpokq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
想象一下，您想度过一整晚看电影，却不知道该选择哪一个。 Yandex用户经常会遇到相同的情况，因此我们的团队会提出可以在Search和Air上找到的建议。看来这很复杂：我们会给用户打分，在他们的帮助下，我们训练汽车来寻找可能给满分5分的电影，并获得一份现成的电影清单。但是这种方法行不通。为什么？那就是我今天要告诉你的。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有点历史。早在2006年，Netflix发起了Netflix Prize机器学习竞赛。如果您突然忘记了，那么该公司尚未在Internet上流式传输，而是租借了DVD上的电影。但是即使如此，对于她来说，预测用户的评分也很重要，以便向他推荐一些东西。因此，竞争的本质是：根据RMSE指标，预测观众的收视率比Netflix推荐系统Cinematch好10％。这是此类首批大规模比赛之一。兴趣激起了巨大的数据集（超过1亿个评分），以及100万美元的奖金。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
比赛于2009年结束。</font><font style="vertical-align: inherit;">BellKor的Pragmatic Chaos和The Ensemble团队以相同的结果（RMSE = 0.8567）到达了终点，但是The Ensemble排名第二，因为他们比竞争对手晚了20分钟发送解决方案。</font><font style="vertical-align: inherit;">结果和工作可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是最有趣的事情是不同的。</font><font style="vertical-align: inherit;">如果您相信在专业会议上的重复报道，那么获奖算法就不会出现在即将推出的视频流服务中。</font><font style="vertical-align: inherit;">我无法说出其他人做出决定的原因，但我会告诉您为什么我们这样做。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">个人评价</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在相当长的一段时间内，Yandex用户可以对他们观看的电影进行评分。不仅在KinoPoisk，而且在搜索结果中。随着时间的流逝，我们已经积累了数以亿计的估计数以千万计的人。在某个时候，我们决定使用这些数据来帮助用户了解他们想要一部电影的程度。实际上，我们解决了与Netflix奖竞赛中相同的问题，即我们预测了用户对这部电影的评价。那时，KinoPoisk和IMDB评级已经存在，它们是根据人们的评级建立的。我们建立了个人评分，因此我们决定使用单独的量表作为百分比，以避免视觉上的相似和混淆。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dd/tk/h7/ddtkh7i3ud_9q5lmqtvw-4ambgc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一下，需要将点数比例和百分比相关联是一个单独的，不明显的头痛，因此，我将简要地讨论一下。</font><font style="vertical-align: inherit;">对于10分制，似乎每个分都占10％-而该分在帽子里。</font><font style="vertical-align: inherit;">但不是。</font><font style="vertical-align: inherit;">原因是心理和习惯。</font><font style="vertical-align: inherit;">例如，从用户的角度来看，8/10的评分比80％好得多。</font><font style="vertical-align: inherit;">如何关联呢？</font><font style="vertical-align: inherit;">随着众包！</font><font style="vertical-align: inherit;">因此我们做到了：我们在Tolok中启动了任务，其中射击者描述了具有一定分数或个人评价百分比的电影的期望。</font><font style="vertical-align: inherit;">基于此标记，我们选择了一个功能，可将分数的预测从点转换为百分比，从而保持用户的期望。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tolok的样本任务</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/tw/fv/ux/twfvuxxkjd7rnkave0yuudmzs5q.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
预测电影的期望是有用的，但是也可以建立推荐。</font><font style="vertical-align: inherit;">也就是说，立即向该人显示好电影列表。</font><font style="vertical-align: inherit;">那时，您中的许多人可能会认为：“然后，让我们根据用户的个人排名对用户未观看的电影进行排序。” </font><font style="vertical-align: inherit;">一开始我们也是这么认为的。</font><font style="vertical-align: inherit;">但是后来我不得不解决两个问题。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工具问题</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当用户搜索特定电影（或想要租借特定DVD）时，服务必须预测该特定电影的等级。确实，在使用RMSE指标的Netflix竞赛中解决了这个问题。但是这些建议解决了一个不同的问题：您不必猜测成绩，而可以找到最终可以观看的电影。而且，RMSE指标在这方面做得不好。例如，预测等级为2而不是1的罚款与5而不是4的罚款完全相同。但是我们的系统绝不建议用户放2的电影！基于列表的度量标准更适合此任务，例如Precision @ K，Recall @ K，MRR或NDCG。我不禁要告诉您更多有关它们的信息（但是，如果您对指标不感兴趣，请跳过下一段）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们从指标开始。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MRR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（平均倒数排名）。我们将看看在测试期间用户与之互动（例如，观看或称赞）的电影在排名中的哪个位置。 MRR度量是此类电影的用户平均反向位置。即</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>R</mi><mi>R</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>u</mi></msub></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.7ex" height="4.259ex" viewBox="0 -1132.2 10204.2 1833.9" role="img" focusable="false" style="vertical-align: -1.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-52" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-52" x="1811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-3D" x="2848" y="0"></use><g transform="translate(3626,0)"><g transform="translate(397,0)"><rect stroke="none" width="1056" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-31" x="496" y="582"></use><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="1046" y="0"></use></g></g></g><g transform="translate(5367,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJSZ1-2211" x="0" y="0"></use><g transform="translate(1056,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="1046" y="0"></use></g><g transform="translate(1056,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-3D" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-31" x="1351" y="0"></use></g></g><g transform="translate(7833,0)"><g transform="translate(286,0)"><rect stroke="none" width="1964" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-31" x="1138" y="582"></use><g transform="translate(60,-403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-61" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-6E" x="981" y="0"></use><g transform="translate(1118,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-75" x="737" y="-213"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>R</mi><mi>R</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>u</mi></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-1">MRR = \frac{1}{|U|} \sum_{u=1}^{|U|} \frac{1}{rank_u}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。与RMSE不同，此指标可评估整个列表，但不幸的是，它仅查看第一个猜测的元素。但是，很容易修改度量标准以消除此缺点。我们可以计算与用户互动的所有电影的反向位置之和。此度量标准称为“平均倒数排名”。此度量标准考虑了该期中所有可能的电影。请注意，支出中的位置k对于猜电影，权重为1 / k，对于另一部电影，权重为0。通常，使用1 / log（k）代替1 / k：这更可能与用户滚动到k位置的概率相对应。结果是DCG指标（折后的累计增益）</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mi>C</mi><mi>G</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mfrac><mrow><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.927ex" height="4.384ex" viewBox="0 -1186 16329.6 1887.7" role="img" focusable="false" style="vertical-align: -1.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-43" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-47" x="1589" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-3D" x="2653" y="0"></use><g transform="translate(3431,0)"><g transform="translate(397,0)"><rect stroke="none" width="1056" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-31" x="496" y="582"></use><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="1046" y="0"></use></g></g></g><g transform="translate(5172,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJSZ1-2211" x="0" y="0"></use><g transform="translate(1056,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-7C" x="1046" y="0"></use></g><g transform="translate(1056,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-3D" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-31" x="1351" y="0"></use></g></g><g transform="translate(7805,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJSZ1-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-4E" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-6F" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-73" x="989" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-3D" x="1458" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-31" x="2237" y="0"></use></g></g><g transform="translate(10897,0)"><g transform="translate(286,0)"><rect stroke="none" width="5025" height="60" x="0" y="220"></rect><g transform="translate(1421,614)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-61" x="480" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-69" x="1010" y="0"></use><g transform="translate(958,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-6E" x="0" y="0"></use><g transform="translate(424,-107)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-6F" x="503" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-73" x="989" y="0"></use></g></g></g><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-6D"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-61" x="833" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-78" x="1334" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-28" x="1862" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-31" x="2252" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-2C" x="2752" y="0"></use><g transform="translate(2143,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-6C"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-6F" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-67" x="779" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-28" x="4310" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-70" x="4700" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-6F" x="5203" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMATHI-73" x="5689" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-29" x="6158" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhht-4Fo_DoHBLU7z8WGIfHhKBzwHA#MJMAIN-29" x="6548" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mi>C</mi><mi>G</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><mfrac><mrow><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><mrow><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-2">DCG = \frac{1}{|U|} \sum_{u=1}^{|U|} \sum_{pos=1}^{N} \frac{gain_{pos}}{\max(1, \log(pos))}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是不同用户对度量的贡献是不同的：对于一个我们猜出所有电影的人，对于一个我们什么都猜不到的人。</font><font style="vertical-align: inherit;">因此，通常，该度量被标准化。</font><font style="vertical-align: inherit;">将每个用户的DCG划分为该用户的最佳DCG。</font><font style="vertical-align: inherit;">所得度量称为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NDCG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（归一化折现累计收益）。</font><font style="vertical-align: inherit;">它被广泛用于评估排名质量。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，每个任务都有其自己的指标。</font><font style="vertical-align: inherit;">但是下一个问题并不是那么明显。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择问题</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
很难描述，但我会尝试。事实证明，人们对</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">观看</font><font style="vertical-align: inherit;">的电影没有给予很高的评价</font><font style="vertical-align: inherit;">。罕见的电影杰作，经典作品，艺术工作室获得最高分，但这并不能阻止人们在下班后的晚上高兴地观看一部好的喜剧，一部新的动作片或一部壮观的太空歌剧。除此之外，Yandex上的用户并没有欣赏他们曾经在某个地方观看过的所有电影。而且，如果我们只关注最高收视率，那么就有冒险获得推荐的电影供稿的风险，该供稿看起来很合逻辑，用户甚至可能会意识到其质量，但最终他们什么也不会看。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，如果我们按个人评分对电影供稿进行调整，而过去对我的观看情况一无所知，这就是我的电影供稿的外观。很棒的电影。但是我今天不想复习它们。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5y/gz/ot/5ygzotyougvrodtwyb_nlbp03va.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实证明，在收视率分散和缺少高收视率电影的情况下，不仅值得看一下收视率。好吧，然后我们训练汽车来预测推荐电影的观看情况，而不是评分。这似乎是合乎逻辑的，因为用户希望这样做。可能出什么问题了？问题在于，磁带上将充满胶片，每个胶片都非常适合在晚上轻松消遣，但是他们的个人评价会很低。用户当然会注意磁带中没有“杰作”的事实，这意味着建议的可信度将受到损害，他们将看不到他们会看到的东西。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，我们了解到，需要在两个极端之间取得平衡。有必要对机器进行培训，以便同时考虑观看和推荐的可能性。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们的建议如何运作</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的系统是搜索的一部分，因此我们需要非常快速地建立建议：服务的响应时间应少于100毫秒。</font><font style="vertical-align: inherit;">因此，在数据准备阶段，我们尝试脱机执行尽可能多的繁重操作。</font><font style="vertical-align: inherit;">推荐系统中的所有电影和用户均由配置文件表示（不要与帐户混淆，这一点很重要），其中包括对象键，计数器和嵌入（换言之，一定空间中的向量）。</font><font style="vertical-align: inherit;">影片简介每天都在YT（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读作“ Yt”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）上准备，并加载到响应请求的机器的RAM中。</font><font style="vertical-align: inherit;">但是对于用户而言，一切都有些复杂。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每天，我们还在YT上建立主要用户配置文件，并将其发送到Yandex商店，从那里您可以在几十毫秒内获得该配置文件。但是，如果有人积极观看和评估视频，数据很快就会过时。如果建议开始落后，那就不好了。因此，我们读取用户事件流并形成概要文件的动态部分。当有人输入请求时，我们会将存储库中的配置文件与动态配置文件结合在一起，并获得一个配置文件，该配置文件可能仅落后于实际情况几秒钟。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是离线（即提前）发生的，现在我们直接进入运行时。这里的推荐系统包括两个步骤。对整个电影数据库进行排名的时间太长，因此第一步，我们仅选择几百个候选电影，也就是说，我们发现了观众可能感兴趣的电影。这既包括受欢迎的绘画，也包括在某些嵌入物中接近用户的绘画。有几种算法可以快速找到最近的邻居，我们使用HNSW（分层导航小世界）。有了它，我们可以在几毫秒内找到距离用户最近的电影。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二步中，我们按电影，用户和用户/电影对提取特征（有时也称为因子），并使用</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">CatBoost</font></a><font style="vertical-align: inherit;">对候选者进行</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">排名</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">让我提醒您：我们已经意识到，我们不仅需要专注于意见，还需要专注于建议的其他质量特征，因此，为了进行排名，我们采用了针对各种目标训练的几种CatBoost模型的组合。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了找到候选者，我们使用了几种矩阵分解中的嵌入方法：从预测评估的ALS经典版本到基于SVD ++的更复杂的变体。</font><font style="vertical-align: inherit;">作为排名的功能，使用了简单的用户事件计数器和影片，各种事件的CTR以及更复杂的预训练模型。</font><font style="vertical-align: inherit;">例如，ALS预测也可以用作特征。</font><font style="vertical-align: inherit;">最有用的模型之一是Recommender DSSM神经网络，我可能会再谈一点。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">推荐DSSM</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DSSM是一个两塔神经网络。每个塔都建立自己的嵌入，然后考虑嵌入之间的余弦距离，该数字是网络输出。也就是说，网络学习评估左侧和右侧塔楼中对象的接近程度。例如，在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络搜索</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中使用了类似的神经网络</font><font style="vertical-align: inherit;">来查找与查询相关的文档。对于搜索任务，将请求发送到其中一个塔楼，将文档发送到另一个塔楼。对于我们的网络，请求的角色由用户扮演，影片充当文档。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
电影塔基于电影数据进行嵌入：这是标题，描述，体裁，国家/地区，演员等。网络的这一部分与搜索部分非常相似。但是，对于观看者，我们想使用他的故事。为此，我们将故事中电影的嵌入与事件发生后时间的推移进行汇总。然后，在总嵌入的基础上，我们应用了网络的几层，因此得到了大小为400的嵌入。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lt/3k/v0/lt3kv0xtsbzqiyxq_333j3sgkua.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您在嵌入时立即考虑到用户的整个历史记录，这将大大减慢培训速度。</font><font style="vertical-align: inherit;">因此，我们将分两步进行学习，并学习网络。</font><font style="vertical-align: inherit;">首先，学习更简单的InnerDSSM。</font><font style="vertical-align: inherit;">在入口处，他仅接收用户历史记录中的最近50个事件，而没有划分事件的类型（观看次数，评分等）。</font><font style="vertical-align: inherit;">然后，我们将在整个用户历史记录中对生成的InnerDSSM进行重新训练，但会细分为事件类型。</font><font style="vertical-align: inherit;">因此，我们获得了OuterDSSM，它在运行时中使用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在额头上使用运行时网络需要大量的计算资源。</font><font style="vertical-align: inherit;">因此，我们将电影塔中的嵌入内容保存在数据库中，并且根据用户历史记录的嵌入内容几乎实时更新。</font><font style="vertical-align: inherit;">因此，在处理请求期间，您仅需要应用OuterDSSM的一小部分并计算余弦，这不会花费太多时间。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们的建议已经可以在</font><font style="vertical-align: inherit;">Yandex.Air服务</font><font style="vertical-align: inherit;">的搜索中找到（例如，通过请求</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[看什么]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），并且Yandex.Station中也使用了该技术的改进版本。</font><font style="vertical-align: inherit;">但这并不意味着我们可以放松。</font><font style="vertical-align: inherit;">我们不断训练新模型，应用越来越多的数据，尝试新的训练方法和新的质量指标。</font><font style="vertical-align: inherit;">我认为，该地区越老，开发难度就越大。</font><font style="vertical-align: inherit;">但这是专家的主要兴趣。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN497376/index.html">红脸颊怎么办，使鼻子不长</a></li>
<li><a href="../zh-CN497382/index.html">大流行期间敏捷团队面临的8个困难：“ Ndagwurugwu nke anya mmiri”，ụjọ，oke iwe，agnar，COVID-19</a></li>
<li><a href="../zh-CN497384/index.html">如何在远程模式下建立对服务器的安全访问</a></li>
<li><a href="../zh-CN497386/index.html">VK奖学金研究员谈论远程学习，学科和社会化的未来</a></li>
<li><a href="../zh-CN497388/index.html">从零开始的百万富翁射击游戏：独立开发者之路</a></li>
<li><a href="../zh-CN497392/index.html">如何从学生成长为软件工程师？</a></li>
<li><a href="../zh-CN497394/index.html">四月份免费提供十项带有计算机科学课程的资源</a></li>
<li><a href="../zh-CN497396/index.html">同事：既不是朋友也不是敌人，但是如何？</a></li>
<li><a href="../zh-CN497398/index.html">AMD EPYC Rome 7x32服务器处理器-记录单核性能</a></li>
<li><a href="../zh-CN497402/index.html">如何创建Python编程语言？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>