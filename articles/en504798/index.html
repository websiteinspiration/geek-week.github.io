<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§õüèΩ üëãüèæ üêÜ Artificial Intelligence Watch Complaints üë®üèº‚Äçüç≥ üí∑ üé¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Any financial organization is a living organism and the processes in it are imperfect. Process imperfections give rise to customer dissatisfaction, wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Artificial Intelligence Watch Complaints</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504798/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/hj/o8/nj/hjo8njqdctiheow1_8sejspu94m.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Any financial organization is a living organism and the processes in it are imperfect. </font><font style="vertical-align: inherit;">Process imperfections give rise to customer dissatisfaction, which can even transform into complaints. </font><font style="vertical-align: inherit;">In this article, we will talk about our contribution to the automation process by implementing a small Machine Learning project. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can try to solve any difficult task using simple methods, and Machine Learning is no exception.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Feedback is the most valuable information, so you should study as much as possible every bit of it. Analyzing complaints from customers, we objectively see in which business processes problems arise. Since processes are often interconnected, they can be grouped and considered as a group. Accordingly, we come to the standard task Machine Learning (ML) - ‚Äúmulticlass classification‚Äù. As a result of this analysis, the task is solved - the collection of consolidated analytics for the organization. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The classification task is a task in which there are many objects divided into classes in a certain way. In the case of multiclass classification, the number of classes must be more than 2 and can even reach many thousands.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Data on complaints and responses to them is stored on the server, the process of unloading and pre-processing is carried out as a standard through a request to the database, at the output we get a data frame with the data with which we will work. </font><font style="vertical-align: inherit;">The complaint and the answer to it are quite lengthy documents. </font><font style="vertical-align: inherit;">For example, the response to a complaint can reach hundreds or even thousands of words. </font><font style="vertical-align: inherit;">Processing such text directly is very costly (computationally), which is why text preprocessing is necessary.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">review_to_wordlist</span>(<span class="hljs-params">review</span>):</span>
       		review_text = re.sub(<span class="hljs-string">'[^--]'</span>,<span class="hljs-string">' '</span>, review)<font></font>
       		words = review_text.strip().lower().split()<font></font>
       		words = [w <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> words <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> w <span class="hljs-keyword">in</span> stop_words] <font></font>
       		words = [morph.parse(w)[<span class="hljs-number">0</span>].normal_form <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> words]<font></font>
       		new_stop_words = find_names(words)<font></font>
       		words = [w <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> words <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> w <span class="hljs-keyword">in</span> new_stop_words]
       		<span class="hljs-keyword">return</span> words</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Accuracy according to the model substantially depends on the uniqueness of the text, therefore it is necessary to remove words from the text that do not carry much meaning - ‚Äústop words‚Äù. </font><font style="vertical-align: inherit;">Usually the composition of words includes prepositions, conjunctions, and other insignificant parts of speech. </font><font style="vertical-align: inherit;">We also supplemented the stop words dictionary with first and middle names.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_names</span>(<span class="hljs-params">words, prob_thresh = <span class="hljs-number">0.4</span></span>):</span>
    words = [w <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> words <span class="hljs-keyword">if</span> <span class="hljs-string">'str'</span> <span class="hljs-keyword">in</span> str(type(w))]<font></font>
    add_stop_words = [w <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> words <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> morph.parse(w) <span class="hljs-keyword">if</span> <span class="hljs-string">'Name'</span> <span class="hljs-keyword">in</span> p.tag <span class="hljs-keyword">and</span><font></font>
    p.score &gt;= prob_thresh]<font></font>
    stop_words.update(add_stop_words)<font></font>
    <span class="hljs-keyword">return</span> stop_words</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prior to the implementation of the project, classification was carried out manually, therefore, we have data marked up by experts. </font><font style="vertical-align: inherit;">And this is a classic ML teaching task with a teacher. </font><font style="vertical-align: inherit;">The pre-processed text is reduced to a view that the model can process. </font><font style="vertical-align: inherit;">To do this, we translate the responses to complaints into feature vectors (the independent variable used in the code is features, the dependent variable is labels).</font></font><br>
<br>
<pre><code class="python hljs">tfidf = TfidfVectorizer(sublinear_tf=<span class="hljs-literal">True</span>, min_df=<span class="hljs-number">5</span>, norm=<span class="hljs-string">'l2'</span>, encoding=<span class="hljs-string">'utf8'</span>,  <font></font>
    ngram_range=(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>), stop_words=stop_words)<font></font>
features = tfidf.fit_transform(df_temp[<span class="hljs-string">'Consumer_complaint_narrative'</span>])<font></font>
labels = df_temp[<span class="hljs-string">'Num_bp'</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linear Support Vector Classification is selected for classification. </font><font style="vertical-align: inherit;">This was done for the following reasons:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">high efficiency when working with measurements of large dimension;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stable work in case of excess of dimension over the number of samples.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This project has been prepared for implementation in the prom. </font><font style="vertical-align: inherit;">Every day, the model will carry out the classification of data entered during the working day. </font><font style="vertical-align: inherit;">At the initial stage, an additional manual verification of the model‚Äôs work by an expert is supposed. </font><font style="vertical-align: inherit;">Once a month, the model will be retrained. </font><font style="vertical-align: inherit;">The implementation of this project allowed us to take one step closer to the future!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en504784/index.html">Sectigo's AddTrust root certificate expired on May 30, 2020, which caused problems in OpenSSL 1.0.x and GnuTLS clients</a></li>
<li><a href="../en504786/index.html">Everything you need to know about caching</a></li>
<li><a href="../en504790/index.html">A selection of articles on machine learning: cases, guides and studies for May 2020</a></li>
<li><a href="../en504792/index.html">Duty boarding house. How NSPK saved its duty room from a coronavirus</a></li>
<li><a href="../en504796/index.html">Udalenka is cool. Maybe stay forever?</a></li>
<li><a href="../en504800/index.html">dracut + systemd + LUKS + usbflash = auto unlock</a></li>
<li><a href="../en504804/index.html">Something that integrates chicken leg and iPhone 11</a></li>
<li><a href="../en504806/index.html">We analyze the masterpieces of painting with the help of classic ML</a></li>
<li><a href="../en504808/index.html">Hammock Driven Development - Rich Hickey (with Russian translation)</a></li>
<li><a href="../en504812/index.html">Instacart Human Delivery Price</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>