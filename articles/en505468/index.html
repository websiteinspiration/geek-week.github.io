<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ß üï∞Ô∏è üë¥üèæ Email Archiving in Zimbra Collaboration Suite Open-Source Edition üçÆ üíí ü§∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Archiving mail with the ability to view it in the future is an important function for large businesses. It can be used to handle various complaints, c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Email Archiving in Zimbra Collaboration Suite Open-Source Edition</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zimbra/blog/505468/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archiving mail with the ability to view it in the future is an important function for large businesses. It can be used to handle various complaints, conduct investigations, and in a number of other situations. This function is also useful for SaaS providers to protect themselves in the event that an unscrupulous user uses their service to commit illegal actions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Especially for these purposes, the Zimbra Archiving and Discovery plugin was created, which allows you to archive outgoing and incoming letters in each mailbox and even letters saved in draft messages. However, this decision is not without drawbacks. Firstly, it works only with the paid Zimbra Collaboration Suite Network Edition, and secondly, it works only within the framework of the web client and when using desktop or mobile mail clients it will not archive anything. In this regard, we will tell you about how to implement archiving of incoming and outgoing mail in the free ZImbra Collaboration Suite Open-Source Edition. which, in addition, will archive letters that are sent from any email clients.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/op/xi/ie/opxiieyaijocgswpkt2td6f4-u0.png" alt="image"><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Archiving mail is implemented through the built-in Postfix BCC function. </font><font style="vertical-align: inherit;">It works as follows: the system administrator sets the archive mail address for the mailbox, enter certain settings, after which each incoming and outgoing letter will be copied to archive mail, in which you can later find the letter you need. </font><font style="vertical-align: inherit;">We recommend creating a separate domain for the mail archive. </font><font style="vertical-align: inherit;">This will greatly simplify the management of archive mailboxes in the future.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archiving Outgoing Emails</font></font></h4><br>
<img src="https://habrastorage.org/webt/zt/le/ip/ztleipulglmkhl7kgwyrlafhd7a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's configure archiving of outgoing letters. For example, take the manager@company.ru account and make an archive mailbox manager@archive.company.ru for it. In order for outgoing mail to be archived, you need to make a number of changes to the Postfix settings. To do this, open the file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/opt/zimbra/postfix/conf/main.cf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the line </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sender_bcc_maps = lmdb: / opt / zimbra / postfix / conf / sender_bcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at its end </font><font style="vertical-align: inherit;">. After that, you need to create the file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ opt / zimbra / postfix / conf / sender_bcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the mailboxes that you plan to archive into it, as well as the mailboxes to which the archived letters will be sent. It is possible to archive several mailboxes into one. This is done as follows:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manager@company.ru manager@archive.company.ru </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sales@company.ru manager@archive.company.ru </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
support@company.ru support@archive.company.ru</font></font></blockquote><br>
<img src="https://habrastorage.org/webt/zt/le/ip/ztleipulglmkhl7kgwyrlafhd7a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After all mailboxes have been added, all you have to do is run the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postmap / opt / zimbra / postfix / conf / sender_bcc command</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and reload Postfix using the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postfix reload</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">As follows from our example, after a reboot, all outgoing letters from the accounts manager@company.ru and sales@company.ru will be sent to the same mailbox manager@archive.company.ru, and outgoing letters from the account support@company.ru will be archived in the mailbox support@archive.company.ru</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archiving Incoming Emails</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now set up automatic archiving of incoming emails. You can use the same Postfix BCC for this. As in the case of archiving outgoing messages, you need to open the file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/opt/zimbra/postfix/conf/main.cf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the line </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recipient_bcc_maps = lmdb: / opt / zimbra / postfix / conf / recipient_bcc to it</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . After that, you need to create the file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ opt / zimbra / postfix / conf / recipient_bcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the necessary email addresses to it in the previous format. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fe/uj/b8/feujb8otepa2ydyonxn_fsex8p0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After adding the boxes, you need to run the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postmap / opt / zimbra / postfix / conf / recipient_bcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command and restart Postfix using the </font><b><font style="vertical-align: inherit;">postfix reload</font></b><font style="vertical-align: inherit;"> command</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Now all incoming letters from the accounts manager@company.ru and sales@company.ru will be archived in the mailbox manager@archive.company.ru, and incoming letters from the account support@company.ru will be copied to the mailbox support@archive.company .ru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gi/pe/wk/gipewkvtnhw-mavnwqt1qp8dhws.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Example of filtering incoming messages</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
It should be noted that each time you add or remove email addresses in the lists </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ opt / zimbra / postfix / conf / sender_bcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ opt / zimbra / postfix / conf / recipient_bcc,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you must run the </font><b><font style="vertical-align: inherit;">postmap</font></b><font style="vertical-align: inherit;"> command </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">again</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">showing the modified list, and restart Postfix. We also recommend that you use Zimbra OSE mail filters based on the name of the sender and recipient so that incoming and outgoing messages are sorted into folders and later it will be easier for you to find the message you need. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5f/gl/dd/5fglddcvjyzgdpxjtuxsrte1gew.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Example of filtering outgoing messages</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
To search letters in the created mail archives later, you can use the built-in search Zimbra OSE. It should also be noted that the storage time of emails in the archive is much longer than in the account, which means that they need to set an increased quota, as well as a retention policy with a longer period. In the event that you have archive mailboxes on a separate domain, it will be much easier to do this.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For all questions related to the Zextras Suite, you can contact the representative of the company "Zextras" Ekaterina Triandafilidi by e-mail katerina@zextras.com</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en505452/index.html">The evolution of bank cards: from metal to metal</a></li>
<li><a href="../en505456/index.html">Why printers put invisible dots on documents</a></li>
<li><a href="../en505458/index.html">How to understand machine learning if you are not a great mathematician</a></li>
<li><a href="../en505460/index.html">Pay for training in coding: Russian bachelors can win a scholarship to study for a master's degree in Switzerland</a></li>
<li><a href="../en505462/index.html">Micro data center: why do we need miniature data centers?</a></li>
<li><a href="../en505470/index.html">Notes of the knowledge manager. How Exness Knowledge Management Works</a></li>
<li><a href="../en505472/index.html">Useful post: Install OpenShift, learn Kafka, use Ansible on Google Cloud Platform</a></li>
<li><a href="../en505476/index.html">CRUD API on Deno and PostegreSQL: working with a dinosaur</a></li>
<li><a href="../en505478/index.html">Replacing a CRM system with a CRM system</a></li>
<li><a href="../en505488/index.html">12 tips for implementing TypeScript in React applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>