<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👏🏻 👨‍🎨 👨🏻‍🏭 開発者クックブック：DDDレシピ（パート5、プロセス） 🖲️ 📪 👩🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前書き
 

前の記事では、スコープ、方法論の基礎、アーキテクチャと構造の例について説明しました。この記事では、プロセスの記述方法、要件の収集の原則、ビジネス要件と機能要件の違い、要件からコードへの移行方法について説明します。（ユースケース）を使用するオプションの適用の原則と、それらがどのように役立...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>開発者クックブック：DDDレシピ（パート5、プロセス）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454668/"><h1 id="vvedenie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前の記事では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スコープ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法論の基礎</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アーキテクチャ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構造の</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">例</font></a><font style="vertical-align: inherit;">について説明しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この記事では、プロセスの記述方法、要件の収集の原則、ビジネス要件と機能要件の違い、要件からコードへの移行方法について説明します。</font><font style="vertical-align: inherit;">（ユースケース）を使用する</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプション</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の適用の原則</font><font style="vertical-align: inherit;">と、それらがどのように役立つかについて話します。</font><font style="vertical-align: inherit;">InteractorおよびService Layerデザインパターンの実装オプションの例をご覧ください。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/wo/je/ct/woject0sgeuwc_4xnnzugty-5jg.png" alt="あなたのおばあちゃんのように"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事の例は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LunaPark</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソリューションを使用して</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">提供さ</font></a><font style="vertical-align: inherit;">れているため、説明されているアプローチの最初のステップで役立ちます。</font></font></p><br>
<h1 id="otdelyaem-funkcionalnye-trebovaniya-ot-biznes-trebovaniy"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能要件をビジネス要件から分離します。</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何度も何度も、多くのビジネスアイデアが実際に最終的な意図された製品にならないことがあります。</font><font style="vertical-align: inherit;">多くの場合、これはビジネス要件と機能要件の違いを理解できないためであり、最終的には要件の収集が不十分になり、不必要な文書化、プロジェクトの遅延、および主要なプロジェクトの失敗につながります。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または、最終的なソリューションは顧客のニーズを満たしているが、どういうわけかビジネス目標が達成されていない状況に直面することもあります。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、ビジネス要件と機能要件を定義し始めるまで、それらを機能要件から分離することが非常に重要です。</font><font style="vertical-align: inherit;">例を見てみましょう。</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピザの配送会社のアプリケーションを作成していて、宅配便追跡システムを作成するとします。</font><font style="vertical-align: inherit;">ビジネス要件は次のとおりです。</font></font></p><br>
<p><em>" -        ,              ,       ."</em></p><br>
<p>     ,   ,     :</p><br>
<ul>
<li>-      ;</li>
<li>    ,      ;</li>
<li>    ,     ;</li>
<li>   «<strong></strong>»  «<strong></strong>».    ?     .</li>
</ul><br>
<p>  —  <em></em>,    ,   -.  ,         .      :</p><br>
<ul>
<li>        GPS/;</li>
<li>      ;</li>
<li>         .</li>
</ul><br>
<p>  :</p><br>
<ul>
<li>       ;</li>
<li>    ;</li>
<li>    , ,  ,      ;</li>
<li>   «<strong></strong>».     .</li>
</ul><br>
<p>       (   «  »),        (,   , , , ).      «<strong></strong>»   . </p><br>
<p> —      .   —    ,   — . </p><br>
<h1 id="varianty-ispolzovaniya-use-cases">  (Use cases)</h1><br>
<p>   , ,     .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>      <em>Use Case</em>.</p><br>
<p>  ,     .   —   <em>Use Case</em>,    UML,   RUP,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Use-Case 2.0 The Hub of Software Development</a>  6   <em> </em>:</p><br>
<ol>
<li>    ;</li>
<li>  ,   ;</li>
<li>  ;</li>
<li>   ;</li>
<li>  ;</li>
<li>  .</li>
</ol><br>
<p>     ,      .     ,    ,      .</p><br>
<h3 id="prostota-cherez-povestvovanie">  </h3><br>
<p><em> —   ;        ,    — .      ,    ,       .</em></p><br>
<p><em>    .    ,  ,   .    ,       ,   .  ,   ,       ,    ,  .    ,     .</em></p><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a> (Ubiques language)  DDD .</p><br>
<h3 id="ponimanie-kartiny-v-celom">   </h3><br>
<p><em>  ,    , , , ,   -,     .             ,    ,  ,         .</em></p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>,      .     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a> (Context map)  . , Scrum   ,        ,  ,     ,  .      waterflow,       -,    ,   .   ,    .      ,    .</p><br>
<h3 id="fokus-na-znachenii">  </h3><br>
<p><em> ,    ,     ,         .      ,   .      ,    ,       ,    .</em> </p><br>
<p><em>    ,     ,          .       : ,    ,  ,     .</em> </p><br>
<p>    ,       :</p><br>
<p><img src="https://habrastorage.org/webt/5g/nk/ma/5gnkmae4chv6_azevvzhg2euglc.png"></p><br>
<p>    , «   ».        <em> </em> (Basic flow).     <em> </em> (alternative flow).     ,       .</p><br>
<h3 id="posloynoe-postroenie"> </h3><br>
<p><em>    ,       .    ,       ,    ,       .</em></p><br>
<p><em>         .      ,        .</em></p><br>
<p>          <em></em> (Domain).</p><br>
<h3 id="poshagovyy-vyvod-produkta-na-rynok">    </h3><br>
<p><em>       .      ;      ,       .        ,      .    ,     .   ,      .</em></p><br>
<h3 id="udovletvoryat-potrebnosti-komandy">  </h3><br>
<p><em> ,        ;            .   ,      ,   ,         .</em></p><br>
<p>               UML.     .  ,      ,       UML.</p><br>
<h1 id="realizaciya"></h1><br>
<p>        <em> </em> :</p><br>
<blockquote>These use cases orchestrate the flow of data to and from the entities, and direct those entities to use their Critical Business Rules to achieve the goals of the use case.</blockquote><p>     .        <em> </em>     .    -: «   ».</p><br>
<p>   :</p><br>
<ul>
<li>  ;</li>
<li>   ;</li>
<li> ;</li>
<li>  ;</li>
<li> ;</li>
<li> ;</li>
<li> .</li>
</ul><br>
<p>      <em></em> (Interactor),         <em> </em> (Functional Object)  <em> </em> (Service Layer).</p><br>
<h1 id="posledovatelnost-deystviy-interactor">  (Interactor)</h1><br>
<p><img src="https://habrastorage.org/webt/6b/vk/ra/6bvkra2chr3b8d43dmtxebpjaj4.png" alt="ステップバイステップ"></p><br>
<p>      -   <em> </em>.   ,    <em> </em>,    -.    .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><em></em></a>,    .      <em></em>   . </p><br>
<p>     .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a> (sequence diagram).    ,   <em> </em> (Use Case) —  .    ,          ,     .     ,   <em>Sequence</em>,     ,   <em>Interactor</em>.     ,     — <em>Interactor</em>.</p><br>
<p> ,    -    ,  ,   : «    ,    ».  ,    .  ,   ,    ,      .        .     DiscountSystem,    Entites::Contract.     ,   <em></em> ,     .</p><br>
<p>    -,  ,           ,     .        <em> </em>.</p><br>
<p>  <em> </em>  :</p><br>
<ul>
<li>  <em></em>;</li>
<li>    <em></em>;</li>
<li>   <em></em>    ;</li>
<li>    <em></em>;</li>
<li><strong></strong>:       —   . </li>
</ul><br>
<p>      ,     -   —     ,   ,       . <strong>     ,       </strong>.        .</p><br>
<p>  :       <em>Interactor</em>.</p><br>
<h2 id="realizaciya-1"></h2><br>
<p>  ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">LunaPark</a>,      .</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Kitchen</span></span>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Sequences</span></span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CookingPieWith</span><span class="hljs-title">abbage</span> &lt; LunaPark::Interactors::<span class="hljs-title">Sequence</span></span>
      TEMPERATURE = Values::Temperature.new(<span class="hljs-number">180</span>, <span class="hljs-symbol">unit:</span> <span class="hljs-symbol">:cel</span>)<font></font>
<font></font>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call!</span></span>
        Services::CheckProductsAvailability.call   <span class="hljs-symbol">list:</span> ingredients<font></font>
        dough   = Services::BeatDough.call         <span class="hljs-symbol">from:</span> Repository::Products.get(beat_ingredients)<font></font>
        filler  = Services::MakeabbageFiller.call <span class="hljs-symbol">from:</span> Repository::Products.get(filler_ingredients)<font></font>
        pie     = Services::MakePie.call           dough, <span class="hljs-symbol">with:</span> filler<font></font>
        bake    = Services::BakePie.new            pie,   <span class="hljs-symbol">temp:</span> TEMPERATURE<font></font>
        sleep <span class="hljs-number">5</span>.min <span class="hljs-keyword">until</span> bake.call<font></font>
        pie  <font></font>
      <span class="hljs-keyword">end</span><font></font>
<font></font>
      private<font></font>
<font></font>
      <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:beat_ingredients</span>, <span class="hljs-symbol">:filler_ingredients</span>
      <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:pie</span><font></font>
<font></font>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ingredients_list</span></span><font></font>
        beat_ingredients_list + filler_ingredients_list<font></font>
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>  
<span class="hljs-keyword">end</span></code></pre><br>
<p>  ,  <code>call!</code>   -   .        .</p><br>
<p>,        ,  <code>MakeabbageFiller</code>  <code>MakeFishFiller</code>.  ,     -,    .  ,     <em></em> ,  -.</p><br>
<h3 id="dogovorennosti"></h3><br>
<ul>
<li> <code>call!</code>   ,    <em></em>.</li>
<li>        <code>attr_acessor</code>:</li>
</ul><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> &lt; LunaPark::Interactors::<span class="hljs-title">Sequence</span></span>
  <span class="hljs-comment"># ...</span><font></font>
  private<font></font>
  <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:bar</span> 
<span class="hljs-keyword">end</span><font></font>
<font></font>
Foo.call(<span class="hljs-symbol">bar:</span> <span class="hljs-number">42</span>)</code></pre><br>
<ul>
<li>    .</li>
</ul><br>
<h2 id="primer-ispolzovaniya"> </h2><br>
<pre><code class="ruby hljs">beat_ingredients = [<font></font>
  Entity::Product.new <span class="hljs-symbol">:flour</span>,   <span class="hljs-number">500</span>, <span class="hljs-symbol">:gr</span>,<font></font>
  Entity::Product.new <span class="hljs-symbol">:oil</span>,     <span class="hljs-number">50</span>,  <span class="hljs-symbol">:gr</span>,<font></font>
  Entity::Product.new <span class="hljs-symbol">:salt</span>,    <span class="hljs-number">1</span>,   <span class="hljs-symbol">:spoon</span>,<font></font>
  Entity::Product.new <span class="hljs-symbol">:milk</span>,    <span class="hljs-number">150</span>, <span class="hljs-symbol">:ml</span>,<font></font>
  Entity::Product.new <span class="hljs-symbol">:egg</span>,     <span class="hljs-number">1</span>,   <span class="hljs-symbol">:unit</span>,<font></font>
  Entity::Product.new <span class="hljs-symbol">:yeast</span>,   <span class="hljs-number">1</span>,   <span class="hljs-symbol">:spoon</span><font></font>
]<font></font>
<font></font>
filler_ingredients = [<font></font>
  Entity::Product.new <span class="hljs-symbol">:cabbage</span>, <span class="hljs-number">500</span>, <span class="hljs-symbol">:gr</span>,<font></font>
  Entity::Product.new <span class="hljs-symbol">:salt</span>,    <span class="hljs-number">1</span>,   <span class="hljs-symbol">:spoon</span>,<font></font>
  Entity::Product.new <span class="hljs-symbol">:pepper</span>,  <span class="hljs-number">1</span>,   <span class="hljs-symbol">:spoon</span><font></font>
]<font></font>
<font></font>
cooking = CookingPieWithabbage.call(<font></font>
  <span class="hljs-symbol">beat_ingredients:</span>   beat_ingredients, 
  <span class="hljs-symbol">filler_ingredients:</span> filler_ingredients<font></font>
)<font></font>
<font></font>
<span class="hljs-comment">#   :</span>
cooking.success?     <span class="hljs-comment"># =&gt; true</span>
cooking.fail         <span class="hljs-comment"># =&gt; false</span>
cooking.fail_message <span class="hljs-comment"># =&gt; ''</span>
cooking.data         <span class="hljs-comment"># =&gt; Entity::Pie</span><font></font>
<font></font>
<span class="hljs-comment">#   :</span>
cooking.success?     <span class="hljs-comment"># =&gt; false</span>
cooking.fail         <span class="hljs-comment"># =&gt; true</span>
cooking.fail_message <span class="hljs-comment"># =&gt; 'The pie burned out'</span>
cooking.data         <span class="hljs-comment"># =&gt; nil</span></code></pre><br>
<p>             —    ,   -    ,   ,  ?</p><br>
<h2 id="obrabotka-oshibok"> </h2><br>
<p>      Use Case,    ,   <em> </em>,      <em></em> .  ,    .  :         ,       ,   ,    .</p><br>
<p><em>Interactor</em>       <code>LunaPark::Errors::Processing</code>. </p><br>
<p>    ?     <code>Burned</code>  <em></em> <code>BakePie</code>. </p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Kitchen</span></span>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Errors</span></span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Burned</span> &lt; LunaPark::Errors::<span class="hljs-title">Processing</span>;</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>   , ,     :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Kitchen</span></span>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span> </span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BakePie</span> &lt; LunaPark::Callable   </span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span>
          <span class="hljs-comment"># ...</span>
          <span class="hljs-keyword">rescue</span> Errors::Burned, <span class="hljs-string">'The pie burned out'</span> <span class="hljs-keyword">if</span> pie.burned?
          <span class="hljs-comment"># ...</span>
      <span class="hljs-keyword">end</span>    
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>     ,        <code></code>.<br>
,    <code>Processing</code>,         .     ,    500 ServerError.</p><br>
<h2 id="praktika-ispolzovaniya"> </h2><br>
<h3 id="1-staraytes-opisyvat-vse-vyzovy-v-metode-call">1.       call!</h3><br>
<p>    <em></em>  ,     .      ,     .    :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Service</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CookingPieWith</span><span class="hljs-title">abbage</span> &lt; LunaPark::Interactors::<span class="hljs-title">Sequence</span></span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call!</span></span><font></font>
      check_products_availability<font></font>
      make_cabbage_filler<font></font>
      make_pie<font></font>
      bake<font></font>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    private  <font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_products_availability</span></span>
      Services::CheckProductsAvailability.call <span class="hljs-symbol">list:</span> ingredients  
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>     .      ruby   ,     :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DrivingStart</span> &lt; LunaPark::Interactors::<span class="hljs-title">Sequence</span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call!</span></span><font></font>
    Service::CheckEngine.call<font></font>
    Service::StartUpTheIgnition.call car, <span class="hljs-symbol">with:</span> key<font></font>
    Service::ChangeGear.call         car.gear_box, <span class="hljs-symbol">to:</span> <span class="hljs-symbol">:drive</span>
    Service::StepOnTheGas.call       car.pedals[<span class="hljs-symbol">:right</span>]
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<h3 id="2-po-vozmozhnosti-ispolzuyte-metod-klassa-call">2.      call</h3><br>
<pre><code class="ruby hljs"><span class="hljs-comment"># good - ,   ,  . </span>
<span class="hljs-comment">#           .</span><font></font>
Sequence::RingingToPerson.call(params)<font></font>
<font></font>
<span class="hljs-comment"># good -   ,      e,</span>
<span class="hljs-comment">#           ,     , </span>
<span class="hljs-comment">#           .</span><font></font>
ring = Sequence::RingingToPerson.new(person)<font></font>
<font></font>
<span class="hljs-keyword">unless</span> ring.success?<font></font>
  ring.call<font></font>
  sleep <span class="hljs-number">5</span>.min
<span class="hljs-keyword">end</span>
</code></pre><br>
<h3 id="3-ne-sozdavayte-_funkcionalnye-obekty_-radi-tipizacii-koda-smotrite-po-situacii">3.   <em> </em>   ,   </h3><br>
<pre><code class="ruby hljs"><span class="hljs-comment"># bad -        ,  </span>
<span class="hljs-comment">#           .</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BuildUser</span> &lt; LunaPark::Callable</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(<span class="hljs-symbol">first_name:</span>, <span class="hljs-symbol">last_name:</span>, <span class="hljs-symbol">phone:</span>)</span></span><font></font>
      @first_name = first_name<font></font>
      @last_name = last_name<font></font>
      @phone = phone<font></font>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span><font></font>
      Entity::User.new(<font></font>
        <span class="hljs-symbol">first_name:</span> first_name, 
        <span class="hljs-symbol">last_name:</span> last_name,
        <span class="hljs-symbol">phone:</span> phone <font></font>
      )<font></font>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    private<font></font>
    <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:first_name</span>, <span class="hljs-symbol">:last_name</span>, <span class="hljs-symbol">:phone</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Sequences</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegisteringUser</span> &lt; LunaPark::Interactors::<span class="hljs-title">Sequence</span></span>
    <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:first_name</span>, <span class="hljs-symbol">:last_name</span>, <span class="hljs-symbol">:phone</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call!</span></span>
      user = Service::BuildUser.call(<span class="hljs-symbol">first_name:</span> first_name, <span class="hljs-symbol">last_name:</span> last_name, <span class="hljs-symbol">phone:</span> phone)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span><font></font>
<font></font>
<span class="hljs-comment"># good -     ,  . </span>
<span class="hljs-comment">#                , </span>
<span class="hljs-comment">#              .</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Sequences</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegisteringUser</span> &lt; LunaPark::Interactors::<span class="hljs-title">Sequence</span></span>
    <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:first_name</span>, <span class="hljs-symbol">:last_name</span>, <span class="hljs-symbol">:phone</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call!</span></span>
      user <span class="hljs-comment">#...</span>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    private <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">user</span></span><font></font>
      @user = Entity::User.new(<font></font>
        <span class="hljs-symbol">first_name:</span> first_name, 
        <span class="hljs-symbol">last_name:</span> last_name,
        <span class="hljs-symbol">phone:</span> phone <font></font>
      )<font></font>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<h1 id="servisnyy-sloy-service-layer">  (Service Layer)</h1><br>
<p><img src="https://habrastorage.org/webt/1-/qv/ip/1-qvipbbxxz2i0cveslcf02b7c0.png" alt="LSD"></p><br>
<p><em> </em> (Interactor),   ,  -    . <em> </em> (Service layer)      .      ,    <em> </em> (Interactor)    " ",       .     <em> </em>.   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>: </p><br>
<p><em>      ,          (Entity)  - (Value object).       ,   .          ,      .</em></p><br>
<p><em>      :          ,   ,    .           ,       ,      .        ,      ,   .                  .       ,  ,      .</em></p><br>
<p>       ,    .   —    .  , "   " :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Entities</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Wood</span></span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">chop</span></span>
      <span class="hljs-comment"># ...</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>    .     ,   :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Entities</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Axe</span></span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">chop</span><span class="hljs-params">(sacrifice)</span></span>
      <span class="hljs-comment"># ...</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>    -,   .       ,   ,     ,  ,  ,         . </p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Entities</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Human</span></span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">chop_firewood</span><span class="hljs-params">(wood, axe, chock)</span></span>
      <span class="hljs-comment"># ...</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre><br>
<p>    ,     .       ,     .        Ruby on Rails,     :  ,    ,    .      ,        .</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChopFirewood</span></span>
    <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p> ,   ,      <em></em>     .         .</p><br>
<h2 id="funkcionalnye-obekty"> </h2><br>
<p>     .            — <code>call</code>.</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Serivices</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sum</span></span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(x, y)</span></span><font></font>
      @x = x<font></font>
      @y = y<font></font>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span><font></font>
      x + y<font></font>
    <span class="hljs-keyword">end</span>  <font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">self</span>.<span class="hljs-title">call</span><span class="hljs-params">(x,y)</span></span><font></font>
      new(x,y).call<font></font>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    private<font></font>
    <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:x</span>, <span class="hljs-symbol">:y</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>    :  ,    .   ,      .      ,         :</p><br>
<ul>
<li><em> </em> (Service) — ,   ;</li>
<li><em></em> (Command) —   ;</li>
<li><em></em> (Guard) —   , -   .</li>
</ul><br>
<h2 id="servisnyy-obekt-service">  (Service)</h2><br>
<p>   <em>Service</em> —       .</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">KorovaMilkBar</span></span>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span></span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FindMilk</span> &lt; LunaPark::Callable</span>
      GLASS_SIZE = Values::Unit.wrap <span class="hljs-string">'200g'</span><font></font>
<font></font>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(<span class="hljs-symbol">fridge:</span>)</span></span><font></font>
        @fridge = fridge<font></font>
        <span class="hljs-keyword">end</span><font></font>
<font></font>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span>
          fridge.shelfs.find { <span class="hljs-params">|shelf|</span> shelf.has?(GLASS_SIZE, <span class="hljs-symbol">of:</span> <span class="hljs-symbol">:milk</span>) }
        <span class="hljs-keyword">end</span><font></font>
<font></font>
        private<font></font>
        <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:fridge</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span> <font></font>
<font></font>
FindMilk.call(<span class="hljs-symbol">fridge:</span> the_red_one) <span class="hljs-comment"># =&gt; #&lt;Glass: ... &gt;</span></code></pre><br>
<h2 id="komanda-command"> (Command)</h2><br>
<p>   <em>Command</em> —   <em></em>,  ,     true.  , <em></em>   ,   .</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">KorovaMilkBar</span></span>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Commands</span></span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FillGlass</span> &lt; LunaPark::Callable    </span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(glass, <span class="hljs-symbol">with:</span>)</span></span><font></font>
        @glass   = glass<font></font>
        @content = with<font></font>
      <span class="hljs-keyword">end</span><font></font>
<font></font>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span><font></font>
        glass &lt;&lt; content<font></font>
        <span class="hljs-literal">true</span>
      <span class="hljs-keyword">end</span><font></font>
<font></font>
      private<font></font>
      <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:fridge</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span> <font></font>
<font></font>
glass  = Glass.empty<font></font>
milk   = Milk.new(<span class="hljs-number">200</span>, <span class="hljs-symbol">:gr</span>)<font></font>
glass.empty?                     <span class="hljs-comment"># =&gt; true</span>
FillGlass.call glass, <span class="hljs-symbol">with:</span> milk <span class="hljs-comment"># =&gt; true</span>
glass.empty?                     <span class="hljs-comment"># =&gt; false</span></code></pre><br>
<h2 id="vahter-guard"> (Guard)</h2><br>
<p><em></em>,          .        <em> </em>,     <em> </em>,  -   . </p><br>
<p>    ,   :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">KorovaMilkBar</span></span>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Guards</span></span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IsFresh</span> &lt; LunaPark::Callable  </span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(product)</span></span><font></font>
        @products = products<font></font>
      <span class="hljs-keyword">end</span><font></font>
<font></font>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span>
        products.each <span class="hljs-keyword">do</span> <span class="hljs-params">|product|</span>
          raise Errors::Rotten, <span class="hljs-string">"<span class="hljs-subst">#{product.title}</span> is not fresh"</span> <span class="hljs-keyword">if</span> product.expiration_date &gt; Date.today
        <span class="hljs-keyword">end</span><font></font>
<font></font>
        <span class="hljs-literal">nil</span>
      <span class="hljs-keyword">end</span><font></font>
<font></font>
      private<font></font>
      <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:products</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span> </code></pre><br>
<p>        .    , , <em>Builder</em> —     .</p><br>
<h3 id="dogovorennosti-1"></h3><br>
<ul>
<li> <code>call</code>     .</li>
<li> <code>initialize</code>     .</li>
<li>    .</li>
<li>      <code>LunaPark::Errors::Processing</code> .</li>
</ul><br>
<h2 id="obrabotka-oshibok-1"> </h2><br>
<p>  2  ,          <em></em>.</p><br>
<h5 id="oshibki-processa-vypolneniya">  </h5><br>
<p>        .</p><br>
<p>:</p><br>
<ul>
<li>   email ;</li>
<li>   ,  ;</li>
<li>    (  ,   ,   ).</li>
</ul><br>
<p>  ,      . , ,   ,<br>
   .</p><br>
<p>     <code>LunaPark::Errors::Processing</code></p><br>
<h5 id="sistemnyy-oshibki"> </h5><br>
<p>,      .</p><br>
<p>:</p><br>
<ul>
<li>  ;</li>
<li>-   .</li>
</ul><br>
<p>  ,            ,  ,    ,    ,   .      <code>SystemError</code></p><br>
<p> , <strong> </strong>,       .</p><br>
<h2 id="praktika-ispolzovaniya-1"> </h2><br>
<h3 id="1-ispolzuyte-peremennye-chtoby-povysit-chitaemost">1.  ,   </h3><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Fishing</span></span>
  <span class="hljs-comment"># bad -  </span><font></font>
  Serivices::Catch.call(fish, rod)<font></font>
<font></font>
  <span class="hljs-comment"># bad - </span>
  Serivices::Catch.call(<span class="hljs-symbol">fish:</span> fish, <span class="hljs-symbol">rod:</span> rod)<font></font>
<font></font>
  <span class="hljs-comment"># good -   </span>
  Serivices::Catch.call(fish, <span class="hljs-symbol">with:</span> rod)<font></font>
<font></font>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Serivices</span></span>
        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Catch</span></span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(fish, <span class="hljs-symbol">with:</span>)</span></span><font></font>
        @fish = fish<font></font>
        @rod  = with <span class="hljs-comment">#     </span>
                     <span class="hljs-comment">#   .</span>
      <span class="hljs-keyword">end</span>
      <span class="hljs-comment"># ...</span><font></font>
      private<font></font>
      <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:fish</span>, <span class="hljs-symbol">:rod</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span> 
<span class="hljs-keyword">end</span>   </code></pre><br>
<h3 id="2-peredavayte-obekty-a-ne-parametry">2.  ,   </h3><br>
<p>   ,       .<br>
 ,   . </p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Service</span></span>
  <span class="hljs-comment"># bad -        -.  </span>
  <span class="hljs-comment">#            ,   .</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> </span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(<span class="hljs-symbol">foo_params:</span>, <span class="hljs-symbol">bar_params:</span>)</span></span><font></font>
      @foo = Values::Foo.new(*foo_params)<font></font>
      @bar = Values::Bar.new(*bar_params)<font></font>
    <span class="hljs-keyword">end</span>
    <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">end</span>
  Services::Foo.call(<span class="hljs-symbol">foo:</span> {<span class="hljs-symbol">a:</span> <span class="hljs-number">1</span>, <span class="hljs-symbol">b:</span> <span class="hljs-number">2</span>}, <span class="hljs-symbol">bar:</span> <span class="hljs-number">34</span>)<font></font>
<font></font>
  <span class="hljs-comment"># good -   -.</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bar</span> </span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(<span class="hljs-symbol">foo:</span>, <span class="hljs-symbol">bar:</span>)</span></span><font></font>
      @foo = foo<font></font>
      @bar = bar  <font></font>
      <span class="hljs-comment"># ...</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span><font></font>
<font></font>
  foo = Values::Foo.new(<span class="hljs-symbol">a:</span> <span class="hljs-number">1</span>, <span class="hljs-symbol">b:</span> <span class="hljs-number">2</span>)<font></font>
  bar = Values::Bar.new(<span class="hljs-number">34</span>)<font></font>
  Services::Bar.call(<span class="hljs-symbol">foo:</span> foo, <span class="hljs-symbol">bar:</span> bar)<font></font>
<font></font>
  <span class="hljs-comment"># good -       - Builder.</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BuildFoo</span> </span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(<span class="hljs-symbol">param_1:</span>, <span class="hljs-symbol">param_2:</span>)</span></span><font></font>
      @param_1 = param_1<font></font>
      @param_1 = param_1<font></font>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span><font></font>
      Foo.new(<font></font>
        <span class="hljs-symbol">param_1:</span> param_1.foo,
        <span class="hljs-symbol">param_2:</span> param_2.bar,
        <span class="hljs-symbol">param_3:</span> some_magick<font></font>
      ) <font></font>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<h3 id="3-ispolzuyte-v-nazvanie-deystviya---glagol-deystviya-i-obekt-vozdeystviya">3.     —     .</h3><br>
<pre><code class="ruby hljs"><span class="hljs-comment"># bad</span>
<span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Milk</span>;</span> <span class="hljs-keyword">end</span> 
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Work</span>;</span> <span class="hljs-keyword">end</span> 
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooBuild</span>;</span> <span class="hljs-keyword">end</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PasswordGenerator</span>;</span> <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span><font></font>
<font></font>
<span class="hljs-comment"># good</span>
<span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetMilk</span>;</span> <span class="hljs-keyword">end</span> 
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WorkOnTable</span>;</span> <span class="hljs-keyword">end</span> 
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BuildFoo</span>;</span> <span class="hljs-keyword">end</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GeneratePassword</span>;</span> <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<h3 id="4-po-vozmozhnosti-ispolzuyte-metod-klassa-call">4.      call</h3><br>
<p>   <em></em>,    ,    .</p><br>
<pre><code class="ruby hljs"><span class="hljs-comment"># good -    .</span><font></font>
Services::BuildFoo.call(params)<font></font>
<font></font>
<span class="hljs-comment"># good -    </span><font></font>
Services::BuildFoo.(params)<font></font>
<font></font>
<span class="hljs-comment"># good -   ,      , </span>
<span class="hljs-comment">#           ,     ,   </span>
<span class="hljs-comment">#         .</span><font></font>
<font></font>
ring = Services::RingToPhone.new(<span class="hljs-symbol">phone:</span> neighbour)
<span class="hljs-number">10</span>.times <span class="hljs-keyword">do</span><font></font>
  ring.call<font></font>
<span class="hljs-keyword">end</span></code></pre><br>
<h3 id="5-obrabotka-oshibok-ne-yavlyaetsya-zadachey-servisa">5.      </h3><br>
<pre><code class="ruby hljs"><span class="hljs-comment"># bad -    ,   .</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span><font></font>
<font></font>
  <span class="hljs-comment">#...</span>
<span class="hljs-keyword">rescue</span> SystemError =&gt; e
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
<span class="hljs-keyword">end</span></code></pre><br>
<h2 id="moduli"></h2><br>
<p>      <em> </em>    .         :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sum</span><span class="hljs-params">(a, b)</span></span><font></font>
    a + b<font></font>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p> ,     —    . ,   «rails fat model»,   «services fat folder».     ,    .       ,       . ,     - ,  ,        :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NoonService</span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(arina_radionovna, pushkin)</span></span>
    <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">end</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">to_feed</span></span>
    <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">end</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">to_sleep</span></span>
    <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>       .      ,   ,   .           ,        .     ,    :</p><br>
<pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Services</span></span>
  <span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Noon</span></span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ToFeed</span></span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call!</span></span>
        <span class="hljs-comment"># ...</span>
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-class"><span class="hljs-keyword">class</span> &lt;&lt; self</span>
      <span class="hljs-comment">#    ,   </span>
      <span class="hljs-comment">#   </span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">to_feed</span><span class="hljs-params">(arina_radionovna, pushkin)</span></span><font></font>
        ToFeed.new(arina_radionovna, pushkin).call<font></font>
      <span class="hljs-keyword">end</span><font></font>
<font></font>
      <span class="hljs-comment">#    ,   </span>
      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">to_sleep</span><span class="hljs-params">(arina_radionovna, pushkin)</span></span><font></font>
        arina_radionovna.tell_story pushkin<font></font>
        pushkin.state = <span class="hljs-symbol">:sleep</span>
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>         (low coupling)     (high cohesion),       Services,  Interactors,         .   ,   .             ,      ,       .       ,    .</p><br>
<p>       :</p><br>
<p><em>  ,          .            .     ,      ,      ,       ,               ,  .          ,              .     ,              ,       .</em> </p><br>
<p><em>   ,     .   ,           .</em></p><br>
<p>    ,          .         <em></em>  <em></em>.   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>,        DDD.       .</p><br>
<hr><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://www.netsolutions.com/insights/business-and-functional-requirements-what-is-the-difference-and-why-should-you-care/</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://magazines.russ.ru/nz/2007/54/gi3.html</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://www.microtool.de/en/knowledge-base/how-use-case-2-0-works/</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://www.researchgate.net/publication/220059381_Use_cases_-_Yesterday_today_and_tomorrow</a></li>
<li>- ,  . </li>
</ul></div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454652/index.html">家庭用3DプリンターのJetエンジン</a></li>
<li><a href="../ja454658/index.html">美容小道具-深刻なビジネス</a></li>
<li><a href="../ja454662/index.html">Осторожный переезд в Нидерланды с женой и ипотекой. Часть 1: поиск работы</a></li>
<li><a href="../ja454664/index.html">ARでテトリスをプレイ</a></li>
<li><a href="../ja454666/index.html">ソフトウェア無線-それはどのように機能しますか？パート7</a></li>
<li><a href="../ja454670/index.html">シリーズ「チェルノブイリ」：見て、考えて</a></li>
<li><a href="../ja454672/index.html">スタートの鍵：コンピュータフォレンジックに最適なソフトウェアとハ​​ードウェア</a></li>
<li><a href="../ja454674/index.html">コンソールからの貧しい人々の監視またはサーバーの監視</a></li>
<li><a href="../ja454676/index.html">ArduinoのGPSウォッチ</a></li>
<li><a href="../ja454678/index.html">Rustでの慣用的なGPUプログラミング：Emuライブラリ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>