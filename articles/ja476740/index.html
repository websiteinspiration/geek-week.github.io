<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👂 👨🏽‍✈️ 👩🏼‍🍳 Donot Teamサイバーグループ活動を探索する 🤶🏿 ⛹️ 👧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="APTグループのDonotチーム（別名APT-C-35、SectorE02）は少なくとも2012年から活動しています。攻撃者の関心は、機密情報と知的財産の取得を目的としています。犯罪者の目標の中には、南アジアの国々、特にパキスタンの公共部門があります。2019年には、バングラデシュ、タイ、インド、ス...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Donot Teamサイバーグループ活動を探索する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/476740/"><img src="https://habrastorage.org/webt/ij/9l/ez/ij9lez0rx_2lq1djikodvksxlkq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APTグループのDonotチーム（別名APT-C-35、SectorE02）は少なくとも2012年から活動しています。</font><font style="vertical-align: inherit;">攻撃者の関心は、機密情報と知的財産の取得を目的としています。</font><font style="vertical-align: inherit;">犯罪者の目標の中には、南アジアの国々、特にパキスタンの公共部門があります。</font><font style="vertical-align: inherit;">2019年には、バングラデシュ、タイ、インド、スリランカ、フィリピン、およびアジア地域外（アルゼンチン、アラブ首長国連邦、英国）での活動を観察しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数か月間、グループの悪意のあるダウンローダーのコードの変更を追跡しました。</font><font style="vertical-align: inherit;">この記事では、攻撃ベクトルの1つを検討し、前述のローダーについて詳しく説明し、ネットワークインフラストラクチャの機能に触れます。</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃チェーン</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
感染の初めに、被害者はOffice Open XML形式のMS Wordドキュメントを受け取ります。明確な証拠はありませんが、最初の侵入経路はオフィスに添付されたフィッシング電子メールを標的にしていると確信しています。ドキュメント自体は悪意のあるものではありませんが、外部要素を自動ロードして次の段階のドキュメントを起動する機能を悪用します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e6/cg/zw/e6cgzwmgrxgjfalxttmycvqtjj0.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンクされた外部オブジェクトへのアクセス</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ダウンロードファイルは、Microsoft EquationのCVE-2018-0802の脆弱性を不正利用するRTFドキュメントです。メインのシェルコード操作の前に、キー0x90および0xCEを使用したシングルバイトXORで次のレイヤーを復号化する中間のチェーンが続きます：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/ed/mb/bbedmbpsatugmchjoucfxftvy-m.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2番目の最初のシェルコード</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/sx/1f/ef/sx1fefq-ucfv5nr9hfckbyldcxi.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">による復号化3番目の2番目のシェルコードによる復号化</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/hm/am/qf/hmamqfcbaxfnysggnlhemicw3ay.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メインシェルコード</font><i><font style="vertical-align: inherit;">の3番目のシェルコードによる復号化</font></i><font style="vertical-align: inherit;">は、次のアクションを実行します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キー0x79のシングルバイトXORは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％TEMP％\ one</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルからバイナリデータを復号化します</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行可能ファイル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\ Windows \ Tasks \ Serviceflow.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\ Windows \ Tasks \ sinter.exeを作成し</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これらは悪質なグループダウンローダーであり、これについては後で説明します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\ Windows \ Tasks \ S_An.dllを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成します。このファイル</font><font style="vertical-align: inherit;">には2つの0x90バイトが書き込まれます。</font></font></li>
<li>  <b>C:\Windows\Tasks\A64.dll</b>.        x64-  x86-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">UACMe</a>     .    UAC     BAT- <b>%TEMP%\v.bat</b>,             :</li>
</ul><br>
<pre><code class="bash hljs">sc create ServiceTool displayname= <span class="hljs-string">"ServiceFill"</span> binpath= <span class="hljs-string">"C:\Windows\Tasks\Serviceflow.exe"</span> start= <span class="hljs-string">"auto"</span>
sc start ServiceTool</code></pre><br>
<br>
<img src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/issleduem-aktivnost-kibergruppirovki-donot-team/05.jpg" alt="画像"><br>
<br>
<i>  BAT-    UACMe</i><br>
<br>
<ul>
<li>   JScript- <b>C:\Windows\Tasks\bin.js</b>.   —   <b>A64.dll</b>   <b>RnMod</b>  rundll32.</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタートアップディレクトリに</font><font style="vertical-align: inherit;">ショートカット</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WORDICON.lnk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">作成します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そのタスクは</font><font style="vertical-align: inherit;">、システムの再起動後に</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sinter.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブートローダー</font><font style="vertical-align: inherit;">を起動することです。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">起動ディレクトリに</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Support.lnk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ショートカット</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">作成します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そのタスクは</font><font style="vertical-align: inherit;">、システムの再起動後に</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin.js</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JScriptスクリプトを実行する</font><font style="vertical-align: inherit;">ことです。</font></font></li>
</ul><br>
<img src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/issleduem-aktivnost-kibergruppirovki-donot-team/06.jpg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">逆コンパイルされたメインシェルコードコード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
したがって、この段階では、2つのローダーがシステムに安全に固定されています。これについては、後で詳しく説明します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo2ローダー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分類にもかかわらず、トロイの木馬にはさまざまなタスクがあります。</font><font style="vertical-align: inherit;">したがって、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serviceflow.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">はウォッチドッグの役割を果たします。</font><font style="vertical-align: inherit;">システムに関する情報を収集します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー名、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンピュータネーム</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ Program Files \および\ Program Files（x86）\ディレクトリの内容</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSバージョン</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセッサデータ-</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果をlog.txtファイルに書き込みます。</font><font style="vertical-align: inherit;">それはの存在を確認し</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A64.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sinter.exeファイル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、必要に応じてskillsnewからダウンロードして、\ WINDOWS \タスク\ディレクトリ内にして、[。]トップ管理サーバと、現在のユーザーの代わりに起動して、winlogon.exeのプロセスから対応するトークンを抽出します。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sinter.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トロイの木馬</font></font><code>hxxps://mystrylust.pw/confirm.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、システムに関する以前に収集した情報に</font><font style="vertical-align: inherit;">アクセス</font><font style="vertical-align: inherit;">して送信</font><font style="vertical-align: inherit;">することにより、感染について攻撃者に合図し、</font><font style="vertical-align: inherit;">skillsnew [。] Topに送信します。</font><font style="vertical-align: inherit;">次に、被害者のコンピュータがさらに興味がある場合、customer.txtファイルの内容を次の場所で受け取ります</font></font><code>hxxp://docs.google.com/uc?id=1wUaESzjGT2fSuP_hOJMpqidyzqwu15sz&amp;export=download</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このファイルには、コントロールサーバーの車の名前[。] Drivethrough.topが含まれており、これを使用してさらに対話が行われます。ダウンロード可能なコンポーネントは、\ AppData \ Roaming \ InStore \ディレクトリにあり、タスクスケジューラを使用して起動できます。</font></font><br>
<br>
<img src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/issleduem-aktivnost-kibergruppirovki-donot-team/07.jpg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドフラグメントとタスクテンプレート</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font><i><font style="vertical-align: inherit;">解読された行</font></i><font style="vertical-align: inherit;">悪意のあるダウンローダーの作業の結果、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yty</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フレームワークコンポーネントがシステム</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">統合され、</font><font style="vertical-align: inherit;">指定された拡張子のファイル、インターセプトされた入力行、プロセスリスト、スクリーンショットなど、被害者に関するより完全な情報を抽出できるようになります。プラグインについては、この記事の範囲を超えて考慮します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の同様のサンプルを調べると、デバッグ情報に残っているパスとプロジェクト名が見つかりました。</font></font><br>
<br>
<ul>
<li>D:\Soft\DevelopedCode_Last\BitDefenderTest\m0\New_Single_File\Lo2\SingleV2\Release\BinWork.pdb</li>
<li>D:\Soft\DevelopedCode_Last\BitDefenderTest\m0\New_Single_File\Lo2<br>
\SingleV2_Task_Layout_NewICON\Release\BinWork.pdb</li>
<li>D:\Soft\DevelopedCode_Last\BitDefenderTest\m0\New_Single_File\Lo2<br>
\SingleV2_Task_Layout_NewICON_N_Lnk\Release\BinWork.pdb</li>
<li>D:\Soft\DevelopedCode_Last\BitDefenderTest\m0\New_Single_File\Lo2\SingleV3\Release\WorkFile.pdb</li>
<li>D:\Soft\DevelopedCode_Last\BitDefenderTest\m0\Off\Off_New_Api\Release\C++\ConnectLink.pdb</li>
<li>D:\Soft\DevelopedCode_Last\BitDefenderTest\m0\Off\Off_New_Api\Release\C++\TerBin.pdb</li>
<li>D:\Soft\DevelopedCode_Last\BitDefenderTest\m0\yty 2.0 <i>-</i> With AES Chunks LOC FOR XP Just Bit-Change_Name\Release\TaskTool.pdb</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D：\ Soft \ DevelopedCode_Last \ BitDefenderTest \ yty 2.0 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> With AES Chunks </font><font style="vertical-align: inherit;">OFFS </font><font style="vertical-align: inherit;">Just Bit \ Release \ C ++ \ MsBuild.pdb</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D：\ Soft \ DevelopedCode_Last \ yty 2.0 \ Release \ C ++ \ Setup.pdb</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トロイの木馬を前述のフレームワークに接続する「yty 2.0」サブストリングに加えて、「Loader 2」の省略形である可能性があるサブストリング「Lo2」に注意しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2018年半ばまでのバージョンのブートローダーでは、使用されたすべての文字列がクリアテキストでファイルに保存されていました。</font><font style="vertical-align: inherit;">次のビルドでは、攻撃者は文字列暗号化を使用し始めました。</font><font style="vertical-align: inherit;">バージョンごとに、アルゴリズムは次のように変更されました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2018年5月から：行を反転してBase64をエンコードします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年4月から：前の手順を</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2回</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行します</font><font style="vertical-align: inherit;">。</font></font></li>
<li>  2019 :    AES   CBC   Base64.    Python  :</li>
</ul><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">from</span> Cryptodome.Cipher <span class="hljs-keyword">import</span> AES<font></font>
<font></font>
aeskey = (<span class="hljs-number">0x23</span>, <span class="hljs-number">0xd4</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x55</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">aes_decrypt</span>(<span class="hljs-params">data, aeskey</span>):</span>
	iv = bytes(list(range(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)))<font></font>
	key = bytes(aeskey)<font></font>
	aes = AES.new(key, AES.MODE_CBC, iv)<font></font>
	<span class="hljs-keyword">return</span> aes.decrypt(data).decode().strip(<span class="hljs-string">'\x00'</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">base64_aes_decrypt</span>(<span class="hljs-params">data, aeskey</span>):</span><font></font>
	data = base64.b64decode(data)<font></font>
	data = aes_decrypt(data, aeskey)<font></font>
	<span class="hljs-keyword">return</span> data</code></pre><br>
<ul>
<li>  2019 :        ,    UTF-8   Base64.    Python  :</li>
</ul><br>
<pre><code class="python hljs">subgamma = (<span class="hljs-number">0x2d</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xf</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xf</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xf</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sub_decrypt</span>(<span class="hljs-params">data, subgamma</span>):</span>
	o = <span class="hljs-string">''</span><font></font>
	length = len(data)<font></font>
	subgamma_length = len(subgamma)<font></font>
	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(length):<font></font>
		o += chr((<span class="hljs-number">0x100</span> + ord(data[i]) - subgamma[i%subgamma_length]) &amp; <span class="hljs-number">0xff</span>)
	<span class="hljs-keyword">return</span> o<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">base64_utf8_sub_decrypt</span>(<span class="hljs-params">data, subgamma</span>):</span><font></font>
	data = base64.b64decode(data)<font></font>
	data = data.decode(<span class="hljs-string">'utf-8'</span>)<font></font>
	data = sub_decrypt(data, subgamma)<font></font>
	<span class="hljs-keyword">return</span> data</code></pre><br>
<ul>
<li>  2019 :     XOR       Base64 <u></u>.   XOR  ,              — XOR   .    Python  :</li>
</ul><br>
<pre><code class="python hljs">xorgamma = (<span class="hljs-number">0x56</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x16</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modxor_decrypt</span>(<span class="hljs-params">data, xorgamma</span>):</span>
	o = <span class="hljs-string">''</span><font></font>
	length = len(data)<font></font>
	xorgamma_length = len(xorgamma)<font></font>
	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(length):<font></font>
		c = data[i]<font></font>
		<span class="hljs-keyword">if</span> c != xorgamma[i%xorgamma_length]:<font></font>
			c = data[i] ^ xorgamma[i%xorgamma_length]<font></font>
		o += chr(c)<font></font>
	<span class="hljs-keyword">return</span> o<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">base64_modxor_decrypt</span>(<span class="hljs-params">data, xorgamma</span>):</span><font></font>
	data = base64.b64decode(data)<font></font>
	data = modxor_decrypt(data, xorgamma)<font></font>
	<span class="hljs-keyword">return</span> data</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
復号化用のスクリプトを作成する過程で、一部の個別の行を復号化できないことがわかりました。</font><font style="vertical-align: inherit;">しかし、その後、上記の他の解読方法のいずれもそのような文字列に適していることがわかりました。</font><font style="vertical-align: inherit;">各サンプルでデータのデコード方法が1つだけ実装されていることを確認した後、攻撃者は未使用の行を削除するか、マルウェアの次のバージョン用に正しく暗号化されたものに置き換えるのを忘れたという結論に達しました。</font></font><br>
<br>
<img src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/issleduem-aktivnost-kibergruppirovki-donot-team/08.jpg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブートローダーサンプルの1つの行はさまざまな方法で暗号化されましたが、実行可能ファイルには1つしか実装されていませんでした。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
そのようなエラーは常に研究者の手に渡ってい</font><i><font style="vertical-align: inherit;">ます。</font></i><font style="vertical-align: inherit;">たとえば、忘れられた行の中で、以前は私たちが知らなかった攻撃者の制御サーバーが何度も遭遇しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークインフラストラクチャの機能</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完全を期すために、将来のグループ化攻撃の接続に役立ついくつかの特徴的な機能に注意します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほとんどの管理サーバーはプロバイダーDigitalOcean、LLC（ASN 14061）からリースされ、アムステルダムにあります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃者は、異なるDNS名に同じサーバーを使用しません。新しいドメイン名ごとに、新しい専用ホストを予約することを好みます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほとんどの場合、ドメイン所有者の登録データはプライバシーサービスによって隠されています。</font><font style="vertical-align: inherit;">これには次のサービスが使用されます。WhoisGuard、Inc ;; </font><font style="vertical-align: inherit;">Whois Privacy Protection Service、Inc ;; </font><font style="vertical-align: inherit;">Proxys、LLCによるドメイン。</font><font style="vertical-align: inherit;">Whoisプライバシー保護財団。</font><font style="vertical-align: inherit;">場合によっては、データが利用可能であり、フィールドに入力するための一般的なアプローチに従うことができます。</font></font></li>
</ul><br>
<img src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/issleduem-aktivnost-kibergruppirovki-donot-team/09.jpg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Burningforests [。] Com </font></font></i><br>
<br>
<img src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/issleduem-aktivnost-kibergruppirovki-donot-team/10.jpg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメインWHOIS情報cloud-storage-service [。] ComドメインWHOIS情報</font></font></i><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主に使用されるのは、.top、.pw、.space、.live、および.icu TLDです。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donotチームは、攻撃の各段階で独自のツールを使用することで区別されます。</font><font style="vertical-align: inherit;">コードの分析を複雑にするために使用される手法は、一方では、システムでのアクションを注意深く隠したり、偽装したりする試みの欠如です。</font><font style="vertical-align: inherit;">同じ目標</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">に対する</font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">繰り返しの</font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、選ばれた犠牲者の輪に対する特別な関心を示しているだけでなく、使用された戦術と技術の低い効率を確認することもできます。</font><font style="vertical-align: inherit;">Positive Technologies、Alexey Vishnyakov </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">による投稿</font></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IOC</font></font></b><div class="spoiler_text">6ce1855cf027d76463bb8d5954fcc7bb —    MS Word<br>
hxxp://plug.msplugin.icu/MicrosoftSecurityScan/DOCSDOC<br>
21b7fc61448af8938c09007871486f58 —    MS Word<br>
71ab0946b6a72622aef6cdd7907479ec —  Lo2  C:\Windows\Tasks\Serviceflow.exe<br>
22f41b6238290913fc4d196b8423724d —  Lo2  C:\Windows\Tasks\sinter.exe<br>
330a4678fae2662975e850200081a1b1 — x86-  UACMe<br>
22e7ef7c3c7911b4c08ce82fde76ec72 — x64-  UACMe<br>
skillsnew[.]top<br>
hxxps://mystrylust.pw/confirm.php<br>
hxxp://docs.google.com/uc?id=1wUaESzjGT2fSuP_hOJMpqidyzqwu15sz&amp;export=download<br>
car[.]drivethrough.top<br>
burningforests[.]com<br>
cloud-storage-service[.]com</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja476726/index.html">イノポリス大学の卒業生、グルノーブル大学での勉強、AI、英語とフランス語、ナンキンムシとチーズ</a></li>
<li><a href="../ja476728/index.html">B2B企業のコンテンツ戦略：ケースとチェックリスト</a></li>
<li><a href="../ja476734/index.html">ハードドライブの自己診断とデータ復旧</a></li>
<li><a href="../ja476736/index.html">脅威ハンターの狩猟：有能な専門家を見つけて訓練する方法？</a></li>
<li><a href="../ja476738/index.html">Slurm Prom：ロシア語でのプロメテウスとその作者Vladimir Guryanovの最初のコース</a></li>
<li><a href="../ja476742/index.html">バーンアウトを防ぐために「常に連絡」の状態をどのように変更したか</a></li>
<li><a href="../ja476748/index.html">おおよその技術：QATOK</a></li>
<li><a href="../ja476752/index.html">将来のITランドスケープが消費者、ITプロバイダー、およびT＆Dをどのように結び付けるのに役立つか</a></li>
<li><a href="../ja476754/index.html">Yandex Maps APIサービスを使用して隣人に請求する方法、またはITの巨人が品質管理を必要とする理由</a></li>
<li><a href="../ja476756/index.html">HaskellでFunCをFunCtionalに変える：Serokellがテレグラムブロックチェーンの競争に勝った方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>