<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚭 👐🏾 👨🏿‍🎨 MLアルゴリズムを使用したマルチページドキュメントの分類：VTBエクスペリエンス 📎 👩‍❤️‍👨 🐍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="銀行は、法人のクレジットコンベヤーの一部として、企業にさまざまなドキュメントのオリジナルを要求します。多くの場合、これらのドキュメントのスキャンは、単一のマルチページファイル（「ストリーム」）の形式で行われます。使いやすくするために、フローは個別のドキュメント（単一ページまたは複数ページ）にセグメン...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MLアルゴリズムを使用したマルチページドキュメントの分類：VTBエクスペリエンス</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vtb/blog/497484/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">銀行は、法人のクレジットコンベヤーの一部として、企業にさまざまなドキュメントのオリジナルを要求します。多くの場合、これらのドキュメントのスキャンは、単一のマルチページファイル（「ストリーム」）の形式で行われます。使いやすくするために、フローは個別のドキュメント（単一ページまたは複数ページ）にセグメント化して分類する必要があります。カットの下では、すでにセグメント化されたドキュメントの分類における機械学習アルゴリズムの適用について説明します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nx/pw/ht/nxpwht7ju1u1dkqjvgwpo3liabk.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントのタイプは、テキスト情報と視覚情報の両方によって決定されます。たとえば、パスポートやワークブックは、内部のテキストを分析しなくても視覚的に簡単に区別できます。さらに、このようなドキュメントのテキスト認識の品質は、専門的でないソリューションが使用された場合、かなり低くなります。したがって、視覚的コンポーネントには、分類に関連する情報がはるかに多く含まれています。リース契約と会社の憲章は視覚的に類似している可能性がありますが、それらに含まれるテキスト情報は大幅に異なります。その結果、ドキュメントを分類するタスクは、2つの非構造化データソース（ドキュメントの視覚的表現とテキスト情報の認識結果）を組み合わせるデータ融合モデルに削減されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
銀行では、ドキュメントの分類は、ドキュメントのスキャンまたは写真の個人のコンベヤ、ドキュメントの蓄積された資金の並べ替え、サービス品質を向上させるための顧客レビューのフィルタリング、支払いドキュメントの並べ替え、ニュースフローの追加のフィルタリングなどにも使用されます。 。&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BERTモデル</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BERT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデル</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">（トランスフォーマーからの双方向エンコーダー表現）（</font></a><font style="vertical-align: inherit;">多層双方向コーディング</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トランスフォーマーに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基づく言語モデル）を使用しました</font><font style="vertical-align: inherit;">。トランスフォーマーは、トークンのシーケンス（単語のコードまたは単語の一部）を入力として受け取り、内部変換後、このシーケンスのコード化された表現（埋め込みのセット）を生成します。さらに、これらの埋め込みを使用して、さまざまな問題を解決できます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ed5/d53/ca1/ed5d53ca1f9da10c0d39093d5f6aeaa1.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変圧器モデルのアーキテクチャ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに詳しく説明すると、一連のトークンが入力に供給され、これらのトークンの位置のコードと、トークンが配置されているセグメント（オファー）のコードが合計されます。 Transformerは、入力シーケンスごとに、「注意」の適応メカニズムに基づいて、状況依存の表現（シーケンス全体の一連の埋め込み）を生成します。埋め込まれた各出力は、他のトークンと比較して、いくつかのトークンのエンコードされた「注意」を埋め込みます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mb/p9/nv/mbp9nvuozjmotfflq6qmio5b5l0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動物に焦点を合わせた「注意」メカニズムの一部であるitという単語をエンコードし、itエンコードでの表現の一部を修正しました（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Illustrated Transfomerブログから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BERTモデルは、事前トレーニングとファイルチューニングの2つのステップで構築されます。事前トレーニング中に、モデルは2つの問題を解決します。MLM（マスク言語モデル）とNSP（次の文章予測）です。 MLMタスクでは、入力シーケンス内の特定の割合のトークンにランダムにラベルが付けられ（マスクされ）、タスクはマスクされたトークンの値を復元することです。 NSPタスクは、2番目の文が最初の文の論理的な続きであるかどうかを予測する必要がある場合に、文のペアのバイナリ分類です。チューニング中、事前トレーニング済みのトランスフォーマーは、これらの特定のタスクを再トレーニングします。トランスベースのチューニングは、多くのNLPで自分自身を証明している（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自然言語処理</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">タスク</font><font style="vertical-align: inherit;">：自動チャットボット、翻訳、テキスト・アナライザ、およびその他</font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">変圧器</font></a></i></font><br>
<br>
<img src="https://habrastorage.org/webt/uw/pv/0e/uwpv0eqwrvlyanjei4wztuouudc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回路</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フランス語から英語への自動翻訳用（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Illustrated Transfomer blogから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
BERTモデルが登場する前は、ページングスキャンの方法が使用されていました：画像からのたたみ込み符号（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たたみ込みニューラルネットワークを使用して取得</font><font style="vertical-align: inherit;">）、周波数テキスト属性（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">） 、主題のテキストタグ（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トピック）、畳み込みテキストタグ（1-D畳み込み）、単語の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">埋め込み</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">WordToVec</font></a><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GloVe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）およびそれらの組み合わせ。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前に開発された方法は良質を与えます。</font><font style="vertical-align: inherit;">ただし、品質を最高に近づけるほど、品質を向上させることが難しくなります。</font><font style="vertical-align: inherit;">後で示すように、すでに最高に近い品質があったときに、BERTモデルを使用することで、さらに高い品質を実現できました。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主にロシア語のテキストで作業するため、ロシア語のテキストのいくつかのケース（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RuBERT、ロシア語、DeepPavlovの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ケース）について事前トレーニングされたBERTモデルを使用しました</font><font style="vertical-align: inherit;">。&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちのデータセット&nbsp;</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明文</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが分類問題を解決した文書の選択は、長年にわたってVTB Bankに蓄積された企業の企業文書のスキャンで構成されています。複数ページの企業ドキュメントは、スキャンされたストリームから半自動的にセグメント化され、それらのページは有料ソリューションによって分類されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのスキャンは白黒であり、一部はカラーです（主にカラープリントによる）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビジネスユニットの顧客は、10の主要なドキュメントカテゴリを識別しました（約30,000のセグメント化された複数ページのドキュメント、約129,000ページ）。</font><font style="vertical-align: inherit;">セグメンテーション中のエラーのため、ドキュメントを手動でクリーンアップする必要がありました。</font><font style="vertical-align: inherit;">1つのカテゴリ「その他」も導入され、重要度の低いドキュメントの他のすべてのカテゴリが結合されました（約300カテゴリ、約43,000のマルチページドキュメントは既にセグメント化、約128,000ページ）。</font><font style="vertical-align: inherit;">その結果、11個のクラスを持つ分類子を作成します。</font><font style="vertical-align: inherit;">また、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageNetデータセット</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から約18,000枚の画像を「その他」カテゴリに追加しました</font><font style="vertical-align: inherit;">（「愚か者からの保護」のため）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主な10のカテゴリは次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リース契約</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参加者名簿から抜粋</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会社憲章</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">税務当局への登録証明書</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法人に対するアンケート</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロシアのパスポート</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み込みシート</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法人の州登録証明書</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注文/注文</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定/プロトコル</font></font><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
様々な他の識別カード（外国のパスポート、マイグレーション・カードなど）、他の証明書、IPアンケート、文、作用、委任状、アンケート、仲裁裁判所の決定、ImageNetからの画像、等が。他のカテゴリに含まれていた</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
列車を撮影しました（そのようなすべてのドキュメントの数の）既にセグメント化されたマルチページドキュメントの約81％、開発-9％、テスト-10％。</font><font style="vertical-align: inherit;">実験の純粋さのために、セグメント化された複数ページのドキュメントのページが完全に1つの部分（トレーニング、開発、またはテスト）に分類されるように、選択は分割されました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">認定ステッチページ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、企業のクライアントはオリジナルではなくドキュメントのコピーを提供しますが、その多くは公証人または企業の幹部によって認証されています。</font><font style="vertical-align: inherit;">さらに、複数ページのドキュメントは多くの場合、ホチキス止めされ、ファームウェアの日付が規定され、最後のページで再度認定されます。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、私たちのデータセットには、このような複数ページのドキュメントが多数あり、最後のスキャン（ページ）には、ファームウェアまたは証人の詳細に関するシール、日付、およびその他の情報がありますが、ドキュメントのクラスには関連していません。</font><font style="vertical-align: inherit;">以下は、ストリームからセグメント化された2つの異なるマルチページドキュメントの最後のページです。残りのページを確認しないと、正しく分類することはほとんど不可能です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oo/gl/va/ooglvahkozchwcnzh_s846-l1uk.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さまざまなクラスのドキュメントの同一の最後のページ</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スキャン品質</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントのスキャンは通常、銀行のオフィスで行われますが（コピー機を使用して）、顧客はスキャンしたドキュメントのコピーを何度も持ってきます。</font><font style="vertical-align: inherit;">そして、そのようなコピーの品質は大きく低下します。スキャンでは、多くのドキュメントのホログラムやテクスチャから、およびその他の理由で、トナーの品質の低下から現れる可能性のあるノイズやアーティファクトがたくさんあります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オリエンテーション</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スキャンの向きが間違っている多くのドキュメントがデータセットにあります。これは特に、横向きモードで作成されたIDカードとテキストドキュメントに当てはまります。</font><font style="vertical-align: inherit;">ただし、基本的に、テキストは90度の倍数（±5度）回転されます。</font><font style="vertical-align: inherit;">テキストを抽出するときに、画像の「正しい」方向を追加で決定し、ほとんどのテキストが垂直方向を向くようにしました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベースライン</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのドキュメントは最初のページからスキャンを開始するため、通常、クラスを決定するのに十分な情報があり、多くの複数ページのドキュメントは最初の1ページで大きく異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、最初のページのみにあるマルチページドキュメントのベースライン分類子を作成します。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事ではマルチページストリームのセグメンテーションの問題（PSS-ページストリームセグメンテーション）は考慮していませんが、最初のドキュメントだけでなく、残りのドキュメントのページをトレーニングに追加する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、バイナリ分類によるPSSセグメンテーションの問題の解決策を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">得る</font></a><font style="vertical-align: inherit;">ことができます</font><font style="vertical-align: inherit;">。ストリームからのページの場合、「新しいドキュメント」または「同じドキュメント」という2つのクラスが順番に予測されます。&nbsp;</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前処理</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スキャンの多くの画像は大きく、これは処理速度に影響するため、最初にすべてのスキャンを圧縮して、両方の画像サイズ（幅と高さ）が2000ピクセル以下になるようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像からテキストを抽出するために</font><font style="vertical-align: inherit;">、Googleの</font><font style="vertical-align: inherit;">無料の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tesseract 4.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージを使用</font><font style="vertical-align: inherit;">しました。</font><font style="vertical-align: inherit;">このパッケージのバージョン4.0（およびそれ以降）は、（以前のバージョンとは異なり）ノイズに非常によく対応しているため、テキストからノイズを削除しませんでしたが、スキャンイメージからテキストを抽出する前に「正しい」方向を決定しました。 4.0。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写真の畳み込み分類器</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各ドキュメントから、事前トレーニング済みの畳み込みニューラルネットワーク（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResNet34</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を使用して畳み込み符号を取得しました</font><font style="vertical-align: inherit;">。このため、最後のたたみ込み層の出力（512個のたたみ込み記号のベクトル）が取得されました。ニューラルネットワークを実行する前に、列車からのスキャンの写真は、再訓練に抵抗するためにある程度の増強を受けました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
畳み込み符号の分類子のモデルとして、ロジスティック回帰とブースティングがdevでパラメーターを選択して試されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストでの最良のたたみ込み分類子モデルの品質は、ロジスティック回帰で約76.1％（精度）でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法により、互いに非常によく見えるスキャンを分類できました。しかし、ニューラルネットワークを介して画像を実行するために、それらはニューラルネットワークの入力のサイズに圧縮され（ResNet34のサイズは入力で224x224ピクセルです）、したがって、分類の品質は低くなります。大きなフォント、特別な配置のページ上のいくつかのオブジェクトなどから取得されますが、このような分類子はテキストの本質を考慮していません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ik/9e/9k/ik9e9kshvecqqnmxpkydjgghrwq.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リース契約の最初のページのスキャンと会社のチャーターの最初のページは、視覚的にかなり異なります</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、企業ドキュメントの分類の問題を解決します。多くのタイプのドキュメントにはほとんどテキスト情報が含まれており、視覚的に区別することは困難です。同一のドキュメントヘッダーを持つ行の「長いスポット」だけを視覚的に「キャッチ」することは困難です</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-2/yf/i-/-2yfi-huofcgcclpwevjxawhhty.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。2つの異なるカテゴリからの証明書のスキャンのコピーを視覚的に減らしますほとんど区別がつかない</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
私たちは、テキスト属性が品質を向上させ、したがってテキスト属性を追加するか、ベースラインモデルのテキスト分類子を作成すると想定しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テキスト分類子</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベースラインモデルでは、スキャンから抽出されたテキストのTF-IDF（用語頻度-逆ドキュメント頻度）の標識にのみテキスト分類子を構築します。</font><font style="vertical-align: inherit;">サーマルマトリックスTF-IDFをコンパイルする前に、テキストは小文字に削減されました。</font><font style="vertical-align: inherit;">句読点、ストップワードがテキストから削除されました。</font><font style="vertical-align: inherit;">単語のスペルがチェックされ、見出し語化（Pymystem3パッケージ）によって最初の形式に削減されました。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分類モデルとして、ロジスティック回帰とブースティングを再試行し、パラメーターをdevで選択しました。</font><font style="vertical-align: inherit;">熱行列はサイズが大きく、非常に疎であるため、ロジスティック回帰は良好な品質を示し、品質はテストごとに85.4％（精度）でした。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分類器のアンサンブル</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アンサンブルを取得するために、devサンプルで選択された重みを使用して、畳み込みとテキストの分類子をブレンドしました。つまり、各スキ​​ャンSについて</font><font style="vertical-align: inherit;">、畳み込み分類器によって発行され</font><font style="vertical-align: inherit;">た確率セットY </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（11桁のカテゴリ数）を</font><font style="vertical-align: inherit;">重みαで取得し</font><font style="vertical-align: inherit;">、テキスト分類器によって発行された重み1 –αで</font><font style="vertical-align: inherit;">11桁の確率セットY </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も取得</font><font style="vertical-align: inherit;">します。混合ベースライン分類子の出力を取得するために、これらの加重セットを要約します</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（S）=αY </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +（1-α）Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF</font></font></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
結果として、テストで混合分類子の品質は90.2％（精度）でした。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分類子の結果：たたみ込み（Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、tf-idf（Y</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）とそのアンサンブル（Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -76.1％</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tf-idf</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -85.4％</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -90.2％</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二段階分類</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分類器のアンサンブルの結果を分析したところ、「パスポート（RF）」カテゴリからのスキャンでミスを犯し、パスポートを「その他」に分類することがよくありました。これは、このカテゴリに多くのIDカードが含まれているためです。</font><font style="vertical-align: inherit;">さらに、それらのスキャンやパスポートスキャンも質が悪いことが多く、定性的な分類に干渉します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、分類は2段階で行うことにしました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ1</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
train、dev、testへの最初の分割に従って、カテゴリ「その他」のすべての識別カードをカテゴリ「ロシア連邦のパスポート」に転送しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主な10のカテゴリ：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リース契約</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参加者名簿から抜粋</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会社憲章</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">税務当局への登録証明書</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法人に対するアンケート</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロシア連邦のパスポート+各種IDカード（外国のパスポート、移住カードなど）</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み込みシート</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法人の州登録証明書</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注文/注文</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定/プロトコル</font></font><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カテゴリ「その他」：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その他の証拠</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPアンケート</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステートメント</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行為</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">委任状</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アンケート</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仲裁裁判所の決定など</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのような変更されたサンプルで分類子の集合を訓練しました。&nbsp;</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ2&nbsp;</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のステップとして、最初のステップで取得したカテゴリ6内のバイナリ分類を行いました。「ロシア連邦のパスポート」（クラス1）と「さまざまなIDカード」（クラス0）です。</font><font style="vertical-align: inherit;">これを行うために、類推により、畳み込みとテキストの分類子をトレーニングし（両方のモデルでロジスティック回帰がありました）、アンサンブルを受け取って、それらの出力を比較検討しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのステップでの全体的な分類品質は、テストごとに95.7％（精度）でした。</font><font style="vertical-align: inherit;">この場合、品質はビジネス顧客の要件を満たします（しきい値-95％）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BERTサイン</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記と同様に2段階の分類を作成しましたが、TF-IDF機能の代わりに、RuBERTモデルから取得したページのテキスト埋め込みを使用しました。各ページについて、テキストがトークン化され、最初の256トークンのシーケンスがRuBERTモデルの入力に提供されました（512までのパッドパディング、つまりモデル入力のサイズまで）。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
効率を高めるために、テキストの埋め込みを受け取る前に、BERTモデルの作成者が行った方法と同様に、データセットからのテキストでMLM（マスク言語モデル）モデルを事前トレーニングしました。トークンを取った。実験の純粋さのために、事前トレーニングは、トレーニングからのテキストに対してのみ実行されました。トークンシーケンスは、最初のページだけでなく、セグメント化されたドキュメントのすべてのページで取得されました。シーケンスの開始は、トークン化されたテキストからランダムに選択されました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
埋め込みの段階で、RuBERTモデルの結果の出力の平均ベクトルが、ページのテキスト埋め込みとして採用されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事前トレーニングにより、2段階の分類が改善されました。RuBERTモデルから取得したテキスト埋め込みを使用すると、テストにより品質が96.3％（精度）に向上しました。</font><font style="vertical-align: inherit;">精度が100％に近づくほど、改善が難しくなることに注意してください。</font><font style="vertical-align: inherit;">したがって、結果として生じる0.6％の増加は、重要であると考えることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力トークンシーケンスの長さを512（BERTモデルの入力サイズまで）に増やしても、顕著な増加はありませんでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちが得たもの</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルの最終的なスキーム：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/eb1/bdf/818/eb1bdf8183c5015c50d5316f6092d921.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのテスト済みモデルの品質：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -76.1％、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -85.4％、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -90.2％、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF + 2ステップ-95.7</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + RuBERT + 2ステップ-96.3</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％、</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は畳み込み分類子、Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><sub><font style="vertical-align: inherit;">TF-IDF</font></sub><font style="vertical-align: inherit;">の属性のテキスト分類子です。&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF-</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分類子の集合（Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（S）=αY </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +（1-α）Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF、</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> α= 0.45）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + TF-IDF +</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2ステップ</font><sub><font style="vertical-align: inherit;">-2</font></sub><font style="vertical-align: inherit;">ステップの分類：1）IDカードは「ロシア連邦のパスポート+ IDカード」のカテゴリに転送され、分類子のアンサンブルが11個のクラスを持つ結果のサンプルに構築されます。 2）カテゴリ「ロシア連邦のパスポート+ IDカード」では、2つのクラスを持つ分類子の集合が作成されています。クラス1-ロシア連邦のパスポート、クラス0-IDカード。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN + RuBERT + 2ステップ</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-2段階の分類。</font><font style="vertical-align: inherit;">TF-IDF記号の代わりに、データセットで事前トレーニングされたRuBERTモデルのテキスト埋め込みが使用されます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja497470/index.html">Corona SDKでウイルスを駆除する方法</a></li>
<li><a href="../ja497476/index.html">トップ8 JavaScriptデータ構造</a></li>
<li><a href="../ja497478/index.html">ネットワークシミュレータチュートリアルns-3。第4章</a></li>
<li><a href="../ja497480/index.html">ビデオレクチャー：unix way</a></li>
<li><a href="../ja497482/index.html">Dexを使用したKubernetesでの認証：LDAPを固定する</a></li>
<li><a href="../ja497486/index.html">データ部。2013年。回顧</a></li>
<li><a href="../ja497488/index.html">Microsoft Teams、PowerApps、Power Automateを使用して人事プロセスを自動化します。従業員の離職リクエスト</a></li>
<li><a href="../ja497490/index.html">タツノオトシゴの父性の難しさ：免疫系の遺伝的変態</a></li>
<li><a href="../ja497492/index.html">TSD上のアプリケーションと1Cとの通信：HTTPサービスによるエンタープライズ8.3。パート1.1（APIの詳細な説明）</a></li>
<li><a href="../ja497504/index.html">QuarkusがMicroProfileとSpringを統合する方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>