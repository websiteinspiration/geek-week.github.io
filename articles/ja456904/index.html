<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕟 ㊗️ 🔦 Webプロジェクトの負荷テスト-現金なし 🤸🏼 🤞🏿 ⛹🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="友達、こんにちは！
 
 私たちは、開発に関連するプロジェクトに関する一連の出版物を「カットなし」で続けます。多くの場合、接頭辞「web」が付いています。今日はストレステストについて話しましょう。問題は、クライアントもプロジェクトマネージャーも、なぜそれが必要なのか、どのようなリスクを軽減できるのか...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Webプロジェクトの負荷テスト-現金なし</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bitrix/blog/456904/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">友達、こんにちは！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、開発に関連するプロジェクトに関する一連の出版物を「カットなし」で続けます。多くの場合、接頭辞「web」が付いています。</font><font style="vertical-align: inherit;">今日はストレステストについて話しましょう。</font><font style="vertical-align: inherit;">問題は、クライアントもプロジェクトマネージャーも、なぜそれが必要なのか、どのようなリスクを軽減できるのか、どのように整理するのか、そしてどのようにしてビジネスの利益のために結果を解釈するのが難しいのかを理解していないことです。</font><font style="vertical-align: inherit;">コーヒーを入れて行こう...</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webプロジェクトをロードテストする理由</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際には、品質を維持するためにいくつかのWebプロジェクトでセルフテストがまだ記述されていますが、開発段階でパフォーマンス制御に関与している人はほとんどいません。</font><font style="vertical-align: inherit;">自動テストとコードベンチマークの両方を備えたWebプロジェクトを目にすることは非常にまれです。</font><font style="vertical-align: inherit;">多くの場合、妥当な理由により、開発中は、便益と費用の比率が高い次のヒューリスティックに従います。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLへのクエリ（この一般的なデータベースを例として使用します）は、インデックスを使用するかなり適切なAPIを通過します（ただし、スケジューラでインデックスがどのように使用されているかはわかりませんが、そのカーディナリティは何ですか）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースクエリの実行結果と重いコードがキャッシュされます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発者はブラウザーでWebページの構造を3.14回確認しましたが、目が遅くならない場合は、すべて問題ありません。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、ヒューリスティックスはうまく機能しますが、プロジェクトが大きくて重いほど、何か</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指数関数的に増加する確率で</font><b><font style="vertical-align: inherit;">問題</font></b><font style="vertical-align: inherit;">を起こす可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キャッシュを取る。開発時には、キャッシュを再構築できる頻度について考える時間がないことがよくあります。しかし、無駄です。たとえば製品カタログなどのキャッシュの再構築に時間がかかり、1つの製品が追加されたときにキャッシュがリセットされる場合、キャッシュは害を及ぼします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、ちなみに、組み込みのMySQLクエリキャッシュを使用することはお勧めしません。同様の問題が発生します。少なくとも1つのテーブルレコードを変更すると、テーブルキャッシュは完全にリセットされます（10万行のテーブルがあり、状況の不条理が明らかになります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQLクエリでの同様の状況。クエリがインデックスによって実行される場合、通常、クエリは...「より速く」実行されます。このようなクエリの実行時間は、対数的にデータ量に依存すると考えられます（O（log（n）））。しかし実際には、一部のクエリが他のクエリに影響を与え、同時に一般的なデータベースサブシステム（ディスク上でソートを行うと速度が低下し始める）を使用することがよくあり、これをすぐに予測することはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ロード時に、オペレーティングシステムの興味深い機能、特にmemcachedでの集中的な作業中の発信TCP / IPクライアントポートの範囲のオーバーフローが明らかになります。または、apacheが画像処理のリクエストで詰まる構成中に、nginxキャッシングプロキシサーバーによる処理を構成するのを忘れていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一時テーブルのパスをデータをRAMにマップするディスク（ "/ dev / shm"）にMySQLにインストールするのを忘れる場合があります。これは、負荷が増加すると、データベースサーバーが集中的なソートから解放されるためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、データがWebプロジェクトに追加されると、戦闘1に近いボリュームで、クエリとアルゴリズムは積極的に「O表記」を示します。デカルトが少量のデータに対して不可視である場合、戦闘ボリュームが表示されると、データベースサーバーは電圧が原因で赤になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他にもたくさんの例がありますが、とりあえずこれについて考えましょう。理解しておくべき主なことは、負荷テストが必要であることです。中規模のWebシステムを事前に「ブレーキング」するためのすべての可能なオプションを予測することは非常に高価で、非常に長く、経済的に非実用的であるためです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストレステストのターゲットを特定する方法</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、ストレステスト中にWebシステムの品質レベルを実際にあなたとクライアントの両方に示しているものを理解することが重要です。</font><font style="vertical-align: inherit;">ストレステストのターゲットの具体的な例より良いものと悪いものはありません。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100万ヒット。</font><font style="vertical-align: inherit;">Webページの平均作成時間= 1秒。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは何を示していますか？</font><font style="vertical-align: inherit;">気にしないで。</font><font style="vertical-align: inherit;">負荷テストはどのくらい続きましたか？</font><font style="vertical-align: inherit;">単一のリクエストの実行時間は1ミリ秒または600秒のいずれかであり、どの比率が大きいかは不明です。</font><font style="vertical-align: inherit;">また、エラーの数（「エラー50x」のスタイルのnginx応答）も明確ではありません:-)</font></font></li>
<li><b> 1 . .    - = 1 ,  HTTP- — 0.5%</b>   ?    ,   .   ,    ,   ,          .  —    «» ,   ( «» ),  , ,   .      .</li>
<li><b>   1 . . 25%   ,   10 , 50%   ,   1  (     50 ), 75%   ,   1.5 , 95%   ,   5    HTTP- — 0.5%</b>  !   ,    ,  ,      ,     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、負荷テスト中にWebプロジェクトの速度を評価するための適切なメトリックの選択は非常に重要です。</font><font style="vertical-align: inherit;">原則は1つだけあります。クライアントとお客様の両方にとって絶対に明確であり、品質を明確かつ明確に示す必要があります。</font><font style="vertical-align: inherit;">実際、最も明白で正しい指標は、時間の経過に伴うヒット処理速度の分布です。</font><font style="vertical-align: inherit;">あなたがあなたのストレステストでこれを行うことができるなら-それは素晴らしいでしょう。</font><font style="vertical-align: inherit;">さらに、タイムヒットの分布の性質によって2つのストレステストを比較し、それがどのように、どこで改善されたかを確認できます。</font><font style="vertical-align: inherit;">視覚化は力です！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明確なものはありません：パーセンタイル、中央値、変位値、ドラフト、分布...</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが簡単です！次に、データ分析のための美しい環境で描画および表示します。JupyterNotebook / Python。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような時間（ミリ秒単位）で10件のヒットがWebサイトに作成されたとしましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l-/e8/io/l-e8io0jdj8vupfnnzus5sjm54i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、ヒットの実行時間を昇順でソート</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/m8/ay/tpm8ayfzhwxc3et6n74glp3ngnm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
中央値の25パーセンテルと75パーセンテルを理解するまであと一歩です。すべてがシンプルです-グラフを半分に分割し、中央に「中央値」（グラフの1番）があります。グラフの第1四半期は25パーセンタイル（グラフの数値2）に対応し、第3四半期は75パーセンタイル（グラフの数値3）に対応します。したがって、他のパーセンタイルが取得されます（または、クォンタイルとも呼ばれます）-90、95、99など。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/2l/wu/zf2lwu3o2z9xl7_zb2srwk2ayqc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、上記のヒットの実行時の分布（ヒストグラム）は次のようになります。ご覧のとおり、すべてが非常に明確でシンプルです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ro/s8/yi/ros8yifhkgaa8phiovwj7xhffee.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、負荷テストリクエストのログに従って、分布（ヒストグラム）をすばやく構築する方法です。</font><font style="vertical-align: inherit;">ログ形式に変更します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash
</span>
TOTAL=`cat /var/<span class="hljs-built_in">log</span>/nginx.access.log | wc -l`<font></font>
<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Total:"</span> <span class="hljs-variable">$TOTAL</span><font></font>
<font></font>
cat /var/<span class="hljs-built_in">log</span>/nginx.access.log | awk -F<span class="hljs-string">'-&gt;'</span> <span class="hljs-string">'{ $2=$2*1000; zone = int($2/100)*100; hits[zone]++; } \
END {for (z in hits) {printf("%8s ms: %8s,%6.2f% ",z,hits[z],hits[z]/total*100);{s="";a=0;while(a++&lt;int(hits[z]/total*100)) s=s"*";print s} } }'</span> \<font></font>
total=<span class="hljs-string">"<span class="hljs-variable">$TOTAL</span>"</span> - | sort -n
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、あなたはこのようなものを手に入れます：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yi/cw/kt/yicwktq5m-gspcpb81-q9o5mele.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は今すべてが明確になり、整っていることを願っています。</font><font style="vertical-align: inherit;">そうでない場合は、コメントで質問してください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストレステスト時間</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
よく聞かれる質問-Webプロジェクトの負荷テストはどれくらい続くべきですか？</font><font style="vertical-align: inherit;">単純なヒューリスティックがあります。オペレーティングシステムでは、多くの場合、スケジュールされたタスクが1日に1回実行されます。つまり、バックアップ、ログのローテーションなどです。したがって、負荷テストを実行する時間は、正確には1日以上である必要があります。</font><font style="vertical-align: inherit;">WebプロジェクトがBitrixに基づいている場合、プラットフォームは多くのスケジュールされたタスクも実行するため、少なくとも1日はWebシステムをロードすることをお勧めします。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">負荷分散</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに運営されているウェブサイトがある場合、はい、そこから訪問ログを取得し、それらを使用して新しいウェブシステムをロードできます。</font><font style="vertical-align: inherit;">しかし、多くの場合、開発されたWebシステムのみをロードする問題を解決します。</font><font style="vertical-align: inherit;">負荷分散を計画するには、サイトへのアクセスの予想されるチェーンを共有に分割するモデルが適しています。</font><font style="vertical-align: inherit;">例えば：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホーム-ニュース-詳細なニュース= 50％</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホーム-カタログの概要-詳細なカタログ= 30％</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細カタログ-カタログの概要-詳細カタログ= 15％</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検索結果-詳細カタログ= 5％</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
負荷を作成するためのソフトウェア（多くの場合Jmeterを使用）では、チェーンごとに非常に多くの負荷フローが作成されるため、チェーン内のヒット間の間隔を考慮に入れると、単位時間あたりの各チェーンの合計ヒット数は、50％、30％、15％、5％として相関します。 。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
間隔と潮流の計算は、Excelや鉛筆を使用したシートで簡単に実行できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロードチェーン構造</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webシステムのユーザーのライフサイクルの特徴を考慮することが重要です。多くの場合、ユーザーはログインしてからWebサイトにアクセスします。これを行うには、承認につながるアクションをロードチェーンの先頭に配置する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/9a/5m/lx9a5m6lnnnjt0t4x0lk6avsn5e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストレステスト中にカタログの詳細ページを1つだけプルすることは不可能であること</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">明らかであるため、CSVファイルからリストを読み込んで回転させると便利です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7o/uz/py/7ouzpyccej3ec5s2cfgederegqe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ヒットの間にランダムな一時停止を行う必要があり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">-実際のユーザーが作成する負荷に近づきます。 Cookie値の保存とサーバーへの返却についても覚えています：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j-/x-/wb/j-x-wbxmqntmtxflqp31azfk2ka.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スレッド数を含むロードチェーンのグローバル変数は簡単に設定できます。その後、特定のグローバル変数をロードチェーンのさまざまな場所で使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1z/gd/zb/1zgdzbx3p1i53-kzx69v5uypvbc.png"><br>
<br>
<img src="https://habrastorage.org/webt/ei/qu/x8/eiqux8vtg5i-pkdagldbiiy-0rs.png"><br>
<br>
<img src="https://habrastorage.org/webt/cu/mu/rx/cumurxiaukl1feoyc0ltyeyj2pe.png"><br>
<br>
<h2>  ,     ?</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際には、ほとんどの場合、最初の数分または数時間で負荷テストがWebシステムをクラッシュさせ、すべてが喫煙を開始してから書き込み、サイトが開かず、MySQLがスワップに陥り、接続を許可せず、サーバーのLAが100に近づき、開発者が実行を開始します「これは起こるべきではなかった」という言葉で、にやにや笑うシステム管理者は通常「人生には正義がある！」と答えます。そして、サーバールームでビールを飲み始めます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、すべてが落ちた理由と何を修復するかを理解するために、1日の「成功した」負荷テストの結果をクライアントに示すには、まずオペレーティングシステムの寿命の主要なメトリックの記録を有効にする必要があります。これは無料のmunun / cactiクラスの製品で簡単に実行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webシステムの崩壊時に最も頻繁に起こることとそれを修正する方法をリストします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、Apacheまたはphp-fpm Webサーバーがリクエストで「詰まっている」：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tm/tv/pd/tmtvpdrhkkgk7vckhnxsglfb19m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの場合、これはMySQLの崩壊が原因で発生します-ハングしているリクエストフローの数が増加しています：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/dm/f2/owdmf24wsw1zbm9ksfbgczezzv0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これの理由は何ですか？多くの場合、トップは忘れ</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詰まり</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">痙攣と遅いスワップのRAMからのアプリケーションの損失が発生するのMySQLへの制限にApacheまたはクエリストリームの数を：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/dc/un/qqdcunmpuk0dbmuq0a1jfhqstas.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、スワップで作業する場合、我々は突然の活動を参照してください、あなたはスワップで、どこで落ちた人を理解する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jk/r4/6q/jkr46qtuyn9ttbbcxwav0iaxvhs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、時には問題があります遅いディスクサブシステムの側。この場合、LAは急激に上昇し、ディスク使用率が100に近づきます（右下のグラフ）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rn/sk/od/rnskodj5gr0xot-bozw4haogwas.png"><br>
<br>
<img src="https://habrastorage.org/webt/sp/za/yq/spzayqb1ud73lnrn9wezocfvjv4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明らかに、ストレステストを行うWebプロジェクトで開始できる最も興味深いものの一部のみを明らかにしました。</font><font style="vertical-align: inherit;">しかし、主なことは、正しい方向を設定し、正しいプロセスを構築することです。</font><font style="vertical-align: inherit;">ロード中にポップアップしたものをコメントで尋ねてください、私は助けようとします。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストレステスト結果の解釈</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、5〜10回の再起動と調整の後、負荷テストは飛行を開始し、正常に完了します。</font><font style="vertical-align: inherit;">その結果、さらに分析するために、おおよそこのようなログのセットが必要です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginxへのリクエストのログとクライアントのリクエストの時間（この場合はソフトウェアのロード）、nginxからapache / php-fpmまでのプロキシ時間</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginxエラーログ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apache / php-fpmリクエストログ、リクエスト処理時間とHTTPレスポンスステータス</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache / php-fpmエラーログ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLスローログ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLエラーログ</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、CPU、ディスク、MySQL、RAM、Apacheワーカーなどの使用に関する過去1日間の分析グラフがあるはずです。 （上記のmuninチャートの例を参照してください）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのアーティファクトがあると、投稿の冒頭で単純なawkスクリプトを使用して、これらのログの分布（ヒストグラム）を構築し、HTTPエラーの数とタイプを計算できます。実際、このコンテンツに関するストレステストの成功に関するレポートを生成できます。このレポートは、非常に容量が多く、ビジネスや意思決定に役立ちます。</font></font><br>
<blockquote>    1 . . 25%   ,   50 , 50%   ,   0.5  (), 75%   ,   1 , 95%   ,   5 ,   HTTP — 0.01%.  : , , ,     ,   . <s>  — .</s><br>
<br>
 :<br>
<br>
 —  —   = 50%<br>
 —   —   = 30%<br>
  —   —   = 15%<br>
  —   = 5%<br>
<br>
   :<br>
…<br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、Webシステムの負荷テストに関するわかりやすいレポートです。</font><font style="vertical-align: inherit;">激しい痛みが好きな場合でも、負荷テスト中に、SAP、1CなどのクラスのシステムからWebサイトへのデータのインポートとエクスポートを毎分含めることをお勧めします。</font><font style="vertical-align: inherit;">外部暗号化サービスなどのTCP / IPソケットでの同期接続：たとえば、暗号通貨:-) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、正直</font><font style="vertical-align: inherit;">に言うと、</font><font style="vertical-align: inherit;">インポート/エクスポートが慎重に行われた場合、良心的に、負荷テストおよびこれらの条件下でのビジネスで許容できる数値が表示されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストレステストはどこから来るのですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、この瞬間は強調していません。ささいな理由で、nginx-apache-mysqlワーカー間のバランスの欠如が通常現れます。それら。ワーカーは上から制限されません。その結果、500ワーカー（それぞれ100 MBになることもあります）はすぐにApacheに移行し、リクエストを含む500スレッドがすぐにMySQLに到達します。これにより、HTTP 50xエラーが急増し、崩壊する可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、apache / php-fpmワーカーの数をRAMに収まる数に制限し、同様に、使用可能なRAMのオーバーフローから保護するためにMySQLのスレッド数を制限することをお勧めします。考え方は簡単です。クライアントをnginxの前で待機させると、非同期および非ブロッキングのTCP / IPソケットが少し遅くなる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より厄介な理由の中で、segfault PHPがあるかもしれません。</font><font style="vertical-align: inherit;">この場合、コアダンプ収集を有効にし、gdbを使用してこれが発生する理由を確認する必要があります。</font><font style="vertical-align: inherit;">ほとんどの場合、問題はPHPを更新/構成することで回避できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">舞台裏に残るもの</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webの最新のフロントエンドが活発に活動を始めたという噂が根強く残っているため、この投稿で提示されているバックエンドの従来の負荷テストでは、Angular / React / Vue.jsの根性でWebページを構築するとフリーズする可能性のあるすべてのリスクがカバーされなくなりました。</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重い不透明な、テストが不十分なフロントエンドを使用しないでください。</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要に応じて、ロードチェーンをこの状況に適合させることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いずれにせよ、バックエンドのストレステストの結果が適切な数値を示していて、ブラウザでWebサイトの速度が低下し続けている場合、誰が「真っ赤な顔をした」かは明らかです:-) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
真剣に、次の投稿でこの重要なトピックをカバーしたいと思っています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まとめと結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
合計-開発とビジネスに役立つWebシステムの負荷テストを整理して実施することは複雑ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
適切に編成された負荷テストは常に実行する必要があります。そうしないと、戦闘中に重大なトラブルが発生する可能性があり、数日で解消することができません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストレステストを実施するには、開発者だけでなく、オペレーティングシステムやハードウェアの専門家（経験豊富なシステム管理者）を巻き込むことが重要です。「スワップに陥る」または「IPアドレスのローカル範囲がオーバーフローする」という問題は、目からの出血や失神の原因にはなりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸運のお友達とコメントで質問してください！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja456892/index.html">Webアプリケーションの脆弱性を探す方法：8つの一般的なスキャナーの比較</a></li>
<li><a href="../ja456894/index.html">DockerとNginxによる認証</a></li>
<li><a href="../ja456896/index.html">歪んだキャッシュによるTorネットワークのユーザーの実際のIPアドレスの識別</a></li>
<li><a href="../ja456898/index.html">テーブルを使用した高速整数乗算</a></li>
<li><a href="../ja456902/index.html">安全なプッシュ通知：理論から実践まで</a></li>
<li><a href="../ja456908/index.html">TelegramがどのようにRostelecomにマージするか</a></li>
<li><a href="../ja456910/index.html">インターネットプロジェクトsecurity.txt-別の.well-knownファイルを知る</a></li>
<li><a href="../ja456912/index.html">2019年にサイトを作る方法</a></li>
<li><a href="../ja456916/index.html">Dockerでのクロスコンパイル。何故なの？</a></li>
<li><a href="../ja456920/index.html">Sony Xperia 1 in Russia-価格と予約注文のボーナス</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>