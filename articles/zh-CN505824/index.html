<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐑 ➖ ↙️ 指南：您自己的L2TP VPN 👩🏾‍🎨 👩🏽‍⚖️ 👨‍👩‍👦‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在Internet上四处寻找用于构建自己的VPN的软件后，您经常发现与OpenVPN相关的一堆指南，该指南配置和使用不便，需要Wireguard专有客户端，在所有情况下只有一个SoftEther能够适当实施。但是，可以这么说，我们将讲述Windows的本机VPN实现-路由和远程访问（RRAS）。
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>指南：您自己的L2TP VPN</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/505824/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Internet上四处寻找用于构建自己的VPN的软件后，您经常发现与OpenVPN相关的一堆指南，该指南配置和使用不便，需要Wireguard专有客户端，在所有情况下只有一个SoftEther能够适当实施。</font><font style="vertical-align: inherit;">但是，可以这么说，我们将讲述Windows的本机VPN实现-路由和远程访问（RRAS）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出于一个奇怪的原因，没有人在一份指南中写过关于如何部署所有这些以及如何在其上启用NAT的信息，因此现在我们将对其进行修复，并告诉您如何在Windows Server上创建自己的VPN。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
好的，可以通过现成</font><font style="vertical-align: inherit;">的方式</font><font style="vertical-align: inherit;">从我们的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">市场上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">订购现成的和预先配置的VPN </font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/qd/_q/-e/qd_q-ewnh9imcvaaujksgzzhfyq.jpeg"></div></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.安装服务</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，我们需要Windows Server桌面体验。</font><font style="vertical-align: inherit;">因为没有NPA组件，所以无法安装Core。</font><font style="vertical-align: inherit;">如果计算机是域的成员，则可以在Server Core处停止，在这种情况下，可以将整个内容放入一个GB的RAM中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要安装RRAS和NPA（网络策略服务器）。</font><font style="vertical-align: inherit;">我们需要第一个创建隧道，如果服务器不是域的成员，则需要第二个。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/vc/cg/hwvccgfuaaiklixrhtsf-3jc_g0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在选择的RRAS组件中，选择“直接访问”以及“ VPN和路由”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bm/pr/ly/bmprly1klryjjgc6cr5bcd3w_9k.png"><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.配置RRAS</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装所有组件并重新启动计算机后，我们需要开始配置。如图所示，在启动时，我们找到了RRAS管理器。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i6/rj/ry/i6rjryud0us53ivjbdknjmt43vq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过此管理单元，我们可以管理安装了RRAS的服务器。右键单击，选择设置并继续。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ss/_o/5d/ss_o5de0katdbw7tyrp81pzv7vu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
跳过第一页后，我们转到配置选择，然后选择您自己的配置。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nc/gb/ku/ncgbkuset2thtgb-lrxiqyxvyvu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在下一页，我们被邀请选择组件，选择VPN和NAT。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/q0/ol/uj/q0oluj1q4hgl-jfvhgc7ngt081o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
进一步，进一步。做完了</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，您需要启用ipsec并分配我们的NAT将使用的地址池。右键单击服务器，然后转到属性。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6_/19/f-/6_19f-vs-vmjtv8h_epxtdchpam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，输入l2TP ipsec的密码。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ds/jd/ln/dsjdlntmm_eoy6eymyuqfg29hqc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在“ IPv4”选项卡上，有必要设置发布给客户端的IP地址范围。</font><font style="vertical-align: inherit;">没有此功能，NAT将无法工作。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hh/oa/td/hhoatdwghrbykefsev7ioqg-2-w.png"><br>
<br>
<img src="https://habrastorage.org/webt/th/ol/dc/tholdcsuhekfwb00_pzqlexwnco.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在仍然需要添加NAT接口。</font><font style="vertical-align: inherit;">转到IPv4子项，右键单击空白处并添加新接口。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v9/rg/mq/v9rgmqsrvnlkxbpbwgupalc54si.png"><br>
<br>
<img src="https://habrastorage.org/webt/an/mc/b-/anmcb-lels67_oetwjsqvu2tpks.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在接口（非内部接口）上，启用NAT。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hh/s-/mb/hhs-mbbbqocw0mvvdjydjddr1xy.png"><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.在防火墙中允许规则</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里的一切都很简单。</font><font style="vertical-align: inherit;">您需要找到“路由和远程访问”规则组并将其全部启用。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bo/qk/hd/boqkhd0qpat-thjtkpxrzy2xaok.png"><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.配置NPS</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们正在寻找网络策略服务器的启动。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/ta/o1/khtao1xs4n-xinhylbwpq8rmb8k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在列出所有策略的选项卡中，您需要同时启用两个标准策略。</font><font style="vertical-align: inherit;">这将允许所有本地用户连接到VPN。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f7/e5/un/f7e5und8rmofp9npiq8iqszwfrw.png"><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.通过VPN连接</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出于演示目的，选择Windows10。在开始菜单中，查找VPN。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u6/ly/ge/u6lygemk7e49hku8vb8xpeate8w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
单击添加连接按钮，然后转到设置。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nh/-u/_f/nh-u_f5xvirnp8fx_0eulynloqo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指定所需的连接名称。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IP地址是您的VPN服务器的地址。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VPN类型-具有初步密钥的l2TP。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
共享密钥是vpn（用于我们在市场中的图像。）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
用户名和密码是本地用户（即管理员</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的用户名和密码。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sp/at/kh/spatkhujdiiuivv9imaqxjjdtc0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
单击连接即可完成。</font><font style="vertical-align: inherit;">因此，您自己的VPN已准备就绪。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g4/ic/ws/g4icwstdvv5o_ge-3nlb5soxang.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们希望我们的指南将为那些想要建立自己的VPN而无需联系Linux或只想向其AD添加网关的人提供另一个选择。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/gu/ab/cg/guabcgmwuqoopx1ar80sjpz6keq.png"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/de/0y/l-/de0yl-6ppopvisr_a80b4yuhjj8.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN505796/index.html">CO2，Sp02和COVID-19：为何需要更频繁地通风（很少测量）</a></li>
<li><a href="../zh-CN505798/index.html">PHP 25年：语言的简要历史，PhpStorm享有50％的折扣</a></li>
<li><a href="../zh-CN505802/index.html">托管和专用服务器：回答问题。第4部分</a></li>
<li><a href="../zh-CN505812/index.html">4名工程师，7000台服务器和1次全球性大流行</a></li>
<li><a href="../zh-CN505814/index.html">Radarr，Jackett和购物车中的机器人。以新方式下载种子</a></li>
<li><a href="../zh-CN505826/index.html">如何获得100％甚至更多的视力</a></li>
<li><a href="../zh-CN505834/index.html">中位数样本。置信区间和比较</a></li>
<li><a href="../zh-CN505838/index.html">适用于数千种应用的FPGA技术</a></li>
<li><a href="../zh-CN505846/index.html">从COVID-19开发疫苗时，真正的数学问题是什么？</a></li>
<li><a href="../zh-CN505850/index.html">产品代码中的C ++基于概念的多态性：LLVM中的PassManager</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>