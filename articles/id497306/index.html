<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß† üöµüèª üë©üèæ‚Äçüé§ DLL spoofing (pembajakan DLL) üîú üíª üçä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Saat ini, OTUS telah membuka satu set untuk peluncuran kursus rekayasa balik yang diperbarui pada bulan April . Untuk mengantisipasi di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>DLL spoofing (pembajakan DLL)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/497306/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo semuanya. </font><font style="vertical-align: inherit;">Saat ini, OTUS telah membuka satu set untuk peluncuran kursus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rekayasa balik yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diperbarui pada bulan April </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Untuk mengantisipasi dimulainya kursus, kami secara tradisional menyiapkan terjemahan materi yang menarik.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/hb/vt/zh/hbvtzhxt8n3pklbvenpcr72xxdq.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam sistem operasi Windows, aplikasi dan layanan saat startup mencari DLL yang diperlukan agar berfungsi dengan benar. </font><font style="vertical-align: inherit;">Jika DLL ini tidak ditemukan atau pemuatannya diterapkan dengan cara yang tidak aman (DLL dipanggil tanpa menggunakan path lengkap), maka Anda dapat meningkatkan hak istimewa dengan memaksa aplikasi untuk mengunduh dan menjalankan file DLL berbahaya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perlu dicatat bahwa ketika aplikasi perlu mengunduh DLL, maka pencariannya dilakukan dalam urutan berikut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direktori tempat aplikasi tersebut diunduh</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Windows \ System32</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Windows \ System</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Windows</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direktori kerja saat ini</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direktori dalam variabel lingkungan PATH pengguna</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direktori dalam variabel lingkungan sistem PATH</font></font></li>
</ul><a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langkah 1 - Proses dengan DLL Hilang</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah pertama adalah menemukan proses yang berjalan pada SISTEM dan mencoba memuat DLL yang hilang. </font><font style="vertical-align: inherit;">Ini dapat dilakukan dengan menggunakan </font><font style="vertical-align: inherit;">Sysinternals </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Process Monitor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan menerapkan filter yang tercantum di bawah ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8c/2l/i-/8c2li-1qfj3csw3bfytkej1bzri.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filter Procmon untuk Mencari Proses yang Mengunduh DLL </font></font></i><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proses yang </font></font></a><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Hilang </font></i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Monitor</font></a><font style="vertical-align: inherit;"> akan mengidentifikasi DLL yang hilang yang sedang dicoba dimuat oleh aplikasi dan menunjukkan jalur sebenarnya yang sedang dicari oleh DLL ini. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/gl/0_/bkgl0_q1eomsgzemfqprbkcfqfg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebuah proses dengan DLL yang hilang</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dalam contoh ini, suatu proses </font></font><code>Bginfo.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak memiliki beberapa file .dll yang dapat digunakan untuk meningkatkan hak istimewa.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langkah 2 - Izin Folder</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika perangkat lunak diinstal di direktori </font></font><code>C:\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai gantinya </font></font><code>C:\Program Files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, maka secara default pengguna yang diautentikasi akan memiliki akses tulis ke direktori ini. </font><font style="vertical-align: inherit;">Selain itu, perangkat lunak seperti Perl, Python, Ruby, dll. Biasanya ditambahkan ke variabel PATH. </font><font style="vertical-align: inherit;">Hal ini memungkinkan untuk meningkatkan hak istimewa, karena pengguna dapat menulis DLL berbahaya ke direktori ini, yang akan dimuat pada saat proses dimulai dan mendapatkan hak untuk proses ini. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8x/am/4k/8xam4k5sv5rcxouitfhoerzqjni.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Izin folder yang lemah</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langkah 3 - Gantikan DLL</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menggunakan Metasploit, Anda dapat menghasilkan DLL payload sebagai sesi dengan hak istimewa layanan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s3/kk/ap/s3kkapxllhprqdd9mk8fveeywgi.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generasi DLL Berbahaya</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Proses ini </font></font><code>Bginfo.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diluncurkan di bawah SISTEM, oleh karena itu setelah memulai ulang DLL jahat akan memiliki hak yang sama, karena DLL dimuat dan dieksekusi oleh proses ini. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/w7/xz/wqw7xz-pd3l_8r8axlnbt_yitss.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proses diluncurkan di bawah SISTEM.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Seperti yang ditunjukkan di atas, proses tidak dapat ditemukan </font></font><code>Riched32.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, jadi </font></font><code>pentestlab.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda harus mengubah nama menjadi </font></font><code>Riched32.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ini akan membingungkan aplikasi dan akan mencoba memuat DLL karena menurutnya itu adalah DLL yang sah. DLL jahat harus ditempatkan di salah satu folder tempat Windows mencari file DLL. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sn/la/ms/snlamsjl0ixkfbzvibb8i3tpcsy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL berbahaya diganti nama dan dihosting</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat di bawah, ketika Anda me-restart layanan dengan menggunakan DLL spoofing, sesi Meterpreter dengan hak istimewa SISTEM terbuka. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/j_/r9/baj_r9sstyxrajtkimosaxgvwgo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metasploit - Meningkatnya hak istimewa melalui spoofing DLL</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Powersploit</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proses penggantian DLL dapat dilakukan melalui PowerSploit, di mana ada tiga modul yang akan membantu dalam menemukan layanan dengan DLL yang hilang, dalam menemukan folder dengan hak modifikasi dan dalam menghasilkan DLL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modul ini </font></font><code>Find-ProcessDLLHijack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan menemukan semua proses dalam sistem yang mencoba memuat DLL yang hilang. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/hg/dv/gyhgdveyv97iumk-g5h7jgif6w8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerSploit - Mendeteksi Proses dengan DLL Hilang</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Langkah selanjutnya adalah mengidentifikasi folder tempat pengguna dapat memodifikasi konten. </font><font style="vertical-align: inherit;">Folder akan ditemukan di mana DLL jahat harus dibuang. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/ui/3h/j7ui3hwcu2v-syisqovozbz9z4g.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mendeteksi folder dengan hak untuk memodifikasi</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Langkah terakhir adalah membuat DLL jahat di salah satu folder dengan izin Modify (M). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1a/il/s9/1ails9hsqecemlskuuuefzov8ak.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat DLL di folder dengan izin lemah</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk dapat meningkatkan hak istimewa melalui DLL spoofing, kondisi berikut ini harus dipenuhi:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Izin untuk menulis ke folder sistem</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menginstal perangkat lunak dalam direktori selain direktori default</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layanan yang berjalan di bawah SISTEM dan mencoba memuat DLL yang hilang</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layanan restart</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menemukan aplikasi yang tidak diinstal </font></font><code>Program Files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak sulit, karena selain dari aplikasi pihak ketiga yang tidak dipaksa untuk menginstal sepanjang jalur ini, ada berbagai program perangkat lunak khusus yang terletak di luar folder yang dilindungi ini. </font><font style="vertical-align: inherit;">Selain itu, ada sejumlah layanan Windows, seperti IKEEXT (IKE dan AuthIP IPsec Keying Modules) dengan DLL yang hilang ( </font></font><code>wlbsctrl.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), yang dapat digunakan baik secara manual atau otomatis. </font><font style="vertical-align: inherit;">Ada modul Metasploit khusus untuk IKEEXT:</font></font><br>
<br>
<pre><code class="plaintext hljs">exploit/windows/local/ikeext_service</code></pre><br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   .</a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id497290/index.html">Meningkatkan kinerja menggunakan cache uop di Sandy Bridge +</a></li>
<li><a href="../id497292/index.html">Game Stack Shiro Teknologi</a></li>
<li><a href="../id497296/index.html">Kesalahan populer dalam bahasa Inggris di kalangan profesional TI. Bagian 2: Pengucapan</a></li>
<li><a href="../id497302/index.html">Navigasi otonom dari robot seluler</a></li>
<li><a href="../id497304/index.html">Intercepter-NG 2.5 dirilis untuk Android</a></li>
<li><a href="../id497308/index.html">Bisakah kecerdasan buatan melakukan seni?</a></li>
<li><a href="../id497310/index.html">Jaringan morfologi bipolar: neuron tanpa multiplikasi</a></li>
<li><a href="../id497312/index.html">Pertanyaan tentang CAN FD</a></li>
<li><a href="../id497314/index.html">Seberapa dalam Challenger Abyss adalah: mengukur kedalaman</a></li>
<li><a href="../id497316/index.html">Server sendiri atau cloud publik?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>