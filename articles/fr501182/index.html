<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😠 🤲🏼 📿 oVirt en 2 heures. Partie 2. Installation du gestionnaire et des hôtes 😧 👩🏽‍🌾 🎛️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article est le prochain d'une série sur oVirt, commençant ici .
 
 Des articles
 

1. introduction
2. Installation du gestionnaire (ovirt-engine) ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>oVirt en 2 heures. Partie 2. Installation du gestionnaire et des hôtes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501182/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet article est le prochain d'une série sur oVirt, commençant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des articles</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation du gestionnaire (ovirt-engine) et des hyperviseurs (hôtes) - Nous sommes ici</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paramètres additionnels</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérations de base</font></font></a></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons donc considérer les problèmes d'installation initiale des composants ovirt-engine et ovirt-host.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez toujours voir les processus d'installation dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus en détail </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenu</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer le moteur ovirt</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer ovirt-host</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout d'un nœud à oVirtN</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration de l'interface réseau</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration FC</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer FCoE</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stockage d'images ISO</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Première VM</font></font></a></li>
</ol><br>
<a name="setup-engine"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer le moteur ovirt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour Engine, les exigences minimales sont de 2 cœurs / 4 Gio de RAM / 25 Gio de stockage. Recommandé - à partir de 4 cœurs / 16 Gio de RAM / 50 Gio de stockage. Nous utilisons l'option Gestionnaire autonome lorsque le moteur s'exécute sur une machine physique ou virtuelle dédiée en dehors d'un cluster géré. Pour notre installation, prenons une machine virtuelle, par exemple, sur un ESXi </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> distinct </font><font style="vertical-align: inherit;">. Il est pratique d'utiliser des outils d'automatisation du déploiement ou le clonage à partir d'un modèle préalablement préparé ou l'installation de kickstart. </font></font><br>
<br>
<i><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Remarque: pour un système de production, c'est une mauvaise idée car le manager travaille sans réserve et devient un goulot d'étranglement. Dans ce cas, il est préférable de considérer l'option Moteur auto-hébergé.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si nécessaire, la procédure de conversion de Standalone en Self Hosted est décrite en détail dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En particulier, l'hôte doit recevoir la commande de réinstallation avec prise en charge du moteur hébergé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez CentOS 7 dans la configuration minimale sur la machine virtuelle, puis mettez à jour et redémarrez le système:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum update -y &amp;&amp; sudo reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour une machine virtuelle, il est utile d'installer un agent invité:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install open-vm-tools</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pour les hôtes VMware ESXi ou pour oVirt:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install ovirt-guest-agent</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous connectons le référentiel et installons le gestionnaire:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install https://resources.ovirt.org/pub/yum-repo/ovirt-release43.rpm<font></font>
$ sudo yum install ovirt-engine<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réglage de base:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo engine-setup</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la plupart des cas, les paramètres par défaut sélectionnés sont suffisants; pour leur utilisation automatique, vous pouvez démarrer la configuration avec la touche:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo engine-setup --accept-defaults</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons maintenant nous connecter à notre nouveau moteur sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ovirt.lab.example.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il est toujours vide ici, alors passons à l'installation d'hyperviseurs.</font></font><br>
<a name="setup-host"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer ovirt-host</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez CentOS 7 dans la configuration minimale sur l'hôte physique, puis connectez le référentiel, mettez à jour et redémarrez le système:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install https://resources.ovirt.org/pub/yum-repo/ovirt-release43.rpm<font></font>
$ sudo yum update -y &amp;&amp; sudo reboot<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque: il est pratique d'utiliser des outils d'automatisation du déploiement ou de lancer l'installation pour l'installation.</font></font></i><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de fichier Kickstart</font></font></b>
                        <div class="spoiler_text">! <b>   !</b>  !<br>
<br>
<pre><code class="plaintext hljs"># System authorization information<font></font>
auth --enableshadow --passalgo=sha512<font></font>
# Use CDROM installation media<font></font>
cdrom<font></font>
# Use graphical install<font></font>
graphical<font></font>
# Run the Setup Agent on first boot<font></font>
firstboot --enable<font></font>
ignoredisk --only-use=sda<font></font>
# Keyboard layouts<font></font>
keyboard --vckeymap=us --xlayouts='us','ru' --switch='grp:alt_shift_toggle'<font></font>
# System language<font></font>
lang ru_RU.UTF-8<font></font>
<font></font>
# Network information<font></font>
network  --bootproto=dhcp --device=ens192 --ipv6=auto --activate<font></font>
network  --hostname=kvm01.lab.example.com<font></font>
<font></font>
# Root password 'monteV1DE0'<font></font>
rootpw --iscrypted $6$6oPcf0GW9VdmJe5w$6WBucrUPRdCAP.aBVnUfvaEu9ozkXq9M1TXiwOm41Y58DEerG8b3Ulme2YtxAgNHr6DGIJ02eFgVuEmYsOo7./<font></font>
# User password 'metroP0!is'<font></font>
user --name=mgmt --groups=wheel --iscrypted --password=$6$883g2lyXdkDLbKYR$B3yWx1aQZmYYi.aO10W2Bvw0Jpkl1upzgjhZr6lmITTrGaPupa5iC3kZAOvwDonZ/6ogNJe/59GN5U8Okp.qx.<font></font>
# System services<font></font>
services --enabled="chronyd"<font></font>
# System timezone<font></font>
timezone Europe/Moscow --isUtc<font></font>
# System bootloader configuration<font></font>
bootloader --append=" crashkernel=auto" --location=mbr --boot-drive=sda<font></font>
# Partition clearing information<font></font>
clearpart --all<font></font>
# Disk partitioning information<font></font>
part /boot --fstype xfs --size=1024 --ondisk=sda  --label=boot<font></font>
part pv.01 --size=45056 --grow<font></font>
volgroup HostVG pv.01 --reserved-percent=20<font></font>
logvol swap --vgname=HostVG --name=lv_swap --fstype=swap --recommended<font></font>
logvol none --vgname=HostVG --name=HostPool --thinpool --size=40960 --grow<font></font>
logvol / --vgname=HostVG --name=lv_root --thin --fstype=ext4 --label="root" --poolname=HostPool --fsoptions="defaults,discard" --size=6144 --grow<font></font>
logvol /var --vgname=HostVG --name=lv_var --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=16536<font></font>
logvol /var/crash --vgname=HostVG --name=lv_var_crash --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=10240<font></font>
logvol /var/log --vgname=HostVG --name=lv_var_log --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=8192<font></font>
logvol /var/log/audit --vgname=HostVG --name=lv_var_audit --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=2048<font></font>
logvol /home --vgname=HostVG --name=lv_home --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=1024<font></font>
logvol /tmp --vgname=HostVG --name=lv_tmp --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=1024<font></font>
<font></font>
%packages<font></font>
@^minimal<font></font>
@core<font></font>
chrony<font></font>
kexec-tools<font></font>
<font></font>
%end<font></font>
<font></font>
%addon com_redhat_kdump --enable --reserve-mb='auto'<font></font>
<font></font>
%end<font></font>
<font></font>
%anaconda<font></font>
pwpolicy root --minlen=6 --minquality=1 --notstrict --nochanges --notempty<font></font>
pwpolicy user --minlen=6 --minquality=1 --notstrict --nochanges --emptyok<font></font>
pwpolicy luks --minlen=6 --minquality=1 --notstrict --nochanges --notempty<font></font>
%end<font></font>
# Reboot when the install is finished.<font></font>
reboot --eject<font></font>
</code></pre><br>
  , .,  <a href="" rel="nofollow">ftp.example.com/pub/labkvm.cfg</a>.           'Install CentOS 7',     ( Tab)    ( ,  )  <br>
<br>
<pre><code class="plaintext hljs">' inst.ks=ftp://ftp.example.com/pub/labkvm.cfg'</code></pre>.<br>
      /dev/sda,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> </a> (      lsblk).     kvm01.lab.example.com (     hostnamectl set-hostname kvm03.lab.example.com),  IP  — ,   — ,    .<br>
<br>
  root: monteV1DE0,   mgmt: metroP0!is.<br>
<b>!    !  !</b><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Répétez (ou exécutez en parallèle) sur tous les hôtes. </font><font style="vertical-align: inherit;">De la mise sous tension du serveur "vide" à l'état fini, en prenant en compte 2 longs téléchargements, cela prend environ 20 minutes.</font></font><br>
<a name="add-host"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout d'un nœud à oVirt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est très simple: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calcul → Hôtes → Nouveau → ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'assistant, les champs Nom (nom d'affichage, par exemple, kvm03), Nom d'hôte (FQDN, par exemple kvm03.lab.example.com) et la section Authentification sont requis - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisateur root (invariablement)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mot de passe ou clé publique SSH. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir cliqué sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">vous recevrez le message </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«Vous n'avez pas configuré la gestion de l'alimentation pour cet hôte. Es-tu sur de vouloir continuer? "</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ceci est normal - nous considérerons la gestion de l'alimentation plus tard, après une connexion hôte réussie. Cependant, si les machines sur lesquelles les hôtes sont installés ne prennent pas en charge la gestion (IPMI, iLO, DRAC, etc.), je recommande de la désactiver: Calcul → Clusters → Par défaut → Modifier → Clôture Ploicy → Activer la clôture, décochez-la.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le référentiel oVirt n'était pas connecté sur l'hôte, l'installation échouera, mais ça va - vous devez l'ajouter, puis cliquez sur Installer -&gt; Réinstaller. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La connexion à l'hôte ne prend pas plus de 5 à 10 minutes.</font></font><br>
<a name="host-nic"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration de l'interface réseau</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous construisons un système tolérant aux pannes, la connexion réseau doit également fournir une connexion redondante, ce qui se fait dans l'onglet Calculer → Hôtes → </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HÔTE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> → Interfaces réseau - Configurer les réseaux hôtes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fonction des capacités de votre équipement réseau et de vos approches d'architecture, des options sont possibles. Il est préférable de se connecter à la pile de commutateurs du haut du rack de sorte que lorsqu'un échec, la disponibilité du réseau ne soit pas interrompue. Prenons l'exemple d'un canal LACP agrégé. Pour configurer le canal agrégé, "prenez" le 2ème adaptateur inutilisé avec la souris et "amenez" le 1er. La fenêtre </font><b><font style="vertical-align: inherit;">Create New Bond</font></b><font style="vertical-align: inherit;"> s'ouvre.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">où LACP (Mode 4, Agrégation de liens dynamiques, 802.3ad) est sélectionné par défaut. </font><font style="vertical-align: inherit;">Côté commutateur, la configuration normale du groupe LACP est effectuée. </font><font style="vertical-align: inherit;">S'il n'est pas possible de créer une pile de commutateurs, vous pouvez utiliser le mode Active-Backup (Mode 1). </font><font style="vertical-align: inherit;">Nous examinerons les paramètres VLAN dans le prochain article, et plus en détail avec des recommandations sur les paramètres réseau dans le document </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guide de planification et des prérequis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="host-fc"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration FC</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fibre Channel (FC) est pris en charge immédiatement, son utilisation est simple. </font><font style="vertical-align: inherit;">Nous ne configurerons pas le réseau de stockage, y compris la configuration des systèmes de stockage et le zonage des commutateurs Fabric dans le cadre de la configuration oVirt.</font></font><br>
<a name="ovirt-fcoe"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer FCoE</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FCoE, à mon avis, n'était pas largement utilisé dans les réseaux de stockage, mais il est souvent utilisé sur les serveurs comme le «dernier kilomètre», par exemple, dans HPE Virtual Connect.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La configuration de FCoE nécessite des étapes simples supplémentaires.</font></font></b>
                        <div class="spoiler_text"><h4>Setup FCoE Engine</h4><br>
   Red Hat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">B.3. How to Set Up Red Hat Virtualization Manager to Use FCoE<br>
On the Manager</a>,         :<br>
<br>
<pre><code class="bash hljs">
$ sudo engine-config -s UserDefinedNetworkCustomProperties=<span class="hljs-string">'fcoe=^((enable|dcb|auto_vlan)=(yes|no),?)*$'</span><font></font>
$ sudo systemctl restart ovirt-engine.service<font></font>
</code></pre><br>
<h4>Setup Node FCoE</h4><br>
 oVirt-Host'   <br>
<br>
<pre><code class="bash hljs">$ sudo yum install vdsm-hook-fcoe</code></pre><br>
   FCoE,   Red Hat: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">25.5. Configuring a Fibre Channel over Ethernet Interface</a>.<br>
<br>
 Broadcom CNA   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">User Guide FCoE Configuration for Broadcom-Based Adapters</a>.<br>
<br>
,    (   minimal):<br>
<br>
<pre><code class="bash hljs">$ sudo yum install fcoe-utils lldpad</code></pre><br>
   ( ens3f2  ens3f3   CNA,    ):<br>
<br>
<pre><code class="bash hljs">$ sudo cp /etc/fcoe/cfg-ethx /etc/fcoe/cfg-ens3f2<font></font>
$ sudo cp /etc/fcoe/cfg-ethx /etc/fcoe/cfg-ens3f3<font></font>
$ sudo vim /etc/fcoe/cfg-ens3f2<font></font>
$ sudo vim /etc/fcoe/cfg-ens3f3<font></font>
</code></pre><br>
<b></b>:      DCB/DCBX,  DCB_REQUIRED     no.<br>
<br>
DCB_REQUIRED=«yes» → <b>#</b>DCB_REQUIRED=«yes»<br>
<br>
  ,  adminStatus    ,  ..   FCoE:<br>
<br>
<pre><code class="bash hljs">$ sudo lldptool <span class="hljs-built_in">set</span>-lldp -i ens3f0 adminStatus=disabled<font></font>
...<font></font>
$ sudo lldptool <span class="hljs-built_in">set</span>-lldp -i ens3f3 adminStatus=disabled
</code></pre><br>
    ,   LLDP:<br>
<br>
<pre><code class="bash hljs">$ sudo systemctl start lldpad<font></font>
$ sudo systemctl <span class="hljs-built_in">enable</span> lldpad
</code></pre><br>
  ,    DCB/DCBX,  DCB_REQUIRED     <b>no</b>      .<br>
<br>
<pre><code class="bash hljs">$ sudo dcbtool sc ens3f2 dcb on<font></font>
$ sudo dcbtool sc ens3f3 dcb on<font></font>
$ sudo dcbtool sc ens3f2 app:fcoe e:1<font></font>
$ sudo dcbtool sc ens3f3 app:fcoe e:1<font></font>
$ sudo ip link <span class="hljs-built_in">set</span> dev ens3f2 up<font></font>
$ sudo ip link <span class="hljs-built_in">set</span> dev ens3f3 up<font></font>
$ sudo systemctl start fcoe<font></font>
$ sudo systemctl <span class="hljs-built_in">enable</span> fcoe
</code></pre><br>
      :<br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/sysconfig/network-scripts/ifcfg-ens3f2<font></font>
$ sudo vim /etc/sysconfig/network-scripts/ifcfg-ens3f3<font></font>
</code></pre><br>
<pre><code class="plaintext hljs">ONBOOT=yes</code></pre><br>
  FCoE ,      .<br>
<br>
<pre><code class="bash hljs">$ sudo fcoeadm -i</code></pre><br>
  FCoE     FC.<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui suit est la configuration des systèmes et réseaux de stockage - zonage, hôtes SAN, création et présentation de volumes / LUN, après quoi le stockage peut être connecté aux hôtes ovirt: Stockage → Domaines → Nouveau domaine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fonction de domaine que nous laissons Données, Type de stockage - Fibre Channel, Hôte - tout, nom - par exemple storNN-volMM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certes, votre système de stockage permet la connexion n'est pas seulement une réservation de chemins, mais aussi un équilibrage. </font><font style="vertical-align: inherit;">De nombreux systèmes modernes sont capables de transmettre des données de manière optimale sur tous les chemins (ALUA actif / actif). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour activer tous les chemins dans un état actif, vous devez configurer le multipassing, plus à ce sujet dans les articles suivants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La configuration de NFS et iSCSI se fait de manière similaire.</font></font><br>
<a name="host-iso"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stockage d'images ISO</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour installer l'OS, vous aurez besoin de leurs fichiers d'installation, le plus souvent disponibles sous forme d'images ISO. </font><font style="vertical-align: inherit;">Vous pouvez utiliser le chemin d'accès intégré, mais pour travailler avec des images dans oVirt, un type spécial de stockage est développé - ISO, qui peut être ciblé sur un serveur NFS. </font><font style="vertical-align: inherit;">Ajoutez-le: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stockage → Domaines → Nouveau domaine, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fonction de domaine → ISO, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
chemin d'exportation - par exemple mynfs01.example.com:/exports/ovirt-iso (au moment de la connexion, le dossier doit être vide, le gestionnaire doit pouvoir y écrire), </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom - par exemple mynfs01-iso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour stocker des images, le gestionnaire créera la structure </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ exports / ovirt-iso </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ &lt;certains UUID&gt; / images / 11111111-1111-1111-1111-111111111111 /</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez déjà des images ISO sur notre serveur NFS, il est pratique de les lier à ce dossier au lieu de copier des fichiers pour économiser de l'espace.</font></font><br>
<a name="1stVM"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Première VM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À ce stade, vous pouvez déjà créer la première machine virtuelle, y installer le système d'exploitation et le logiciel d'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calculer → Machines virtuelles → Nouveau </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la nouvelle machine, spécifiez un nom (Nom), créez un disque (Images d'instance → Créer) et connectez l'interface réseau (Instanciez les interfaces réseau VM en choisissant un profil vNIC → choisissez le seul ovirtmgmt dans la liste jusqu'à présent). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Côté client, vous avez besoin d'un navigateur moderne et d'un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client SPICE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour interagir avec la console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première machine a démarré avec succès. </font><font style="vertical-align: inherit;">Cependant, pour un fonctionnement plus complet du système, un certain nombre de paramètres supplémentaires sont requis, que nous continuerons dans les articles suivants.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501166/index.html">oVirt en 2 heures. Partie 1. Plateforme de virtualisation de basculement ouverte</a></li>
<li><a href="../fr501168/index.html">Les aides-soignants se sauvent - sauvegardent-ils, sauvegardent-ils, s'épuisent-ils?</a></li>
<li><a href="../fr501172/index.html">Mon ordinateur Mikrosh: continuez la semaine de la nostalgie</a></li>
<li><a href="../fr501178/index.html">Comment regarder du porno affecte la productivité du travail et des études</a></li>
<li><a href="../fr501180/index.html">[Post-Question] Avez-vous besoin d'un mouvement informatique pour FAITS sur le coronavirus et les «effets secondaires»</a></li>
<li><a href="../fr501184/index.html">Comment configurer Apollo pour fonctionner avec GraphQL dans Android</a></li>
<li><a href="../fr501188/index.html">Comment traiter l'imagerie satellite avec Sen2Cor</a></li>
<li><a href="../fr501190/index.html">Comment démarrer une startup, pénétrer le marché chinois et obtenir 15 millions d'investissements</a></li>
<li><a href="../fr501192/index.html">Les 5 meilleurs conseils pour améliorer les compétences non techniques en anglais</a></li>
<li><a href="../fr501194/index.html">Dans le sillage des particules chaudes. Chambre de Wilson</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>