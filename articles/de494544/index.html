<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏆 🐯 🏙️ Analysieren von Fotos von cian.ru mit Selen 🚄 👨🏿‍🤝‍👨🏽 👊🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo liebe Khabrovites, in diesem kleinen Beispiel möchte ich zeigen, wie Sie eine Seite analysieren können, deren Daten mithilfe von Javascript-Widg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Analysieren von Fotos von cian.ru mit Selen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494544/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo liebe Khabrovites, in diesem kleinen Beispiel möchte ich zeigen, wie Sie eine Seite analysieren können, deren Daten mithilfe von Javascript-Widgets geladen werden. Selbst wenn die Seite in diesem Beispiel einfach zu speichern ist, können Sie aufgrund dieser Widgets nicht alle erforderlichen Fotos daraus analysieren. In diesem Fall verwende ich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cian.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als </font><font style="vertical-align: inherit;">Beispiel </font><font style="vertical-align: inherit;">, das eine eigene </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API hat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die ich nicht verwenden werde, sondern Selenium. Ich arbeite nicht bei cian.ru, ich benutze diese Seite nur als Beispiel. Der Code im Parser ist einfach und für Anfänger konzipiert.</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine kurze Einführung - als ich mir in meiner Freizeit Beispiele für Reparaturen in cian.ru ansah, dachte ich, es wäre schön, die Fotos zu speichern, die ich mochte, aber das manuelle Speichern würde lange dauern, außerdem ist dies nicht unsere Methode, also habe ich beschlossen, dies zu schreiben Parser.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Parser ist in Python3 aus der Distribution von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anaconda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selenium</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chromedriver Binary geschrieben, die</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ich separat von diesen Links installiert habe. </font><font style="vertical-align: inherit;">(Und natürlich muss der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Chrome-Browser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf dem System installiert sein. </font><font style="vertical-align: inherit;">)</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unten ist der vollständige Parser-Code, dann werde ich die Hauptpunkte separat analysieren.</font></font></p><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.chrome.options <span class="hljs-keyword">import</span> Options
<span class="hljs-keyword">from</span> selenium.common.exceptions <span class="hljs-keyword">import</span> NoSuchElementException
<span class="hljs-keyword">import</span> chromedriver_binary 
<span class="hljs-keyword">import</span> urllib
<span class="hljs-keyword">import</span> time<font></font>
<font></font>
print(<span class="hljs-string">'start...'</span>)<font></font>
<font></font>
site = <span class="hljs-string">"https://www.cian.ru/sale/flat/222059642/"</span><font></font>
<font></font>
chrome_options = Options()<font></font>
chrome_options.add_argument(<span class="hljs-string">"--headless"</span>)<font></font>
<font></font>
driver = webdriver.Chrome(options=chrome_options)<font></font>
<span class="hljs-comment">#driver = webdriver.Chrome()</span><font></font>
driver.get(site)<font></font>
<font></font>
i = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:   
    <span class="hljs-keyword">try</span>:<font></font>
        url = driver.find_element_by_xpath(<span class="hljs-string">"//div[contains(@class, 'fotorama__active')]/img"</span>).get_attribute(<span class="hljs-string">'src'</span>)
    <span class="hljs-keyword">except</span> NoSuchElementException:
        <span class="hljs-keyword">break</span>        <font></font>
<font></font>
    i += <span class="hljs-number">1</span><font></font>
    print(i, url)<font></font>
<font></font>
    driver.find_element_by_xpath(<span class="hljs-string">"//div[@class='fotorama__arr fotorama__arr--next']"</span>).click()<font></font>
<font></font>
    name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]<font></font>
    urllib.request.urlretrieve(url, name)<font></font>
<font></font>
    time.sleep(<span class="hljs-number">2</span>)<font></font>
<font></font>
print(<span class="hljs-string">'done.'</span>)</code></pre><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">https://www.cian.ru/sale/flat/222059642/</a>    .      <code>driver</code>        <code>get</code>.  ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Headless Chrome</a>, ..   <code>webdriver.Chrome()</code>      <code>--headless</code>,         ,      ,     <code>chrome_options</code>     ,     .</p><br>
<pre><code class="python hljs">site = <span class="hljs-string">"https://www.cian.ru/sale/flat/222059642/"</span><font></font>
<font></font>
chrome_options = Options()<font></font>
chrome_options.add_argument(<span class="hljs-string">"--headless"</span>)<font></font>
<font></font>
driver = webdriver.Chrome(options=chrome_options)<font></font>
<span class="hljs-comment">#driver = webdriver.Chrome()</span>
driver.get(site)</code></pre><br>
<p>      ,    ,        , ..        "next".</p><br>
<p><img src="https://habrastorage.org/webt/cg/1d/df/cg1ddfpfsda6ozsadz1t0ob2p48.png"></p><br>
<p>     <code>url</code>   ,  <code>try/except</code>   <code>NoSuchElementException</code>,   ,      Selenium    .</p><br>
<pre><code class="python hljs">    <span class="hljs-keyword">try</span>:<font></font>
        url = driver.find_element_by_xpath(<span class="hljs-string">"//div[contains(@class, 'fotorama__active')]/img"</span>).get_attribute(<span class="hljs-string">'src'</span>)
    <span class="hljs-keyword">except</span> NoSuchElementException:
        <span class="hljs-keyword">break</span>       </code></pre><br>
<p>           .</p><br>
<pre><code class="python hljs">    driver.find_element_by_xpath(<span class="hljs-string">"//div[@class='fotorama__arr fotorama__arr--next']"</span>).click()</code></pre><br>
<p>         <code>urllib</code>.</p><br>
<pre><code class="python hljs">    name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]<font></font>
    urllib.request.urlretrieve(url, name)</code></pre><br>
<p>      ,         . (        Selenium)</p><br>
<pre><code class="python hljs">    time.sleep(<span class="hljs-number">2</span>)</code></pre><br>
<p>      Selenium,  ,    ,  -         .</p><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"></a>.</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de494532/index.html">TTA-Prozessor. Teil 2</a></li>
<li><a href="../de494534/index.html">Keine Masken, aber du hältst 1/2</a></li>
<li><a href="../de494536/index.html">Erkenntnistheoretische Standards von Erfindungen</a></li>
<li><a href="../de494538/index.html">Zuckende Luftschlangen verdienen im Traum Tausende von Dollar</a></li>
<li><a href="../de494542/index.html">Der Regenbogennachweis zeigt das Vorhandensein von Standardkomponenten in Diagrammen</a></li>
<li><a href="../de494546/index.html">Modellierung des Universums: Himmelsmechanik klar</a></li>
<li><a href="../de494548/index.html">Karasische Programmiersprache</a></li>
<li><a href="../de494552/index.html">Über schlechte Arbeitgeber gute Arbeitnehmer: Leidenschaften nach der freien Woche</a></li>
<li><a href="../de494554/index.html">SDL 2.0-Unterrichtszyklus: Lektion 6 - Herunterladen von Schriftarten mit SDL_ttf</a></li>
<li><a href="../de494560/index.html">Genaues Fahren: Wie und warum Innovationen im Automobilbereich Unfälle hervorrufen - Studie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>