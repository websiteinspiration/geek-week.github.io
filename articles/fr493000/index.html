<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî¥ üëáüèª üê´ M√©thodes de traitement du code h√©rit√© en utilisant GitLab comme exemple üë®üèΩ‚Äçüè≠ üíê ‚úåüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vous pouvez sans cesse tricher si GitLab est un bon produit. Il vaut mieux regarder les chiffres: selon les r√©sultats du cycle d'investissement, la va...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>M√©thodes de traitement du code h√©rit√© en utilisant GitLab comme exemple</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/493000/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez sans cesse tricher si GitLab est un bon produit. Il vaut mieux regarder les chiffres: selon les r√©sultats du cycle d'investissement, la valorisation de GitLab √©tait de 2,7 milliards de dollars, tandis que la valorisation pr√©c√©dente √©tait de 1,1 milliard de dollars. Cela signifie une croissance rapide et la soci√©t√© embauchera de plus en plus de d√©veloppeurs front-end. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est l'histoire de l'apparition du frontend dans GitLab. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cy/uq/uh/cyuquhlxnzithh35ujtiswr5upy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un graphique du nombre de fournisseurs frontaux dans GitLab, commen√ßant en 2016, quand ils n'√©taient pas l√† du tout, et se terminant en 2019, alors qu'il y en avait d√©j√† quelques dizaines. Mais GitLab lui-m√™me existe depuis 7 ans. Donc, jusqu'en 2017, le code principal sur le frontend a √©t√© √©crit par les d√©veloppeurs du backend, pire, les d√©veloppeurs du backend sur Ruby on Rails (en aucun cas, nous ne voulons offenser qui que ce soit et expliquer ci-dessous de quoi nous parlons).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis 7 ans, tout projet, qu'il vous plaise ou non, devient obsol√®te. </font><font style="vertical-align: inherit;">√Ä un moment donn√©, le refactoring devient impossible √† reporter. </font><font style="vertical-align: inherit;">Et le voyage commence, plein d'aventures, dont le point final n'atteint jamais. </font><font style="vertical-align: inherit;">√Ä propos de la fa√ßon dont cela se produit dans GitLab, a d√©clar√© Ilya Klimov.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3tdfBMRq34o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos de l'orateur: Ilya Klimov (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xanf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ing√©nieur frontend senior chez GitLab. </font><font style="vertical-align: inherit;">Avant cela, il a travaill√© dans des startups et de l'externalisation, a dirig√© une petite entreprise d'externalisation. </font><font style="vertical-align: inherit;">Ensuite, j'ai r√©alis√© que je n'avais pas encore eu le temps de travailler sur le produit et je suis venu √† GitLab. </font></font></em><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L‚Äôarticle est bas√© sur un rapport d‚ÄôIlya de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FrontendConf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Par cons√©quent, il ne structure pas tant les informations que l‚Äôexp√©rience de l‚Äôorateur. </font><font style="vertical-align: inherit;">Cela peut sembler excessivement conversationnel, mais non moins int√©ressant du point de vue du travail avec l'h√©ritage. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans GitLab, comme dans de nombreux autres projets, ils migrent progressivement des anciennes technologies vers quelque chose de plus pertinent:</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CoffeeScript en JavaScript. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les d√©veloppeurs de Ruby on Rails, lorsqu'ils ont commenc√© le projet, ne pouvaient s'emp√™cher de pr√™ter attention √† CoffeeScript, qui ressemble beaucoup √† Ruby.</font></font></li>
<li><strong>JQuery  Vue. </strong>  ,        JQuery.   GitLab  SPA.  server-side rendering  progressive enhancement,        Vue-.  ,    :     Vue-,    .</li>
<li><strong>Karma  Jest. </strong>Jest  -     . Karma     , , .</li>
<li><strong>REST  GraphQL</strong> ,   , <strong>Vuex  Apollo</strong>.      Vuex,    Redux   Vue,  Apollo local state  ,     .    GraphQL    ,      .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En m√™me temps, les remplacements ont lieu dans plusieurs directions √† la fois, dans le projet il y a simultan√©ment un code h√©rit√© √† diff√©rentes √©tapes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez maintenant que vous arrivez √† un projet au milieu de toutes ces migrations. Le point standard et de r√©f√©rence pour moi √©tait la situation lorsque vous ouvrez l'√©dition d'un projet, appuyez sur le bouton Enregistrer - et que pensez-vous qui s'en vient? Si vous pensiez que nous sommes de tels vieux phages que HTML vient, alors non. JavaScript vient du fait que vous devez ¬´√©voluer¬ª pour afficher une fen√™tre pop-up. C'est le point bas de ma photo h√©rit√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus loin: des classes auto-√©crites dans JQuery, des composants Vue et, comme point culminant, de nouvelles fonctionnalit√©s modernes √©crites avec Vuex, Apollo, Jest, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici √† quoi ressemble mon graphique de contribution sur GitLab.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ew/ml/io/ewmliousc_qzjvrr0pfshtqlrj0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce document - et cela est tr√®s important pour comprendre l'essence de l'histoire et toutes mes douleurs - plusieurs segments peuvent √™tre distingu√©s:</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int√©gration</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la zone avril. </font><font style="vertical-align: inherit;">¬´Lune de miel¬ª quand je viens de commencer √† travailler chez GitLab. </font><font style="vertical-align: inherit;">√Ä ce moment, les d√©butants se voient confier des t√¢ches plus faciles.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De la fin avril √† la mi-mai, il n'y a que quelques commits - une p√©riode de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©ni</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ¬´Non, il ne peut pas que tout se fasse de cette fa√ßon!¬ª </font><font style="vertical-align: inherit;">J'ai essay√© de comprendre o√π je ne comprenais pas quelque chose, donc il y a si peu de commits.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxi√®me moiti√© de mai est la </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">col√®re</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : "Je m'en fous de tout - j'ai besoin de d√©placer la production, de partager des fonctionnalit√©s, d'essayer de faire quelque chose."</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le d√©but de juin (z√©ro engagement) est une </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©pression</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ce n'√©tait pas des vacances, j'ai regard√© et compris que mes mains tombaient, je ne sais pas quoi en faire.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apr√®s cela, je suis d' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accord avec moi</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><strong><font style="vertical-align: inherit;">m√™me</font></strong><font style="vertical-align: inherit;"> , j'ai d√©cid√© d'√™tre embauch√© en tant que professionnel et je peux am√©liorer GitLab. </font><font style="vertical-align: inherit;">En juin et juillet, j'ai propos√© un grand nombre d'am√©liorations. </font><font style="vertical-align: inherit;">Tous n'ont pas r√©sonn√© pour des raisons dont nous parlerons.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, je suis au stade de l' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adoption</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><font style="vertical-align: inherit;">je </font><font style="vertical-align: inherit;">comprends clairement: comment, o√π, pourquoi et quoi faire avec tout cela.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais vous dire plus en d√©tail ce que j'ai fait d'ao√ªt √† octobre. </font><font style="vertical-align: inherit;">Honn√™tement, dans une petite entreprise d'externalisation ou dans une startup, j'aurais √©t√© licenci√© cinq fois avec une telle productivit√© en trois mois. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, en trois mois, j'ai fait:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contr√¥le segment√© - trois boutons.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La cha√Æne de recherche qui stocke l'historique local est un composant l√©g√®rement plus complexe.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fileur. </font><font style="vertical-align: inherit;">Et ce composant n'est pas encore fig√©.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/p6/fw/uw/p6fwuwfxi5dxzpyuewu9vn7_zc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, √©tape par √©tape, nous analyserons pourquoi cela s'est produit et comment vivre avec. S'il vous semble que j'exag√®re, voici une capture d'√©cran de certaines des t√¢ches qui m'accrochent sur GitLab (vous pouvez regarder directement GitLab, il est ouvert). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/em/ax/o9/emaxo9j3iwkxpdefee2ghsokjpi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voir: manqu√© 12,1, manqu√© 12,2, manqu√© 12,3. Le sprint dure un mois et le contr√¥le segment√© - 3 sprints. Spinner est toujours parti, il sera notre personnage principal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le probl√®me du refactoring et la philosophie du refactoring sont confront√©s √† l'humanit√© depuis tr√®s longtemps - depuis des mill√©naires. Je vais maintenant prouver:</font></font><br>
<blockquote><em>¬´        ;      ,   ,   ;        ;    ,  .<br>
<br>
 ,   ,    ,  :  ¬ª.<br>
<br>
 </em></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La Bible nous explique comment combiner des fonctionnalit√©s anciennes et nouvelles. </font><font style="vertical-align: inherit;">La deuxi√®me partie de la citation est pr√©cieuse du point de vue du management: peu importe comment vous sortez avec les initiatives, vous rencontrerez une grande r√©sistance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la phase de d√©pression, j'ai regard√© beaucoup de rapports sur la refactorisation de grands projets, mais environ 70% d'entre eux me rappelaient une blague. </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discussion Javist: </font></font></em><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Comment acc√©l√©rer notre application Java? </font></font></em><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Oh, j'ai donc eu un rapport √† ce sujet! </font><font style="vertical-align: inherit;">Tu veux dire? </font></font></em><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Pour dire et je peux, j'acc√©l√©rerais! </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous d√©cidez toujours de vous lancer dans la voie dangereuse et fragile du refactoring, j'ai quelques recettes simples que j'ai d√©velopp√©es pour moi et qui fonctionnent dans des conditions proches de la r√©alit√©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Isolation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour acc√©l√©rer les choses, am√©liorer, refactoriser, vous devez couper l'√©l√©phant en steaks, c'est-√†-dire diviser la t√¢che en plusieurs parties. GitLab est tr√®s grand, nous avons une cha√Æne Slack "Est-ce connu", o√π les gens posent des questions comme "Est-ce un bug ou une fonctionnalit√©, qui peut expliquer?" - et la r√©ponse n'est pas toujours trouv√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple simple: des captures d'√©cran du m√™me endroit dans GitLab, prises avec une diff√©rence d'un jour. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_i/e7/t3/_ie7t3qfxsof8p9kwrdzy2wsymi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'√©tais tr√®s contrari√©, parce que je travaillais sur ce bouton, et c'est tout ou partie des probl√®mes avec le bouton. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-il arriv√©? C'est simple: nous d√©veloppons un syst√®me de conception, et dans le cadre d'un outil de livre d'histoire distinct pour tester un syst√®me de conception, nous avons d√©sactiv√© le CSS GitLab global pour v√©rifier comment les composants CSS sont isol√©s du CSS global. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©sum√©: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS n'est plus sauvegard√©</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au moins dans GitLab. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je travaille avec JavaScript depuis 14 ans et je n'ai jamais vu de projet dont la dur√©e d'au moins un an ou deux pr√©serve le CSS enti√®rement g√©r√©. Soit dit en passant, le </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne </font><strong><font style="vertical-align: inherit;">peut</font></strong><font style="vertical-align: inherit;"> pas non plus √™tre enregistr√© (dans GitLab √† coup s√ªr). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitLab a √©t√© d√©velopp√© depuis longtemps et backendov. Ils ont pris la d√©cision controvers√©e d'utiliser Bootstrap car Bootstrap offrait un syst√®me de mise en page convivial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais qu'est-ce que Bootstrap en termes de philosophie d'isolation des composants? Il s'agit d'environ 600 √† 700 classes globales (en fait, chaque classe CSS est globale) qui impr√®gnent toute l'application. En termes de g√©rabilit√©, rien de bon n'en sortira.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prochaine action (ne l'appelons pas une erreur) - GitLab a pris Vue.js. Le choix √©tait raisonnable, en raison des trois cadres, c'est Vue qui vous permet de r√©√©crire le plus facilement possible. Vous n'avez pas besoin de jeter et de couper imm√©diatement une grande application monopage, mais vous pouvez r√©√©crire des petits n≈ìuds individuels. Maintenant, cela peut √™tre fait sur Angular, mais il y a 3-4 ans, quand Angular 2 est apparu, il ne pouvait pas coexister sur une page dans plus d'une instance. React est √©galement possible maintenant, mais toute cette magie avec l'absence d'une √©tape de construction et ainsi de suite a fait pencher la balance vers Vue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, un mal a √©t√© combin√© avec le second. C'est mauvais, car les styles Bootstrap ne savent rien du syst√®me de composants, et les composants Vue ont √©t√© √©crits au d√©but, de toute fa√ßon. Par cons√©quent, une d√©cision volontariste a √©t√© prise de cr√©er leur propre syst√®me de conception. Nous l'avons appel√©</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pyjama</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais personne ne pouvait m'expliquer pourquoi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vois que maintenant il y a de plus en plus de nos propres syst√®mes de conception, et c'est bien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le syst√®me de conception implique l'isolement, mais puisque GitLab a d√©j√† √©t√© √©crit en Bootstrap, environ 50 √† 60% de notre syst√®me de conception est un wrapper sur les composants Bootstrap / Vue avec une diminution de leur fonctionnalit√©. Cela est n√©cessaire pour que le syst√®me de conception ne vous permette pas d'utiliser le composant de mani√®re incorrecte. Si nous parlons d'une biblioth√®que abstraite, la flexibilit√© y est importante, par exemple, la possibilit√© de cr√©er n'importe quel bouton de votre choix. Si, dans GitLab, les filateurs peuvent avoir quatre tailles approuv√©es par les concepteurs, vous devez physiquement ne pas laisser les autres le faire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un jour, le bien gagnera, et nous aurons un outil important avec lequel, bien s√ªr, si vous avez marqu√© sur le support d'IE et Edge, vous pouvez efficacement refactoriser les projets frontaux - c'est </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shadow DOM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le Shadow DOM r√©sout le probl√®me des styles globaux coulant dans les composants. Veuillez ne pas prendre Polymer, que m√™me Google a d√©j√† enterr√©. Utilisez lit-element et lit-HTML, et vous pouvez cr√©er des styles isol√©s en utilisant votre framework pr√©f√©r√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez dire que React a des modules CSS, Vue a des styles √©tendus qui font de m√™me. Soyez tr√®s prudent avec eux: les modules CSS ne fournissent pas une isolation √† 100% car ils ne fonctionnent qu'avec des classes. Et avec les styles √©tendus dans Vue, un sc√©nario tr√®s int√©ressant peut √™tre r√©alis√© lorsque les styles du composant sup√©rieur tombent dans l'√©l√©ment racine du parent et que des attributs de donn√©es sont utilis√©s qui ralentissent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgr√© le fait que j'ai grond√© Angular pendant trois ans, maintenant je dois admettre qu'au moment o√π il est le mieux impl√©ment√©. Dans Angular, afin d'assurer une bonne isolation de style, il suffit de changer simplement le mode d'isolement et, si n√©cessaire, d'utiliser le Shadow DOM, sinon une √©mulation normale.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Revenons au spinner. </font><font style="vertical-align: inherit;">Des trois mois que j'ai combattus avec lui, j'ai √©t√© engag√© pendant un certain temps dans une entreprise passionnante: le nettoyage. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s8/zv/u0/s8zvu0h5yauznhgfqthij_96rkc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une classe </font></font><code>loading-container</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est un d√©tail d'impl√©mentation d'un spinner, c'est-√†-dire qu'il s'agit d'une classe √† l'int√©rieur d'une impl√©mentation spinner. </font><font style="vertical-align: inherit;">Nous avons d√©cid√©, puisque le CSS ne devait pas √™tre enregistr√©, en pyjama de cr√©er un CSS s√©par√© bas√© sur le CSS atomique. </font><font style="vertical-align: inherit;">Personnellement, je n'aime pas vraiment le concept CSS atomique, mais nous avons ce que nous avons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, je me suis engag√© √† nettoyer les styles dans le code du produit principal qui √©taient accroch√©s √† des √©l√©ments qui sont des d√©tails d'impl√©mentation. </font><font style="vertical-align: inherit;">Tout cela semble tr√®s simple - car, bien s√ªr, il existe des tests dans GitLab.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Tests</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les tests dans GitLab couvrent tout le code</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , assurent la fiabilit√©. </font><font style="vertical-align: inherit;">Et donc le pipeline est termin√© en 98 minutes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fl/uz/bb/fluzbboaa7on25ueq9z6pkvcdb4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitLab collecte 40% du temps des coureurs publics sur GitLab.com car GitLab collecte des pipelines pour chaque demande de fusion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'√©tais tr√®s inspir√©: j'ai finalement pu r√©aliser un projet o√π tout est couvert par des tests! </font><font style="vertical-align: inherit;">La couverture du code backend est proche de 100%, et le code frontal au moment de mon arriv√©e √©tait couvert par </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">89,3%. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, il s'est av√©r√© que la plupart de cette couverture est une corbeille parce que:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tombe en panne lorsque des modifications ne sont pas li√©es aux composants;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne se casse pas lorsque des modifications sont apport√©es.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais expliquer avec des exemples. </font><font style="vertical-align: inherit;">Nous avons pris Jest parce que nous pensions qu'il nous permettrait dans certaines situations de ne pas √©crire d'assertions, mais d'utiliser des instantan√©s. </font><font style="vertical-align: inherit;">Le probl√®me est que si vous n'avez pas configur√© Jest et ajout√© le s√©rialiseur correct, Vue Test Utils affiche simplement les accessoires en HTML. </font><font style="vertical-align: inherit;">Ensuite, par exemple, il s'av√®re que les accessoires avec l'utilisateur de nom, qui avait des accessoires dans les param√®tres avec les donn√©es de nom, auxquels l'objet objet a √©t√© transmis. </font><font style="vertical-align: inherit;">Toute modification du format des donn√©es transmises n'entra√Æne pas l'√©chec de l'instantan√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les d√©veloppeurs Ruby ont l'habitude de faire des tests, grosso modo, couvrant toutes les m√©thodes.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque nous effectuons des tests pour les composants Vue ou React, nous devons tester le comportement de l'API publique.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, nous avons eu d'√©normes tests sur des propri√©t√©s calcul√©es qui n'√©taient pas utilis√©es dans certains sc√©narios, mais dans d'autres, il √©tait physiquement impossible d'atteindre l'√©tat o√π ce calcul serait appel√©. </font><font style="vertical-align: inherit;">Un merci sp√©cial √† Vue, dans lequel les mod√®les sont des cha√Ænes, vous ne pouvez donc pas calculer la couverture de test du mod√®le. </font><font style="vertical-align: inherit;">Dans Vue 3, les cartes sources appara√Ætront et la possibilit√© de le r√©parer, mais ce ne sera pas pour bient√¥t. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heureusement, il existe une comp√©tence simple qui vous permettra de remanier efficacement l'h√©ritage. </font><font style="vertical-align: inherit;">C'est la capacit√© d'√©crire ce qu'on appelle le test d'√©pinglage dans le monde des gros tests.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test d'√©pinglage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un test qui tente de capturer le comportement que vous refactorisez. Veuillez noter que le test d'√©pinglage ne finira probablement pas par √™tre valid√© dans le r√©f√©rentiel. Autrement dit, vous, √† travers toutes sortes de raffinements, par exemple, en utilisant l'environnement de transfert, √©crivez vous-m√™me un test qui d√©crit comment votre composant est rendu. Apr√®s refactorisation, le test d'√©pinglage doit soit g√©n√©rer le m√™me HTML, ce qui est tr√®s probablement un bon signe, soit comprendre les changements qui se sont produits.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais donner un exemple tir√© de la vie. Il y a quelques mois, j'ai effectu√© un examen de la demande de fusion avec la refactorisation d'une liste d√©roulante. Le contexte h√©rit√© est le suivant: auparavant, afin de s√©parer les branches d'un ami les unes des autres par un tiret dans la liste d√©roulante, la cha√Æne de texte ¬´diviseur¬ª √©tait simplement pass√©e. Par cons√©quent, si votre branche s'appelait diviseur, vous n'avez pas de chance. Dans le processus de refactoring, une personne a √©chang√© deux classes dans un n≈ìud HTML, cela est entr√© en production et l'a ruin√©. En toute justice, bien s√ªr, pas tout √† fait en production, mais en mise en sc√®ne, mais n√©anmoins.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, lorsque nous avons commenc√© √† √©crire de tels tests, nous avons constat√© que, malgr√© l'indicateur de couverture de test sympa, les tests √©taient mal √©crits. Parce que, premi√®rement, nous avons eu des tests pour Karma, c'est-√†-dire d'anciens. Deuxi√®mement, presque tous les tests ont √©mis des hypoth√®ses sur les composants internes du composant. Autrement dit, ils pr√©tendaient √™tre des tests unitaires et fonctionnaient essentiellement comme de bout en bout, v√©rifiant qu'une balise sp√©cifique avec une classe sp√©cifique √©tait en cours de rendu, au lieu de v√©rifier qu'un composant sp√©cifique √©tait rendu avec des accessoires sp√©cifiques. Comprenez la diff√©rence: les classes sont des composants? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, mes 18 demandes de fusion avec des tests de refactoring pour un total de 8 √† 9 000 lignes, le changelog total s'est av√©r√© √™tre d'environ 20 000, car 11 000 ont √©t√© supprim√©s.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ay/q_/qs/ayq_qsjbluc3lyjaiwft9oxkefo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le m√™me temps, formellement, j'ai retravaill√© tous ces tests pour une seule chose: supprimer les assertions concernant les classes de spinner et v√©rifier √† la place que le spinner avec les accessoires corrects y est rendu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä premi√®re vue, c'est un travail ingrat. </font><font style="vertical-align: inherit;">Mais r√©√©crire les tests pour la bonne architecture √©tait assez facile √† vendre √† l'entreprise. </font><font style="vertical-align: inherit;">GitLab est un produit commercialement rentable. </font><font style="vertical-align: inherit;">Bien s√ªr, si vous dites au chef de produit que vous avez besoin de trois it√©rations pour r√©√©crire 20 tests, devinez o√π vous serez envoy√©. </font><font style="vertical-align: inherit;">Autre chose: ¬´J'ai besoin de trois it√©rations pour r√©√©crire le test. </font><font style="vertical-align: inherit;">Cela nous permettra de pr√©senter les filateurs plus efficacement et d'acc√©l√©rer la future mise en ≈ìuvre de nouveaux √©l√©ments du syst√®me de conception. ¬ª </font><font style="vertical-align: inherit;">Et nous arrivons ici √† l'important.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. R√©sistance</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a une autre fonctionnalit√© que plus de mes filateurs attendent dans le syst√®me de conception GitLab - ce sont des ic√¥nes SVG ordinaires.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yu/to/cc/yutoccm3twkiswgiyqe2flvse_w.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons des ic√¥nes dessin√©es par le designer qui sont utilis√©es dans le projet principal, mais elles ne sont pas dans le syst√®me de conception, car GitLab a une enfance difficile. </font><font style="vertical-align: inherit;">Par exemple, en 2019, le CSS n'est pas collect√© via Webpack, mais par un morceau appel√© Sprockets - c'est le pipeline Ruby, car nous devons r√©utiliser le m√™me CSS sur le backend et le frontend. </font><font style="vertical-align: inherit;">Pour cette raison, les ic√¥nes doivent √™tre connect√©es √† diff√©rents projets de diff√©rentes mani√®res. </font><font style="vertical-align: inherit;">Par cons√©quent, quelqu'un a refactoris√© la base de code principale pendant trois mois afin que vous puissiez connecter les ic√¥nes du syst√®me de conception aux projets associ√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a ici un point important que vous rencontrerez in√©vitablement. </font><font style="vertical-align: inherit;">Le refactoring est un processus d'am√©lioration continue. </font><font style="vertical-align: inherit;">Mais t√¥t ou tard, vous devez vous arr√™ter.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est tout √† fait normal de s'arr√™ter sans terminer la refactorisation, mais obtenir des am√©liorations concr√®tes et mesurables.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais si vous travaillez sur un projet h√©rit√©, vous rencontrerez in√©vitablement des gens qui le font. </font></font><br>
<img src="https://habrastorage.org/webt/to/bx/ix/tobxixkebgoqq2lvl-2fijjeqme.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela signifie qu'ils √©crivent √† l'ancienne, car ils y sont tellement habitu√©s. Par exemple, nos bailleurs de fonds disent: "Je ne veux pas enseigner ceci √† votre plaisanterie. J'ai √©crit des tests pour Karma pendant trois ans, j'ai besoin d'ajouter de nouvelles fonctionnalit√©s, et comme ils ne prendront pas de fonctionnalit√©s sans tests, voici un test pour Karma. " </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Votre t√¢che consiste √† y r√©sister autant que possible. C'est relativement facile √† combattre, mais il y a un p√©ch√© encore plus grand que cela. Parfois, dans le processus de refactorisation, vous rencontrez un probl√®me et vous souhaitez g√©n√©ralement vous √©carter.</font></font><br>
<img src="https://habrastorage.org/webt/pz/va/st/pzvast70b3gpomnqsaic1iignns.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, pour remplacer une nouvelle b√©quille simplement parce que pour certaines raisons, il n'est pas possible de mettre fin au refactoring. </font><font style="vertical-align: inherit;">Par exemple, si nous avons des probl√®mes pour int√©grer des ic√¥nes dans la base de code principale, nous pouvons laisser une classe utilitaire qui sera extraite du CSS d'application global. </font><font style="vertical-align: inherit;">Formellement, la t√¢che commerciale sera r√©solue, mais dans la pratique, comme dans l'histoire de l'hydre lern√©enne: il y avait 8 bugs, 4 corrig√©s, 13 restaient. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La refactorisation, comme la r√©paration d'une maison - il est impossible de terminer, vous ne pouvez que l'arr√™ter.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les premiers 80% du refactoring prennent 20% du temps, les 80% restants du refactoring (juste comme √ßa) prennent encore 80% du temps.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est important de ne pas introduire de nouveaux hacks lors du processus de refactoring. </font><font style="vertical-align: inherit;">Croyez-moi, au cours du processus de d√©veloppement, ils appara√Ætront eux-m√™mes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Outils</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heureusement, avant m√™me mon arriv√©e, GitLab s'est engag√© sur la bonne voie pour introduire de bons outils: Prettier, Vue Test Utils, Jest. Bien que Prettier l'ait impl√©ment√© de fa√ßon tordue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais vous expliquer ce qui est en jeu. Alors que j'ai compris quoi et pourquoi, historiquement, 80% de mes recherches sont tomb√©es sur un commit de 37 000 lignes de code prettify. Il √©tait presque impossible d'utiliser l'historique, et j'ai d√ª configurer le plug-in pour VS Code afin d'exclure ce commit lors de la recherche de l'historique des modifications.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, les outils sont importants, mais vous devez les choisir avec soin. Par exemple, nous avons Vue, et Vue a un bon outil de test - Vue Test Utils. Mais si Vue 2 est sorti il ‚Äã‚Äãy a 2-3 ans, Vue Test Utils n'est toujours pas sorti de la version b√™ta. De plus, selon des informations privil√©gi√©es, √† l'heure actuelle, le seul d√©veloppeur de Vue Test Utils n'√©crit pas sur Vue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le processus de choix des outils, vous jouez au sort et tentez vraiment de gagner. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitLab a eu une blessure d'enfance avec CoffeeScript. C'est pourquoi il est impossible de pousser m√™me l'id√©e th√©orique d'√©crire en TypeScript dans GitLab. Tout se d√©compose en un argument simple: ne sera-t-il pas le m√™me qu'avec CoffeeScript lorsque le langage qui se compile en JavaScript est mort.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors du choix des outils, essayez de remplacer l'outil ou, dans les cas extr√™mes, de le maintenir ind√©pendamment.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chez GitLab, nous utilisons une chose cool appel√©e Danger. </font></font><br>
<img src="https://habrastorage.org/webt/lv/ol/oh/lvolohfoqnrzwiqzur-ziqhaaxw.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une v√©ritable capture d'√©cran de leur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en 2019. </font><font style="vertical-align: inherit;">Mais, des coll√®gues ont d√©clar√© qu'en fait, en 2019, le site pourrait ressembler √† n'importe quoi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le danger est un bot qui occupe un √©tat interm√©diaire entre le linter de votre CI et les directives √©crites. </font><font style="vertical-align: inherit;">Ce bot peut √™tre d√©velopp√© et il viendra pour tirer la demande ou, comme ils sont correctement appel√©s avec nous, fusionner la demande et laisser des commentaires comme:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Il y a un commentaire de d√©sactivation ESlint dans ce fichier, corrigez-le."</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´Ce fichier √©tait auparavant dirig√© par cette personne. </font><font style="vertical-align: inherit;">Vous devrez peut-√™tre y mettre un avis. ¬ª</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä mon avis, c'est un tr√®s bon cadre, important et extensible pour surveiller l'√©tat de la base de code.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Abstraction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais commencer par un exemple. </font><font style="vertical-align: inherit;">Il y a quelques mois, j'ai vu la nouvelle: ¬´GitHub s'est d√©barrass√© de jQuery. </font><font style="vertical-align: inherit;">Nous avons parcouru un long chemin et n'utilisons plus jQuery. ¬ª </font><font style="vertical-align: inherit;">Naturellement, je pensais que nous devions √©galement nous d√©barrasser de jQuery dans GitLab. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e3/3d/4z/e33d4zkjkbo05u2iz2ehkjp9oh8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une recherche rapide a montr√© que jQuery est utilis√© dans 300 fichiers. </font><font style="vertical-align: inherit;">Cela semble effrayant, mais rien - les yeux ont peur, les mains font. </font><font style="vertical-align: inherit;">Mais non! </font><font style="vertical-align: inherit;">jQuery est une colle int√©grale dans la base de code GitLab, car nous avons Bootstrap. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bootstrap a √©t√© initialement √©crit dans jQuery. </font><font style="vertical-align: inherit;">Cela signifie que si vous devez, par exemple, intercepter l'√©v√©nement d'ouverture d√©roulante dans Bootstrap, il s'agit d'un √©v√©nement jQuery. </font><font style="vertical-align: inherit;">Vous ne pouvez pas l'intercepter nativement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est la premi√®re chose que vous devez abstraire lorsque vous travaillez avec du code h√©rit√©. </font><font style="vertical-align: inherit;">Si vous avez jQuery que vous ne pouvez pas jeter, √©crivez votre propre √©metteur d'√©v√©nements, qui se cachera √† l'int√©rieur du travail avec les √©v√©nements jQuery. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'un avenir radieux arrive, nous pouvons supprimer jQuery, mais pour l'instant, d√©sol√©, vous devez concentrer le govnokod. </font><font style="vertical-align: inherit;">Dans un projet h√©rit√© r√©gulier, il est r√©parti uniform√©ment dans tout le code. </font><font style="vertical-align: inherit;">R√©cup√©rez-le dans des goulots d'√©tranglement marqu√©s des drapeaux ¬´N'entrez pas sans combinaison de protection chimique¬ª.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Mesures</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous ne pouvez pas faire quelque chose dont le r√©sultat ne peut pas √™tre mesur√©. Chez GitLab, nous mesurons tout ce que nous faisons pour savoir objectivement que le code fonctionne mieux. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/me/0g/qb/me0gqbigji1jssyvv6be_ve_bjq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, nous avons un calendrier de migration des tests Karma (bleu) vers Jest (vert): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vous voyez qu'il y a des progr√®s graduels. Et nous avons beaucoup de tels horaires. Mais il est important de comprendre que tout ne se termine pas toujours bien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais vous donner un autre exemple (la d√©mo dans le rapport commence √† partir de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> moment). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6s/az/t7/6sazt7jddhpg2kshoo0sodo-hbu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici l'interface habituelle de demande de fusion dans la production GitLab. √âvidemment, nous pouvons r√©duire les fichiers, cliquer sur l'en-t√™te et le fichier commencera √† se r√©duire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que pensez-vous, combien de temps faut-il pour r√©duire un fichier de 50 lignes, alors que la machine avec la huiti√®me g√©n√©ration de Core i7 est tordue pour des performances maximales? </font><font style="vertical-align: inherit;">Combien de temps dure le d√©ploiement? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le temps n√©cessaire √† l'effondrement du fichier varie de 7 √† 15 secondes. </font><font style="vertical-align: inherit;">Le d√©ploiement se produit instantan√©ment. </font><font style="vertical-align: inherit;">Avant la refactorisation, les deux fonctionnaient aussi rapidement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est pourquoi il est tr√®s important d'avoir des m√©triques.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais vous dire ce qui se passe ici. </font><font style="vertical-align: inherit;">Voici Vue, son syst√®me de r√©activit√© garde une trace de la valeur: s'il change, toutes les d√©pendances qui d√©pendent de cette valeur sont appel√©es. </font><font style="vertical-align: inherit;">Chaque ligne est un composant Vue compos√© de plusieurs choses, car vous pouvez mettre des commentaires sur une ligne, les commentaires peuvent √™tre charg√©s dynamiquement depuis le serveur, etc. </font><font style="vertical-align: inherit;">Tout cela est souscrit au magasin Vue, qui est √©galement un composant Vue.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous fermez la demande de fusion, tous, disons, 20 000 abonnements de magasin doivent √™tre mis √† jour lorsque le magasin est mis √† jour. Si la ligne est supprim√©e, elle doit √™tre supprim√©e des d√©pendances. Et puis des calculs simples: vous devez regarder un tableau de 20 000 √©l√©ments pour trouver ceux qui doivent √™tre supprim√©s. Disons qu'il y a 500 lignes de ce type, et chaque ligne est constitu√©e de plusieurs composants. Le r√©sultat est une op√©ration math√©matique O (N), c'est-√†-dire O (20 000) * 500. JavaScript fonctionne depuis tout ce temps. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le d√©ploiement se produit instantan√©ment, car l'ajout d'une d√©pendance n'est qu'une pouss√©e vers le tableau, c'est-√†-dire op√©ration math√©matique O (1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, l'am√©lioration de la qualit√© du code d√©grade les performances et d'autres mesures. Il est tr√®s important de les mesurer. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En r√©sum√©: isolez le mauvais code et suivez les m√©triques.</font></font></strong><br>
<br>
<blockquote>  legacy ‚Äî  .   ,      ‚Äì     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TechLead Conf</a> ‚Äî ,    .   ‚Äì    ,  legacy        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> Python</a>,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> PHP</a>.<br>
<br>
            ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">++</a>,        ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FrontendConf</a>.          .</blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr492980/index.html">9 outils informatiques pour augmenter le capital humain dans une entreprise</a></li>
<li><a href="../fr492990/index.html">Organisation de la formation des √©tudiants en ligne</a></li>
<li><a href="../fr492994/index.html">Nouveaut√©s de TestMace, partie 1. Synchronisation dans le cloud, interface mise √† jour, etc.</a></li>
<li><a href="../fr492996/index.html">Marshaling et d√©-marshalling des formats de date personnalis√©s dans Go</a></li>
<li><a href="../fr492998/index.html">Comment nous nous sommes tromp√©s sur la pige pour un centre de donn√©es et ce qui en est arriv√©</a></li>
<li><a href="../fr493002/index.html">350 personnes √† distance: comment c'√©tait</a></li>
<li><a href="../fr493008/index.html">√Ä propos du cluster de serveurs 1C</a></li>
<li><a href="../fr493010/index.html">Comment Quarkus combine la programmation imp√©rative et r√©active</a></li>
<li><a href="../fr493012/index.html">Air, relais, c√¢ble par la fen√™tre: comment ne pas tomber sur un fournisseur monopoliste dans un centre d'affaires</a></li>
<li><a href="../fr493014/index.html">Entretien avec Vyacheslav Utochkin, directeur des programmes de d√©veloppement √©ducatif √† la Higher School of Economics, Higher School of Economics, Higher School of Economics; 20 questions sur Gamedev</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>