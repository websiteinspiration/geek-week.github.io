<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😗 👨‍👧‍👦 🧜 ジュリアでの分散コンピューティング 🌔 😠 👋🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前の記事がシードされる可能性が高い場合は、今度は彼女のマシン上で並列化するJuliaの能力をテストする時です。
 マルチコアまたは分散処理
 

分散メモリを使用した並列計算の実装は、モジュールによって提供されます Distributed , Julia. , . . : . , (). , - ....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ジュリアでの分散コンピューティング</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455846/"><p><img src="https://habrastorage.org/webt/ud/o6/5u/udo65u8kthnpek7hzrcedxgzwtk.jpeg"></p><br>
<p><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前の記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がシードされる可能性が高い</font><font style="vertical-align: inherit;">場合は</font><font style="vertical-align: inherit;">、今度は彼女のマシン上で並列化するJuliaの能力をテストする時です。</font></font></p><a name="habracut"></a><br>
<h2 id="mnogoyadernaya-ili-raspredelennaya-obrabotka"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチコアまたは分散処理</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分散メモリを使用した並列計算の実装は、モジュールによって提供されます </font></font><code>Distributed</code>    ,   Julia.       ,        .          .      :         .    ,               ().    ,         -       . ,       «»    . Julia   ,    ,           .</p><br>
<p>    Julia    ,   <abbr title="この文脈では、MPIはMPI-1標準を指します。 MPI-2以降、MPI標準委員会は、リモートメモリアクセス（RMA）と総称される新しい通信メカニズムのセットを導入しました。">MPI</abbr> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">[1]</a>.   Julia  "",  ,           .  ,       « »  « »,       ,     . </p><br>
<p>   Julia    : <em> </em>  <em> </em>.   —  ,          ,    .   —             (,  ) .</p><br>
<p>    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Future</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">RemoteChannel</a>. </p><br>
<p>   <code>Future</code>    ; ,   ,     ,        - .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">wait</a>   <code>Future</code>,       ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">fetch</a>. </p><br>
<p>  ,    RemoteChannel',  . ,      ,        .      . ,    Julia,   ,  1. ,      ,  «».     ,  1  .       ,    1.</p><br>
<p><img src="https://habrastorage.org/webt/vy/ts/gd/vytsgdo3oi1x52r901ibv8s4z1a.jpeg"></p><br>
<p> .    <code>julia -p n</code>  n     .   ,  n     ( )  .  ,   -p    Distributed.</p><br>
<div class="spoiler"><b class="spoiler_title">    ?</b><div class="spoiler_text"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linuxユーザーの場合、コンソールを使用した操作は簡単です。</font><font style="vertical-align: inherit;">この教育プログラムは、Windowsの経験の浅いユーザーを対象としています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナルジュリア（REPL）は、システムコマンドを使用する機能を提供します。</font></font></p><br>
<pre><code class="plaintext hljs">julia&gt; pwd() #    <font></font>
"C:\\Users\\User\\AppData\\Local\\Julia-1.1.0"<font></font>
<font></font>
julia&gt; cd("C:/Users/User/Desktop") #  <font></font>
<font></font>
julia&gt; run(`calc`) #    <font></font>
#     Windows.<font></font>
#     <font></font>
Process(`calc`, ProcessExited(0))</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらのコマンドを使用して、ジュリアからジュリアを起動できますが、夢中にならない方が良い</font></font></p><br>
<p><img src="https://habrastorage.org/webt/tb/yv/4m/tbyv4me6o0jhsk-5ap3xgdqivsq.png"></p><br>
<p>    <strong>cmd</strong>  <em>julia/bin/</em>     <code>julia -p 2</code>       :          <code>C:\Users\User\AppData\Local\Julia-1.1.0\bin\julia -p 4</code> (<em>     </em>)         <em>run.bat</em>. ,           Julia  4 .</p><br>
<p>    (   <em>Jupyter</em>):</p><br>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> Distributed<font></font>
addprocs(<span class="hljs-number">2</span>)</code></pre></div></div><br>
<pre><code class="julia hljs">$ ./julia -p <span class="hljs-number">2</span><font></font>
<font></font>
julia&gt; r = remotecall(rand, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>)
<span class="hljs-built_in">Future</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-literal">nothing</span>)<font></font>
<font></font>
julia&gt; s = <span class="hljs-meta">@spawnat</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> .+ fetch(r)
<span class="hljs-built_in">Future</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-literal">nothing</span>)<font></font>
<font></font>
julia&gt; fetch(s)<font></font>
<span class="hljs-number">2</span>×<span class="hljs-number">2</span> <span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Float64</span>,<span class="hljs-number">2</span>}:
 <span class="hljs-number">1.18526</span>  <span class="hljs-number">1.50912</span>
 <span class="hljs-number">1.16296</span>  <span class="hljs-number">1.60607</span>
</code></pre><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">remotecall</a> —   .<br>
    Julia         ,      ,    . </p><br>
<p>   <code>remotecall</code> —   ,    ,       .  ,       2    2  2,        1  .       , r  s.  spawnat      ,    .       .   ,      ,   ,     .     <code>remotecall_fetch</code>.   <code>fetch (remotecall (...))</code>,   .</p><br>
<p>,  <code>getindex(r, 1,1)</code>  <code>r[1,1]</code>,        <code>r</code>. </p><br>
<p>   <code>remotecall</code>   .  <code>@spawn</code>  .    ,    ,  ,     :</p><br>
<pre><code class="julia hljs">julia&gt; r = <span class="hljs-meta">@spawn</span> rand(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)
<span class="hljs-built_in">Future</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-literal">nothing</span>)<font></font>
<font></font>
julia&gt; s = <span class="hljs-meta">@spawn</span> <span class="hljs-number">1</span> .+ fetch(r)
<span class="hljs-built_in">Future</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-literal">nothing</span>)<font></font>
<font></font>
julia&gt; fetch(s)<font></font>
<span class="hljs-number">2</span>×<span class="hljs-number">2</span> <span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Float64</span>,<span class="hljs-number">2</span>}:
 <span class="hljs-number">1.38854</span>  <span class="hljs-number">1.9098</span>
 <span class="hljs-number">1.20939</span>  <span class="hljs-number">1.57158</span></code></pre><br>
<p> ,    <code>1 .+ Fetch(r)</code>  <code>1 .+ r</code>.  ,    ,    ,          <code>r</code>  ,  .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">@spawn</a>  ,     ,   <code>r</code>,  fetch   (   ). ( ,  spawn  ,      .      .)</p><br>
<p> ,    <code>Future</code>     .   fetch      .  ,     ,    . </p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">@async</a>   <code>@spawn</code>,       .       «»   .     ,    ,         ,      . </p><br>
<p> ,         ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">@sync</a>,           ,     . </p><br>
<p>  v0.7  ,        nextidx,           .     ,      , ,    / .  ,         :   ,   <code>remotecall_fetch</code>.    ,        Julia,      ,      N   M ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">M:N Threading</a>.     /    <code>nextidx</code>,          .</p><br>
<p>       ,   . ,     Julia :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-keyword">function</span> rand2(dims...)
           <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>*rand(dims...)
       <span class="hljs-keyword">end</span><font></font>
<font></font>
julia&gt; rand2(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)
<span class="hljs-number">2</span>×<span class="hljs-number">2</span> <span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Float64</span>,<span class="hljs-number">2</span>}:
 <span class="hljs-number">0.153756</span>  <span class="hljs-number">0.368514</span>
 <span class="hljs-number">1.15119</span>   <span class="hljs-number">0.918912</span><font></font>
<font></font>
julia&gt; fetch(<span class="hljs-meta">@spawn</span> rand2(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>))<font></font>
ERROR: <span class="hljs-built_in">RemoteException</span>(<span class="hljs-number">2</span>, <span class="hljs-built_in">CapturedException</span>(<span class="hljs-built_in">UndefVarError</span>(<span class="hljs-built_in">Symbol</span>(<span class="hljs-string">"#rand2"</span>))<font></font>
Stacktrace:<font></font>
[...]</code></pre><br>
<p> 1    rand2,   2 — .          ,         ,    .   <code>DummyModule.jl</code>,   :</p><br>
<pre><code class="julia hljs"><span class="hljs-keyword">module</span> DummyModule<font></font>
<font></font>
<span class="hljs-keyword">export</span> MyType, f<font></font>
<font></font>
<span class="hljs-keyword">mutable struct</span> MyType<font></font>
    a::<span class="hljs-built_in">Int</span>
<span class="hljs-keyword">end</span><font></font>
<font></font>
f(x) = x^<span class="hljs-number">2</span>+<span class="hljs-number">1</span><font></font>
<font></font>
println(<span class="hljs-string">"loaded"</span>)<font></font>
<font></font>
<span class="hljs-keyword">end</span></code></pre><br>
<p>   <code>MyType</code>   , <code>DummyModule.jl</code>      .  <code>include ('DummyModule.jl')</code>      .      ,   <code>@everywhere</code> ( Julia  julia -p 2):</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-meta">@everywhere</span> include(<span class="hljs-string">"DummyModule.jl"</span>)<font></font>
loaded<font></font>
      From worker <span class="hljs-number">3</span>:    loaded<font></font>
      From worker <span class="hljs-number">2</span>:    loaded</code></pre><br>
<p> ,    DummyModule    ,     .  ,  DummyModule      ,       :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-keyword">using</span> .DummyModule<font></font>
<font></font>
julia&gt; MyType(<span class="hljs-number">7</span>)<font></font>
MyType(<span class="hljs-number">7</span>)<font></font>
<font></font>
julia&gt; fetch(<span class="hljs-meta">@spawnat</span> <span class="hljs-number">2</span> MyType(<span class="hljs-number">7</span>))<font></font>
ERROR: On worker <span class="hljs-number">2</span>:
<span class="hljs-built_in">UndefVarError</span>: MyType not defined<font></font>
⋮<font></font>
<font></font>
julia&gt; fetch(<span class="hljs-meta">@spawnat</span> <span class="hljs-number">2</span> DummyModule.MyType(<span class="hljs-number">7</span>))<font></font>
MyType(<span class="hljs-number">7</span>)</code></pre><br>
<p>  ,   , ,  MyType ,   DummyModule,        :</p><br>
<pre><code class="julia hljs">julia&gt; put!(<span class="hljs-built_in">RemoteChannel</span>(<span class="hljs-number">2</span>), MyType(<span class="hljs-number">7</span>))
<span class="hljs-built_in">RemoteChannel</span>{<span class="hljs-built_in">Channel</span>{<span class="hljs-built_in">Any</span>}}(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>)</code></pre><br>
<p>             -L,        :</p><br>
<pre><code class="julia hljs">julia -p &lt;n&gt; -L file1.jl -L file2.jl driver.jl</code></pre><br>
<p> Julia,       ,  ,  1,   ,  ,   . ,  DummyModule.jl    ,  ,   DummyModule  DummyModule.jl   ,        ,     .</p><br>
<h2 id="zapusk-i-upravlenie-rabochimi-processami">    </h2><br>
<p>  Julia      : </p><br>
<ul>
<li> ,    -p,   . </li>
<li> ,   --machine-file.     ssh       Julia (   ,    )   . </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/dr/1b/7y/dr1b7y4ly3ashzsh19-7lwmvwni.jpeg"></p><br>
<p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">addprocs</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">rmprocs</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">worker</a>        ,      .</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-keyword">using</span> Distributed<font></font>
<font></font>
julia&gt; addprocs(<span class="hljs-number">2</span>)
<span class="hljs-number">2</span>-element <span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Int64</span>,<span class="hljs-number">1</span>}:
 <span class="hljs-number">2</span>
 <span class="hljs-number">3</span></code></pre><br>
<p> <code>Distributed</code>          <code>addprocs</code>.       .  ,       <code>~/.julia/config/startup.jl</code>          (   ,      )      .     ,    <code>ClusterManager</code>,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ClusterManager</a>.</p><br>
<h2 id="deystviya-s-dannymi">  </h2><br>
<p>            .               .      ,      . </p><br>
<p><code>fetch</code>       ,         . <code>@spawn</code> (   )   ,     ,        .            :</p><br>
<p> :</p><br>
<pre><code class="julia hljs">julia&gt; A = rand(<span class="hljs-number">1000</span>,<span class="hljs-number">1000</span>);<font></font>
<font></font>
julia&gt; Bref = <span class="hljs-meta">@spawn</span> A^<span class="hljs-number">2</span>;<font></font>
<font></font>
[...]<font></font>
<font></font>
julia&gt; fetch(Bref);</code></pre><br>
<p> :</p><br>
<pre><code class="julia hljs">julia&gt; Bref = <span class="hljs-meta">@spawn</span> rand(<span class="hljs-number">1000</span>,<span class="hljs-number">1000</span>)^<span class="hljs-number">2</span>;<font></font>
<font></font>
[...]<font></font>
<font></font>
julia&gt; fetch(Bref);</code></pre><br>
<p>  ,        -  <code>@spawn</code>.       ,      ,     .             .       ,  .            .   ,            , ,  . </p><br>
<p>,       ,      . ,   A        ,         . ,         <code>spawn</code>  <code>fetch(Bref)</code>,      .  ,  <code>rand(1000, 1000)</code>    .         <code>spawn</code>    .</p><br>
<h2 id="globalnye-peremennye"> </h2><br>
<p>,    spawn,  ,       <code>remotecall</code>,     .     <code>Main</code>   ,      .    :</p><br>
<pre><code class="julia hljs">A = rand(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)<font></font>
remotecall_fetch(()-&gt;sum(A), <span class="hljs-number">2</span>)</code></pre><br>
<p>   <code>sum</code>      .  ,  <code>A</code>   ,     .   2     <code>A</code>   <code>Main</code>.    <code>() -&gt; sum(A)</code>   2   ,  <code>Main.A</code>   2. <code>Main.A</code>     2     <code>remotecall_fetch</code>. </p><br>
<p><img src="https://habrastorage.org/webt/kp/iv/xi/kpivxixwcfwqqzi4gv1dyqkjhcw.png"></p><br>
<p>      (   )     : </p><br>
<ul>
<li>       ,         . </li>
<li>        . </li>
<li>Globals              ,    .  ,       . :</li>
</ul><br>
<pre><code class="julia hljs">A = rand(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)<font></font>
remotecall_fetch(()-&gt;sum(A), <span class="hljs-number">2</span>) <span class="hljs-comment"># worker 2</span>
A = rand(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)<font></font>
remotecall_fetch(()-&gt;sum(A), <span class="hljs-number">3</span>) <span class="hljs-comment"># worker 3</span>
A = <span class="hljs-literal">nothing</span></code></pre><br>
<p>      ,  <code>Main.A</code>   2  ,   <code>Main.A</code>   3,    <code>Main.A</code>   1  . </p><br>
<p> , , ,  ,    ,   ,      ,      ,    . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">clear!</a>          <code>nothing</code>,     .    ,   ,      .  ,            .   ,  ,    .       ,     <code>let</code>    . :</p><br>
<pre><code class="julia hljs">julia&gt; A = rand(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);<font></font>
<font></font>
julia&gt; remotecall_fetch(()-&gt;A, <span class="hljs-number">2</span>);<font></font>
<font></font>
julia&gt; B = rand(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>);<font></font>
<font></font>
julia&gt; <span class="hljs-keyword">let</span> B = B<font></font>
           remotecall_fetch(()-&gt;B, <span class="hljs-number">2</span>)
       <span class="hljs-keyword">end</span>;<font></font>
<font></font>
julia&gt; <span class="hljs-meta">@fetchfrom</span> <span class="hljs-number">2</span> InteractiveUtils.varinfo()<font></font>
name           size summary<font></font>
––––––––– ––––––––– ––––––––––––––––––––––<font></font>
A         <span class="hljs-number">800</span> bytes <span class="hljs-number">10</span>×<span class="hljs-number">10</span> <span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Float64</span>,<span class="hljs-number">2</span>}<font></font>
Base                <span class="hljs-built_in">Module</span>
Core                <span class="hljs-built_in">Module</span>
Main                <span class="hljs-built_in">Module</span></code></pre><br>
<p> ,    <code>A</code>    2,  <code>B</code>    , , ,   <code>B</code>     2.</p><br>
<h2 id="parallelnye-cikly"> </h2><br>
<p><img src="https://habrastorage.org/webt/zv/m5/q_/zvm5q_scthnveue7fxljwa0dshu.jpeg"></p><br>
<p> ,        .     -,         .    <code>@spawn</code>,      .      <code>count_heads.jl</code>:</p><br>
<pre><code class="julia hljs"><span class="hljs-keyword">function</span> count_heads(n)<font></font>
    c::<span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:n<font></font>
        c += rand(<span class="hljs-built_in">Bool</span>)
    <span class="hljs-keyword">end</span><font></font>
    c<font></font>
<span class="hljs-keyword">end</span></code></pre><br>
<p> count_heads   n  .             :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-meta">@everywhere</span> include_string(Main, $(read(<span class="hljs-string">"count_heads.jl"</span>, <span class="hljs-built_in">String</span>)), <span class="hljs-string">"count_heads.jl"</span>)<font></font>
<font></font>
julia&gt; a = <span class="hljs-meta">@spawn</span> count_heads(<span class="hljs-number">100000000</span>)
<span class="hljs-built_in">Future</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-literal">nothing</span>)<font></font>
<font></font>
julia&gt; b = <span class="hljs-meta">@spawn</span> count_heads(<span class="hljs-number">100000000</span>)
<span class="hljs-built_in">Future</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-literal">nothing</span>)<font></font>
<font></font>
julia&gt; fetch(a)+fetch(b)<font></font>
<span class="hljs-number">100001564</span></code></pre><br>
<p>         .       ,         .    ,      :      ,          ..       :  <code>x = f(x, v [i])</code>,  <code>x</code> — , <code>f</code> —  ,  <code>v[i]</code> —  . </p><br>
<p>,  <code>f</code>  ,    ,     .  ,       <code>count_heads</code>   .      <code>spawn</code>,     .            <code>for</code>,    ,     Julia   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">distributed</a>, :</p><br>
<pre><code class="julia hljs">nheads = <span class="hljs-meta">@distributed</span> (+) <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:<span class="hljs-number">200000000</span>
    <span class="hljs-built_in">Int</span>(rand(<span class="hljs-built_in">Bool</span>))
<span class="hljs-keyword">end</span></code></pre><br>
<p>               (   <code>(+)</code>).          .         . </p><br>
<p> ,     <code>for</code>    ,    .  ,      ,          ,      .  ,    ,      . ,       :</p><br>
<pre><code class="julia hljs">a = zeros(<span class="hljs-number">100000</span>)
<span class="hljs-meta">@distributed</span> <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:<span class="hljs-number">100000</span><font></font>
    a[i] = i<font></font>
<span class="hljs-keyword">end</span></code></pre><br>
<p>     ,          .    ,  .  ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Shared Arrays</a>,    ,    :</p><br>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> SharedArrays<font></font>
<font></font>
a = <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Float64</span>}(<span class="hljs-number">10</span>)
<span class="hljs-meta">@distributed</span> <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:<span class="hljs-number">10</span><font></font>
    a[i] = i<font></font>
<span class="hljs-keyword">end</span></code></pre><br>
<p> «»      ,      :</p><br>
<pre><code class="julia hljs">a = randn(<span class="hljs-number">1000</span>)
<span class="hljs-meta">@distributed</span> (+) <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:<span class="hljs-number">100000</span>
    f(a[rand(<span class="hljs-number">1</span>:<span class="hljs-keyword">end</span>)])
<span class="hljs-keyword">end</span></code></pre><br>
<p>    <code>f</code>      ,    .    ,    ,    .      ,               <code>Future</code> ,   .     Future    ,    <code>fetch</code>,      ,   <code>@sync</code>,  <code>@sync distributed for</code>. </p><br>
<p>      ,              (,    ,      ).     ,  <em> </em>,   Julia   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">pmap</a>. ,            :</p><br>
<pre><code class="julia hljs">julia&gt; M = <span class="hljs-built_in">Matrix</span>{<span class="hljs-built_in">Float64</span>}[rand(<span class="hljs-number">1000</span>,<span class="hljs-number">1000</span>) <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:<span class="hljs-number">10</span>];<font></font>
<font></font>
julia&gt; pmap(svdvals, M);</code></pre><br>
<p><code>pmap</code>    ,        . , <code>distributed for</code>   ,    , ,    .      <code>pmap</code>,   <code>distributed</code>   .   <code>distributed for</code>      .</p><br>
<h2 id="obschie-massivy-shared-arrays">  (Shared Arrays)</h2><br>
<p><img src="https://habrastorage.org/webt/gg/46/u5/gg46u5y_8bmejazw_ijxwzrbxie.jpeg"></p><br>
<p>Shared Arrays              .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">DArray</a>,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SharedArray</a>  .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">DArray</a>         ,            ; ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SharedArray</a>        . </p><br>
<p><code>SharedArray</code> —  ,   ,              .  Shared Array    <code>SharedArrays</code>,         .  <code>SharedArray</code>  (    )   ,        ,       .        <code>SharedArray</code>,     .  ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Array</a>,      <code>SharedArray</code>,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">sdata</a>.    <code>AbstractArray</code> <code>sdata</code>    ,    <code>sdata</code>     <code>Array</code>.      :</p><br>
<pre><code class="julia hljs"><span class="hljs-built_in">SharedArray</span>{T,N}(dims::<span class="hljs-built_in">NTuple</span>; init=<span class="hljs-literal">false</span>, pids=<span class="hljs-built_in">Int</span>[])</code></pre><br>
<p>  <code>N</code>-     <code>T</code>   <code>dims</code>  ,   <code>pids</code>.     ,        ,      <code>pids</code> (  ,       ). </p><br>
<p>   <code>init</code>   <code>initfn(S :: SharedArray)</code>,      .   ,      <code>init</code>    ,  . </p><br>
<p>  :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-keyword">using</span> Distributed<font></font>
<font></font>
julia&gt; addprocs(<span class="hljs-number">3</span>)
<span class="hljs-number">3</span>-element <span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Int64</span>,<span class="hljs-number">1</span>}:
 <span class="hljs-number">2</span>
 <span class="hljs-number">3</span>
 <span class="hljs-number">4</span><font></font>
<font></font>
julia&gt; <span class="hljs-meta">@everywhere</span> <span class="hljs-keyword">using</span> SharedArrays<font></font>
<font></font>
julia&gt; S = <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Int</span>,<span class="hljs-number">2</span>}((<span class="hljs-number">3</span>,<span class="hljs-number">4</span>), init = S -&gt; S[localindices(S)] = myid())
<span class="hljs-number">3</span>×<span class="hljs-number">4</span> <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Int64</span>,<span class="hljs-number">2</span>}:
 <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
 <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
 <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span><font></font>
<font></font>
julia&gt; S[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>
<span class="hljs-number">7</span><font></font>
<font></font>
julia&gt; S<font></font>
<span class="hljs-number">3</span>×<span class="hljs-number">4</span> <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Int64</span>,<span class="hljs-number">2</span>}:
 <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
 <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
 <span class="hljs-number">2</span>  <span class="hljs-number">7</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span></code></pre><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SharedArrays.localindices</a>             . ,      ,  :</p><br>
<pre><code class="julia hljs">julia&gt; S = <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Int</span>,<span class="hljs-number">2</span>}((<span class="hljs-number">3</span>,<span class="hljs-number">4</span>), init = S -&gt; S[indexpids(S):length(procs(S)):length(S)] = myid())
<span class="hljs-number">3</span>×<span class="hljs-number">4</span> <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Int64</span>,<span class="hljs-number">2</span>}:
 <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
 <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>
 <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span></code></pre><br>
<p>       ,    ,    . :</p><br>
<pre><code class="julia hljs"><span class="hljs-meta">@sync</span> <span class="hljs-keyword">begin</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> procs(S)
        <span class="hljs-meta">@async</span> <span class="hljs-keyword">begin</span><font></font>
            remotecall_wait(fill!, p, S, p)<font></font>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
<p>   .     <em></em>    <code>pid</code>,  ,     (   <code>S</code>),   <code>pid</code>.</p><br>
<p>           «»:</p><br>
<pre><code class="julia hljs">q[i,j,t+<span class="hljs-number">1</span>] = q[i,j,t] + u[i,j,t]</code></pre><br>
<p>  ,     ,   , ,  ,   :  <code>q [i,j,t]</code>    ,     <code>q[i,j,t+1]</code>     ,  ,  ,  <code>q[i,j,t]</code>      ,      <code>q[i,j,t+1]</code>.         .     .  ,    <code>(irange, jrange)</code>,   :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-meta">@everywhere</span> <span class="hljs-keyword">function</span> myrange(q::<span class="hljs-built_in">SharedArray</span>)<font></font>
           idx = indexpids(q)<font></font>
           <span class="hljs-keyword">if</span> idx == <span class="hljs-number">0</span> <span class="hljs-comment"># This worker is not assigned a piece</span>
               <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>:<span class="hljs-number">0</span>, <span class="hljs-number">1</span>:<span class="hljs-number">0</span>
           <span class="hljs-keyword">end</span><font></font>
           nchunks = length(procs(q))<font></font>
           splits = [round(<span class="hljs-built_in">Int</span>, s) <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, stop=size(q,<span class="hljs-number">2</span>), length=nchunks+<span class="hljs-number">1</span>)]
           <span class="hljs-number">1</span>:size(q,<span class="hljs-number">1</span>), splits[idx]+<span class="hljs-number">1</span>:splits[idx+<span class="hljs-number">1</span>]
       <span class="hljs-keyword">end</span></code></pre><br>
<p>  :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-meta">@everywhere</span> <span class="hljs-keyword">function</span> advection_chunk!(q, u, irange, jrange, trange)
           <span class="hljs-meta">@show</span> (irange, jrange, trange)  <span class="hljs-comment"># display so we can see what's happening</span>
           <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> trange, j <span class="hljs-keyword">in</span> jrange, i <span class="hljs-keyword">in</span> irange<font></font>
               q[i,j,t+<span class="hljs-number">1</span>] = q[i,j,t] + u[i,j,t]
           <span class="hljs-keyword">end</span><font></font>
           q<font></font>
       <span class="hljs-keyword">end</span></code></pre><br>
<p>       <code>SharedArray</code></p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-meta">@everywhere</span> advection_shared_chunk!(q, u) =<font></font>
           advection_chunk!(q, u, myrange(q)..., <span class="hljs-number">1</span>:size(q,<span class="hljs-number">3</span>)-<span class="hljs-number">1</span>)</code></pre><br>
<p>     ,       :</p><br>
<pre><code class="julia hljs">julia&gt; advection_serial!(q, u) = advection_chunk!(q, u, <span class="hljs-number">1</span>:size(q,<span class="hljs-number">1</span>), <span class="hljs-number">1</span>:size(q,<span class="hljs-number">2</span>), <span class="hljs-number">1</span>:size(q,<span class="hljs-number">3</span>)-<span class="hljs-number">1</span>);</code></pre><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">@distributed</a>:</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-keyword">function</span> advection_parallel!(q, u)
           <span class="hljs-keyword">for</span> t = <span class="hljs-number">1</span>:size(q,<span class="hljs-number">3</span>)-<span class="hljs-number">1</span>
               <span class="hljs-meta">@sync</span> <span class="hljs-meta">@distributed</span> <span class="hljs-keyword">for</span> j = <span class="hljs-number">1</span>:size(q,<span class="hljs-number">2</span>)
                   <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:size(q,<span class="hljs-number">1</span>)<font></font>
                       q[i,j,t+<span class="hljs-number">1</span>]= q[i,j,t] + u[i,j,t]
                   <span class="hljs-keyword">end</span>
               <span class="hljs-keyword">end</span>
           <span class="hljs-keyword">end</span><font></font>
           q<font></font>
       <span class="hljs-keyword">end</span>;</code></pre><br>
<p> ,   :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-keyword">function</span> advection_shared!(q, u)
           <span class="hljs-meta">@sync</span> <span class="hljs-keyword">begin</span>
               <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> procs(q)
                   <span class="hljs-meta">@async</span> remotecall_wait(advection_shared_chunk!, p, q, u)
               <span class="hljs-keyword">end</span>
           <span class="hljs-keyword">end</span><font></font>
           q<font></font>
       <span class="hljs-keyword">end</span>;</code></pre><br>
<p>   SharedArray    ,     (  <code>julia -p 4</code>):</p><br>
<pre><code class="julia hljs">julia&gt; q = <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Float64</span>,<span class="hljs-number">3</span>}((<span class="hljs-number">500</span>,<span class="hljs-number">500</span>,<span class="hljs-number">500</span>));<font></font>
<font></font>
julia&gt; u = <span class="hljs-built_in">SharedArray</span>{<span class="hljs-built_in">Float64</span>,<span class="hljs-number">3</span>}((<span class="hljs-number">500</span>,<span class="hljs-number">500</span>,<span class="hljs-number">500</span>));</code></pre><br>
<p>     JIT-     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">@time</a>   :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-meta">@time</span> advection_serial!(q, u);<font></font>
(irange,jrange,trange) = (<span class="hljs-number">1</span>:<span class="hljs-number">500</span>,<span class="hljs-number">1</span>:<span class="hljs-number">500</span>,<span class="hljs-number">1</span>:<span class="hljs-number">499</span>)
 <span class="hljs-number">830.220</span> milliseconds (<span class="hljs-number">216</span> allocations: <span class="hljs-number">13820</span> bytes)<font></font>
<font></font>
julia&gt; <span class="hljs-meta">@time</span> advection_parallel!(q, u);
   <span class="hljs-number">2.495</span> seconds      (<span class="hljs-number">3999</span> k allocations: <span class="hljs-number">289</span> MB, <span class="hljs-number">2.09</span>% gc time)<font></font>
<font></font>
julia&gt; <span class="hljs-meta">@time</span> advection_shared!(q,u);<font></font>
        From worker <span class="hljs-number">2</span>:       (irange,jrange,trange) = (<span class="hljs-number">1</span>:<span class="hljs-number">500</span>,<span class="hljs-number">1</span>:<span class="hljs-number">125</span>,<span class="hljs-number">1</span>:<span class="hljs-number">499</span>)<font></font>
        From worker <span class="hljs-number">4</span>:       (irange,jrange,trange) = (<span class="hljs-number">1</span>:<span class="hljs-number">500</span>,<span class="hljs-number">251</span>:<span class="hljs-number">375</span>,<span class="hljs-number">1</span>:<span class="hljs-number">499</span>)<font></font>
        From worker <span class="hljs-number">3</span>:       (irange,jrange,trange) = (<span class="hljs-number">1</span>:<span class="hljs-number">500</span>,<span class="hljs-number">126</span>:<span class="hljs-number">250</span>,<span class="hljs-number">1</span>:<span class="hljs-number">499</span>)<font></font>
        From worker <span class="hljs-number">5</span>:       (irange,jrange,trange) = (<span class="hljs-number">1</span>:<span class="hljs-number">500</span>,<span class="hljs-number">376</span>:<span class="hljs-number">500</span>,<span class="hljs-number">1</span>:<span class="hljs-number">499</span>)
 <span class="hljs-number">238.119</span> milliseconds (<span class="hljs-number">2264</span> allocations: <span class="hljs-number">169</span> KB)</code></pre><br>
<p>   <code>advection_shared!</code>  ,      ,         . </p><br>
<h3 id="obschie-massivy-i-raspredelennaya-sborka-musora">     </h3><br>
<p>   ,          . ,        ,         .<br>
   ,     ,   ,  . </p><br>
<h1 id="parallelnyy-monte-karlo-v-julia"> -  Julia</h1><br>
<p> ,             ,    ,        .</p><br>
<p>        <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>=</mo><mn>3.14159265...</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.48ex" height="2.009ex" viewBox="0 -755.5 7526.1 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-3D" x="851" y="0"></use><g transform="translate(1907,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-34" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-31" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-35" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-39" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-32" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-36" x="3782" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-35" x="4282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2E" x="4783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2E" x="5061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2E" x="5340" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo>=</mo><mn>3.14159265...</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">\pi = 3.14159265...</script>,      ,   -.   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.332ex" height="1.509ex" viewBox="0 -540.2 573.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\pi</script> ,     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo>=</mo><mi>&amp;#x03C0;</mi><msup><mi>r</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.033ex" height="2.384ex" viewBox="0 -916.9 3458.5 1026.6" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="1979" y="0"></use><g transform="translate(2553,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-32" x="638" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>=</mo><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">S = \pi r^2</script>,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.509ex" viewBox="0 -540.2 451.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-72" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> r </script> —  .     -   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.332ex" height="1.509ex" viewBox="0 -540.2 573.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">\pi</script>    , ..        <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mn>1</mn><msup><mo stretchy=&quot;false&quot;>]</mo><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.515ex" height="2.884ex" viewBox="0 -916.9 3235.6 1241.8" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-31" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2C" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-31" x="2002" y="0"></use><g transform="translate(2503,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-5D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-32" x="393" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">[−1,1]^2</script>   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2212;</mo><mi>y</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.326ex" height="2.134ex" viewBox="0 -647.8 2292.9 918.9" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2212" x="794" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-79" x="1795" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>−</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">x-y</script>    ,    .</p><br>
<p><img src="https://habrastorage.org/webt/4v/ym/mb/4vymmbllbfnu3prcb3wfu0qqkje.png"></p><br>
<p>    (<math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo>=</mo><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.93ex" height="2.134ex" viewBox="0 -809.3 2553.1 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="1979" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>=</mo><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">S=\pi</script>,   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.31ex" height="2.009ex" viewBox="0 -755.5 2286.1 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-31" x="1785" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">r = 1</script>)    (<math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>=</mo><mn>4</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.004ex" height="2.134ex" viewBox="0 -809.3 2585.1 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-3D" x="1028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-34" x="2084" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">A = 4</script>)  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>4</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.657ex" height="2.634ex" viewBox="0 -809.3 1574.5 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-2F" x="573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMAIN-34" x="1074" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">\pi/4</script>,      ,    ,          .  ,   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.332ex" height="1.509ex" viewBox="0 -540.2 573.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">\pi</script>      ,    .    <code>compute_pi (N)</code>,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.332ex" height="1.509ex" viewBox="0 -540.2 573.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\pi</script>,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">N</script> .</p><br>
<pre><code class="julia hljs"><span class="hljs-keyword">function</span> compute_pi(N::<span class="hljs-built_in">Int</span>)<font></font>
<font></font>
    <span class="hljs-comment"># counts number of points that have radial coordinate &lt; 1, i.e. in circle</span>
    n_landed_in_circle = <span class="hljs-number">0</span>  
    <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:N<font></font>
        x = rand() * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>  <span class="hljs-comment"># uniformly distributed number on x-axis</span>
        y = rand() * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>  <span class="hljs-comment"># uniformly distributed number on y-axis</span><font></font>
<font></font>
        r2 = x*x + y*y  <span class="hljs-comment"># radius squared, in radial coordinates</span>
        <span class="hljs-keyword">if</span> r2 &lt; <span class="hljs-number">1.0</span>
            n_landed_in_circle += <span class="hljs-number">1</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> n_landed_in_circle / N * <span class="hljs-number">4.0</span>    
<span class="hljs-keyword">end</span></code></pre><br>
<p> ,     ,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.332ex" height="1.509ex" viewBox="0 -540.2 573.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhhObuNmKUHa1xCpT2vLEICQlw7UnQ#MJMATHI-3C0" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">\pi</script>.      :   ,          ,     25  .</p><br>
<p> Julia         <code>Pi.jl</code> (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Sublime Text</a>,          ):</p><br>
<pre><code class="julia hljs">C:\Users\User\AppData\Local\Julia-<span class="hljs-number">1.1</span><span class="hljs-number">.0</span>\bin\julia -p <span class="hljs-number">4</span><font></font>
<font></font>
julia&gt; include(<span class="hljs-string">"C:/Users/User/Desktop/Pi.jl"</span>)</code></pre><br>
<p>      </p><br>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> Distributed<font></font>
addprocs(<span class="hljs-number">4</span>)</code></pre><br>
<p>      <em>Jupyter</em></p><br>
<div class="spoiler"><b class="spoiler_title">Pi.jl</b><div class="spoiler_text"><pre><code class="julia hljs"><span class="hljs-meta">@everywhere</span> <span class="hljs-keyword">function</span> compute_pi(N::<span class="hljs-built_in">Int</span>)<font></font>
<font></font>
    n_landed_in_circle = <span class="hljs-number">0</span>  
    <span class="hljs-comment"># counts number of points that have radial coordinate &lt; 1, i.e. in circle</span>
    <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>:N<font></font>
        x = rand() * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>  <span class="hljs-comment"># uniformly distributed number on x-axis</span>
        y = rand() * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>  <span class="hljs-comment"># uniformly distributed number on y-axis</span><font></font>
<font></font>
        r2 = x*x + y*y  <span class="hljs-comment"># radius squared, in radial coordinates</span>
        <span class="hljs-keyword">if</span> r2 &lt; <span class="hljs-number">1.0</span>
            n_landed_in_circle += <span class="hljs-number">1</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> n_landed_in_circle / N * <span class="hljs-number">4.0</span>    
<span class="hljs-keyword">end</span><font></font>
<font></font>
<span class="hljs-keyword">function</span> parallel_pi_computation(N::<span class="hljs-built_in">Int</span>; ncores::<span class="hljs-built_in">Int</span>=<span class="hljs-number">4</span>)<font></font>
<font></font>
    <span class="hljs-comment">#      </span>
    sum_of_pis = <span class="hljs-meta">@distributed</span> (+) <span class="hljs-keyword">for</span> i=<span class="hljs-number">1</span>:ncores<font></font>
        compute_pi(ceil(<span class="hljs-built_in">Int</span>, N / ncores))
    <span class="hljs-keyword">end</span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> sum_of_pis / ncores  <span class="hljs-comment"># average value</span>
<span class="hljs-keyword">end</span>
<span class="hljs-comment"># ceil (T, x)     </span>
<span class="hljs-comment">#  T,     x.</span></code></pre></div></div><br>
<p>      ,    :</p><br>
<pre><code class="julia hljs">julia&gt; <span class="hljs-meta">@time</span> parallel_pi_computation(<span class="hljs-number">1000000000</span>, ncores = <span class="hljs-number">1</span>)
  <span class="hljs-number">6.818123</span> seconds (<span class="hljs-number">1.96</span> M allocations: <span class="hljs-number">99.838</span> MiB, <span class="hljs-number">0.42</span>% gc time)
<span class="hljs-number">3.141562892</span><font></font>
<font></font>
julia&gt; <span class="hljs-meta">@time</span> parallel_pi_computation(<span class="hljs-number">1000000000</span>, ncores = <span class="hljs-number">1</span>)
  <span class="hljs-number">5.081638</span> seconds (<span class="hljs-number">1.12</span> k allocations: <span class="hljs-number">62.953</span> KiB)
<span class="hljs-number">3.141657252</span><font></font>
<font></font>
julia&gt; <span class="hljs-meta">@time</span> parallel_pi_computation(<span class="hljs-number">1000000000</span>, ncores = <span class="hljs-number">2</span>)
  <span class="hljs-number">3.504871</span> seconds (<span class="hljs-number">1.84</span> k allocations: <span class="hljs-number">109.382</span> KiB)
<span class="hljs-number">3.1415942599999997</span><font></font>
<font></font>
julia&gt; <span class="hljs-meta">@time</span> parallel_pi_computation(<span class="hljs-number">1000000000</span>, ncores = <span class="hljs-number">4</span>)
  <span class="hljs-number">3.093918</span> seconds (<span class="hljs-number">1.12</span> k allocations: <span class="hljs-number">71.938</span> KiB)
<span class="hljs-number">3.1416889400000003</span><font></font>
<font></font>
julia&gt; <span class="hljs-literal">pi</span>
? = <span class="hljs-number">3.1415926535897</span>...</code></pre><br>
<p> <em>JIT</em>- —     .  ,    Julia  . ,             (       Multi-Threading, Atomic Operations, Channels  Coroutines).</p><br>
<h3 id="poleznye-ssylki"> </h3><br>
<p>  ,    ,   .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">MPI.jl</a>      <code>MPI</code>, <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">DistributedArrays.jl</a>     .<br>
      GPU,    :</p><br>
<ol>
<li> (  C) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">OpenCL.jl</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CUDAdrv.jl</a>     OpenCL   CUDA.</li>
<li> (  Julia)  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CUDAnative.jl</a>     CUDA .</li>
<li> ,    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CuArrays.jl</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CLArrays.jl</a></li>
<li>  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ArrayFire.jl</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">GPUArrays.jl</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> -</a></li>
<li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Kynseed</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
</ol><br>
<p> , , .    !</p><br>
<p><img src="https://habrastorage.org/webt/f2/4o/pr/f24oprfnnrnguwwb03xcyo__xx4.gif"></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja455832/index.html">単一のSQL調査の履歴</a></li>
<li><a href="../ja455834/index.html">Linuxサーバーのベンチマーク：5つのオープンツール</a></li>
<li><a href="../ja455840/index.html">複数のクエリを使用する方法。組成、レジューサー、FP</a></li>
<li><a href="../ja455842/index.html">単一リンクリストを広げます。Swiftエディション</a></li>
<li><a href="../ja455844/index.html">例としてカプセル化テストを使用したRoslynアナライザーの作成</a></li>
<li><a href="../ja455848/index.html">シングルトンにアクセスするときに未定義の動作を回避するための手法</a></li>
<li><a href="../ja455850/index.html">研究者向けツールボックス-第3版：ソースの検索と操作</a></li>
<li><a href="../ja455852/index.html">副鼻腔挙上と同時着床</a></li>
<li><a href="../ja455854/index.html">iOS 13でコンテキストメニューを実装する方法</a></li>
<li><a href="../ja455856/index.html">nRF52832のワイヤレス温度、湿度、および気圧センサー</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>