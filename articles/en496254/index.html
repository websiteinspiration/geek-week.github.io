<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üâê üí™üèº üë©‚Äç‚ù§Ô∏è‚Äçüë® How Rostelecom mistakenly redirected traffic to Google, AWS, Cloudflare, etc. üí∑ üïë üßñüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Earlier this week (April 1-5, 20) traffic destined for more than 200 of the world's largest CDN and cloud providers was suspiciously redirected throug...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How Rostelecom mistakenly redirected traffic to Google, AWS, Cloudflare, etc.</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496254/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Earlier this week (April 1-5, 20) traffic destined for more than 200 of the world's largest CDN and cloud providers was suspiciously redirected through </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rostelecom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Russia's main telecommunications provider). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The incident affected more than 8,800 Internet traffic routes out of 200+ networks and lasted about an hour. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Affected companies are those who are in the cloud and CDN market, including big names such as Google, Amazon, Facebook, Akamai, Cloudflare, GoDaddy, Digital Ocean, Joyent, LeaseWeb, Hetzner and Linode.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Technical details</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The incident is the classic </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BGP hijack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BGP stands for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Border Gateway Protocol</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and is a de facto system used to route Internet traffic between Internet networks around the world. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The entire Internet routing system is still extremely fragile, because any of the participating networks can simply ‚Äúlie‚Äù and publish an advertisement (BGP route) stating that the ‚ÄúFacebook servers‚Äù are on their network, and many providers will consider it legal and send all Facebook traffic to the "trickster" servers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">History tour</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the old days, before HTTPS was widely used to encrypt traffic, BGP hackers allowed attackers to carry out ‚Äú </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">man-in-the-middle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù </font><font style="vertical-align: inherit;">attacks </font><font style="vertical-align: inherit;">and intercept / modify Internet traffic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Currently, BGP hacks are still dangerous because they allow an attacker to register traffic, analyze and decrypt it later, when the encryption used to protect it was weakened due to advances in cryptography. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BGP hacks have been a problem for the Internet backbone since the mid-90s, and efforts to strengthen the security of the BGP protocol have been made over the years, with projects such as </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROV, RPKI,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and most recently, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MANRS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, progress in adopting new protocols is slow, and BGP spoofing continues to occur on a regular basis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, in November 2018, a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">small Nigerian Internet service provider intercepted traffic</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destined for the Google network, and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in June 2019 most of the European mobile traffic was redirected through China Telecom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the state-owned and largest telecom operator in China.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rostelecom - a repeated offender</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the past, experts have repeatedly noted that not all BGP ‚Äúhijackers‚Äù acted purposefully. Most incidents can be the result of a human factor: the operator sealed up when dialing the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (the code by which Internet entities are identified) and accidentally stole the Internet traffic of this company. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, organizations that regularly monitor BGP hijackings, as well as incidents that many experts call suspicious, suggest that these are often not just random errors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
China Telecom is currently considered the largest criminal on this front [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despite the fact that Rostelecom ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AS12389</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) does not participate in BGP ‚Äúhijackings‚Äù as widespread as China Telecom, it is also behind many similar suspicious incidents. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The last major hijacking of Rostelecom occurred in 2017, when </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BGP routes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> were </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">replaced for several of the world's largest financial institutions, including Visa, Mastercard, HSBC</font></a><font style="vertical-align: inherit;"> and many others. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At that time, Cisco </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BGPMon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> described the incident as ‚Äúcurious,‚Äù since it apparently only affected financial services, not random ASNs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This time, everything is ambiguous: BGPMon founder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andree Toonk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doubts the focus of the Russian operator and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tweeted</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that the ‚Äúhacking‚Äù occurred after the internal traffic management subsystem of Rostelecom could accidentally reveal the wrong BGP routes on the public Internet, and not on the internal network of Rostelecom.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the whole situation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As many Internet experts have noted in the past, deliberate hijacking of BGP may look like an accidental error, and no one can notice the difference. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BGP abductions at state-controlled telecommunications organizations in autocratic countries such as China and Russia will always be considered suspicious, primarily because of politics, not technical reasons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
More links: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
more about this leak of routes from April 2: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">habr.com/ru/company/qrator/blog/495274</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
media response and Rostelecom‚Äôs response: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tjournal.ru/news/156008-zhurnalist-poprosil-rostelekom-obyasnit-peregruzku- seti-iz-za-karantina-press-sluzhba-otvetila-emu-a-potom-oskorbila</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tech.slashdot.org/story/20/04/07/0018229/russian-telco-hijacked-internet-traffic-of-google-aws-cloudflare-and-others</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en496240/index.html">Product Discovery 101 for Product Manager</a></li>
<li><a href="../en496242/index.html">Cyberpunk is already here: schoolchildren study at Minecraft, and students take physical tests in CS: GO</a></li>
<li><a href="../en496248/index.html">Challenges, bald heads and wine. How we at HFLabs endure self-isolation</a></li>
<li><a href="../en496250/index.html">How strange code hides errors? TensorFlow.NET Analysis</a></li>
<li><a href="../en496252/index.html">Aerodynamically offset centering aircraft</a></li>
<li><a href="../en496256/index.html">Machine learning on R: expert techniques for predictive analysis</a></li>
<li><a href="../en496258/index.html">Online holivar: a new format for the exchange of experience. This Saturday</a></li>
<li><a href="../en496260/index.html">Cybersecurity tips for working from home</a></li>
<li><a href="../en496262/index.html">Getting CVE ID</a></li>
<li><a href="../en496266/index.html">Coronavirus: shall we all die?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>