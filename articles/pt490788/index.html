<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öñÔ∏è üïô üö∂üèæ REPL in√∫til Relat√≥rio Yandex üçæ üë©‚Äçüëß üëÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O REPL (loop de leitura-avalia√ß√£o-impress√£o) √© in√∫til no Python, mesmo que seja IPython m√°gico. Hoje vou oferecer uma das solu√ß√µes poss√≠veis para esse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>REPL in√∫til Relat√≥rio Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/490788/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O REPL (loop de leitura-avalia√ß√£o-impress√£o) √© in√∫til no Python, mesmo que seja IPython m√°gico. </font><font style="vertical-align: inherit;">Hoje vou oferecer uma das solu√ß√µes poss√≠veis para esse problema. </font><font style="vertical-align: inherit;">Primeiro de tudo, o relat√≥rio e minha extens√£o TheREPL ser√£o √∫teis para aqueles que est√£o interessados ‚Äã‚Äãem um desenvolvimento mais r√°pido e eficiente, bem como para aqueles que escrevem sistemas com estado.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Meu nome √© Alexander, trabalho como programador em Yandex. Estamos escrevendo na minha equipe em Python, ainda n√£o mudamos para o Go. Por√©m, no meu tempo livre, por incr√≠vel que pare√ßa, tamb√©m programo e fa√ßo em uma linguagem muito din√¢mica - Common Lisp. Talvez seja ainda mais din√¢mico que o Python. Sua peculiaridade reside no fato de que o pr√≥prio processo de desenvolvimento √© organizado de maneira um pouco diferente. √â mais interativo e iterativo, porque no REPL on Lisp voc√™ pode fazer tudo: criar novos e excluir m√≥dulos antigos, adicionar m√©todos, classes e exclu√≠-los, redefinir classes etc.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/0p/ld/xo/0pldxop8ymqyuvlwarowoynh_44.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Python, isso √© ainda mais dif√≠cil. Possui IPython. Obviamente, o IPython aprimora o REPL de alguma forma, adiciona o preenchimento autom√°tico e permite o uso de extens√µes diferentes. Mas para o desenvolvimento iterativo, ele n√£o se encaixa muito bem. Nele voc√™ pode baixar o c√≥digo, test√°-lo um pouco e √© isso. E, √†s vezes, ele quer mais interatividade para que voc√™ possa realmente usar esse REPL no desenvolvimento, alternar entre m√≥dulos, alterar fun√ß√µes e classes dentro deles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso acontece comigo - voc√™ executa, por exemplo, o IPython REPL no ambiente de produ√ß√£o e come√ßa a executar alguns comandos l√°, investiga alguma coisa e, em seguida, verifica-se que h√° um erro no m√≥dulo e voc√™ deseja corrigi-lo rapidamente. Mas isso n√£o funciona, porque voc√™ precisa criar uma nova imagem do Docker, coloc√°-la em produ√ß√£o, entrar neste REPL novamente, alcan√ßar o estado desejado l√° novamente, iniciar tudo o que caiu nela novamente. E, idealmente, eu teria que corrigir a fun√ß√£o, execut√°-la imediatamente e obter o resultado instantaneamente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que pode ser feito sobre isso? </font><font style="vertical-align: inherit;">Como recarregar o c√≥digo no IPython? </font><font style="vertical-align: inherit;">Tentei usar o carregamento autom√°tico e n√£o gostei por v√°rios motivos. </font><font style="vertical-align: inherit;">Antes de tudo, quando o m√≥dulo √© reiniciado, ele perde o estado que estava nas vari√°veis ‚Äã‚Äãglobais dentro deste m√≥dulo. </font><font style="vertical-align: inherit;">E pode haver um valor em cache com os resultados de algumas fun√ß√µes. </font><font style="vertical-align: inherit;">Ou eu poderia, por exemplo, carregar dados pela rede l√°, para que mais tarde eu pudesse trabalhar com eles mais rapidamente. </font><font style="vertical-align: inherit;">Ou seja, o carregamento autom√°tico perde o estado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, como um experimento, fiz minha extens√£o simples para IPython e o nomeei TheREPL.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu vim para voc√™ com este relat√≥rio como uma id√©ia do que pode ser feito com o REPL em Python. </font><font style="vertical-align: inherit;">E eu realmente espero que voc√™ goste dessa id√©ia, que voc√™ a realize em sua mente e continue a criar coisas que tornar√£o o Python ainda mais eficiente e conveniente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que √© o TheREPL? Essa √© a extens√£o que voc√™ baixa, ap√≥s a qual um conceito como namespace aparece no IPython, e voc√™ pode pegar e alternar para qualquer m√≥dulo Python, ver quais vari√°veis, fun√ß√µes etc. est√£o l√°. E, mais importante, voc√™ pode escrever diretamente def, o nome da fun√ß√£o, redefinir a fun√ß√£o ou a classe, e ela ser√° alterada em todos os m√≥dulos em que foi importada. Mas, ao mesmo tempo, o pr√≥prio m√≥dulo n√£o √© reiniciado, portanto, o estado √© salvo. Al√©m disso, o TheREPL permite evitar mais alguns artefatos que est√£o em carregamento autom√°tico e que examinaremos agora.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h0/ob/lo/h0obloylvllg9wciqqyvg3yhqam.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, no carregamento autom√°tico, a atualiza√ß√£o do c√≥digo ocorre apenas quando o arquivo √© salvo. Mas, ao mesmo tempo, √© necess√°rio inserir algo no pr√≥prio REPL, e somente ent√£o o carregamento autom√°tico capta essas altera√ß√µes. Esse √© o problema n√∫mero 1. Ou seja, se voc√™ tiver algum tipo de processo em segundo plano em um encadeamento separado (por exemplo, o servidor est√° em execu√ß√£o), n√£o poder√° simplesmente pegar e corrigir o c√≥digo. O carregamento autom√°tico n√£o aplicar√° essas altera√ß√µes at√© que voc√™ insira algo no IPython REPL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No caso da minha extens√£o, voc√™ pressiona o atalho diretamente no editor e a fun√ß√£o que est√° sob o cursor √© aplicada imediatamente e come√ßa a funcionar. Ou seja, usando TheREPL, voc√™ pode alterar o c√≥digo de forma mais granular. Voc√™ tamb√©m pode escrever def no IPython.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8c/gf/5h/8cgf5hocolkvqgirby2kq730eus.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alternar entre m√≥dulos, como eu disse, o carregamento autom√°tico n√£o oferece suporte de forma alguma. Voc√™ s√≥ pode encontrar o arquivo no sistema de arquivos, alter√°-lo e esperar que o carregamento autom√°tico resolva tudo l√°. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h-/4t/sr/h-4tsrp2ncyufazpguvh0qmjxum.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais. O carregamento autom√°tico perde vari√°veis ‚Äã‚Äãglobais, o TheREPL salva e permite que voc√™ continue pesquisando a opera√ß√£o do seu aplicativo, altere seu c√≥digo interno e, assim, desenvolva-o rapidamente.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tb/md/o_/tbmdo_pag196om9zw0heb1rtvy4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O carregamento autom√°tico ainda possui esse recurso. Ele astuciosamente aplica altera√ß√µes no m√≥dulo que √© recarregado. Em particular, ele faz um truque muito interessante l√°. Se a fun√ß√£o neste m√≥dulo foi atualizada, para alter√°-la onde quer que fosse importada, ele usa o coletor de lixo para encontr√°-la e todas essas inst√¢ncias de fun√ß√µes e alterar o c√≥digo dentro delas. Al√©m disso, veremos exemplos de como isso acontece. Devido a isso, o c√≥digo da fun√ß√£o √© alterado, mesmo que ele entre no fechamento.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ sabe o que √© um fechamento? Isso √© uma coisa muito √∫til. Os desenvolvedores de JavaScript usam isso o tempo todo. Voc√™, provavelmente, tamb√©m simplesmente nunca prestou aten√ß√£o. Mas como o carregamento autom√°tico faz o que descrevi acima, voc√™ pode se encontrar em uma situa√ß√£o em que o c√≥digo antigo usa um novo c√≥digo que pode funcionar de maneira diferente. Por exemplo, uma fun√ß√£o pode retornar n√£o um valor, mas dois, tupla, em vez de string, etc. O c√≥digo antigo ser√° quebrado com isso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O REPL n√£o faz uma coisa t√£o complicada especificamente para garantir que tudo seja mais consistente. Ou seja, ele altera a fun√ß√£o ou classe no m√≥dulo em que est√° definido. Localiza essa classe em todos os outros m√≥dulos e a altera tamb√©m. Depois disso, tudo funciona de uma nova maneira.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-j/fv/xo/-jfvxo93yhfdk69oyhb9xsybvom.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como substituir a fun√ß√£o que o carregamento autom√°tico faz? Temos duas fun√ß√µes, uma e duas. Cada fun√ß√£o possui um conjunto de atributos: documenta√ß√£o, c√≥digo, argumentos, etc. Aqui no slide est√° um exemplo de substitui√ß√£o dos atributos nos quais o bytecode est√° armazenado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois que o carregamento autom√°tico √© alterado, a fun√ß√£o chamada come√ßa a funcionar de maneira diferente. Mas este √© um exemplo sint√©tico que acabei de reproduzir com as m√£os para que voc√™ entenda o que est√° acontecendo. A fun√ß√£o √© chamada de uma maneira, mas o c√≥digo √© realmente diferente. E se voc√™ desmontar, tamb√©m mostra que retorna um empate. O que isso leva a? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bt/u7/qt/btu7qtygtpvagsnxat-tngwtvle.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° um exemplo de encerramento. Na segunda linha, criamos um fechamento no qual capturamos a fun√ß√£o foo. O fechamento em si espera que essa fun√ß√£o que passamos retorne uma linha, ela a codifique em utf-8 e tudo funcione.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tu/mx/b8/tumxb8ifcxw_yh5o2veg8sfrtbw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas suponha que voc√™ altere o m√≥dulo no qual foo est√° definido e o carregamento autom√°tico capta a altera√ß√£o. E voc√™ altera para que n√£o retorne uma string, mas um n√∫mero. Ent√£o o fechamento j√° funcionar√° incorretamente, porque a fun√ß√£o foi alterada por dentro, mas o fechamento n√£o espera isso, n√£o foi alterado. E esses problemas com o carregamento autom√°tico podem "disparar" em locais inesperados. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/eq/k0/mseqk0r8rxsiji38ypx3drsloaw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o carregamento autom√°tico atualiza as classes? Muito simples. Ele atualiza todos os m√©todos da classe da mesma maneira que as fun√ß√µes e tamb√©m atualiza o atributo __class__ para todas as inst√¢ncias, para que a resolu√ß√£o dos m√©todos (determinando qual m√©todo deve ser chamado) comece a funcionar de uma nova maneira.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo √© um pouco mais complicado no TheREPL, porque quando voc√™ atualiza a _classe_, pode haver alguns descendentes, classes filho, que tamb√©m precisam ser atualizados, porque algo mudou na lista de classes base. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver esse problema, voc√™ pode reconstruir a classe. Mas vamos primeiro ver o que acontece com o carregamento autom√°tico quando ele recarrega um m√≥dulo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p-/xc/jg/p-xcjggcwk7h30knymqvqsl9_ue.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° um bom exemplo. Existem dois m√≥dulos - a e b. No m√≥dulo a, uma classe pai √© definida, no m√≥dulo b uma classe filho, e criamos uma inst√¢ncia da classe filho. E a linha 10 mostra que sim, esta √© uma inst√¢ncia da classe Foo, o pai. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nm/aj/gu/nmajgupfumnuw-igpxdk-_fbvlw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, apenas pegamos e alteramos o m√≥dulo a. Por exemplo, adicione documenta√ß√£o √† classe Foo. O carregamento autom√°tico pega essas altera√ß√µes. O que voc√™ acha que, nesse caso, ele retornar√° de Bar?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3t/kz/iw/3tkziw2mnozaraudax0vm4ndzii.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E retorna false, porque o carregamento autom√°tico alterou a classe Foo e agora √© uma classe completamente diferente, n√£o a da qual a classe Bar √© herdada. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jy/o5/mt/jyo5mtiwfcsw1vuvuegmz-ynxbm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E uma surpresa! Nos dois m√≥dulos aeb, a classe Foo √© uma classe diferente e Bar herda de um deles. Devido a esses batentes, √© muito dif√≠cil prever como o seu c√≥digo funcionar√° ap√≥s o carregamento autom√°tico corrigir algo nele. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g3/cj/3e/g3cj3enddiaxo02tzn5zr3jqaa8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algo assim, atualiza as classes. Vou comentar sobre a imagem. Inicialmente, a classe Foo √© importada para o m√≥dulo b e, portanto, permanece l√°. Ao substituir o carregamento autom√°tico, este m√≥dulo a √© realocado e uma nova classe aparece l√°, e no m√≥dulo b n√£o √© atualizado.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/mg/pk/jamgpkvsohlnphdstlwz9_dbyig.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O REPL faz um pouco diferente. Ele injeta uma classe modificada em cada m√≥dulo em que foi importado. Portanto, tudo funciona corretamente l√°. Al√©m disso, se houver objetos na classe, eles ser√£o preservados. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/72/hk/cq/72hkcql64u5ap4p0dzhiwyoxicc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E √© assim que TheREPL resolve o problema com as classes filho. Ou seja, quando a classe pai √© alterada, ela define a lista de classes base atrav√©s do atributo m√°gico mro (ordem de resolu√ß√£o do m√©todo). Este atributo cont√©m uma lista de classes na ordem em que voc√™ deseja procurar m√©todos ou atributos nelas. E toda vez que voc√™ chama o m√©todo get_name no seu objeto, por exemplo, o Python primeiro o verifica na classe Bar, depois na classe Foo e depois na classe de objeto, se n√£o o encontrar. Ele atua de acordo com o procedimento de ordem de resolu√ß√£o do m√©todo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O REPL usa esse chip. </font><font style="vertical-align: inherit;">√â preciso uma lista de classes base, muda a classe que voc√™ acabou de mudar para uma nova. </font><font style="vertical-align: inherit;">Cria um novo tipo filho, este √© o segundo passo. </font><font style="vertical-align: inherit;">Com a fun√ß√£o type, voc√™ pode realmente criar classes. </font><font style="vertical-align: inherit;">Se voc√™ nunca usou, experimente, √© divertido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ acabou de dizer o nome da classe, dizer qual √© a sua classe base. </font><font style="vertical-align: inherit;">No caso mais simples, por exemplo, objeto. </font><font style="vertical-align: inherit;">E - um dicion√°rio com m√©todos e atributos de classe. </font><font style="vertical-align: inherit;">Tudo, voc√™ tem uma nova classe que pode instanciar, como de costume. </font><font style="vertical-align: inherit;">O REPL tira proveito deste chip. </font><font style="vertical-align: inherit;">Ele gera uma classe filha e altera os ponteiros para ela em todos os objetos da classe Bar antiga. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainda tenho uma demonstra√ß√£o, vamos dar uma olhada em como funciona. </font><font style="vertical-align: inherit;">Primeiro, vamos ver uma coisa t√£o simples.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeira demo</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu disse que voc√™ pode alterar o c√≥digo dentro do m√≥dulo. Suponha que tenhamos um servidor. Eu vou execut√°-lo agora. Em algum momento, descobrimos que, por algum motivo, ele cria diret√≥rios tempor√°rios. Ou ele come√ßou a criar, mas antes disso ele n√£o criou. Em seguida, podemos nos conectar a este servidor e, supondo que provavelmente crie esses diret√≥rios usando a fun√ß√£o mkdtemp do m√≥dulo de arquivo, voc√™ pode ir diretamente para esse m√≥dulo Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veja - no canto, o nome do m√≥dulo atual foi alterado. Agora diz tempfile. E eu posso ver quais recursos existem. N√≥s os vemos e, principalmente, podemos redefini-los. Eu preparei um inv√≥lucro especial que permite decorar qualquer fun√ß√£o para que, com todas as chamadas, voc√™ possa ver o rastreio de onde √© chamado. Agora vamos import√°-los e aplic√°-los.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou seja, envolvo a fun√ß√£o Python padr√£o, sem ter acesso ao c√≥digo-fonte para este m√≥dulo. </font><font style="vertical-align: inherit;">Eu posso pegar e embrulh√°-lo. </font><font style="vertical-align: inherit;">E na pr√≥xima sa√≠da, veremos o Traceback e descobriremos de onde √© chamado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da mesma forma, essas altera√ß√µes podem ser revertidas para que n√£o nos enviem spam. </font><font style="vertical-align: inherit;">Ou seja, vemos que esse servidor dentro do worker na oitava linha chama mkdtemp e continua produzindo diret√≥rios tempor√°rios para n√≥s, sobrecarregando o sistema de arquivos. </font><font style="vertical-align: inherit;">Esta √© uma aplica√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vejamos outro exemplo de por que o carregamento autom√°tico √†s vezes n√£o funciona muito bem. </font><font style="vertical-align: inherit;">Eu tenho um bot de telegrama preparado:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segunda demo</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, ativamos o carregamento autom√°tico e vemos como isso nos ajuda. √â isso a√≠, agora voc√™ pode iniciar o bot e conversar com ele. Para que voc√™ possa ver melhor, iniciaremos um di√°logo com ele. Conhe√ßa o bot. Assim. H√° algum tipo de erro. Um erro completamente diferente foi concebido e eu decidi fazer altera√ß√µes no √∫ltimo momento. Mas isso n√£o importa. Agora vamos corrigi-lo, o carregamento autom√°tico nos ajudar√° com isso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos mudando para o bot. E agora vou comentar temporariamente sobre isso, se sim. Eu salvo o arquivo. A carga autom√°tica, em teoria, teve que captar essas mudan√ßas. Inicie o bot novamente. O bot me reconheceu. Vamos conversar com ele.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro erro. Ela j√° concebeu. Vamos consertar. Deixarei o bot, ele funcionar√° em segundo plano, mudarei para o editor e, no editor, encontraremos esse erro. √â apenas um erro de digita√ß√£o e esqueci que minha vari√°vel se chama user_name. Eu salvei o arquivo. autoreload deveria peg√°-la, e agora vamos v√™-lo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas o carregamento autom√°tico, como j√° mencionei, n√£o sabe nada sobre o fato de o arquivo ter sido alterado at√© voc√™ inserir algo nele. Com um processo t√£o longo ... Ele precisa ser interrompido, reiniciado. Feito. Volte para o nosso bot, escreva para ele. Bem, voc√™ v√™, o bot esqueceu que meu nome √© Sasha. Por qu√™? O autoreload o recriou novamente porque recarrega completamente o m√≥dulo. E eu preciso escrever para o bot novamente, para restaurar seu estado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E se voc√™ estiver depurando algum tipo de erro que ocorre em um determinado estado, o estado n√£o pode ser perdido, porque, caso contr√°rio, voc√™ passar√° muito tempo novamente para atingir esse estado. O REPL ajuda nesses casos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ver como o bot ser√° atualizado no caso de usar o TheREPL. Para a pureza do experimento, vou reiniciar o IPython e repetiremos tudo de novo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E agora eu baixo TheREPL. Ele imediatamente come√ßa a ouvir em uma porta espec√≠fica para que voc√™ possa enviar um c√≥digo dentro dela. A prop√≥sito, isso pode ser feito mesmo que o IPython esteja sendo executado em algum lugar no servidor e o editor esteja sendo executado localmente, o que tamb√©m pode ajud√°-lo em alguns casos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s importamos o bot, iniciamos, escrevemos novamente. Est√° claro aqui: reiniciamos o Python, para que n√£o se lembre de quem eu sou. Verifique se h√° um erro dentro. Sim, h√° um erro. Bem, vamos faz√™-lo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Volto ao editor, corrijo o erro. Nem precisamos salvar o arquivo, pressione Ctrl-C, Ctrl-C, este √© um atalho pelo qual o Emacs pega a descri√ß√£o atual da fun√ß√£o que est√° logo abaixo do cursor e a envia para o processo Python ao qual est√° conectado. Isso √© tudo, agora podemos verificar como nosso bot responde √†s minhas mensagens l√°. Agora, ele lembra que eu sou Sasha e responde honestamente que ele n√£o sabe como.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos tentar adicionar diretamente novas funcionalidades l√°. Para fazer isso, volte ao editor. Por exemplo, adicione o comando help. Por enquanto, deixe-o responder que n√£o sabe nada sobre ajuda. Mais uma vez, pressione Ctrl-C, Ctrl-C, o c√≥digo √© aplicado. N√≥s vamos ao bot. Veja se ele entende esse comando. Sim, a equipe se inscreveu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A prop√≥sito, ele ainda tem uma coisa dessas, agora vamos ver como a classe vai mudar. Ele tem um comando de estado, um comando de depura√ß√£o especial para visualizar o estado do bot. Ent√£o, alguns Oleg conectados. Interessante.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando o bot executa este comando, ele chama reply para visualizar a representa√ß√£o do bot. Podemos corrigir, por exemplo, esta resposta com outra coisa. Por exemplo, fa√ßa com que apenas os nomes sejam inseridos. Voc√™ pode fazer isso. Voltamos ao nosso messenger, novamente executamos o estado. E isso √© tudo. Agora, a resposta funciona de uma nova maneira, mas o objeto √© o mesmo, preservou seu estado, pois lembra de todos n√≥s - Oleg, Sasha, kek e "Usu√°rios da tabela da DROP, Alex"! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, voc√™ pode escrever e depurar c√≥digo diretamente, sem mudar para esse ciclo, quando precisar coletar um pacote, role-o em algum lugar. Voc√™ pode testar rapidamente algo, alterar tudo o que precisa e s√≥ ent√£o todas essas altera√ß√µes devem ser empacotadas adequadamente e implantadas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, voc√™ n√£o deve fazer isso na produ√ß√£o real, porque com essa abordagem que tipo de problema pode ser. Voc√™ pode esquecer que o c√≥digo que voc√™ acabou de iniciar no servidor precisa ser salvo e, em seguida, implantado como deveria. Essa abordagem requer disciplina. Mas, no processo de desenvolvimento e depura√ß√£o de algum tipo de teste, isso √© √≥timo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certifique-se de criar um plugin para o PyCharm. Se houver um volunt√°rio que me ajudar√° com o Kotlin e o plugin PyCharm, terei prazer em conversar. Escreva-me </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pelo correio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telegrama</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* * * </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conectar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para o desenvolvimento do TheREPL. </font><font style="vertical-align: inherit;">Existem muitos outros chips em que voc√™ pode pensar. </font><font style="vertical-align: inherit;">Por exemplo, voc√™ pode encontrar uma maneira de atualizar inst√¢ncias de classe quando elas atualizam, adicionam novos atributos ou atualizam seu estado de alguma forma. </font><font style="vertical-align: inherit;">Da mesma forma, atualizaremos o banco de dados. </font><font style="vertical-align: inherit;">Agora isso n√£o √©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode criar um c√≥digo de recarga a quente para produ√ß√£o, para que, quando novas altera√ß√µes chegarem, n√£o seja necess√°rio reiniciar o servidor. </font><font style="vertical-align: inherit;">Voc√™ pode criar muito mais. </font><font style="vertical-align: inherit;">Isso √© apenas uma ideia, e eu quero que voc√™ tire isso daqui. </font><font style="vertical-align: inherit;">Devemos ajustar tudo por n√≥s mesmos e torn√°-lo conveniente. </font><font style="vertical-align: inherit;">Isso √© tudo para mim.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt490778/index.html">Pessoas que entendem o trabalho de um programador podem ser encontradas em qualquer lugar</a></li>
<li><a href="../pt490780/index.html">Intel Xeon Scalable Gen2: grande venda de n√∫cleos</a></li>
<li><a href="../pt490782/index.html">Confer√™ncia AnalogBytes: Roskomnadzor, m√≠dia, carga alta e tudo-tudo-tudo</a></li>
<li><a href="../pt490784/index.html">Sou desenvolvedor do Android e n√£o gostava de trabalhar manualmente.</a></li>
<li><a href="../pt490786/index.html">An√°lise de vazamento de segunda ordem: quando vaza de quem rouba dados de um banco</a></li>
<li><a href="../pt490790/index.html">Arquivos Zip: Hist√≥rico, Explica√ß√£o e Implementa√ß√£o</a></li>
<li><a href="../pt490792/index.html">VXLAN no NSX-V - Underlay problem√°tico</a></li>
<li><a href="../pt490796/index.html">Como automatizar a seguran√ßa de cont√™ineres no estilo de pol√≠tica como c√≥digo usando CRD</a></li>
<li><a href="../pt490804/index.html">Como a m√£e de um hacker entrou na pris√£o e infectou o computador do chefe</a></li>
<li><a href="../pt490808/index.html">Matem√°tica em astron√°utica: mecanismo de detona√ß√£o rotacional</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>