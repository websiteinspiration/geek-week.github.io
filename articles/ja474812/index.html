<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸🏼 👲🏿 🕧 シェーダーは魔法ではありません。Unityでシェーダーを書く。頂点シェーダー 🛠️ 😥 🧝🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="みなさん、こんにちは！私の名前はグリゴリーディアディチェンコで、Foxsys Studiosの創設者兼CTOです。今日は頂点シェーダーについて話します。この記事では、Unityの観点からの実践、非常に単純な例、およびUnityのシェーダーに関する情報を学習するための多くのリンクを検討します。シェーダ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>シェーダーは魔法ではありません。Unityでシェーダーを書く。頂点シェーダー</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474812/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">みなさん、こんにちは！</font><font style="vertical-align: inherit;">私の名前はグリゴリーディアディチェンコで、Foxsys Studiosの創設者兼CTOです。</font><font style="vertical-align: inherit;">今日は頂点シェーダーについて話します。</font><font style="vertical-align: inherit;">この記事では、Unityの観点からの実践、非常に単純な例、およびUnityのシェーダーに関する情報を学習するための多くのリンクを検討します。</font><font style="vertical-align: inherit;">シェーダーの作成に長けていると、自分にとって新しいものは見つかりません。</font><font style="vertical-align: inherit;">Unityでシェーダーを書き始めたい人は、猫へようこそ。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/9n/wy/zr9nwyvbjnky73iqvvuvvzxpyjs.jpeg"><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理論のビット</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シェーダープロセスをよりよく理解するために、少し理論を見てみましょう。</font><font style="vertical-align: inherit;">頂点シェーダーまたは頂点シェーダーは、個々の頂点で機能するシェーダーのプログラム可能なステージです。</font><font style="vertical-align: inherit;">頂点は、シェーダーのこの部分で処理されるさまざまな属性を格納し、出力で変換された属性を取得します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点シェーダーが使用される例</font></font></h3><br>
<br>
<img src="https://habrastorage.org/webt/fk/ry/kc/fkrykcsixvzaihfaa4g6jajebk4.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトの変形</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -リアルな波、雨の波紋の効果、弾丸が当たったときの変形、これらすべては頂点シェーダーで行うことができ、シェーダーのフラグメント部分のバンプマッピングで行う同じものよりもリアルに見えます。これはジオメトリの変更なので。このテーマのレベル3.0シェーダーには、ディスペースマッピングと呼ばれる手法があり、シェーダーの頂点部分のテクスチャにアクセスできるようになりました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8e/tb/uu/8etbuufscvxpmvx3acs8irusgag.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトのアニメーション。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">植物がキャラクターに反応したり、木が風に揺れたりすると、ゲームはより生き生きとして面白くなります。これには、頂点シェーダーも使用</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cu/ov/vk/cuovvkcufzn0jn0351xjw9bzfso.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">されます。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多くのゲームでは、スタイルの観点から見ると、もっと面白く見えるのはPBRライティングではなく、スタイルです。</font><font style="vertical-align: inherit;">同時に、フラグメント部分で何かを計算しても意味がありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/m1/8a/km/m18akmnn364xlwyrh_0r5pb_zjc.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スキニング。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現時点では、この問題はゲームエンジンで解決されていますが、頂点シェーダーを理解して、その動作を理解することは有用です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点を操作する簡単な例</font></font></h3><br>
<img src="https://habrastorage.org/webt/ra/7v/m-/ra7vm-kgn__gsmaeg6xg7aud4ey.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フクロウの描き方の古いレッスンのように、それが起こらないようにしたいので、段階的に進みましょう。</font><font style="vertical-align: inherit;">標準のサーフェスシェーダーを作成します。</font><font style="vertical-align: inherit;">これは、プロジェクトビューの右マウスボタンまたは[アセット]タブの上部パネルで実行できます。</font><font style="vertical-align: inherit;">作成-&gt;シェーダー-&gt;標準サーフェスシェーダー。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、私たちはそのような標準的なブランクを得ます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーフェイスシェーダー</font></font></b><div class="spoiler_text"><code>Shader "Custom/SimpleVertexExtrusionShader"<br>
{<br>
 Properties<br>
 {<br>
 _Color ("Color", Color) = (1,1,1,1)<br>
 _MainTex ("Albedo (RGB)", 2D) = "white" {}<br>
 _Glossiness ("Smoothness", Range(0,1)) = 0.5<br>
 _Metallic ("Metallic", Range(0,1)) = 0.0<br>
 }<br>
 SubShader<br>
 {<br>
 Tags { "RenderType"="Opaque" }<br>
 LOD 200<br>
<br>
CGPROGRAM<br>
 // Physically based Standard lighting model, and enable shadows on all light types<br>
 #pragma surface surf Standard fullforwardshadows<br>
<br>
// Use shader model 3.0 target, to get nicer looking lighting<br>
 #pragma target 3.0<br>
<br>
sampler2D _MainTex;<br>
<br>
struct Input<br>
 {<br>
 float2 uv_MainTex;<br>
 };<br>
<br>
half _Glossiness;<br>
 half _Metallic;<br>
 fixed4 _Color;<br>
<br>
// Add instancing support for this shader. You need to check 'Enable Instancing' on materials that use the shader.<br>
 // See https://docs.unity3d.com/Manual/GPUInstancing.html for more information about instancing.<br>
 // #pragma instancing_options assumeuniformscaling<br>
 UNITY_INSTANCING_BUFFER_START(Props)<br>
 // put more per-instance properties here<br>
 UNITY_INSTANCING_BUFFER_END(Props)<br>
<br>
void surf (Input IN, inout SurfaceOutputStandard o)<br>
 {<br>
 // Albedo comes from a texture tinted by color<br>
 fixed4 c = tex2D (_MainTex, IN.uv_MainTex) * _Color;<br>
 o.Albedo = c.rgb;<br>
 // Metallic and smoothness come from slider variables<br>
 o.Metallic = _Metallic;<br>
 o.Smoothness = _Glossiness;<br>
 o.Alpha = c.a;<br>
 }<br>
 ENDCG<br>
 }<br>
 FallBack "Diffuse"<br>
}</code></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それがどのように機能するか、そして一般的には、基本的な練習の後の記事で詳細に分析します。さらに、シェーダーの実装中に部分的に理解します。</font><font style="vertical-align: inherit;">とりあえず、与えられたままにしておこう。</font><font style="vertical-align: inherit;">要するに、（パラメータの取得方法などに関して）魔法はありません。特定のキーワードに対してのみ、ユニットは最初からコードを記述しないようにコードを生成します。</font><font style="vertical-align: inherit;">したがって、このプロセスは十分に明確ではありません。</font><font style="vertical-align: inherit;">Unityのサーフェスシェーダーとそのプロパティの詳細については、こちらをご覧ください。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.unity3d.com/Manual/SL-SurfaceShaders.html不要な</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ものはすべて削除するので、気</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">が散ら</font></a><font style="vertical-align: inherit;">ないようにします。現時点では不要なためです。</font><font style="vertical-align: inherit;">そして、そのような短いシェーダーを入手してください。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡略化されたシェーダー</font></font></b><div class="spoiler_text"><code>Shader "Custom/SimpleVertexExtrusionShader"<br>
{<br>
 Properties<br>
 {<br>
 _Color ("Color", Color) = (1,1,1,1)<br>
 }<br>
 SubShader<br>
 {<br>
 Tags { "RenderType"="Opaque" }<br>
 LOD 200<br>
<br>
CGPROGRAM<br>
<br>
#pragma surface surf Standard fullforwardshadows<br>
<br>
#pragma target 3.0<br>
<br>
struct Input<br>
 {<br>
 float4 color : COLOR;<br>
 };<br>
 <br>
 fixed4 _Color;<br>
<br>
void surf (Input IN, inout SurfaceOutputStandard o)<br>
 {<br>
 fixed4 c = _Color;<br>
 o.Albedo = c.rgb;<br>
 }<br>
 ENDCG<br>
 }<br>
 FallBack "Diffuse"<br>
}<br>
</code><br>
</div></div><br>
<img src="https://habrastorage.org/webt/wg/po/iw/wgpoiwtso4uxmmipwrbvtnz1mek.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
照明付きモデルの色だけです。この場合、Unityが照明の計算を担当します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、Unityの例から最も単純な効果を追加します。押し出しは正常であり、その例では、それがどのように機能するかを分析します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行う</font><font style="vertical-align: inherit;">には、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#pragma surface surf Standard fullforwardshadows</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lineに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vertex：vert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修飾子を</font><font style="vertical-align: inherit;">追加し</font><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inout appdata_full v</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をパラメーターとして関数に渡すと</font><font style="vertical-align: inherit;">、本質的にこの関数は頂点修飾子になります。その中心には、頂点の予備処理を提供するコード生成ユニットによって作成された頂点シェーダーの一部です。また、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Properties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブロックで、</font><font style="vertical-align: inherit;">0から1までの値を受け入れる</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Amount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールド</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">追加</font><font style="vertical-align: inherit;">します。フィールドを使用するには</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーの</font><i><font style="vertical-align: inherit;">_Amount</font></i><font style="vertical-align: inherit;">、ここでも定義する必要があります。</font><font style="vertical-align: inherit;">関数では、単純に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Amount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">応じて通常にシフトします</font><font style="vertical-align: inherit;">。0は標準の頂点位置（ゼロシフト）、1は正確に通常のシフトです。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleVertexExtrusionShader</font></font></b><div class="spoiler_text"><code>Shader "Custom/SimpleVertexExtrusionShader"<br>
{<br>
 Properties<br>
 {<br>
 _Color ("Color", Color) = (1,1,1,1)<br>
 _Amount ("Extrusion Amount", Range(0,1)) = 0.5<br>
 }<br>
 SubShader<br>
 {<br>
 Tags { "RenderType"="Opaque" }<br>
 LOD 200<br>
<br>
CGPROGRAM<br>
<br>
#pragma surface surf Standard fullforwardshadows vertex:vert<br>
<br>
#pragma target 3.0<br>
<br>
struct Input<br>
 {<br>
 float4 color : COLOR;<br>
 };<br>
 <br>
 fixed4 _Color;<br>
 float _Amount;<br>
<br>
void vert (inout appdata_full v)<br>
 {<br>
 v.vertex.xyz += v.normal * _Amount;<br>
 }<br>
 void surf (Input IN, inout SurfaceOutputStandard o)<br>
 {<br>
 fixed4 c = _Color;<br>
 o.Albedo = c.rgb;<br>
 }<br>
 ENDCG<br>
 }<br>
 FallBack "Diffuse"<br>
}<br>
</code><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シェーダーの重要な機能に気づくでしょう。シェーダーはフレームごとに実行されますが、シェーダー操作中に取得された結果はメッシュに保存されず、レンダリングのみに使用されます。したがって、シェーダーの機能や</font><font style="vertical-align: inherit;">スクリプト内</font><font style="vertical-align: inherit;">の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Update</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">関連付けることはできません</font><font style="vertical-align: inherit;">。それらは、メッシュデータを変更せずにフレームごとに適用されますが、さらにレンダリングするためにメッシュを変更するだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、アニメーションを作成する最も簡単な方法の1つは、時間を使用して振幅を変更することです。ユニットには組み込み変数があり、その完全なリストは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.unity3d.com/Manual/SL-UnityShaderVariables.htmlにあります</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この場合、過去のシェーダーに基づいて新しいシェーダーを作成します。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Amountの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わりに</font><i><font style="vertical-align: inherit;">-float</font></i><font style="vertical-align: inherit;">値を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Amplitudeにします</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み込み変数Unity </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_SinTime</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用します</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_SinTime</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は時間の正弦であるため、-1から1までの値を取ります。ただし、ユニットシェーダーのすべての組み込み時間変数が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">float4</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベクトルであることを忘れないでください</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">たとえば、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_SinTimeは</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（sin（t / 8）、sin（t / 4）、sin（t / 2）、sin（t））</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として定義され</font><font style="vertical-align: inherit;">ます。ここで、tは時間です。</font><font style="vertical-align: inherit;">したがって、アニメーションが高速になるようにzコンポーネントを使用します。</font><font style="vertical-align: inherit;">そして私達は得る：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleVertexExtrusionWithTime</font></font></b><div class="spoiler_text"><code>Shader "Custom/SimpleVertexExtrusionWithTime"<br>
{<br>
 Properties<br>
 {<br>
 _Color ("Color", Color) = (1,1,1,1)<br>
 _Amplitude ("Extrusion Amplitude", float) = 1<br>
 }<br>
 SubShader<br>
 {<br>
 Tags { "RenderType"="Opaque" }<br>
 LOD 200<br>
<br>
CGPROGRAM<br>
<br>
#pragma surface surf Standard fullforwardshadows vertex:vert<br>
<br>
#pragma target 3.0<br>
<br>
struct Input<br>
 {<br>
 float4 color : COLOR;<br>
 };<br>
 <br>
 fixed4 _Color;<br>
 float _Amplitude;<br>
<br>
void vert (inout appdata_full v)<br>
 {<br>
 v.vertex.xyz += v.normal * _Amplitude * (1 - _SinTime.z);<br>
 }<br>
 void surf (Input IN, inout SurfaceOutputStandard o)<br>
 {<br>
 fixed4 c = _Color;<br>
 o.Albedo = c.rgb;<br>
 }<br>
 ENDCG<br>
 }<br>
 FallBack "Diffuse"<br>
}<br>
</code><br>
</div></div><br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お使いのブラウザはHTML5ビデオをサポートしていません。</font></font><source src="https://i.giphy.com/media/U5UFh8tOZIAmDyZmzm/giphy.mp4" type="video/mp4"></video></div></div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、これらは単純な例でした。</font><font style="vertical-align: inherit;">フクロウを描く時が来ました！</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトの変形</font></font></h3><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お使いのブラウザはHTML5ビデオをサポートしていません。</font></font><source src="https://media.giphy.com/media/pOwf43ETsackhG30CA/giphy.mp4" type="video/mp4"></video></div></div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセスの数学とそのような効果を開発するときの思考の論理の詳細な分析とともに、1つの変形効果のトピックに関する記事全体をすでに書きました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。Habr.com/ en / post / 435828</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これが私たちのフクロウになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事のすべてのシェーダーはhlslで記述されています。この言語には実際には独自の膨大なドキュメントがあり、HLSL </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.microsoft.com/en-us/windows/win32/direct3dhlsl/dx-graphics-hlsl-組み込み関数</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、実際には、ユニット内のサーフェスシェーダーは、それ自体が大きくて膨大なトピックです。</font><font style="vertical-align: inherit;">さらに、Unityライティングを常にいじりたいとは限りません。</font><font style="vertical-align: inherit;">場合によっては、正しい事前定義されたエフェクトのセットのみを備えた最速のシェーダーをだまして作成する必要があります。</font><font style="vertical-align: inherit;">ユニットでは、下位レベルのシェーダーを記述できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">低レベルシェーダー</font></font></h3><br>
<br>
<img src="https://habrastorage.org/webt/k6/xx/bm/k6xxbmwnws5jw0bjy181o3q9ome.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シェーダーを使用する古き良き伝統に従って、以下ではスタンフォードウサギを苦しめます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、いわゆるUnity ShaderLabは本質的に、マテリアル内のフィールドを使用したインスペクターの視覚化であり、シェーダーの記述を単純化しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Shaderlabシェーダーの一般的な構造を取り上げます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的なシェーダー構造</font></font></b><div class="spoiler_text"><code>Shader "MyShaderName"<br>
{<br>
 Properties<br>
 {<br>
 //  <br>
 }<br>
 SubShader //     (   ) <br>
 {<br>
 Pass<br>
 {<br>
 //  <br>
 }<br>
 //       <br>
 }<br>
 //    <br>
 FallBack "VertexLit" //         ,    <br>
}<br>
</code><br>
</div></div><br><font style="vertical-align: inherit;"></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#pragma vertex vert </font></font></i><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#pragma fragment frag</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
などのコンパイルディレクティブは</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 、それぞれ頂点シェーダーおよびフラグメントシェーダーとしてコンパイルするシェーダー関数を決定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も一般的な例の1つである法線の色を表示するシェーダーを取り上げます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleNormalVisualization</font></font></b><div class="spoiler_text"><code>Shader "Custom/SimpleNormalVisualization"<br>
{<br>
 Properties<br>
 {<br>
 }<br>
 SubShader<br>
 {<br>
 Pass<br>
 {<br>
 CGPROGRAM<br>
<br>
#pragma vertex vert<br>
 #pragma fragment frag<br>
 <br>
 #include "UnityCG.cginc"<br>
<br>
struct v2f {<br>
 float4 pos : SV_POSITION;<br>
 fixed3 color : COLOR0;<br>
 };<br>
<br>
v2f vert (appdata_base v)<br>
 {<br>
 v2f o;<br>
 o.pos = UnityObjectToClipPos(v.vertex);<br>
 o.color = v.normal * 0.5 + 0.5;<br>
 return o;<br>
 }<br>
 <br>
 fixed4 frag (v2f i) : SV_Target<br>
 {<br>
 return fixed4 (i.color, 1);<br>
 }<br>
 ENDCG<br>
 }<br>
 }<br>
 FallBack "VertexLit"<br>
}<br>
</code><br>
</div></div><br>
<img src="https://habrastorage.org/webt/5t/oy/wv/5toywvw0cewffefffvw5xfvtj60.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、頂点部分では、変換された法線値を頂点色に書き込み、ピクセル部分では、この色をモデルの色として使用します。</font><i><font style="vertical-align: inherit;">UnityObjectToClipPos</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、オブジェクトの頂点をカメラに関連付けられた位置に変換する</font><font style="vertical-align: inherit;">（</font><i><font style="vertical-align: inherit;">UnityCG.cginc</font></i><font style="vertical-align: inherit;">ファイルからの</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">補助Unity関数</font><font style="vertical-align: inherit;">です。これがない場合、オブジェクトは、カメラの可視性（錐台）に入ると、変換の位置に関係なく、画面の座標で描画されます。最初から、頂点の位置はオブジェクトの座標で表示されます。彼のピボットに関連する値だけです。</font><font style="vertical-align: inherit;">
このブロック。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<code> struct v2f {<br>
 float4 pos : SV_POSITION;<br>
 fixed3 color : COLOR0;<br>
 };</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、頂点部分で処理され、フラグメント部分に転送される構造の定義です。</font><font style="vertical-align: inherit;">この場合、メッシュから2つのパラメーター（頂点の位置と頂点の色）が取得されると定義されています。</font><font style="vertical-align: inherit;">ユニットでスローできるデータの詳細については、このリンク</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.unity3d.com/Manual/SL-VertexProgramInputs.html</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
重要な説明を</font><font style="vertical-align: inherit;">参照してください</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">メッシュ属性の名前は重要ではありません。</font><font style="vertical-align: inherit;">つまり、カラー属性に、元の位置からの偏差のベクトルを書き込むことができるとしましょう（このようにして、キャラクターが歩いているときに、草が「反発」するように効果が出る場合があります）。</font><font style="vertical-align: inherit;">この属性の処理方法は、シェーダーに完全に依存しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご清聴ありがとうございました！</font><font style="vertical-align: inherit;">いくつかの複雑な効果を書くことは、断片的な部分なしでは問題があります。このため、別の記事で同様のことについて説明します。</font><font style="vertical-align: inherit;">この記事の中で、頂点シェーダーのコードが一般的にどのように記述されているか、またシェーダーは非常に深いトピックであるため、研究のための情報をどこに見つけることができるかが少し明確になったことを願っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今後の記事では、他のタイプのシェーダー、個々のエフェクトを分析し、新しいエフェクトや複雑なエフェクトを作成するときの私の考え方のロジックについて説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシリーズの記事</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/Nox7atra/ShaderExamplesの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての結果が追加されるリポジトリも作成されています。</font><font style="vertical-align: inherit;">この情報が、このトピックの学習を始めたばかりの初心者に役立つことを願っています。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかの便利なリンク（ソースを含む）：</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.khronos.org/opengl/wiki/Vertex_Shader </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.microsoft.com/en-us/windows/win32/direct3dhlsl/dx-graphics-hlsl-reference </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.unity3d.com/en/current/Manual/SL-Reference。 html </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.unity3d.com/Manual/GraphicsTutorials.html </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.malbred.com/3d-grafika-3d-redaktory/sovremennaya-terminologiya-3d-grafiki/vertex-shader-vershinnyy-sheyder.html </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3dpapa.ru/accurate-displacement -ワークフロー</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja474796/index.html">モノのインターネットとは何ですか？それは企業がより多くを稼ぐのにどのように役立ちますか？</a></li>
<li><a href="../ja474800/index.html">.NET Coreのパフォーマンス</a></li>
<li><a href="../ja474804/index.html">スポーツにおけるロシアの技術進歩：ニューラルインターフェース、IPカメラ、スポーツCRM、レーシングカーのBigData</a></li>
<li><a href="../ja474806/index.html">GoogleからのUDPフラッド、またはすべてのYouTubeを奪わないための方法</a></li>
<li><a href="../ja474808/index.html">Rust 1.39.0リリース：async / await、関数パラメーターの属性、新しい定数関数</a></li>
<li><a href="../ja474814/index.html">Древности: вестник тлена или незапланированное устаревание</a></li>
<li><a href="../ja474816/index.html">ペットプロジェクト-小さな人生</a></li>
<li><a href="../ja474818/index.html">CSSに乱数はありますか？</a></li>
<li><a href="../ja474822/index.html">WISE-PaaS-産業用モノのインターネットのためのクラウドプラットフォーム</a></li>
<li><a href="../ja474826/index.html">Markdownの通常のテーブル</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>