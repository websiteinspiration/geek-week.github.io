<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÖüèæ üóúÔ∏è üî§ How to implement ignore blocked users in Telegram groups? üßê üë®üèø‚Äçüè≠ üñïüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="UPD: thanks to help Tkachovthis article still turned from a request for help into a working instruction. In the comments, he gave a working code for c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How to implement ignore blocked users in Telegram groups?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487512/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/n8/lx/it/n8lxiti0sdes3qvykd6fxu5smas.png" alt="image alt"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD: thanks to help </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tkachov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this article still turned from a request for help into a working instruction. In the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comments,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> he gave a working code for creating an ignore in the Telegram desktop client. Just in case, I‚Äôll put an explanation at the end of the article. Further, the article continues in the same form in which it was written. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* * * </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I would like to ask the community for help, because I have completely exhausted all my own possibilities. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One could ask a question on the Q&amp;A service (aka former Toaster) - only I have already done this, and not much has come out of it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nevertheless, just asking a question under the guise of an article seems to me not very correct. Therefore, I will try to add the background of the whole process to the text and tell what steps have already been taken.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you're lucky, someone in the comments will tell you the solution. </font><font style="vertical-align: inherit;">And then those who find this article in the search engines will also be able to solve this problem.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem and Background</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As all Telegram users are well aware, in the group chats of this messenger there is no user ignore function. You can block a user who is unpleasant to you, but this just prohibits him from writing you private messages. In group chat - and now group chats seem to accommodate up to 10 thousand users - you simply </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">have to</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> see everything that other members of the group have thrown off. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the ‚ÄúBlack Mirror‚Äù there was even a series about it. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/9h/lk/zr9hlk0liyhnvaexdinjwkpsgna.png"><br>
<sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keep watching! Keep watching! Keep watching!</font></font></i></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
If we try to find a solution to this problem on the Internet, we will encounter a typical war story of a large corporation and a small group of disgruntled people. The stages of this war are clearly visible on Github. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">first request for this feature from 2015.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can find links to the following topics in this thread, people constantly asked for this feature in the following years, but each call turned out to be closed with a rather stupid answer ‚ÄúThis is not a client problem, but an API problem‚Äù. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is not even clear for the programmer that the data is shown to the user using the client. And even if the API sends you all the messages from the server - there is no problem hiding some of them on the client side. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But for five years now, every year, and sometimes several times a year, people get to Github with a request to introduce ignore in groups - and each time they are refused and the topic closed. More than six months ago, apparently tired of the constant requirements, the developers </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">posted a non-binding excuse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : they say, yes, yes, we will do everything, someday in the distant future.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o8/vg/u7/o8vgu7sadj-sdregj1scnma6lz8.png"><br>
<sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I heard you! I just voiced it until I‚Äôm ready to answer you, let‚Äôs say, I understand your position. Come on, call, don't get lost!</font></font></i></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
There is exactly one benefit from this excuse - now tdesktop administrators on Github refer to this message for all complaints. Say - look, they know everything, they will do everything, I'm sorry, the branch is closed. Over the past six months, a lot of time-consuming changes took place in the telegram, for example, animated stickers and BEAUTIFUL waving forms for polls were added to the chats. But no ignore came even close. I think it will not appear in a year.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the same time, the situation looks even a little sinister - there is a feeling that it is forbidden to introduce this function with any special instructions for official forks. Telegram has at least a dozen well-known forks (like Unigram) and a hundred little-known forks, but none of them have this feature. I wrote in support of the most popular forks, but received no response. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the same time manage with blocked users client-side messages </font></font><u><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be</font></font></b></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is confirmed by the existence of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegreat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is a fork of Telegram, in which the option to ignore blocked users was declared.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alas, this ignore is not real. All that the option ‚ÄúIgnore blocked users‚Äù does is colorizes the text of messages of blocked users in gray. Pictures, videos, music or stickers from blocked users are still visible; In addition, the gray color on dark topics is perfectly readable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
People regularly come to a chat to the developer, where I sat for a while, and ask to make a ‚Äúreal ignore‚Äù. Previously, he simply refused; in the last six months, he completely abandoned his project, because he "has no time." Well, this is a common thing for free open source projects. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I mention this project for two reasons.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firstly, it is advertised precisely as a ‚Äúclient with an ignore function‚Äù and it is advised by people who read only the description, not knowing how this ‚Äúignore‚Äù is actually implemented there. </font><font style="vertical-align: inherit;">As mentioned above, this function does not work.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secondly, it is a living confirmation that in the Telegram client it is possible to determine the message of a blocked user and change it. </font><font style="vertical-align: inherit;">That is, in fact, ignore on the client side is possible.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, no one does this. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Best of all, my feelings are conveyed in a commentary on a similar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">topic on Reddit four years ago:</font></font></a><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I'm shocked you can't do it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seriously? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If I just don't want to read anything some user writes I should be able to do so ... it's like, one of the very basic features of every communication protocols EVER! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You could do it in the 90s with emails and newsgroups!</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moreover, wherever we talk about the reasons for the absence of a player, the same things are repeated: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - You will not see all the messages and because of this you will not understand what is happening in the chat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - You will duplicate messages. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - The functionality of the system of ‚Äúanswers‚Äù ‚Äã‚Äãwill be violated. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And, again, I use a quote, just to show you - these are not my personal thoughts, this is our common position, people who want to introduce this function:</font></font><br>
<blockquote><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">I can assure you 100.00% of people asking for this feature, are fully aware of the side effects it has, and could not care less about those.<br>
<br>
Yes just not show it at all. Yes including if it's a reply. Yes if the admin needs to see everything to moderate, then they don't have the luxury of using ignore. And most certainly we can compare TG groups to IRC, because they are both a mechanism for accomplishing the same thing, namely multi-user communication.</a></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is just a life example regarding duplication - I sit in several telegram chats and during the day </font><font style="vertical-align: inherit;">several users </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">always</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> throw the same news / funny screenshot / fresh popular meme into the chat. Despite the fact that before them it was already. Despite the fact that there is no ignore, they still just do not read the chat history and duplicate messages. About how people do not know how to use the search on the forums, and repeatedly repeat the same questions - I will not even mention it, most readers probably have come across this. Again, without any ignorance, this problem already exists. And ignore her will not aggravate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So why </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this function really not exist?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, the conspiracy thesis says that the main goal of the Telegram is to collect personal data and user interaction graphs. In this sense, each telegram group allows you to fix a typical small group, which the user can at least withstand, and which can withstand it. Otherwise, either he is thrown out of the group, or he leaves himself. The introduction of ignore will violate the purity of the experiment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The marketing version is a little easier.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When Khaled Mardam Bay created mIRC in 1995, he wrote a program for people. I mean, for independent people who know what they want, they choose what they think is right and are responsible for the consequences of their actions. On the one hand, this caused problems, for example, with scripted vulnerabilities - you run a line with commands and that's it, you are hacked. On the other hand, it was a messenger that was used by adults and responsible people. And they knew how to exist in a chat with ignore, where some of the messages are simply not visible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When in 2013 Pasha Durov made Telegram, he made the program ‚Äúfor housewives‚Äù. For a dumb mass user who needs a good guardian. Hence, all this registration by phone number, sending messages to everyone on the phone book, flags and prohibitions from all sides. After all, they ‚Äúpress something and everything disappears!‚Äù. And then they will write complaints in support! Hence such stupid excuses - "because if you turn on ignore, then you will not see other people's messages." When you make a mass product - you are forced to limit any functionality. The product for the fool must have protection against the fool.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here comes the crown argument, which is always given at the end: "Do not like it - don‚Äôt use it like that." </font><font style="vertical-align: inherit;">I will not explain what is wrong with him, this is an ethical question of the format ‚Äúwhy people should not be eaten‚Äù - whoever asks him is meaningless to explain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But in the case of Telegram, this argument is slightly modified: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"I do not like it - do it as you like, it's open source</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">"</font></b></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attempt to solve</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tired of many years of searching, I decided to really try to change something on my own. </font><font style="vertical-align: inherit;">It seemed to me a good idea to make my own assembly of the Telegram. </font><font style="vertical-align: inherit;">Not in the sense of a public assembly, with a website and placement in the application store, but simply compiling the application for yourself and using it yourself. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this sense, I would not be bothered by any possible ‚Äúbrakes‚Äù from hiding messages, nor the ‚Äúproblem of losing context in the conversation‚Äù, nor the problem of ‚Äúhow to administer the chat if you do not see part of the messages‚Äù. </font><font style="vertical-align: inherit;">All this did not interest me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seemed obvious to me that just adding a line like this:</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if message.author.isBlocked == true then message.value = 'The message from blocked user'</font></font></b></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sorry for the pseudo-code, but it seems to me that it conveys the idea correctly. I just wanted to catch any message at the very early stage, when it only comes from the server, and replace it with a line about blocking. Thus, the problem would be solved with pictures / stickers / gifs - they would also be replaced with such a message and they would not be visible. And even if someone replied to or quoted a message, it would still be replaced. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But where to start? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After asking friends of programmers, I found out that there are two ways. The first is to use the native Telegram client, and the second is to use a third-party client that is written using the newer TDLib library. I went to the question service mentioned at the beginning of the article and asked a </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">question</font></a><font style="vertical-align: inherit;"> there</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. As you can see, the line of respondents is not lined up. The only thread led to the Kotatogram messenger. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I talked with the creator of this messenger, and he gave me two useful tips. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Firstly, he said that messages in the native client are displayed in the usual way, and are not generated (I, however, suspected this with the Telegreat example) - therefore, you can use the native client as the source. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secondly, he told where to look for the message output itself - in the history_message block. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unfortunately, he, like the creator of Telegreat, also did not have free time to independently add the ignore function, which is to his client, which is for me.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How did I proceed next? </font><font style="vertical-align: inherit;">Assembly instructions exist on Github, but it does not reflect all stages of work. </font><font style="vertical-align: inherit;">I will describe them here, in case someone else comes to the article who is not particularly familiar with programming, but who wants to make the same client with ignore for himself:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I decided to do everything in a virtual machine. </font><font style="vertical-align: inherit;">To do this, I installed Oracle VM Virtual Box for myself and downloaded </font><font style="vertical-align: inherit;">their official virtual machine with preinstalled Windows 10 and Visual Studio 2019 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from the official Microsoft website</font></font></a><font style="vertical-align: inherit;"></font></li>
<li>      Visual Studio.  ,       C++,    Visual Studio Installer   .    Modify     C++,     .           QT <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"></a>.</li>
<li>    Git c <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">git-scm.com</a></li>
<li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  </a>. <b>  !</b> </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are 2 sections of teams. </font><font style="vertical-align: inherit;">And if the first section contains about a dozen commands that are easy to copy and paste into the command line, then for the second section of several dozen commands, it seems natural to copy all the code into a bat-file and run it. </font><font style="vertical-align: inherit;">This is a mistake, because the process stops at least twice. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first stop occurs after the line:</font></font><br>
<br>
<pre><code class="plaintext hljs">gyp --no-circular-check breakpad_client.gyp --format=ninja</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second is after the fourth line from the end, the long QT configuration instruction:</font></font><br>
<br>
<pre><code class="plaintext hljs">configure -prefix "%LibrariesPath%\Qt-5.12.5" ....... </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As my friends told me, this is due to the fact that during the execution of these commands other bat-files are launched, in which a direct exit from the process is already registered. </font><font style="vertical-align: inherit;">As a result, you either need to simply copy and paste the commands, or split the instruction into 3 bat files (but in this case, remember that the commands should continue to be executed from the same directory in which the process stopped!). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Getting your own api_id is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">also described on Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ultimately, I compiled a fully working Telegram exe file. </font><font style="vertical-align: inherit;">In total, the assembly takes about three hours (not counting the preliminary downloads and installations), perhaps this time depends on the computer's power.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hall help (and solution found)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And here finally my request to the habrasociety appears. As readers have already guessed, I do not know what and how to change. It seems to me that I found a place where the message is displayed, but I'm not sure, because I do not know C ++. Not to mention that (perhaps) it would be correct to change something not in history_message, but somewhere in history_item. </font><sub><i><font style="vertical-align: inherit;">‚ÄúSomething in Elvish, I can‚Äôt read‚Äù</font></i></sub><font style="vertical-align: inherit;"> 
Maybe someone here has already encountered the Telegram code or just has a very developed skill and can write the very same line with the replacement of any message from a blocked user, and also say where to put it in this code.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/wx/r6/el/wxr6el7uy7ed5dhp2fexr-9yhli.png"></a><br>
<sub><i><font style="vertical-align: inherit;"></font></i></sub><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I suppose that the telegram‚Äôs withdrawal mechanism itself will not suddenly change. </font><font style="vertical-align: inherit;">So when updating the client, I will just download the updated version from the github and add this line again with a lock before compiling. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD: As I mentioned at the beginning of the article, </font><font style="vertical-align: inherit;">a working version of the code appeared </font><font style="vertical-align: inherit;">in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comments</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">I bring it directly to the article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first part of the code replaces the text with another message. </font><font style="vertical-align: inherit;">This is necessary because </font><font style="vertical-align: inherit;">this text is visible in quotes if another user answers the blocked one, or on the left in the chat window, where the latest messages in group chats are displayed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the file History_Message.cpp we find the function just in the same place as in the screenshot above:</font></font><br>
<br>
<pre><code class="cpp hljs">HistoryMessage::HistoryMessage(<font></font>
	not_null&lt;History*&gt; history,<font></font>
	<span class="hljs-keyword">const</span> MTPDmessage &amp;data,<font></font>
	MTPDmessage_ClientFlags clientFlags)<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And inside we replace the original text:</font></font><br>
<br>
<pre><code class="cpp hljs">	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> media = data.vmedia()) {<font></font>
		setMedia(*media);<font></font>
	}<font></font>
	setText({<font></font>
		TextUtilities::Clean(qs(data.vmessage())),<font></font>
		Api::EntitiesFromMTP(data.ventities().value_or_empty())<font></font>
	});</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On advanced:</font></font><br>
<br>
<pre><code class="cpp hljs"><font></font>
	UserId from = data.vfrom_id().value_or_empty();<font></font>
	PeerData* pd = from ? history-&gt;owner().user(from) : history-&gt;peer;<font></font>
	<span class="hljs-keyword">if</span> (pd-&gt;isUser() &amp;&amp; pd-&gt;asUser()-&gt;isBlocked()) {<font></font>
		setText({<font></font>
			TextUtilities::Clean(qs(<span class="hljs-string">"The message from blocked user"</span>)),<font></font>
			Api::EntitiesFromMTP(data.ventities().value_or_empty())<font></font>
			});<font></font>
	}<font></font>
	<span class="hljs-keyword">else</span> {
		<span class="hljs-comment">//   442-448:</span>
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> media = data.vmedia()) {<font></font>
			setMedia(*media);<font></font>
		}<font></font>
		setText({<font></font>
			TextUtilities::Clean(qs(data.vmessage())),<font></font>
			Api::EntitiesFromMTP(data.ventities().value_or_empty())<font></font>
			});<font></font>
	}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you use only this code, the old messages of blocked users will be visible, but the new ones will no longer be. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, the second part of the solution mentioned in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comment </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
adds the following code to the history_view_message.cpp file:</font></font><br>
<br>
<pre><code class="cpp hljs">PeerData* pd = item-&gt;from();
<span class="hljs-keyword">if</span> (pd-&gt;isUser() &amp;&amp; pd-&gt;asUser()-&gt;isBlocked()) <span class="hljs-keyword">return</span>;</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD: in the new version, the compiler swears on an empty return, so I added the output of QSize (0,0)</font></font><br>
<pre><code class="cpp hljs">PeerData* pd = item-&gt;from();
<span class="hljs-keyword">if</span> (pd-&gt;isUser() &amp;&amp; pd-&gt;asUser()-&gt;isBlocked()) <span class="hljs-keyword">return</span> QSize(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Immediately after declaring the item variable in the </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
QSize Message :: performCountOptimalSize () </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
void Message :: draw ( </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Painter &amp; p, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 QRect clip, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 TextSelection selection, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 crl :: time ms) </font><font style="vertical-align: inherit;">functions, </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
this will completely prevent the messages from blocked users in the chat log. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Important addition:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If suddenly the messages of the blocked user are still visible - you just need to click on his profile, the information that he is blocked will be updated, and all his messages will disappear from the chat log. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For those who wish, he added a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compiled application</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to Dropbox </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">.</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
UPD: Made a ‚Äúsite‚Äù for distributing </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sites.google.com/view/ignoram</font></font></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487498/index.html">Choosing a database for analytics</a></li>
<li><a href="../en487502/index.html">Polling print devices using SNMP while the printer is printing</a></li>
<li><a href="../en487504/index.html">By the Day of Russian Science, the best achievements of domestic scientists of 2019 are named</a></li>
<li><a href="../en487508/index.html">Measuring distance to objects using RealSense D435</a></li>
<li><a href="../en487510/index.html">Radioactive products. Gamma spectrometer. Part 1</a></li>
<li><a href="../en487514/index.html">Qrator Labs Annual Network Security and Availability Report</a></li>
<li><a href="../en487516/index.html">Hunting techniques and tactics of attackers using Prefetch files</a></li>
<li><a href="../en487518/index.html">Radioactive products. Gamma spectrometer. Part 2</a></li>
<li><a href="../en487522/index.html">We make the terminal fly (part 1)</a></li>
<li><a href="../en487524/index.html">Why does a hardware startup hackathon need</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>