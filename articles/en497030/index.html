<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèº ‚õ∞Ô∏è üèÇüèø Experience in implementing network factories based on EVPN VXLAN and Cisco ACI and a small comparison üö£üèª üë©üèº‚Äçüíº ‚≠êÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rate the ligaments in the middle of the chart. We will return to them below.
 
 At some point, you may encounter the fact that large complex networks ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Experience in implementing network factories based on EVPN VXLAN and Cisco ACI and a small comparison</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/technoserv/blog/497030/"><img src="https://habrastorage.org/webt/lm/g1/e3/lmg1e3x6aykybvn_h9hdjagbaf4.gif"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rate the ligaments in the middle of the chart. </font><font style="vertical-align: inherit;">We will return to them below.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
At some point, you may encounter the fact that large complex networks based on L2 are terminally ill. </font><font style="vertical-align: inherit;">First of all, problems associated with the processing of BUM traffic and with the operation of the STP protocol. </font><font style="vertical-align: inherit;">The second - as a whole morally obsolete architecture. </font><font style="vertical-align: inherit;">This causes unpleasant problems in the form of downtimes and inconvenience to manageability. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We had two parallel projects where customers soberly evaluated all the pros and cons of the options and chose two different overlay solutions, and we implemented them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It was possible to compare exactly the implementation. </font><font style="vertical-align: inherit;">Not exploitation, it‚Äôs worth talking about it in two or three years. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So what is an overlay network factory and SDN?</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What to do with the sore problems of the classical network architecture?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Every year new technologies and ideas appear. In practice, the hot need to rebuild networks has not arisen for quite some time, because you can also do everything by hand using the good old grandfather methods. So what about the twenty-first century? In the end, the admin should work, not sit in his office. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then the boom of building large-scale data centers began. Then it became clear that the limit of development of classical architecture was reached not only in terms of performance, fault tolerance, scalability. And one of the options for solving these problems was the idea of ‚Äã‚Äãbuilding superimposed networks on top of the routed backbone.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, with the increasing scale of networks, the problem of managing such factories became acute, as a result of which solutions of software-defined networks began to appear with the ability to manage the entire network infrastructure as a whole. And when the network is managed from a single point, it is easier for other components of the IT infrastructure to interact with it, and such interaction processes are easier to automate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Almost every major manufacturer of not only network equipment, but also virtualization, has in its portfolio options for such solutions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It remains only to figure out what is suitable for what needs. </font><font style="vertical-align: inherit;">For example, for especially large companies with a good development and operation team, vendor-based box solutions do not always satisfy all needs, and they resort to developing their own SD (software defined) solutions. </font><font style="vertical-align: inherit;">For example, these are cloud providers that are constantly expanding the range of services provided to their customers, and boxed solutions are simply not able to keep up with their needs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For medium-sized companies, the functionality offered by the vendor in the form of a boxed solution is enough in 99 percent of cases.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is Overlay Networking?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What is the idea of ‚Äã‚Äãoverlay networks? In essence, you take a classic routed network and build another network on top of it to get more features. Most often, we are talking about the effective distribution of the load on equipment and communication lines, a significant increase in the scalability limit, increased reliability and a bunch of security buns (due to segmentation). And SDN solutions in addition to this provide an opportunity for a very, very, very convenient flexible administration and make the network more transparent for its consumers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, if local networks were invented in the years of the 2010s, then they would not look like the ones that we inherited from the military from the 1970s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From the point of view of technologies for building factories using superimposed networks, there are currently many implementations of manufacturers and Internet projects RFC (EVPN + VXLAN, EVPN + MPLS, EVPN + MPLSoGRE, EVPN + Geneve and others). Yes, there are standards, but the implementation of these standards by different manufacturers may differ, therefore, when creating such factories, it is still possible to completely abandon vendor-lock only in theory on paper. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With the SD solution, things are even more confusing, each vendor has its own vision. There are completely open solutions that, in theory, you can finish yourself, there are completely closed ones.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cisco offers its own SDN option for data centers - ACI. Naturally, this is a 100% vendor-lock solution in terms of the choice of network equipment, but at the same time it is fully integrated with virtualization, containerization, security, orchestration, load balancers, etc. But in essence it is still a kind of black box, without the possibility of full access to all internal processes. Not all customers agree to this option, since you completely depend on the quality of the written solution code and its implementation, but on the other hand, the manufacturer has one of the best technical support in the world and has a dedicated team that deals only with this solution. It was Cisco ACI that was chosen as the solution for the first project.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The solution for Juniper was chosen for the second project. </font><font style="vertical-align: inherit;">The manufacturer also has its own SDN for the data center, but the customer decided to abandon the implementation of SDN. </font><font style="vertical-align: inherit;">The EVPN VXLAN factory without the use of centralized controllers was chosen as the technology for building the network.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why do you need</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creating a factory allows you to build an easily scalable, fault-tolerant, reliable network. The architecture (leaf-spine) takes into account the features of data centers (traffic paths, minimizing delays and network bottlenecks). SD solutions in data centers make it possible to conveniently, quickly, flexibly manage such a factory and integrate it into the data center ecosystem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Both customers needed to build backup data centers to ensure fault tolerance, in addition, traffic between the data centers had to be encrypted. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first customer already considered solutions without a factory as a possible standard for their networks, but in tests they had problems with STP compatibility between several hardware vendors. There were downtimes that caused service drops. And for the customer it was critical.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cisco was already the corporate standard of the customer, they looked at ACI and other options and decided that it was worth taking this solution. I liked the automation of control with one button through a single controller. Services are configured faster, managed faster. They decided to provide traffic encryption by running MACSec between the IPN and SPINE switches. Thus, we managed to avoid a bottleneck in the form of a crypto-gateway, save on them and use the maximum bandwidth.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second customer chose a solution without a controller from Juniper, because in their existing data center there was already a small installation with the implementation of the EVPN VXLAN factory. But there it was not fault-tolerant (one switch was used). They decided to expand the infrastructure of the main data center and build a factory in the backup data center. The existing EVPN was not fully used: VXLAN encapsulation was not actually used, since all hosts were connected to one switch, and all MAC addresses and / 32 host addresses were local, the same switch was a gateway for them, there were no other devices, where it was necessary to build VXLAN tunnels. They decided to provide traffic encryption using IPSEC technology between firewalls (ITU performance was sufficient).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They also felt ACI, but decided that because of the vendor lock they would have to buy too much iron, including replacing recently purchased new equipment, and this just does not make economic sense. </font><font style="vertical-align: inherit;">Yes, the Cisco factory integrates with everything, but only its devices are possible inside the factory itself. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the other hand, as they said earlier, EVPN VXLAN factory just can‚Äôt mix with any neighboring vendor, because protocol implementations are different. </font><font style="vertical-align: inherit;">It's like crossing Cisco and Huawei on the same network - it seems that the standards are common, only you have to dance with a tambourine. </font><font style="vertical-align: inherit;">Since this is a bank, and compatibility tests would be very long, they decided that it is better to purchase the same vendor now, and not really get carried away with functionality outside the base.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migration plan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Two ACI-based data </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vl/2d/ko/vl2dkovftrnj3nibbzsohv2ohmg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
centers </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Organization of interaction between data centers. Multi-Pod solution selected - each data center is a hearth. The requirements for scaling in the number of switches and for delays between the hearths (RTT less than 50 ms) were taken into account. It was decided not to build a Multi-Site solution for ease of management (for a Multi-Pod solution, a single management interface is used, for a Multi-Site there would be two interfaces, or a Multi-Site Orchestrator would be required), and since geographic reservation of sites was not required. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/dv/p9/l9/dvp9l9nxgykdkezfjijl_78xxfc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From the point of view of migration of services from the Legacy network, the most transparent option was chosen, to gradually transfer VLANs corresponding to certain services.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For migration, each VLAN was created with the corresponding EPG (End-point-group) in the factory. </font><font style="vertical-align: inherit;">First, the network was stretched between the old network and the factory via L2, then after all the hosts were migrated, the gateway was transferred to the factory, and the EPG interacted with the existing network through L3OUT, and the interaction between L3OUT and EPG was described using contracts. </font><font style="vertical-align: inherit;">Sample schema: The </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xv/bw/ud/xvbwudyrejpamzsr-6ci2gzdpxo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sample structure of most ACI factory policies in the figure below. </font><font style="vertical-align: inherit;">The whole configuration is based on policies embedded in other policies and so on. </font><font style="vertical-align: inherit;">At first it‚Äôs very difficult to figure it out, but gradually, as practice shows, network administrators get used to such a structure in about a month, and then only comes to an understanding of how convenient it is.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/6k/mo/fj6kmo-wea0276rf3e7o1tp-i94.gif"><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparison</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the Cisco ACI solution, you need to buy more equipment (separate switches for Inter-Pod interaction and APIC controllers), which made it more expensive. Juniper's solution did not require the purchase of controllers and accessories; It turned out to partially use the existing customer equipment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the architecture of the EVPN VXLAN factory for two data centers of the second project:</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/_x/9w/zt/_x9wzt9cwwtpy03rusumpwnylac.png"><br>
<img src="https://habrastorage.org/webt/k1/gg/o8/k1ggo8qkpapr6pjk5qviylzegvk.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In ACI you get a ready-made solution - no need to pick, no need to optimize. At the initial acquaintance of the customer with the factory, developers are not needed; supportive people are not needed for code and automation. It‚Äôs quite simple to operate, many settings can be done generally through the wizard, which is not always a plus, especially for people who are used to the command line. In any case, it takes time to rebuild the brain on new tracks, on the feature of settings through policies and on the operation of many policies nested in each other. In addition, it is very desirable to have a clear structure for the names of policies and objects. If there is any problem in the logic of the controller, it can only be solved through technical support.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In EVPN, a console. Suffer or rejoice. The familiar interface for the old guard. Yes, there is a typical configuration and guides. Have to smoke mana. Different designs, everything is clear and detailed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturally, in both cases it is better to migrate not the most critical services, for example, test environments, during migration, and only then, after catching all the bugs, proceed to production. And do not tune in on Friday night. You should not trust the vendor that everything will be ok, it is always better to play it safe.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You pay more on ACI, although Cisco is currently actively promoting this solution and often gives good discounts on it, but you save on maintenance ‚Äî maintenance. Management and any automation of an EVPN factory without a controller requires investments and regular expenses - monitoring, automation, implementation of new services. At the same time, the initial launch at ACI is 30-40 percent longer. This is because the whole set of necessary profiles and policies is created longer, which will then be used. But as the network grows, the number of required configurations decreases. Use the already created policies, profiles, objects. You can flexibly configure segmentation and security, centrally manage contracts that are responsible for allowing certain interactions between EPGs - the volume of work drops sharply.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In EVPN, each device in the factory must be configured, the probability of error is greater. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If ACI is slower to deploy, then EVPN has been debugging almost twice as long. If in the case of Cisco you can always call a support engineer and ask about the network as a whole (because it is covered as a solution), then from Juniper Networks you buy only hardware, and it is covered by it. Are the packets from the device gone? Well ok, then your problems. But you can open the question of choosing a solution or designing a network - and then they will advise you to purchase a professional service, for an additional fee.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ACI support is very cool because it is separate: a separate team sits just for this. </font><font style="vertical-align: inherit;">There are, including Russian-speaking specialists. </font><font style="vertical-align: inherit;">Hyde detailed, decisions are predetermined. </font><font style="vertical-align: inherit;">They look and advise. </font><font style="vertical-align: inherit;">Design validates quickly, which is often important. </font><font style="vertical-align: inherit;">Juniper Networks are doing the same thing, but at times slower (we had it, it should be better now, it‚Äôs rumored), which forces you to do everything yourself where your solution engineer could advise.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cisco ACI supports integration with virtualization and containerization systems (VMware, Kubernetes, Hyper-V) and centralized management. </font><font style="vertical-align: inherit;">There are network and security services - balancing, firewalls, WAF, IPS and more ... Good micro-segmentation out of the box. </font><font style="vertical-align: inherit;">In the second solution, integration with network services is done with a tambourine, and it is better to smoke forums with those who did this in advance.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For each specific case, it is necessary to select a solution, not only based on the cost of the equipment, but also need to take into account further operating costs and the main problems that the customer is facing now, and what are the plans for the development of IT infrastructure. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ACI due to additional equipment came out more expensive, but the solution is ready without the need for finishing, the second solution is more complicated and costly from the point of view of operation, but cheaper. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to discuss how much it can cost to implement a network factory on different vendors, and what kind of architecture is needed, you can meet and talk. </font><font style="vertical-align: inherit;">Before the rough draft of architecture (with which budgets can be considered) we will show you for free, a detailed study, of course, is already paid.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vladimir Klepce, corporate networks.</font></font></blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497016/index.html">April 13th Java Digest</a></li>
<li><a href="../en497020/index.html">DocuSign, a popular digital signature service, now supports the GlobalSign infrastructure</a></li>
<li><a href="../en497022/index.html">Updating corporate network access. New ExtremeSwitching X435 Gigabit Switches</a></li>
<li><a href="../en497024/index.html">Why hyperconvergence? Cisco HyperFlex Overview and Tests</a></li>
<li><a href="../en497028/index.html">Welcome to Robot Operating System MeetUp</a></li>
<li><a href="../en497032/index.html">Service business and crisis: success stories. How does thinking outside the box work for you?</a></li>
<li><a href="../en497034/index.html">What is the new nRF Connect SDK for Nordic? Evolution, revolution or alternative?</a></li>
<li><a href="../en497036/index.html">When to stop the video sequence recognition process?</a></li>
<li><a href="../en497040/index.html">Product Led Growth Strategy. How Miro grows x3 annually</a></li>
<li><a href="../en497046/index.html">How to bring a site to the west in TOP10 without knowing anything about SEO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>