<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§úüèª üïñ üë∞üèΩ Perhitungan cepat rumus dari Excel dalam C # ‚è≠Ô∏è üî¢ üï∫üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seberapa sering Anda mendengar dari pelanggan bahwa mereka akan mengirim data ke Excel atau meminta Anda untuk mengimpor atau mengunggah dalam format ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Perhitungan cepat rumus dari Excel dalam C #</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/arcadia/blog/498032/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seberapa sering Anda mendengar dari pelanggan bahwa mereka akan mengirim data ke Excel atau meminta Anda untuk mengimpor atau mengunggah dalam format yang kompatibel dengan Excel? </font><font style="vertical-align: inherit;">Saya yakin bahwa di sebagian besar area, Excel adalah salah satu alat yang paling populer, kuat, dan sekaligus sederhana dan nyaman. </font><font style="vertical-align: inherit;">Tetapi titik yang paling bermasalah adalah selalu integrasi data tersebut dengan berbagai sistem otomatis. </font><font style="vertical-align: inherit;">Tim kami diminta untuk mempertimbangkan kemungkinan melakukan perhitungan data menggunakan pengaturan dari file Excel khusus.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/8g/to/wx/8gtowxbs0dnpmjvr59epns8b0sq.jpeg" alt="Perhitungan cepat rumus dari Excel dalam C #"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda perlu memilih perpustakaan yang produktif untuk bekerja dengan file Excel atau jika Anda mencari solusi untuk menghitung data keuangan yang kompleks (dan tidak hanya) dengan alat yang nyaman untuk mengelola dan memvisualisasikan rumus di luar kotak, selamat datang di cat.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mempelajari persyaratan proyek baru di perusahaan, kami menemukan satu hal yang sangat menarik: "Solusi yang dikembangkan harus dapat menghitung biaya produk (yaitu, balkon) ketika mengubah konfigurasi dan langsung menampilkan biaya baru pada antarmuka. Penting untuk menyediakan kemampuan untuk mengunduh file Excel dengan semua fungsi perhitungan dan daftar harga komponen. " Klien perlu mengembangkan portal untuk merancang konfigurasi balkon tergantung pada ukuran, bentuk, jenis kaca dan bahan yang digunakan, jenis pengikat, serta banyak parameter terkait lainnya yang digunakan untuk menghitung biaya produksi dan indikator keandalan yang tepat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memformalkan persyaratan input sehingga lebih mudah untuk memahami dalam konteks mana diperlukan untuk menyelesaikan masalah:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penghitungan cepat harga pada antarmuka saat mengubah parameter balkon;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perhitungan cepat data desain, termasuk berbagai konfigurasi balkon dan penawaran individual, disediakan oleh file perhitungan terpisah;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam jangka panjang - pengembangan fungsionalitas menggunakan berbagai operasi yang memakan sumber daya (tugas mengoptimalkan parameter, dll.)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua ini ada di server jauh dengan output melalui API, karena </font><font style="vertical-align: inherit;">Semua formula adalah properti intelektual pelanggan dan tidak boleh terlihat oleh pihak ketiga;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aliran data input dengan beban puncak: pengguna dapat sering dan cepat mengubah parameter untuk memilih konfigurasi produk sesuai dengan persyaratan mereka.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedengarannya sangat tidak biasa dan sangat menggoda, mari kita mulai!</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi turnkey dan persiapan data</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap penelitian untuk memecahkan masalah yang rumit dimulai dengan berselancar di StackOverflow, GitHub dan banyak forum mencari solusi yang sudah jadi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa solusi siap pakai dipilih yang mendukung pembacaan data dari file Excel, serta mampu melakukan perhitungan berdasarkan formula yang ditentukan di dalam perpustakaan. </font><font style="vertical-align: inherit;">Di antara perpustakaan-perpustakaan ini ada solusi gratis dan pengembangan komersial.&nbsp;</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perpustakaan</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tautan</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentasi</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lisensi</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 4</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/JanKallman/EPPlus</font></font></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/JanKallman/EPPlus/wiki</font></font></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lisensi Publik Umum Perpustakaan GNU&nbsp;</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 5</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/EPPlusSoftware/EPPlus</font></font></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/EPPlusSoftware/EPPlus/wiki</font></font></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lisensi Nonkomersial </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Polyform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.0.0 ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">www.epplussoftware.com/LicenseOverview</font></a><font style="vertical-align: inherit;"> )&nbsp;</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NPOI</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/tonyqus/npoi</font></font></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/tonyqus/npoi/wiki</font></font></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lisensi Apache 2.0</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puncak menara</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.e-iceblue.com/Introduce/excel-for-net-introduce.html</a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.e-iceblue.com/Tutorials/Spire.XLS/Spire.XLS-Program-Guide/Spire.XLS-Program-Guide-Content.html</a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.e-iceblue.com/Tutorials/Licensing/License-Agreement.html</a>&nbsp;</td>
</tr>
<tr>
<td><strong>Excel Interop</strong><i>(Microsoft.Office.Interop.Excel)</i></td>
<td>n/a</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">docs.microsoft.com/ru-ru/dotnet/api/microsoft.office.interop.excel._workbook?view=excel-pia</a></td>
<td><i>  Excel     </i></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah selanjutnya adalah menulis tes beban dan mengukur runtime dari masing-masing perpustakaan. Untuk melakukan ini, siapkan data uji. Kami membuat file Excel baru, menetapkan 10 sel untuk parameter input dan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satu</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ingat saat ini</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) formula untuk mendapatkan hasil yang menggunakan semua parameter input. Dalam rumus, kami mencoba menggunakan semua fungsi matematika yang mungkin dari berbagai kompleksitas komputasi dan menggabungkannya dengan cara yang rumit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu juga tentang uang (biaya produk), penting untuk melihat keakuratan hasil. Dalam hal ini, kami akan mengambil nilai yang dihasilkan yang diperoleh menggunakan </font><strong><font style="vertical-align: inherit;">Excel Interop</font></strong><font style="vertical-align: inherit;"> sebagai referensi</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">karena Data yang diperoleh dengan cara ini dihitung melalui inti Excel dan sama dengan nilai yang dilihat pelanggan ketika mengembangkan formula dan secara manual menghitung biaya.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai runtime referensi, kami akan menggunakan kode asli yang ditulis secara manual dalam C # murni untuk menampilkan rumus yang sama yang ditulis dalam Excel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formula Tes Awal Diterjemahkan:</font></font><br>
<br>
<pre><code class="plaintext hljs">public double Execute(double[] p)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return Math.Pow(p[0] * p[8] / p[4] * Math.Sin(p[5]) * Math.Cos(p[2]) +<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Math.Abs(p[1] - (p[2] + p[3] + p[4] + p[5] + p[6] + p[7] + p[8]))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Math.Sqrt(p[0] * p[0] + p[1] * p[1]) / 2.0 * Math.PI, p[9]);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami membentuk aliran data input acak untuk iterasi N (dalam hal ini, kami menggunakan 10.000 vektor). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memulai perhitungan untuk setiap vektor parameter input pada keseluruhan aliran, mendapatkan hasil dan mengukur waktu inisialisasi perpustakaan dan perhitungan umum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk membandingkan akurasi hasil, kami menggunakan dua indikator - standar deviasi dan persentase nilai yang cocok dengan langkah akurasi tertentu epsilon. Jika Anda secara acak membuat daftar nilai input dengan titik mengambang setelah titik desimal, Anda harus menentukan keakuratan parameter input - ini akan memungkinkan Anda untuk mendapatkan hasil yang benar. Jika tidak, angka acak dapat memiliki perbedaan besar urutan besarnya - ini dapat sangat mempengaruhi keakuratan hasil dan mempengaruhi estimasi kesalahan hasil.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena Awalnya, kami mengasumsikan bahwa diperlukan untuk beroperasi dengan nilai konstan dari biaya bahan, serta beberapa konstanta dari berbagai bidang pengetahuan, kami dapat menerima bahwa semua parameter input akan memiliki nilai yang akurat hingga 3 tempat desimal. Idealnya, Anda perlu menentukan rentang nilai yang valid untuk masing-masing parameter dan hanya menggunakannya untuk menghasilkan nilai acak, tetapi sejak itu rumus untuk pengujian dikompilasi secara acak tanpa pembenaran matematis dan fisik, maka tidak mungkin untuk menghitung kisaran nilai untuk semua 10 parameter dalam periode waktu yang wajar. Oleh karena itu, dalam perhitungan kadang-kadang dimungkinkan untuk mendapatkan kesalahan perhitungan. Kami mengecualikan vektor input data tersebut pada saat perhitungan untuk indikator akurasi,tetapi kami akan menghitung kesalahan tersebut sebagai karakteristik yang terpisah.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arsitektur Uji&nbsp;</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk setiap pustaka terpisah, kelasnya sendiri telah dibuat yang mengimplementasikan antarmuka </font></font><code>ITestExecutor </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang mencakup 3 metode - </font></font><code>SetUp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Execute </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>TearDown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="plaintext hljs">public interface ITestExecutor<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;//      <font></font>
&nbsp;&nbsp;&nbsp;&nbsp;void SetUp();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;//   ,           <font></font>
&nbsp;&nbsp;&nbsp;&nbsp;double Execute(double[] p);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;//    ,      <font></font>
&nbsp;&nbsp;&nbsp;&nbsp;void TearDown();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode </font></font><code>SetUp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>TearDown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya digunakan sekali dalam proses pengujian perpustakaan dan tidak dipertimbangkan ketika mengukur perhitungan waktu pada seluruh rangkaian data input. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, algoritma pengujian diringkas menjadi sebagai berikut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Persiapan data (kami membentuk aliran input vektor dengan akurasi tertentu);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alokasi memori untuk data yang dihasilkan (array hasil untuk setiap perpustakaan, array dengan jumlah kesalahan);&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inisialisasi perpustakaan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memperoleh hasil perhitungan untuk masing-masing perpustakaan dengan menyimpan hasilnya dalam array yang disiapkan sebelumnya dan mencatat waktu pelaksanaan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penyelesaian pekerjaan dengan kode perpustakaan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analisis data:</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Representasi grafis dari algoritma ini disajikan di bawah ini.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sl/yg/e0/slyge0dloc1dednqql-hgga6um4.png" alt="Bagan alur pengujian kinerja dan akurasi perpustakaan dukungan Excel"></div><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil iterasi pertama</font></font></h1><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indeks</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asli</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 4</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
&amp; </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 5</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NPOI</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puncak menara</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excel interop</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu inisialisasi (ms)</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">257</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">266</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">632</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1653</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengawinkan </font><font style="vertical-align: inherit;">waktu untuk 1 pass (ms)</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0002</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,4086</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,6847</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.9782</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38.8423</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rata-rata </font><font style="vertical-align: inherit;">deviasi</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000394</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000395</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000237</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000631</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t / a</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketepatan</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99,99%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99,92%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99,97%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99,84%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t / a</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesalahan</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,94%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,94%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,52%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,94%</font></font></td>
</tr>
</tbody></table></div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa hasil EPPlus 5 dan EPPlus 4 digabungkan?</font></font></b>
                        <div class="spoiler_text">      EPPlus      .    ,       ,         .    ,         .     EPPlus 5     ,       .          ,      EPPlus,    .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Iterasi pertama dari tes menunjukkan hasil yang baik, di mana para pemimpin di antara perpustakaan segera terlihat. </font><font style="vertical-align: inherit;">Seperti dapat dilihat dari data di atas, pemimpin absolut dalam situasi ini adalah perpustakaan EPPlus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasilnya tidak mengesankan dibandingkan dengan kode asli, tetapi Anda dapat hidup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini bisa saja dihentikan, tetapi setelah berbicara dengan pelanggan, keraguan pertama muncul: hasilnya terlalu bagus.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zp/7s/ry/zp7sryxdmhkg5rp8xfhwf537kti.jpeg"></div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fitur bekerja dengan perpustakaan Spire</font></font></b>
                        <div class="spoiler_text">     Spire  ,             InvalidCastException.      ,          Excel-    ,     ,      ,     .                    try...catch.       ,         .<br>
</div>
                    </div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rake iterasi tes pertama</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di atas, saya meminta Anda untuk menarik perhatian Anda ke satu titik yang memainkan peran penting dalam mendapatkan hasil. Kami menduga bahwa formula yang digunakan dalam file Excel sebenarnya dari pelanggan akan jauh dari primitif, dengan banyak dependensi di dalamnya, tetapi kami tidak menduga bahwa ini dapat sangat mempengaruhi indikator. Namun demikian, pada awalnya, ketika menyusun data pengujian, saya tidak melihat ini, dan data dari pelanggan (setidaknya informasi bahwa setidaknya 120 parameter input digunakan dalam file akhir) mengisyaratkan bahwa kita perlu berpikir dan menambahkan formula dengan dependensi antar sel. .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mulai menyiapkan data baru untuk iterasi pengujian berikutnya. </font><font style="vertical-align: inherit;">Mari kita membahas 10 parameter input dan menambahkan 4 formula baru tambahan dengan ketergantungan hanya pada parameter dan 1 formula agregasi, yang didasarkan pada empat sel ini dengan formula dan juga akan bergantung pada nilai-nilai data input. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formula baru yang akan digunakan untuk pengujian selanjutnya:</font></font><br>
<br>
<pre><code class="plaintext hljs">public double Execute(double[] p)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price1 = Math.Pow(p[0] * p[8] / p[4] * Math.Sin(p[5]) * Math.Cos(p[2]) +<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Math.Abs(p[1] - (p[2] + p[3] + p[4] + p[5] + p[6] + p[7] + p[8]))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Math.Sqrt(p[0] * p[0] + p[1] * p[1]) / 2.0 * Math.PI, p[9]);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price2 = p[4] * p[5] * p[2] / Math.Max(1, Math.Abs(p[7]));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price3 = Math.Abs(p[7] - p[3]) * p[2];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price4 = Math.Sqrt(Math.Abs(p[1] * p[2] + p[3] * p[4] + p[5] * p[6]) + 1.0);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price5 = p[0] * Math.Cos(p[1]) + p[2] * Math.Sin(p[1]);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var sum = p[0] + p[1] + p[2] + p[3] + p[4] + p[5] + p[6] + p[7] + p[8] + p[9];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price6 = sum / Math.Max(1, Math.Abs((p[0] + p[1] + p[2] + p[3]) / 4.0))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ sum / Math.Max(1, Math.Abs((p[4] + p[5] + p[6] + p[7] + p[8] + p[9]) / 6.0));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var pricingAverage = (price1 + price2 + price3 + price4 + price5 + price6) / 6.0;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return pricingAverage / Math.Max(1, Math.Abs(price1 + price2 + price3 + price4 + price5 + price6));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, formula yang dihasilkan ternyata jauh lebih rumit, yang secara alami memengaruhi hasil - bukan untuk yang lebih baik. </font><font style="vertical-align: inherit;">Tabel dengan hasilnya disajikan di bawah ini:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indeks</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asli</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 4 </font></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 5</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NPOI</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puncak menara</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excel interop</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu inisialisasi (ms)</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">241</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">368</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">722</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1640</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengawinkan </font><font style="vertical-align: inherit;">waktu untuk 1 pass (ms)</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0004</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,9174 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(+ 124%)</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,8996 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(+ 177%)</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,7647 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(+ 11%)</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50.7194 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(+ 30%)</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rata-rata </font><font style="vertical-align: inherit;">deviasi</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,035884</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t / a</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketepatan</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">98,79%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100,00%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100,00%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100,00%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t / a</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesalahan</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,3%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,3%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,28%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,3%</font></font></td>
</tr>
</tbody></table></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xg/l5/ye/xgl5yefp3_meak1f4qzj1mctjsm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan: Karena </font><font style="vertical-align: inherit;">Excel Interop terlalu besar, harus dikeluarkan dari bagan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti dapat dilihat dari hasilnya, situasinya menjadi sangat tidak cocok untuk digunakan dalam produksi. </font><font style="vertical-align: inherit;">Sedikit sedih, persediaan kopi dan menyelam lebih dalam ke studi - langsung ke generasi kode.&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nv/d_/kh/nvd_khyfluufkuwh64vikgafdpe.jpeg"></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembuatan Kode</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda tiba-tiba tidak pernah menghadapi tugas serupa, maka kami akan melakukan perjalanan singkat.&nbsp;</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembuatan kode</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah cara menyelesaikan masalah dengan secara dinamis menghasilkan kode sumber berdasarkan input data dengan kompilasi dan eksekusi selanjutnya. </font><font style="vertical-align: inherit;">Ada kedua pembuatan kode statis yang terjadi selama pembangunan proyek (saya dapat mengutip T4MVC sebagai contoh, yang membuat kode baru berdasarkan template dan metadata yang dapat digunakan saat menulis kode aplikasi utama), dan kode dinamis yang berjalan selama runtime.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tugas kami adalah membentuk fungsi baru berdasarkan data sumber (rumus dari Excel), yang menerima hasil berdasarkan vektor nilai input. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melakukan ini, Anda harus:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baca rumus dari file;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kumpulkan semua dependensi;</font></font></li>
<li>       C#;</li>
<li>     ;</li>
<li>            ;</li>
<li>     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua perpustakaan yang disajikan cocok untuk membaca rumus, namun, perpustakaan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ternyata merupakan antarmuka yang paling nyaman untuk fungsi tersebut </font><font style="vertical-align: inherit;">. Setelah mencari-cari sedikit dalam kode sumber perpustakaan ini, saya menemukan kelas publik untuk membentuk daftar token dan transformasi lebih lanjut menjadi pohon ekspresi. Bingo, pikirku! Pohon ekspresi siap pakai dari kotak sangat ideal, cukup telusuri dan bentuk kode C # kami.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi tangkapan besar sedang menunggu saya ketika saya mulai mempelajari node dari pohon ekspresi yang dihasilkan. Beberapa node, khususnya panggilan ke fungsi Excel, merangkum informasi tentang fungsi yang digunakan dan parameter inputnya dan tidak menyediakan akses terbuka ke data ini. Oleh karena itu, pekerjaan dengan pohon ekspresi selesai harus ditunda.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami naik satu tingkat lebih rendah dan mencoba bekerja dengan daftar token. Semuanya cukup sederhana di sini: kami memiliki token yang memiliki jenis dan nilai. Karena kita diberi fungsi dan kita perlu membentuk fungsi, maka kita bisa mengonversi token pohon menjadi setara di C #. Hal utama dalam pendekatan ini adalah mengatur fungsi yang kompatibel. Sebagian besar fungsi matematika sudah kompatibel - seperti menghitung cosinus, sinus, mendapatkan root, dan menaikkan ke kekuatan. Tetapi fungsi agregasi - seperti nilai maksimum, minimum, jumlah - perlu diselesaikan. Perbedaan utama adalah bahwa di Excel, fungsi-fungsi ini bekerja dengan rentang nilai. Untuk kesederhanaan prototipe, kami akan membuat fungsi yang mengambil daftar parameter sebagai input, yang sebelumnya memperluas rentang nilai ke dalam daftar linier.Dengan cara ini kita mendapatkan konversi yang benar dan kompatibel dari sintaks Excel ke sintaks C #.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah ini adalah kode utama untuk mengonversi daftar token dari rumus Excel menjadi kode C # yang valid.</font></font><br>
<br>
<pre><code class="plaintext hljs">private string TransformToSharpCode(string formula, ParsingContext parsingContext)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Initialize basic compile components, e.g. lexer<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var lexer = new Lexer(parsingContext.Configuration.FunctionRepository, parsingContext.NameValueProvider);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// List of dependency variables that can be filled during formula transformation<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var variables = new Dictionary&lt;string, string&gt;();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;using (var scope = parsingContext.Scopes.NewScope(RangeAddress.Empty))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Take resulting code line<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var compiledResultCode = TransformToSharpCode(formula, parsingContext, scope, lexer, variables);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var output = new StringBuilder();<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Define dependency variables in reverse order.<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach (var variableDefinition in variables.Reverse())<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.AppendLine($"var {variableDefinition.Key} = {variableDefinition.Value};");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Take the result<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.AppendLine($"return {compiledResultCode};");<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return output.ToString();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
}<font></font>
<font></font>
private string TransformToSharpCode(ICollection&lt;Token&gt; tokens, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var output = new StringBuilder();<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;foreach (Token token in tokens)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (token.TokenType)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Function:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(BuildFunctionName(token.Value));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.OpeningParenthesis:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append("(");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.ClosingParenthesis:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(")");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Comma:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(", ");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.ExcelAddress:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var address = token.Value;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(TransformAddressToSharpCode(address, parsingContext, scope, lexer, variables));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Decimal:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Integer:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Boolean:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(token.Value);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Operator:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(token.Value);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return output.ToString();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuansa berikutnya dalam konversi adalah penggunaan konstanta Excel - mereka adalah fungsi, jadi dalam C # mereka juga harus dibungkus dalam suatu fungsi.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetap hanya menyelesaikan satu pertanyaan: konversi referensi sel ke parameter. Dalam kasus di mana token berisi informasi tentang sel, pertama-tama kita menentukan apa yang disimpan dalam sel ini. Jika ini adalah rumus, perluas itu secara rekursif. Jika konstanta diganti dengan tautan analisis C #, dari formulir </font></font><code>p[row, column]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, di mana ia </font></font><code>p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bisa berupa array dua dimensi atau kelas akses yang diindeks untuk pemetaan data yang benar. Dengan rentang sel, kami melakukan hal yang sama, hanya memperluas rentang menjadi sel-sel individual dan memprosesnya secara terpisah. Jadi, kami membahas fungsionalitas utama saat menerjemahkan fungsi Excel.&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gw/kk/hz/gwkkhzpfeudqdzcbfsgsdzdtolo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah ini adalah kode untuk mengonversi tautan ke sel spreadsheet Excel menjadi kode C # yang valid:</font></font><br>
<br>
<pre><code class="plaintext hljs">private string TransformAddressToSharpCode(string excelAddress, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Try to parse excel range of addresses<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Currently, reference to another worksheet in address string is not supported<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var rangeParts = excelAddress.Split(':');<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;if (rangeParts.Length == 1)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Unpack single excel address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return UnpackExcelAddress(excelAddress, parsingContext, scope, lexer, variables);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Parse excel range address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ParseAddressToIndexes(rangeParts[0], out int startRowIndex, out int startColumnIndex);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ParseAddressToIndexes(rangeParts[1], out int endRowIndex, out int endColumnIndex);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var rowDelta = endRowIndex - startRowIndex;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var columnDelta = endColumnIndex - startColumnIndex;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var allAccessors = new List&lt;string&gt;(Math.Abs(rowDelta * columnDelta));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// TODO This part of code doesn't support reverse-ordered range address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;for (var rowIndex = startRowIndex; rowIndex &lt;= endRowIndex; rowIndex++)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (var columnIndex = startColumnIndex; columnIndex &lt;= endColumnIndex; columnIndex++)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Unpack single excel address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allAccessors.Add(UnpackExcelAddress(rowIndex, columnIndex, parsingContext, scope, lexer, variables));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return string.Join(", ", allAccessors);<font></font>
}<font></font>
<font></font>
private string UnpackExcelAddress(string excelAddress, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ParseAddressToIndexes(excelAddress, out int rowIndex, out int columnIndex);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return UnpackExcelAddress(rowIndex, columnIndex, parsingContext, scope, lexer, variables);<font></font>
}<font></font>
<font></font>
private string UnpackExcelAddress(int rowIndex, int columnIndex, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var formula = parsingContext.ExcelDataProvider.GetRangeFormula(_worksheet.Name, rowIndex, columnIndex);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;if (string.IsNullOrWhiteSpace(formula))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// When excel address doesn't contain information about any excel formula, we should just use external input data parameter provider.<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $"p[{rowIndex},{columnIndex}]";<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// When formula is provided, try to identify that variable is not defined yet<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// TODO Worksheet name is not included in variable name, potentially that can cause conflicts<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Extracting and reusing calculations via local variables improves performance for 0.0045ms<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var cellVariableId = $"C{rowIndex}R{columnIndex}";<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;if (variables.ContainsKey(cellVariableId))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return cellVariableId;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// When variable does not exist, transform new formula and register that to variable scope<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;variables.Add(cellVariableId, TransformToSharpCode(formula, parsingContext, scope, lexer, variables));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return cellVariableId;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetap hanya untuk membungkus kode yang dikonversi yang dihasilkan menjadi fungsi statis, menghubungkan perakitan dengan fungsi kompatibilitas, dan mengkompilasi perakitan dinamis. </font><font style="vertical-align: inherit;">Masukkan ke dalam memori, dapatkan tautan ke fungsi kami - dan Anda dapat menggunakannya.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menulis kelas pembungkus untuk menguji dan menjalankan tes dengan pengukuran waktu.&nbsp;</font></font><br>
<br>
<pre><code class="plaintext hljs">public void SetUp()<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Initialize excel package by EPPlus library<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_package = new ExcelPackage(new FileInfo(_fileName));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_workbook = _package.Workbook;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_worksheet = _workbook.Worksheets[1];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_inputRange = new ExcelRange[10];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;for (int rowIndex = 0; rowIndex &lt; 10; rowIndex++)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_inputRange[rowIndex] = _worksheet.Cells[rowIndex + 1, 2];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Access to result cell and extract formula string<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_resultRange = _worksheet.Cells[11, 2];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var formula = _resultRange.Formula;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Initialize parsing context and setup data provider<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var parsingContext = ParsingContext.Create();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;parsingContext.ExcelDataProvider = new EpplusExcelDataProvider(_package);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Transform Excel formula to CSharp code<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var sourceCode = TransformToSharpCode(formula, parsingContext);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Compile CSharp code to IL dynamic assembly via helper wrappers<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_code = CodeGenerator.CreateCode&lt;double&gt;(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sourceCode,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new string[]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// List of used namespaces<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"System", // Required for Math functions<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ExcelCalculations.PerformanceTests" // Required for Excel function wrappers stored at ExcelCompiledFunctions static class<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new string[]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Add reference to current compiled assembly, that is required to use Excel function wrappers located at ExcelCompiledFunctions static class<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"....\\bin\\Debug\\ExcelCalculations.PerformanceTests.exe"<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Notify that this source code should use parameter;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Use abstract p parameter - interface for values accessing.<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new CodeParameter("p", typeof(IExcelValueProvider))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasilnya, kami memiliki prototipe solusi ini dan menandainya sebagai </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlusCompiled, Mark-I</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Setelah menjalankan tes, kami mendapatkan hasil yang lama ditunggu-tunggu. Akselerasinya hampir 300 kali. Sudah tidak buruk, tetapi kode yang dihasilkan masih 16 kali lebih lambat dari yang asli. Mungkinkah ini lebih baik? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ya kamu bisa! Mari kita coba untuk meningkatkan hasilnya karena kita akan mengganti semua tautan ke sel tambahan dengan rumus dengan variabel. Pengujian kami menggunakan beberapa penggunaan sel dependen dalam rumus, oleh karena itu, dalam versi pertama penerjemah, kami menerima banyak perhitungan dari data yang sama. Oleh karena itu, diputuskan untuk menggunakan variabel perantara dalam perhitungan. Setelah memperluas kode menggunakan generasi variabel dependen, kami mendapat peningkatan kinerja 2 kali lebih banyak. Perbaikan ini disebut</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlusCompiled, Mark-II</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Tabel perbandingan disajikan di bawah ini:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perpustakaan</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengawinkan </font><font style="vertical-align: inherit;">waktu (ms)</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coef. </font><font style="vertical-align: inherit;">perlambatan</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asli</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,00004</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlusCompiled, Mark-II</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,003</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlusCompiled, Mark-I</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0061</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enambelas</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,2089</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3023</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah kondisi ini dan batas waktu yang diberikan untuk tugas tersebut, kami mendapat hasil yang membawa kami lebih dekat dengan kinerja kode asli dengan sedikit lag - 8 kali, dibandingkan dengan versi asli - lag dari beberapa urutan besarnya, 3028 kali. </font><font style="vertical-align: inherit;">Tetapi apakah mungkin untuk meningkatkan hasilnya dan mendapatkan sedekat mungkin dengan kode asli, jika Anda menghapus batas waktu dan seberapa sesuai?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jawaban saya adalah ya, tetapi, sayangnya, saya tidak lagi punya waktu untuk menerapkan teknik ini. </font><font style="vertical-align: inherit;">Mungkin saya akan mencurahkan artikel terpisah untuk topik ini. </font><font style="vertical-align: inherit;">Saat ini, saya hanya dapat berbicara tentang ide dan opsi utama, menuliskannya dalam bentuk abstrak singkat yang telah diverifikasi oleh transformasi terbalik. </font><font style="vertical-align: inherit;">Dengan konversi terbalik, maksud saya degradasi kode asli yang ditulis dengan tangan ke arah kode yang dihasilkan. </font><font style="vertical-align: inherit;">Pendekatan ini memungkinkan Anda untuk memeriksa beberapa tesis dengan cukup cepat dan tidak memerlukan perubahan signifikan dalam kode. </font><font style="vertical-align: inherit;">Ini juga memungkinkan Anda untuk menjawab pertanyaan tentang bagaimana kinerja kode asli akan memburuk dalam kondisi tertentu, yang berarti bahwa jika kode yang dihasilkan ditingkatkan secara otomatis di arah yang berlawanan, kita bisa mendapatkan peningkatan kinerja dengan koefisien yang sama.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abstrak</font></font></h2><br>
<ol>
<li>  ,                     ;</li>
<li>           inline      ;</li>
<li> -     Sum, Max, Min   ;</li>
<li>  Sum  inline     ;</li>
<li>   (         )    .</li>
</ol><br>
<h1></h1><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong></strong></td>
<td><strong>Native</strong></td>
<td><strong>EPPlus Compiled, Mark-II</strong></td>
<td><strong>EPPlus 4</strong><strong>EPPlus 5</strong></td>
<td><strong>NPOI</strong></td>
<td><strong>Spire</strong></td>
<td><strong>Excel Interop</strong></td>
</tr>
<tr>
<td><strong>  ()</strong></td>
<td>0</td>
<td>239</td>
<td>241</td>
<td>368</td>
<td>722</td>
<td>1640</td>
</tr>
<tr>
<td><strong>.   1  ()</strong></td>
<td>0,0004</td>
<td>0,003</td>
<td>0,9174</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,8996</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,7647</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50.7194</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rata-rata </font><font style="vertical-align: inherit;">deviasi</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,035884</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t / a</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketepatan</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">98,79%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t / a</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesalahan</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,3%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,3%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,28%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,3%</font></font></td>
</tr>
</tbody></table></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kd/py/vy/kdpyvy0-qfqtfbwgtvbwjo28coo.png" alt="Perhitungan cepat rumus dari Excel dalam C #"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ringkas langkah-langkahnya, kami memiliki mekanisme untuk mengubah formula langsung dari dokumen Excel kustom menjadi kode yang berfungsi di server. </font><font style="vertical-align: inherit;">Ini memungkinkan Anda untuk menggunakan fleksibilitas yang luar biasa dari pengintegrasian Excel dengan solusi bisnis apa pun tanpa kehilangan antarmuka pengguna yang kuat yang digunakan oleh banyak pengguna. </font><font style="vertical-align: inherit;">Apakah mungkin untuk mengembangkan antarmuka yang nyaman dengan seperangkat alat yang sama untuk menganalisis dan memvisualisasikan data seperti di Excel untuk periode pengembangan yang begitu singkat? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan integrasi apa yang paling tidak biasa dan menarik dengan dokumen Excel yang harus Anda implementasikan?</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id498022/index.html">Intisari materi menarik untuk pengembang seluler # 341 (pada 13-19 April)</a></li>
<li><a href="../id498024/index.html">Membangun kota dengan mengklik mouse dengan Houdini dan Python</a></li>
<li><a href="../id498026/index.html">FOSS News No. 12 - ulasan berita gratis dan sumber terbuka untuk 13-19 April 2020</a></li>
<li><a href="../id498028/index.html">Simulasi pandemi Python COVID-19</a></li>
<li><a href="../id498030/index.html">Cadangan: di mana, bagaimana, dan mengapa?</a></li>
<li><a href="../id498034/index.html">Pesawat dengan desain modern dilindungi terhadap ancaman biologis (COVID-19) lebih baik dari yang Anda kira</a></li>
<li><a href="../id498036/index.html">Mark Andriessen: Saatnya menciptakan untuk diri kita sendiri (Saatnya Membangun)</a></li>
<li><a href="../id498038/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 411 (13-19 April 2020)</a></li>
<li><a href="../id498042/index.html">Parse, tidak divalidasi</a></li>
<li><a href="../id498046/index.html">Para peneliti sedang mengembangkan pendekatan untuk mengurangi bias dalam dataset visi komputer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>