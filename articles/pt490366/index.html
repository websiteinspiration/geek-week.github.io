<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà∫ üå•Ô∏è üåÜ Devo armazenar o Google Fonts no meu servidor? ü§∞ ü§æüèø ‚ú≥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nas √∫ltimas semanas, por coincid√™ncia no trabalho e em projetos de terceiros, aprendi muito sobre fontes da Web, bem como sobre o Google Fonts em part...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Devo armazenar o Google Fonts no meu servidor?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/490366/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nas √∫ltimas semanas, por coincid√™ncia no trabalho e em projetos de terceiros, aprendi muito sobre fontes da Web, bem como sobre o Google Fonts em particular. Gra√ßas a isso, posso dar uma resposta mais detalhada a uma pergunta que me pareceu simples no passado: voc√™ deve armazenar o Google Fonts no seu servidor?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Objetivamente falando, admito que as fontes n√£o s√£o o meu forte. Prefiro uma abordagem mais pr√°tica e n√£o me concentro no design (consulte este site e verifique se √©) e, antes disso, n√£o sentia a necessidade de usar fontes n√£o-padr√£o. Obviamente, eles parecem um pouco mais agrad√°veis ‚Äã‚Äãe ‚Äúmarcam‚Äù o texto. Mas, para o texto principal, h√° pouco sentido neles. Nunca classifiquei o artigo (ou o relacionei de maneira diferente), apenas porque uma fonte bonita foi usada para envi√°-lo. No entanto, eu estava ciente do impacto negativo de fontes adicionais no desempenho e na velocidade de carregamento da p√°gina; talvez, por isso, eu seja enviesado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, muitos podem discordar de mim, e as fontes, sejam importantes para mim pessoalmente ou n√£o, s√£o usadas regularmente por muitos outros desenvolvedores e, geralmente, elas simplesmente n√£o t√™m escolha. </font><font style="vertical-align: inherit;">Vamos ver o que pode ser feito para n√£o perder a velocidade do site e deixar os designers felizes.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recursos externos e auto-hospedados</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alguns anos atr√°s, era considerado normal usar o CDN para conectar recursos compartilhados (por exemplo, jQuery com </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code.jquery.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sim, eles ainda o usam muito</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Para esclarecer, por CDN aqui quero dizer carregar recursos do dom√≠nio de outra pessoa, n√£o da sua pr√≥pria CDN. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O motivo foi que os navegadores supostamente limitaram o n√∫mero de conex√µes para cada dom√≠nio (geralmente para 6 conex√µes); portanto, usar outro dom√≠nio deu a voc√™ outras 6 conex√µes. Isso poderia ser verdade no passado (especialmente quando a restri√ß√£o era &lt;6 dom√≠nios) e antes do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.tunetheweb.com/security/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se tornar a norma, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aumentando significativamente os custos de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conex√£o. Al√©m disso, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.tunetheweb.com/performance/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente se beneficia do uso de uma conex√£o (principalmente!); portanto, o uso de outros dom√≠nios geralmente √© uma perda de desempenho, e n√£o uma aquisi√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra maneira de obter o mesmo foi dividindo o dom√≠nio principal com um ou mais subdom√≠nios t√©cnicos (por exemplo, assets.example.com) e, nesse caso, as fontes novamente n√£o aparecem no dom√≠nio principal, de onde sua p√°gina da web √© carregada. No entanto, esse m√©todo tem os mesmos problemas de conex√£o, portanto, isso n√£o pode ser chamado de ganho de desempenho, mesmo que existisse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra vantagem de uma CDN p√∫blica foi a alta probabilidade de os visitantes j√° terem essa vers√£o do jQuery condicional no cache. Mas, novamente, estou convencido de que isso √© demais. Existem muitas bibliotecas e suas vers√µes, e</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.speedshop.co/2015/11/05/page-weight-doesnt-matter.html&amp;usg=ALkJrhi72b1W2NoXwuNNVG9LiXf-ySNpMQ#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O cache do navegador √© menor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do que parece, portanto, essa correspond√™ncia √© muito improv√°vel. Al√©m disso, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Safari usa um cache HTTP exclusivo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para cada dom√≠nio visitado, por motivos de privacidade (cache de chave dupla), e o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome tamb√©m apresentar√° essa fun√ß√£o em breve</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Portanto, n√£o h√° mais nada a discutir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este t√≥pico se transforma suavemente em uma conversa sobre o impacto de CDNs de terceiros na privacidade. Voc√™ n√£o tem id√©ia de como e por que eles est√£o rastreando seus usu√°rios, o que n√£o pode acontecer com uma solu√ß√£o auto-hospedada. E inova√ß√µes recentes na lei obrigam muitos sites a listar explicitamente todos os cookies usados ‚Äã‚Äãno site. N√£o √© a tarefa mais f√°cil ao usar CDNs de terceiros.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante muito tempo, estou convencido de que CDNs de terceiros ou mesmo compartilhamento de seus pr√≥prios dom√≠nios est√£o muito longe do ganho de desempenho prometido. Com frequ√™ncia, voc√™ pode encontrar sites nos quais o dom√≠nio principal distribui apenas index.html e, em seguida, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perde muito tempo desperdi√ßando a configura√ß√£o de novas conex√µes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso sem mencionar as implica√ß√µes de seguran√ßa do download de recursos de sites de terceiros. Sim, existe um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SRI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas pode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://nooshu.github.io/blog/2019/12/17/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">causar problemas inesperados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e sinceramente n√£o entendo o ponto. Se for um recurso est√°tico (onde voc√™ pode usar o SRI), armazene-o localmente e, se n√£o for est√°tico (porque o conte√∫do pode mudar), n√£o ser√° poss√≠vel usar o SRI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, o uso de recursos de fontes de terceiros amea√ßa que eles se tornem um √∫nico ponto de falha (SPOF) e desabilitem o site. </font><font style="vertical-align: inherit;">Isso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aconteceu mais de uma vez</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e, embora possa parecer improv√°vel que o Google Fonts caia, ele pode ser bloqueado por proxies da empresa ou por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pa√≠ses inteiros</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, mais e mais pessoas est√£o aconselhando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a manter seus recursos est√°ticos em casa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , idealmente no dom√≠nio do qual voc√™ est√° distribuindo p√°ginas da web. </font><font style="vertical-align: inherit;">As fontes s√£o recursos est√°ticos, ent√£o o mesmo se aplica a eles, certo? </font><font style="vertical-align: inherit;">Bem, acontece que nem tudo √© t√£o simples, porque as fontes t√™m suas pr√≥prias peculiaridades e t√©cnicas de otimiza√ß√£o, o que pode tornar o armazenamento local um pouco mais complicado ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fontes do Google e como eles funcionam</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Google Fonts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© um recurso incr√≠vel se voc√™ gosta de fontes. 977 fontes gr√°tis que qualquer pessoa pode usar gratuitamente. As fontes comerciais geralmente s√£o ridiculamente caras e geralmente licenciadas em vez de vendidas, ou seja, as taxas s√£o cobradas com base no n√∫mero esperado de visualiza√ß√µes de p√°gina. Portanto, ter tantas fontes gratuitas e f√°ceis de usar em uma cole√ß√£o √© muito √∫til. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas isso n√£o √© tudo. O Google Fonts, como muitos provedores de recursos para sites (veja o exemplo jQuery acima), fornece CDNs e armazena fontes para que todos possam usar diretamente de seus servidores. Isso significa que voc√™ pode come√ßar a usar fontes simplesmente adicionando uma linha de c√≥digo ao site para carregar a folha de estilo:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode adicionar mais propriedades e fontes em uma linha para carregar v√°rias fontes e varia√ß√µes de cada uma delas:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i,900%7CPoppins:300,400,700,900&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A desvantagem √© uma queda no desempenho (a vantagem tamb√©m est√° no desempenho, mas isso n√£o √© t√£o √≥bvio, chegaremos a isso). </font><font style="vertical-align: inherit;">O problema √© que seu site (por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.example.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) carrega uma folha de estilo em fonts.googleapis.com, que retorna um CSS com regras de fonte. </font><font style="vertical-align: inherit;">Aqui est√° a fonte do link no exemplo acima:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-comment">/* latin-ext */</span>
<span class="hljs-keyword">@font-face</span> {
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
  <span class="hljs-attribute">font-style</span>: normal;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
  <span class="hljs-attribute">font-display</span>: swap;
  <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjxAwXiWtFCfQ7A.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
  <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0100</span>-<span class="hljs-number">024</span>F, U+<span class="hljs-number">0259</span>, U+<span class="hljs-number">1</span>E00-<span class="hljs-number">1</span>EFF, U+<span class="hljs-number">2020</span>, U+<span class="hljs-number">20</span>A0-<span class="hljs-number">20</span>AB, U+<span class="hljs-number">20</span>AD-<span class="hljs-number">20</span>CF, U+<span class="hljs-number">2113</span>, U+<span class="hljs-number">2</span>C60-<span class="hljs-number">2</span>C7F, U+A720-A7FF;<font></font>
}<font></font>
<span class="hljs-comment">/* latin */</span>
<span class="hljs-keyword">@font-face</span> {
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
  <span class="hljs-attribute">font-style</span>: normal;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
  <span class="hljs-attribute">font-display</span>: swap;
  <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wXiWtFCc.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
  <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0000</span>-<span class="hljs-number">00</span>FF, U+<span class="hljs-number">0131</span>, U+<span class="hljs-number">0152</span>-<span class="hljs-number">0153</span>, U+<span class="hljs-number">02</span>BB-<span class="hljs-number">02</span>BC, U+<span class="hljs-number">02</span>C6, U+<span class="hljs-number">02</span>DA, U+<span class="hljs-number">02</span>DC, U+<span class="hljs-number">2000</span>-<span class="hljs-number">206</span>F, U+<span class="hljs-number">2074</span>, U+<span class="hljs-number">20</span>AC, U+<span class="hljs-number">2122</span>, U+<span class="hljs-number">2191</span>, U+<span class="hljs-number">2193</span>, U+<span class="hljs-number">2212</span>, U+<span class="hljs-number">2215</span>, U+FEFF, U+FFFD;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Falaremos sobre o que algumas dessas configura√ß√µes significam mais tarde (e tamb√©m sobre por que existem duas regras de fonte), mas por enquanto isso significa que voc√™ pode usar essa fonte em seus estilos como este:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-tag">body</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>, sans-serif;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, agora voc√™ precisa se conectar a fonts.googleapis.com, baixar CSS e, em seguida, conectar-se a fonts.gstatic.com e baixar as fontes em si (por que o Google n√£o pode hospedar CSS e fontes no mesmo dom√≠nio - eu realmente n√£o entendo!). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As fontes s√£o frequentemente detectadas pelo navegador com um atraso ao carregar a p√°gina (afinal, voc√™ precisa carregar o CSS para encontrar links para elas). Mas o Google Fonts √© descoberto ainda mais tarde, porque o CSS precisa ser baixado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">outro</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dom√≠nio e, em seguida, as fontes do terceiro dom√≠nio e, como mencionei, estabelecer uma conex√£o HTTPS tamb√©m n√£o √© instant√¢nea. Isso pode ser visto no diagrama em cascata abaixo gerado pelo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebPageTest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (observe que todos os testes foram executados com o Chrome - 3GSlow):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/94/si/uk/94siukfgpsuc3y8vvcenns7d8rm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A linha 1 mostra que o HTML √© carregado primeiro. </font><font style="vertical-align: inherit;">Ent√£o, assim que √© baixado e lido em menos de 2 segundos, o navegador detecta a necessidade de carregar o CSS do Google Fonts e o carrega na linha 4. Demora um segundo para estabelecer uma conex√£o e, em seguida, um arquivo √© baixado por 3,5 segundos. </font><font style="vertical-align: inherit;">Finalmente, o navegador descobriu a exist√™ncia de nossa fonte e a carregou na linha 6, tendo perdido mais 1 segundo no caminho para a conex√£o com o fonts.gstatic.com. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, o uso dessa fonte do Google Fonts nos custa tr√™s segundos inteiros de produtividade a partir do momento em que o HTML est√° dispon√≠vel, sem levar em considera√ß√£o o tempo para fazer o download da fonte!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acelerando o Google Fonts pr√©-carregando recursos </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode atenuar esse terr√≠vel impacto no desempenho ao carregar CSS e fontes de dois dom√≠nios diferentes. O primeiro dom√≠nio (para CSS) deve estar localizado mais pr√≥ximo do in√≠cio do arquivo index.html, para que o navegador o leia o mais r√°pido poss√≠vel, mas o segundo ainda est√° oculto. No entanto, sabemos como ser√° esse dom√≠nio (fonts.gstatic.com), para que possamos abrir a conex√£o com anteced√™ncia para economizar algum tempo na segunda conex√£o posteriormente:</font></font><br>
<br>
<pre><code class="xml hljs">
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">crossorigin</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao testar novamente, vemos a seguinte imagem: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0-/ab/1r/0-ab1rf2caybdrxaloc5xrs6d0k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui vemos que a conex√£o na linha 5 √© aberta antecipadamente, antes de carregar o CSS. Ent√£o, ganhamos mais de um segundo (baixando fontes em 4 segundos, e n√£o 5,25), porque conseguimos evitar perder tempo durante a conex√£o e as fontes s√£o baixadas imediatamente ap√≥s a leitura das CSS Google Fonts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode pensar em avan√ßar e pr√©-carregar toda a fonte, em vez de se contentar em ingressar apenas no dom√≠nio, mas o Google Fonts chama hashes exclusivos de fontes. No exemplo acima, a fonte baixada √© chamada S6uyw4BMUTPHjx4wXg.woff2, n√£o lato.woff2, portanto, o pr√©-carregamento n√£o √© poss√≠vel, a menos que voc√™ queira que seu site falhe um dia quando o Google decidir mudar repentinamente esse hash.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De qualquer forma, se voc√™ usa o Google Fonts e n√£o pretende fazer mais nada depois de ler esta nota, adicione pelo menos uma conex√£o preliminar ao dom√≠nio, caso ainda n√£o o esteja. Essa √© apenas uma linha de c√≥digo e deve melhorar significativamente o desempenho da sua p√°gina. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, o Google Fonts fornece um comando semelhante nos cabe√ßalhos HTTP quando processa CSS:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1g/7n/lg/1g7nlg8c-qteofu6cr1t3eep2bi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, em muitos casos, isso n√£o ajudar√° muito, porque quando voc√™ recebe os cabe√ßalhos de resposta HTTP do servidor com CSS, o navegador j√° sabe que deseja se conectar a esse dom√≠nio para baixar fontes. </font><font style="vertical-align: inherit;">Portanto, √© melhor especificar isso no c√≥digo HTML para que a pr√©-carga funcione mais cedo (n√£o importa que seja duplicada dessa maneira, a segunda tentativa ser√° simplesmente ignorada). </font><font style="vertical-align: inherit;">No entanto, se sua p√°gina ainda estiver sendo processada no momento em que os cabe√ßalhos do servidor CSS do Google Fonts forem recebidos e o DOM n√£o estiver pronto (talvez isso seja um sinal de muito JavaScript na sua p√°gina?), Isso poder√° ajudar a melhorar o desempenho quando finalmente ficar claro qual fonte baixar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exibi√ß√£o de fonte: Trocar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No c√≥digo da fonte acima, voc√™ pode ver a linha display: swap; line. Esta √© uma instru√ß√£o relativamente nova. Ele pode ser adicionado √† declara√ß√£o da fonte e instruir√° o navegador a usar o fallback primeiro, ou seja, a fonte do sistema (sem serifa neste exemplo) e, em seguida, substitua-a pela fonte real ap√≥s o download. Dessa forma, voc√™ pode evitar atrasos no carregamento do conte√∫do quando a fonte ainda n√£o foi carregada e tamb√©m melhorar o desempenho.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sim, isso leva a um surto de texto sem estilo (FOUT) - os mesmos "saltos" no conte√∫do durante o carregamento da p√°gina, mas algumas pessoas n√£o gostam (minha opini√£o √© de opini√£o de que o conte√∫do √© mais importante que o estilo, mas o texto que salta pela p√°gina √© irritante, embora isso pode ser atenuado ajustando a fonte sobressalente). Uma alternativa √© o texto invis√≠vel instant√¢neo (FOIT). Nesse caso, o texto fica oculto at√© que a fonte seja exibida, o que obviamente atrasa o download e pode causar outros problemas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se algum texto carregar, mas outros n√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> !</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De qualquer forma, antes da introdu√ß√£o do font-display: swap, diferentes navegadores lidavam com isso de maneira diferente - alguns, como o IE e o Edge, usavam FOUT, outros usavam FOIT, e tinham tempos diferentes at√© que esperassem que as fontes esperassem. Por esse motivo, se a fonte n√£o for carregada, seu conte√∫do poder√° permanecer invis√≠vel por um longo tempo. A introdu√ß√£o do font-display: swap permitiu que os desenvolvedores de sites decidissem por si mesmos como isso aconteceria. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A maioria dos navegadores suporta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exibi√ß√£o de fonte: swap, com exce√ß√£o do IE e Edge, mas como mencionado acima, eles usam isso por padr√£o de qualquer maneira. As fontes do Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tamb√©m oferecem suporte a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v√°rias op√ß√µes de exibi√ß√£o de fontes e oferecem exibi√ß√£o de fonte: troca por padr√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, outra dica se voc√™ usar fontes do Google √© verificar se possui o par√¢metro &amp; display = swap no URL e, se n√£o tiver (apenas o suporte recente), adicione-o: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, substitua:</font></font><br>
<br>
<pre><code class="xml hljs">
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">crossorigin</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nisto:</font></font><br>
<br>
<pre><code class="xml hljs">
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">crossorigin</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificar um dos outros valores de exibi√ß√£o de fonte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , por exemplo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opcional</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , se desejar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, isso resolve apenas metade do problema. </font><font style="vertical-align: inherit;">Esta instru√ß√£o est√° em CSS, que retorna o Google Fonts, por isso √© √∫til apenas ap√≥s o download do arquivo CSS. </font><font style="vertical-align: inherit;">Portanto, ajuda a lidar com o atraso ao carregar as fontes em si, mas n√£o ajuda enquanto voc√™ aguarda o carregamento desse CSS. </font><font style="vertical-align: inherit;">Portanto, essa √© uma boa melhoria (pelo menos para quem prefere FOUT), mas ainda n√£o √© a solu√ß√£o completa como um todo.</font></font><br>
<br>
<h2>  Google Fonts</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajudou a criar Web Almanac</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (um olhar fant√°stico para o estado da Internet - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ver por</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si mesmo se voc√™ ainda n√£o viu ainda) e o download lento de fontes do Google em nosso site me incomodou e eu quis corrigi-lo. Especialmente FOUT com exibi√ß√£o de fonte: swap. Fiquei me perguntando se poder√≠amos reduzir o impacto disso, e a solu√ß√£o local parecia estar armazenando arquivos localmente, possivelmente usando pr√©-carregamento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° usamos as t√©cnicas acima (pr√©-carregamento e exibi√ß√£o da fonte: swap;), mas, √© claro, seria melhor evitar conectar o CSS de fora. Sabemos o que haver√° neste CSS. Ent√£o, escolha com confian√ßa auto-hospedado? √â aqui que fica interessante ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrei um script conveniente no GitHub ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Font Download</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), que me ajudou a baixar todas as op√ß√µes de fontes diferentes (j√° que havia muitas delas, at√© 9 dependendo da p√°gina) e, em seguida, copiou o CSS, exibido na nossa folha de estilo principal, e carregou as fontes no servidor. Existem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">outras ferramentas online</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que fazem o mesmo. Tudo parecia funcionar, e nos livramos do carregamento irritante de CSS e da necessidade de trabalhar com dois dom√≠nios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, ap√≥s uma inspe√ß√£o mais detalhada, notei que as fontes eram maiores:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1w/hk/fs/1whkfsun5mb15p76jzen2eft4wk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, houve um aumento significativo no tamanho (at√© 74% a mais para alguns deles!) Em compara√ß√£o com as fontes do Google baixadas (√† direita) e as fontes localmente colocadas (√† esquerda). Inicialmente, pensei que isso se devia ao meu servidor web local, por exemplo, devido √† desativa√ß√£o da compacta√ß√£o. Por√©m, as fontes WOFF2 s√£o servidas sem compacta√ß√£o pelo servidor da Web - ou pelo menos deveria ser - j√° que o formato inclui a compacta√ß√£o de Brotli. Al√©m disso, a captura de tela acima mostra os bytes baixados (preto na parte superior) e os bytes n√£o compactados (um pouco mais claros na parte inferior) de cada coluna (eles s√£o bastante semelhantes nas duas colunas, pois as fontes s√£o realmente enviadas sem compress√£o pelo servidor da Web, mas os bytes baixados incluem cabe√ßalhos HTTP , ent√£o eles s√£o um pouco maiores) e houve diferen√ßas nos bytes compactados e descompactados. Portanto, esse n√£o √© o ponto.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A compara√ß√£o das regras de face da fonte obtidas usando a ferramenta com as originais revelou uma diferen√ßa: No </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google Fonts:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-comment">/* latin-ext */</span>
<span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">font-display</span>: swap;
    <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjxAwXiWtFCfQ7A.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
    <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0100</span>-<span class="hljs-number">024</span>F, U+<span class="hljs-number">0259</span>, U+<span class="hljs-number">1</span>E00-<span class="hljs-number">1</span>EFF, U+<span class="hljs-number">2020</span>, U+<span class="hljs-number">20</span>A0-<span class="hljs-number">20</span>AB, U+<span class="hljs-number">20</span>AD-<span class="hljs-number">20</span>CF, U+<span class="hljs-number">2113</span>, U+<span class="hljs-number">2</span>C60-<span class="hljs-number">2</span>C7F, U+A720-A7FF;<font></font>
}<font></font>
<span class="hljs-comment">/* latin */</span>
<span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">font-display</span>: swap;
    <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wXiWtFCc.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
    <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0000</span>-<span class="hljs-number">00</span>FF, U+<span class="hljs-number">0131</span>, U+<span class="hljs-number">0152</span>-<span class="hljs-number">0153</span>, U+<span class="hljs-number">02</span>BB-<span class="hljs-number">02</span>BC, U+<span class="hljs-number">02</span>C6, U+<span class="hljs-number">02</span>DA, U+<span class="hljs-number">02</span>DC, U+<span class="hljs-number">2000</span>-<span class="hljs-number">206</span>F, U+<span class="hljs-number">2074</span>, U+<span class="hljs-number">20</span>AC, U+<span class="hljs-number">2122</span>, U+<span class="hljs-number">2191</span>, U+<span class="hljs-number">2193</span>, U+<span class="hljs-number">2212</span>, U+<span class="hljs-number">2215</span>, U+FEFF, U+FFFD;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na ferramenta de download:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">src</span>:
        <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>),
        <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>),
        <span class="hljs-comment">/* from https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wXg.woff2 */</span>
        <span class="hljs-built_in">url</span>(<span class="hljs-string">'Lato_400.woff2'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>),
        <span class="hljs-comment">/* from https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wWA.woff */</span>
        <span class="hljs-built_in">url</span>(<span class="hljs-string">'Lato_400.woff'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff'</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira diferen√ßa √© que perdemos a linha de exibi√ß√£o da fonte: linha de troca, mas isso pode ser corrigido sem problemas. </font><font style="vertical-align: inherit;">Muito mais interessante √© o fato de o Google Fonts distribuir duas fontes - e incluir diferentes intervalos Unicode. </font><font style="vertical-align: inherit;">Isso ocorre devido ao subconjunto de fontes e reduz os arquivos de fontes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subconjunto de fontes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Subconjunto de fontes √© a remo√ß√£o de caracteres que voc√™ n√£o usar√° para reduzir o tamanho do arquivo de fontes. Normalmente, a maioria dos ocidentais usa apenas caracteres latinos, e o download de uma fonte com todos os caracteres que voc√™ provavelmente n√£o usar√° √© irracional. Eu j√° tinha ouvido falar sobre isso antes, mas nunca pensei o qu√£o significativo isso poderia ter! O Google Fonts renderiza automaticamente uma face de fonte com um conjunto de caracteres latinos e, sempre que poss√≠vel, conecta uma segunda fonte para caracteres latinos estendidos (por exemplo, ƒÄ), que ser√£o baixados apenas se necess√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, voc√™ tamb√©m pode solicitar uma fonte especial que contenha apenas os caracteres necess√°rios com o par√¢metro de texto: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://fonts.googleapis.com/css?family=Lato&amp;text=ABC</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A julgar por outras observa√ß√µes, a ferramenta de carregamento de fontes que usei aparentemente suporta subconjuntos de fontes, mas apenas para todo o ‚Äúidioma‚Äù (latim ou latim estendido), e combina os dois subconjuntos de caracteres em um √∫nico arquivo. </font><font style="vertical-align: inherit;">No final, voltei a usar o que meu navegador usava e parei de usar essa ferramenta. </font><font style="vertical-align: inherit;">Isso forneceu tamanhos de arquivo semelhantes (com uma pequena diferen√ßa devido aos cabe√ßalhos HTTP no meu ambiente de desenvolvimento), mas logo descobri que n√£o se tratava apenas de subconjunto de fontes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Google Fonts distribui fontes de maneira inteligente</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As fontes do Google nem sempre processam o mesmo CSS e isso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depende do agente do usu√°rio usado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Por exemplo, para o Internet Explorer 11, ele envia o seguinte:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">font-display</span>: swap;
    <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wWA.woff) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff'</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui voc√™ pode ver que ele fornece apenas o formato WOFF, j√° que o IE 11 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o suporta WOFF2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e, pelo mesmo motivo, o intervalo unicode n√£o √© especificado. D√° fonte-display: swap (como eu apontei na URL para CSS), embora o navegador n√£o o suporte, mas n√£o prejudique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o √© apenas o fabricante e a vers√£o do navegador. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dica de fonte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inclui instru√ß√µes adicionais no arquivo da fonte, que s√£o usadas para fornecer a melhor exibi√ß√£o da fonte - especialmente em telas de baixa resolu√ß√£o ou em tamanhos muito pequenos. A dica de fonte √© usada no Windows, mas n√£o no MacOS. Portanto, dependendo de qual sistema operacional voc√™ trabalha ao receber o Google Fonts, usando um navegador (mesmo se voc√™ usa o Chrome em cada plataforma), voc√™ pode obter arquivos de fonte com dicas ou sem ele. Se voc√™ baixar a vers√£o do Windows e us√°-la, voc√™ realmente far√° com que os usu√°rios do MacOS sofram com a necessidade de processar grandes arquivos de fonte cheios de dicas n√£o utilizadas; se voc√™ fizer o oposto, provavelmente far√° com que os usu√°rios do Windows sofram com pior exibi√ß√£o da fonte, sem dica de fonte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando eu usei o Google Fonts e baixei fontes para uso local, fiz no meu Mac, para obter arquivos menores. </font><font style="vertical-align: inherit;">Quando usei a ferramenta, obtive fontes completas, com dicas. </font><font style="vertical-align: inherit;">Ent√£o essa foi outra raz√£o para a grande diferen√ßa de tamanho! </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A dica de fonte ainda √© relevante</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque as telas de alta defini√ß√£o se tornaram mais comuns - essa √© uma boa pergunta e muitas fontes s√£o entregues inicialmente sem sugest√µes, pois leva muito tempo para cri√°-las. </font><font style="vertical-align: inherit;">Quando est√° presente, pode aumentar significativamente o tamanho da fonte. </font><font style="vertical-align: inherit;">No caso de Lato, o tamanho √© dobrado. </font><font style="vertical-align: inherit;">Vale a pena a carga de trabalho extra que voc√™ encontrar√° ao abandonar as Fontes do Google e localizar fontes localmente? </font><font style="vertical-align: inherit;">Essa √© outra decis√£o que voc√™ precisa tomar para si mesmo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, o CDN do Google Fonts √© suportado por um script inteligente que fornece as fontes mais adequadas, otimizando-as para manter o desempenho m√°ximo. Ao mudar para o armazenamento local de fontes, voc√™ ter√° que configurar tudo isso por conta pr√≥pria e, em alguns navegadores, poder√° perder a exibi√ß√£o correta de suas fontes em alguns navegadores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o Web Almanac, analisamos as estat√≠sticas dos navegadores dos visitantes e decidimos dar suporte apenas ao WOFF2, al√©m de usar vers√µes do MacOS sem dar dicas, pois elas pesam metade do mesmo. Este CSS simplificado (especialmente porque o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intervalo unicode √©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suportado por todos os navegadores que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suportam WOFF2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), e os usu√°rios do IE 11 e outros navegadores antigos veem o sans-serif por padr√£o, o que n√£o parece muito bom, mas, em nossa opini√£o, as fontes s√£o uma melhoria progressiva e, mesmo sem eles, o site ainda √© mais do que utiliz√°vel. Al√©m disso, navegadores mais antigos podem at√© se beneficiar do uso de fontes padr√£o do sistema, pois provavelmente ser√£o usadas em m√°quinas mais antigas e de baixa pot√™ncia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fazer outros ajustes nas fontes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usadas, se desejar (verifique as licen√ßas primeiro!). Mas copiar as fontes padr√£o do Google usadas no Chrome no MacOS provavelmente √© suficiente para a maioria de n√≥s, se voc√™ quiser suportar apenas navegadores WOFF2 sem dar dicas. .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, se adot√°ssemos o Google Fonts, ter√≠amos WOFF (e formatos ainda mais antigos) e dicas sempre que necess√°rio, sem a necessidade de configura√ß√£o profunda da substitui√ß√£o da fonte correta, dependendo do navegador. </font><font style="vertical-align: inherit;">Portanto, o uso das fontes do Google para fontes ainda tem certas vantagens e, ao escolher o armazenamento local, voc√™ as recusa. </font><font style="vertical-align: inherit;">Isso tamb√©m se aplica a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quaisquer aprimoramentos futuros no Google Fonts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aprimoramentos de fontes futuras</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao me aprofundar no assunto das fontes e avisar que voc√™ poder√° perder quaisquer benef√≠cios futuros do Google Fonts acessando o armazenamento local, quero me afastar um pouco do t√≥pico principal e falar sobre outras coisas interessantes que descobri. </font><font style="vertical-align: inherit;">Quais s√£o as pr√≥ximas grandes mudan√ßas no mundo das fontes? </font><font style="vertical-align: inherit;">Bem, h√° duas altera√ß√µes que est√£o sendo discutidas ativamente no momento e que podem afetar fontes no futuro (e, portanto, podem ser suportadas pelo Google Fonts, talvez por padr√£o, se voc√™ optar por usar este servi√ßo): fontes vari√°veis ‚Äã‚Äãe enriquecimento progressivo de fontes .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fontes vari√°veis</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As fontes vari√°veis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permitem usar diferentes estilos de fonte sem precisar fazer o download de arquivos individuais. Mencionei anteriormente que o Web Almanac usa at√© 9 arquivos de fontes diferentes, mas na realidade s√£o apenas 2 fontes. O motivo √© simples - o site tamb√©m usa vers√µes em negrito, it√°lico, negrito e at√© mais fina de um ou de ambos. Muitas varia√ß√µes da mesma fonte podem parecer inadequadas e voc√™ pode pensar que o pr√≥prio navegador lidar√° com a tarefa de alterar a espessura do texto ou escrever em it√°lico. Sim, √© poss√≠vel. Mas cada navegador faz isso de maneira um pouco diferente, e os resultados </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podem ser radicalmente diferentes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , muitos chamam de "fontes artificiais".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A √∫nica maneira de garantir a mesma exibi√ß√£o √© usar uma "fonte real" especificamente para cada estilo que voc√™ precisa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fontes vari√°veis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">padronizam a exibi√ß√£o de v√°rias varia√ß√µes de fontes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e a necessidade de arquivos adicionais desaparece. Teoricamente, poder√≠amos substituir essas 9 fontes por 2 quando suas vers√µes de fontes vari√°veis ‚Äã‚Äãestiverem dispon√≠veis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso abre in√∫meras possibilidades para o uso de fontes na Internet. Embora possa me parecer que as 9 op√ß√µes para as duas fontes s√£o demais, na realidade n√£o √© demais, enquanto as fontes vari√°veis ‚Äã‚Äãpermitiriam varia√ß√µes infinitas. Em dispositivos m√≥veis, voc√™ pode definir uma espessura ligeiramente diferente para o "negrito" do que em computadores e tablets. Fontes vari√°veis ‚Äã‚Äãcom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algumas instru√ß√µes CSS simples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permita isso sem o custo de recursos para baixar uma fonte adicional. Recentemente, no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DotCSS, </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jason Pamental</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falou sobre fontes vari√°veis ‚Äã‚Äãe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demonstrou</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como voc√™ pode obter uma p√°gina lindamente projetada com o que parece haver muitas fontes diferentes - todas usando um √∫nico arquivo! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usar fontes vari√°veis ‚Äã‚Äãtamb√©m </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">significa carregar todas as varia√ß√µes de fontes ao mesmo tempo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , evitando a confus√£o causada pelos problemas mencionados anteriormente. Isso tamb√©m leva a menos redesenhos do layout: sem fontes vari√°veis, a p√°gina </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser√° redesenhada pelo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> navegador repetidamente √† medida que cada variante de fonte individual √© carregada. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fontes vari√°veis ‚Äã‚Äãt√™m bom suporte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nos navegadores modernos, mas sua desvantagem √© o tamanho grande, porque o armazenamento de varia√ß√µes de fontes diferentes requer mais espa√ßo, como √© o caso das dicas de fontes. </font><font style="vertical-align: inherit;">Depende da fonte, mas geralmente elas s√£o duas vezes maiores ap√≥s a compacta√ß√£o; portanto, para justificar seu uso, voc√™ precisa de pelo menos dois estilos. </font><font style="vertical-align: inherit;">Mesmo assim, √© melhor voc√™ preferir um arquivo menor carregado para exibir texto cr√≠tico, em vez de um arquivo maior para exibir todo o texto. </font><font style="vertical-align: inherit;">E, novamente, o uso do display de fonte: swap pode ser uma solu√ß√£o menos problem√°tica? </font><font style="vertical-align: inherit;">Cabe a cada propriet√°rio do site decidir!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enriquecimento progressivo de fontes</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O enriquecimento progressivo de fontes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , em ess√™ncia, leva a subconjunto a um novo n√≠vel e permite que voc√™ baixe defini√ß√µes de caracteres adicionais, conforme necess√°rio, na forma de um fluxo de informa√ß√µes adicionais que complementam a fonte carregada no momento, mas n√£o adicionam outra. Isso pode parecer uma pequena vantagem para n√≥s, ocidentais, mas para outros idiomas - especialmente no Extremo Oriente - os arquivos de fonte podem ser muito grandes (por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2Mb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), devido ao grande n√∫mero de caracteres nesses idiomas. Por esse motivo, as fontes da Web s√£o menos usadas nesses pa√≠ses e o enriquecimento progressivo das fontes pode ter um efeito positivo na situa√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O enriquecimento progressivo de fontes, como eu o entendo, est√° em um est√°gio muito anterior √†s fontes vari√°veis, mas existem</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demonstra√ß√£o online</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">De qualquer forma, essa √© outra altera√ß√£o potencialmente interessante relacionada a fontes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Google Fonts continuar√° melhorando?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado o funcionamento do Google Fonts, √© f√°cil imaginar que ele pode continuar a crescer com novos aprimoramentos, como os descritos neste artigo (ou muitos outros!), Apenas alterando o CSS fornecido. E ele pode fazer isso com sabedoria. Por exemplo, determinar se o seu navegador suporta novas tecnologias (como acontece agora com o formato da fonte - WOFF ou WOFF2) ou de outras maneiras. Por exemplo, se voc√™ solicitar mais de duas fontes e fornecer uma fonte vari√°vel com menos recursos, poder√° automatizar e vincular ao mesmo arquivo de fonte em v√°rios an√∫ncios de fonte e, se solicitar apenas uma op√ß√£o, consulte uma mais leve, fonte tradicional. Parece rebuscado? </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eles j√° fizeram isso com uma fonte.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Oswald)! Honestamente, n√£o sei se o mesmo √© poss√≠vel com o enriquecimento progressivo de fontes, porque n√£o entendo completamente o princ√≠pio de seu trabalho, mas ser√° interessante ver. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, vale ressaltar que, ao usar fontes do Google, ao atualizar fontes, por exemplo, para adicionar novos conjuntos de caracteres ou corrigir erros nos glifos, voc√™ obt√©m novas fontes automaticamente. Com o armazenamento local, isso n√£o funcionar√° - pelo menos n√£o sem a interven√ß√£o de uma m√£o. Talvez voc√™ possa procurar na dire√ß√£o de solicita√ß√µes de proxy atrav√©s do seu dom√≠nio e, assim, aproveitar o melhor das duas op√ß√µes, mas isso provavelmente ser√° mais lento e exigir√° configura√ß√£o e gerenciamento adicionais.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por outro lado, o armazenamento local fornece estabilidade, pois algumas atualiza√ß√µes podem afetar seu design, por exemplo, se um t√≠tulo em uma linha come√ßar a se estender para dois devido a uma altera√ß√£o na fonte. </font><font style="vertical-align: inherit;">H√° uma categoria de pessoas que est√£o muito chateadas por causa disso</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benef√≠cios do armazenamento de fontes locais</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, discutimos muita teoria e, embora haja √≥bvios benef√≠cios potenciais do armazenamento local, tamb√©m h√° dificuldades a serem consideradas e, portanto, o uso do Google Fonts tamb√©m traz alguns benef√≠cios √≥bvios. Ent√£o, o auto-hospedado vale a pena? Depende das comodidades reais em uma situa√ß√£o espec√≠fica. Se a diferen√ßa de desempenho for insignificante, pode valer a pena continuar usando o Google Fonts, se grande, respectivamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o Web Almanac, recentemente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://github.com/HTTPArchive/almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selecionamos o armazenamento local do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Google Fonts e os testes mostraram mudan√ßas dr√°sticas:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oa/xy/ha/oaxyhappghsnk9rj-l4qoicboki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A imagem inferior cont√©m fontes locais em nosso servidor de teste e voc√™ pode ver que o tempo de download foi reduzido pela metade - de 6 a 3 segundos! Ap√≥s uma an√°lise mais profunda, vi que a produtividade aumentou ainda mais (3 ‚Öì segundos de economia)! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que n√£o √© t√£o √≥bvio (mas o que veremos mais adiante) - neste momento, as fontes n√£o est√£o totalmente carregadas em nenhuma das imagens - com o armazenamento local, s√£o necess√°rios 7,5 segundos e 10,5 segundos ao usar o Google Fonts. No entanto, as fontes usadas s√£o bastante semelhantes √†s padr√£o, e n√£o h√° saltos vis√≠veis no layout. Isso pode ser visto no diagrama abaixo:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ai/zw/vu/aizwvu3sstjfwd68gd7gzhez4im.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O diagrama mostra que a p√°gina com armazenamento local (em vermelho) √© quase completamente carregada em 2,4 segundos e depois √© atualizada v√°rias vezes √† medida que as imagens s√£o carregadas, ap√≥s o que as fontes tamb√©m s√£o exibidas. Sim, eu gostaria de tornar tudo ainda mais suave, mas ainda √© imposs√≠vel otimizar alguns custos de download de fontes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A raz√£o pela qual as melhorias s√£o realmente tang√≠veis √© por causa de mais uma coisa que eu n√£o levei em considera√ß√£o no in√≠cio: a CSS bloqueia a renderiza√ß√£o. Portanto, se houver um link para o CSS do Google Fonts, o navegador n√£o atrasa apenas a exibi√ß√£o do texto - atrasa a exibi√ß√£o de todo o conte√∫do da p√°gina! A fonte √© uma melhoria progressiva, para que possamos renderizar com seguran√ßa o restante da p√°gina e at√© o pr√≥prio texto (com fontes padr√£o / de fallback), mas o navegador n√£o - apenas v√™ que h√° algum CSS e tenta carreg√°-lo, adiando o download o resto da p√°gina. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o h√° carregamento ass√≠ncrono para CSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- mas talvez deva ser para esses casos? No entanto, corremos o risco de que, em caso de problemas na conex√£o com o Google Fonts, todo o site fique inacess√≠vel at√© que o navegador pare de tentar processar o link! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v6/3_/oo/v63_oow5ktzvixadg7tpirrthcs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No gr√°fico de compara√ß√£o acima, a linha verde vertical da Renderiza√ß√£o inicial j√° ocorre ap√≥s 6 segundos - j√° que ele precisa esperar at√© o CSS do Google Fonts carregar na linha 12, gastando metade do tempo conectando-se ao dom√≠nio e a outra metade realmente carregando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compare isso com a vers√£o local: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x6/hm/4c/x6hm4c_omalxhr4ogx_5pueneci.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
aqui podemos come√ßar a renderizar assim que o CSS do site for carregado e processado em 2,5 segundos. Isso ocorre porque n√£o h√° atraso na conex√£o com o dom√≠nio do Google Fonts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos dois casos, vemos que o in√≠cio da renderiza√ß√£o acontece antes do carregamento das fontes e, gra√ßas √† m√°gica da exibi√ß√£o da fonte: swap, o texto ainda est√° vis√≠vel. Portanto, pelo menos ao usar font-display: swap, seria melhor se o Google Fonts n√£o fosse carregado com renderiza√ß√£o de bloqueio CSS, mas, por exemplo, carregado via JavaScript ass√≠ncrono, que insere fontes CSS na p√°gina somente ap√≥s como eles s√£o baixados. Se o processo fosse implementado dessa maneira, os atrasos na renderiza√ß√£o n√£o ocorreriam, no entanto, ainda haver√° atrasos na conex√£o e uma longa espera para que o texto seja exibido corretamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD: Criei um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">problema no GitHub Google Fonts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com uma proposta para adicionar uma maneira de baixar o Google Fonts sem bloquear a renderiza√ß√£o - vote se voc√™ tamb√©m quiser!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zach Leatherman defende essa abordagem para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reduzir o n√∫mero de redesenhos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e mostra que isso tamb√©m √© poss√≠vel apenas com JavaScript, sem a necessidade de um arquivo CSS. </font><font style="vertical-align: inherit;">Em seguida, mostra outras vantagens de gerenciar suas fontes com JavaScript, por exemplo, voc√™ pode recusar o download de fontes, se o site estiver aberto em uma rede lenta (usando a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API de informa√ß√µes de rede</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ou se o usu√°rio tiver as configura√ß√µes de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salvar dados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preferir movimento reduzido</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ativadas </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Recursos interessantes!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©-carregando fontes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de se afastar dos URLs com hash do Google, voc√™ poder√° pr√©-carregar a fonte para melhorar ainda mais o desempenho. No entanto, essa op√ß√£o tem algumas falhas em potencial, como Andy Davies discutiu no artigo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preloading Fonts e the Puzzle of Priorities</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Basicamente, ao pr√©-carregar as fontes e mov√™-las para cima na ordem de prioridade, voc√™ reduz implicitamente a prioridade de outros downloads cr√≠ticos (por exemplo, CSS) e, devido a um erro no Chrome, as fontes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podem at√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ultrapassar algumas delas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, o pr√©-carregamento quando a fonte n√£o ser√° usada causar√° carga desnecess√°ria desnecess√°ria - por exemplo, se a vers√£o local existir e puder ser usada com prioridade ou se o navegador n√£o suportar esse formato de fonte (embora todos os navegadores que suportam o pr√©-carregamento tamb√©m ofere√ßam suporte a WOFF2 ) Juntamente com a recomenda√ß√£o de usar o pr√©-carregamento, o Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avisa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> claramente </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">sobre isso</font></a><font style="vertical-align: inherit;"> , e √© bom ver que eles prestam aten√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao usar a fun√ß√£o font-display: swap, a necessidade de pr√©-carregamento pode n√£o ser t√£o forte. </font><font style="vertical-align: inherit;">Embora, nesse caso, voc√™ ainda possa ganhar tempo baixando o n√∫mero m√≠nimo necess√°rio de fontes e evitando FOUT e redesenho. </font><font style="vertical-align: inherit;">No momento, n√£o usamos pr√©-carregamento no Web Almanac e, antes de come√ßar, precisamos de mais alguns testes, mas por enquanto estou satisfeito com o que √©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Respondendo a uma pergunta no t√≠tulo do artigo: sim, vale a pena, pois o ganho de desempenho √© significativo. </font><font style="vertical-align: inherit;">Obviamente, seus resultados podem variar, porque tudo depende do site espec√≠fico, portanto teste, teste e teste novamente. </font><font style="vertical-align: inherit;">Mas acho que ainda √© a melhor op√ß√£o, em termos de desempenho, para a maioria dos sites.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, o Google Fonts n√£o √© apenas um reposit√≥rio de centenas de fontes gratuitas - √© tamb√©m um mecanismo de entrega inteligente que usa muitas das mais recentes t√©cnicas de otimiza√ß√£o para renderizar as fontes mais adequadas com o m√≠nimo esfor√ßo por parte do propriet√°rio do site. Ao mudar para auto-hospedado, idealmente, √© necess√°rio reimplementar muitas melhorias √∫teis, como exibi√ß√£o de fonte: troca, remo√ß√£o de dicas de fontes (pelo menos em alguns navegadores) ou, caso contr√°rio, voc√™ s√≥ pode prejudicar o desempenho de outras pesadas. arquivos de fonte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta n√£o √© uma tarefa f√°cil (e o Google Fonts faz isso por voc√™, sim). Mas como agora usar apenas o formato WOFF2 √© a √∫nica op√ß√£o realista e os navegadores suportam a maioria das t√©cnicas de otimiza√ß√£o, tudo ficou muito mais f√°cil do que antes. No entanto, vale a pena ter algum conhecimento sobre fontes da Web antes de configurar tudo (espero que este post tenha ajudado!). E, ao mesmo tempo, fique de olho nas novas mudan√ßas no mundo das fontes, pois sem d√∫vida haver√° outras melhorias. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, talvez estiv√©ssemos muito interessados ‚Äã‚Äãem otimiza√ß√£o e, com o armazenamento local, podemos usar a fonte completa, sem subconjuntos e com dicas? No site do Google Fonts, √© poss√≠vel fazer o download de qualquer fonte e √© relativamente simples, embora seja estranho que o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo n√£o inclua os WOFF e WOFF2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ao usar esse m√©todo de carregamento, que √© completamente incompreens√≠vel para mim! </font><font style="vertical-align: inherit;">No entanto, se voc√™ est√° realmente interessado em melhorar o desempenho (e deveria estar interessado!), Tente fazer a coisa certa. </font><font style="vertical-align: inherit;">Este artigo mostra apenas que √© um pouco mais complicado do que apenas baixar e colocar fontes no seu site, como eu sempre esperava. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uau, algo acabou sendo mais longo do que eu esperava! </font><font style="vertical-align: inherit;">Espero que voc√™ tenha o mesmo interesse em entender o t√≥pico e que agora tenha algumas novas id√©ias para acelerar o download de fontes em seu site. </font><font style="vertical-align: inherit;">Eu recomendo que voc√™ siga </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jason</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zach</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no Twitter para saber mais sobre fontes e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para saber mais sobre a velocidade geral dos aplicativos Web.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt490354/index.html">Aprimorando a cultura de seguran√ßa da informa√ß√£o nas empresas de fintech</a></li>
<li><a href="../pt490356/index.html">Apresentando o Kubernetes CCM (Cloud Controller Manager) para Yandex.Cloud</a></li>
<li><a href="../pt490358/index.html">Um programador moderno precisa ser capaz de criar algoritmos?</a></li>
<li><a href="../pt490362/index.html">Kubernetes no esp√≠rito da pirataria: nosso caminho para microsservi√ßos e um modelo pronto para implementa√ß√£o</a></li>
<li><a href="../pt490364/index.html">Os data centers consomem muita eletricidade, mas ainda n√£o amea√ßam o clima</a></li>
<li><a href="../pt490372/index.html">Entrevista na Dodo Pizza</a></li>
<li><a href="../pt490376/index.html">Plural</a></li>
<li><a href="../pt490378/index.html">IPv6 - um mundo maravilhoso que vale uma r√°pida transi√ß√£o para ele</a></li>
<li><a href="../pt490380/index.html">Conclus√£o atrasada do pod quando ele √© exclu√≠do</a></li>
<li><a href="../pt490382/index.html">Conte√∫do # 2 de FunCorp iOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>