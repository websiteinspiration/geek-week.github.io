<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>▶️ 👨🏻‍🏭 🛤️ Explorer le cybergrouping Cobalt: quels nouveaux outils et attaques les pirates utilisent-ils? 👋🏻 👩🏼‍🎨 ⤴️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Des spécialistes du PT Expert Security Center suivent l'activité du groupe Cobalt depuis 2016 . Aujourd'hui, le groupe attaque des institutions financ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Explorer le cybergrouping Cobalt: quels nouveaux outils et attaques les pirates utilisent-ils?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/506932/"><img src="https://habrastorage.org/webt/y2/c0/qd/y2c0qdpfwf0ykktfxq6kcdjxjcc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des spécialistes du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT Expert Security Center</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suivent l'activité du groupe Cobalt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depuis 2016</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Aujourd'hui, le groupe attaque des institutions financières du monde entier. </font><font style="vertical-align: inherit;">Les dégâts causés par ces attaques il y a un an ont </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dépassé le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> milliard de roubles. </font><font style="vertical-align: inherit;">Au cours des quatre dernières années, nous avons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publié</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plusieurs </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapports d'attaques</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> liées à ce groupe.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours de l'année écoulée, le groupe Cobalt a non seulement modifié ses principaux outils CobInt et le compte-gouttes COM-DLL en conjonction avec la porte dérobée JavaScript more_eggs, mais a également utilisé de nouvelles méthodes de livraison et de nouvelles techniques pour contourner la protection au stade initial de l'attaque. </font><font style="vertical-align: inherit;">La mise à jour des tactiques et des outils peut être due au fait que le groupe est ciblé depuis longtemps par des chercheurs du monde entier, et il doit avoir une longueur d'avance pour contourner les moyens de protection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En moyenne, en 2019, le groupe a mené trois attaques par mois. </font><font style="vertical-align: inherit;">Dans notre nouvel article - analyse de nouvelles tactiques et outils de cyber regroupement. </font><font style="vertical-align: inherit;">La version complète de l'étude est disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Site de phishing Banque centrale européenne</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fin août 2019, lors d'une enquête sur les menaces à la sécurité de l'information, nous avons enregistré une attaque à l'aide de CobInt. L'attaque aurait été dirigée contre des institutions financières européennes. Nous n'avons aucune donnée sur son succès. Un programme d'installation NSIS personnalisé a servi de compte-gouttes pour CobInt. Nous avons trouvé trois versions d'un tel compte-gouttes: pour Chrome, Firefox et Opera. À l'intérieur de chacun se trouvait la même version de CobInt et le programme d'installation correspondant pour le navigateur. Après le démarrage, le compte-gouttes a enregistré CobInt dans le dossier% TEMP% et le programme d'installation l'a également lancé. Après avoir analysé les logiciels malveillants, nous avons constaté que la distribution des compte-gouttes se faisait à partir du site phb ecb-european [.] Eu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/by/up/fmbyupvcfdyjqxqtv_rva-ubnay.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accueil du site de phishing</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le site était une copie du site de la Banque centrale européenne - sauf que lors de sa visite, l'utilisateur a affiché une fenêtre contextuelle lui demandant de mettre à jour le navigateur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9i/pn/ni/9ipnniehr72_vbnv0evoyy5m7a4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fenêtre contextuelle sur un faux site Web de la BCE</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En conséquence, le compte-gouttes susmentionné a été téléchargé sur l'ordinateur de l'utilisateur. </font><font style="vertical-align: inherit;">Dans le code source de la page, il y avait un lien vers le script qui affichait cette fenêtre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Très probablement, les utilisateurs se sont rendus sur le site à l'aide d'un e-mail de phishing similaire à ceux que le groupe Cobalt utilise le plus souvent.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Disque dur virtuel malveillant</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fin décembre 2019, nous avons découvert le prochain bootloader CobInt Cobalt. Insolite était le conteneur qui contenait ce chargeur de démarrage. C'était un disque dur virtuel (VHD), qui aurait été envoyé par la poste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le format VHD est utilisé depuis la création de la technologie de virtualisation Hyper-V. Un fichier VHD peut contenir tout ce qui peut être trouvé sur un disque dur normal: des partitions de disque, un système de fichiers avec des dossiers et des fichiers. À partir de Windows 7, l'utilisateur peut connecter manuellement le disque dur virtuel, par exemple via la console MMC. À partir de Windows 8, un utilisateur peut connecter un disque dur virtuel simplement en double-cliquant dessus avec la souris, et il apparaîtra dans le système comme un disque normal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En septembre 2019, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">un article a</font></a><font style="vertical-align: inherit;"> été publié sur le blog du CERT / CC</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les dangers des fichiers VHD et leur utilisation comme vecteur potentiel d'attaques. Will Dorman a montré que ni les antivirus ni les marques sur le Web ne signalent à l'utilisateur que le contenu du fichier VHD téléchargé sur Internet peut endommager l'ordinateur. Il est possible que le groupe Cobalt ait utilisé les résultats de cette étude. Leur fichier VHD n'était pas non plus détecté par les antivirus au moment où il est apparu sur VirusTotal. Six mois plus tard, ce fichier est détecté par un seul antivirus: il s'agit d'un indicateur très faible. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vy/ok/xu/vyokxub26hafxvwac-cdikvtams.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'intérieur du disque dur virtuel se trouvent deux fichiers CobInt. Deux certificats Google non valides sont attachés à la fin de l'un des fichiers pour réduire la probabilité de détection par des éléments de sécurité.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois le disque dur virtuel monté, l'utilisateur doit démarrer manuellement l'un des fichiers. </font><font style="vertical-align: inherit;">Par fonction, les deux fichiers sont identiques. </font><font style="vertical-align: inherit;">Après avoir démarré l'un de CobInt, la bibliothèque principale est chargée. </font><font style="vertical-align: inherit;">La bibliothèque principale est chargée par CobInt depuis le serveur de contrôle sous forme de fichier HTML.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Macro BIFF </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En mars 2020, nous avons enregistré un document du groupe Cobalt au format XLS, qui téléchargeait et exécutait un compte-gouttes COM-DLL. Le document contenait un format de macro Excel 4.0 assez ancien et n'était pratiquement pas détecté par les antivirus (1 verdict sur 60 selon le service VirusTotal). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4n/8m/w-/4n8mw-eh7eh8vodwp2zwbauplg4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nombre de verdicts antivirus sur le premier téléchargement d'un fichier de macro Excel 4.0 vers VirusTotal </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette norme de macro est utilisée depuis 20 ans. Sa particularité est que la macro n'est pas stockée dans un projet VBA, elle est située dans les cellules de la page, tandis que la page peut être masquée dans Excel lui-même. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela signifie que la macro ne sera pas dans le flux VBA, mais dans l'enregistrement BIFF (Binary Interchange File Format).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous ouvrez le document dans Excel, nous ne verrons qu'une seule page et l'absence de macros dans le projet VBA. </font><font style="vertical-align: inherit;">Cependant, Excel détectera toujours la présence d'une macro et bloquera son exécution. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ouvrant le document source dans le gestionnaire de formules, nous verrons que l'une des formules démarre automatiquement lorsque vous ouvrez le document. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/20/9w/e5/209we5fodrts0svk62kuavorzky.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formule de macro qui démarre à l'ouverture du document. La</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
formule initiale lance une grande chaîne de commandes COMBIN, EXECUTE, SYMBOL, CALL, ce qui conduit finalement au chargement et au lancement du dropper COM-DLL. </font><font style="vertical-align: inherit;">La chaîne de commande entière est dispersée à travers un immense champ de cellules dans une page Excel, ce qui rend l'analyse difficile. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ir/fo/tv/irfotvsrlnkddg31oszuzjhnwy4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formules de macro pour télécharger et exécuter un compte-gouttes COM-DLL</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Analyse du compte-gouttes COM-DLL</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Début avril 2020, nous avons découvert une nouvelle version du compte-gouttes COM-DLL. </font><font style="vertical-align: inherit;">En termes de fonctions, il diffère de tout ce que nous avons vu précédemment. </font><font style="vertical-align: inherit;">Cependant, la charge utile sous la forme de la porte dérobée JavaScript more_eggs reste la même. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le compte-gouttes COM-DLL est apparu dans l'arsenal Cobalt à l'été 2017 et est toujours utilisé par le groupe pour fournir la porte dérobée JavaScript </font></font><code>more_eggs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui y est contenue sous forme cryptée et archivée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Caractéristiques compte-gouttes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entièrement écrit en PureBasic.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilise un grand nombre de techniques anti-analyse différentes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il contient un chargeur JavaScript chiffré et archivé, une porte dérobée JavaScript, un utilitaire de conversion de ligne de commande légitime pour lancer la porte dérobée JavaScript more_eggs.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il a un obfuscateur intégré pour la porte dérobée JavaScript et le chargeur JavaScript câblé à l'intérieur.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le groupe Cobalt continue d'attaquer les institutions financières du monde entier, adopte de nouvelles tactiques, met à jour les outils et tente de contourner plus efficacement les défenses. </font><font style="vertical-align: inherit;">En raison de la mise en quarantaine, de nombreux employés du secteur financier et du crédit travaillent désormais "à distance", hors de portée des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recours des entreprises</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">De plus, de nombreux attaquants utilisent le thème du coronavirus dans leurs attaques, comme le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groupe Higaisa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il est possible que le groupe Cobalt essaie d'utiliser ce thème dans ses futures attaques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La version complète de l'étude </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est disponible ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auteurs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Denis Kuvshinov, Sergey Tarasov, Daniil Koloskov, PT Expert Security Center</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr506906/index.html">Les paradoxes du trou noir révèlent le lien fondamental entre l'énergie et l'ordre</a></li>
<li><a href="../fr506908/index.html">Top science. Mai dix médias: désespoir des poissons d'aquarium, voix des troubles mentaux et plusieurs fois COVID</a></li>
<li><a href="../fr506916/index.html">Qu'est-ce qu'un maillage de service?</a></li>
<li><a href="../fr506924/index.html">Comment choisir le meilleur matériau aux premiers stades de la conception?</a></li>
<li><a href="../fr506926/index.html">Analyse: pourquoi la forte augmentation du nombre d'utilisateurs et des revenus de Zoom n'indique pas le succès de l'entreprise après la pandémie</a></li>
<li><a href="../fr506938/index.html">Jeux de la présentation Sony PlayStation 5</a></li>
<li><a href="../fr506940/index.html">La route de l'idéal: un petit guide pour les programmeurs et leurs dirigeants</a></li>
<li><a href="../fr506950/index.html">Qu'est-ce que l'école 21 et pourquoi est-elle ainsi conçue?</a></li>
<li><a href="../fr506952/index.html">Portail API: que rechercher lors de la conception. Expérience Wrike</a></li>
<li><a href="../fr506954/index.html">Un autre article sur Rails et ELK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>