<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö® ü•ã üìÑ Sobre a opera√ß√£o de um PC usando o exemplo do Windows 10 e o teclado da Parte 2 ü¶ã ü§¶üèª üåã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nesta parte, consideraremos para que lado as informa√ß√µes sobre a tecla pressionada do teclado at√© a CPU, haver√° muitas fotos e essa n√£o √© a √∫ltima par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sobre a opera√ß√£o de um PC usando o exemplo do Windows 10 e o teclado da Parte 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489166/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nesta parte, consideraremos para que lado as informa√ß√µes sobre a tecla pressionada do teclado at√© a CPU, haver√° muitas fotos e essa n√£o √© a √∫ltima parte. Vou falar sobre isso do ponto de vista de um programador que escreve no modo de usu√°rio - programas de usu√°rio, web, aplicativos m√≥veis - portanto, pode haver imprecis√µes. √â improv√°vel que as pessoas envolvidas em eletr√¥nicos encontrem algo √∫til para elas mesmas. A primeira parte est√° </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wl/me/mo/wlmemoyr_plutwlcq7nhezslr78.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O problema do ensino superior para programadores √© que os alunos estudam em detalhes aspectos individuais retirados do contexto sem entender como isso tudo se encaixa. V√°rios semestres de matem√°tica superior para entender f√≠sica, para entender engenharia el√©trica, eletrodom√©sticos, montadores, sistemas operacionais, algoritmos, programa√ß√£o de sistemas e um monte de outras disciplinas envolvidas em um programa padr√£o de cinco anos. A abund√¢ncia de detalhes e ningu√©m explica como isso se encaixa no quadro geral, pressup√µe-se que, ap√≥s 5 anos, o aluno o prenda na cabe√ßa e depois trabalhe com o .Net e nunca toque nos modos eletr√¥nico e de kernel. Acredito que n√£o √© necess√°rio conhecer com tanto detalhe o funcionamento de um computador, basta ter um entendimento geral do que est√° acontecendo na pilha tecnol√≥gica. Se as pessoas que compunham os programas de treinamento para universidades abriram escolas de condu√ß√£o,voc√™ aprenderia russo, caligrafia e hidrodin√¢mica, porque precisa se comunicar com os inspetores, trocar fluidos e escrever notas explicativas. Haver√° algumas imprecis√µes no artigo, portanto n√£o ser√° adequado para a aprova√ß√£o no exame em disciplinas especializadas, mas depois ser√° mais f√°cil entender o dispositivo do PC.</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sob tr√°fego de gatos.</font></font></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma tecla do teclado √© um bot√£o que fecha os contatos e uma corrente el√©trica passa por eles. </font><font style="vertical-align: inherit;">O mecanismo de fechamento / abertura √© feito de forma que o bot√£o n√£o precise ser pressionado completamente, pois, caso contr√°rio, os dedos se cansar√£o rapidamente e o teclado n√£o ser√° ergon√¥mico. </font><font style="vertical-align: inherit;">Na se√ß√£o, a chave se parece com isso. </font><font style="vertical-align: inherit;">No lado direito, est√° o contato ao qual a tens√£o √© aplicada.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/g5/c1/ay/g5c1aykcd7h6pbxwih_ci_dcsk0.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O "c√©rebro" do teclado que pode determinar o pressionamento de tecla √© um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">microcontrolador</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que √© essencialmente um mini-computador com um programa que verifica cada tecla aplicando tens√£o a ela e, se ela passar, a tecla ser√° pressionada. As pernas do microcontrolador t√™m nomes pr√≥prios e podem ser acessadas em c√≥digo; s√£o usadas para se comunicar com o mundo exterior. As pernas podem controlar a opera√ß√£o do microcontrolador, relatar o status do chip ou servir para ler / transmitir dados.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/ek/uq/om/ekuqom94exvedvmbel6ky6botvm.png"></td>
<td><img src="https://habrastorage.org/webt/mb/wm/14/mbwm14xm-h71gr7plnv5oglrhak.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O programa ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">firmware</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) pode ser escrito em C ou assembler, √© carregado no microcontrolador atrav√©s do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programador</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . √â um dispositivo com um conector para instalar um microcontrolador e pode ser conectado a um computador via USB, no qual um software especial est√° sendo executado. Aqui est√° a apar√™ncia do programador na vida real:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/4q/qz/ut/4qqzutlhi4hlltp4ubcclyv2rtu.png"></td>
<td><img src="https://habrastorage.org/webt/hy/ex/xj/hyexxj5ezr-gkg4jva6rerfkbnw.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atrav√©s do programa, cada perna pode ser configurada ou medida da tens√£o. </font><font style="vertical-align: inherit;">O algoritmo para encontrar a tecla pressionada √© aplicar tens√£o a uma perna e medi-la na outra, e se a tecla foi pressionada, a segunda perna ter√° aproximadamente o mesmo volt da entrada. </font><font style="vertical-align: inherit;">Assim, em um loop infinito, todas as chaves s√£o verificadas. </font><font style="vertical-align: inherit;">Como regra, o teclado possui 80-110 bot√µes e o controlador de contato (pinos) √© muito menor. </font><font style="vertical-align: inherit;">Portanto, eles usam uma abordagem como a "matriz do teclado" - todas as chaves s√£o distribu√≠das em colunas e linhas, e o algoritmo √© reduzido para encontrar uma coluna que cruza a linha √† qual o programa aplicou a tens√£o. </font><font style="vertical-align: inherit;">A correspond√™ncia de coluna / linha para contatos √© destacada aqui.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/3w/yn/dm3wynvz4faugjchr5h94ywdwgq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na realidade, a matriz pode ser assim. </font><font style="vertical-align: inherit;">√Ä esquerda √© industrial e √† direita √© caseira.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-y/3o/ik/-y3oikaoyykmeihyhgskuihxgoo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No pseudoc√≥digo, a parte do programa de firmware que determina as teclas pressionadas pode ser assim.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; COLSC; i++) {<font></font>
 	SetPower(columns[i], <span class="hljs-number">3.0</span> f);
  	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; ROWSC; j++) {
    		<span class="hljs-keyword">float</span> power = GetPower(rows[j]);
    		<span class="hljs-keyword">if</span> (power &gt;= <span class="hljs-number">3.0f</span> - THRESHOLD) {<font></font>
      			BYTE key = keys[i, j];<font></font>
      			SendKey(key);<font></font>
    		}<font></font>
  	}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada tecla corresponde a um c√≥digo de verifica√ß√£o, √© padronizada e √© um n√∫mero de 8 bits, ou seja, um byte. Portanto, quando a tecla Y for pressionada, o controlador do teclado precisar√° enviar o n√∫mero 21 (0x15) e, quando liberado - 149 (0x95). Como √© feita a remessa? Certamente voc√™ trabalhou com JSON, servi√ßos da Web ou enviou dados entre processos e sabe que para enviar dados √© necess√°rio </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serializar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, transformar em uma matriz de bytes ou texto formatado que o destinat√°rio possa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desserializar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, recrie um objeto em seu espa√ßo de endere√ßo. E o que pode serializar dados em um n√≠vel t√£o baixo? Precisamos transferir apenas 1 byte (8 bits). Olhando para o futuro, direi que transmitiremos dados pouco a pouco.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em matem√°tica, existe uma f√≥rmula que pode converter qualquer n√∫mero decimal que nos seja familiar em uma sequ√™ncia de zeros e uns e vice-versa. Esta f√≥rmula encontrou aplica√ß√£o em tecnologia de computadores. Na primeira parte, mencionei casualmente que a tecnologia anal√≥gica explora as leis da f√≠sica, enquanto o digital funciona no n√≠vel de zeros e uns. Isso significa que um telefone anal√≥gico codifica todo o espectro de uma voz humana em uma sequ√™ncia de ondas eletromagn√©ticas, e um telefone digital usa um microchip que converte uma voz humana em dados digitais, por exemplo, em arquivos WAV, e depois os transfere em uma sequ√™ncia de zeros e outros na forma de ondas eletromagn√©ticas. Somente neste caso, em vez de todo o espectro da voz, apenas dois valores devem ser representados - 0 e 1. Eles podem ser representados por ondas de comprimentos diferentes, tens√µes diferentes,pulsos de luz atrav√©s da fibra √≥ptica, listras preto e branco no papel, orif√≠cios no cart√£o perfurado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo de varredura da tecla Y pressionada no bin√°rio se parece com 0001 0101. N√≥s os transmitiremos ao longo da perna do microcontrolador respons√°vel pelos dados ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DATA</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A unidade l√≥gica</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© 3.3V ou superior, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zero l√≥gico</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- tens√£o √© de cerca de 0V. Aqui est√° o problema - como passo tr√™s zeros seguidos? Para fazer isso, precisamos de uma segunda etapa que chamaremos de CLOCK, quando nela significa que a sess√£o de transmiss√£o de um bit come√ßou e o zero terminou. Essa mudan√ßa nos valores (tens√µes) ocorrer√° com um determinado intervalo de tempo, digamos 50 nanossegundos, porque no outro extremo existe um segundo microcontrolador que trabalha em sua pr√≥pria velocidade e escuta as pernas √†s quais CLOCK e DATA est√£o conectados em um loop sem fim. Neste exemplo, assumirei que o teclado est√° conectado atrav√©s do conector PS2, que √© mostrado abaixo. Atrav√©s da porta USB, o algoritmo de transfer√™ncia ser√° diferente. Como voc√™ pode ver, a porta PS2 possui pinos chamados Data, Clock.Al√©m deles, h√° tamb√©m um contato atrav√©s do qual o controlador de porta PS2 distribui a tens√£o de 5V necess√°ria para a opera√ß√£o do teclado e um contato de terra, que √© simplesmente exibido no corpo do teclado. Outros contatos n√£o s√£o usados.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/8g/ug/g7/8gugg7htfuyfrzclfypvowdzkhq.png"></td>
<td><img src="https://habrastorage.org/webt/dy/zf/_w/dyzf_w-iqlutb2xiju_om0e4abq.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">porta</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PS / 2 √© chamada de </font><i><font style="vertical-align: inherit;">barramento serial</font></i><font style="vertical-align: inherit;"> , porque transmite os bits um por um (uma sequ√™ncia de bits). </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A porta paralela</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> transmite dados de uma s√≥ vez para v√°rios contatos e pode transferir, por exemplo, um byte (8 bits) de uma vez para uma sess√£o de transfer√™ncia de dados. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual √© a diferen√ßa entre uma porta, um barramento e um protocolo? Um barramento, como uma porta, √© um conjunto de contatos (fia√ß√£o) e um acordo sobre como us√°-los, apenas a porta possui uma conex√£o para conectar dispositivos externos e o barramento √© usado para comunicar componentes na placa-m√£e. Uma porta √© essencialmente um barramento com um conector no meio. Um protocolo √© uma intera√ß√£o atrav√©s de contatos. No exemplo com PS / 2, essa era a ordem de transfer√™ncia de dados atrav√©s dos contatos Rel√≥gio e Dados.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anteriormente, o microcontrolador Intel 8042 era muito comum e era usado tanto no teclado quanto como um controlador de porta PS2, ou seja, dois chips id√™nticos trocaram dados. O driver da porta PS2 no Windows √© chamado 8042prt.sys.</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
De fato, transmitimos n√£o 8 bits, mas 11, porque os dados s√£o transmitidos como um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pacote</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mensagem de </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">dados</font></i><font style="vertical-align: inherit;"> . Outros 3 bits indicam o in√≠cio e o fim dos dados - um zero no in√≠cio e 0 1 no final, um protocolo para transferir dados do dispositivo para o host no PS2. Pode parecer com a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SendKey</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no pseudo-c√≥digo, se voc√™ preferir entender o c√≥digo. Ele envia dados sobre a tecla pressionada atrav√©s do barramento PS2.</font></font><br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SendBit</span><span class="hljs-params">(BYTE bit)</span> </span>{
	<span class="hljs-keyword">float</span> power = (bit != <span class="hljs-number">0</span>) ? <span class="hljs-number">3.3f</span> : <span class="hljs-number">0.0f</span>;<font></font>
	SetPower(DATA, power);<font></font>
	SetPower(CLOCK, <span class="hljs-number">3.3f</span>);<font></font>
	Sleep(<span class="hljs-number">50</span>);<font></font>
	SetPower(CLOCK, <span class="hljs-number">0.0f</span>);<font></font>
	Sleep(<span class="hljs-number">50</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SendData</span><span class="hljs-params">(BYTE data)</span> </span>{<font></font>
	SendBit(<span class="hljs-number">0</span>);<font></font>
	<font></font>
	<span class="hljs-keyword">for</span> (BYTE i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(BYTE); i++) {<font></font>
		BYTE bit = (data &gt;&gt; i) &amp; <span class="hljs-number">1</span>;<font></font>
		SendBit(bit);<font></font>
	}<font></font>
<font></font>
	SendBit(<span class="hljs-number">0</span>);<font></font>
	SendBit(<span class="hljs-number">1</span>);<font></font>
}<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nem sempre √© necess√°rio definir manualmente a tens√£o em cada perna individualmente para transfer√™ncia de dados. </font><font style="vertical-align: inherit;">Em alguns casos, o valor armazenado no registro √© exibido automaticamente nos contatos. </font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No gr√°fico, essa transfer√™ncia de dados ser√° visualizada da seguinte maneira. </font><font style="vertical-align: inherit;">O tempo √© ao longo do eixo X, a tens√£o √© ao longo do eixo Y.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/cy/p8/zscyp8ur1i1t0lmau3n50evbuke.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na tecnologia anal√≥gica, o sinal pode estar distorcido, isto √©, </font><font style="vertical-align: inherit;">o fio n√£o est√° conectado a nada, mas o volt√≠metro mostra 0,5V nele devido ao fato de haver um campo eletromagn√©tico pr√≥ximo. </font><font style="vertical-align: inherit;">Portanto, o conceito de tens√£o limite √© usado. </font><font style="vertical-align: inherit;">Se a tens√£o for menor que o limite, assumimos que obtivemos um zero l√≥gico, caso contr√°rio, a unidade. </font><font style="vertical-align: inherit;">Levando em considera√ß√£o poss√≠veis distor√ß√µes, o c√≥digo de digitaliza√ß√£o da tecla Y pressionada pode ser assim:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sl/u4/3k/slu43kce6evjxlk3qgrzzwpfhmg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de examinarmos de perto como os dados do teclado chegam √† CPU, vamos falar sobre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">microchips</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">barramentos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">m√£e</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microcontroladores e microcircuitos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O microcontrolador pode executar um programa costurado nele, possui uma certa quantidade de mem√≥ria RAM e um local para armazenar dados e c√≥digo do programa. No </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chip, o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> programa pode ser definido na fase de design. A cria√ß√£o manual de um circuito el√©trico implementando um algoritmo consome muito tempo e, portanto, uma linguagem de programa√ß√£o especial chamada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VHDL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Linguagem de Descri√ß√£o de Hardware) </font><font style="vertical-align: inherit;">pode ser usada para projetar microcircuitos </font><font style="vertical-align: inherit;">. Esta √© uma linguagem de programa√ß√£o de alto n√≠vel que √© traduzida em um plano de circuito, √© executada atrav√©s de um programa que encontra a localiza√ß√£o ideal dos elementos de r√°dio no quadro e √© feita, finalmente, em forma f√≠sica. As imagens s√£o apenas para fins ilustrativos.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6c/rt/vp/6crtvpo861utguxs56v37-7syx4.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gk/r8/q7/gkr8q7m78x8ldyxvdxu7tp9pxhc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como os dados e comandos s√£o representados em microchips e microcontroladores? </font><font style="vertical-align: inherit;">A base da tecnologia computacional √© um transistor, que a humanidade aprendeu a fabricar em dimens√µes microsc√≥picas. </font><font style="vertical-align: inherit;">Um transistor √© um elemento de r√°dio que possui tr√™s pernas: uma entrada, uma sa√≠da e entre eles um controle que abre ou fecha uma corrente entre duas pernas. </font><font style="vertical-align: inherit;">A figura abaixo ilustra a opera√ß√£o do transistor, a √°gua ilustra a corrente.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/1g/kj/bw/1gkjbwtax3xmpshjmbllzgpvkoo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A tens√£o √© aplicada √† perna de entrada; se o controle tiver tens√£o, a corrente passa para a sa√≠da; caso contr√°rio, haver√° 0V. </font><font style="vertical-align: inherit;">Tendo 8 transistores, cada um dos quais com um LED conectado √† sa√≠da que acende ou n√£o, podemos imaginar 256 combina√ß√µes √∫nicas (2 √† pot√™ncia de 8). </font><font style="vertical-align: inherit;">Lapochki s√£o interpretados da direita para a esquerda, bem como n√∫meros decimais. </font><font style="vertical-align: inherit;">Os d√≠gitos inferiores est√£o √† direita.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/bt/gb/9l/btgb9ln9dejdgz-v-e7l_6mjx9u.png"></td>
<td><img src="https://habrastorage.org/webt/vb/js/yg/vbjsygneuovkp0ocaml6yfvoigy.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa. </font><font style="vertical-align: inherit;">uma l√¢mpada representa um bit de informa√ß√£o (0 ou 1) e oito l√¢mpadas correspondem a um byte. </font><font style="vertical-align: inherit;">√â poss√≠vel criar operadores l√≥gicos AND, OR, NOT, XOR em transistores.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wu/rw/gz/wurwgzgga7mny0qhn3daju6hdic.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, no circuito do operador AND (√† esquerda na figura acima), a sa√≠da s√≥ ter√° voltagem se as duas voltagens de entrada forem diferentes de zero. </font><font style="vertical-align: inherit;">Algu√©m j√° inventou algoritmos para adi√ß√£o, multiplica√ß√£o, divis√£o e subtra√ß√£o com base em opera√ß√µes l√≥gicas bit a bit e mudan√ßas de bits. </font><font style="vertical-align: inherit;">Os fabricantes de chips precisam apenas implement√°-los. </font><font style="vertical-align: inherit;">A opera√ß√£o do algoritmo de adi√ß√£o bit a bit √© ilustrada abaixo; n√£o iremos analis√°-lo:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9k/t3/m5/9kt3m5uiw9wp1xk7ferifgngpzi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os nanotransistores s√£o microsc√≥picos e podem ser colocados na placa aos milh√µes. </font><font style="vertical-align: inherit;">O processador Intel √© mostrado abaixo e como pode ser a apar√™ncia de um de seus n√∫cleos. </font><font style="vertical-align: inherit;">A imagem √© ilustrativa.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hy/77/gt/hy77gt038gktsayjog-kg9rh65u.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os microcircuitos podem conter um microcontrolador na mesma placa e no mesmo caso.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pneus</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalmente, nos livros did√°ticos, os pneus s√£o mostrados como setas em negrito, como na figura abaixo. </font><font style="vertical-align: inherit;">Isso √© feito para n√£o desenhar todas as conex√µes dos contatos, que podem ser muitas. </font><font style="vertical-align: inherit;">A opera√ß√£o do barramento PS2 √© muito simples, tudo o que voc√™ precisa √© de tr√™s pinos. </font><font style="vertical-align: inherit;">Mas existem √¥nibus que, por exemplo, t√™m 124 contatos para transfer√™ncia de dados.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zu/-a/vd/zu-avduvaicswxtkaeihnnwureu.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem os seguintes tipos de pneus:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os bits de dados nesses contatos s√£o interpretados como dados: n√∫mero, s√≠mbolo, parte de uma imagem ou outros dados bin√°rios. </font><font style="vertical-align: inherit;">A largura do barramento afeta a taxa de transfer√™ncia, o n√∫mero de bits transmitidos por segundo</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endere√ßos - os bits desses pinos s√£o interpretados como um endere√ßo f√≠sico na mem√≥ria. </font><font style="vertical-align: inherit;">A largura desse barramento determina a capacidade m√°xima de RAM suportada.</font></font></li>
<li> ‚Äî          . CPU         RAM   I/O.</li>
<li>.         ,      .    ATX 24 Pin 12V PSU Connector,       .<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/am/cb/mq/amcbmq-jxkqdth45s_79xrg6uwa.png"></div></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pneu pode consistir em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">substratos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , isto √©, </font><font style="vertical-align: inherit;">alguns contatos s√£o usados ‚Äã‚Äãpara dados, outros para endere√ßos, outros para controle e contatos para os quais a energia √© transmitida. </font><font style="vertical-align: inherit;">A abordagem em que os mesmos contatos s√£o usados ‚Äã‚Äãalternadamente para transmitir dados e endere√ßos √© chamada de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multiplexa√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Por exemplo, o processador Intel 8086 possui um barramento de dados e endere√ßo de 20 bits. No diagrama de pinos, seus contatos s√£o indicados por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AD0-AD19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (pernas 16-2 e 39-35).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jp/wy/tx/jpwytxl5cbiuv_hky79ledmfzjk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em um caso mais complexo, podemos ter v√°rios microcircuitos conectados aos mesmos contatos. </font><font style="vertical-align: inherit;">Para comunica√ß√£o normal, eles precisam de um chip adicional que determine quem em que ponto do tempo os poder√° usar, chamado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controlador de barramento.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Na figura abaixo, um barramento esf√©rico no v√°cuo: quatro microcontroladores id√™nticos transmitem dados ao microcontrolador consumidor atrav√©s do controlador de barramento. O fio vermelho √© a tens√£o que o controlador de barramento distribui para todos os chips conectados a ele. Os dados s√£o transmitidos atrav√©s dos fios verdes e a ‚Äúnegocia√ß√£o‚Äù com o controlador de barramento √© realizada, e o fio azul √© Clock, atrav√©s do qual o controlador de barramento sincroniza a comunica√ß√£o dos controladores, porque eles podem operar em velocidades diferentes. Se a unidade l√≥gica estiver no fio azul, o chip autorizado a usar o barramento poder√° executar um ato de intera√ß√£o com o mundo exterior - leia um pouco, por exemplo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3a/tc/pq/3atcpqqtqdpmnbvrjho1h1y-bww.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O controlador de barramento pode ser considerado como um componente integral, porque a comunica√ß√£o com o mundo externo passar√° por ele e quantos chips ou dispositivos externos reais realmente est√£o no barramento n√£o s√£o importantes. </font><font style="vertical-align: inherit;">Para transfer√™ncia de dados, a placa-m√£e possui uma extensa rede de barramento. </font><font style="vertical-align: inherit;">Apesar do grande n√∫mero de chipsets, eles geralmente seguem um layout t√≠pico, porque todos os dispositivos conectados √† placa-m√£e s√£o divididos em:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lento - teclado, disco r√≠gido, placa de rede, √°udio etc. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√°pido - CPU, RAM, GPU. </font></font></li>
</ul><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Com base nessa divis√£o, a placa-m√£e possui dois chips principais - a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ponte Sul</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que coordena o trabalho de todos os dispositivos lentos, e a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ponte Norte,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para coordena√ß√£o de dispositivos r√°pidos. Nos computadores modernos, o Northbridge est√° localizado na pr√≥pria CPU e o Southbridge pode ser chamado de Platform Controller Hub, mas isso n√£o muda a ess√™ncia. Ambas as pontes s√£o interconectadas por um barramento atrav√©s do qual se informam sobre eventos significativos. De particular interesse √© o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerador de rel√≥gio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pelo qual o processador, a RAM e a placa gr√°fica sincronizam seu trabalho, o mesmo fio azul. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Overclock</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isso est√° essencialmente alterando as configura√ß√µes do BIOS para que a sincroniza√ß√£o ocorra com mais frequ√™ncia, enquanto o hardware, principalmente a CPU, esquenta mais, consome mais energia e desenvolve mais rapidamente seus recursos. O oposto √© o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rel√≥gio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quando a velocidade diminui para economizar energia da bateria ou reduzir o ru√≠do. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um chipset</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© um conjunto de chips que foram projetados para funcionar entre si. Eles fornecem comunica√ß√£o entre os componentes na placa-m√£e e fornecem funcionalidades como temporizadores. O chipset funciona com apenas uma marca de processador; a AMD n√£o pode ser inserida na placa-m√£e com o chipset Intel; eles ainda t√™m contatos diferentes. O diagrama da placa-m√£e √© apresentado abaixo:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/hd/zk/ld/hdzkldbz0h6vjddegg2iqwir-f0.png"></td>
<td><img src="https://habrastorage.org/webt/2h/sl/-f/2hsl-f2t77a-x4xy0dn5xqo2ua0.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deseja um exemplo de encapsulamento de hardware? </font><font style="vertical-align: inherit;">Os chipsets Intel t√™m um chip chamado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Super IO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √© mostrado na figura abaixo e √© conectado √† ponte sul atrav√©s do barramento LPC. </font><font style="vertical-align: inherit;">LPC √© o nome inteligente para a fia√ß√£o CLOCK, DATA, VCC (POWER). </font><font style="vertical-align: inherit;">Esse chip cont√©m a emula√ß√£o de todos os chips antigos que j√° foram usados ‚Äã‚Äãpara perif√©ricos, incluindo o chip 8042 que foi usado para a porta PS2. </font><font style="vertical-align: inherit;">H√° tamb√©m um emulador de controlador de porta para disquete e outras rel√≠quias que interferem no progresso. </font><font style="vertical-align: inherit;">No diagrama geral da placa-m√£e, o Super IO e o barramento </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LPC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o indicados acima </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bf/wx/sm/bfwxsm3i9gekd4yjd0uizbusb3u.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A moderna porta PS2 se conecta diretamente ao chip Super I / O. </font><font style="vertical-align: inherit;">Verde √© o teclado, roxo √© o mouse. </font><font style="vertical-align: inherit;">Anteriormente, ele era conectado ao microcontrolador Intel 8042.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ae/za/tj/aezatje8p9gbwod0uap92v7sv-e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A placa-m√£e √© feita de diel√©trico, ou seja, </font><font style="vertical-align: inherit;">material que n√£o conduz corrente. </font><font style="vertical-align: inherit;">A corrente pode passar apenas pelas linhas impressas no quadro. </font><font style="vertical-align: inherit;">A placa-m√£e possui muitas camadas, cada uma com seus pr√≥prios contatos impressos e, portanto, se voc√™ perfurar a placa-m√£e onde as linhas n√£o s√£o vis√≠veis, poder√° estrag√°-la danificando os contatos invis√≠veis dentro da placa. </font><font style="vertical-align: inherit;">Agora voc√™ pode dar uma olhada no processo de distribui√ß√£o de dados do PS2 para a CPU.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A estrada do PS2 para o processador</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalmente, a arquitetura do computador √© considerada no processador 8086. Por um lado, isso √© correto, porque √© bastante simples comparado √†s CPUs modernas e, por outro lado, est√° errado, porque √© antigo e n√£o reflete a arquitetura de uma m√°quina moderna. O Intel 8086 n√£o precisava de pontes, porque era t√£o lento que podia funcionar com perif√©ricos em um barramento, ou seja, em uma frequ√™ncia. N√£o conhe√ßo os modernos conjuntos de chips e CPU, ent√£o vou explicar sobre os fict√≠cios que se assemelham aos reais. No meu exemplo, haver√° uma CPU fict√≠cia muito semelhante √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel 8086</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. O chip Super IO possui mais de cem contatos e existe documenta√ß√£o na Internet, mas n√£o vejo o ponto de determinar quais pinos o teclado e o barramento LPC realmente usam para se comunicar com South Bridge. O principal √© o princ√≠pio, que pode ser implementado de diferentes maneiras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos dar uma r√°pida olhada na foto para lembrar que j√° passamos. As setas verdes indicam o caminho que vamos seguir.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/82/ic/2e/82ic2e8smxmv-z0epnfxzk1f6n8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, os dados do teclado j√° chegaram ao controlador de porta PS2, que j√° foi um chip Intel 8042, e agora √© emulado pelo chip Super IO. E agora vamos analisar o curso de a√ß√µes adicionais na minha placa-m√£e fict√≠cia com uma CPU fict√≠cia. O controlador PS2 recebeu um c√≥digo de varredura da tecla Y pressionada e agora fornece tens√£o ao sinal de contato (linha roxa, veja a figura abaixo) na qual o controlador de interrup√ß√£o program√°vel deve notificar sobre os dados do teclado. Esse sinal √© transmitido de um chip para outro at√© que a ponte norte o passe ao gerente de interrup√ß√£o.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zh/jb/jb/zhjbjbwyj8dgyhydsaeryyfyfrm.jpeg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlador de interrup√ß√£o program√°vel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel 8259</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de chips </font><font style="vertical-align: inherit;">em que 8 p√©s (seus nomes IRQ0-IRQ7) s√£o reservadas para receber notifica√ß√µes de determinadas portas ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nterrupt </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uest). Um teclado est√° vinculado ao pino IRQ1, IRQ7 a uma impressora, disquete a algum pino, placa de som, portas paralelas e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">outras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Obviamente, pode haver muito mais do que oito dispositivos, portanto, uma t√©cnica como cascata foi usada quando outro PIC semelhante foi conectado a uma perna com o nome IRQ2, no qual a contagem n√£o come√ßou de 0, mas 7. O mouse est√° vinculado ao IRQ12, ou seja, p√© IRQ5 no segundo PIC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O controlador de interrup√ß√£o agora deve notificar a CPU do evento no teclado. Isso acontece da seguinte maneira:</font></font><br>
<ol>
<li>      INT (Interrupt) ,     INTR (<i>Interrupt Request</i>) . CPU            ,        , ..       .     ,       .        exception  .</li>
<li>               INTR,        .</li>
<li>       ( D0-D7)  ,    .      PIC          (   IRQ).<br>
<br>
<i> ,   ?     .               .   ‚Äî      (x, y, z, w).        .</i></li>
<li>CPU     AD0-AD7  ,  .      IDT (<i>Interrupt Descriptior Table</i>)    ,     ,         .   CPU   .<br>
<br>
<i>             .       .    ,   IDT        C# .</i><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">IDT_entry</span>{</span>
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> offset_lowerbits;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> selector;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> zero;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> type_attr;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> offset_higherbits;<font></font>
};<font></font>
 <font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">IDT_entry</span> <span class="hljs-title">IDT</span>[256];</span>
</code></pre></li>
<li>        ,          INTA (<b>Int</b>errupt <b>A</b>cknowledged).<br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O manipulador de interrup√ß√£o do teclado no c√≥digo mais simples ficar√° assim. Ele chama um comando que sinaliza a conclus√£o do processamento de interrup√ß√£o, ou seja, envia um sinal para o p√© INTA.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">irq1_handler</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
	  outb(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x20</span>); <span class="hljs-comment">//EOI</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode aprender mais sobre como a tabela de vetores de interrup√ß√£o √© configurada no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">osdev</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora sabemos como ocorreu a interrup√ß√£o, mas n√£o sabemos como o manipulador de interrup√ß√£o l√™ informa√ß√µes sobre a tecla pressionada. Do ponto de vista do software, a porta PS2 √© dois registros, s√≥ que eles n√£o s√£o acessados por nomes ou endere√ßos na mem√≥ria </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pelo n√∫mero da porta I / O</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esses dois registros de byte √∫nico s√£o atribu√≠dos √†s portas 0x60 e 0x64, o primeiro (0x60) conter√° o c√≥digo de verifica√ß√£o da chave. A segunda porta √© usada para transferir status e comandos para a porta PS2 (n√£o o teclado!). O conjunto de arquitetura x86 instru√ß√£o tem o comando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IN </font></font></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">storeTo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fromPortNum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que l√™ o valor da porta de E / S especificada no registro especificado. </font><font style="vertical-align: inherit;">Por exemplo, IN AL, 0x60 salvar√° os dados do teclado no registro AL. </font><font style="vertical-align: inherit;">Pode funcionar algo como isto:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No processador que estamos considerando, existem pernas AD0-AD20, elas podem ser usadas para indicar o endere√ßo e os dados. </font><font style="vertical-align: inherit;">Este √© um barramento de dados e um barramento de endere√ßos. </font><font style="vertical-align: inherit;">Al√©m deles, h√° v√°rias pernas de controle, por exemplo, pino n¬∫ 28 (S2), cujo valor indicar√° para a ponte norte onde a leitura ocorrer√° - a partir da mem√≥ria ou de um dispositivo de entrada / sa√≠da. </font><font style="vertical-align: inherit;">O comando IN define o valor aqui falando sobre o dispositivo de E / S.</font></font></li>
<li>   CPU (-   AD0-AD20)   0110 0000,    0x60.      CPU    ,     .        , -   , - .       0x60        SuperIO ,    -    .</li>
<li>    Super IO            .   0x60        PS2,         . </li>
<li>    .   Intel 8042,     SuperIO,   LPC       ,       . ..        ,    .</li>
<li>     CPU              (- 8   AD0-AD20). </li>
<li> CPU                   AL.         .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo esse algoritmo funciona em escala de nanossegundos e, portanto, √© executado quase instantaneamente, mesmo que o processador tenha passado algum tempo aguardando a opera√ß√£o de E / S. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como agora voc√™ entende a leitura de dispositivos externos, mesmo como mem√≥ria RAM, etc. CPU √© bastante lenta. Essa lentid√£o pode ser percebida escrevendo um programa que imprime 10.000 linhas em um arquivo linha por linha, em vez de copi√°-las para o buffer e salvar imediatamente. O disco r√≠gido est√° conectado √† ponte sul e, dentro dela, tamb√©m existe um controlador que controla o posicionamento direto dos dados.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A RAM est√° conectada √† CPU atrav√©s do barramento e a leitura demora algum tempo. Para acelerar a CPU, ela possui um cache, ou seja, A √°rea na qual os transistores est√£o localizados, representando dados que em breve ser√£o necess√°rios ou usados ‚Äã‚Äãcom frequ√™ncia, sua leitura √© muito mais r√°pida que na placa de RAM, que se comunica com a CPU atrav√©s da Ponte Norte. A RAM √© chamada de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mem√≥ria de acesso aleat√≥rio din√¢mico</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , porque os capacitores s√£o usados ‚Äã‚Äãpara representar dados nela. Um capacitor √© um elemento de r√°dio que, como uma bateria, mant√©m a carga por um tempo at√© que esteja completamente descarregada. Somente aqui a descarga ocorre muito rapidamente. Portanto, os capacitores devem ser recarregados, isso acontece instantaneamente, basta aplicar tens√£o. Capacitor carregado - l√≥gico 1, caso contr√°rio 0. Para a mem√≥ria cache √© usada</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM est√°tica,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou seja, </font><font style="vertical-align: inherit;">ele n√£o precisa ser recarregado e, portanto, funciona mais r√°pido, mas custa mais. </font><font style="vertical-align: inherit;">O cache √© dividido em 3 n√≠veis, que s√£o verificados sequencialmente durante a pesquisa dos dados solicitados antes do processador acessar a RAM. </font><font style="vertical-align: inherit;">Em processadores mais antigos, o cache de primeiro n√≠vel (L1) fazia parte da CPU e trabalhava com ele na mesma frequ√™ncia, quando os caches L2 e L3 eram chips externos. </font><font style="vertical-align: inherit;">Agora eles est√£o todos no mesmo chip que o processador. </font><font style="vertical-align: inherit;">O cache L1 √© o mais r√°pido e menor em tamanho de mem√≥ria, L2 tem mais mem√≥ria, mas mais lento. </font><font style="vertical-align: inherit;">L3 √© o maior cache e o mais lento, geralmente chamado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cache compartilhado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , porque armazena dados para todos os n√∫cleos da CPU, enquanto L1 e L2 s√£o criados para cada n√∫cleo individual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na pr√≥xima parte, falaremos sobre como o Windows recebe e processa os dados recebidos.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt489146/index.html">802.11ba (WUR) ou como cruzar uma cobra com um ouri√ßo</a></li>
<li><a href="../pt489156/index.html">Quem √© mais inteligente que a IDEA?</a></li>
<li><a href="../pt489160/index.html">Resultados de um estudo sobre ofertas de emprego para um designer de produto digital. Parte I - Resultados e Estat√≠sticas</a></li>
<li><a href="../pt489162/index.html">O gerente entregar√°</a></li>
<li><a href="../pt489164/index.html">Atualiza√ß√£o do cluster Kubernetes sem tempo de inatividade</a></li>
<li><a href="../pt489172/index.html">Apertamos a autoriza√ß√£o do ActiveDirectory para o Kubernetes com Keycloak</a></li>
<li><a href="../pt489174/index.html">Princ√≠pio de responsabilidade √∫nica (SRP) com o Laravel</a></li>
<li><a href="../pt489178/index.html">GSMout - receba SMS e chamadas "em casa"</a></li>
<li><a href="../pt489188/index.html">Efetuando login em um ambiente .Net de microsservi√ßo na pr√°tica</a></li>
<li><a href="../pt489190/index.html">Estudo RedHat: c√≥digo aberto substitui software propriet√°rio do segmento corporativo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>