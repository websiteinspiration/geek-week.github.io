<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😿 🧘 🛬 LogRock：ロギングによるテスト 👈🏿 ⛽️ 🍙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="LogRock：ロギングによるテスト
 2年以上にわたり、私たちはCleverbrushプロジェクトに取り組んできました。これはベクターグラフィックスを操作するためのソフトウェアです。グラフィカルエディターでの作業は、アプリケーションの使用例が非常に多いことを意味します。私たちはお金と時間を節約しよ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>LogRock：ロギングによるテスト</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453652/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0a0/8fe/e87/0a08fee87984969110aef2080f4687ae.png" alt="ログロック"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LogRock：ロギングによるテスト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2年以上にわたり、私たちは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cleverbrush</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトに取り組んできました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これはベクターグラフィックスを操作するためのソフトウェアです。</font><font style="vertical-align: inherit;">グラフィカルエディターでの作業は、アプリケーションの使用例が非常に多いことを意味します。</font><font style="vertical-align: inherit;">私たちはお金と時間を節約しようとしているので、テストを含むすべてを最適化します。</font><font style="vertical-align: inherit;">各オプションでテストケースをカバーすることは、特にすべてのオプションをカバーすることが不可能であるため、コストがかかり、非合理的です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発中に、React JSアプリケーション用のモジュールが作成されました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-LogRock（github）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモジュールを使用すると、最新のロギングアプリケーションを整理できます。</font><font style="vertical-align: inherit;">ログに基づいて、テストを実行します。</font><font style="vertical-align: inherit;">この記事では、このモジュールを使用する際の複雑さと、ロギングを使用してテストを整理する方法について説明します。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何が問題ですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムを生物と比較すると、そのバグは病気です。</font><font style="vertical-align: inherit;">この「病気」の原因には、特定のユーザーの環境など、さまざまな要因が考えられます。</font><font style="vertical-align: inherit;">これは、Webプラットフォームを検討している場合に特に当てはまります。</font><font style="vertical-align: inherit;">時々、因果関係は非常に複雑で、テスト中に発見されたバグは、いくつかのイベントの結果です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
人間の病気と同様に、誰も患者よりも症状をうまく説明できず、テスターは何が起こったのかをプログラム自体よりもよく知ることができません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何をすべきか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が起こっているのかを理解するには、アプリケーションでユーザーが実行したアクションのリストが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのプログラム自体が「痛い」ことを教えてくれるように、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LogRock</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュール</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">（github）</font></a><font style="vertical-align: inherit;">を取り、ElasticSearch、LogStash、Kibanaに関連付けます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/1d6/7ea/6d41d67ea5bd247827fd03948fc8b0dd.png" alt="画像"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ElasticSearch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は強力な全文検索エンジンです。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ElasticSearchチュートリアルを見ることができ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LogStash</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、</font><b><font style="vertical-align: inherit;">ElasticSearch</font></b><font style="vertical-align: inherit;">などのログを送信できるさまざまなソースからログを収集するためのシステムです。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kibanaは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、多くのアドオンでElasticSearchへのWebインターフェイスです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使い方？</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dcf/06e/706/dcf06e706a5ae052a2f15eaf09e45c93.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラーが発生した場合（またはオンデマンドで）、アプリケーションはサーバーにログを送信し、ファイルに保存されます。</font><font style="vertical-align: inherit;">LogstashはElasticSearchのデータをデータベースに増分保存します。</font><font style="vertical-align: inherit;">ユーザーはKibanaにログインし、保存されたログを確認します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e19/0b0/244/e190b0244b22db314385b5156e5c56cd.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
よく調整された木花のようです。</font><font style="vertical-align: inherit;">ElasticSearchからのデータを表示します。</font><font style="vertical-align: inherit;">Kibanaは、テーブル、グラフ、マップなどの形式でデータを表示できます。これは、アプリケーションで何が起こっているのかを分析して理解するのに非常に便利です。</font></font><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事では、ElasticStackのセットアップについては説明しません！</font></font></u></b><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロギングシステムの作成</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例として、Reactで作成された1ページのJSアプリケーションにロギングシステムを統合します。</font><font style="vertical-align: inherit;">アプリケーションがどのフレームワークに書き込まれるかは問題ではありません。</font><font style="vertical-align: inherit;">ログシステムを構築する方法について説明します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.お客様</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0 LogRock。</font><font style="vertical-align: inherit;">取り付け</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LogRock</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
への</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">リンク</font></a><font style="vertical-align: inherit;">インストールするには、次の操作を行う必要があります。</font></font><br>
<br>
<pre><code class="bash hljs">npm install logrock<font></font>
<font></font>
yarn add logrock</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1 LogRock。</font><font style="vertical-align: inherit;">アプリケーションのセットアップ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、アプリケーションをコンポーネントでラップします</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { LoggerContainer } <span class="hljs-keyword">from</span> <span class="hljs-string">"logrock"</span>;<font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoggerContainer</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">LoggerContainer</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LoggerContainerは、アプリケーションエラーに応答してスタックを形成するコンポーネントです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタックは、ユーザーのオペレーティングシステム、ブラウザ、どのマウスまたはキーボードのボタンが押されたか、そしてもちろん、actionsサブ配列に関する情報を持つオブジェクトです。ここには、ユーザーがシステムで実行したすべてのユーザーアクションが記録されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LoggerContainerにはいくつかの設定があります。それらのいくつかを検討してください</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;LoggerContainer<font></font>
    active={<span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>}<font></font>
    limit={<span class="hljs-number">20</span>}<font></font>
    onError={stack =&gt; {<font></font>
        sendToServer(stack);<font></font>
    }}<font></font>
&gt;<font></font>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>
&lt;/LoggerContainer&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
active- </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
制限</font><font style="vertical-align: inherit;">ロガーを有効または無効にします</font><font style="vertical-align: inherit;">-保存する最近のユーザーアクションの数に制限を設定します。</font><font style="vertical-align: inherit;">ユーザーが21のアクションを実行すると、この配列の最初のアクションが自動的に削除されます。</font><font style="vertical-align: inherit;">したがって、エラーの前の最後の20のアクションが表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
onError-エラーが発生したときに呼び出されるコールバック。</font><font style="vertical-align: inherit;">Stackオブジェクトが入り、環境、ユーザーアクションなどに関するすべての情報が格納されます。</font><font style="vertical-align: inherit;">このコールバックから、このデータをElasticSearchまたはバックエンドに送信するか、さらに分析および監視するためにファイルに保存する必要があります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2 LogRock。</font><font style="vertical-align: inherit;">ロギング</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーアクションの高品質なログを作成するには、コードをログ呼び出しでカバーする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LogRockモジュールはLoggerContainerに関連付けられているロガーが付属しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、コンポーネントを持っていると仮定します</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Toggle</span>(<span class="hljs-params">props</span>) </span>{
    <span class="hljs-keyword">const</span> [toggleState, setToggleState] = useState(<span class="hljs-string">"off"</span>);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggle</span>(<span class="hljs-params"></span>) </span>{<font></font>
        setToggleState(toggleState === <span class="hljs-string">"off"</span> ? <span class="hljs-string">"on"</span> : <span class="hljs-string">"off"</span>);<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">switch</span> ${<span class="hljs-attr">toggleState</span>}`} <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggle}</span> /&gt;</span></span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログで適切にカバーするには、トグルメソッドを変更する必要があります</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggle</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> state = toggleState === <span class="hljs-string">"off"</span> ? <span class="hljs-string">"on"</span> : <span class="hljs-string">"off"</span>;<font></font>
    logger.info(<span class="hljs-string">`React.Toggle|Toggle component changed state <span class="hljs-subst">${state}</span>`</span>);<font></font>
    setToggleState(state);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
情報を2つの部分に分割するロガーを追加しました。</font><font style="vertical-align: inherit;">React.Toggleは、このアクションがTactコンポーネントであるReactのレベルで発生したことを示します。次に、このコンポーネントに入ってきたアクションと現在の状態について口頭で説明します。</font><font style="vertical-align: inherit;">レベルへのそのような分離は必要ありませんが、このアプローチを使用すると、コードが実行された場所がより明確になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラーが発生した場合は、Reactバージョン16で導入された「componentDidCatch」メソッドを使用することもできます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.サーバーの相互作用</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の例を考えてみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックエンドからユーザーデータを収集するメソッドがあるとします。</font><font style="vertical-align: inherit;">メソッドは非同期で、ロジックの一部はバックエンドに隠されています。</font><font style="vertical-align: inherit;">このコードを正しく記録するにはどうすればよいですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、クライアントアプリケーションがあるため、サーバーに送信されるすべてのリクエストは、ページを再読み込みすることなく、単一のユーザーセッションを経由します。</font><font style="vertical-align: inherit;">クライアントのアクションをサーバーのアクションに関連付けるには、グローバルSessionIDを作成し、それをサーバーへの各リクエストのヘッダーに追加する必要があります。</font><font style="vertical-align: inherit;">サーバーでは、フロントエンドからの例のようにロジックをカバーする任意のロガーを使用できます。エラーが発生した場合は、ElasticのsessionIDが添付されたこのデータをバックエンドプレートに送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.クライアントでSessionIDを生成します</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>.SESSION_ID = <span class="hljs-string">`sessionid-<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">3</span>, <span class="hljs-number">9</span>)}</span>`</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.サーバーへのすべてのリクエストにSessionIDを設定する必要があります。</font><font style="vertical-align: inherit;">クエリにライブラリを使用する場合、すべてのクエリのSessionIDを宣言することで、これは非常に簡単です。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> fetch = axios.create({...});<font></font>
fetch.defaults.headers.common.sessionId = <span class="hljs-built_in">window</span>.SESSION_ID;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. LoggerContainerには、SessionIDの特別なフィールドがあります</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;LoggerContainer<font></font>
    active={<span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>}<font></font>
    sessionID={<span class="hljs-built_in">window</span>.SESSION_ID}<font></font>
    limit={<span class="hljs-number">20</span>}<font></font>
    onError={stack =&gt; {<font></font>
        sendToServer(stack);<font></font>
    }}<font></font>
&gt;<font></font>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>
&lt;/LoggerContainer&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.リクエスト自体（クライアント上）は次のようになります。</font></font><br>
<br>
<pre><code class="javascript hljs">logger.info(<span class="hljs-string">`store.getData|User is ready for loading... User ID is <span class="hljs-subst">${id}</span>`</span>);<font></font>
<font></font>
getData(<span class="hljs-string">'/api/v1/user'</span>, { id })<font></font>
    .then(<span class="hljs-function"><span class="hljs-params">userData</span> =&gt;</span> {<font></font>
        logger.info(<span class="hljs-string">`store.getData|User have already loaded. User count is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(userData)}</span>`</span>);<font></font>
    })<font></font>
    .catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {<font></font>
        logger.error(<span class="hljs-string">`store.getData|User loaded fail <span class="hljs-subst">${err.message}</span>`</span>);<font></font>
    });</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての仕組み：クライアントでのリクエストの前に、ログが書き込まれます。</font><font style="vertical-align: inherit;">私たちのコードによると、サーバーからのデータのロードが開始されることがわかります。</font><font style="vertical-align: inherit;">リクエストにSessionIDを添付しました。</font><font style="vertical-align: inherit;">このSessionIDが追加されたログで覆われたバックエンドがあり、リクエストが失敗した場合、バックエンドで何が起こったかを確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、クライアントだけでなくバックエンドでもアプリケーションのサイクル全体を監視します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.テスター</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テスターでの作業は、プロセスの個別の説明に値します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちにはスタートアップがあるので、正式な要件はなく、時にはすべてが論理的に機能しないことがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テスターが動作を理解していない場合、これは少なくとも検討する必要があるケースです。</font><font style="vertical-align: inherit;">また、多くの場合、テスターは1つの状況を2回繰り返すことはできません。</font><font style="vertical-align: inherit;">不正な動作に至るまでのステップは、数が多く、簡単ではない場合があるためです。</font><font style="vertical-align: inherit;">さらに、すべてのエラーが例外などの重大な結果につながるわけではありません。</font><font style="vertical-align: inherit;">それらのいくつかは、アプリケーションの動作を変更できるだけで、システムによってエラーとして解釈されません。</font><font style="vertical-align: inherit;">これらの目的のために、ステージング時に、アプリケーションヘッダーにボタンを追加して、ログの送信を強制できます。</font><font style="vertical-align: inherit;">テスターは何かが正しく機能していないことを確認し、ボタンをクリックして、アクションを含むスタックをElasticSearchに送信します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/154/7f0/5531547f03a044eda98449e829d67839.png" alt="画像"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでも重大なエラーが発生した場合は、インターフェースをブロックして、テスターがそれ以上クリックしないで行き止まりにならないようにする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの目的のために、私たちは死のブルースクリーンを表示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上部にこの重大なエラーのスタックが表示されたテキストが表示され、以下にその前のアクションが表示されます。</font><font style="vertical-align: inherit;">エラーIDも取得します。テスターはそれを選択してチケットに添付します。</font><font style="vertical-align: inherit;">後でこのエラーは、このIDによってKibanaで簡単に見つけることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f3/5b8/4b7/7f35b84b746e584111ce64e6416e1f36.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの目的のために、LoggerContainerには独自のプロパティがあります。</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;LoggerContainer<font></font>
    active={<span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>}<font></font>
    limit={<span class="hljs-number">20</span>}<font></font>
    bsodActive={<span class="hljs-literal">true</span>}<font></font>
    bsod={BSOD}<font></font>
    onError={stack =&gt; {<font></font>
        sendToServer(stack);<font></font>
    }}<font></font>
&gt;<font></font>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>
&lt;/LoggerContainer&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bsodActive-BSODを有効/無効にします（BSODの無効化は製品コードに適用されます）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bsodはコンポーネントです。</font><font style="vertical-align: inherit;">デフォルトでは、上記のスクリーンショットのようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UI LoggerContainerにボタンを表示するには、コンテキストで使用できます</font></font><br>
<br>
<pre><code class="javascript hljs">context.logger.onError(context.logger.getStackData());</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. LogRock。</font><font style="vertical-align: inherit;">ユーザーインタラクション</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログをコンソールに出力したり、ユーザーに表示したりできます。これには、stdoutメソッドを使用する必要があります。</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;LoggerContainer<font></font>
    active={<span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>}<font></font>
    limit={<span class="hljs-number">20</span>}<font></font>
    bsodActive={<span class="hljs-literal">true</span>}<font></font>
    bsod={BSOD}<font></font>
    onError={stack =&gt; {<font></font>
        sendToServer(stack);<font></font>
    }}<font></font>
    stdout={(level, message, important) =&gt; {<font></font>
          <span class="hljs-built_in">console</span>[level](message);<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (important) {<font></font>
              alert(message);<font></font>
          }<font></font>
    }}<font></font>
&gt;<font></font>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>
&lt;/LoggerContainer&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stdoutは、メッセージの表示を担当するメソッドです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージが重要になるためには、ロガーに2番目のパラメーターをtrueに渡すだけで十分です。</font><font style="vertical-align: inherit;">したがって、このメッセージはポップアップウィンドウでユーザーに表示できます。たとえば、データのロードに失敗した場合、エラーメッセージを表示できます。</font></font><br>
<br>
<pre><code class="javascript hljs">logger.log(<span class="hljs-string">'Something was wrong'</span>, <span class="hljs-literal">true</span>);</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高度なロギング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのストアでReduxまたは同様のソリューションを使用する場合、ミドルウェアにロガーを配置してアクションを処理できます。これにより、すべての重要なアクションがシステムを通過します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
効果的なロギングを行うには、データをプロキシオブジェクトでラップし、オブジェクトを使用するすべてのアクションにロガーを配置できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロギングでサードパーティのメソッド（ライブラリメソッド、レガシーコードメソッド）をカバーするには、デコレータ-"@"を使用できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">助言</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際のユーザーよりも優れているため、テスターがボトルネックを見つけることはないため、実稼働環境を含むログアプリケーション。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用許諾契約にログの収集を示すことを忘れないでください。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワード、銀行の詳細、その他の個人情報は記録しないでください！</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログの冗長性も悪いので、署名をできるだけ明確にしてください。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代替案</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のアプローチとして、私は強調します：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロールバーは高度にカスタマイズ可能です。</font><font style="vertical-align: inherit;">1か月あたり150ドルで50万件のエラーを記録できます。</font><font style="vertical-align: inherit;">アプリケーションをゼロから開発している場合は、これを使用することをお勧めします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sentryは統合が簡単ですが、カスタマイズ性は低くなります。</font><font style="vertical-align: inherit;">1か月あたり200ドルで100万件のイベントを記録できます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どちらのサービスでも、ほぼ同じことができ、バックエンドに統合できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次は何ですか</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロギングは、エラーの検索だけでなく、ユーザーのアクションやデータ収集も監視します。</font><font style="vertical-align: inherit;">ログは、Googleアナリティクスとユーザーエクスペリエンスの検証を補完するものとして役立ちます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリをリリースすると、彼にとって人生は始まったばかりです。</font><font style="vertical-align: inherit;">あなたの頭脳に責任を持ち、フィードバックを得て、ログを監視し、それを改善してください。</font><font style="vertical-align: inherit;">高品質のソフトウェアを書き、繁栄する:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Angular、Vueなどのモジュールの開発を支援したい場合。</font><font style="vertical-align: inherit;">私はリクエストをプルして喜んでいます- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453628/index.html">あなたは20年で何を支払いますか？</a></li>
<li><a href="../ja453634/index.html">システム分析のアルファ銀行学校</a></li>
<li><a href="../ja453642/index.html">単語で書かれた数のスマートパーサー</a></li>
<li><a href="../ja453644/index.html">インタビュー-Swiftに関する10の質問。パート3</a></li>
<li><a href="../ja453650/index.html">F-35ユニファイドストライクファイターソフトウェアオンボードサイバーインフラストラクチャ</a></li>
<li><a href="../ja453656/index.html">静的ウェブ：基本に戻りますか？</a></li>
<li><a href="../ja453660/index.html">Intelは、コアあたり5 GHzのターボ周波数を備えた新しいi9-9900KSプロセッサーを示しました</a></li>
<li><a href="../ja453662/index.html">火星-北極近くのさらに深い氷</a></li>
<li><a href="../ja453664/index.html">Spring Boot-OAuth2とJWT</a></li>
<li><a href="../ja453666/index.html">無人タクシーに乗る方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>