<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍🎨 🚫 🐸 Como criamos a galeria de arte em redes neurais e por que não damos fotos para copiar 👩🏿‍🚒 ⏺️ 🍄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoje lançamos uma galeria virtual onde todas as imagens são criadas por uma rede neural. Sua peculiaridade é que apenas uma pessoa pode tirar cada fot...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Como criamos a galeria de arte em redes neurais e por que não damos fotos para copiar</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/493190/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hoje lançamos uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galeria</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> virtual </font><font style="vertical-align: inherit;">onde todas as imagens são criadas por uma rede neural. Sua peculiaridade é que apenas uma pessoa pode tirar cada foto em tamanho real. Quase como em uma galeria real. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste post, falarei sobre como essa ideia nasceu e como a implementamos usando duas redes neurais, uma das quais é usada na pesquisa Yandex.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/7w/ge/up/7wgeupvzbfnaze2xnkflpwzjz5g.jpeg"></a><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idéia</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Experimentamos muito com GANs e tentamos encontrar a idéia de um projeto bonito e compreensível no qual pudéssemos mostrar nossas realizações. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu já tinha um projeto de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ganarts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que lancei para mim e para meus amigos. </font><font style="vertical-align: inherit;">Era apenas uma página na qual as imagens em forma de impressão em uma camiseta eram geradas infinitamente. </font><font style="vertical-align: inherit;">Eles foram gerados pela rede neural StyleGAN, treinada em estilos de arte escolhidos a dedo com o wikiart.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project Gif</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/gh/cj/-l/ghcj-lsrc7_z7dwq_riy_wxnsp8.gif"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tomamos essa ideia como base. Mas eu não queria fazer apenas outro gerador de fotos no site. E, no processo de discussão, surgiu o conceito de uma galeria de arte com várias salas temáticas, onde cada imagem não deveria ter mais que um proprietário. De acordo com nossa ideia, isso deve conectar a galeria virtual às galerias mais familiares nas quais cada imagem tem um proprietário específico. Ao mesmo tempo, sendo capaz de gerar milhões de imagens, limitamos especificamente seu número para que cada usuário que conseguisse capturar uma foto sentisse sua singularidade. E também adicionamos uma restrição - você pode tirar mais de uma foto -, por isso é muito mais interessante escolher. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementação</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como a empresa Nvidia publicou o código para treinar a rede neural StyleGAN, é bastante difícil surpreender alguém com as imagens geradas. Seus autores conseguiram criar uma arquitetura bastante universal, que mostra bons resultados em diferentes dados. Um avanço também foi o fato de o modelo poder ser treinado em uma resolução suficientemente alta (1024 × 1024) por um tempo aceitável e com melhor qualidade do que a dos concorrentes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entusiastas "alimentaram" para ela tudo o que estava à mão. Se você estiver interessado em olhar para esses projetos, aqui está uma lista dos mais impressionantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Pessoas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thispersondoesnotexist.com</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Anime: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.thiswaifudoesnotexist.net</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Gatos: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thesecatsdonotexist.com</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">Personagens de</font></a><font style="vertical-align: inherit;"> Game of Thrones: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nanonets.com/blog/stylegan-got</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Carros: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/SyntopiaDK/status/1094337819659644928</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Logos: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/matthewjarvisw/status/1110548997729452035</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Desenhos para crianças: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/roberttwomey/status/1239050186120282113</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Erros: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/karim_douieb54st</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- quadrinhos Garfield: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/willynguen/status/1220382062554898433</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Fontes: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/cyrildiagne/status/1095603397179396098</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Imagens do microscópio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/MichaelFriese10/status/1229453681516412928</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Pokemon: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/MichaelFriese10/status/ 1210305621121064960</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mas o progresso não </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">pára</font></a><font style="vertical-align: inherit;"> e, no final de 2019, a Nvidia lançou a segunda versão</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StyleGAN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Uma visão geral detalhada de todas as alterações pode ser lida </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no Habré</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A principal melhoria visível é livrar-se de artefatos característicos de gotículas, alterando o método de normalização de ativações na rede. Depois de experimentar a nova arquitetura em nosso conjunto de dados inicial, também notamos um aumento na variedade de pinturas geradas, que não podiam deixar de se alegrar. Nossa hipótese: isso ocorreu devido a um aumento no número de parâmetros na segunda versão da arquitetura, o que nos permitiu aprender mais "modos" na distribuição de dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro bônus interessante da segunda versão do StyleGAN foi o espaço latente "mais suave". Simplificando, isso permite que você faça um fluxo suave entre fotos diferentes:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/4dYphfhu-MI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar as pinturas, usamos a arquitetura StyleGAN2. Ensinamos a rede neural sobre obras pertencentes a diferentes áreas da pintura: do fauvismo e cubismo ao minimalismo e arte de rua. No total, existem cerca de 40 mil pinturas no conjunto de treinamento, com base nas quais imagens completamente novas são geradas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nossa galeria possui quatro salas temáticas: "Pessoas", "Natureza", "Cidade" e "Humor". Para dividir as pinturas em salas, usamos a rede neural, que é usada no Yandex.Pictures. Ela aprende sobre os cliques do usuário emitindo imagens em uma solicitação de texto. Nosso conjunto de dados de treinamento interno é grande o suficiente para que essa rede neural possa descobrir até os padrões gerados. Ela ajudou a selecionar automaticamente as imagens, de acordo com nossos pedidos de texto, a partir de um grande número de imagens aleatórias. Por exemplo, para uma sala chamada "Pessoas", as pinturas foram selecionadas a pedido de "beleza", "dança redonda", "data", "mestre" e assim por diante. Isso criou uma sensação de salas temáticas, e as consultas iniciais serviram como nomes para as pinturas. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultado</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/67/nl/ut/67nlut1rdydjqllagly9il2dto8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Fizemos uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galeria</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de quatro mil pinturas, cada uma das quais pode encontrar seu dono. </font><font style="vertical-align: inherit;">Com esta galeria virtual, queremos reduzir ainda mais a distância entre a criatividade da rede neural e a arte mais tangível. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acredito que o processo de seleção de uma imagem pelo usuário também possa ser chamado de manifestação de criatividade. </font><font style="vertical-align: inherit;">E espero que, no futuro, haja muito mais oportunidades de escolha criativa.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493170/index.html">Versão Werf 1.1: melhorias no colecionador hoje e planos para o futuro</a></li>
<li><a href="../pt493172/index.html">Quanto maior, pior ou por que o loop do jogo é importante</a></li>
<li><a href="../pt493178/index.html">Tudo é incrível em software, mas todo mundo está infeliz</a></li>
<li><a href="../pt493184/index.html">Desenvolvimento de contrato de eletrônica. Cálculo do projeto</a></li>
<li><a href="../pt493186/index.html">Os melhores artigos relacionados a automóveis para desenvolvedores em Habré [170+]</a></li>
<li><a href="../pt493192/index.html">Jogo ASCII - um compromisso de autenticidade e conveniência</a></li>
<li><a href="../pt493196/index.html">Preparando-se para o SHAD sem sair de casa</a></li>
<li><a href="../pt493198/index.html">Como visualizar e animar modelos (geofísicos). Modelos Voxel e superfícies de malha</a></li>
<li><a href="../pt493200/index.html">Distribuição de um cavalo esférico no vácuo em toda a Federação Russa</a></li>
<li><a href="../pt493202/index.html">O RBK.money lançou o primeiro processamento de pagamentos de código aberto do mundo - criando o futuro juntos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>