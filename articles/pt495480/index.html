<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñäÔ∏è ‚ìÇÔ∏è üåâ Criando liga√ß√µes Python para bibliotecas C / C ++ usando SIP. Parte 1 üôèüèº üà¥ üîü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√Äs vezes, ao trabalhar em um projeto em Python, h√° um desejo de usar uma biblioteca que n√£o seja escrita em Python, mas, por exemplo, em C ou C ++. As...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Criando liga√ß√µes Python para bibliotecas C / C ++ usando SIP. Parte 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495480/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Äs vezes, ao trabalhar em um projeto em Python, h√° um desejo de usar uma biblioteca que n√£o seja escrita em Python, mas, por exemplo, em C ou C ++. As raz√µes para isso podem ser diferentes: primeiro, o Python √© uma linguagem maravilhosa, mas em algumas situa√ß√µes n√£o √© r√°pida o suficiente. E se voc√™ perceber que o desempenho √© limitado pelos recursos da linguagem Python, faz sentido escrever parte do programa em outra linguagem (neste artigo, falaremos sobre C e C ++), organize essa parte do programa como uma biblioteca, fa√ßa liga√ß√µes Python (liga√ß√µes Python) por cima e use o m√≥dulo assim obtido como uma biblioteca Python normal. Em segundo lugar, geralmente ocorre uma situa√ß√£o quando voc√™ sabe que existe uma biblioteca que resolve o problema necess√°rio, mas, infelizmente, essa biblioteca n√£o est√° escrita em Python, mas no mesmo C ou C ++.Nesse caso, tamb√©m podemos criar uma liga√ß√£o Python sobre a biblioteca e us√°-la sem pensar no fato de que a biblioteca n√£o foi originalmente escrita em Python.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem v√°rias ferramentas para criar liga√ß√µes Python, desde as de n√≠vel inferior, como a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Python / C,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at√© as de n√≠vel superior, como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SWIG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu n√£o tinha o objetivo de comparar maneiras diferentes de criar liga√ß√µes Python, mas gostaria de falar sobre o b√°sico do uso de uma ferramenta, a saber, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Inicialmente, o SIP foi projetado para criar uma liga√ß√£o em torno da biblioteca Qt - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyQt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e tamb√©m √© usado para desenvolver outras grandes bibliotecas Python, por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wxPython</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, o gcc ser√° usado como o compilador para C e o g ++ ser√° usado como o compilador C ++. </font><font style="vertical-align: inherit;">Todos os exemplos foram testados no Arch Linux e Python 3.8. </font><font style="vertical-align: inherit;">Para n√£o complicar os exemplos, o t√≥pico de compila√ß√£o para diferentes sistemas operacionais e o uso de diferentes compiladores (por exemplo, Visual Studio) n√£o est√° inclu√≠do no escopo deste artigo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode baixar todos os exemplos deste artigo no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reposit√≥rio no github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O reposit√≥rio com fontes SIP est√° localizado em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.riverbankcomputing.com/hg/sip/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O Mercurial √© usado como o sistema de controle de vers√£o do SIP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fazendo uma liga√ß√£o sobre uma biblioteca em C</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escrevendo uma biblioteca em C</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este exemplo est√° localizado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na fonte, mas neste artigo iremos assumir que estamos fazendo tudo do zero. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar com um exemplo simples. </font><font style="vertical-align: inherit;">Primeiro, criaremos uma biblioteca C simples, que ser√° executada a partir de um script Python. </font><font style="vertical-align: inherit;">Deixe nossa biblioteca ser a √∫nica fun√ß√£o</font></font><br>
<br>
<pre><code class="plaintext hljs">int foo(char*);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
que </font><i><font style="vertical-align: inherit;">pegar√°</font></i><font style="vertical-align: inherit;"> uma string e retornar√° seu comprimento multiplicado por 2. O </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
arquivo de cabe√ßalho </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode parecer, por exemplo, assim:</font></font><br>
<br>
<pre><code class="plaintext hljs">#ifndef FOO_LIB<font></font>
#define FOO_LIB<font></font>
<font></font>
int foo(char* str);<font></font>
<font></font>
#endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E o arquivo com a implementa√ß√£o do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;string.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int foo(char* str) {<font></font>
	return strlen(str) * 2;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para testar a funcionalidade da biblioteca, escreveremos um programa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simples </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;stdio.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int main(int argc, char* argv[]) {<font></font>
	char* str = "0123456789";<font></font>
	printf("%d\n", foo(str));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para maior precis√£o, crie um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=gcc<font></font>
CFLAGS=-c<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
	$(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.c<font></font>
	$(CC) $(CFLAGS) main.c -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.c<font></font>
	$(CC) $(CFLAGS) foo.c -o $(DIR_OUT)/foo.o<font></font>
	ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
	mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
	rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deixe todas as fontes da biblioteca </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localizadas em uma subpasta de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na pasta de origem:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Make‚îÄ‚îÄ Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos para a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e compilamos as fontes usando o comando</font></font><br>
<br>
<pre><code class="bash hljs">make
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante a compila√ß√£o, o texto ser√° exibido.</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O resultado da compila√ß√£o ser√° colocado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dentro da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Lib ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Main ‚îú‚îÄ‚îÄ main</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Make‚îÄ‚îÄ Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilamos uma biblioteca para vincula√ß√£o est√°tica e um programa que a usa com o nome </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ap√≥s a compila√ß√£o, voc√™ pode verificar se o programa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inicia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos criar uma liga√ß√£o Python sobre a biblioteca foo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fundamentos do SIP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro voc√™ precisa instalar o SIP. </font><font style="vertical-align: inherit;">Isso √© feito de maneira padr√£o, como em todas as outras bibliotecas usando pip:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user sip
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, se voc√™ estiver trabalhando em um ambiente virtual, o par√¢metro --user, indicando que a biblioteca SIP precisa ser instalada na pasta do usu√°rio e n√£o globalmente no sistema, n√£o deve ser especificado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que precisamos fazer para que a biblioteca foo possa ser chamada a partir do c√≥digo Python? No m√≠nimo, voc√™ precisa criar dois arquivos: um deles no formato TOML e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">denomine pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e o segundo √© um arquivo com a extens√£o .sip. Vamos lidar com cada um deles sequencialmente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos concordar com a estrutura da fonte. Dentro da </font><font style="vertical-align: inherit;">pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que cont√©m a fonte da biblioteca. Ap√≥s a compila√ß√£o </font><font style="vertical-align: inherit;">, a pasta </font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;"> √© criada </font><font style="vertical-align: inherit;">dentro da </font><font style="vertical-align: inherit;">pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que conter√° todos os arquivos compilados. </font><font style="vertical-align: inherit;">Posteriormente, adicionaremos a capacidade do usu√°rio especificar os caminhos para os arquivos de cabe√ßalho e objeto da biblioteca atrav√©s da linha de comando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os arquivos necess√°rios para o SIP estar√£o localizados na mesma pasta que a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyproject.toml</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o √© uma inven√ß√£o dos desenvolvedores do SIP, mas o formato de descri√ß√£o do projeto Python descrito no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 517 "Um formato independente do sistema de compila√ß√£o para as √°rvores de origem"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518 "Especificando os Requisitos M√≠nimos do Sistema de Compila√ß√£o para Projetos Python"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Este √© um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo TOML</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que pode ser considerado como uma vers√£o mais avan√ßada do formato ini, na qual os par√¢metros s√£o armazenados na forma de "chave = valor" e os par√¢metros podem ser localizados n√£o apenas em se√ß√µes como [foo], chamadas de tabelas em termos de TOML, mas e em subse√ß√µes do formul√°rio [foo.bar.spam]. Os par√¢metros podem conter n√£o apenas cadeias, mas tamb√©m listas, n√∫meros e valores booleanos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este arquivo deve descrever tudo o que √© necess√°rio para criar um pacote Python, e n√£o necessariamente usando o SIP. </font><font style="vertical-align: inherit;">No entanto, como veremos um pouco mais tarde, em alguns casos, esse arquivo n√£o ser√° suficiente e, al√©m disso, ser√° necess√°rio criar um pequeno script Python. </font><font style="vertical-align: inherit;">Mas vamos falar sobre tudo em ordem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma descri√ß√£o completa de todos os par√¢metros poss√≠veis do arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> relacionados ao SIP pode ser encontrada na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√°gina de documenta√ß√£o do SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o nosso exemplo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crie o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arquivo </font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;"> no mesmo n√≠vel da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lib ‚îÇ ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ main</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Make ‚îî‚îÄ‚îÄ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O conte√∫do de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√° o seguinte:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A se√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[build-system]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ("table" em termos de TOML) √© padr√£o e est√° descrita no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ele cont√©m dois par√¢metros:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - uma lista de pacotes necess√°rios para compilar nosso pacote. </font><font style="vertical-align: inherit;">O formato de descri√ß√£o da depend√™ncia do pacote √© descrito na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica√ß√£o de depend√™ncia do PEP 508 para pacotes de software Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nesse caso, precisamos apenas da vers√£o 5.x do pacote sip.</font></font></li>
<li><i>build-backend</i> ,        .  ,          Python-,    .        ,   ,    SIP,     ¬´sipbuild.api¬ª.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outros par√¢metros s√£o descritos nas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se√ß√µes [tool.sip. *]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A se√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cont√©m informa√ß√µes gerais sobre o pacote: o nome do pacote a ser montado (nosso pacote ser√° chamado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas n√£o confunda esse nome com o nome do m√≥dulo, que importaremos posteriormente para o Python), o n√∫mero da vers√£o do pacote (no nosso caso) n√∫mero da vers√£o "0.1") e licen√ßa (por exemplo, " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mais importante do ponto de vista da montagem √© descrito em [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anote o nome do pacote no cabe√ßalho da se√ß√£o. </font><font style="vertical-align: inherit;">Adicionamos dois par√¢metros a esta se√ß√£o:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cabe√ßalhos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - uma lista de arquivos de cabe√ßalho necess√°rios para usar a biblioteca foo.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bibliotecas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - uma lista de arquivos de objetos compilados para vincula√ß√£o est√°tica.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">incluem-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o caminho onde procurar por arquivos de cabe√ßalho adicionais, al√©m daqueles que est√£o ligados ao compilador C. Neste caso, para onde olhar para o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arquivo </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o caminho para procurar arquivos de objetos adicionais al√©m daqueles anexados ao compilador C. Nesse caso, esta √© a pasta na qual o arquivo de biblioteca compilado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo √© criado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, criamos o primeiro arquivo necess√°rio para o SIP. </font><font style="vertical-align: inherit;">Agora passamos a criar o pr√≥ximo arquivo que descrever√° o conte√∫do do futuro m√≥dulo Python.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyfoo.sip</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na mesma pasta que o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lib ‚îÇ ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ main</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Make ‚îî‚îÄ‚îÄ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um arquivo com a extens√£o .sip descreve a interface da biblioteca de origem, que ser√° convertida em um m√≥dulo em Python. </font><font style="vertical-align: inherit;">Esse arquivo tem seu pr√≥prio formato, que consideraremos agora, e se assemelha ao arquivo de cabe√ßalho C / C ++ com marca√ß√£o adicional, o que deve ajudar o SIP a criar um m√≥dulo Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso exemplo, esse arquivo deve ser chamado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , porque antes disso, no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criamos as [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] No caso geral, pode haver v√°rias parti√ß√µes e, portanto, deve haver v√°rios arquivos * .sip. Mas se tivermos v√°rios arquivos sip, esse √© um caso especial do ponto de vista do SIP, e n√£o o consideraremos neste artigo. Observe que, no caso geral, o nome do arquivo .sip (e, consequentemente, o nome da se√ß√£o) pode n√£o coincidir com o nome do pacote especificado no par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na se√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do nosso exemplo:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo, language=<span class="hljs-string">"C"</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linhas que come√ßam com o caractere "%" s√£o chamadas de diretivas. Eles devem informar ao SIP como montar e estilizar adequadamente o m√≥dulo Python. Uma lista completa de diretivas √© descrita </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nesta p√°gina de documenta√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Algumas diretivas possuem par√¢metros adicionais. Os par√¢metros podem n√£o ser necess√°rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste exemplo, usamos duas diretivas; conheceremos outras diretivas nos exemplos a seguir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> come√ßa com a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module (nome = foo, idioma = ‚ÄúC‚Äù)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Observe que </font><font style="vertical-align: inherit;">especificamos o </font><font style="vertical-align: inherit;">valor do primeiro par√¢metro ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nome</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) sem aspas e o valor do segundo par√¢metro ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">idioma</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) entre aspas, como cadeias de caracteres em C / C ++. </font><font style="vertical-align: inherit;">Este √© um requisito desta diretiva, conforme descrito na documenta√ß√£o para a diretiva </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">apenas o par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© necess√°rio </font><font style="vertical-align: inherit;">, que define o nome do m√≥dulo Python do qual importaremos a fun√ß√£o de biblioteca. </font><font style="vertical-align: inherit;">Nesse caso, o m√≥dulo √© chamado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ele conter√° a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; portanto, ap√≥s a montagem e instala√ß√£o, o importaremos usando o c√≥digo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Poder√≠amos tornar esse m√≥dulo aninhado em outro m√≥dulo substituindo esta linha, por exemplo, por esta:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo.bar, language=<span class="hljs-string">"C"</span>)<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, importe a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo seria</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a seguinte:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo.bar <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">language</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indica o idioma em que a biblioteca de origem est√° gravada. </font><font style="vertical-align: inherit;">O valor deste par√¢metro pode ser "C" ou "C ++". </font><font style="vertical-align: inherit;">Se esse par√¢metro n√£o for especificado, o SIP assumir√° que a biblioteca est√° gravada em C ++. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora observe a √∫ltima linha do arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta √© uma descri√ß√£o da interface da fun√ß√£o da biblioteca que queremos colocar no m√≥dulo Python. </font><font style="vertical-align: inherit;">Com base nesta declara√ß√£o, o sip criar√° uma fun√ß√£o Python. </font><font style="vertical-align: inherit;">Eu acho que tudo deve ficar claro aqui.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> N√≥s coletamos e verificamos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora tudo est√° pronto para criar um pacote Python com uma liga√ß√£o para uma biblioteca C. Primeiro, voc√™ precisa construir a pr√≥pria biblioteca. </font><font style="vertical-align: inherit;">V√° para a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01 / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e inicie a compila√ß√£o usando o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">$ make<font></font>
<font></font>
mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se tudo der certo, a </font><font style="vertical-align: inherit;">pasta </font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;"> ser√° criada </font><font style="vertical-align: inherit;">dentro da </font><font style="vertical-align: inherit;">pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , na qual, entre outros arquivos, haver√° uma biblioteca </font><i><font style="vertical-align: inherit;">libfoo.a</font></i><font style="vertical-align: inherit;"> compilada </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Deixe-me lembr√°-lo que aqui, para n√£o nos distrairmos do t√≥pico principal, estamos apenas falando sobre a cria√ß√£o no Linux usando o gcc. </font><font style="vertical-align: inherit;">
Volte para a pasta </font><i><font style="vertical-align: inherit;">pyfoo_c_01</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Agora √© hora de conhecer as equipes do SIP. </font><font style="vertical-align: inherit;">Ap√≥s a instala√ß√£o do SIP, os seguintes comandos da linha de comando ficar√£o dispon√≠veis ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">p√°gina de documenta√ß√£o</font></a><font style="vertical-align: inherit;"> ):</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cria um arquivo de objeto de extens√£o Python.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cria um arquivo de objeto de extens√£o Python e o instala.</font></font></li>
<li><i>sip-sdist</i>.      .tar.gz,      pip.</li>
<li><i>sip-wheel</i>.     wheel (   .whl).</li>
<li><i>sip-module</i>.  ,      ,   SIP.  ,    ,    .         ,       standalone project,      ,     ,     ,    .</li>
<li><i>sip-distinfo</i>.     <i>.dist-info</i>,       wheel.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esses comandos precisam ser executados na pasta em que o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° </font><i><font style="vertical-align: inherit;">localizado</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, para entender melhor a opera√ß√£o do SIP, execute o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , com a op√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--verbose</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para obter uma sa√≠da mais detalhada no console e veja o que acontece durante o processo de constru√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build --verbose</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Essas liga√ß√µes ser√£o criadas: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gerando as liga√ß√µes do pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilando o m√≥dulo 'foo' ... </font><font style="vertical-align: inherit;">
criando a </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
extens√£o 'foo' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criando build </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
criando build / temp.linux-x86_64-3.8</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c sipfoocmodule.c -o build / temp.linux-x86_64-3.8 / sipfoocmodule.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: Na fun√ß√£o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
func_foo </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">sipfoocmodule .c: 29: 22: aviso: declara√ß√£o impl√≠cita de fun√ß√£o ‚Äúfoo‚Äù [-Wimplicit-function-statement] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c array.c -o build / temp.linux-x86_64-3.8 / array.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c bool.cpp -o build / temp.linux-x86_64-3.8 / bool.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c objmap.c -o build / temp.linux-x86_64-3.8 / objmap.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c qtlib.c -o build / temp.linux-x86_64-3.8 / qtlib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c int_convertors.c -o build / temp.linux-x86_64-3.8 / int_convertors.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c voidptr.c -o build / temp.linux-x86_64-3.8 / voidptr.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c apiversions.c -o build / temp.linux-x86_64-3.8 / apiversions.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c descriptors.c -o build / temp.linux-x86_64-3.8 / descriptors.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c threadss.c -o build / temp.linux-x86_64-3.8 / </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
threadss.o gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fno-sem√¢ntica-interposi√ß√£o -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -march = x86-64 -mtune = gen√©rico -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c siplib.c -o build / temp.linux-x86_64-3.8 / siplib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Na fun√ß√£o "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">9536: 16: aviso: "st" pode ser usado sem inicializa√ß√£o nesta fun√ß√£o [-Pode ser n√£o inicializado] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 10671: 19: nota: "st" foi declarado aqui </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Na fun√ß√£o "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: aviso: "propriet√°rio" pode ser usado sem inicializa√ß√£o nesta fun√ß√£o [-Pode ser n√£o inicializado] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * propriet√°rio = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^ ~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
g ++ -pthread -shared -Wl, -O1, - classificar comum, - conforme necess√°rio, -z, relro, -z, agora -fno-sem√¢ntica-interposi√ß√£o -Wl, -O1, - classificar comum, Agora, voc√™ pode usar o seguinte comando: http: //support.microsoft.com/kb/610716/pt-br / bool.o build / temp.linux-x86_64-3.8 / objmap.o build / temp.linux-x86_64-3.8 / qtlib.o build / temp.linux-x86_64-3.8 / int_convertors.o build / temp.linux-x86_64 -3.8 / voidptr.o build / temp.linux-x86_64-3.8 / apiversions.o build / temp.linux-x86_64-3.8 / descriptors.o build / temp.linux-x86_64-3.8 / threadss.o build / temp.linux -x86_64-3.8 / siplib.o -L ../../ foo / bin -L / usr / lib -lfoo -o / home / jenyay / projects / soft / sip-examples / pyfoo_c_01 / build / foo / foo. cpython-38-x86_64-linux-gnu.so </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O projeto foi constru√≠do.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o vamos nos aprofundar no trabalho do SIP, mas pode ser visto pela sa√≠da que algumas fontes est√£o compilando. </font><font style="vertical-align: inherit;">Essas fontes podem ser vistas na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criada por este comando </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Build‚îÄ‚îÄ compila√ß√£o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îî‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ apiversions.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ array.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ array.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bool.cpp</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Build ‚îú‚îÄ‚îÄ compila√ß√£o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instalar o temp.linux-x86_64-3.8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ apiversions.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ array.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ bool.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ descritores.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Int ‚îÇ ‚îú‚îÄ‚îÄ int_convertors.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Map ‚îÇ ‚îú‚îÄ‚îÄ objmap.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ qtlib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ip ‚îÇ ‚îú‚îÄ‚îÄ sipfoocmodule.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ siplib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ threads.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ voidptr.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ descriptors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fo ‚îú‚îÄ‚îÄ foo.cpython-38-x86_64-linux-gnu.so</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Int ‚îú‚îÄ‚îÄ int_convertors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Map ‚îú‚îÄ‚îÄ objmap.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ qtlib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ip ‚îú‚îÄ‚îÄ sipAPIfoo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S ‚îú‚îÄ‚îÄ sipfoocmodule.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ sip.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ sipint.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ siplib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ threads.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îî‚îÄ‚îÄ voidptr.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lib ‚îÇ ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ main</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Make ‚îî‚îÄ‚îÄ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As fontes auxiliares apareceram </font><font style="vertical-align: inherit;">
na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Por curiosidade, vejamos o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipfoocmodule.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pois est√° diretamente relacionado ao m√≥dulo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que ser√° criado:</font></font><br>
<br>
<pre><code class="plaintext hljs">/*<font></font>
 * Module code.<font></font>
 *<font></font>
 * Generated by SIP 5.1.1<font></font>
 */<font></font>
<font></font>
#include "sipAPIfoo.h"<font></font>
<font></font>
/* Define the strings used by this module. */<font></font>
const char sipStrings_foo[] = {<font></font>
    'f', 'o', 'o', 0,<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_foo, "foo(str) -&gt; int");<font></font>
<font></font>
static PyObject *func_foo(PyObject *sipSelf,PyObject *sipArgs)<font></font>
{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        char* a0;<font></font>
<font></font>
        if (sipParseArgs(&amp;sipParseErr, sipArgs, "s", &amp;a0))<font></font>
        {<font></font>
            int sipRes;<font></font>
<font></font>
            sipRes = foo(a0);<font></font>
<font></font>
            return PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    /* Raise an exception if the arguments couldn't be parsed. */<font></font>
    sipNoFunction(sipParseErr, sipName_foo, doc_foo);<font></font>
<font></font>
    return SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
/* This defines this module. */<font></font>
sipExportedModuleDef sipModuleAPI_foo = {<font></font>
    0,<font></font>
    SIP_ABI_MINOR_VERSION,<font></font>
    sipNameNr_foo,<font></font>
    0,<font></font>
    sipStrings_foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
            SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
<font></font>
/* The SIP API and the APIs of any imported modules. */<font></font>
const sipAPIDef *sipAPI_foo;<font></font>
<font></font>
/* The Python module initialisation function. */<font></font>
#if defined(SIP_STATIC_MODULE)<font></font>
PyObject *PyInit_foo(void)<font></font>
#else<font></font>
PyMODINIT_FUNC PyInit_foo(void)<font></font>
#endif<font></font>
{<font></font>
    static PyMethodDef sip_methods[] = {<font></font>
        {sipName_foo, func_foo, METH_VARARGS, doc_foo},<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, 0, SIP_NULLPTR}<font></font>
    };<font></font>
<font></font>
    static PyModuleDef sip_module_def = {<font></font>
        PyModuleDef_HEAD_INIT,<font></font>
        "foo",<font></font>
        SIP_NULLPTR,<font></font>
        -1,<font></font>
        sip_methods,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    };<font></font>
<font></font>
    PyObject *sipModule, *sipModuleDict;<font></font>
    /* Initialise the module and get it's dictionary. */<font></font>
    if ((sipModule = PyModule_Create(&amp;sip_module_def)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    sipModuleDict = PyModule_GetDict(sipModule);<font></font>
<font></font>
    if ((sipAPI_foo = sip_init_library(sipModuleDict)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    /* Export the module and publish it's API. */<font></font>
    if (sipExportModule(&amp;sipModuleAPI_foo, SIP_ABI_MAJOR_VERSION, SIP_ABI_MINOR_VERSION, 0) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
    /* Initialise the module now all its dependencies have been set up. */<font></font>
    if (sipInitModule(&amp;sipModuleAPI_foo,sipModuleDict) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
<font></font>
    return sipModule;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ trabalhou com a API Python / C, ver√° fun√ß√µes familiares. Preste aten√ß√£o especial √† fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">func_foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> iniciando na linha 18. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado da compila√ß√£o dessas fontes, o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo / foo.cpython-38-x86_64-linux-gnu.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√° criado </font><font style="vertical-align: inherit;">e cont√©m a extens√£o Python, que ainda precisa ser instalada corretamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para compilar a extens√£o e instal√°-la imediatamente, voc√™ pode usar o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas n√£o o usaremos, porque, por padr√£o, ele tenta instalar a extens√£o Python criada globalmente no sistema. Este comando possui um par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--target-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, com o qual voc√™ pode especificar o caminho em que deseja instalar a extens√£o, mas √© melhor usarmos outras ferramentas que criam pacotes, que podem ser instalados usando o pip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, use o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Us√°-lo √© muito simples:</font></font><br>
<br>
<pre><code class="bash hljs">$ sip-sdist<font></font>
<font></font>
The sdist has been built.<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1.tar.gz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√° criado </font><font style="vertical-align: inherit;">, que pode ser instalado usando o comando:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user pyfoo-0.1.tar.gz
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, as seguintes informa√ß√µes ser√£o mostradas e o pacote ser√° instalado:</font></font><br>
<br>
<pre><code class="plaintext hljs">Processing ./pyfoo-0.1.tar.gz<font></font>
  Installing build dependencies ... done<font></font>
  Getting requirements to build wheel ... done<font></font>
    Preparing wheel metadata ... done<font></font>
Building wheels for collected packages: pyfoo<font></font>
  Building wheel for pyfoo (PEP 517) ... done<font></font>
  Created wheel for pyfoo: filename=pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl size=337289 sha256=762fc578...<font></font>
  Stored in directory: /home/jenyay/.cache/pip/wheels/54/dc/d8/cc534fff...<font></font>
Successfully built pyfoo<font></font>
Installing collected packages: pyfoo<font></font>
  Attempting uninstall: pyfoo<font></font>
    Found existing installation: pyfoo 0.1<font></font>
    Uninstalling pyfoo-0.1:<font></font>
      Successfully uninstalled pyfoo-0.1<font></font>
Successfully installed pyfoo-0.1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos garantir que conseguimos fazer uma liga√ß√£o em Python. </font><font style="vertical-align: inherit;">Iniciamos o Python e tentamos chamar a fun√ß√£o </font><font style="vertical-align: inherit;">Deixe-me lembr√°-lo de que, de acordo com nossas configura√ß√µes, o pacote </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cont√©m o m√≥dulo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que tem a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'123456'</span>)
<span class="hljs-number">12</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Observe que, como par√¢metro para a fun√ß√£o, passamos n√£o apenas uma string, mas uma string de bytes b'123456 '- um an√°logo direto de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para C. Um pouco mais tarde, adicionaremos a convers√£o de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e vice-versa. O resultado era esperado. Deixe-me lembr√°-lo de que a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retorna o tamanho duplo de uma matriz do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , transmitida a ela como par√¢metro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos tentar passar uma </font><font style="vertical-align: inherit;">string Python regular </font><font style="vertical-align: inherit;">para a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , em </font><font style="vertical-align: inherit;">vez de uma lista de bytes.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'123456'</span>)<font></font>
<font></font>
Traceback (most recent call last):<font></font>
  File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
TypeError: foo(str): argument <span class="hljs-number">1</span> has unexpected type <span class="hljs-string">'str'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A liga√ß√£o criada n√£o p√¥de converter a string em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; discutiremos como ensin√°-lo a fazer isso na pr√≥xima se√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parab√©ns, criamos a primeira encaderna√ß√£o em uma biblioteca escrita em C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saia do interpretador Python e monte o assembly no formato de roda. Como voc√™ provavelmente sabe, wheel √© um formato de pacote relativamente novo que tem sido usado universalmente recentemente. O formato √© descrito no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 427, ‚ÄúThe Wheel Binary Package Format 1.0‚Äù,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mas uma descri√ß√£o dos recursos do formato wheel √© um t√≥pico digno de um grande artigo separado. √â importante para n√≥s que o usu√°rio possa instalar facilmente o pacote no formato de roda usando pip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pacote no formato wheel n√£o √© mais complicado do que um pacote no formato sdist. Para fazer isso, na pasta com o arquivo</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> precisa executar o comando</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s executar este comando, o processo de compila√ß√£o ser√° mostrado e poder√° haver avisos do compilador: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ sip-wheel </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essas liga√ß√µes ser√£o criadas: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gerando as liga√ß√µes do pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilando o m√≥dulo 'foo' ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: Na fun√ß√£o func_foo: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: 29: 22: warning: declara√ß√£o impl√≠cita da fun√ß√£o foo [-Wimplicit-function-statement] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Na fun√ß√£o "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">9536: 16: aviso: "st" pode ser usado sem inicializa√ß√£o nesta fun√ß√£o [-O que talvez n√£o seja inicializado] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 10671: 19: observa√ß√£o: "st" foi declarado aqui</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Na fun√ß√£o "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: aviso: "propriet√°rio" pode ser usado sem inicializa√ß√£o nesta fun√ß√£o [-Pode ser n√£o inicializado] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * propriet√°rio = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^ ~ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A roda foi constru√≠da. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando a montagem √© conclu√≠da (nosso pequeno projeto √© compilado rapidamente), um arquivo com o nome </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou similar </font><font style="vertical-align: inherit;">aparecer√° na pasta do projeto </font><font style="vertical-align: inherit;">. O nome do arquivo gerado pode ser diferente, dependendo do sistema operacional e da vers√£o do Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora podemos instalar este pacote usando o pip:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A op√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--upgrade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© usada </font><i><font style="vertical-align: inherit;">aqui</font></i><font style="vertical-align: inherit;"> para que o pip substitua o m√≥dulo pyfoo instalado anteriormente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, o m√≥dulo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o pacote </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> podem ser usados, como mostrado acima.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adicione regras de convers√£o ao char *</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na se√ß√£o anterior, encontramos um problema em que a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode aceitar apenas um conjunto de bytes, mas n√£o seq√º√™ncias de caracteres. Agora vamos corrigir essa falha. Para fazer isso, usaremos outra ferramenta SIP - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anota√ß√µes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . As anota√ß√µes s√£o usadas nos arquivos .sip e s√£o aplicadas a alguns elementos de c√≥digo: fun√ß√µes, classes, argumentos de fun√ß√£o, exce√ß√µes, vari√°veis ‚Äã‚Äãetc. As anota√ß√µes s√£o escritas entre barras: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ anota√ß√£o /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma anota√ß√£o pode funcionar como um sinalizador, que pode estar no estado definido ou n√£o, por exemplo: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ReleaseGIL /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou algumas anota√ß√µes precisam receber alguns valores, por exemplo: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Encoding = "UTF-8" /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se v√°rias anota√ß√µes precisarem ser aplicadas a algum objeto, elas ser√£o separadas por v√≠rgulas nas barras: / anota√ß√£o_1, anota√ß√£o_2 /. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No exemplo a seguir, localizado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , adicione a </font><font style="vertical-align: inherit;">fun√ß√£o </font><i><font style="vertical-align: inherit;">foo do</font></i><font style="vertical-align: inherit;"> par√¢metro de anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arquivo </font><font style="vertical-align: inherit;">:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
<font></font>
int foo(char* /Encoding="UTF-8"/);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indica em qual codifica√ß√£o a string a ser passada para a fun√ß√£o deve ser codificada. Os valores para esta anota√ß√£o podem ser: ASCII, Latim-1, UTF-8 ou Nenhum. Se a anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o </font><font style="vertical-align: inherit;">for </font><font style="vertical-align: inherit;">especificada ou for igual a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">None</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o par√¢metro para essa fun√ß√£o n√£o estar√° sujeito a nenhuma codifica√ß√£o e ser√° passado para a fun√ß√£o como est√°, mas, neste caso, o par√¢metro no c√≥digo Python deve ser do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, uma matriz de bytes, como vimos no exemplo anterior. Se a codifica√ß√£o for especificada, esse par√¢metro poder√° ser uma sequ√™ncia (digite </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em Python). </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anota√ß√£o de </font><i><font style="vertical-align: inherit;">codifica√ß√£o</font></i><font style="vertical-align: inherit;"> pode ser aplicada apenas a par√¢metros do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos verificar como o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fun√ß√£o </font><font style="vertical-align: inherit;">do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√≥dulo </font><font style="vertical-align: inherit;">trabalha agora </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para fazer isso, como antes, voc√™ deve primeiro compilar a biblioteca </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamando </font><font style="vertical-align: inherit;">o comando </font><i><font style="vertical-align: inherit;">make</font></i><font style="vertical-align: inherit;"> dentro da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e depois </font><font style="vertical-align: inherit;">chamar o comando, por exemplo, </font><i><font style="vertical-align: inherit;">sip-wheel,</font></i><font style="vertical-align: inherit;"> da pasta de exemplo </font><i><font style="vertical-align: inherit;">pyfoo_c_02</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O arquivo </font><i><font style="vertical-align: inherit;">pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl</font></i><font style="vertical-align: inherit;"> ou com um nome semelhante </font><font style="vertical-align: inherit;">ser√° criado </font><font style="vertical-align: inherit;">, que pode ser definido usando o comando:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se tudo correu bem, inicie o interpretador Python e tente chamar a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com um argumento string:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">''</span>)
<span class="hljs-number">24</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, garantimos que o uso de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ainda seja poss√≠vel. Depois disso, garantimos que agora tamb√©m podemos passar </font><font style="vertical-align: inherit;">argumentos de string </font><font style="vertical-align: inherit;">para a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Observe que a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para um argumento de string com letras russas retornou um valor duas vezes maior do que para uma string contendo apenas letras latinas. Isso aconteceu devido ao fato de a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o contar o comprimento da string em caracteres (e dobr√°-la), mas o comprimento da matriz </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e, como na codifica√ß√£o UTF-8, as letras russas ocupam 2 bytes, o tamanho da matriz </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ap√≥s a convers√£o de Seq√º√™ncias de caracteres Python eram duas vezes maiores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem! Resolvemos o problema com o argumento da fun√ß√£o</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas e se tivermos dezenas ou centenas dessas fun√ß√µes em nossa biblioteca, voc√™ precisar√° especificar a codifica√ß√£o de par√¢metro para cada uma delas? Freq√ºentemente, a codifica√ß√£o usada em um programa √© a mesma e n√£o h√° prop√≥sito para fun√ß√µes diferentes indicar codifica√ß√µes diferentes. Nesse caso, o SIP pode especificar a codifica√ß√£o padr√£o e, para alguma fun√ß√£o, a codifica√ß√£o precisar de outra, ela poder√° ser redefinida usando a anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para definir a codifica√ß√£o dos par√¢metros da fun√ß√£o por padr√£o, a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><i><font style="vertical-align: inherit;">usada</font></i><font style="vertical-align: inherit;"> . Seu uso √© mostrado no exemplo localizado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aproveitar a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , altere o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, agora seu conte√∫do √© o seguinte:</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
%DefaultEncoding "UTF-8"<font></font>
<font></font>
int foo(char*);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, se o argumento for uma fun√ß√£o do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc. </font><font style="vertical-align: inherit;">Se </font><font style="vertical-align: inherit;">n√£o houver anota√ß√£o de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codifica√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a codifica√ß√£o ser√° obtida da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e, se n√£o houver, a convers√£o n√£o ser√° executada e, para todos os par√¢metros </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc. </font><font style="vertical-align: inherit;">√© necess√°rio transferir n√£o linhas, mas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um exemplo da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03 √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coletado e verificado da mesma maneira que um exemplo da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brevemente sobre project.py. </font><font style="vertical-align: inherit;">Automatizar montagem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At√© agora, usamos dois arquivos utilit√°rios para criar uma liga√ß√£o Python - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Agora, vamos nos familiarizar com outro arquivo desse tipo, que deve ser chamado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Com esse script, podemos influenciar o processo de compila√ß√£o do nosso pacote. Vamos fazer a automa√ß√£o de compila√ß√£o. Para coletar os exemplos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> das se√ß√µes anteriores, primeiro voc√™ deve ir para a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , compilar usando o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , retornar √† pasta onde o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° </font><i><font style="vertical-align: inherit;">localizado</font></i><font style="vertical-align: inherit;"> e s√≥ ent√£o come√ßar a compilar o pacote usando um dos seguintes comandos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, nosso objetivo √© garantir que, ao executar os </font><i><font style="vertical-align: inherit;">comandos </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o conjunto da biblioteca C </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seja iniciado primeiro </font><font style="vertical-align: inherit;">e, em seguida, o pr√≥prio comando j√° seja iniciado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um exemplo criado nesta se√ß√£o est√° localizado na pasta de </font><font style="vertical-align: inherit;">origem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para alterar o processo de compila√ß√£o, podemos </font><font style="vertical-align: inherit;">declarar uma classe </font><font style="vertical-align: inherit;">no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (o nome do arquivo deve ser exatamente isso) derivado da classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Essa classe possui m√©todos que podemos substituir por conta pr√≥pria. </font><font style="vertical-align: inherit;">Atualmente, estamos interessados ‚Äã‚Äãnos seguintes m√©todos:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Chamado durante a chamada para o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Chamado quando o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando sip-sdist √© chamado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Chamado quando o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© chamado </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instalar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Chamado quando o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© chamado </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou seja, podemos redefinir o comportamento desses comandos. </font><font style="vertical-align: inherit;">Estritamente falando, os m√©todos listados s√£o declarados na classe abstrata </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.AbstractProject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a partir da qual a classe derivada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© criada </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie um arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com o seguinte conte√∫do:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Declaramos a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
classe </font><i><font style="vertical-align: inherit;">FooProject</font></i><font style="vertical-align: inherit;"> , derivada da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font><i><font style="vertical-align: inherit;">definimos os</font></i><font style="vertical-align: inherit;"> m√©todos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nela </font><font style="vertical-align: inherit;">. Em todos esses m√©todos, chamamos os m√©todos com o mesmo nome da classe base, antes de chamar o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_build_foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que inicia a execu√ß√£o do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note-se que os </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©todos build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve retornar o nome do arquivo que eles criaram. Isso n√£o est√° escrito na documenta√ß√£o, mas √© indicado nas fontes SIP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora n√£o precisamos executar o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manualmente para criar a biblioteca </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , isso ser√° feito automaticamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ agora </font><font style="vertical-align: inherit;">executar o comando </font><i><font style="vertical-align: inherit;">sip-wheel</font></i><font style="vertical-align: inherit;"> na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ser√° criado um arquivo com o nome pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl ou similar, dependendo do sistema operacional e da vers√£o do Python. </font><font style="vertical-align: inherit;">
Este pacote pode ser instalado usando o comando:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, voc√™ pode ter certeza que o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fun√ß√£o </font><font style="vertical-align: inherit;">do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√≥dulo </font><font style="vertical-align: inherit;">ainda funciona.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adicione op√ß√µes de linha de comando para criar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O exemplo a seguir est√° na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o pacote possui um n√∫mero de vers√£o 0,5 (consulte as configura√ß√µes no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Este exemplo √© baseado em um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemplo da documenta√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com algumas corre√ß√µes. Neste exemplo, refazeremos o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e adicionaremos novas op√ß√µes de linha de comando para a compila√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em nossos exemplos, estamos construindo uma biblioteca muito simples </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e em projetos reais, a biblioteca pode ser bastante grande e, portanto, n√£o far√° sentido inclu√≠-la no c√≥digo-fonte do projeto de liga√ß√£o do Python. Deixe-me lembr√°-lo de que o SIP foi criado originalmente para criar uma liga√ß√£o para uma biblioteca t√£o grande como o Qt. √â claro que voc√™ pode argumentar que os subm√≥dulos do git podem ajudar a organizar a fonte, mas esse n√£o √© o ponto. Suponha que a biblioteca n√£o esteja na pasta com a fonte de liga√ß√£o. Nesse caso, surge a pergunta: onde o coletor SIP deve procurar o cabe√ßalho da biblioteca e os arquivos de objeto? Nesse caso, diferentes usu√°rios podem ter suas pr√≥prias maneiras de colocar a biblioteca. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver esse problema, adicionaremos duas novas op√ß√µes de linha de comando ao sistema de constru√ß√£o, com as quais voc√™ pode especificar o caminho para o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-include-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) e para o arquivo de objeto da biblioteca (par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-library-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Al√©m disso, assumiremos que, se esses par√¢metros n√£o forem especificados, a biblioteca </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ainda estar√° localizada junto com as fontes de liga√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos criar o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> novamente </font><font style="vertical-align: inherit;">e declarar uma classe derivada de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Vamos examinar a nova vers√£o do arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> primeiro </font><font style="vertical-align: inherit;">e depois </font><font style="vertical-align: inherit;">ver </font><font style="vertical-align: inherit;">como ele funciona.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Option, Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-string">"""        
       foo.
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">"""     . """</span><font></font>
<font></font>
        tools = [<span class="hljs-string">'build'</span>, <span class="hljs-string">'install'</span>, <span class="hljs-string">'sdist'</span>, <span class="hljs-string">'wheel'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   .</span><font></font>
        options = super().get_options()<font></font>
<font></font>
        <span class="hljs-comment">#   </span>
        inc_dir_option = Option(<span class="hljs-string">'foo_include_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing foo.h"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo'</span>),<font></font>
                                tools=tools)<font></font>
        options.append(inc_dir_option)<font></font>
<font></font>
        lib_dir_option = Option(<span class="hljs-string">'foo_library_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing the foo library"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo/bin'</span>),<font></font>
                                tools=tools)<font></font>
<font></font>
        options.append(lib_dir_option)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""    . """</span><font></font>
<font></font>
        <span class="hljs-comment">#     </span><font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
        <span class="hljs-comment">#  ,         </span><font></font>
        self.foo_include_dir = os.path.abspath(self.foo_include_dir)<font></font>
        self.foo_library_dir = os.path.abspath(self.foo_library_dir)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""   . """</span><font></font>
<font></font>
        <span class="hljs-comment">#   pyfoo</span>
        <span class="hljs-comment"># (  pyproject.toml  [tool.sip.bindings.pyfoo])</span>
        foo_bindings = self.bindings[<span class="hljs-string">'pyfoo'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   include_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_include_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.include_dirs = [self.foo_include_dir]<font></font>
<font></font>
        <span class="hljs-comment">#   library_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_library_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.library_dirs = [self.foo_library_dir]<font></font>
<font></font>
        super().update(tool)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Criamos novamente a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , derivada de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Neste exemplo, a montagem autom√°tica da biblioteca </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° desativada </font><font style="vertical-align: inherit;">, porque agora sup√µe-se que ela possa estar em outro local e, quando a liga√ß√£o for criada, os arquivos de cabe√ßalho e de objeto dever√£o estar prontos. </font><font style="vertical-align: inherit;">Tr√™s m√©todos s√£o redefinidos </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
no </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font><font style="vertical-align: inherit;">: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atualiza√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Considere-os com mais cuidado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar com o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Este m√©todo deve retornar uma lista de inst√¢ncias da classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Option</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Cada item da lista √© uma op√ß√£o de linha de comando. Dentro do m√©todo substitu√≠do, obtemos a lista de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">op√ß√µes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> padr√£o (a vari√°vel </font><i><font style="vertical-align: inherit;">options</font></i><font style="vertical-align: inherit;"> ) chamando o m√©todo da classe base com o mesmo nome, depois criamos duas novas op√ß√µes ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) e as adicionamos √† lista e, em seguida, retornamos essa lista da fun√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O construtor da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aceita um par√¢metro necess√°rio (nome da op√ß√£o) e um n√∫mero suficientemente grande de opcionais que descrevem o tipo de valor desse par√¢metro, o valor padr√£o, a descri√ß√£o do par√¢metro e alguns outros. Este exemplo usa as seguintes op√ß√µes para o construtor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><i>help</i>   ,   ,     <i>sip-wheel -h</i></li>
<li><i>metavar</i> ‚Äî  ,    ,       .     <i>metavar</i>  ¬´DIR¬ª,   ,     ‚Äî .</li>
<li><i>default</i> ‚Äî     .    ,          ,   <i>foo</i>   ,      (    ).</li>
<li><i>tools</i> ‚Äî  ,        .        <i>sip-build</i>, <i>sip-install</i>, <i>sip-sdist</i>  <i>sip-wheel</i>,  tools = ['build', 'install', 'sdist', 'wheel'].</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O seguinte m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobrecarregado </font><i><font style="vertical-align: inherit;">foi</font></i><font style="vertical-align: inherit;"> projetado para definir valores de par√¢metros que o usu√°rio pode passar pela linha de comandos. O m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da classe base cria uma </font><font style="vertical-align: inherit;">vari√°vel (membro da classe) </font><font style="vertical-align: inherit;">para cada par√¢metro da linha de comando criado no m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , portanto, √© importante chamar o m√©todo da classe base com o mesmo nome antes de usar as vari√°veis ‚Äã‚Äãcriadas, para que todas as vari√°veis ‚Äã‚Äãcriadas usando os par√¢metros da linha de comando sejam criadas e inicializadas com valores padr√£o . Depois disso, em nosso exemplo, as vari√°veis </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font><i><font style="vertical-align: inherit;">self.foo_library_dir</font></i><font style="vertical-align: inherit;"> ser√£o criadas</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se o usu√°rio n√£o tiver especificado os par√¢metros de linha de comando correspondentes, eles receber√£o valores padr√£o de acordo com os par√¢metros do construtor da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">padr√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Se o par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">padr√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o </font><font style="vertical-align: inherit;">estiver </font><font style="vertical-align: inherit;">definido, dependendo do tipo de valor esperado do par√¢metro, ele ser√° inicializado None ou uma lista vazia ou 0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro do m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">garantimos</font></i><font style="vertical-align: inherit;"> que os caminhos nas vari√°veis </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir sejam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sempre absolutos. Isso √© necess√°rio para que n√£o dependa de qual ser√° a pasta de trabalho no momento em que a montagem for iniciada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O √∫ltimo m√©todo sobrecarregado nesta classe √© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atualiza√ß√£o.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Esse m√©todo √© chamado quando √© necess√°rio aplicar ao projeto as altera√ß√µes feitas antes disso. Por exemplo, altere ou adicione os par√¢metros especificados no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nos exemplos anteriores, definimos os caminhos para os arquivos de cabe√ßalho e objeto usando os par√¢metros </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">respectivamente, dentro da se√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.bindings.pyfoo]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Agora, definiremos esses par√¢metros no script </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , portanto, no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">removeremos esses par√¢metros:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.3"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro do m√©todo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atualize-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos do dicion√°rio </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.bindings com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chave </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gat instance </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Bindings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . O nome da chave corresponde √†s [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] do arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e a inst√¢ncia da classe assim obtida descreve as configura√ß√µes descritas nesta se√ß√£o. Em seguida, os membros desta classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (os nomes dos membros correspondem aos par√¢metros </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com um h√≠fen substitu√≠do por sublinhado) recebem listas designadas que cont√™m os caminhos armazenados nos membros </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Neste exemplo, para precis√£o, verificamos que os valores </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o </font><i><font style="vertical-align: inherit;">s√£o</font></i><font style="vertical-align: inherit;"> iguais a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">None</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas neste exemplo essa condi√ß√£o √© sempre cumprida porque os par√¢metros da linha de comando que criamos t√™m valores padr√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, preparamos os arquivos de configura√ß√£o para que durante a montagem fosse poss√≠vel indicar os caminhos para os arquivos de cabe√ßalho e objeto. Vamos verificar o que aconteceu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, verifique se os valores padr√£o funcionam. Para fazer isso, v√° para a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05 / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e construa a biblioteca usando o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pois desativamos a compila√ß√£o autom√°tica da biblioteca neste exemplo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, v√° para a pasta</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e execute o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Como resultado deste comando, o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo pyfoo-0.5-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou com um nome semelhante </font><font style="vertical-align: inherit;">ser√° criado </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora mova a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo para</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algum lugar fora da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e execute o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> novamente </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Como resultado, obtemos o erro esperado informando que n√£o temos um arquivo de biblioteca de objetos:</font></font><br>
<br>
<pre><code class="plaintext hljs">usr/bin/ld:   -lfoo<font></font>
collect2: :  ld     1<font></font>
sip-wheel: Unable to compile the 'foo' module: command 'g++' failed with exit status 1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, execute o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando a nova op√ß√£o de linha de comando:</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel --foo-include-dir <span class="hljs-string">".../foo"</span> --foo-library-dir <span class="hljs-string">".../foo/bin"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em vez das retic√™ncias, √© necess√°rio especificar o caminho para a pasta em que voc√™ moveu a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com a biblioteca montada. </font><font style="vertical-align: inherit;">Como resultado, o assembly deve conseguir criar o arquivo .whl. </font><font style="vertical-align: inherit;">O m√≥dulo criado pode ser instalado e testado da mesma maneira que nas se√ß√µes anteriores.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verifique a ordem dos m√©todos de chamada em project.py</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pr√≥ximo exemplo, que consideraremos, ser√° muito simples: demonstrar√° a ordem de chamar os m√©todos da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que sobrecarregamos nas se√ß√µes anteriores. Isso pode ser √∫til para entender quando as vari√°veis ‚Äã‚Äãpodem ser inicializadas. Este exemplo est√° localizado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no reposit√≥rio de origem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A ess√™ncia deste exemplo √© </font><font style="vertical-align: inherit;">sobrecarregar todos os m√©todos que usamos anteriormente </font><font style="vertical-align: inherit;">na classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que est√° localizada no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e adicionar chamadas √† fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">print</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a eles </font><font style="vertical-align: inherit;">, que exibe o nome do m√©todo em que est√° localizado:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'get_options()'</span>)<font></font>
        options = super().get_options()<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_user_defaults()'</span>)<font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_nonuser_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_nonuser_defaults()'</span>)<font></font>
        super().apply_nonuser_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'update()'</span>)<font></font>
        super().update(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'build()'</span>)<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span>
        print(<span class="hljs-string">'build_sdist()'</span>)
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span>
        print(<span class="hljs-string">'build_wheel()'</span>)
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'install()'</span>)<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os leitores atentos devem observar que, al√©m dos m√©todos usados ‚Äã‚Äãanteriormente, o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sobre o qual n√£o falamos antes </font><font style="vertical-align: inherit;">, est√° sobrecarregado neste exemplo </font><font style="vertical-align: inherit;">. Este m√©todo recomenda definir valores padr√£o para todas as vari√°veis ‚Äã‚Äãque n√£o podem ser alteradas atrav√©s dos par√¢metros da linha de comando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retorne o caminho expl√≠cito para a biblioteca:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.4"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que o projeto </font><font style="vertical-align: inherit;">seja compilado com </font><font style="vertical-align: inherit;">√™xito, voc√™ precisa ir para a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e criar a biblioteca usando o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Depois disso, retorne √† pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e execute, por exemplo, o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Como resultado, se voc√™ descartar os avisos do compilador, o seguinte texto ser√° exibido: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update ())</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Essas liga√ß√µes ser√£o criadas: pyfoo. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel ()</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Gerando as liga√ß√µes do pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilando o m√≥dulo 'foo' ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A roda foi constru√≠da.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linhas em negrito s√£o exibidas que s√£o geradas pelo nosso arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Portanto, vemos que o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamado v√°rias vezes, e isso deve ser levado em considera√ß√£o se voc√™ for inicializar qualquer vari√°vel de membro na classe derivada do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . O m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o √© o melhor lugar para isso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m √© √∫til lembrar que o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamado antes do m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, no m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , voc√™ j√° pode usar vari√°veis ‚Äã‚Äãcujos valores est√£o configurados no m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, o m√©todo de </font><i><font style="vertical-align: inherit;">atualiza√ß√£o</font></i><font style="vertical-align: inherit;"> √© chamado</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e no final, o m√©todo diretamente respons√°vel pela montagem, no nosso caso, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conclus√£o para a primeira parte</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, come√ßamos a estudar a ferramenta SIP projetada para criar liga√ß√µes Python para bibliotecas escritas em C ou C ++. Nesta primeira parte do artigo, examinamos os conceitos b√°sicos do uso do SIP usando o exemplo da cria√ß√£o de uma liga√ß√£o Python para uma biblioteca muito simples escrita em C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Descobrimos os arquivos que voc√™ precisa criar para trabalhar com o SIP. O arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cont√©m informa√ß√µes sobre o pacote (nome, n√∫mero da vers√£o, licen√ßa e caminhos para os arquivos de cabe√ßalho e objeto). Usando o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">voc√™ pode influenciar o processo de compila√ß√£o do pacote Python, por exemplo, come√ßar a criar a biblioteca C ou permitir que o usu√°rio especifique o local dos arquivos de cabe√ßalho e objeto da biblioteca. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descreve a interface do m√≥dulo Python, listando as fun√ß√µes e classes que estar√£o contidas no m√≥dulo. </font><font style="vertical-align: inherit;">Diretivas e anota√ß√µes s√£o usadas </font><font style="vertical-align: inherit;">para descrever a interface no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na segunda parte do artigo, criaremos uma liga√ß√£o sobre uma biblioteca orientada a objetos escrita em C ++ e, por seu exemplo, estudaremos t√©cnicas que ser√£o √∫teis na descri√ß√£o da interface de classes C ++ e, ao mesmo tempo, trataremos de novas diretivas e anota√ß√µes para n√≥s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Continua.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Refer√™ncias</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplos para este artigo</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P√°gina inicial do SIP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documenta√ß√£o para SIP</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495468/index.html">Algoritmo de reconhecimento de pre√ßo que funciona mesmo em terminais de coleta de dados</a></li>
<li><a href="../pt495472/index.html">Mudar para o vegetarianismo n√£o impedir√° que as pessoas sejam infectadas por doen√ßas como COVID-19</a></li>
<li><a href="../pt495474/index.html">DataGrip 2020.1: inicie configura√ß√µes, exporte para Excel, resulte no editor e muito mais</a></li>
<li><a href="../pt495476/index.html">Por que o sucesso da Atari DeepMind AI √© decepcionante</a></li>
<li><a href="../pt495478/index.html">Testador de dados grandes e pequenos: tend√™ncias, teoria, minha hist√≥ria</a></li>
<li><a href="../pt495484/index.html">Como os pipelines Unix s√£o implementados</a></li>
<li><a href="../pt495486/index.html">Novas amea√ßas aos dados confidenciais: Resultados da pesquisa global da Acronis</a></li>
<li><a href="../pt495490/index.html">Se√ß√£o de testes e controle de qualidade na confer√™ncia DUMP 2020. O que esperar este ano? Spoiler: um par de analg√©sicos e cerejas</a></li>
<li><a href="../pt495492/index.html">Funcionalidades de vers√£o do jogo Unreal Engine 4 para iOS</a></li>
<li><a href="../pt495494/index.html">Criando um kube-scheduler adicional com um conjunto personalizado de regras de planejamento</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>