<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍❤️‍👨 🐆 🚙 Détectez COVID-19 dans les rayons X avec Keras, TensorFlow et Deep Learning 🈹 👦🏼 ↪️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avec l'aide de ce guide, avec l'aide de Keras, TensorFlow et de l'apprentissage en profondeur, nous apprendrons comment déterminer automatiquement COV...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Détectez COVID-19 dans les rayons X avec Keras, TensorFlow et Deep Learning</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/493614/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/bt/gn/albtgnkhy92l7fzrjmwpm6fdu4o.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec l'aide de ce guide, avec l'aide de Keras, TensorFlow et de l'apprentissage en profondeur, nous apprendrons comment déterminer automatiquement COVID-19 à partir d'un ensemble de données assemblé manuellement à partir d'images radiographiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme tant d'autres, je suis sincèrement préoccupé par COVID-19. </font><font style="vertical-align: inherit;">J'ai remarqué que j'analysais constamment mon état et je me demandais si j'attraperais la maladie et quand elle se produirait. </font><font style="vertical-align: inherit;">Et plus je m'en inquiète, plus cela se transforme en un jeu d'esprit douloureux, dans lequel la symptomatologie se conjugue à l'hypocondrie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je me suis réveillé le matin, ressentant un peu de douleur et de faiblesse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quand j'ai rampé hors du lit, j'ai trouvé un nez qui coule (bien qu'il soit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déjà connu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qu'un nez qui coule n'est </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un symptôme de COVID-19).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au moment où je suis arrivé aux toilettes pour obtenir un foulard en papier, je toussais déjà.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, je n'y ai pas prêté beaucoup d'attention - je suis allergique au pollen, et en raison du temps chaud sur la côte est des États-Unis, ce printemps a été un début de printemps. </font><font style="vertical-align: inherit;">Il s'agit très probablement de symptômes allergiques. </font><font style="vertical-align: inherit;">Mais pendant la journée, mon état ne s'est pas amélioré. </font><font style="vertical-align: inherit;">Je m'assois et j'écris ce manuel avec un thermomètre dans la bouche. </font><font style="vertical-align: inherit;">Je baisse les yeux et vois 37,4 ° C. </font><font style="vertical-align: inherit;">Ma température corporelle normale est légèrement inférieure à celle des autres, à 36,3 ° C. </font><font style="vertical-align: inherit;">Tout ce qui dépasse 37,2 ° C est déjà un peu chaud pour moi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toux et légère fièvre? </font><font style="vertical-align: inherit;">Ça pourrait être COVID-19 ... ou juste mon allergie. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est impossible de le découvrir sans tester, et c'est précisément cette «ignorance» qui rend la situation si intimidante sur le plan humain.</font></font></strong><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UFO Care Minute</font></font></h3><br>
     COVID-19 —     ,   SARS-CoV-2 (2019-nCoV).        —    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgré mes craintes, j'essaie de penser rationnellement. J'ai un peu plus de 30 ans, je suis en pleine forme et mon immunité est forte. Je vais me mettre en quarantaine (juste au cas où), me reposer et m'occuper de tout. COVID-19 ne me fait pas peur du point de vue de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> santé </font><i><font style="vertical-align: inherit;">personnelle</font></i><font style="vertical-align: inherit;"> (au moins je vais le supporter pour moi-même). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, je m'inquiète pour mes parents âgés, y compris tous ceux qui ont déjà été diagnostiqués avec la maladie, ainsi que ceux qui sont dans des maisons de retraite et des hôpitaux. Ces gens sont vulnérables et ce sera terrible s'ils meurent à cause de COVID-19. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de ne rien faire et de laisser ma maladie me garder à la maison (que ce soit l'allergie, le COVID-19 ou mes peurs), j'ai décidé de faire ce que je peux:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je vais écrire le code, mener des expériences et, à l'aide d'exemples pratiques, enseigner aux autres comment utiliser la vision par ordinateur et l'apprentissage en profondeur</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je dois dire tout de suite que ce n'est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas l'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article </font><i><font style="vertical-align: inherit;">le</font></i><font style="vertical-align: inherit;"> plus scientifique que j'ai écrit. </font><font style="vertical-align: inherit;">Elle n'est pas du tout scientifique. </font><font style="vertical-align: inherit;">Les méthodes et les ensembles de données utilisés </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valent </font><i><font style="vertical-align: inherit;">pas la</font></i><font style="vertical-align: inherit;"> peine d'être publiés. </font><font style="vertical-align: inherit;">Mais ils servent de point de départ à ceux qui veulent au moins </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quelque chose pour</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aider. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je m'inquiète pour vous et cette communauté. </font><font style="vertical-align: inherit;">Je veux aider ce que je peux: cet article est ma façon de faire face mentalement aux moments difficiles, tout en aidant les autres dans une situation similaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce guide, vous apprendrez:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment collecter un ensemble de données open source d'images radiographiques de patients atteints de COVID-19 détecté.</font></font></li>
<li>   «» (  )    .</li>
<li>      COVID-19      .</li>
<li>      .</li>
</ol><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j'ai déjà fait allusion à cela, mais maintenant je vais le dire directement. </font><font style="vertical-align: inherit;">Les techniques décrites ici sont uniquement à des fins éducatives. </font><font style="vertical-align: inherit;">Il </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s'agit </font><strong><font style="vertical-align: inherit;">pas d'une</font></strong><font style="vertical-align: inherit;"> étude scientifique rigoureuse, elle ne sera pas publiée dans des revues. </font><font style="vertical-align: inherit;">Cet article s'adresse aux lecteurs qui s'intéressent à la vision par ordinateur et au deep learning, qui souhaitent apprendre dans la pratique, ainsi qu'à ceux qui sont inspirés par l'actualité. </font><font style="vertical-align: inherit;">Je vous demande de prendre tout cela en compte. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la première partie du manuel, nous verrons comment détecter le COVID-19 dans les radiographies pulmonaires. </font><font style="vertical-align: inherit;">Ensuite, nous discutons de l'ensemble de données lui-même. </font><font style="vertical-align: inherit;">Et puis je montrerai comment former le modèle en utilisant Keras et TensorFlow pour prédire COVID-19 dans nos images.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explication</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet article sur la détection automatique COVID-19 est écrit à des fins éducatives uniquement. Il </font></font></strong><i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></strong></i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> décrit </font></font></strong><font style="vertical-align: inherit;"><i><strong><font style="vertical-align: inherit;">pas</font></strong></i><strong><font style="vertical-align: inherit;"> un système de diagnostic fiable et précis COVID-19, n'a été testé ni d'un point de vue professionnel ni académique.</font></strong></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mon objectif est de vous inspirer et de montrer comment l'étude de la vision par ordinateur et de l'apprentissage profond avec l'application ultérieure de ces connaissances dans le domaine médical peut avoir un impact important sur le monde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous n'avez pas besoin d'une formation médicale pour influencer la médecine</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Aujourd'hui, les praticiens de la formation approfondie travaillent en étroite collaboration avec des médecins et d'autres médecins pour résoudre des problèmes complexes, sauver des vies et rendre le monde meilleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que mon leadership vous inspirera à le faire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais compte tenu de tout ce qui précède, les chercheurs, les conservateurs de magazines et le système d'examen sont déjà surchargés de travaux qui décrivent des modèles de prévision COVID-19 d'une qualité douteuse. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veuillez ne pas envoyer le code et le modèle de cet article à une revue ou à une publication scientifique - vous ne fera qu'augmenter le chaos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, si vous souhaitez effectuer des recherches sur la base de cet article (ou de toute autre publication sur COVID-19), respectez le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guide TRIPOD pour décrire les modèles prédictifs.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Comme vous le comprenez, l'utilisation de l'intelligence artificielle dans le domaine médical peut avoir des conséquences très graves. Ne publiez et n'utilisez de tels modèles que si vous êtes un médecin spécialiste ou si ces spécialistes vous ont conseillé en détail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment COVID-19 peut-il être détecté aux rayons X?</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/8bd/a46/dbb8bda4650156ba71b79b0db4309738.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 1:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exemple de radiographie d'un patient diagnostiqué avec COVID-19. </font><font style="vertical-align: inherit;">Dans ces images, vous pouvez apprendre au classificateur à l'aide de Keras et TensorFlow pour déterminer COVID-19. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le test de COVID-19 est maintenant difficile - il n'y a</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pas assez de tests</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais il est impossible de les produire rapidement, ce qui ne fait qu'accroître la panique. </font><font style="vertical-align: inherit;">Et dans la panique, il y a des scélérats qui essaient de</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tirer profit des</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> autres</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"> et de vendre de faux tests sur COVID-19</font></a><font style="vertical-align: inherit;"> , se</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retrouvant victimes sans méfiance dans les réseaux sociaux et les messagers instantanés. </font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné le nombre limité de tests, nous devons compter sur d'autres méthodes de diagnostic.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai décidé d'étudier les rayons X, car les médecins les utilisent souvent et les résultats de la tomodensitométrie pour diagnostiquer la pneumonie, l'inflammation pulmonaire, les abcès et les ganglions lymphatiques hypertrophiés. Comme le virus attaque les cellules épithéliales qui tapissent les voies respiratoires, nous pouvons utiliser des rayons X pour étudier l'état des poumons humains. Et puisque les machines à rayons X sont presque partout, en utilisant les images, vous pouvez détecter COVID-19 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sans</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kits de test. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les inconvénients de la méthode incluent le besoin de radiologues, ainsi qu'un temps de traitement important. Et le temps est particulièrement coûteux lorsque les gens sont malades partout dans le monde. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et pour gagner du temps aux médecins, vous devez créer un système d'analyse automatique</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque:</font></font></strong></i><i>    ,   ,    COVID-19    .        .  ,  </i><i><strong></strong></i><i> ,  ,   ,     COVID-19,   .</i><br>
<br>
<h3>    COVID-19</h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e99/03e/e2a/e9903ee2a07ec44819bb4821671401fa.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 2:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à gauche sont des photos de personnes avec un résultat positif (infecté), à droite - avec un négatif. </font><font style="vertical-align: inherit;">Dans ces images, nous enseignerons le modèle en utilisant TensorFlow et Keras pour prédire automatiquement la présence de COVID-19 (c'est-à-dire une maladie résultant d'un coronavirus). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ensemble de données d'images de patients utilisées avec COVID-19 utilisé ici a été compilé sous la supervision du</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un étudiant diplômé de l'Université de Montréal. </font><font style="vertical-align: inherit;">Il y a quelques jours, Cohen a commencé à collecter des images radiographiques de patients atteints de COVID-19 et à les télécharger</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le référentiel GitHub. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous y trouverez des exemples non seulement de cette maladie, mais aussi du MERS, du SRAS et des SDRA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour créer un jeu de données I:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysez le fichier metadata.csv à partir du référentiel.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sélectionné toutes les lignes:</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au total, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 tirs</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ont été obtenus </font><strong><font style="vertical-align: inherit;">avec des résultats positifs sur COVID-19</font></strong><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">figure 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , à </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gauche</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, choisissez les photos de personnes en bonne santé.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pour ce faire, j'ai pris un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ensemble de données de radiographie pulmonaire de Kaggle (pneumonie)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et sélectionné </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 images de personnes en bonne santé</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">figure 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , à </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">droite</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Cet ensemble de données présente un certain nombre d'inconvénients, y compris des étiquettes mal ou mal remplies, mais il convient comme point de départ pour tester l'hypothèse du détecteur COVID-19. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, j'ai reçu </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> injections </font><strong><font style="vertical-align: inherit;">:</font></strong><font style="vertical-align: inherit;"> 25 patients avec COVID-19 et 25 en bonne santé. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez télécharger l'ensemble de données à partir du </font></font></strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">De plus, j'ai ajouté des scripts Python avec lesquels j'ai généré le jeu de données, mais dans cet article, je ne les ai pas pris en compte.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Structure du projet</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez le code et les données. </font><font style="vertical-align: inherit;">Retirez les fichiers à partir de là et vous obtenez la structure de répertoires suivante:</font></font><br>
<br>
<pre><code class="python hljs">$ tree --dirsfirst --filelimit <span class="hljs-number">10</span><font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [<span class="hljs-number">25</span> entries]<font></font>
│   └── normal [<span class="hljs-number">25</span> entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois répertoires, cinq fichiers. </font><font style="vertical-align: inherit;">L'ensemble de données se trouve dans le répertoire dataset / et est divisé en deux classes - covid / et normal /. </font><font style="vertical-align: inherit;">Ci-dessous, nous regardons le script train_covid19.py qui forme notre détecteur COVID-19.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implémentation du script de formation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons maintenant au réglage fin du réseau neuronal convolutionnel, qui diagnostiquera automatiquement COVID-19 à l'aide de Keras, TensorFlow et de l'apprentissage en profondeur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ouvrez le fichier train_covid19.py et collez le code suivant:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce script tire parti des bibliothèques TensorFlow 2.0 et Keras en sélectionnant les importations tensorflow.keras. </font><font style="vertical-align: inherit;">Nous utilisons également:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il s'agit d'une </font><font style="vertical-align: inherit;">bibliothèque d'apprentissage automatique </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de facto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour la cartographie,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour le téléchargement et le prétraitement d'images dans un ensemble de données.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour savoir comment installer TensorFlow 2.0 (y compris scikit-learn, OpenCV et matplotlib), consultez mes tutoriels pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous analysons les arguments de la ligne de commande et initialisons les hyperparamètres:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
    help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos trois </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arguments de ligne de commande</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 24-31</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) incluent:</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: chemin d'accès au jeu de données d'entrée.</font></font></li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: chemin facultatif vers le calendrier de sortie de l'historique d'apprentissage. </font><font style="vertical-align: inherit;">Par défaut, le graphique est appelé plot.png sauf si un nom différent est spécifié sur la ligne de commande.</font></font></li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: chemin facultatif vers notre modèle de définition de sortie COVID-19. </font><font style="vertical-align: inherit;">Par défaut, il est appelé covid19.model.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous initialisons la fréquence d'apprentissage initiale, le nombre d'époques d'apprentissage et les hyperparamètres de taille de paquet ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 35-37</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, téléchargez et prétraitez les rayons X:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
    <span class="hljs-comment"># extract the class label from the filename</span>
    label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]<font></font>
<font></font>
    <span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
    <span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
    image = cv2.imread(imagePath)<font></font>
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
    image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))<font></font>
<font></font>
    <span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
    data.append(image)<font></font>
    labels.append(label)<font></font>
<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span><font></font>
labels = np.array(labels)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour charger les données, nous prenons tous les chemins d'accès aux images dans le répertoire --dataset ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ligne 42</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), puis pour chaque imagePath:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On extrait du chemin ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ligne 49</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) le label de classe (covid ou normal).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous chargeons l'image, la convertissons en canaux RVB et la réduisons à une taille de 224x224 pixels pour alimenter un réseau neuronal convolutionnel ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 53-55</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise à jour des listes de données et d'étiquettes ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 58 et 59</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous mettons l'échelle des pixels à l'échelle </font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et convertissons les données et les étiquettes au format de tableau NumPy ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 63 et 64</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous effectuerons un codage à chaud de nos étiquettes et diviserons l'ensemble de données en ensembles de formation et de test:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels); print(labels)<font></font>
<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
    test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
    rotation_range=<span class="hljs-number">15</span>,<font></font>
    fill_mode=<span class="hljs-string">"nearest"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le codage unitaire des étiquettes s'effectue aux </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 67 à 69</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : les données seront présentées dans ce format:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque étiquette codée de cette manière est constituée d'un tableau à deux éléments, dans lequel l'un des éléments est «chaud» (1) et le second est «non» (0). Aux </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 73 et 74, l'</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ensemble de données est divisé en deux parties: 80% pour la formation, 20% pour les tests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour généraliser le modèle, nous effectuons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une expansion des données</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (augmentation des données), en définissant une rotation aléatoire de l'image de 15 degrés dans le sens horaire ou en la contrant. L'objet de génération d'extension est initialisé sur les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 77-79</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, initialisez le modèle VGGNet et préparez-le pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un réglage fin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
    input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))<font></font>
<font></font>
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)<font></font>
<font></font>
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
    layer.trainable = <span class="hljs-literal">False</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aux </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 83 et 84</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , une instance du réseau neuronal VGG16 est créée avec les poids obtenus à l'avance sur ImageNet sans couche entièrement connectée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous allons créer une couche entièrement connectée composée de couches POOL =&gt; FC = SOFTMAX ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 88-93</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) et la placer sur VGG16 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ligne 97</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geler maintenant les poids CONV de sorte que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seule une</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> couche entièrement connectée soit </font><font style="vertical-align: inherit;">entraînée </font><font style="vertical-align: inherit;">( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 101-102</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Ceci termine le réglage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes maintenant prêts à compiler et à former notre modèle d'apprentissage en profondeur:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
    metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
    trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
    steps_per_epoch=len(trainX) // BS,<font></font>
    validation_data=(testX, testY),<font></font>
    validation_steps=len(testX) // BS,<font></font>
    epochs=EPOCHS)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 106-108, l' </font></font></strong><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entraînement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l'optimiseur de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">vitesse d'atténuation du</font></a><font style="vertical-align: inherit;"> réseau compilés </font><font style="vertical-align: inherit;">Adam. Étant donné qu'il s'agit d'une tâche de classification à deux classes, nous utilisons la fonction de perte de l'entropie croisée binaire (binary_crossentropy), et non de l'entropie croisée catégorique (entrentropie catégorielle). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer la formation, nous appelons la méthode Keras </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fit_generator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et lui donnons nos rayons X via une extension d'objet de données ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 112-117</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, évaluons le modèle:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
    target_names=lb.classes_))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, nous effectuons d'abord des prévisions basées sur la suite de tests et obtenons des indices de prévision ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 121-125</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Ensuite, nous générerons et afficherons le rapport de classification ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 128 et 129</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">à l'aide de l'utilitaire scikit-learn </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calculons maintenant la matrice de confusion pour une future estimation statistique:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])<font></font>
<font></font>
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes ici:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">générer une matrice d'inexactitudes ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ligne 133</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous utilisons cette matrice pour déterminer la précision, la sensibilité et la spécificité ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 135-137</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), puis nous dérivons toutes ces mesures ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes 141-143</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, pour une analyse ultérieure, nous affichons sous forme de graphique dans un fichier l'historique des changements de précision et des pertes:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et enfin, nous sérialisons le modèle de classificateur tf.keras sur le disque:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous formons notre détecteur avec Keras et TensorFlow</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après l'implémentation du script train_covid19.py, nous pouvons entraîner le détecteur automatique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez le code source, l'ensemble de données et le modèle pré-formé. </font><font style="vertical-align: inherit;">Ouvrez un terminal et exécutez la commande pour entraîner le détecteur:</font></font><br>
<br>
<pre><code class="python hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch <span class="hljs-number">1</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">20</span>s <span class="hljs-number">4</span>s/step - loss: <span class="hljs-number">0.7169</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.6590</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">2</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">86</span>ms/step - loss: <span class="hljs-number">0.8088</span> - accuracy: <span class="hljs-number">0.4250</span> - val_loss: <span class="hljs-number">0.6112</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">3</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.6809</span> - accuracy: <span class="hljs-number">0.5500</span> - val_loss: <span class="hljs-number">0.6054</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">4</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">100</span>ms/step - loss: <span class="hljs-number">0.6723</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.5771</span> - val_accuracy: <span class="hljs-number">0.6000</span><font></font>
...<font></font>
Epoch <span class="hljs-number">22</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3271</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2902</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">23</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3634</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2690</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">24</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">27</span>s <span class="hljs-number">5</span>s/step - loss: <span class="hljs-number">0.3175</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2395</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">25</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">101</span>ms/step - loss: <span class="hljs-number">0.3655</span> - accuracy: <span class="hljs-number">0.8250</span> - val_loss: <span class="hljs-number">0.2522</span> - val_accuracy: <span class="hljs-number">0.9000</span><font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
<font></font>
       covid       <span class="hljs-number">0.83</span>      <span class="hljs-number">1.00</span>      <span class="hljs-number">0.91</span>         <span class="hljs-number">5</span>
      normal       <span class="hljs-number">1.00</span>      <span class="hljs-number">0.80</span>      <span class="hljs-number">0.89</span>         <span class="hljs-number">5</span><font></font>
<font></font>
    accuracy                           <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
   macro avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
weighted avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span><font></font>
<font></font>
[[<span class="hljs-number">5</span> <span class="hljs-number">0</span>]<font></font>
 [<span class="hljs-number">1</span> <span class="hljs-number">4</span>]]<font></font>
acc: <span class="hljs-number">0.9000</span>
sensitivity: <span class="hljs-number">1.0000</span>
specificity: <span class="hljs-number">0.8000</span>
[INFO] saving COVID<span class="hljs-number">-19</span> detector model...
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagnostic automatique des rayons X</font></font></h3><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans cette partie, nous ne "résolvons" pas le problème de détermination du COVID-19. Il est rédigé dans le contexte de la situation actuelle et uniquement à des fins éducatives. Ceci est un exemple de l'application pratique de la vision par ordinateur et de l'apprentissage en profondeur, afin que vous vous familiarisiez avec différentes mesures, y compris la précision, la sensibilité et la spécificité habituelles (et les compromis qui doivent être pris en compte lorsque vous travaillez avec des données médicales). Je le répète, nous </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne résolvons pas le</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> problème de détermination du COVID-19.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ainsi, notre détecteur automatique a montré une précision de</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ~ 90-92%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur des échantillons d'</font><font style="vertical-align: inherit;">images radiographiques</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seuls</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Aucune autre information n'a été utilisée pour former le modèle, y compris l'emplacement géographique, la densité de population, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons également reçu</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sensibilité de 100%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spécificité de 80%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui signifie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parmi les patients </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (vrais cas positifs), en utilisant le modèle, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous avons pu identifier avec précision comme «COVID-19 positif» dans 100% des cas.</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parmi les patients qui </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'avaient pas de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (véritables cas négatifs), en utilisant le modèle, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous avons pu identifier avec précision comme «COVID-19-négatif» dans seulement 80% des cas.</font></font></strong></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le montre le graphique de l'historique d'entraînement, le réseau neuronal n'est pas recyclé, malgré la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">très petite</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> taille des données d'entraînement:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/566/c90/eb8/566c90eb8e4b35dd1d5c5293e90084f6.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 3:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ce graphique de précision et de perte montre que notre modèle n'est pas recyclé.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
C'est formidable d'avoir atteint une précision de 100% lors de la détection de COVID-19. Cependant, la situation avec des cas vraiment négatifs est embarrassante:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous ne voulons pas attribuer à «COVID-19-négatif» ceux qui sont réellement «COVID-19-positifs».</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous voulons moins laisser les patients malades rentrer chez eux, dans leurs familles et amis, ce qui contribue à la propagation de la maladie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez également être</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> très prudent</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec la part des cas de faux positifs:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous ne voulons pas considérer par erreur quelqu'un comme malade et le mettre en quarantaine avec d'autres patients afin qu'il en soit infecté</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trouver un équilibre entre sensibilité et spécificité -</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tâche </font><i><font style="vertical-align: inherit;">extrêmement difficile</font></i><font style="vertical-align: inherit;"> , surtout en ce qui concerne la médecine, et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surtout</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en ce qui concerne la propagation rapide des maladies infectieuses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En parlant de vision par ordinateur médicale et d'apprentissage en profondeur, vous devez toujours vous rappeler que le travail de nos modèles prédictifs peut avoir des conséquences très graves: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des diagnostics erronés peuvent coûter des vies</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je le répète, les résultats de cet article sont présentés </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à des fins éducatives uniquement</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ce n'est pas une publication de revue, ces données ne répondent pas aux critères du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRÉPIED pour la publication des modèles de prévision.</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitations, améliorations et travaux ultérieurs</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/032/a41/702032a4173717d7cc9fddb00d67ee27.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 4:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aujourd'hui, les professionnels de l'IA et du deep learning manquent de données COVID-19 de qualité pour former efficacement les systèmes de reconnaissance automatique d'images.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'une des principales limites de la méthode décrite dans ce manuel concerne les données.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous ne disposons pas de suffisamment de données (fiables) pour former des détecteurs COVID-19.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Les hôpitaux ont déjà de nombreux antécédents de cas avec ce virus, mais compte tenu de la confidentialité et des droits de l'homme, il devient encore plus difficile d'assembler rapidement un ensemble de données de haute qualité à partir d'images médicales. Je pense qu'au cours des 12 à 18 prochains mois, nous aurons plus de données de qualité. Mais pour l'instant, vous devez utiliser ce que vous avez.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai essayé (compte tenu de ma condition physique et mentale) dans des conditions de temps et de ressources limités d'écrire ce guide pour ceux qui sont intéressés par l'utilisation de la vision par ordinateur et de l'apprentissage profond. Mais </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permettez-moi de</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous rappeler que </font><strong><font style="vertical-align: inherit;">je ne suis pas un médecin professionnel</font></strong><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin d'utiliser le détecteur COVID-19 dans la vie réelle, il doit être </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rigoureusement</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> testé par de vrais médecins travaillant main dans la main avec des spécialistes de l'apprentissage en profondeur. La méthode que j'ai décrite ne convient pas à cela. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, il faut faire attention à ce que le modèle «apprend» exactement.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Comme je l'ai écrit dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le manuel Grad-CAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, il est probable que le modèle apprendra des modèles qui ne sont pas pertinents pour COVID-19, mais ne pourra distinguer que deux échantillons de données (c'est-à-dire des diagnostics positifs et négatifs). Les résultats de notre détecteur devront être rigoureusement testés et vérifiés par des médecins. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enfin, les futurs détecteurs (et plus avancés) seront multimodaux.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Maintenant, nous utilisons uniquement des données visuelles (rayons X). De meilleurs détecteurs devraient utiliser d'autres données: indicateurs vitaux des patients, densité de population, situation géographique, etc. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les données visuelles seules ne sont généralement pas suffisantes pour de telles tâches</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ces raisons, je tiens à souligner à nouveau: ce guide ne joue que le rôle de matériel de formation - il ne peut pas être considéré comme un détecteur COVID-19 fiable. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous pensez que vous ou une personne proche de COVID-19, suivez les recommandations de votre système de santé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que ce guide vous a été utile. </font><font style="vertical-align: inherit;">J'espère également que ce sera pour quelqu'un un point de départ dans la recherche de méthodes d'utilisation de la vision par ordinateur et de l'apprentissage en profondeur pour déterminer automatiquement COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce guide, vous avez appris à utiliser Keras, TensorFlow et le deep learning pour créer un détecteur automatique COVID-19 sur un jeu de données à partir d'images radiographiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui (encore) il n'y a pas de jeux de données d'images de haute qualité et vérifiées pour cette maladie, vous devez donc travailler avec </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le référentiel Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons pris 25 images de son</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ensemble de données </font><strong><font style="vertical-align: inherit;">,</font></strong><font style="vertical-align: inherit;"> nous limitant à la projection antéropostérieure de cas diagnostiqués positivement.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous avons pris 25 photos de personnes en bonne santé à</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir du jeu de données </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaggle Chest X-Ray Images (Pneumonia).</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puis, avec l'aide de Keras et TensorFlow, nous avons formé le détecteur COVID-19, qui a montré une </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">précision de</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 90 à 92 </font><strong><font style="vertical-align: inherit;">%</font></strong><font style="vertical-align: inherit;"> sur notre échantillon de test, avec une sensibilité de 100% et une spécificité de 80% (sur notre petit ensemble de données). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'oubliez pas que le détecteur décrit ici est uniquement à des fins éducatives (voir la note dans le texte). </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je voulais inspirer d'autres personnes à utiliser l'apprentissage en profondeur, pour montrer qu'en combinaison avec la vision par ordinateur, cela pouvait avoir un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grand impact</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur nos vies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que vous avez aimé.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493596/index.html">L'homme qui n'était pas pressé</a></li>
<li><a href="../fr493598/index.html">Masquer une partie du numéro de téléphone</a></li>
<li><a href="../fr493604/index.html">Événements numériques à Moscou du 23 au 29 mars</a></li>
<li><a href="../fr493606/index.html">L'histoire de la création d'un service cloud parfumé au cyberpunk</a></li>
<li><a href="../fr493610/index.html">Programmation d'une couche vidéo dans un Raspberry Pi à l'aide de l'API DispmanX</a></li>
<li><a href="../fr493616/index.html">Des images comme des boîtes - que contient-il? Signaler dans Yandex</a></li>
<li><a href="../fr493618/index.html">OSINT (pas) évident sur Twitter</a></li>
<li><a href="../fr493620/index.html">Courbe logistique. Quand l'épidémie prendra-t-elle fin?</a></li>
<li><a href="../fr493622/index.html">Écrire un Retrowave sur Angular</a></li>
<li><a href="../fr493626/index.html">Selenoid - Des centaines de tests d'interface utilisateur parallèles faciles et rapides. Pavel Senin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>