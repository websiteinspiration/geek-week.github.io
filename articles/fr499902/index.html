<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â¤´ï¸ âœ‹ğŸ½ ğŸ‘¨â€ğŸš’ Fonctionnement de l'attaque de rÃ©initialisation TCP ğŸ‘©ğŸ½â€ğŸ­ âºï¸ ğŸ‘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une attaque de rÃ©initialisation TCP est effectuÃ©e Ã  l'aide d'un seul paquet de donnÃ©es de quelques octets au maximum. Le segment TCP remplacÃ© par l'us...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Fonctionnement de l'attaque de rÃ©initialisation TCP</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499902/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une attaque de rÃ©initialisation TCP est effectuÃ©e Ã  l'aide d'un seul paquet de donnÃ©es de quelques octets au maximum. </font><font style="vertical-align: inherit;">Le segment TCP remplacÃ© par l'usurpation d'identitÃ©, crÃ©Ã© et transmis par l'attaquant, trompe les deux victimes pour mettre fin Ã  la connexion TCP, interrompant la connexion entre elles, ce qui pourrait Ãªtre critique.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d0e/768/854/d0e7688544d90ce84fd01f7aae77b348.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette attaque a eu des consÃ©quences dans le monde rÃ©el. </font><font style="vertical-align: inherit;">Les craintes de son utilisation ont Ã©tÃ© provoquÃ©es par l'introduction de modifications au protocole TCP lui-mÃªme. </font><font style="vertical-align: inherit;">L'attaque serait une composante essentielle du grand pare-feu chinois (le Bouclier d'or), qui est utilisÃ© par le gouvernement chinois pour censurer Internet en dehors de la Chine. </font><font style="vertical-align: inherit;">MalgrÃ© ses antÃ©cÃ©dents impressionnants, la comprÃ©hension des mÃ©canismes derriÃ¨re cette attaque ne nÃ©cessite pas nÃ©cessairement une connaissance approfondie de TCP. </font><font style="vertical-align: inherit;">Bien sÃ»r, une comprÃ©hension de ses subtilitÃ©s peut vous en apprendre beaucoup sur les fonctionnalitÃ©s de la mise en Å“uvre du protocole TCP, et, comme nous le verrons bientÃ´t, vous pouvez mÃªme mener cette attaque contre vous-mÃªme en utilisant un seul ordinateur portable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apprenez les bases de TCP</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apprenez comment fonctionne l'attaque.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LanÃ§ons une attaque contre nous-mÃªmes avec un simple script Python.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de commencer Ã  analyser la mÃ©canique de l'attaque, voyons d'abord comment elle est utilisÃ©e dans le monde rÃ©el.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment l'attaque de rÃ©initialisation TCP est-elle utilisÃ©e dans le grand pare-feu?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Great Firewall (GFW) est un ensemble de systÃ¨mes et de techniques utilisÃ©s par le gouvernement chinois pour censurer Internet pour les utilisateurs chinois internes. </font><font style="vertical-align: inherit;">GFW bloque et rompt activement les connexions avec les serveurs Ã  l'intÃ©rieur et Ã  l'extÃ©rieur du pays, et surveille Ã©galement passivement le trafic Internet de contenu interdit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour empÃªcher les utilisateurs de se connecter mÃªme Ã  des serveurs interdits, GFW utilise des techniques telles que la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pollution DNS</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blocage IP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(les deux coÃ»tent des articles sÃ©parÃ©s). </font><font style="vertical-align: inherit;">Cependant, le pare-feu GFW doit parfois Ãªtre autorisÃ© Ã  Ã©tablir une connexion, mais Ã  le rompre au milieu. </font><font style="vertical-align: inherit;">Par exemple, cela est nÃ©cessaire si vous souhaitez effectuer une analyse lente et en attente de la connexion, par exemple, sa corrÃ©lation avec d'autres actions. </font><font style="vertical-align: inherit;">Ou il est utilisÃ© si le pare-feu doit analyser les donnÃ©es Ã©changÃ©es au cours du processus de connexion, puis utiliser ces informations pour dÃ©cider de continuer ou de les bloquer. </font><font style="vertical-align: inherit;">Par exemple, le trafic vers un site Web d'actualitÃ©s peut Ãªtre autorisÃ©, mais les vidÃ©os contenant des mots clÃ©s interdits seront censurÃ©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cela, GFW a besoin d'outils capables d'interrompre les connexions dÃ©jÃ  Ã©tablies. </font><font style="vertical-align: inherit;">Un tel outil est une attaque de rÃ©initialisation TCP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment fonctionne une attaque de rÃ©initialisation TCP?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans une attaque de rÃ©initialisation TCP, l'attaquant rompt la connexion entre les deux victimes, envoyant un ou les deux faux messages leur disant de se dÃ©connecter immÃ©diatement. Ces messages sont appelÃ©s </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">segments de rÃ©initialisation TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En fonctionnement normal sans la participation d'un attaquant, les ordinateurs envoient des segments de suppression TCP lorsqu'ils reÃ§oivent du trafic TCP inattendu et souhaitent que l'expÃ©diteur arrÃªte de l'envoyer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'attaque de rÃ©initialisation TCP exploite malicieusement ce mÃ©canisme, incitant les victimes Ã  mettre fin prÃ©maturÃ©ment aux connexions TCP en leur envoyant de faux segments de rÃ©initialisation. Si le faux segment de rÃ©initialisation est effectuÃ© correctement, le rÃ©cepteur le prendra pour le segment rÃ©el et fermera la connexion de sa part, interrompant la transmission d'informations sur cette connexion. Pour poursuivre l'Ã©change de donnÃ©es, les victimes peuvent essayer de crÃ©er une nouvelle connexion TCP, mais l'attaquant peut avoir la possibilitÃ© de rÃ©initialiser cette nouvelle connexion. Heureusement, comme un attaquant a besoin de temps pour crÃ©er et envoyer un faux paquet, la suppression des attaques n'est vraiment efficace que contre les connexions Ã  long terme. Connexions Ã  court terme. par exemple, utilisÃ© pour transfÃ©rer de petites pages Web, ont gÃ©nÃ©ralement le temps de remplir leur mission au moment oÃ¹quand l'attaquant pourra les rÃ©initialiser.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'envoi de faux segments TCP est en quelque sorte un processus facile, car ni TCP ni IP n'ont leurs propres moyens de vÃ©rifier l'identitÃ© de l'expÃ©diteur. Il existe une extension IP appelÃ©e IPSec qui fournit l'authentification, mais elle n'est pas si largement utilisÃ©e. Les fournisseurs de services Internet doivent refuser de transmettre des paquets IP provenant d'une adresse IP manifestement fausse, mais il est allÃ©guÃ© que ce contrÃ´le est trÃ¨s mÃ©diocre. Tout ce que le destinataire peut faire est de prendre l'adresse IP source et le port Ã  l'intÃ©rieur du paquet ou du segment Ã  leur valeur nominale et, si possible, d'utiliser des protocoles de niveau supÃ©rieur, tels que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/2014/03/27/how-does-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TLS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pour identifier l'expÃ©diteur </font><font style="vertical-align: inherit;">. Cependant, comme les paquets de vidage TCP font partie du protocole TCP lui-mÃªme, ils ne peuvent pas Ãªtre vÃ©rifiÃ©s Ã  l'aide de ces protocoles de haut niveau.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MalgrÃ© la simplicitÃ© de l'envoi de faux segments, la crÃ©ation d'un faux segment et l'exÃ©cution d'une attaque de rÃ©initialisation TCP rÃ©ussie peuvent toujours Ãªtre une tÃ¢che ardue. </font><font style="vertical-align: inherit;">Pour comprendre pourquoi cela se produit, nous devons comprendre le fonctionnement du protocole TCP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment fonctionne TCP</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le but du protocole TCP est d'envoyer au destinataire une copie exacte du bloc de donnÃ©es. </font><font style="vertical-align: inherit;">Par exemple, si mon serveur envoie du HTML via TCP Ã  votre ordinateur, </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la pile TCP de</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> votre ordinateur (la partie de son systÃ¨me d'exploitation qui traite TCP) devrait sortir mon HTML exactement sous la mÃªme forme et dans l'ordre dans lequel mon serveur l'a envoyÃ©.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54d/bf5/d64/54dbf5d644d0a3d8ece1cff6cde7b790.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, mon HTML n'est pas transmis sur Internet d'une maniÃ¨re aussi parfaitement ordonnÃ©e. Il est divisÃ© en plusieurs petits fragments (appelÃ©s </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">segments TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), chacun Ã©tant transmis individuellement sur Internet et recrÃ©Ã© dans l'ordre transfÃ©rÃ© par la pile TCP de votre ordinateur. Cette sortie restaurÃ©e est appelÃ©e </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un flux TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Chaque segment TCP est transmis dans son propre </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paquet IP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cependant, pour comprendre l'attaque, nous n'avons pas besoin de connaÃ®tre les dÃ©tails de l'IP.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/468/904/175/4689041752b8fa9f66c57c696c4be2ef.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conversion de segments en un flux nÃ©cessite des prÃ©cautions car Internet n'est pas fiable. </font><font style="vertical-align: inherit;">Les segments TCP peuvent Ãªtre perdus. </font><font style="vertical-align: inherit;">Ils peuvent Ãªtre hors service, envoyÃ©s deux fois, endommagÃ©s et subir de nombreuses autres mÃ©saventures. </font><font style="vertical-align: inherit;">Par consÃ©quent, le but du protocole TCP est d'assurer une transmission de donnÃ©es fiable sur un rÃ©seau peu fiable. </font><font style="vertical-align: inherit;">TCP effectue cette tÃ¢che, exigeant que les deux cÃ´tÃ©s de la connexion maintiennent un contact Ã©troit entre eux et transmettent constamment des informations sur les blocs de donnÃ©es reÃ§us. </font><font style="vertical-align: inherit;">Cela permet aux expÃ©diteurs de comprendre les donnÃ©es que le destinataire n'a pas encore reÃ§ues et de retransmettre les donnÃ©es perdues. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour comprendre le fonctionnement du processus, nous devons comprendre comment les expÃ©diteurs et les rÃ©cepteurs utilisent </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les numÃ©ros de sÃ©quence TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour le marquage et le suivi des donnÃ©es transmises via TCP.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NumÃ©ros de sÃ©quence TCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque octet transmis sur une connexion TCP a un numÃ©ro de sÃ©quence qui lui est attribuÃ© par l'expÃ©diteur. </font><font style="vertical-align: inherit;">Les machines rÃ©ceptrices utilisent des numÃ©ros de sÃ©rie pour dÃ©placer les donnÃ©es reÃ§ues dans la commande d'origine.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/402/fbc/144/402fbc144a2864f986debfb2ea9b6412.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque deux machines nÃ©gocient une connexion TCP, chaque machine envoie un autre </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">numÃ©ro de sÃ©quence de dÃ©marrage</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alÃ©atoire </font><font style="vertical-align: inherit;">. Il s'agit du numÃ©ro de sÃ©quence que la machine attribuera au premier octet qu'elle envoie. Chaque octet suivant reÃ§oit le numÃ©ro de sÃ©quence de l'octet prÃ©cÃ©dent plus 1. Les segments </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contiennent </font><em><font style="vertical-align: inherit;">des en-tÃªtes TCP</font></em><font style="vertical-align: inherit;"> , qui sont des mÃ©tadonnÃ©es attachÃ©es au dÃ©but du segment. Le numÃ©ro de sÃ©quence du premier octet dans le corps du segment est inclus dans l'en-tÃªte TCP de ce segment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter que les connexions TCP sont bidirectionnelles, c'est-Ã -dire que les donnÃ©es peuvent Ãªtre transmises dans les deux sens, et chaque machine dans une connexion TCP agit Ã  la fois comme un expÃ©diteur et un rÃ©cepteur. Pour cette raison, chaque machine doit attribuer et traiter son propre ensemble indÃ©pendant de numÃ©ros de sÃ©quence.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Confirmation de rÃ©ception des donnÃ©es</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'une machine reÃ§oit un segment TCP, elle indique Ã  l'expÃ©diteur du segment qu'il a Ã©tÃ© reÃ§u. </font><font style="vertical-align: inherit;">Le destinataire le fait en envoyant un segment </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(abrÃ©viation de Â«accusÃ© de rÃ©ceptionÂ»), contenant le numÃ©ro de sÃ©quence de l' </font><font style="vertical-align: inherit;">octet </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivant</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qu'il s'attend Ã  recevoir de l'expÃ©diteur. </font><font style="vertical-align: inherit;">L'expÃ©diteur utilise ces informations pour comprendre que le rÃ©cepteur a bien reÃ§u tous les autres octets jusqu'Ã  ce nombre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un segment est </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indiquÃ© par la prÃ©sence d'un indicateur </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le numÃ©ro de confirmation correspondant dans l'en-tÃªte TCP du segment. </font><font style="vertical-align: inherit;">Il n'y a que 6 drapeaux dans le protocole TCP, y compris (comme nous le verrons bientÃ´t) un drapeau </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(abrÃ©viation de Â«resetÂ» - Â«resetÂ»), indiquant le segment de rÃ©initialisation.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/242/452/e35/242452e35d360faf406441ab93f8c383.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remarque: TCP permet Ã©galement l'utilisation d' </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accusÃ©s de rÃ©ception sÃ©lectifs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui sont transmis lorsque le rÃ©cepteur a reÃ§u certains segments, mais pas tous, dans la plage de nombres. Par exemple, "J'ai reÃ§u les octets 1000-3000 et 4000-5000, mais pas 3001-3999". Par souci de simplicitÃ©, je ne considÃ©rerai pas les ACK sÃ©lectifs dans notre discussion sur les attaques de rÃ©initialisation TCP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'expÃ©diteur transmet des donnÃ©es mais ne reÃ§oit pas</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour eux pendant un certain intervalle de temps, il suppose que les donnÃ©es ont Ã©tÃ© perdues et les renvoie, en leur donnant les mÃªmes numÃ©ros de sÃ©rie. Cela signifie que si le rÃ©cepteur accepte deux fois les mÃªmes octets, il utilise trivialement les numÃ©ros de sÃ©quence pour se dÃ©barrasser des doublons sans interrompre le flux. Le destinataire peut accepter des donnÃ©es en double parce que le segment d'origine a Ã©tÃ© reÃ§u plus tard, aprÃ¨s qu'il a Ã©tÃ© envoyÃ© Ã  nouveau, ou parce que le segment d'origine a Ã©tÃ© reÃ§u avec succÃ¨s, mais que le segment correspondant a Ã©tÃ© </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perdu sur le chemin de l'expÃ©diteur.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/22f/a09/e6d22fa098d7375dab30e6c8341ff358.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que ces donnÃ©es en double soient assez rares, le gaspillage excessif de ressources qui en rÃ©sulte ne pose pas de problÃ¨mes. </font><font style="vertical-align: inherit;">Si toutes les donnÃ©es parviennent tÃ´t ou tard au destinataire et que les donnÃ©es correspondantes </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parviennent Ã  l'expÃ©diteur, la connexion TCP fait son travail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choisir un numÃ©ro de sÃ©rie pour un faux segment</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la crÃ©ation d'un faux segment, l' </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attaquant doit lui donner un numÃ©ro de sÃ©rie. </font><font style="vertical-align: inherit;">Les destinataires sont trÃ¨s heureux que vous ayez besoin d'accepter des segments avec des numÃ©ros de sÃ©rie incohÃ©rents et de les connecter indÃ©pendamment dans le bon ordre. </font><font style="vertical-align: inherit;">Cependant, leurs capacitÃ©s sont limitÃ©es. </font><font style="vertical-align: inherit;">Si le destinataire reÃ§oit un segment avec un numÃ©ro de sÃ©quence qui est Â«tropÂ» hors service, il rejette un tel segment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par consÃ©quent, pour une attaque de rÃ©initialisation TCP rÃ©ussie, un numÃ©ro de sÃ©quence plausible est requis. </font><font style="vertical-align: inherit;">Mais qu'est-ce qui est considÃ©rÃ© comme un tel nombre? </font><font style="vertical-align: inherit;">Pour la plupart des segments (bien que, comme nous le verrons plus loin, pas pour </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), la rÃ©ponse est dÃ©terminÃ©e par la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taille de la fenÃªtre TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Taille de la fenÃªtre TCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez un ancien ordinateur du dÃ©but des annÃ©es 1990, connectÃ© Ã  un rÃ©seau de fibre optique gigabit moderne. Un rÃ©seau ultrarapide peut transfÃ©rer des donnÃ©es vers cet ordinateur Ã¢gÃ© Ã  une vitesse incroyable, plus rapidement que la machine ne peut les traiter. Cela nous dÃ©range, car le segment TCP ne peut pas Ãªtre considÃ©rÃ© comme reÃ§u tant que le rÃ©cepteur ne peut pas le traiter.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a5/299/76a/8a529976a3acd7a28babb9e8220bcb7d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les ordinateurs ont une </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃ©moire tampon TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans laquelle les nouvelles donnÃ©es arrivant en attente de traitement pendant que l'ordinateur travaille sur les donnÃ©es qui arrivent avant. Cependant, ce tampon a une taille limitÃ©e. Si le destinataire n'est pas en mesure de faire face Ã  la quantitÃ© de donnÃ©es qui lui est transmise par le rÃ©seau, le tampon dÃ©bordera. Lorsque le tampon est plein, le destinataire n'a d'autre choix que de se dÃ©barrasser des donnÃ©es redondantes. Le destinataire n'envoie pas </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de donnÃ©es supprimÃ©es, l'expÃ©diteur doit donc les renvoyer lorsqu'il y a de l'espace libre dans le tampon du destinataire. Peu importe la vitesse Ã  laquelle le rÃ©seau peut transmettre des donnÃ©es si le destinataire n'a pas le temps de les gÃ©rer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez un ami trop zÃ©lÃ© qui vous envoie un flux entier de lettres Ã  votre courrier plus rapidement que vous ne pouvez le lire. Il y a un certain espace tampon Ã  l'intÃ©rieur de votre boÃ®te aux lettres, mais une fois qu'il est plein, toutes les lettres non placÃ©es tomberont au sol, oÃ¹ les renards et autres crÃ©atures les mangeront. Un ami devra renvoyer les lettres qu'il a mangÃ©es, mais pour l'instant vous aurez le temps de recevoir ses prÃ©cÃ©dents messages. L'envoi d'un trop grand nombre de lettres ou d'un volume de donnÃ©es que le destinataire n'est pas en mesure de traiter est un gaspillage d'Ã©nergie et de canal de transmission. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Â«TropÂ» - de combien de donnÃ©es s'agit-il? Comment l'expÃ©diteur comprend-il quand envoyer plus de donnÃ©es et quand vaut-il la peine d'attendre? C'est lÃ  que la </font><em><font style="vertical-align: inherit;">taille de la fenÃªtre TCP</font></em><font style="vertical-align: inherit;"> est utile.</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. La taille de la fenÃªtre du destinataire est le nombre maximal d'octets non acquittÃ©s que l'expÃ©diteur peut lui transfÃ©rer Ã  tout moment. Supposons que le destinataire signale que sa taille de fenÃªtre est de 100 000 (nous dÃ©couvrirons bientÃ´t comment il transmet cette valeur), de sorte que l'expÃ©diteur envoie 100 000 octets. Supposons qu'au moment oÃ¹ l'expÃ©diteur a transmis un cent milliÃ¨me d'octet, le rÃ©cepteur ait envoyÃ© les segments </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les 10 000 premiers de ces octets. Cela signifie que 90 000 octets n'ont pas encore Ã©tÃ© confirmÃ©s. Ã‰tant donnÃ© que la taille de la fenÃªtre est de 100 000, l'expÃ©diteur peut transfÃ©rer 10 000 autres octets avant d'attendre de nouveaux </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si, aprÃ¨s avoir envoyÃ© ces 10 000 octets supplÃ©mentaires,</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'il n'a pas Ã©tÃ© reÃ§u, l'expÃ©diteur s'exÃ©cutera dans sa limite de 100 000 octets non confirmÃ©s. Par consÃ©quent, l'expÃ©diteur devra attendre et cesser d'envoyer des donnÃ©es (sauf pour la retransmission de donnÃ©es qu'il considÃ¨re comme perdues) jusqu'Ã  ce qu'il en reÃ§oive de nouvelles </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/afa/5df/46f/afa5df46f3304b04abbf629ca6ef34a0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque cÃ´tÃ© de la connexion TCP notifie Ã  l'autre la taille de sa fenÃªtre pendant le processus de prise de contact qui est effectuÃ© lorsque la connexion est ouverte. De plus, la taille des fenÃªtres peut Ãªtre modifiÃ©e dynamiquement pendant le processus de connexion. Un ordinateur avec un grand tampon TCP peut annoncer une grande taille de fenÃªtre pour maximiser le dÃ©bit. Cela permet Ã  la machine qui communique avec elle de transmettre en continu des donnÃ©es via une connexion TCP sans pause ni attente de confirmation. Un ordinateur avec un petit tampon TCP peut Ãªtre contraint de signaler une petite taille de fenÃªtre. Parfois, les expÃ©diteurs remplissent complÃ¨tement la fenÃªtre et sont obligÃ©s d'attendre que certains segments soient confirmÃ©s. La bande passante en souffre, mais il est nÃ©cessaire que les tampons TCP ne dÃ©bordent pas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e3/d5e/5e0/8e3d5e5e0e4b574c6896e6ef7adc94bc.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La taille de la fenÃªtre TCP est une limite stricte sur la quantitÃ© de donnÃ©es non confirmÃ©es transmises. </font><font style="vertical-align: inherit;">Nous pouvons l'utiliser pour calculer le numÃ©ro de sÃ©quence maximum possible (que dans l'Ã©quation ci-dessous j'ai dÃ©signÃ© comme </font></font><code>max_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), que l'expÃ©diteur peut envoyer Ã  l'heure actuelle:</font></font><br>
<br>
<blockquote><code>max_seq_no = max_acked_seq_no + window_size</code></blockquote><br>
<code>max_acked_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Il s'agit du numÃ©ro de sÃ©quence maximum pour lequel le destinataire a envoyÃ© </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il s'agit du numÃ©ro de sÃ©quence maximal que l'expÃ©diteur sait que le destinataire a exactement reÃ§u. </font><font style="vertical-align: inherit;">Ã‰tant donnÃ© que l'expÃ©diteur ne peut transmettre que des </font></font><code>window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octets non confirmÃ©s, le numÃ©ro de sÃ©quence maximal qu'il peut envoyer est </font></font><code>max_acked_seq_no + window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cette raison, la spÃ©cification TCP indique que le destinataire doit ignorer toutes les donnÃ©es qu'il reÃ§oit qui ont des numÃ©ros de sÃ©rie en dehors de la fenÃªtre valide. Par exemple, si le destinataire a confirmÃ© tous les octets jusqu'Ã  15 000 et que la taille de sa fenÃªtre est de 30 000, il recevra toutes les donnÃ©es avec un numÃ©ro de sÃ©rie compris entre 15 000 et (15 000 + 30 000 = 45 000). De plus, le destinataire ignore complÃ¨tement les donnÃ©es avec des numÃ©ros de sÃ©rie en dehors de cet intervalle. Si un segment contient des donnÃ©es, dont certaines se trouvent dans cette fenÃªtre et d'autres en dehors, alors les donnÃ©es Ã  l'intÃ©rieur de la fenÃªtre seront acceptÃ©es et confirmÃ©es, mais les donnÃ©es Ã  l'extÃ©rieur seront rejetÃ©es. Notez que nous ignorons toujours la possibilitÃ© des </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sÃ©lections</font></font><code>ACK</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui ont Ã©tÃ© briÃ¨vement Ã©voquÃ©es au dÃ©but du post.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas de la plupart des segments TCP, cette rÃ¨gle nous donne un intervalle de numÃ©ros de sÃ©quence acceptables. </font><font style="vertical-align: inherit;">Cependant, comme mentionnÃ© prÃ©cÃ©demment, les </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restrictions </font><font style="vertical-align: inherit;">imposÃ©es sur les segments </font><font style="vertical-align: inherit;">sont encore plus strictes que les restrictions sur les segments de transmission de donnÃ©es ordinaires. </font><font style="vertical-align: inherit;">Comme nous le verrons bientÃ´t, cela a Ã©tÃ© fait pour compliquer la conduite d'une variante d'une </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attaque de</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rÃ©initialisation TCP appelÃ©e </font><em><font style="vertical-align: inherit;">Â«attaque de rÃ©initialisation TCP aveugleÂ»</font></em><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NumÃ©ros de sÃ©quence acceptables pour les segments RST</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les segments rÃ©guliers sont acceptÃ©s si leur numÃ©ro de sÃ©quence se situe entre le prochain numÃ©ro de sÃ©quence attendu et ce numÃ©ro plus la taille de la fenÃªtre. Cependant, les paquets </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne sont reÃ§us que lorsque leur numÃ©ro de sÃ©quence est </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exactement Ã©gal au</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prochain numÃ©ro de sÃ©quence attendu. Revenons Ã  l'exemple prÃ©cÃ©dent, dans lequel le destinataire a envoyÃ© le numÃ©ro de confirmation 15 000. Pour que le paquet </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">soit reÃ§u, son numÃ©ro de sÃ©quence doit Ãªtre exactement 15 000. Si le destinataire reÃ§oit un segment </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un numÃ©ro de sÃ©quence diffÃ©rent de 15 000, il ne l'acceptera pas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d9/596/b55/1d9596b55bb0ac4946ed16ff6b878dff.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le numÃ©ro de sÃ©quence est en dehors de l'intervalle, le rÃ©cepteur l'ignore complÃ¨tement. </font><font style="vertical-align: inherit;">Cependant, s'il se trouve dans la fenÃªtre des numÃ©ros de sÃ©quence attendus, le rÃ©cepteur envoie un Â«dÃ©fi </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â» (Â«appel ACKÂ»). </font><font style="vertical-align: inherit;">Il s'agit d'un segment qui indique Ã  l'expÃ©diteur que le segment </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a un numÃ©ro de sÃ©quence non valide. </font><font style="vertical-align: inherit;">Il indique Ã©galement Ã  l'expÃ©diteur le numÃ©ro de sÃ©quence que le destinataire attend. </font><font style="vertical-align: inherit;">L'expÃ©diteur peut utiliser ces informations de l' </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appel pour recrÃ©er et renvoyer les siennes </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'en 2010, TCP n'a pas imposÃ© ces restrictions de segment supplÃ©mentaires </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Les segments ont Ã©tÃ© </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acceptÃ©s ou rejetÃ©s conformÃ©ment aux mÃªmes rÃ¨gles que les autres. </font><font style="vertical-align: inherit;">Cependant, cela a Ã©galement simplifiÃ© les </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attaques aveugles de rÃ©initialisation TCP aveugles</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attaques TCP aveugles</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'attaquant a la capacitÃ© d'intercepter le trafic Ã©changÃ© entre ses victimes, il peut lire les numÃ©ros de sÃ©rie et de confirmation des paquets TCP des victimes. Il peut utiliser ces informations pour sÃ©lectionner les numÃ©ros de sÃ©rie Ã  attribuer Ã  ses faux segments </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Cependant, si l'attaquant ne peut pas intercepter le trafic des victimes, il ne saura pas quels numÃ©ros de sÃ©quence insÃ©rer. Mais il peut toujours transfÃ©rer n'importe quel nombre de segments </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un nombre quelconque de numÃ©ros de sÃ©rie diffÃ©rents, en espÃ©rant que l'un d'eux se rÃ©vÃ¨le Ãªtre correct. Une telle attaque est appelÃ©e attaque de rÃ©initialisation TCP aveugle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous l'avons dÃ©jÃ  dit, dans la version initiale du protocole TCP, l'attaquant n'avait qu'Ã  rÃ©cupÃ©rer le numÃ©ro de sÃ©rie</font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans la fenÃªtre TCP du rÃ©cepteur. </font><font style="vertical-align: inherit;">Un article intitulÃ© Â«Slipping in the WindowÂ» a montrÃ© que cela rendait les attaques aveugles trop faciles, car pour un succÃ¨s presque garanti, un attaquant n'avait qu'Ã  envoyer des dizaines de milliers de segments. </font><font style="vertical-align: inherit;">Pour contrer cela, la rÃ¨gle qui obligeait le destinataire Ã  accepter le segment a </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©tÃ© remplacÃ©e par le critÃ¨re plus strict dÃ©crit ci-dessus. </font><font style="vertical-align: inherit;">GrÃ¢ce aux nouvelles rÃ¨gles pour effectuer des attaques de rÃ©initialisation TCP, des millions de segments doivent Ãªtre envoyÃ©s Ã  l'aveugle, ce qui les rend pratiquement irrÃ©alisables. </font><font style="vertical-align: inherit;">Voir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC-5963 pour</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">de</font></a><font style="vertical-align: inherit;"> dÃ©tails </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effectuer une attaque de rÃ©initialisation TCP contre nous-mÃªmes</font></font></h2><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque: J'ai testÃ© ce processus sur OSX, mais j'ai reÃ§u quelques commentaires selon lesquels il ne fonctionne pas correctement sous Linux. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous savons maintenant tout sur l'exÃ©cution d'une attaque de rÃ©initialisation TCP. </font><font style="vertical-align: inherit;">L'attaquant doit:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regarder le trafic rÃ©seau ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«sniffÂ»</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) entre deux victimes</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renifler le segment TCP avec le drapeau activÃ© </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et lire son numÃ©ro confirmÃ©</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CrÃ©ez un faux segment TCP avec l'indicateur activÃ© </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et un numÃ©ro de sÃ©quence Ã©gal au numÃ©ro confirmÃ© du segment interceptÃ© (notez que cela implique une transmission lente, sinon le numÃ©ro de sÃ©quence sÃ©lectionnÃ© deviendra rapidement obsolÃ¨te. (Pour augmenter les chances de succÃ¨s, vous pouvez transfÃ©rer plusieurs segments </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un grand intervalle de numÃ©ros de sÃ©quence .)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envoyez de faux segments Ã  une ou aux deux victimes, en espÃ©rant que cela rompra leur connexion TCP</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous entraÃ®ner, menons une attaque TCP contre nous-mÃªmes sur le mÃªme ordinateur, en communiquant avec nous-mÃªmes </font></font><code>localhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pour cela, nous avons besoin de:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer la connexion TCP entre deux fenÃªtres de terminal</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‰crivez un programme d'attaque qui traitera le reniflement du trafic</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifiez le programme pour qu'il produise et envoie de faux segments </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CommenÃ§ons.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Etablissement d'une connexion TCP entre deux fenÃªtres de terminal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons configurer la connexion TCP Ã  l'aide de l'outil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><code>netcat</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui par dÃ©faut est disponible sur de nombreux systÃ¨mes d'exploitation. </font><font style="vertical-align: inherit;">Tout autre </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client TCP fera l'affaire</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans la premiÃ¨re fenÃªtre du terminal, nous exÃ©cuterons la commande suivante:</font></font><br>
<br>
<blockquote><code>nc -nvl 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette commande dÃ©marre un serveur TCP Ã©coutant sur un port de notre machine locale </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans la deuxiÃ¨me fenÃªtre de terminal, exÃ©cutez la commande suivante:</font></font><br>
<br>
<blockquote><code>nc 127.0.0.1 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette commande tente de crÃ©er une connexion TCP Ã  la machine par l'adresse IP du </font></font><code>127.0.0.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">port </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Maintenant, entre les deux fenÃªtres du terminal, une connexion TCP doit Ãªtre Ã©tablie. </font><font style="vertical-align: inherit;">Essayez de saisir quelque chose dans une fenÃªtre - les donnÃ©es devront Ãªtre transmises via la connexion TCP et apparaÃ®tre dans une autre fenÃªtre.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/911/301/786/911301786c4f56287f80d38f67ef73f6.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Reniflement du trafic</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons Ã©crire un programme d'attaque qui effectue le reniflement du trafic Ã  l'aide de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><code>scapy</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bibliothÃ¨que rÃ©seau Python populaire. </font><font style="vertical-align: inherit;">Ce programme utilise scapy pour lire les donnÃ©es transfÃ©rÃ©es entre deux fenÃªtres du terminal, bien qu'il ne fasse pas partie de la connexion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code du programme est publiÃ© dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mon rÃ©fÃ©rentiel sur GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le programme renifle le trafic de connexion et l'affiche sur le terminal. </font><font style="vertical-align: inherit;">Le noyau principal du code est l'appel </font></font><code>sniff</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de </font><font style="vertical-align: inherit;">mÃ©thode Ã  </font><font style="vertical-align: inherit;">partir de la bibliothÃ¨que </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">situÃ©e Ã  la fin du fichier:</font></font><br>
<br>
<pre><code class="python hljs">t = sniff(<font></font>
        iface=<span class="hljs-string">'lo0'</span>,<font></font>
        lfilter=is_packet_tcp_client_to_server(localhost_ip, localhost_server_port, localhost_ip),<font></font>
        prn=log_packet,<font></font>
        count=<span class="hljs-number">50</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce morceau de code nous dit </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de renifler les paquets sur l'interface </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et de capturer les dÃ©tails de tous les paquets dans le cadre de notre connexion TCP. </font><font style="vertical-align: inherit;">L'appel a les paramÃ¨tres suivants:</font></font><br>
<br>
<ul>
<li><code>iface</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- commandes </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d'Ã©coute de l'interface rÃ©seau </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou localhost</font></font></li>
<li><code>lfilter</code> â€”  ,  <code>scapy</code>   ,      IP- localhost   .   ,        ,   <code>lo0</code>.     ,     .</li>
<li><code>prn</code> â€” ,  <code>scapy</code>     ,    <code>lfilter</code>.          .       ,      <code>RST</code>.</li>
<li><code>count</code> â€”  ,  <code>scapy</code>    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour tester ce programme, configurez la connexion TCP Ã  partir de l'Ã©tape 1. Clonez mon rÃ©fÃ©rentiel GitHub, suivez les instructions de configuration et exÃ©cutez le programme dans la troisiÃ¨me fenÃªtre du terminal. </font><font style="vertical-align: inherit;">Saisissez du texte dans l'un des terminaux de la connexion TCP. </font><font style="vertical-align: inherit;">Vous devriez voir que le programme commencera Ã  enregistrer des informations sur les segments de connexion.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Envoi de faux colis </font></font><code>RST</code></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons Ã©tabli une connexion et le programme peut dÃ©tecter tous les segments TCP qui le traversent. Il ne nous reste plus qu'Ã  modifier le programme pour qu'il effectue une attaque de rÃ©initialisation TCP en transmettant de faux segments </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour ce faire, nous allons changer la fonction </font></font><code>prn</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(voir la liste des paramÃ¨tres ci-dessus), appelÃ©e </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les packages qui rÃ©pondent aux exigences de la fonction </font></font><code>lfilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans la version modifiÃ©e de la fonction, au lieu de simplement fixer le package correspondant, nous l'Ã©tudions, extrayons les paramÃ¨tres nÃ©cessaires et utilisons ces paramÃ¨tres pour crÃ©er et envoyer le segment </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons que nous ayons interceptÃ© un segment allant de </font></font><code>(src_ip, src_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font><code>(dst_ip, dst_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il a un drapeau </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le numÃ©ro de confirmation est 100 000. Pour fabriquer et envoyer un segment, nous:</font></font><br>
<br>
<ul>
<li>  IP-   ,    .  ,         .          ,  .</li>
<li>  <code>RST</code> ,     ,    <code>RST</code></li>
<li>        ,      ,    </li>
<li>  <code>send</code>  <code>scapy</code>     â€”   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour modifier notre programme prÃ©cÃ©dent selon vos besoins, dÃ©commentez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cette ligne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et commentez la ligne au-dessus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes maintenant prÃªts pour une attaque Ã  grande Ã©chelle. </font><font style="vertical-align: inherit;">Configurez la connexion TCP conformÃ©ment Ã  l'Ã©tape 1. ExÃ©cutez le programme d'attaque Ã  partir de l'Ã©tape 2 dans la troisiÃ¨me fenÃªtre du terminal. </font><font style="vertical-align: inherit;">Saisissez ensuite du texte dans l'un des terminaux de la connexion TCP. </font><font style="vertical-align: inherit;">Dans le terminal oÃ¹ vous avez saisi le texte, la connexion TCP se coupera soudainement et mystÃ©rieusement. </font><font style="vertical-align: inherit;">L'attaque est terminÃ©e!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad9/2a2/b18/ad92a2b18c1533c47d88ab4ff10dedf7.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La poursuite des travaux</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Continuez d'expÃ©rimenter avec l'outil d'attaque. </font><font style="vertical-align: inherit;">Suivez ce qui se passe si vous ajoutez ou soustrayez 1 du numÃ©ro de sÃ©quence du package </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Assurez-vous qu'il doit Ãªtre </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exactement</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã©gal Ã  la valeur du </font></font><code>ack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paquet interceptÃ©.</font></font></li>
<li> Wireshark       <code>lo0</code>    .            TCP-,       <code>RST</code>.   <code>ip.src == 127.0.0.1 &amp;&amp; ip.dst == 127.0.0.1 &amp;&amp; tcp.port == 8000</code>       .</li>
<li>  ,      .           <code>RST</code>,       <code>RST</code>         ,      .   ,      <code>RST</code>,       .</li>
</ol><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'attaque de rÃ©initialisation TCP est Ã  la fois profonde et simple Ã  la fois. </font><font style="vertical-align: inherit;">Bonne chance avec vos expÃ©riences et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">faites-moi savoir</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si vous avez des questions ou des commentaires.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr499884/index.html">11 choses que j'ai comprises sur CustDev</a></li>
<li><a href="../fr499894/index.html">Maison des choses chantantes. Chipolo ONE Smart Keychain Tracker Review</a></li>
<li><a href="../fr499896/index.html">Nous partons correctement sur le site distant: comment organiser notre travail et le travail du projet en Telegram?</a></li>
<li><a href="../fr499898/index.html">Comment les informaticiens se rapportent Ã  la quarantaine, ce qu'ils font de maniÃ¨re autonome et ce qu'ils utilisent</a></li>
<li><a href="../fr499900/index.html">Analyse de produits mitap: gratuit, sans contact, en ligne</a></li>
<li><a href="../fr499904/index.html">"J'ai peur". Que faire?</a></li>
<li><a href="../fr499906/index.html">Exemples d'utilisation de la RA dans l'industrie du jouet</a></li>
<li><a href="../fr499910/index.html">Ã‰quilibre dans la prise de dÃ©cision. Fork "expÃ©rience alÃ©atoire"</a></li>
<li><a href="../fr499920/index.html">SSH Little Tricks</a></li>
<li><a href="../fr499922/index.html">Enfin, nous traitons du dÃ©bit en bauds Modbus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>