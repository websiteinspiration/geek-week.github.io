<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦏 🤸🏾 🧑🏾‍🤝‍🧑🏾 What You Need to Know About Hash-Based Collections 👐🏾 🤒 🏴󠁧󠁢󠁳󠁣󠁴󠁿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone. In touch Vladislav Rodin. Currently, I am the head of the High Load Architect course at OTUS, and I also teach courses on software arc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>What You Need to Know About Hash-Based Collections</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/495032/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello everyone. </font><font style="vertical-align: inherit;">In touch Vladislav Rodin. </font><font style="vertical-align: inherit;">Currently, I am the head of the High Load Architect course at OTUS, and I also teach courses on software architecture. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to teaching, as you can see, I am also writing copyright material for the OTUS blog on the Habré and I want to devote today's article to launching a new stream of the course </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Algorithms for Developers"</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/uz/cy/uo/uzcyuoeiheb64r-2xjnd8r4ntm4.png"><br>
<hr><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hash tables (HashMap) along with dynamic arrays are the most popular data structures used in production. </font><font style="vertical-align: inherit;">Very often you can hear questions at interviews regarding their purpose, features of their internal structure, as well as related algorithms. </font><font style="vertical-align: inherit;">This data structure is classical and is found not only in Java, but also in many other programming languages.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formulation of the problem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's set a goal to create a data structure that allows you to:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contains (Element element)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> check whether an element is in it or not, for O (1)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add (Element element)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> add an element in O (1)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delete (Element element)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delete an element in O (1)</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's try to do these operations on top of an array, which is the simplest data structure. </font><font style="vertical-align: inherit;">We agree that we will consider the cell empty if it contains null.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Availability check</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is necessary to do a linear search through the array, because the element can potentially be in any cell. </font><font style="vertical-align: inherit;">Asymptotically, this can be done in O (n), where n is the size of the array.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adding</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we need to add an element anywhere, then first we need to find an empty cell, and then write the element to it. </font><font style="vertical-align: inherit;">Thus, we again carry out a linear search and obtain the asymptotic behavior of O (n).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delete</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To delete an element, you must first find it, and then write null to the found cell. </font><font style="vertical-align: inherit;">Again linear search leads us to O (n).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The simplest hash set</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that with each operation, we first searched for the index of the desired cell, and then performed the operation, and it is the search that spoils the asymptotics for us! If we learned to get this index for O (1), then the original problem would be solved. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's now replace the linear search with the following algorithm: we will calculate the value of a certain function - a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hash function</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that maps a class object to an integer. After that, we will compare the resulting integer to the index of the array cell (this is quite easy to do, for example, taking the remainder of dividing this number by the size of the array). If the hash function is written in such a way that it is considered to be O (1) (and it is usually written like this), then we get the simplest implementation of the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hash set</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">An array cell in terms of a hash set can be called a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bucket</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The problems of the simplest implementation of a hash set</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No matter how the hash function is written, the number of cells in the array is always limited, while the set of elements that we want to store in the data structure is unlimited. </font><font style="vertical-align: inherit;">After all, we would not bother with the data structure if there was a need to save only ten previously known elements, right? </font><font style="vertical-align: inherit;">This state of affairs leads to inevitable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conflicts</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A collision is a situation when, when adding different objects, we fall into the same cell in the array. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Two methods were invented to resolve collisions: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the chaining </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">method</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font><b><font style="vertical-align: inherit;">the open addressing method</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaining method</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The chaining method is the simplest method for resolving collisions. In the cell of the array we will not store the elements, but a linked list of these elements. Because adding to the top of the list (and it doesn’t matter to which part of the list to add an element) has the asymptotic behavior of O (1), we will not ruin the general asymptotic behavior, and it will remain equal to O (1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This implementation has a problem: if the lists grow very much (as a last resort, we can consider a hash function that returns a constant for any object), then we get the asymptotics O (m), where m is the number of elements in the set, if the size array is fixed. To avoid such troubles, the concept </font><b><font style="vertical-align: inherit;">of duty</font></b><font style="vertical-align: inherit;"> cycle is introduced.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(it can be equal, for example, 1.5). </font><font style="vertical-align: inherit;">If when adding an element it turns out that the fraction of the number of elements that are in the data structure relative to the size of the array exceeds the fill factor, then the following happens: a new array is selected whose size exceeds the size of the old array (for example, 2 times), and the data structure is rebuilt on the new array. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This method of resolving collisions is used in Java, and the data structure is called </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HashSet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open addressing method</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this method, the elements themselves are stored in the cells, and in the event of a collision, a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sequence of samples</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> occurs </font><font style="vertical-align: inherit;">, that is, we begin to sort through the cells using some algorithm in the hope of finding a free one. </font><font style="vertical-align: inherit;">This can be done by different algorithms ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linear / quadratic sequence of samples</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">double hashing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), each of which has its own problems (for example, the emergence of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primary</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secondary clusters</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From a hash set to a hash table (HashMap)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's create a data structure that allows you to add, delete, search for items, but by some key, as quickly as a hash set (that is, beyond O (1)). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will use the same data structure as the hash set, but we will not store elements, but pairs of elements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, the insertion (put (Key key, Value value)) will be carried out as follows: we will calculate the cell of the array by an object of type Key, we will get the number of bucket. Let's go through the list in the bucket, comparing the key with the key in stored pairs. If you find the same key - just squeeze out the old value, if you did not find it - add a pair.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How is an item received by key? </font><font style="vertical-align: inherit;">Yes, according to a similar principle: we get a bucket by key, go through the pairs and return the value in a pair, the key in which is equal to the key in the request, if there is such a pair, and null otherwise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This data structure is called a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hash table</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typical interview questions</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q: How are HashSet and HashMap arranged? </font><font style="vertical-align: inherit;">How are the main operations carried out in these collections? </font><font style="vertical-align: inherit;">How are equals () and hashCode () methods applied? </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Answers to these questions can be found above. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q: What is the contract for equals () and hashCode ()? </font><font style="vertical-align: inherit;">What is it due to? </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : If the objects are equal, then they must have hashCode equal. </font><font style="vertical-align: inherit;">Thus, hashCode must be determined by the ability of the fields involved in equals. </font><font style="vertical-align: inherit;">Violation of this contract can lead to very interesting effects. </font><font style="vertical-align: inherit;">If the objects are equal, but their hashCode is different, then you may not get the value corresponding to the key by which you just added the object to the HashSet or to the HashMap.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At interviews, they like to ask different cases related to these data structures. </font><font style="vertical-align: inherit;">Moreover, the decision of any of them can be deduced from understanding the principles of their work without any “cramming”.</font></font><br>
<br>
<hr><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That's all. </font><font style="vertical-align: inherit;">If you have read the material to the end, I invite </font><font style="vertical-align: inherit;">my colleague Evgeny Volosatov to show you </font><b><font style="vertical-align: inherit;">how to solve the olympiad problem using the ideas of dynamic programming</font></b><font style="vertical-align: inherit;"> for a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">free lesson</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on the topic “Secrets of Dynamic Programming” </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></b></i><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495018/index.html">Production and use of anticoronovirus lamp</a></li>
<li><a href="../en495022/index.html">Writing a complicated but interesting JavaScript slider</a></li>
<li><a href="../en495024/index.html">Smali cheat sheet in Russian</a></li>
<li><a href="../en495026/index.html">You are doing it wrong: calculating depth</a></li>
<li><a href="../en495030/index.html">How to memorize foreign words and phrases</a></li>
<li><a href="../en495036/index.html">A simple Telegram bot on Flask with weather reporting</a></li>
<li><a href="../en495038/index.html">Design at Confluence</a></li>
<li><a href="../en495042/index.html"># 01 - And a whole byte is not enough ... | What are intro?</a></li>
<li><a href="../en495058/index.html">Museria - a decentralized repository of music</a></li>
<li><a href="../en495066/index.html">Check Point Remote Access VPN - Free Remote Access Setup Course</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>