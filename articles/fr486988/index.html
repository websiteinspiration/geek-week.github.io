<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦃 👩‍🏫 ▫️ Station météo de poche 🎇 😋 👨🏾‍🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oui, la station météorologique concerne quelque chose qui mesure un grand nombre de paramètres, de la direction et de la force du vent au niveau du ra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Station météo de poche</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486988/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oui, la station météorologique concerne quelque chose qui mesure un grand nombre de paramètres, de la direction et de la force du vent au niveau du rayonnement solaire, mais il n'y avait pas de terme plus approprié, vous devez donc induire en erreur. </font><font style="vertical-align: inherit;">Mais à propos de la taille, tout est juste.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sb/vf/yl/sbvfylae2jg5ca22n6incvh0_le.jpeg"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appareil n'a peut-être pas beaucoup de valeur commerciale, car </font><font style="vertical-align: inherit;">même dans la quantité de composants, il est inférieur à de nombreux chinois, et pas seulement aux </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produits</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui ont des fonctionnalités similaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bricolage est également difficile à nommer en raison de la nécessité de commander des cartes de circuits imprimés avec un soudage ultérieur de petits composants / sans plomb, ce qui réduit considérablement le nombre de personnes qui souhaitent répéter l'appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La station météorologique elle-même a été créée comme quelque chose, je veux penser, esthétique, compact et capable d'évaluer rapidement la température + l'humidité autour, et une fois que le capteur sélectionné peut également parler de la pression, alors cela aussi. </font><font style="vertical-align: inherit;">Tout ressemble à quelque chose comme ça (cliquable):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/xy/6q/1n/xy6q1n0mungrju5uff3k_qznrhw.jpeg"></div></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/pa/ur/8t/paur8tgioddbzxqzwbkywgcr9pg.jpeg"></div><br>
</a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par rapport:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/on/6z/bi/on6zbi8c1riuymare1htfaoy3gy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À propos du fer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que capteur, le BOSCH-BME280 a été choisi, ce qui donne les paramètres environnementaux requis même selon I2C, même selon SPI, huit pieds dans un boîtier LGA sans plomb mesurant 2,5 x 2,5 mm - relativement peu coûteux, minuscule. Initialement, un capteur plus sophistiqué était prévu à partir de la même série BME680, qui, en plus de la température, de l'humidité et de la pression atmosphérique, selon la fiche technique, peut également évaluer la qualité de l'air par le soi-disant Index for Air Quality (IAQ). Cela semble bien, mais en fait, il s'est avéré que la QAI ne peut être obtenue qu'en utilisant BSEC: Bosch Software Environmental Cluster, qui, en fonction des lectures du capteur et de la modification de ces lectures, calcule la QAI. Il semblerait que vous puissiez prendre le témoignage vous-même et tout calculer; Pas certainement de cette façon. Sur demande pour mesurer la qualité de l'air, le capteur donne une résistance, en ohms.Il chauffe l'intérieur d'une petite zone sensible qui réagit avec conductivité à la présence de substances organiques volatiles - Composés Organiques Volatils (COV), et donne le résultat i.e. résistance à cette zone. Fondamentalement,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certains artisans</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proposent leurs propres algorithmes pour interpréter ces lectures sans BSEC, mais, entre autres, le coût multiple, par rapport au BME280, n'a laissé aucun choix.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xm/6f/ua/xm6fuaet6jexqzojp2ijibwk8yg.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'écran se compose de deux TOS-F2101, ce sont des indicateurs ordinaires à sept segments de couleur verte avec une cathode commune. </font><font style="vertical-align: inherit;">Parmi les notables, il s'agit de la taille et du boîtier pour un montage en surface, vous permettant de les placer de manière non conventionnelle. </font><font style="vertical-align: inherit;">Soit dit en passant, ce sont les plus petits indicateurs planaires qui ont été trouvés en vente, et ils déterminent, pour la plupart, la taille de l'ensemble de l'appareil.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/s2/ur/mvs2urkyspmxu99dx60ynxqs0ju.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gère tous les STM32F072 dans un boîtier QFPN à 48 broches. </font><font style="vertical-align: inherit;">Sélectionné, encore une fois, en fonction de la taille, de la disponibilité des périphériques et du nombre requis de conclusions pour contrôler les indicateurs qui, dans la version double, pour une raison quelconque, ne se produisent pas et les conclusions doivent être décentes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/1q/ph/dd1qph6m-u11ozvyb8nudzl1mf0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le reste est constitué de résistances, de condensateurs, d'un convertisseur de tension de 3,3 V, le moins - le mieux, dans des limites raisonnables et les composants TTX, bien sûr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le connecteur USB est fait sur la carte. Pour un contact fiable, l'épaisseur du PCB doit être d'environ 2 mm. Si vous êtes guidé par le dessin sur USB Type-A, alors il y en a un peu plus, mais si vous prenez en compte le masque des deux côtés, cela s'avère assez tolérable. Bien sûr, ce format du connecteur laisse plus de chances de dommages mécaniques à la prise USB, mais, dans l'ensemble, cela peut être traité en utilisant un lecteur flash ordinaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bouton tactile est un polygone rond sous l'image sur le tableau, le bouton répond à un toucher court et long. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de l'affichage, la carte dispose de trois LED qui indiquent laquelle des lectures est actuellement affichée sur l'indicateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quant au logiciel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le programme est écrit en utilisant CMSIS, la fréquence de fonctionnement est de 48 MHz et d'une source interne; il y en a un ici, vous pouvez même utiliser USB avec lui sans utiliser de quartz externe. Pour la flexibilité et, éventuellement, l'extension des fonctionnalités, FreeRTOS est ajouté.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bouton tactile est géré par le contrôleur tactile (TSC). Puisqu'il n'y a pas de clavier à partir des boutons tactiles sur la carte ou des curseurs, lorsque les touches tactiles sont combinées en ligne, et qu'il y a un capteur qui capture les touches courtes et longues, il n'y a aucun sens à utiliser la bibliothèque complète de ST. Le principe de fonctionnement du capteur capteur est simple, il y a plusieurs conclusions combinées en groupes, un condensateur (condensateur d'échantillonnage) Cs est connecté à l'un d'eux, cette conclusion devient exemplaire, les conclusions restantes du groupe peuvent être connectées aux polygones des capteurs, qui sont en fait également des condensateurs Cx . Le contrôleur charge la capacité du condensateur de décharge Cx puis cette charge distille dans le modèle Cs, l'opération est répétée jusqu'à une certaine limite de tension sur Cs. La capacité du capteur est généralement petite,par conséquent, de nombreuses opérations de ce type seront nécessaires et il existe un registre séparé (TSC_IOGxCR) pour le comptage. Si vous touchez le capteur, alors la capacité Cx deviendra plus grande et les cycles de charge Cs seront moins nécessaires, cela est immédiatement fixé et un contact est signalé vers le haut. Soit dit en passant, la capacité du capteur commence à augmenter lorsqu'il n'y a pas de contact direct, de sorte que le capteur peut être protégé du contact physique, par exemple avec un masque, ou vous pouvez enregistrer différents degrés d'approximation.ou fixer différents degrés d'approximation.ou fixer différents degrés d'approximation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour communiquer avec le BME280, l'interface I2C est utilisée. </font><font style="vertical-align: inherit;">L'implémentation d'I2C dans STM32F072 est plus simple que dans le STM32F103 populaire, entre autres, vous n'avez pas besoin de suivre séparément 1/2 / plusieurs octets reçus, il suffit de spécifier leur nombre à l'avance (I2C_CR2.NBYTES [7: 0]). </font><font style="vertical-align: inherit;">La même bibliothèque pour travailler avec le capteur est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fournie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et recommandée par le fabricant du capteur. </font><font style="vertical-align: inherit;">Afin de lire les lectures à l'aide de la bibliothèque, vous devez créer deux structures - pour les paramètres et les données. </font><font style="vertical-align: inherit;">Dans les paramètres que vous devez effectuer:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adresse du capteur sur le bus I2C</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions de lecture / écriture I2C ainsi que la fonction de retard</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nombre de lectures d'indications de moyennage (suréchantillonnage) x1, x2, etc., pour chacun des paramètres température / humidité / pression</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coefficient de filtrage pour ADC</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">période de suppression des valeurs des paramètres</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en général, lequel des paramètres peut être lu, par exemple, vous pouvez laisser une température</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode de fonctionnement, "normal" - avec relevés périodiques, "forcé" - relevé sur demande</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, si le mode «normal» est sélectionné, alors les valeurs réelles des lectures peuvent être obtenues en exécutant la fonction «bme280_get_sensor_data», il va regarder les registres de capteurs correspondants, lire les lectures directes, puis les traiter conformément aux facteurs de correction enregistrés dans le microcircuit en usine. </font><font style="vertical-align: inherit;">Par conséquent, la structure des données de sortie contiendra la température en degrés Celsius, l'humidité relative en pourcentage, la pression atmosphérique en pascals. </font><font style="vertical-align: inherit;">En mode "forcé", la même chose, seulement à chaque fois avant de lire les lectures, vous devez exécuter la conversion "bme280_set_sensor_mode".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le principe général de l'appareil est le suivant: se connecter en USB, ou à Power Bank dans une version mobile. Pour l'affichage initial et la commutation des lectures - une touche courte du capteur, pour désactiver - une touche longue. Tout d'abord, la température en degrés Celsius est affichée, puis l'humidité relative en pourcentage et la pression atmosphérique en millimètres de mercure, car il n'y a que deux indicateurs, et l'indicateur de pression dépasse rarement sept cents, alors le nombre sept est virtuel ici. Si vous ne touchez pas le capteur pendant un certain temps, les voyants s'éteignent pour que, par exemple, vous ne déchargiez pas le Power Bank. La consommation moyenne de l'appareil est de ~ 50 mA, et les principaux consommateurs ne sont que des indicateurs.Si vous les éteignez, le décompte va aux microampères.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/os/yc/m4/osycm4d_nxftmdscyosimsmxyqu.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9g/of/6q/9gof6qylzgjq2zeba4rkgumqvze.jpeg"></div><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/n91MdTEM7X4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, le coût total des composants en janvier 2020 s'est avéré être d'environ 850 roubles, c'est sans tenir compte de la carte, c'est devenu facile, car </font><font style="vertical-align: inherit;">le fabricant avait des remises du Nouvel An, et j'ai des coupons, mais cela ne se reproduira probablement pas dans un avenir proche, au moins jusqu'en décembre prochain. </font><font style="vertical-align: inherit;">Eh bien, ceux qui veulent se familiariser avec la source peuvent le faire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr486988/">https://habr.com/ru/post/fr486988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr486976/index.html">Problèmes de l'enseignement de l'information en russe et leurs solutions possibles</a></li>
<li><a href="../fr486978/index.html">Notes de terrain: l'une des plus grandes conférences OpenSource FOSDEM 2020</a></li>
<li><a href="../fr486980/index.html">Kim Dotcom: Caught, la personne la plus recherchée en ligne. Partie 1</a></li>
<li><a href="../fr486982/index.html">Comment apprendre le développement frontal, trouver son premier emploi et ne pas se faire de soucis</a></li>
<li><a href="../fr486984/index.html">Passerelle Python sur InterSystems IRIS</a></li>
<li><a href="../fr486994/index.html">Angulaire: test d'intégration (test peu profond)</a></li>
<li><a href="../fr486998/index.html">Impression d'imprimante thermique chèque pas cher et rapide</a></li>
<li><a href="../fr487000/index.html">Agrumes: ensemble de styles pour AvaloniaUI</a></li>
<li><a href="../fr487002/index.html">Marketing en réalité augmentée: qu'est-ce que c'est et comment ça marche</a></li>
<li><a href="../fr487004/index.html">Pourquoi de plus en plus d'États américains renvoient la neutralité du réseau - discuter du cours des événements</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>