<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶É üë©‚Äçüè´ ‚ñ´Ô∏è Station m√©t√©o de poche üéá üòã üë®üèæ‚Äçüî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oui, la station m√©t√©orologique concerne quelque chose qui mesure un grand nombre de param√®tres, de la direction et de la force du vent au niveau du ra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Station m√©t√©o de poche</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486988/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oui, la station m√©t√©orologique concerne quelque chose qui mesure un grand nombre de param√®tres, de la direction et de la force du vent au niveau du rayonnement solaire, mais il n'y avait pas de terme plus appropri√©, vous devez donc induire en erreur. </font><font style="vertical-align: inherit;">Mais √† propos de la taille, tout est juste.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sb/vf/yl/sbvfylae2jg5ca22n6incvh0_le.jpeg"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appareil n'a peut-√™tre pas beaucoup de valeur commerciale, car </font><font style="vertical-align: inherit;">m√™me dans la quantit√© de composants, il est inf√©rieur √† de nombreux chinois, et pas seulement aux </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produits</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui ont des fonctionnalit√©s similaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bricolage est √©galement difficile √† nommer en raison de la n√©cessit√© de commander des cartes de circuits imprim√©s avec un soudage ult√©rieur de petits composants / sans plomb, ce qui r√©duit consid√©rablement le nombre de personnes qui souhaitent r√©p√©ter l'appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La station m√©t√©orologique elle-m√™me a √©t√© cr√©√©e comme quelque chose, je veux penser, esth√©tique, compact et capable d'√©valuer rapidement la temp√©rature + l'humidit√© autour, et une fois que le capteur s√©lectionn√© peut √©galement parler de la pression, alors cela aussi. </font><font style="vertical-align: inherit;">Tout ressemble √† quelque chose comme √ßa (cliquable):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/xy/6q/1n/xy6q1n0mungrju5uff3k_qznrhw.jpeg"></div></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/pa/ur/8t/paur8tgioddbzxqzwbkywgcr9pg.jpeg"></div><br>
</a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par rapport:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/on/6z/bi/on6zbi8c1riuymare1htfaoy3gy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä propos du fer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que capteur, le BOSCH-BME280 a √©t√© choisi, ce qui donne les param√®tres environnementaux requis m√™me selon I2C, m√™me selon SPI, huit pieds dans un bo√Ætier LGA sans plomb mesurant 2,5 x 2,5 mm - relativement peu co√ªteux, minuscule. Initialement, un capteur plus sophistiqu√© √©tait pr√©vu √† partir de la m√™me s√©rie BME680, qui, en plus de la temp√©rature, de l'humidit√© et de la pression atmosph√©rique, selon la fiche technique, peut √©galement √©valuer la qualit√© de l'air par le soi-disant Index for Air Quality (IAQ). Cela semble bien, mais en fait, il s'est av√©r√© que la QAI ne peut √™tre obtenue qu'en utilisant BSEC: Bosch Software Environmental Cluster, qui, en fonction des lectures du capteur et de la modification de ces lectures, calcule la QAI. Il semblerait que vous puissiez prendre le t√©moignage vous-m√™me et tout calculer; Pas certainement de cette fa√ßon. Sur demande pour mesurer la qualit√© de l'air, le capteur donne une r√©sistance, en ohms.Il chauffe l'int√©rieur d'une petite zone sensible qui r√©agit avec conductivit√© √† la pr√©sence de substances organiques volatiles - Compos√©s Organiques Volatils (COV), et donne le r√©sultat i.e. r√©sistance √† cette zone. Fondamentalement,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certains artisans</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proposent leurs propres algorithmes pour interpr√©ter ces lectures sans BSEC, mais, entre autres, le co√ªt multiple, par rapport au BME280, n'a laiss√© aucun choix.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xm/6f/ua/xm6fuaet6jexqzojp2ijibwk8yg.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©cran se compose de deux TOS-F2101, ce sont des indicateurs ordinaires √† sept segments de couleur verte avec une cathode commune. </font><font style="vertical-align: inherit;">Parmi les notables, il s'agit de la taille et du bo√Ætier pour un montage en surface, vous permettant de les placer de mani√®re non conventionnelle. </font><font style="vertical-align: inherit;">Soit dit en passant, ce sont les plus petits indicateurs planaires qui ont √©t√© trouv√©s en vente, et ils d√©terminent, pour la plupart, la taille de l'ensemble de l'appareil.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/s2/ur/mvs2urkyspmxu99dx60ynxqs0ju.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
G√®re tous les STM32F072 dans un bo√Ætier QFPN √† 48 broches. </font><font style="vertical-align: inherit;">S√©lectionn√©, encore une fois, en fonction de la taille, de la disponibilit√© des p√©riph√©riques et du nombre requis de conclusions pour contr√¥ler les indicateurs qui, dans la version double, pour une raison quelconque, ne se produisent pas et les conclusions doivent √™tre d√©centes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/1q/ph/dd1qph6m-u11ozvyb8nudzl1mf0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le reste est constitu√© de r√©sistances, de condensateurs, d'un convertisseur de tension de 3,3 V, le moins - le mieux, dans des limites raisonnables et les composants TTX, bien s√ªr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le connecteur USB est fait sur la carte. Pour un contact fiable, l'√©paisseur du PCB doit √™tre d'environ 2 mm. Si vous √™tes guid√© par le dessin sur USB Type-A, alors il y en a un peu plus, mais si vous prenez en compte le masque des deux c√¥t√©s, cela s'av√®re assez tol√©rable. Bien s√ªr, ce format du connecteur laisse plus de chances de dommages m√©caniques √† la prise USB, mais, dans l'ensemble, cela peut √™tre trait√© en utilisant un lecteur flash ordinaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bouton tactile est un polygone rond sous l'image sur le tableau, le bouton r√©pond √† un toucher court et long. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de l'affichage, la carte dispose de trois LED qui indiquent laquelle des lectures est actuellement affich√©e sur l'indicateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quant au logiciel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le programme est √©crit en utilisant CMSIS, la fr√©quence de fonctionnement est de 48 MHz et d'une source interne; il y en a un ici, vous pouvez m√™me utiliser USB avec lui sans utiliser de quartz externe. Pour la flexibilit√© et, √©ventuellement, l'extension des fonctionnalit√©s, FreeRTOS est ajout√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bouton tactile est g√©r√© par le contr√¥leur tactile (TSC). Puisqu'il n'y a pas de clavier √† partir des boutons tactiles sur la carte ou des curseurs, lorsque les touches tactiles sont combin√©es en ligne, et qu'il y a un capteur qui capture les touches courtes et longues, il n'y a aucun sens √† utiliser la biblioth√®que compl√®te de ST. Le principe de fonctionnement du capteur capteur est simple, il y a plusieurs conclusions combin√©es en groupes, un condensateur (condensateur d'√©chantillonnage) Cs est connect√© √† l'un d'eux, cette conclusion devient exemplaire, les conclusions restantes du groupe peuvent √™tre connect√©es aux polygones des capteurs, qui sont en fait √©galement des condensateurs Cx . Le contr√¥leur charge la capacit√© du condensateur de d√©charge Cx puis cette charge distille dans le mod√®le Cs, l'op√©ration est r√©p√©t√©e jusqu'√† une certaine limite de tension sur Cs. La capacit√© du capteur est g√©n√©ralement petite,par cons√©quent, de nombreuses op√©rations de ce type seront n√©cessaires et il existe un registre s√©par√© (TSC_IOGxCR) pour le comptage. Si vous touchez le capteur, alors la capacit√© Cx deviendra plus grande et les cycles de charge Cs seront moins n√©cessaires, cela est imm√©diatement fix√© et un contact est signal√© vers le haut. Soit dit en passant, la capacit√© du capteur commence √† augmenter lorsqu'il n'y a pas de contact direct, de sorte que le capteur peut √™tre prot√©g√© du contact physique, par exemple avec un masque, ou vous pouvez enregistrer diff√©rents degr√©s d'approximation.ou fixer diff√©rents degr√©s d'approximation.ou fixer diff√©rents degr√©s d'approximation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour communiquer avec le BME280, l'interface I2C est utilis√©e. </font><font style="vertical-align: inherit;">L'impl√©mentation d'I2C dans STM32F072 est plus simple que dans le STM32F103 populaire, entre autres, vous n'avez pas besoin de suivre s√©par√©ment 1/2 / plusieurs octets re√ßus, il suffit de sp√©cifier leur nombre √† l'avance (I2C_CR2.NBYTES [7: 0]). </font><font style="vertical-align: inherit;">La m√™me biblioth√®que pour travailler avec le capteur est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fournie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et recommand√©e par le fabricant du capteur. </font><font style="vertical-align: inherit;">Afin de lire les lectures √† l'aide de la biblioth√®que, vous devez cr√©er deux structures - pour les param√®tres et les donn√©es. </font><font style="vertical-align: inherit;">Dans les param√®tres que vous devez effectuer:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adresse du capteur sur le bus I2C</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions de lecture / √©criture I2C ainsi que la fonction de retard</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nombre de lectures d'indications de moyennage (sur√©chantillonnage) x1, x2, etc., pour chacun des param√®tres temp√©rature / humidit√© / pression</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coefficient de filtrage pour ADC</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√©riode de suppression des valeurs des param√®tres</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en g√©n√©ral, lequel des param√®tres peut √™tre lu, par exemple, vous pouvez laisser une temp√©rature</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode de fonctionnement, "normal" - avec relev√©s p√©riodiques, "forc√©" - relev√© sur demande</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, si le mode ¬´normal¬ª est s√©lectionn√©, alors les valeurs r√©elles des lectures peuvent √™tre obtenues en ex√©cutant la fonction ¬´bme280_get_sensor_data¬ª, il va regarder les registres de capteurs correspondants, lire les lectures directes, puis les traiter conform√©ment aux facteurs de correction enregistr√©s dans le microcircuit en usine. </font><font style="vertical-align: inherit;">Par cons√©quent, la structure des donn√©es de sortie contiendra la temp√©rature en degr√©s Celsius, l'humidit√© relative en pourcentage, la pression atmosph√©rique en pascals. </font><font style="vertical-align: inherit;">En mode "forc√©", la m√™me chose, seulement √† chaque fois avant de lire les lectures, vous devez ex√©cuter la conversion "bme280_set_sensor_mode".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le principe g√©n√©ral de l'appareil est le suivant: se connecter en USB, ou √† Power Bank dans une version mobile. Pour l'affichage initial et la commutation des lectures - une touche courte du capteur, pour d√©sactiver - une touche longue. Tout d'abord, la temp√©rature en degr√©s Celsius est affich√©e, puis l'humidit√© relative en pourcentage et la pression atmosph√©rique en millim√®tres de mercure, car il n'y a que deux indicateurs, et l'indicateur de pression d√©passe rarement sept cents, alors le nombre sept est virtuel ici. Si vous ne touchez pas le capteur pendant un certain temps, les voyants s'√©teignent pour que, par exemple, vous ne d√©chargiez pas le Power Bank. La consommation moyenne de l'appareil est de ~ 50 mA, et les principaux consommateurs ne sont que des indicateurs.Si vous les √©teignez, le d√©compte va aux microamp√®res.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/os/yc/m4/osycm4d_nxftmdscyosimsmxyqu.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9g/of/6q/9gof6qylzgjq2zeba4rkgumqvze.jpeg"></div><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/n91MdTEM7X4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, le co√ªt total des composants en janvier 2020 s'est av√©r√© √™tre d'environ 850 roubles, c'est sans tenir compte de la carte, c'est devenu facile, car </font><font style="vertical-align: inherit;">le fabricant avait des remises du Nouvel An, et j'ai des coupons, mais cela ne se reproduira probablement pas dans un avenir proche, au moins jusqu'en d√©cembre prochain. </font><font style="vertical-align: inherit;">Eh bien, ceux qui veulent se familiariser avec la source peuvent le faire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr486988/">https://habr.com/ru/post/fr486988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr486976/index.html">Probl√®mes de l'enseignement de l'information en russe et leurs solutions possibles</a></li>
<li><a href="../fr486978/index.html">Notes de terrain: l'une des plus grandes conf√©rences OpenSource FOSDEM 2020</a></li>
<li><a href="../fr486980/index.html">Kim Dotcom: Caught, la personne la plus recherch√©e en ligne. Partie 1</a></li>
<li><a href="../fr486982/index.html">Comment apprendre le d√©veloppement frontal, trouver son premier emploi et ne pas se faire de soucis</a></li>
<li><a href="../fr486984/index.html">Passerelle Python sur InterSystems IRIS</a></li>
<li><a href="../fr486994/index.html">Angulaire: test d'int√©gration (test peu profond)</a></li>
<li><a href="../fr486998/index.html">Impression d'imprimante thermique ch√®que pas cher et rapide</a></li>
<li><a href="../fr487000/index.html">Agrumes: ensemble de styles pour AvaloniaUI</a></li>
<li><a href="../fr487002/index.html">Marketing en r√©alit√© augment√©e: qu'est-ce que c'est et comment √ßa marche</a></li>
<li><a href="../fr487004/index.html">Pourquoi de plus en plus d'√âtats am√©ricains renvoient la neutralit√© du r√©seau - discuter du cours des √©v√©nements</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>