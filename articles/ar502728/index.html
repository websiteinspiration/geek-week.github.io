<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👠 🎤 🐼 حيل مثيرة للاهتمام وحيل SSH 🔭 ✔️ 🤗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="بعض النصائح حول استخدام SSH بكفاءة. لنتحدث عن كيفية:
 
 

- استخدم المصادقة ذات العاملين لاتصالات SSH
- من الآمن استخدام "إعادة توجيه المفاتيح" (إعادة...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>حيل مثيرة للاهتمام وحيل SSH</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502728/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بعض النصائح حول استخدام SSH بكفاءة. </font><font style="vertical-align: inherit;">لنتحدث عن كيفية:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">استخدم المصادقة ذات العاملين لاتصالات SSH</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">من الآمن استخدام "إعادة توجيه المفاتيح" (إعادة توجيه الوكيل) ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الخروج من جلسة SSH المعلقة ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ترك المحطة مفتوحة عند الخروج أو قطع الاتصال ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">شارك المحطة الطرفية البعيدة مع صديق (بدون Zoom!).</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/ib/ip/2b/ibip2baduhanlunu57eepm5ff3w.jpeg" alt="صورة"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مصادقة SSH متعددة العوامل</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك خمس طرق لإضافة عامل ثانٍ للمصادقة في SSH:</font></font><br>
<br>
<ol>
<li> <b> OpenSSH</b>     ( ). <br>
<br>
  2020   OpenSSH    FIDO U2F (Universal Second Factor).    ,   .<br>
<br>
          ,             8.2   .       <b><code>ssh -V</code></b>,      <b><code>nc [servername] 22</code></b>.<br>
<br>
       — <b><code>ecdsa-sk</code></b>  <b><code>ed25519-sk</code></b> (   ).             <b><code>$ ssh-keygen -t ecdsa-sk -f ~/.ssh/id_ecdsa_sk</code></b>.       ,    U2F .    U2F       ,   .<br>
<br>
          . OpenSSH        -sk-«» .        U2F .  ,       .      <b><code>$ ssh-keygen -t ecdsa-sk -O resident -f ~/.ssh/id_ecdsa_sk</code></b>.       ,        <b><code> $ ssh-add -K</code></b>.       .</li>
<li> <b> PIV+PKCS11  Yubikey.</b>      ,      SSH-,      .  Yubikey  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"> U2F+SSH with PIV/PKCS11</a>.     ,     FIDO U2F.   ,  .</li>
<li> <b> ssh- <code>yubikey-agent.</code></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Filippo Valsorda</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">SSH-  Yubikeys</a>.         .</li>
<li> <b> Touch ID  <code>sekey</code>.</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Sekey</a> —  SSH-    ,       secure enclave  MacOS       Touch ID.</li>
<li> <b> Single Sign On SSH.</b>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"></a>  .  Single Sign On SSH   ,          ,    .</li>
</ol><br>
<br>
<h2>    (agent forwarding)</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إعادة توجيه مفتاح في SSH يمنح المضيف البعيد وصولاً إلى وكيل SSH المحلي. عندما يستخدم عميل SSH إعادة توجيه المفاتيح (يتم تنشيطه عادةً بواسطة الخيار </font></font><b><code>ssh -A</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ، هناك قناتان في الاتصال - جلسة تفاعلية وقناة إعادة توجيه المفتاح. يقوم وكيل SSH المحلي بإنشاء مأخذ توصيل IPC يتصل بالمضيف البعيد من خلال هذه القناة. هذا أمر خطير لأنه مستخدم لديه امتيازات الجذر على مضيف بعيد لديه حق الوصول إلى وكيل SSH المحلي الخاص بك ويمكن أن يستخدمه للوصول إلى موارد الشبكة نيابة عنك. مع وكيل SSH القياسي الذي يأتي مع OpenSSH ، لن تعرف أبدًا ما حدث. ولكن إذا كنت تستخدم مفتاح U2F (أو </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ، فيمكنك إيقاف أي محاولات لاستخدام وكيل SSH الخاص بك.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حتى مع هذا القيد ، فإن الاستخدام الدوري لإعادة توجيه المفاتيح مقبول تمامًا. </font><font style="vertical-align: inherit;">لا تستخدم هذه الطريقة لجميع اتصالاتك. </font><font style="vertical-align: inherit;">استخدمه فقط إذا كنت متأكدًا من حاجته في حالات معينة.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الخروج من جلسة SSH المعلقة</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
غالبًا ما تتجمد جلسات SSH بسبب انقطاع الشبكة ، أو فقدان التحكم من خلال برنامج التشغيل أو أحد تتابعات التحكم الطرفية التي تمنع إدخال لوحة المفاتيح. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إليك بعض الطرق للخروج من جلسة معلقة:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">خروج تلقائي عند انقطاع الشبكة. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">في تكوين SSH الخاص بك ، </font></font><code><b>.ssh/config</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تحتاج إلى إضافة: </font><font style="vertical-align: inherit;">سيتحقق من الاتصال عن طريق إرسال طلبات الصدى إلى المضيف البعيد كل </font><font style="vertical-align: inherit;">ثانية. </font><font style="vertical-align: inherit;">إذا </font><font style="vertical-align: inherit;">لم يتم الرد على </font><font style="vertical-align: inherit;">أكثر من </font><font style="vertical-align: inherit;">هذه الطلبات ، فسيغلق SSH الاتصال.</font></font><br>
<br>
<code><b>ServerAliveInterval 5<br>
ServerAliveCountMax 1<br>
</b></code><br>
<br>
<code><b>ssh</b></code><font style="vertical-align: inherit;"></font><code><b>ServerAliveInterval</b></code><font style="vertical-align: inherit;"></font><code><b>ServerAliveCountMax</b></code><font style="vertical-align: inherit;"></font></li>
<li><b> .</b> <code><b>ssh</b></code>   <code><b>~</b></code>     .  <code><b>~.</b></code>        (       ).<br>
<br>
 <code><b>~?</b></code>   ,      .       ,      <code><b>~</b></code> ,    .</li>
</ol><br>
<b>  ?</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">عندما تم اختراع الإنترنت ، لم تكن أجهزة الكمبيوتر المحمولة بشكل خاص. عند العمل على كمبيوتر محمول والتبديل بين شبكات WiFi IPv4 ، يتغير عنوان IP الخاص بك. نظرًا لأن SSH يعتمد على اتصال TCP ، وتعتمد اتصالات TCP على نقاط الاتصال ذات عناوين IP الثابتة ، في كل مرة تتصل فيها بشبكة أخرى ، يتم فقد اتصال SSH الخاص بك. عندما يتغير عنوان IP الخاص بك ، يستغرق الأمر بعض الوقت قبل أن يكتشف مكدس الشبكة فقدان الاتصال. لا يعني اتصال TCP إيقافًا سريعًا لأحد الأطراف في حالة حدوث مشاكل في الشبكة ، لذا سيحاول إعادة محاولة إرسال البيانات لبعض الوقت. في محطتك ، ستبدو الجلسة عالقة. يضيف IPv6 وظائف تسمح للأجهزة بالحفاظ على عنوان IP الخاص بها عند التبديل بين الشبكات.لذا في يوم من الأيام ، سيتوقف هذا عن كونه مشكلة.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كيفية ترك محطة طرفية مفتوحة على مضيف بعيد</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك خياران لحفظ جلسة عند التبديل بين الشبكات أو عندما تريد قطع الاتصال لبعض الوقت:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">استخدم </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أو </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المحطة الأبدية</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">إذا كنت حقًا بحاجة إلى اتصال </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لا يتعطل</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، حتى إذا قمت بالتبديل بين الشبكات ، فاستخدم shell Mosh - mobile. </font><font style="vertical-align: inherit;">Mosh هو غلاف آمن يستخدم SSH لتهيئة جلسة (مصافحة) ، وبعد ذلك يتحول إلى قناته المشفرة الخاصة به. </font><font style="vertical-align: inherit;">هذه القناة مستقرة للغاية. </font><font style="vertical-align: inherit;">يمكنه التعامل مع المواقف المختلفة ، بما في ذلك قطع الاتصال من الإنترنت ، وتغيير عنوان IP لجهاز الكمبيوتر المحمول ، والتأخير الكبير عند الإرسال عبر الشبكة ، وغيرها. </font><font style="vertical-align: inherit;">بفضل سحر UDP وبروتوكول المزامنة المستخدم من قبل Mosh.</font></font><br>
<br>
  Mosh       ,          60000–61000   UDP     .     mosh user@server  .<br>
<br>
Mosh        ,          SSH,      -    .          ,        . SSH        ,  ,  Mosh             .</li>
<li><b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">tmux</a>.</b>      ,           ,    tmux.   SSH- ,      <code><b>tmux attach</b></code>,     <code><b>tmux</b></code>.        —    ,      macOS       .<br>
<br>
  tmux   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Byobu</a> — ,        . Byobu    Ubuntu      macOS    Homebrew.</li>
</ol><br>
<br>
<h2>     </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عندما تحل مشكلة معقدة مع الخوادم ، أود أن أشارك جلسة SSH مع شخص آخر موجود في مكان آخر. </font><font style="vertical-align: inherit;">tmux هو أفضل أداة مشاركة طرفية. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، عليك القيام بما يلي:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تأكد من </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تثبيته على خادمك في DMZ (أو في المكان الذي تريد الاتصال به).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يحتاج كل منكما إلى الاتصال بالخادم عبر SSH </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">باستخدام نفس الحساب</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يجب أن يعمل أحدكم </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لإنشاء </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">جلسة.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يجب على شخص آخر تنفيذ الأمر </font></font><code><b>tmux attach</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هاهو! </font><font style="vertical-align: inherit;">لقد شاركت المحطة.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إذا كنت بحاجة إلى مزيد من الضبط الدقيق لجلسات المستخدمين المتعددين ، فاستخدم tmate ، هذه الشوكة </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، التي تتيح لك جعل الجلسات المشتركة أسهل. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ترجمه أندريه زينشينكو ، رئيس قسم تحليلات ريكسوفت</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar502716/index.html">لا يمكنك مشاركة جهاز الكمبيوتر الخاص بك في المنزل؟ اصنع واحدة من اثنتين</a></li>
<li><a href="../ar502718/index.html">مشروع Talking Head ، أو تاريخ تطوير برنامج لروبوت التواجد عن بعد</a></li>
<li><a href="../ar502720/index.html">اتجاهات الاختبار للنظر إليها في عام 2020</a></li>
<li><a href="../ar502722/index.html">وادي السيليكون باللغة الروسية. كيف يعمل # ITX5 في Innopolis</a></li>
<li><a href="../ar502726/index.html">WebRTC عمل تطبيق باستخدام البلاك جاك ومكالمات الفيديو</a></li>
<li><a href="../ar502730/index.html">ما الذي يعرفه المصممون الصناعيون عن الأجهزة التي تستخدمها كل يوم. أو 50 عامًا من تحويل فأرة الكمبيوتر</a></li>
<li><a href="../ar502732/index.html">كتاب "كيفية الاختبار على Google" - نسخة إلكترونية مجانية</a></li>
<li><a href="../ar502734/index.html">Ack grep أفضل</a></li>
<li><a href="../ar502740/index.html">كيفية تطهير الطائرات في عصر الكوفيد 19؟</a></li>
<li><a href="../ar502742/index.html">ندعوك إلى DINS DevOps EVENING (عبر الإنترنت): تطور Prometheus و Zabbix ومعالجة سجلات Nginx في ClickHouse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>