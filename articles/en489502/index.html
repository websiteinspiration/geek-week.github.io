<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐇 🚴🏼 👴🏾 Selenium + AutoIT. Windows Test Automation Windows 😽 🔅 👩🏼‍✈️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My name is Ivan Sidorenko, I am a testing engineer at Digital Design. 
 
 My task was to develop auto-tests for one of our projects using the Selenium...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Selenium + AutoIT. Windows Test Automation Windows</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/489502/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My name is Ivan Sidorenko, I am a testing engineer at Digital Design. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My task was to develop auto-tests for one of our projects using the Selenium WebDriver tool in Java. You can read more about this in my last </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selenium</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a tool for automating web applications in various browsers. During the development of auto-tests, I came across a scenario in which you need to interact with the Windows window to download files. Unfortunately, Selenium is not able to work with Windows windows, so an alternative solution had to be found.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cd/zl/d4/cdzld4whe4et6m2j_xhh47dl-6g.png"></div><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the search, the choice fell on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoIT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This tool is designed to automate tasks in Microsoft Windows, which was necessary. In this article, I will describe working with AutoIT to solve a task. It is assumed that you already have a development environment with Selenium WebDriver connected. As an example, a window for uploading photos to one of the photo editing sites will be used. So let's get started. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and install AutoIT </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Go to one of the services for downloading photos, for example, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here you need to click the "Download Photos" button to get such a Windows window </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8d/td/ff/8dtdff77nmvci12qingkdozlmuq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Now go to the AutoIT3 folder and select Au3Info.exe</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xw/zt/a8/xwzta8im-wldwys3d4kukksyfx4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Au3Info is a tool that allows you to get information about the required window for automation. To get information about a specific element, simply drag from the Finder Tool block onto the window element. We will get the values ​​of the input field attributes of the “File Name” element. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9p/rr/yl/9prryludo95c5_qeehpmqehltac.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For use in the AutoIT script, we need the attributes Title = 'Open' and Class = 'Edit' </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Go to the AutoIt3 \ SciTE folder and select SciTE, here we will write such a simple script </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ce/a_/e-/cea_e-yqn5uroh9gfadffplsnxe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlFocus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a method , which sets focus on the window element “File Name” </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - The first parameter is the Title value of the desired window, in our case it is 'Open' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - The second parameter is optional</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - The third parameter is the combination of the values ​​of the attribute Class and Instance, i.e. </font><font style="vertical-align: inherit;">it turns out Edit1 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hp/db/bn/hpdbbnufdzq_j0h9w2uhsyuc3xq.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlSetText</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a method by which text is entered into the input of the element "File Name"</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first parameter is the value of Title</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second parameter is optional</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The third parameter is the combination of the values ​​of the Class and Instance attribute, i.e. </font><font style="vertical-align: inherit;">it turns out Edit1</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The fourth parameter is the text that will be entered in input, here we write the path to the file that we will attach</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlClick</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - clicks the "Open" button</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first parameter is the value of Title</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second parameter is optional</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The third parameter is the combination of the values ​​of the Class and Instance attribute, i.e. </font><font style="vertical-align: inherit;">it turns Button1</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/mh/ky/n9/mhkyn9hzowkdemfo0-mxtayc-qu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. Save the script as Autoit </font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/k-/yf/bek-yfclqoutktdksfwsmbn66bq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. Now, to run the script, you need to compile it. To compile a script, there are two options - either for a 64-bit system, or for 86. Choose the appropriate one for your operating system. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nk/ce/7z/nkce7zytnqeugrvb2zdd4-wcceq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8. We got a compiled AutoItScript.exe file. We’ll check its performance - go to the &lt; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.iloveimg.com/en/photo-editor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "&gt; photo editing service and click on" Select Image. Now run AutoItScript.exe </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ea/nw/ef/eanwefram2fb9xsmiqrlmfrjl94.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
9. Now you can add this script in Selenium, for example, for Java, such an addition would look like this:</font></font><br>
<br>
<pre><code class="plaintext hljs">Runtime.getRuntime().exec(":\\auto\\AutoItScript.exe");</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This solution is highly stable. </font><font style="vertical-align: inherit;">Also, due to the fact that we end up with an executable file, this solution can be used with different programming languages. </font><font style="vertical-align: inherit;">The disadvantage is that such a script cannot be used in the headless mode - a mode in which the browser does not start. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope this article helps you in testing automation!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en489490/index.html">Tic Tac Toe (PixiJS)</a></li>
<li><a href="../en489492/index.html">Яндекс.Диск запретил использование open source утилиты rclone. UPD — снова работает</a></li>
<li><a href="../en489494/index.html">Most popular data structures</a></li>
<li><a href="../en489496/index.html">Search for employees and job search: my view from inside and outside</a></li>
<li><a href="../en489500/index.html">Assessing Tasks at Story Points</a></li>
<li><a href="../en489504/index.html">How to start creating a map in UE4</a></li>
<li><a href="../en489510/index.html">Trying to solve the problem of choosing tickets before vacation # 2</a></li>
<li><a href="../en489512/index.html">Flutter. BlOC, Provider, async - Shelf Architecture</a></li>
<li><a href="../en489514/index.html">Download and store files of any size on Google Drive for free. Bug or feature?</a></li>
<li><a href="../en489516/index.html">Friends React Native and Fastlane</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>