<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🚀 🎋 🤘🏾 統合された画像を使用したO（1）の質量中心の計算 🤱🏻 👨🏽‍🚒 🐉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="統合された画像は、多次元配列の長方形のサブセットに囲まれた値の合計を効率的に計算できるアルゴリズムです。彼のまさにそのアイデアは多次元確率分布関数の研究にさかのぼります、そして今まで彼は主要なツールキットとして直接確率理論を使用するそれらの分野で成功したアプリケーションを見つけました。たとえば、パタ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>統合された画像を使用したO（1）の質量中心の計算</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/493300/"><img src="https://habrastorage.org/webt/jz/zu/un/jzzuunk1lhxykcm7wzw8abqoaek.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合された画像は、多次元配列の長方形のサブセットに囲まれた値の合計を効率的に計算できるアルゴリズムです。</font><font style="vertical-align: inherit;">彼のまさにそのアイデアは多次元確率分布関数の研究にさかのぼります、そして今まで彼は主要なツールキットとして直接確率理論を使用するそれらの分野で成功したアプリケーションを見つけました。</font><font style="vertical-align: inherit;">たとえば、パターン認識。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日は、根本的に異なる分野である計算物理学に統合された画像をどのように適用するかという興味深い事例を検討します。</font><font style="vertical-align: inherit;">つまり、パルス場の重心を一緒に計算するとどうなるか、そしてこの共生からどのような利益が得られるかを見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、次のように説明します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この問題はどのようなものですか。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合されたイメージの詳細をご覧ください。</font></font></li>
<li>         N       (-);</li>
<li>        ;</li>
<li>, ,          .</li>
</ul><a name="habracut"></a><br>
<h2>  N </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N体のシステムの重力相互作用に対する厳密な解は、2次の複雑さを持つアルゴリズムを指します。システム内の他のすべての物体は、各物体に重力の影響を及ぼします</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。したがって、Nの各々について算出する重力相互作用必要の力</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /2対。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
厳密なソリューションにどれだけ時間がかかるかを示すために、実際のシステムの計算の複雑さを最新のコンピューターのパフォーマンスと相関させることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3次元空間で2つの物体間の重力を計算するには、浮動小数点（FLOP）で20の操作を実行する必要があります。太陽系には、200キロメートルを超える天体が約100個あります（太陽、9つの惑星、準惑星、衛星を含む）</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2]。</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。地球近くの軌道にある小惑星のおおよその数は約2万</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。小惑星帯では、1.1から1キロを超える190万体にある</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[4]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と約100万個と同様の「トロイの木馬」にある小惑星</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[5]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と木星の「ギリシャ」のグループ。カイパーベルトでは、20 kmを超える約1億個のオブジェクト</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[6]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と約2兆個以上の</font><font style="vertical-align: inherit;">オブジェクト</font><font style="vertical-align: inherit;">がオールト雲の中にあります</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[7]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zp/yx/dq/zpyxdqsshts30cbhyethrg6l1nq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の重力問題を厳密に解決するために必要な計算能力は、神経レベルで人間の脳の働きをシミュレートするために必要な計算能力（2.5×10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">よりも1桁だけ小さい</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[8]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。そのため、その厳密なソリューションは通常、おおよそのソリューションに置き換えられます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重力問題の近似解として最も広く使用されているアルゴリズムの1つであるツリーコードは、準線形時間の複雑さO（N * logN）を持っています</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[9]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ツリーコードは空間ツリーを構築し、このツリーの各ノードについて、そこに分類されるすべてのボディの総質量と質量中心を計算します。将来、各ボディに作用する重力を計算するときに、ツリーコードは他のボディの直接的な影響ではなく、ツリーノードの影響を考慮することができ、距離に応じて、ボディのサブセットがますます多くなるパラメータを含む、より大きなノードを選択します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fy/mu/cp/fymucpzatvvwlghoadwjgdzku3y.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィキペディアのイラスト。</font><font style="vertical-align: inherit;">中央のボディには、緑色の長方形で示されるノードの質量があります。</font><font style="vertical-align: inherit;">最も近いボディの質量のみが直接考慮されます。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">運動量場の重力問題</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
運動量場は離散ベクトル場</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mv（p）で</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、検討中の空間</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各点に</font><font style="vertical-align: inherit;">質量と速度のペア</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">関連付けます。</font><font style="vertical-align: inherit;">パルスフィールドは、任意の次元のスペースに設定できます。</font><font style="vertical-align: inherit;">質量と速度のペアは、運動量を特徴付け、次元</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + 1の</font><font style="vertical-align: inherit;">ベクトルを表します</font><font style="vertical-align: inherit;">。ここで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、パルスフィールドが与えられる空間の次元です。</font><font style="vertical-align: inherit;">たとえば、R = 2の場合、これはベクトル{ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> }になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシステムの記述の数学的に伝統的なバージョンは、ベクトル速度場とスカラー質量場の組み合わせであることは注目に値します。この場合、数学的なふりをしないため、速度と質量を1つのベクトルに自由に組み合わせることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gl/sf/ku/glsfku0yn1u3tdyftw6noww3fhg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パルスのベクトル場のごく一部：質量は色で示され、方向は矢印で示されます。</font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">パルス</font></i><i><font style="vertical-align: inherit;">の</font></i></font><br>
<br>
<img src="https://habrastorage.org/webt/xc/qh/uc/xcqhuc3vgvbr8-k4ybjmbeoh5na.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベクトル場は729×729要素のサイズです。左側は大衆です。右側は衝動です。この図のパルスは、HSV形式で色分けされています（色相はパルスの方向であり、値はその絶対値の次数を直線的に表示するため、最も区別できない（値= 0.05）パルスは10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-7</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のオーダーで</font><font style="vertical-align: inherit;">あり、最も明るいパルス（値= 1 、0）は10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以上の</font><font style="vertical-align: inherit;">オーダー</font><font style="vertical-align: inherit;">です。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これと同様に、グリッド-物理システムを記述する方法は、天体物理学でガス雲の進化、星や銀河の形成をシミュレートするために広く使用されています。これには、SAMR法</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[10]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または流体力学のグリッドモデル</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[11]が含まれ</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N体の重力問題の場合と同様に、離散場の進化では、この場を構成するすべての質量がその離散要素のそれぞれに及ぼす重力の影響を考慮する必要があります。問題の複雑さは空間</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次元に間接的に依存することを考慮する必要があります</font><font style="vertical-align: inherit;">。たとえば、1000×1000の要素で構成される平面上のフィールドの場合、総数Nは10 </font><sup><font style="vertical-align: inherit;">6に</font></sup><font style="vertical-align: inherit;">なります。</font></font><sup><font style="vertical-align: inherit;"></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素、および3次元空間の同じサイズのフィールドにはすでに10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素が</font><font style="vertical-align: inherit;">含まれ</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それにもかかわらず、運動量場の重力問題を近似的に解決することを可能にするいくつかのトリックがあります。マルチグリッド法は、階層的離散化を使用して、さまざまなサイズのいくつかのグリッドをサポートします</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[12]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 Multipole Expansionは、互いに近くにあるソースのグループを1つのオブジェクトとして扱います</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[13]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。マルチグリッドは、準線形計算の複雑さと対数メモリの複雑さを持っています。多重極拡張オプションの1つであるFMMは、計算精度の低下と引き換えに線形計算の複雑さを示します</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[14]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下では、パルスの離散フィールドの重力問題を準線形時間で解くことができ、メモリ内で線形の複雑さを持つ別の方法を検討します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合されたイメージ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インテグラルイメージを使用すると、任意の長方形領域の元のイメージの要素の合計を一定時間計算できます</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[15]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。コンピュータグラフィックスでは、統合画像はもともとミップマッピングと異方性フィルタリングの代替として提案されました</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[16]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。また、デジタル画像処理やパターン認識技術にも使用されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合イメージは、計算の複雑さとメモリの複雑さの間のトレードオフの最も明白な例の1つです。画像要素の合計を計算するための「単純な」アルゴリズムは、時間の複雑度がO（M * N）で、メモリの複雑度がO（1）です。統合されたイメージを使用すると、O（1）時間で同じ計算を実行でき、メモリはO（M * N）複雑です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_f/dp/ap/_fdpapnp5qlfd1e7uwv1hkqd614.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合画像を使用して特定の領域</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font><i><font style="vertical-align: inherit;">要素の合計を計算する統合画像を計算する</font></i><font style="vertical-align: inherit;">アルゴリズムは非常に単純で、線形計算の複雑さを特徴とし、GPGPUの下で簡単に並列化できます</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[17]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、2パスガウスフィルター</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[18]の</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ように実装さ</font><font style="vertical-align: inherit;">れます。最初のパスでは、行の部分和が考慮され、2番目のパスでは、これらの部分和が列に累積されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/d-/c9/gt/d-c9gtnjp-6xcsuykgfd0ruwhn4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つのパスでの統合画像の計算。左側は元の画像です。中央にはラインの部分的な金額があります。右側は最終的な統合イメージです。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ak/si/rc/aksircbzhaq2lby19dpbiaxwhwo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左側は、要素の質量を含む画像です。右側はその統合イメージです。左と右の画像は、異なる対数スケールを使用しています。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合された画像を使用した重力問題の近似解</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自由に大衆の統合されたイメージを持っているので、ツリーコードと多極展開に特徴的な手法をそれに適用することは難しくありません。</font><font style="vertical-align: inherit;">したがって、離散フィールドの各要素について：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">隣接する8つの要素のみの質量の影響を直接考慮します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合された画像を使用してそれらの質量の合計を計算することにより、9つの要素（3×3）で構成される8つの隣接領域の影響を考慮します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">後続の各ステップで、領域のサイズを3倍（9×9、27×27、81×81など）増やし、これがベクトルフィールド全体のサイズを超えるまで続けます。</font></font></li>
</ol><br>
 <img src="https://habrastorage.org/webt/u8/fy/qb/u8fyqbvn6-8o53z-hxsptyogxzk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">質量の積分画像を用いて、パルスのベクトル場の要素に作用する力の近似計算</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
のためのO（N * 8 * LOG3（SQRT（N）））のような、quasilinearly成長積分画像を用いて、パルスフィールドの重力問題の近似解の複雑</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 2また、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 3の</font><font style="vertical-align: inherit;">場合はO（N * 26 * log3（cbrt（N）））のようになり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ik/ou/zg/ikouzgiqpe4r0gs70ib-cxkxd9q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、この形式では、このソリューションにはマルチグリッドテクニックと同じ欠点があります。この問題を実証する最も簡単な方法は明確です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t-/1c/j8/t-1cj8ryo2xicugndkrgg6i_s3i.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この図の力はHSV形式で色分けされています（色相は力の方向、値はその絶対値の次数を直線的に表示するため、最も区別できない（値= 0.05）力は10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-7</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のオーダーで</font><font style="vertical-align: inherit;">あり、最も明るい力（値= 1、 0）は10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以上の</font><font style="vertical-align: inherit;">オーダー</font><font style="vertical-align: inherit;">です。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
上の図では、重力関数の低周波成分の「剛性」の影響が肉眼で確認できます。しかし、マルチグリッドでこの「剛性」がサンプリング周波数の低下により発生した場合、統合された画像では、これは質量の空間分布の性質に関する情報の不足によるものです。実際には、統合された画像を使用して力を近似するアルゴリズムは、重心が領域の中心と一致すると見なします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yp/p-/bt/ypp-bt8mx3i_w3g22ryuyveix_y.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図の中央は、残りのフィールドで比較的均一な質量分布を持つ質量極値を示しています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
質量</font><i><font style="vertical-align: inherit;">極値</font></i><font style="vertical-align: inherit;">は4つの長方形領域のそれぞれに分類されます。明らかに、各領域の質量中心の位置は、白で示される要素とほぼ一致している必要があります。その質量は、黄色で示される領域のほとんどの要素の質量よりも3桁大きいです。ただし、これらの領域の重力関数の低周波成分の計算では、それらの質量中心が円で示される領域の中心と一致すると考えられています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題は、統合画像に追加情報を導入することで解決できます。これにより、特定の領域の質量の合計だけでなく、重心の座標も計算できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、各要素に独自の座標が含まれている画像を想像してみましょう。対応するインテグラルイメージには、座標の合計が含まれます。したがって、この統合された画像の任意の領域の合計を、この領域の要素の総数で割ると、この領域の中心の座標に等しくなります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jc/ay/cp/jcaycpxtpzl1zn73lydkfbuwzig.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">座標の統合画像</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
たとえば、左下隅の座標が{3; 1}と右上に座標{7; 5}。この領域の座標の合計{168; 120}-{18; 45}-{28; 0} + {3; 0}は{125; 75}の場合、要素の総数は25であるため、その中心の座標は{5; 3}。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
やらなければならないことは、画像のすべての要素が1に等しい同じ重み係数を持つと考えるこの特定のケースを一般化することだけです。異なる重みを考慮するために、要素の座標にそれらを掛けます。そして、加重座標​​の合計を加重係数の合計で割ると、領域の中心の加重座標が得られます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o-/b5/nb/o-b5nb0apzvgpvx_mzegt-gcjza.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加重座標の統合画像。大きいフォントは重みを示します</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
座標{2;の左下隅の領域を考えます。 1}と右上に座標{5; 4}。この領域の重み付け係数の合計4.8-1.0-0.6 + 0.2は3.4であり、その重み付けされた座標の合計{11.1; 13.2}-{0.5; 2.0}-{1.5; 0,0} + {0,1; 0,0}は{9,2;と同じです。 11.2}。したがって、この領域の中心の加重座標は{2.7; 3.3}。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この回路が実際に機能することを確認するために、距離変換</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[19]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して、重み付き座標の統合された画像を距離フィールドに変換することにより、視覚的に確認できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5-/id/lq/5-idlqqfst1l6fektpcfezhxp2s.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重み付き座標を含む統合された画像を距離フィールドに変換します。左側は大衆の画像です。次の画像は、3×3要素の領域の重心までの距離です。次は、要素のサイズが9×9および27×27の領域の重心までの距離です。この図の距離値は、サンプリングに使用される領域のサイズに正規化されています。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/dv/yy/q7/dvyyq7f-7eyoq3-ppjmfsoddouo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重み付けされた座標を含む統合画像を有向距離フィールドに変換します。方向と距離はHSV形式で色分けされます。色相は方向、値は正規化された距離です。この図の距離値は、サンプリングに使用される領域のサイズに正規化されています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
上記のすべての要約：</font></font><br>
<br>
<ol>
<li>   ,     ,    ( ,  <i>R</i> = 3)  ―   ,  ,   .</li>
<li>               .</li>
<li>        O(1).</li>
<li>           O(M*N).</li>
</ol><br>
 <img src="https://habrastorage.org/webt/zk/ts/ti/zktstidnvrzkvinkpx9tiekqofy.png"><br>
<i>    .  ―        .  ―        .</i><br>
<br>
<h2>      </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合された画像の重要な機能の1つに注意を払う時間です。それでも、アプリケーションの範囲、つまりリソー​​スの消費と数値の安定性が制限されます。したがって、元の画像に含まれる値の範囲によっては、その統合画像に長いデータタイプが必要になる場合があります。たとえば、標準偏差を計算する場合、元の画像（値の範囲0..255）に加えて、対応する値の平方（値の範囲0..65535）を含む画像が使用されます。この場合、32ビットの大規模統合画像を計算するには精度が十分ではありません</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[20]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同様の状況は、重み付けされた座標を持つ統合された画像の場合にも見られます。統合された画像に格納する必要がある座標の合計の値は、それ自体で画像サイズNに応じて増加します。二次元N *（N-1）* N / 2。たとえば、2048×2048サイズ（4292870144に等しい）の画像の1つの整数座標の合計を格納するには、32ビットの符号なし整数（その最大値は4294967295）で十分です。より大きな統合画像を計算すると、オーバーフローが発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合された画像の32ビット浮動小数点数を使用することは、天文学の距離（10によるオーバーフローの問題を遅らせる</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10 - </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）しかし、同時に、加重座標​​を使用した計算の精度は、合計中に累積される打ち切り誤差のために大幅に低下します</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[21]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/dc/hd/abdchducjcslm8db-fhmwtqnk14.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイズが4×4要素の領域の加重重心を計算する際の誤差の絶対値。統合されたイメージには、単精度数（32ビット）が含まれています。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/wu/zt/qj/wuztqj-7c30j-yhdhnd7gwugrs4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイズが32×32要素の領域の加重重心を計算する際の誤差の絶対値。統合されたイメージには、単精度数（32ビット）が含まれています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最大の絶対値は、小さな領域の加重重心の計算によって達成されます。領域のサイズが2桁増加すると、計算の絶対誤差の大きさが4桁減少します。この場合、（要素の重み付き座標の計算に使用される）重み付け係数の値の範囲に対する計算エラーの依存性は見つかりませんでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nn/xg/at/nnxgat46ty-pm8x78yh9ph-d3cq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重みの範囲が増加しても、重み付き重心の計算における誤差の絶対値には影響しません。グラフは、「統合された画像の右上隅にある」「最悪の」領域のエラーを示しています。統合された画像のサイズは256×256要素です。</font></font></i><br>
 <br>
<img src="https://habrastorage.org/webt/j3/im/68/j3im68bh4wkidntnuo9ihllayxs.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加重重心の計算における誤差の絶対値は、領域のサイズが大きくなるにつれて減少します。グラフは、「統合された画像の右上隅にある」「最悪の」領域のエラーを示しています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
上記の分析に基づいて、統合画像を使用して加重重心を計算するために単精度数を使用することは、サイズが約512×512要素の画像に対してのみ実用的であると結論付けることができます。さらにサイズが大きくなると、誤差の大きさはイメージ要素のサイズに匹敵します。また、このエラーは領域のサイズが大きくなると減少しますが、最終結果（重力の大きさ）に最大の影響を与えるのは小さなサイズの領域であるため、対応するエラーのみを考慮する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大きな画像の場合は、倍精度の重み付き座標を使用するか、さらに1レベルの離散化を追加できます。元の画像をいくつかの部分に分割し、これらの部分ごとに積分画像を個別に読み取ります。</font><font style="vertical-align: inherit;">計算の複雑さの観点から、領域の要素の合計を計算するために複数の積分画像が使用されているが、この「複数」は定数である場合、合計計算アルゴリズムの複雑さは変わりません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合された画像を使用する上記の例は、重要度によるサンプリング（重要度のサンプリング）に最適なアルゴリズムO（1）を開発するためにおそらく適合させることができます。</font><font style="vertical-align: inherit;">GPUの観点から、既存の、そして非常にリソースを消費するアルゴリズムは、線形複雑度O（N）を持ち、グローバルライティングの最新の方法でアプリケーションを見つけます</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[22、23]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、私の意見では、統合された画像は最も過小評価されているアルゴリズムの1つです。</font><font style="vertical-align: inherit;">これらは同時にミップマッピングと異方性フィルタリングの優れた代替手段となり、後者がGPUでどのように実装されているかを考慮すると</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[24、25]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すでにより効果的な方法である可能性が非常に高いです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考文献</font></font></h2><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リストを見る</font></font></b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/N-body_problem</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/List_of_Solar_System_objects_by_size</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Near-Earth_object</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Asteroid</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Trojan_</a>(celestial_body)</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Kuiper_belt</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Oort_cloud</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Computer_performance_by_orders_of_magnitude</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Barnes%E2%80%93Hut_simulation</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">link.springer.com/chapter/10.1007/978-1-4612-1252-2_10</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.researchgate.net/publication/281362507_Grid-Based_Hydrodynamics_in_Astrophysical_Fluid_Flows</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Multigrid_method</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Multipole_expansion</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">math.nyu.edu/faculty/greengar/shortcourse_fmm.pdf</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Summed-area_table</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.florian-oeser.de/wordpress/wp-content/2012/10/crow-1984.pdf</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.nmr.mgh.harvard.edu/~berkin/Bilgic_2010_Integral_Image.pdf</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Gaussian_blur</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Distance_transform</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">staffhome.ecm.uwa.edu.au/~00082689/papers/Shafait-efficient-binarization-SPIE08.pdf</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Truncation_error</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">t.co/Muf6I3yq71?amp=1</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">developer.nvidia.com/gpugems/gpugems3/part-iii-rendering/chapter-20-gpu-based-importance-sampling</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Mipmap</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">en.wikipedia.org/wiki/Anisotropic_filtering</a></li>
</ol><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja493284/index.html">Kubernetes 1.18：主要なイノベーションの概要</a></li>
<li><a href="../ja493288/index.html">5つの有名な説明されたプログラミングの引用</a></li>
<li><a href="../ja493292/index.html">レスポンシブかレスポンシブか？Reactコンポーネント構造の解析</a></li>
<li><a href="../ja493294/index.html">ソビエトの集積回路の内部をTTLで調べます</a></li>
<li><a href="../ja493298/index.html">C ++、メタプログラミング、およびマイクロコントローラーのレジスター</a></li>
<li><a href="../ja493302/index.html">コロナウイルスと戦うために、すでにどんな技術が求められていますか？</a></li>
<li><a href="../ja493304/index.html">ゼロからヘキサポッドを開発する（パート8）-数学の動きの改善</a></li>
<li><a href="../ja493306/index.html">ゲートウェイAPIをWebアプリケーションおよびAPIの単一のエントリポイントとして使用する</a></li>
<li><a href="../ja493308/index.html">ほとんどすべての従業員をリモートサイトに転送した実際の経験</a></li>
<li><a href="../ja493310/index.html">神のゲーム：人工生物</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>