<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💜 👦🏼 🔨 Loghouse 0.3 - das lang erwartete Update unseres Protokollierungssystems in Kubernetes 👩🏻‍🎨 🔔 🍧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Flant hat eine Reihe von Open Source-Entwicklungen, hauptsächlich für Kubernetes, und Loghouse ist eine der beliebtesten. Dies ist unser zentrales Pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Loghouse 0.3 - das lang erwartete Update unseres Protokollierungssystems in Kubernetes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/493158/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flant hat eine Reihe von Open Source-Entwicklungen, hauptsächlich für Kubernetes, und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Loghouse</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist eine der beliebtesten. </font><font style="vertical-align: inherit;">Dies ist unser zentrales Protokollierungswerkzeug in K8s, das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mehr als 2 Jahren eingeführt wurde. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ac/qe/lz/acqelzxpdkabvtthknpon8dnv1g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie wir kürzlich in einem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel über die Protokolle erwähnt haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , musste es verfeinert werden, und seine Relevanz nahm im Laufe der Zeit zu. </font><font style="vertical-align: inherit;">Heute freuen wir uns, Ihnen eine neue Version von loghouse vorstellen zu können - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v0.3.0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Details über sie - unter dem Schnitt.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachteile</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben die ganze Zeit in vielen Kubernetes-Clustern Loghouse verwendet, und im Allgemeinen passt diese Lösung sowohl zu uns selbst als auch zu den verschiedenen Kunden, auf die wir auch Zugriff gewähren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hauptvorteile</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind die einfache und intuitive Benutzeroberfläche, die Fähigkeit, SQL-Abfragen auszuführen, die gute Komprimierung und der geringe Ressourcenverbrauch beim Einfügen von Daten in die Datenbank sowie der geringe Overhead während der Speicherung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die schmerzhaftesten </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probleme</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Blockhaus während des Betriebs:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verwendung von Partitionstabellen, die durch eine Zusammenführungstabelle verbunden sind;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fehlen eines Puffers, der Protokollstöße glätten würde;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Veraltetes und potenziell gefährdetes Webpanel-Juwel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">veraltet fließend ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loghouse-fließend: spätestens</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wegen eines problematischen Gemset nicht gestartet).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus hat sich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine beträchtliche Anzahl von </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Problemen</font></a><font style="vertical-align: inherit;"> angesammelt </font><font style="vertical-align: inherit;">, die ich auch gerne lösen würde.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wesentliche Änderungen im Blockhaus 0.3.0</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich haben wir genügend Änderungen gesammelt, aber wir werden die wichtigsten hervorheben. </font><font style="vertical-align: inherit;">Sie können in 3 Hauptgruppen unterteilt werden:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verbesserung der Protokollspeicherung und des Datenbankschemas;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verbesserte Protokollsammlung;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> das Auftreten der Überwachung.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Verbesserungen bei der Protokollspeicherung und beim Datenbankdesign</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schlüsselinnovationen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Protokollspeicherschemata wurden geändert, der Übergang </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zur Arbeit mit einer einzelnen Tabelle und die Ablehnung von Partitionstabellen wurden abgeschlossen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grundreinigungsmechanismus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in ClickHouse der neuesten Versionen gebaut hat damit begonnen , </font><font style="vertical-align: inherit;">angewendet werden </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt können Sie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine externe ClickHouse-Installation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auch im Cluster-Modus verwenden.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergleichen Sie die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leistung der alten und neuen Schaltungen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in einem realen Projekt. </font><font style="vertical-align: inherit;">Hier ist ein Beispiel für die Suche nach eindeutigen URLs in den Anwendungsprotokollen der beliebten Online-Ressource </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dtf.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    string_fields.values[indexOf(string_fields.names, <span class="hljs-string">'path'</span>)] <span class="hljs-keyword">AS</span> <span class="hljs-keyword">path</span>, 
    <span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">count</span>
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">logs</span>
<span class="hljs-keyword">WHERE</span> (namespace = <span class="hljs-string">'kube-nginx-ingress'</span>) <span class="hljs-keyword">AND</span> ((string_fields.values[indexOf(string_fields.names, <span class="hljs-string">'vhost'</span>)]) <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%foobar.baz%'</span>) <span class="hljs-keyword">AND</span> (<span class="hljs-built_in">date</span> = <span class="hljs-string">'2020-02-29'</span>)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> string_fields.values[indexOf(string_fields.names, <span class="hljs-string">'path'</span>)]
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">count</span> <span class="hljs-keyword">DESC</span>
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">20</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Auswahl erfolgt über zig Millionen Datensätze. </font><font style="vertical-align: inherit;">Das alte Schema hat in 20 Sekunden funktioniert: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qx/ws/cg/qxwscgrtd4sjpjxd5njk4l9cgp8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neu - in 14: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sl/ra/n6/slran6jzocb2yzljkocrkeap5vs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie unser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helm-Diagramm verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wird die Datenbank beim Aktualisieren des Blockhauses automatisch in das neue Format migriert. </font><font style="vertical-align: inherit;">Andernfalls müssen Sie die Migration manuell durchführen. </font><font style="vertical-align: inherit;">Der Vorgang ist in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kurz gesagt, laufen Sie einfach:</font></font><br>
<br>
<pre><code class="bash hljs">DO_DB_DEPLOY=<span class="hljs-literal">true</span> rake create_logs_tables</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus haben wir begonnen, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TTL für ClickHouse-Tabellen zu verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Auf diese Weise können Sie automatisch Daten aus der Datenbank löschen, die älter als das angegebene Zeitintervall sind:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">logs</span><font></font>
(<font></font>
....<font></font>
)<font></font>
  <span class="hljs-keyword">ENGINE</span> = MergeTree()
  <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> (<span class="hljs-built_in">date</span>)
  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> (<span class="hljs-built_in">timestamp</span>, nsec, namespace, container_name)<font></font>
  TTL <span class="hljs-built_in">date</span> + toIntervalDay(<span class="hljs-number">14</span>)
  <span class="hljs-keyword">SETTINGS</span> index_granularity = <span class="hljs-number">32768</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiele für Datenbankschemata und Konfigurationen für ClickHouse, einschließlich eines Beispiels für die Arbeit mit dem CH-Cluster, finden Sie in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbesserte Protokollsammlung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schlüsselinnovationen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es wurde ein </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puffer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hinzugefügt </font><font style="vertical-align: inherit;">, der Bursts glättet, wenn eine große Anzahl von Protokollen angezeigt wird.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierung der Möglichkeit </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Protokolle direkt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von der Anwendung </font><b><font style="vertical-align: inherit;">an das Loghouse</font></b><font style="vertical-align: inherit;"> zu </font><b><font style="vertical-align: inherit;">senden</font></b><font style="vertical-align: inherit;"> : über TCP und UDP im JSON-Format.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Blockhausbatterie im Blockhaus ist eine neue Tabelle </font></font><code>logs_buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die dem Datenbankschema hinzugefügt wurde. </font><font style="vertical-align: inherit;">Diese Tabelle befindet sich im Speicher, d.h. </font><font style="vertical-align: inherit;">im RAM gespeichert (hat einen speziellen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puffertyp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ); </font><font style="vertical-align: inherit;">Sie sollte die Last auf der Basis glätten. </font><font style="vertical-align: inherit;">Vielen Dank </font><font style="vertical-align: inherit;">für den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Hinzufügen.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sovigod</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das implementierte Senden von Protokollen direkt von der Anwendung an loghouse ermöglicht es Ihnen, dies auch über netcat zu tun:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">'{"log": {"level": "info", "msg": "hello world"}}'</span> | nc fluentd.loghouse 5170</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Protokolle können in dem Namespace angezeigt werden, in dem Loghouse im Stream installiert ist </font></font><code>net</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Die </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ii/as/pp/iiasppd5mr1xfl335vemk-cp2h0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anforderungen an die zu sendenden Daten sind minimal: Die Nachricht muss ein gültiger JSON mit einem Feld sein </font></font><code>log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Das Feld </font></font><code>log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kann wiederum entweder eine Zeichenfolge oder ein verschachtelter JSON sein.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überwachung des Protokollierungssubsystems</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine wichtige Verbesserung war die Überwachung von Fluentd durch Prometheus. </font><font style="vertical-align: inherit;">Jetzt wird das Blockhaus mit einem Panel für Grafana geliefert, in dem alle grundlegenden Metriken angezeigt werden, z.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anzahl der fließenden Arbeitnehmer;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anzahl der an ClickHouse gesendeten Ereignisse;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> freie Puffergröße in Prozent.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Panel-Code für Grafana ist in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu sehen </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Panel für ClickHouse basiert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einem fertigen Produkt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f1yegor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wofür </font><i><font style="vertical-align: inherit;">wir uns</font></i><font style="vertical-align: inherit;"> beim Autor </font><i><font style="vertical-align: inherit;">bedanken</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, zeigt das Bedienfeld die Anzahl der Verbindungen zu ClickHouse, die Verwendung des Puffers, die Aktivität der Hintergrundaufgaben und die Anzahl der Zusammenführungen an. Dies reicht aus, um den Status des Systems zu verstehen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/pv/lm/ggpvlmvrkdiqpfwk9pea-7-09re.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Feld für fluentd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zeigt die aktiven Instanzen von fluentd an. Dies ist besonders wichtig für diejenigen, die keine Protokolle verlieren möchten / können:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gm/sy/si/gmsysi96zdxhm89qhwtzb_a9k30.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusätzlich zum Status der Pods zeigt das Bedienfeld die Last in der Warteschlange zum Senden von Protokollen an ClickHouse an. </font><font style="vertical-align: inherit;">Sie können wiederum nachvollziehen, ob ClickHouse die Last verarbeitet oder nicht. </font><font style="vertical-align: inherit;">In Fällen, in denen das Protokoll nicht verloren gehen kann, wird dieser Parameter ebenfalls kritisch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiele für Panels sind für unsere Lieferung von Prometheus Operator geschärft, können jedoch leicht über die Variablen in den Einstellungen geändert werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schließlich haben wir im Rahmen der Blockhausüberwachung ein aktuelles Docker-Image mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clickhouse_exporter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0.1.0 zusammengestellt, das von Percona Labs veröffentlicht wurde, da der Autor des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ursprünglichen clickhouse_exporter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sein Repository verlassen hat.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zukunftspläne</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ermöglichen Sie die Bereitstellung eines ClickHouse-Clusters in Kubernetes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arbeiten Sie mit der Auswahl der Protokolle asynchron und entfernen Sie sie aus dem Ruby-Teil des Backends. </font></font></li>
<li>  Ruby-    ,     .</li>
<li> ,     Go.</li>
<li>   .</li>
</ul><br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist schön zu sehen, dass das Loghouse-Projekt sein Publikum gefunden hat, nicht nur Sterne in GitHub (600+) gewonnen hat, sondern auch echte Benutzer dazu ermutigt hat, über ihre Erfolge und Probleme zu sprechen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir vor mehr als zwei Jahren ein Blockhaus gegründet hatten, waren wir uns seiner Aussichten nicht sicher und erwarteten, dass der Markt und / oder die Open Source-Community die besten Lösungen anbieten würden. </font><font style="vertical-align: inherit;">Heute sehen wir jedoch, dass dies ein praktikabler Weg ist, den wir selbst immer noch für viele Kubernetes-Cluster mit Service wählen und verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir freuen uns auf jede Unterstützung bei der Verbesserung und Entwicklung des Blockhauses. </font><font style="vertical-align: inherit;">Wenn Sie etwas im Blockhaus vermissen - schreiben Sie in die Kommentare. </font><font style="vertical-align: inherit;">Natürlich freuen wir uns auch, auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aktiv zu sein </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lesen Sie auch in unserem Blog:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Loggt sich heute in Kubernetes (und nicht nur) ein: Erwartungen und Realität</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li> «<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> loghouse — Open Source-      Kubernetes</a>».</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493140/index.html">Die Abenteuer von Cipollino: Quarantäne IT Quest von Flant</a></li>
<li><a href="../de493142/index.html">"Lass uns Kubernetes benutzen!" Sie haben jetzt 8 Probleme</a></li>
<li><a href="../de493146/index.html">Spannende Nebenprojekte, die Sie heute durchführen können</a></li>
<li><a href="../de493150/index.html">"Remote" mit einem Cisco-Router</a></li>
<li><a href="../de493152/index.html">Neuronale Netze und Process Mining: Freunde finden</a></li>
<li><a href="../de493160/index.html">Wie wir die intelligente Suche auf hh.ru im Jahr 2019 verbessert haben: Infografiken</a></li>
<li><a href="../de493162/index.html">Eine offene Liste von Online-Meetings und Konferenzen</a></li>
<li><a href="../de493164/index.html">Es stellt sich heraus, dass das Online-Geschäft in der aktuellen Umgebung überlebt. Warum? DNA gelöscht</a></li>
<li><a href="../de493166/index.html">Ontol: eine Auswahl von Artikeln über "Burnout" [100+]</a></li>
<li><a href="../de493168/index.html">Pipipax-Rechner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>