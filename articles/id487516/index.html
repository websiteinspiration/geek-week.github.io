<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖌️ 🍸 🏇🏽 Teknik berburu dan taktik penyerang menggunakan file Prefetch 💤 🥕 🚛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Trace file, atau Prefetch file, telah muncul di Windows sejak XP. Sejak itu, mereka telah membantu para ahli forensik digital dan spesialis respons in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Teknik berburu dan taktik penyerang menggunakan file Prefetch</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/487516/"><img src="https://habrastorage.org/webt/qz/fo/tx/qzfotx-ph1-q-7z411gspmuocm8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trace file, atau Prefetch file, telah muncul di Windows sejak XP. Sejak itu, mereka telah membantu para ahli forensik digital dan spesialis respons insiden komputer menemukan jejak peluncuran perangkat lunak, termasuk malware. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oleg Skulkin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , seorang </font><font style="vertical-align: inherit;">spesialis terkemuka dalam forensik komputer di Group-IB, </font><b><font style="vertical-align: inherit;">berbicara</font></b><font style="vertical-align: inherit;"> tentang apa yang dapat Anda temukan dengan file Prefetch dan bagaimana melakukannya.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File prefetch disimpan di direktori </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% SystemRoot% \ Prefetch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan digunakan untuk mempercepat proses peluncuran program. Jika kita melihat salah satu dari file-file ini, kita akan melihat bahwa namanya terdiri dari dua bagian: nama file yang dapat dieksekusi dan checksum dari path ke sana, yang terdiri dari delapan karakter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File yang diambil sebelumnya berisi banyak informasi yang berguna dari sudut pandang forensik: nama file yang dapat dieksekusi, jumlah awal, daftar file dan direktori yang digunakan file yang dapat dieksekusi berinteraksi, dan, tentu saja, cap waktu. Biasanya, forensik menggunakan tanggal pembuatan file Prefetch tertentu untuk menentukan tanggal program pertama kali dimulai. Selain itu, file-file ini menyimpan tanggal peluncuran terakhirnya, dan mulai dengan versi 26 (Windows 8.1), cap waktu dari tujuh peluncuran terakhir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita ambil salah satu file Prefetch, ekstrak datanya menggunakan PECmd Eric Zimmerman dan lihat setiap bagian. </font><font style="vertical-align: inherit;">Untuk demonstrasi, saya akan mengekstrak data dari file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CCLEANER64.EXE-DE05DBE1.pf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, mari kita mulai dari atas. </font><font style="vertical-align: inherit;">Tentu saja, kami memiliki stempel waktu untuk membuat, memodifikasi, dan mengakses file:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u1/gh/uj/u1ghujj7plvhk5wwcrlwrvkxol4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mereka diikuti oleh nama file yang dapat dieksekusi, checksum dari path ke sana, ukuran file yang dapat dieksekusi, serta versi file Prefetch:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/99/b1/af/99b1afl_ahgisejuyetwy5u8oha.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena kita berhadapan dengan Windows 10, maka kita akan melihat jumlah peluncuran, tanggal dan waktu peluncuran terakhir, dan tujuh cap waktu lagi yang menunjukkan tanggal peluncuran sebelumnya:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_n/n6/lq/_nn6lqn99py-wbkorga_2k6xr2e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mereka diikuti oleh informasi tentang volume, termasuk nomor seri dan tanggal pembuatannya:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zo/f7/ur/zof7urr3spmk8fowq19tlm1dtms.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan yang tak kalah pentingnya, daftar direktori dan file yang dapat dieksekusi berinteraksi dengan: </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sj/ut/uc/sjutucejd0bdtl7lqj4jyxvn3bu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, direktori dan file yang berinteraksi dengan executable adalah apa yang ingin saya fokuskan hari ini. Data inilah yang memungkinkan spesialis dalam forensik digital, menanggapi insiden komputer atau pencarian ancaman proaktif untuk menetapkan tidak hanya fakta pelaksanaan file, tetapi, dalam beberapa kasus, merekonstruksi taktik dan teknik penyerang tertentu. Saat ini, penyerang cukup sering menggunakan alat untuk menghapus data secara permanen, misalnya, SDelete, sehingga kemampuan untuk memulihkan setidaknya jejak penggunaan taktik dan teknik tertentu hanya diperlukan untuk bek modern - spesialis forensik komputer, spesialis respons insiden, pakar ThreatHunter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai dengan taktik Akses Awal (TA0001) dan teknik paling populer - Spearphishing Attachment (T1193). Beberapa kelompok penjahat dunia maya sangat kreatif dalam memilih lampiran semacam itu. Misalnya, grup Diam menggunakan file CHM (Microsoft Compiled HTML Help) untuk ini. Jadi, kami memiliki teknik lain - File HTML Terkompilasi (T1223). File-file tersebut diluncurkan menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hh.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , oleh karena itu, jika kami mengekstrak data dari file Prefetch-nya, kami akan mencari tahu file mana yang dibuka oleh korban:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rz/u-/qs/rzu-qs_1gqkqozlylsktzgbixeq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan terus bekerja dengan contoh nyata dan beralih ke taktik Eksekusi berikutnya (TA0002) dan teknik CSMTP (T1191). </font><font style="vertical-align: inherit;">Pemasang Profil Manajer Koneksi Microsoft (CMSTP.exe) dapat digunakan oleh penyerang untuk menjalankan skrip berbahaya. </font><font style="vertical-align: inherit;">Contoh yang bagus adalah band Cobalt. </font><font style="vertical-align: inherit;">Jika kami mengekstrak data dari file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prefetch cmstp.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kami dapat mengetahui lagi apa yang sebenarnya dimulai:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_a/d6/w6/_ad6w6l4kie1jzvqlghmofdjkmy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teknik populer lainnya adalah Regsvr32 (T1117). </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regsvr32.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> juga sering digunakan oleh penyerang untuk meluncurkan. </font><font style="vertical-align: inherit;">Berikut adalah contoh lain dari grup Cobalt: jika kita mengekstrak data dari file Prefetch </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regsvr32.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka sekali lagi kita akan melihat apa yang diluncurkan:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/z5/qi/9ez5qisulx1rhfpgpph2lqsg2io.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Taktik berikut adalah Persistence (TA0003) dan Privilege Escalation (TA0004), serta Application Shimming (T1138) sebagai teknik. Teknik ini digunakan oleh Carbanak / FIN7 untuk mengamankan sistem. Biasanya bekerja dengan basis data dengan informasi tentang kompatibilitas program ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.sdb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) menggunakan </font><b><font style="vertical-align: inherit;">sdbinst.exe</font></b><font style="vertical-align: inherit;"> . Oleh karena itu, file prefetch dari file yang dapat dieksekusi ini dapat membantu kami mengetahui nama-nama database tersebut dan lokasinya:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ps/40/rj/ps40rjgtsih7brdssonnfi05ug0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang dapat Anda lihat dalam ilustrasi, kami tidak hanya memiliki nama file yang digunakan untuk instalasi, tetapi juga nama database yang diinstal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat salah satu contoh paling umum dari peningkatan jaringan (TA0008) - PsExec menggunakan sumber daya bersama administratif (T1077). Layanan bernama PSEXECSVC (tentu saja, nama lain dapat digunakan jika penyerang menggunakan opsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) akan dibuat pada sistem target, oleh karena itu, jika kita mengekstrak data dari file Prefetch, kita akan melihat bahwa itu diluncurkan:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fb/x6/oq/fbx6oqbuwsqjx4n7rlwxepbokg0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan menyelesaikan, mungkin, dengan apa yang saya mulai dengan - menghapus file (T1107). </font><font style="vertical-align: inherit;">Seperti yang saya perhatikan, banyak penyerang menggunakan SDelete untuk menghapus file secara permanen pada berbagai tahap siklus hidup serangan. </font><font style="vertical-align: inherit;">Jika kita melihat data dari file Prefetch </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sdelete.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kita akan melihat apa yang sebenarnya dihapus:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_s/7r/ow/_s7rowf7rwit15k0or2byyp0gkk.jpeg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, ini bukan daftar lengkap teknik yang dapat ditemukan selama analisis file Prefetch, tetapi ini harus cukup untuk memahami bahwa file tersebut tidak hanya dapat menemukan jejak peluncuran, tetapi juga merekonstruksi taktik dan teknik spesifik penyerang.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id487516/">https://habr.com/ru/post/id487516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487504/index.html">Pada Hari Ilmu Pengetahuan Rusia, pencapaian terbaik ilmuwan dalam negeri tahun 2019 dinamai</a></li>
<li><a href="../id487508/index.html">Mengukur jarak ke objek menggunakan RealSense D435</a></li>
<li><a href="../id487510/index.html">Produk radioaktif. Spektrometer gamma. Bagian 1</a></li>
<li><a href="../id487512/index.html">Bagaimana cara menerapkan pengabaian pengguna yang diblokir dalam grup Telegram?</a></li>
<li><a href="../id487514/index.html">Laporan Keamanan dan Ketersediaan Jaringan Tahunan Qrator Labs</a></li>
<li><a href="../id487518/index.html">Produk radioaktif. Spektrometer gamma. Bagian 2</a></li>
<li><a href="../id487522/index.html">Kami membuat terminal terbang (bagian 1)</a></li>
<li><a href="../id487524/index.html">Mengapa perlu startup perangkat keras hackathon</a></li>
<li><a href="../id487528/index.html">Изменения в пользовательском соглашении и политике конфиденциальности на сервисах Хабра</a></li>
<li><a href="../id487534/index.html">etcd 3.4.3: penelitian keandalan dan penyimpanan penyimpanan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>