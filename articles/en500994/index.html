<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•ï¸ ğŸš£ğŸ½ ğŸš´ğŸ¿ Run ant. Run ğŸ¥• ğŸ‘©ğŸ½â€ğŸ­ ğŸ¥”</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article discusses the process of creating a simulation model of the behavior of an ant colony (can be read on Wikipedia ) in the simulation envir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Run ant. Run</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500994/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This article discusses the process of creating a simulation model of the behavior of an ant colony (can be read on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) in the simulation environment "AnyLogic". </font><font style="vertical-align: inherit;">This article is practical. </font><font style="vertical-align: inherit;">It will consider the use of the ant algorithm to solve the traveling salesman problem (you can </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">read here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ca/-m/xy/ca-mxya2npzn6aynp21dpuepx2g.gif"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Briefly about the essence</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The essence of the traveling salesman problem is that the traveling salesman (seller) must visit N cities after visiting each of them only once along the shortest route. Since this task is NP-complex and the number of options for all possible routes between N cities is calculated as â€œN!â€, The shortest route search time will increase exponentially with an increase in N. Accordingly, the shortest route (solution) search time using the algorithm â€œExhaustive searchâ€ (which gives an exact solution) with the number of cities N&gt; 16 increases sharply (is exponential). Therefore, we will not search for the shortest route in length, but close (rational) to it in a finite time using the â€œant algorithmâ€.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A few words about AnyLogic is a powerful tool that allows you to create simulation models of varying complexity. </font><font style="vertical-align: inherit;">It implements various approaches of simulation. </font><font style="vertical-align: inherit;">We will be analyzing only one of the approaches, namely, â€œAgentâ€ modeling. </font><font style="vertical-align: inherit;">It is implemented in the Java programming language, which complements the existing tools. </font><font style="vertical-align: inherit;">The main disadvantage of â€œAnyLogicâ€ is the limitation of the free version on the number of created agents; their number cannot exceed 50,000. â€œAgentâ€ is the basic unit of AnyLogic simulation system. </font><font style="vertical-align: inherit;">More information can be found on the website </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.anylogic.ru</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tools</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Anylogic - download the free version from here </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.anylogic.ru/downloads</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
AnyLogic initial introduction: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AnyLogic interface is shown in Figure 1. It includes:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the green area is the space of the agent in which we will create;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">red area - properties of the object that is in focus;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">palette - tools that you can use when creating a model;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projects - the structure of the developed model.</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/webt/ni/-d/kx/ni-dkxyorpukg5a6xkitxe7nwpm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">1- AnyLogic popup window</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project creation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Everything is simple here. </font><font style="vertical-align: inherit;">Click on the â€œFileâ€ menu item next to â€œCreateâ€ and then â€œModelâ€, enter the model name and click on the â€œFinishâ€ button (Fig. 2). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ej/5e/96/ej5e96ohohjgxmygsj2teeedt1q.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">2- Creating a model</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create cities</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, let's get started. The first thing we will do is create the so-called cities (tops of the graph) that the ant will visit. Why do we open the â€œAgentâ€ tab in the palette and drag the red circle with the little man into the â€œMainâ€ agent from there, as shown in Figure 3. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v9/2x/nb/v92xnbu57t8ulh_cttg_i6p1e_0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 3- Creating cities</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
After you release the mouse button, a dialog box appears ("Step 1"), prompting you to create an agent. Where it will be necessary to select the "Agent Population" item and click on the "Next" button. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h5/bb/jm/h5bbjm3eyfyzggqc_ixb7bikqoi.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4- Creating cities</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The following dialog box appears (Step 2) where you will need to enter the name of the new agent type and the name of the agent population. Enter the type â€œMyTownâ€ and the name of the population â€œmyTownsâ€ and click on the â€œNextâ€ button. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0k/fi/ak/0kfiaknzozrmlyjkzpgnkdrtp2m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4a - Enter the name of the new agent</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then the following window will appear (Step 4.). Here we select â€œ2D Agent Animationâ€ and the icon with the inscription â€œPlantâ€ and click on the â€œFinishâ€ button (Fig. 5). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/si/73/l7/si73l7efxqaj4-lsibjaq23bo5o.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 5- Add animation for the agent</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now create a variable that will determine the initial number of cities in our model. Why, from the "Palette", drag the icon with the inscription "Variable" into the agent "Main" and enter its name "numberTown". Next, click on the icon of our variable and in the Properties tab, enter its initial value equal to, for example, 10 and select its type â€œintâ€ (Fig. 6). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xg/ox/6o/xgox6ohlkcyugq_8bndgxeqe7pe.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 6- Creating a variable</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now we set the initial value of our city population â€œmyTownsâ€, for which we click on its icon and in the â€œPropertiesâ€ tab in the field â€œInitial number of agentsâ€ write the name of the variable we created earlier (Fig. 7).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n2/wn/wr/n2wnwrzolah44a3oiblzp0uitvw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">7 - Changing the properties of the â€œmyTownsâ€ population Next,</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
we will </font><i><font style="vertical-align: inherit;">draw the</font></i><font style="vertical-align: inherit;"> conclusion of our cities in the â€œMainâ€ agent in a random place. </font><font style="vertical-align: inherit;">The space is limited to a square of 400x400 pixels. </font><font style="vertical-align: inherit;">Why, in the "Projects" tab, select the "Main" agent with the mouse and in the "Properties" tab, in the "At Startup" field, add the following Java code (Fig. 7a):</font></font><br>
<pre><code class="java hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;myTowns.size(); i++) {<font></font>
	myTowns.get(i).setXY(uniform(<span class="hljs-number">0</span>,<span class="hljs-number">400</span>), uniform(<span class="hljs-number">0</span>,<span class="hljs-number">400</span>));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Where:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myTowns.size () - the number of cities created;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myTowns.get (i) .setXY (uniform (0.400), uniform (0.400)) - set the X and Y coordinates for the i-th city;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniform (0,400) - a function that returns a random number in the range from 0 to 400 according to the equally probable distribution law of a random variable. </font><font style="vertical-align: inherit;">The AnyLogic environment has an extensive toolkit for working with various distributions of random variables. </font><font style="vertical-align: inherit;">There is a built-in constructor of probability distributions, it is available in the toolbar.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Where:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myTowns.size () - the number of cities created;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myTowns.get (i) .setXY (uniform (0.400), uniform (0.400)) - set the X and Y coordinates for the i-th city;</font></font></li>
<li>uniform(0,400) â€“ ,        0  400      .   AnyLogic          .              . </li>
</ul><br>
<br>
<img src="https://habrastorage.org/webt/cx/9s/uh/cx9suhbif3brjkqje09vjpp0wos.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">7a - We arrange the cities.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Then we can already see what we did and start our model. </font><font style="vertical-align: inherit;">To do this, use the "F5" key, click it and the window for launching the experiment is launched as shown in Figure 8. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e7/w9/0j/e7w90jfs3sz6flkkxvkmhksfysk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">8 - Start the experiment</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Next, click on the "Run" button in the lower left corner of the window and the experiment starts. </font><font style="vertical-align: inherit;">You should get a window with the contents on the screen as shown in Figure 9. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h5/hj/rw/h5hjrw2oona5nb5oxamr7wk1kro.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">9 - The result of the experiment</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So, at this step we created 10 cities and placed them in a random (stochastic) place on our screen. </font><font style="vertical-align: inherit;">Now let's move on to the creation of our "ants"</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create an ant</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the main combat unit of our model will be an ant. We must, firstly, create it, and then model its behavior. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creating an ant is similar to creating a city. In the "Palette" select "Agent" and drag it to "Main". Select â€œPopulation of agentsâ€, then â€œI want to create a new type of agentâ€, then enter â€œName of the new typeâ€ and â€œPopulation nameâ€ â€œMyAntâ€ â€œmyAntsâ€ and click â€œNextâ€. After that we select â€œ2Dâ€ animation and, for example, the icon with the inscription â€œFighterâ€ press â€œFinishâ€ and it should turn out as shown in Figure 10. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q-/pb/wj/q-pbwj-wzsom4meb0xjebt8f6e0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 10 - Create ants</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agree, the airplane does not look like an ant, so we will fix it. We go into the search engine looking for a picture that depicts an ant and change the plane to an ant. Why do we double-click on the red circle near "myAnts". After that the â€œmyAntâ€ tab will open where you need to remove the plane and place the ant in its place (Fig. 11). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v-/5a/tp/v-5atplfehtp9oii49ogb4zarx4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 11 - MyAnt tab</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Select the plane with the mouse and press "Del". Next, go to the â€œPresentationâ€ tab and drag the â€œImageâ€ element from there. After that, a dialog will automatically open to select a file. Select the file with our ant (Fig. 12) and click OK. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3u/cv/jo/3ucvjoiromyqmon5c0gg8rnitps.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 12 - MyAnt tab with ant and already without an airplane</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Move on. </font><font style="vertical-align: inherit;">Scale the ant and move it to the place where the plane used to be. </font><font style="vertical-align: inherit;">It should turn out as shown in Figure 12a. </font><font style="vertical-align: inherit;">All these operations are performed using the mouse. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bh/rr/n_/bhrrn_45uobnz9cpfxyxfmgpajm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">12a - MyAnt tab with ant</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We revive the ant</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we need to teach our freshly baked ant to crawl between cities. </font><font style="vertical-align: inherit;">True, so far without taking into account the mathematical model, but still let it run. </font><font style="vertical-align: inherit;">And so, open the â€œState diagramâ€ diagram in the â€œPaletteâ€ and proceed. </font><font style="vertical-align: inherit;">We transfer the following blocks and connect them together:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The beginning of the state diagram is the starting point of our ant's life cycle;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">State - this block will characterize the state of the life cycle of our ant. </font><font style="vertical-align: inherit;">Such blocks are required in pieces.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transition - an arrow that will connect our â€œStatesâ€ to each other and perform the transition from one â€œStateâ€ to another â€œStateâ€ under certain conditions.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, it should turn out something like as shown in Figure 13. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rl/xk/ry/rlxkrykh7gpd6ujcc5aetxfldxm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">13 - The logic of the ant</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
's </font><i><font style="vertical-align: inherit;">behavior</font></i><font style="vertical-align: inherit;"> Now let's write the initial logic of the ant diagram. </font><font style="vertical-align: inherit;">We select with the mouse the arrow that exits the block under the name â€œSelect Cityâ€ and add the following code in the â€œActionâ€ field in the â€œPropertiesâ€ tab (Fig. 14):</font></font><br>
<pre><code class="java hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;main.myTowns.size(); i++) {
	<span class="hljs-keyword">if</span> (randomTrue(<span class="hljs-number">0.5</span>)) {
		<span class="hljs-keyword">this</span>.moveTo(main.myTowns.get(i));
		<span class="hljs-keyword">break</span>;<font></font>
	} <font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here everything is very simple, we go through the cycle in all cities and toss a coin (we generate a random variable with probability. 0.5) if its value is true (eagle), then we send the ant to this city leaving the cycle. The expression "this.moveTo (main.myTowns.get (i))" is a function that sends one agent to another. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sc/ql/7y/scql7yplmodnhdrldsc6tvb3l2m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 14 - Set the initial logic of the antâ€™s movement.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Next, click on the arrow that leaves the â€œMotionâ€ block and in the â€œPropertiesâ€ tab, in the â€œOccursâ€ field, set the value â€œUpon receipt of a messageâ€ and select â€œUpon receipt of the specified messageâ€ in the â€œOccursâ€ field. Â»As shown in Figure 15. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ks/hh/g9/kshhg9m8nyxvzqz9d1dj2xnrgtc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 15 - Set the logic for the transition between â€œMovementâ€ and â€œBypassed everythingâ€</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now configure the last arrow that comes out of the "Motion" block. </font><font style="vertical-align: inherit;">We select it with the mouse and in the "Properties" tab, in the transition field, set "Upon arrival of the agent." </font><font style="vertical-align: inherit;">The final view of the â€œState diagramâ€ should be as shown in Figure 16. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/os/kv/af/oskvafwwsgpitd36rnozrirob9m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">16 - State diagram with configured transitions between blocks</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So, let's look at how the "State diagram" of ant behavior works:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first state that the ant falls into is â€œVybor_cityâ€, so far no action has been spelled out.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then he goes to the next state upon transition. </font><font style="vertical-align: inherit;">In this transition, we added a code that starts a cycle through all the mountains and makes ants run around the cities.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The "Movement" block is where the ant is located until it arrives in the previously selected city.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Further, he has two ways. </font><font style="vertical-align: inherit;">First, he returns back to the block "City_Choice" and everything is repeated again. </font><font style="vertical-align: inherit;">On the second path he will have to go when he has already visited all cities. </font><font style="vertical-align: inherit;">So far, the second way is not set up with us. </font><font style="vertical-align: inherit;">We will deal with them a little later.</font></font></li>
</ol><br>
<br>
<img src="https://habrastorage.org/webt/3z/aj/md/3zajmdqorvjpondmi8k03fmmz94.gif"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">17 - Operation of the state diagram</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now we can press "F5" to see what happened (Fig. 18). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fr/cg/us/frcgusj3llqem0vaf8rxjngwwii.gif"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">18 - The revival of ants</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Define the criteria</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, what are these criteria (rules):</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An ant should visit each city only once.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ant, when he visited all the cities ends his movement in the last city.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These criteria are dictated to us by the condition of the traveling salesman problem. Each ant will be with us a kind of traveling salesman who travels through cities. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's teach the ant to abide by these rules. Why, from the "Palette", the "Agent" tab, transfer the "Collection" and "Variable" to the "MyAnt" tab and name them first as "isVisited" and the second as "distance". The first will take into account the cities that we have already visited, and the second the distance traveled by the ant. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-k/s-/a_/-ks-a_2igqbcyxzgzxiwlrbn9fe.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 19 - Add Variables</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Set up the isVisited collection. Why do we select it with the mouse and set the â€œTypeâ€ of the â€œintâ€ elements in the â€œPropertiesâ€ tab as shown in Figure 20. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the â€œdistanceâ€ variable in its properties, in the â€œInitial valueâ€ field, set â€œ0â€ and the variable type â€œdoubleâ€ ". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cm/2v/te/cm2vte4vjkzqycf0r58qz8itz7u.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 20 - Collection of type "int"</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now select the arrow leaving the "City_block" block and change the code in the "Action" field to the one below:</font></font><br>
<pre><code class="java hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;main.myTowns.size(); i++) {
	<span class="hljs-keyword">if</span> (randomTrue(<span class="hljs-number">0.9</span>) &amp;&amp; isVisited.indexOf(i)==-<span class="hljs-number">1</span>) {
		<span class="hljs-keyword">this</span>.moveTo(main.myTowns.get(i));<font></font>
		distance=distance+<span class="hljs-keyword">this</span>.distanceTo(main.myTowns.get(i));<font></font>
		isVisited.add(i);<font></font>
		<span class="hljs-keyword">break</span>;<font></font>
	} <font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the code above, we added a check for the cities in which we have already managed to visit, and taking into account the cities that we visited, and also consider the distance traveled. </font><font style="vertical-align: inherit;">The code is quite simple, I think it will not be difficult for you to understand. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can try to launch â€œF5â€ our model and see what happened. </font><font style="vertical-align: inherit;">Now the ants will pass through all the cities only once and complete their movement in the block.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change the initial placement of ants</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At this step, we will determine for each ant we will randomly choose a city from which he will begin his journey. </font><font style="vertical-align: inherit;">Why, on the â€œProjectsâ€ tab, select the â€œMainâ€ agent with the mouse and then in the â€œPropertiesâ€ tab add the following code to the â€œAt Startupâ€ field (Fig. 20a):</font></font><br>
<pre><code class="java hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;myAnts.size(); i++) {
	<span class="hljs-comment">//        </span>
	<span class="hljs-keyword">int</span> startTown = uniform_discr(<span class="hljs-number">0</span>,myTowns-<span class="hljs-number">1</span>);
	<span class="hljs-comment">//     </span><font></font>
	myAnts.get(i).setPosition(myTowns.get(startTown));<font></font>
	<span class="hljs-comment">//      </span><font></font>
	myAnts.get(i).isVisited.add(startTown);<font></font>
}<font></font>
</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/2i/et/cg/2ietcgzx9lkptrnj5rainnljcig.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">20a - Arranging ants by city</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I applied a random selection of the initial city. </font><font style="vertical-align: inherit;">You can initially identify all ants in only one city.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Making ants unpredictable</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us introduce the following formula into our model: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kd/ld/xz/kdldxzse05ththx-oipffhru9oq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where Pi is the probability of transition along the path of the i-th path, li is the length of the i-th transition, fi is the amount of pheromone at the i-th transition, q is the value that determines the â€œgreedâ€ of the algorithm, p - the value that determines the "herd" of the algorithm, with q + p = 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I borrowed this formula from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In simple terms, this formula allows you to calculate the probability with which the ant will have to make the transition to a particular city. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we need to add several variables without which we can not do. Why go back to the â€œMainâ€ tab, figure 21. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zk/ba/cv/zkbacvaft1obpjrs1kw9hblkjos.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 21 - Tab â€œMainâ€</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, we add the variable â€œnumberAntâ€, in which we will store the size of the ant colony. We set its type to "int" and the initial value is 100. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/80/o2/w4/80o2w43ra-j_fwfabeunywmjkbm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 21 - Variable â€œnumberAntâ€</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Next, select the population â€œmyAntsâ€ and set the field â€œInitial number of agentsâ€ to â€œnumberAntâ€. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The variable "p", which will determine the herdness of the algorithm. Its type is double and the initial value is 0.5. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The variable "q", which will determine the greed of the algorithm. Its type is double and the initial value is 0.5. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/m7/n0/gem7n0dj3rlhd_uu6aac3rrqyby.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 22 - Variables "q and p"</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, now we will set a random pheromone value for each edge (road) between the cities. Why create a variable (two-dimensional array) "matrixF". Set it in the â€œPropertiesâ€ tab in the â€œTypeâ€ field, select the value â€œOtherâ€ and write â€œdouble [] []â€ in the field the initial value â€œnew double [numberTown] [numberTown]â€ (Fig. 23). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/4d/oi/wq4doiphuc28xcg1a3vcveng4ms.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 23 - Creating a two-dimensional array "matrixF". Pheromone Matrix</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Next, we need to initialize this matrix. In other words, fill it with random values. We take the pheromone value randomly in the range from 0.1 to </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. For this, on the â€œProjectsâ€ tab, select the â€œMainâ€ agent with the mouse and then in the â€œPropertiesâ€ tab add the following code to the â€œAt Startupâ€ field (Fig. 23a):</font></font><br>
<pre><code class="java hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;myTowns.size(); i++) {
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>; j&lt;myTowns.size(); j++) {<font></font>
		matrixF[i][j]=uniform(<span class="hljs-number">0.1</span>,<span class="hljs-number">1</span>);<font></font>
	}<font></font>
} <font></font>
</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/ob/an/ta/obanta0s5kb7vqnsc3wsn-qmbgg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">23a - Initialization code of the pheromone matrix</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now we return to the â€œMyAntâ€ tab and proceed to calculate the transition probability in accordance with the above formula. </font><font style="vertical-align: inherit;">Select the transition between "City_Choice" and "Motion" and change the code in the Action field to the following (Fig. 24):</font></font><br>
<pre><code class="java hljs"><span class="hljs-comment">//       </span>
<span class="hljs-keyword">double</span> denominator=<span class="hljs-number">0</span>; 
<span class="hljs-comment">//          </span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;main.myTowns.size(); i++) {
	<span class="hljs-keyword">if</span> (isVisited.indexOf(i)==-<span class="hljs-number">1</span>) {	<span class="hljs-comment">//     </span>
	    <span class="hljs-comment">//  i   </span>
		denominator=denominator+(Math.pow(<span class="hljs-keyword">this</span>.distanceTo(main.myTowns.get(i)), main.q)*Math.pow(main.myTowns.get(i).f, main.p));<font></font>
	} <font></font>
}<font></font>
<span class="hljs-comment">//      i </span>
<span class="hljs-keyword">double</span> Pi=<span class="hljs-number">0</span>;
<span class="hljs-comment">//    </span>
<span class="hljs-keyword">double</span> probility=uniform(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;main.myTowns.size(); i++) {
	<span class="hljs-comment">//        Pi</span>
	<span class="hljs-keyword">if</span> (isVisited.indexOf(i)==-<span class="hljs-number">1</span>) {
		<span class="hljs-comment">//     i-      </span>
		Pi=Pi+(Math.pow(<span class="hljs-keyword">this</span>.distanceTo(main.myTowns.get(i)), main.q)*Math.pow(main.myTowns.get(i).f, main.p))/denominator;<font></font>
	}<font></font>
	<span class="hljs-comment">//      Pi      probility</span>
	<span class="hljs-keyword">if</span> (probility&lt;Pi &amp;&amp; isVisited.indexOf(i)==-<span class="hljs-number">1</span>) {
		<span class="hljs-comment">//       i  </span>
		<span class="hljs-keyword">this</span>.moveTo(main.myTowns.get(i));
		<span class="hljs-comment">//     </span>
		distance=distance+<span class="hljs-keyword">this</span>.distanceTo(main.myTowns.get(i));
		<span class="hljs-comment">//           </span><font></font>
		isVisited.add(i);<font></font>
		<span class="hljs-keyword">break</span>;<font></font>
	} <font></font>
}<font></font>
</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/7u/gr/re/7ugrreytqo1mjwh43xeaagissqm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">24 - We set the behavior of the ant based on the analytical expression of the above.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So now I will explain a little whatâ€™s what:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">li - this.distanceTo (main.myTowns.get (i)), the length value between the current position of the ant and the â€œiâ€ city;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fi - main.matrixF [currentPos] [i], the value of the pheromone level between the current city and the city â€œiâ€;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">denominator - denominator + (Math.pow (this.distanceTo (main.myTowns.get (i)), main.q) * Math.pow (main.matrixF [currentPos] [i], main.p)) ;, denominator Pi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pi - Pi + (Math.pow (this.distanceTo (main.myTowns.get (i)), main.q) * Math.pow (main.myTowns.get (i) .f, main.p)) / denominator, the probability of the ant moving from the current city to the city â€œiâ€.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we select the transition between the â€œMotionâ€ and â€œAll-bypassedâ€ blocks with the mouse and select â€œWhen the condition is metâ€ in the â€œOccursâ€ field, and in the condition field we write the condition for the ant to stop â€œisVisited.size () == main.myTowns.size ()â€ (fig. 25). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1w/qz/ag/1wqzagqllmjga_yqm5a8-9c_crg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">25 - Determine the conditions for stopping the ant.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Then you can run the â€œF5â€ model and see what happened. </font><font style="vertical-align: inherit;">Ants will travel between cities with a probability calculated according to the above analytical expression.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Updating the value of pheromone</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's do two things. The first action is to increase the pheromone value on the edge between the cities along which the ant passed. The second is the evaporation of pheromone on the edges between cities, which consists in reducing the value of pheromones relative to the simulation time.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, to begin with the first action, we will update the value of the pheromone of the rib between the city in which the ant is located and in which he will go. The value by which we will increase the current value of the pheromone edges between cities will be calculated very, very simple. We take our maximum initial value of the pheromone value = 1 cu and divide it by the distance between the city in which the ant is located and the city where he is going to go. Accordingly, the smaller the distance, between the cities the greater will be the value by which the level of the pheromone of the rib will be increased. Why do we select the MyAnt agent in the Projects tab, use the mouse to select the transition between the "City_title" and "Movement" blocks and add the following code to the action field: "main.matrixF [currentPos] [i] = main.matrixF [currentPos] [i ] + 1 / this.distanceTo (main.myTowns.get (i); â€.The result should be as shown in Figure 26</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wr/zi/jb/wrzijbuaavovmagcktbz4yrhkw0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 26 - Update the value of the level of pheromones of the ribs that the ant passed along.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now we proceed to </font><i><font style="vertical-align: inherit;">step</font></i><font style="vertical-align: inherit;"> 2 and create an event that will simulate the evaporation of the pheromone on the ribs between cities. Why, in the projects tab, select the â€œMainâ€ agent and create a couple more variables there. The first is â€œintensityâ€ - it will determine the rate (intensity) of pheromone evaporation (Initial value â€œ0.5â€, type â€œdoubleâ€). The second â€œPartâ€ - will characterize the fraction by which the value of the pheromone on the edge will decrease (Initial value â€œ0.9â€, type â€œdoubleâ€). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rh/_8/ly/rh_8lydcrbmm7pkkitihtmsszi4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 27 - Create the variables "intensity" and "Part"</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we take the "Event" element from the "Palette" of the "Agent" tab and transfer it to the "Main" agent and call it "evaporation" - this element will simulate the evaporation of pheromone on the edges. </font><font style="vertical-align: inherit;">Click on it with the mouse and in the "Properties" in the "Event Type" field, select the value "With a given intensity" in the "Intensity" field, write the name of the variable that stores the "intensity" intensity value. </font><font style="vertical-align: inherit;">The response time is seconds. </font><font style="vertical-align: inherit;">Next, add the code below to the action:</font></font><br>
<pre><code class="java hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;myTowns.size(); i++) {
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>; j&lt;myTowns.size(); j++) {<font></font>
		matrixF[i][j]=matrixF[i][j]*Part;<font></font>
		<span class="hljs-keyword">if</span> (matrixF[i][j]&lt;<span class="hljs-number">0.1</span>) matrixF[i][j]=<span class="hljs-number">0.1</span>;<font></font>
	}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the â€œevaporationâ€ event is triggered, pheromone levels in the matrixF matrix will be updated. </font><font style="vertical-align: inherit;">As a result, you should be able to do as shown in Figure 28. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/p9/dl/qqp9dljysgcl9xg7jvydl74oees.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">28 - Create the â€œevaporationâ€ event</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Determine the winner</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At this step, we will add a code that will determine the winner of our ant marathon. The winner will be the one of the ants who ran the shortest route. In addition to everything, after the end of the marathon, we draw this route on the screen. To achieve this, we will create three variables â€œbestAntâ€, â€œbestDistanceâ€ and â€œnumberFinishâ€ in the â€œMainâ€ agent. In the variable "bestAnt" we will store the index of the "fastest" ant, the type of the variable will be "int" and the initial value will be set to "-1". In the variable â€œbestDistanceâ€ we will store the current value of the best route length between cities, the type of the variable will be â€œdoubleâ€ and the initial value will be set to infinity â€œinfinityâ€. In the variable "numberFinish" we will store the number of ants that have finished in our marathon,the type of the variable will be "int" and the initial value is "0" (Fig. 29).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zd/2a/yw/zd2ayw0tmj6_wuft2sl2qz8tevu.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">29 - Create an event of variables</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Next, we create a function that, after finishing all the ants, will draw the lines of the best route between the cities. </font><font style="vertical-align: inherit;">Why from the "Palette" we drag into the agent "Main" an element with the name function. </font><font style="vertical-align: inherit;">Set the function name to drawPath, and in the Properties tab, in the function body field, add the following code:</font></font><br>
<pre><code class="java hljs"><span class="hljs-comment">//        </span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;myAnts.get(bestAnt).isVisited.size()-<span class="hljs-number">1</span>; i++) {
	<span class="hljs-comment">//    </span>
	ShapeLine myLine = <span class="hljs-keyword">new</span> ShapeLine();
	<span class="hljs-comment">//            i</span><font></font>
	myLine.setX(myTowns.get(myAnts.get(bestAnt).isVisited.get(i)).getX());<font></font>
	myLine.setY(myTowns.get(myAnts.get(bestAnt).isVisited.get(i)).getY());<font></font>
	<span class="hljs-comment">//            i+1</span>
	myLine.setEndX(myTowns.get(myAnts.get(bestAnt).isVisited.get(i+<span class="hljs-number">1</span>)).getX());<font></font>
	myLine.setEndY(myTowns.get(myAnts.get(bestAnt).isVisited.get(i+<span class="hljs-number">1</span>)).getY());
	<span class="hljs-comment">//    ""</span><font></font>
	myLine.setColor(blue);<font></font>
	<span class="hljs-comment">//   </span><font></font>
	myLine.setLineStyle(LINE_STYLE_SOLID );<font></font>
	<span class="hljs-comment">//   </span>
	myLine.setLineWidth(<span class="hljs-number">1</span>);
	<span class="hljs-comment">//    </span><font></font>
	presentation.add(myLine);	<font></font>
}<font></font>
	<span class="hljs-comment">//           </span>
	ShapeLine myLine = <span class="hljs-keyword">new</span> ShapeLine();<font></font>
	myLine.setX(myTowns.get(myAnts.get(bestAnt).isVisited.get(myAnts.get(bestAnt).isVisited.size()-<span class="hljs-number">1</span>)).getX());<font></font>
	myLine.setY(myTowns.get(myAnts.get(bestAnt).isVisited.get(myAnts.get(bestAnt).isVisited.size()-<span class="hljs-number">1</span>)).getY());<font></font>
	myLine.setEndX(myTowns.get(myAnts.get(bestAnt).isVisited.get(<span class="hljs-number">0</span>)).getX());<font></font>
	myLine.setEndY(myTowns.get(myAnts.get(bestAnt).isVisited.get(<span class="hljs-number">0</span>)).getY());<font></font>
	myLine.setColor(blue);<font></font>
	myLine.setLineStyle(LINE_STYLE_SOLID );<font></font>
	myLine.setLineWidth(<span class="hljs-number">1</span>);<font></font>
	presentation.add(myLine);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, you should be able to do as shown in Figure 29a. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/am/eq/1b/ameq1bhejnkldupsbngygcqqndw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">29a - Create the â€œdrawPathâ€ function</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now we go back to our ants and add a code that will determine the winner's ant, the length of the best route and draw this route between cities. </font><font style="vertical-align: inherit;">Why, in the â€œProjectsâ€ tab, select the â€œMyAntâ€ agent, then select the â€œAll Bypassedâ€ block and add the following code to the â€œLogon Actionâ€ field:</font></font><br>
<pre><code class="java hljs"><span class="hljs-comment">//    </span><font></font>
main.numberFinish++;<font></font>
<span class="hljs-comment">//      </span>
<span class="hljs-keyword">if</span> (main.bestDistance&gt;distance) {
	<span class="hljs-comment">//           </span>
	<span class="hljs-comment">//      </span><font></font>
	main.bestDistance=distance;<font></font>
	<span class="hljs-comment">//    </span>
	main.bestAnt = <span class="hljs-keyword">this</span>.getIndex();<font></font>
}<font></font>
<span class="hljs-comment">//         Main   </span>
<span class="hljs-keyword">if</span> (main.numberFinish==main.myAnts.size()) main.drawPath();
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should turn out as shown in Figure 30. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/68/ss/7c/68ss7cvbvbfbwkz26u6abdvwit8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">30 - Adding logic to the â€œAll Bypassedâ€ block.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Then you can press â€œF5â€ and run the model. </font><font style="vertical-align: inherit;">Ants will run around looking for routes, and when the cities finish, the blue line will connect, which is the best route.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add a histogram to the model</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order for the model to become more scientific, you must add a graph. Therefore, we will add not just a graph and a histogram that will show us the distribution of the length of the routes that the ants have overcome. Why in the tab "Projects" select the agent "Main" and go to its space. Further, in the "Palette" we go to the "Statistics" tab and from there to the "Main" agent we transfer the "Histogram data" element and directly the "Histogram" itself. Then we select the histograms with the mouse and in the â€œPropertiesâ€ tab, in the â€œDataâ€ field, specify the name of our â€œHistogram Dataâ€ i.e. "Data". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should turn out as shown in Figure 31 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7v/bz/6i/7vbz6ikwgs7t0iintfnp2jz6wyw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. 31 - Building a schedule</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After which we will again have to return to our ant and make it fill the "Histogram" with the values â€‹â€‹of the length of the route. </font><font style="vertical-align: inherit;">Why, in the projects tab, select the agent "MyAnt" and go to its space. </font><font style="vertical-align: inherit;">Next, select the "All Bypass" block and add one line to it "main.data.add (distance);". </font><font style="vertical-align: inherit;">It should turn out as shown in Figure 32. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bf/wa/zl/bfwazly38mrpwolpx4awmowj10o.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">32 - Building a graph</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Next, press "F5" and proceed to study the behavior of the ant algorithm. </font><font style="vertical-align: inherit;">It should turn out something, something like shown in Figure 33. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3w/8w/is/3w8wissyoccebi-8ona5px-cop0.gif"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">33 - Modeling</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And in the end, I recommend adding more unpredictability to the model. </font><font style="vertical-align: inherit;">For this, in the â€œProjectsâ€ tab, select the â€œSimulation: Mainâ€ element with the mouse and set the â€œRandomnessâ€ parameter to â€œRandom initial number (unique runs)â€ in the properties tab - this will make each model launch unique (Fig. 34). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ie/ow/i6/ieowi6e32wykpsao8owpxbwzwzu.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">34 - Making random runs</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Thank you for your attention! </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code can be downloaded from GitHub</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500978/index.html">Delayed Retrays by RabbitMQ</a></li>
<li><a href="../en500980/index.html">Brain rx</a></li>
<li><a href="../en500984/index.html">Bad Apple or Happy Radio Day, geeks</a></li>
<li><a href="../en500986/index.html">Monitoring in the data center: how we changed the old BMS to a new one. Part 3</a></li>
<li><a href="../en500992/index.html">How is Performance Management in the best IT companies</a></li>
<li><a href="../en500996/index.html">How to become a DevOps engineer in six months or even faster. Part 1. Introduction</a></li>
<li><a href="../en500998/index.html">Convolutional neural network and its integration in iOS (part 1)</a></li>
<li><a href="../en501000/index.html">Code generation in Go by the example of creating a client for the database</a></li>
<li><a href="../en501002/index.html">Umka: new statically typed scripting language</a></li>
<li><a href="../en501004/index.html">Do it. Work</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>